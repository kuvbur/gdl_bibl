weight = 0gost = ""maxrad=0inx = 0dim reinforce_gost[8]dim reinforce_class[8]dim reinforce_diam[16][8]dim reinforce_weight[16][8]dim diam_temp[] : diam_temp[1] = 0success = LIBRARYGLOBAL ("Libraryflobals-kzh", "reinforce_class", reinforce_class)success = LIBRARYGLOBAL ("Libraryflobals-kzh", "reinforce_gost", reinforce_gost)success = LIBRARYGLOBAL ("Libraryflobals-kzh", "reinforce_diam", reinforce_diam)success = LIBRARYGLOBAL ("Libraryflobals-kzh", "reinforce_weight", reinforce_weight)dim arm_out[][] : arm_out[1][1] = ""values "marka_1" reinforce_classdim diam_1_temp[] : diam_1_temp[1] = 0if GLOB_MODPAR_NAME = "marka" or diam_1_temp[1]<EPS then 	class = marka_1	GOSUB "GetDiametr"	diam_1_temp = diam_temp	parameters gost_1 = gostendifvalues "diam_arm_1" diam_1_tempif GLOB_MODPAR_NAME = "diam_arm_1" or maxrad_1<EPS or weight = 0 then	class = marka_1	diam_arm = diam_arm_1 	GOSUB "Diametr2Weight"	GOSUB "GetMaxRad"	parameters maxrad_1 = maxrad	parameters ves_1 = weightendifif GLOB_MODPAR_NAME = "maxrad_1" or GLOB_MODPAR_NAME = "man_rad" then 	class = marka_1	diam_arm = diam_arm_1 	GOSUB "GetMaxRad"	if man_rad then		if maxrad_1<diam_arm_1 then parameters maxrad_1 = maxrad	else		parameters maxrad_1 = maxrad	endifendifl1 = pos_1_x1-maxrad_1-diam_arm_1l2 = pos_1_x2-maxrad_1-diam_arm_1l3 = pos_1_y-(maxrad_1+diam_arm_1)*2ld = PI*(maxrad_1+diam_arm_1/2)*(90/180)dlin_st_1 = l1+l2+l3parameters pos_1 = GLOB_ID,dlin_st_1=dlin_st_1pos = pos_1 : inx = 2 : class = marka_1 : diam_arm = diam_arm_1 : gost = gost_1 : dlin_st=dlin_st_1 : shag = shag_1 : GOSUB "SetOut"parameters arm_out = arm_outif GLOB_MODPAR_NAME = "pos_1_yt" then	parameters pos_1_y = pos_1_yt + (maxrad_1+diam_arm_1)*2else	parameters pos_1_yt = pos_1_y - (maxrad_1+diam_arm_1)*2endifvalues "pos_1_y" range[(maxrad_1+diam_arm_1)*2,]values "ang_1_ended" 45, -45values "ang_2_ended" 45, -45if GLOB_MODPAR_NAME = "pos_1_x1" then	if eq_12 then 		parameters pos_1_x2 = pos_1_x1	endifelse	if eq_12 then 		parameters pos_1_x1 = pos_1_x2	endifendifif GLOB_MODPAR_NAME = "pos_1_xt" then	parameters pos_1_x1 = pos_1_x1 + pos_1_xtendifend"GetDiametr":	gost = ""	nstolb = 0	for i = 1 to vardim1(reinforce_class)		if class = reinforce_class[i] then nstolb = i	next i	gost = reinforce_gost[nstolb]	if nstolb <= 0 then nstolb = 1	i = 1 : usl = 0	REPEAT		diam_temp[i] = reinforce_diam[i][nstolb]		i = i + 1		if i <= vardim1(reinforce_diam) and i>0 then			usl = (reinforce_diam[i][nstolb] = 0)		else			usl = 1		endif	UNTIL uslreturn"Diametr2Weight":	nstrok = 1	weight = 0	if nstolb = 0 then nstolb = 1	for i = 1 to vardim1(reinforce_diam)		if diam_arm = reinforce_diam[i][nstolb] then nstrok = i	next i	weight = reinforce_weight[nstrok][nstolb]return"GetMaxRad":	maxrad=diam_arm	if strstr(class,"240")<>0 AND diam_arm<=0.02 then maxrad=2.5*diam_arm/2+diam_arm/2	if strstr(class,"240")<>0 AND diam_arm>0.02 then maxrad=2.5*diam_arm/2+diam_arm/2	if strstr(class,"300")<>0 AND diam_arm<=0.02 then maxrad=4*diam_arm/2+diam_arm/2	if strstr(class,"300")<>0 AND diam_arm>0.02 then maxrad=6*diam_arm/2+diam_arm/2	if strstr(class,"400")<>0 AND diam_arm<=0.02 then maxrad=5*diam_arm/2+diam_arm/2	if strstr(class,"400")<>0 AND diam_arm>0.02 then maxrad=8*diam_arm/2+diam_arm/2	if strstr(class,"500")<>0 AND diam_arm<=0.02 then maxrad=6*diam_arm/2+diam_arm/2	if strstr(class,"500")<>0 AND diam_arm>0.02 then maxrad=8*diam_arm/2+diam_arm/2	maxrad=round_int(maxrad*500)/500return"SetOut":	if inx<=0 then inx = 1	ii = 0	ii = ii + 1 : arm_out[inx][ii] = pos  !Позиция	ii = ii + 1 : arm_out[inx][ii] = class  !Класс	ii = ii + 1 : arm_out[inx][ii] = str("%.0mm", diam_arm)  !Диаметр	ii = ii + 1 : arm_out[inx][ii] = gost  !ГОСТ	ii = ii + 1 : arm_out[inx][ii] = shag  !Шаг	ii = ii + 1 : arm_out[inx][ii] = str("%.0mm", dlin_st)  !Длинаreturn