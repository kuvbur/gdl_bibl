!------------------------
! Reinforcement
! 2012, Eptar Kft.
!------------------------
addx addrot[1][1]
addy addrot[1][2]
addz -addrot[1][4]
rotz addrot[1][3]
if idetlevel3d=0 then end
if bsectionelevationcontext then end
if not(gs_shadow) then shadow off
unid=1
call "ironGlobal" parameters bislisting=bislisting,
d=d,
irontype=iron_type_stirrup,
penironstirrup=penironstirrup,
matstirrup=matstirrup,
bcustom2d=bcustom2d,
bcustom3d=bcustom3d,
returned_parameters ipen,imat
pen ipen
if istirrupsubtype<>type_stirrup_normal then
	call "ironMinMax" parameters bcomplex=0,
	_pointcoords=stirruppointcoords,
	_arccenter=_arccenter,
	_arcpoints=stirruparcpoints,
	_arcangle=_arcangle,
	_radiusdistance=_radiusdistance,
	minpolyx=minpolyx,
	maxpolyx=maxpolyx,
	minpolyy=minpolyy,
	maxpolyy=maxpolyy,
	returned_parameters minpolyx,maxpolyx,minpolyy,maxpolyy
	centerx=minpolyx+(maxpolyx-minpolyx)/2
	centery=minpolyy+(maxpolyy-minpolyy)/2
else
	centerx=hoopx/2
	centery=hoopy/2
	minpolyx=0
	minpolyy=0
	maxpolyx=hoopx
	maxpolyy=hoopy
endif
if iposition=pos_hor then
	roty-90
	rotx-90
endif
unid=100
if n>1 then
	if iedittype<>editby_dist_n then
		hotspot startdist,0,centery,unid,fulllength,1+256:unid=unid+1
		hotspot startdist+fulllength,0,centery,unid,fulllength,2:unid=unid+1
		hotspot startdist-1,0,centery,unid,fulllength,3:unid=unid+1
	else
		unid=unid+3
	endif
	if iedittype<>editby_l_n then
		hotspot startdist,0,centery,unid,disthoops,1:unid=unid+1
		hotspot startdist+disthoops,0,centery,unid,disthoops,2:unid=unid+1
		hotspot startdist-1,0,centery,unid,disthoops,3:unid=unid+1
	else
		unid=unid+3
	endif
	hotspot 0,0,minpolyy,unid,startdist,1:unid=unid+1
	hotspot startdist,0,minpolyy,unid,startdist,2:unid=unid+1
	hotspot-1,0,minpolyy,unid,startdist,3:unid=unid+1
	hotspot 0,0,maxpolyy,unid,startdist,1:unid=unid+1
	hotspot startdist,0,maxpolyy,unid,startdist,2:unid=unid+1
	hotspot-1,0,maxpolyy,unid,startdist,3:unid=unid+1
	hotspot startdist+fulllength,0,minpolyy,unid,enddist,1:unid=unid+1
	hotspot startdist+fulllength+enddist,0,minpolyy,unid,enddist,2:unid=unid+1
	hotspot startdist+fulllength-1,0,minpolyy,unid,enddist,3:unid=unid+1
	hotspot startdist+fulllength,0,maxpolyy,unid,enddist,1:unid=unid+1
	hotspot startdist+fulllength+enddist,0,maxpolyy,unid,enddist,2:unid=unid+1
	hotspot startdist+fulllength-1,0,maxpolyy,unid,enddist,3:unid=unid+1
endif
unid=1000
bnullhotspot=(istirrupsubtype<>type_stirrup_polygon)
add startdist,stirrupoffsetx*(iposition=pos_ver),stirrupoffsety*(iposition=pos_ver)
benablehsedit=benablehsedit*bshow3dhotspots
for i=1 to n-1
	gosub "ed"
	addx disthoops
next i
addx fulllength-n*disthoops
gosub "ed"
del n+1
if iposition=pos_hor then del 2
end
"ed":
		rotz-90
		mulx-1
		gosub "drawIron"
		del 2
	rotz -rot_st
	if bshow3dhotspots then
		if(istirrupsubtype=type_stirrup_normal)|\
		(istirrupsubtype=type_stirrup_type_2)|\
		(istirrupsubtype=type_stirrup_type_5)|\
		(istirrupsubtype=type_stirrup_type_6)|\
		(istirrupsubtype=type_stirrup_type_7) then
			hotspot 0,0,0,unid,hoopx,1:unid=unid+1
			hotspot 0,hoopx,0,unid,hoopx,2:unid=unid+1
			hotspot 0,-1,0,unid,hoopx,3:unid=unid+1
			hotspot 0,0,hoopy,unid,hoopx,1+256:unid=unid+1
			hotspot 0,hoopx,hoopy,unid,hoopx,2:unid=unid+1
			hotspot 0,-1,hoopy,unid,hoopx,3:unid=unid+1
			hotspot 0,0,0,unid,hoopy,1:unid=unid+1
			hotspot 0,0,hoopy,unid,hoopy,2:unid=unid+1
			hotspot 0,0,-1,unid,hoopy,3:unid=unid+1
			hotspot 0,hoopx,0,unid,hoopy,1+256:unid=unid+1
			hotspot 0,hoopx,hoopy,unid,hoopy,2:unid=unid+1
			hotspot 0,hoopx,-1,unid,hoopy,3:unid=unid+1
		endif
		if(istirrupsubtype=type_stirrup_type_8)|\
		(istirrupsubtype=type_stirrup_type_9) then
			hotspot 0,0,0,unid,hoopx,1:unid=unid+1
			hotspot 0,-hoopx,0,unid,hoopx,2:unid=unid+1
			hotspot 0,1,0,unid,hoopx,3:unid=unid+1
			hotspot 0,0,hoopy,unid,hoopx,1+256:unid=unid+1
			hotspot 0,-hoopx,hoopy,unid,hoopx,2:unid=unid+1
			hotspot 0,1,hoopy,unid,hoopx,3:unid=unid+1
			hotspot 0,0,0,unid,hoopy,1:unid=unid+1
			hotspot 0,0,hoopy,unid,hoopy,2:unid=unid+1
			hotspot 0,0,-1,unid,hoopy,3:unid=unid+1
			hotspot 0,-hoopx,0,unid,hoopy,1+256:unid=unid+1
			hotspot 0,-hoopx,hoopy,unid,hoopy,2:unid=unid+1
			hotspot 0,-hoopx,-1,unid,hoopy,3:unid=unid+1
		endif
		if(istirrupsubtype=type_stirrup_type_3)|\
		(istirrupsubtype=type_stirrup_type_4) then
			hotspot 0,0,0,unid,hoopy,1+256:unid=unid+1
			hotspot 0,0,hoopy,unid,hoopy,2:unid=unid+1
			hotspot 0,0,-1,unid,hoopy,3:unid=unid+1
		endif
		if(istirrupsubtype=type_stirrup_type_10) then
			hotspot 0,0,0,unid,hoopx,1:unid=unid+1
			hotspot 0,-hoopx,0,unid,hoopx,2:unid=unid+1
			hotspot 0,1,0,unid,hoopx,3:unid=unid+1
			hotspot 0,0,0,unid,hoopy,1:unid=unid+1
			hotspot 0,0,-hoopy,unid,hoopy,2:unid=unid+1
			hotspot 0,0,1,unid,hoopy,3:unid=unid+1
		endif
		if(istirrupsubtype=type_stirrup_circle) then
			hotspot 0,0,0,unid,hoopcircle2,1+128:unid=unid+1
			hotspot 0,hoopcircle2,0,unid,hoopcircle2,2,hoopcircle:unid=unid+1
			hotspot 0,-1,0,unid,hoopcircle2,3:unid=unid+1
		endif
	endif
	del 1

return
"drawIron":
	call "ironDrawer" parameters buseirondata=0,
	benablehsedit=benablehsedit,
	bnullhotspot=bnullhotspot,
	unid=unid,
	idetlevel3d=idetlevel3d,
	peniron=ipen,
	gs_mat=imat,
	gs_shadow=gs_shadow,
	gs_resol=gs_resol,
	iview=view_side,
	nstirrup=1,
	stirrupdist=disthoops,
	irontype=irontype,
	d=d,
	bendradius=bendradius,
	jointlength=jointlength,
	bdetailedarc=1,
	fulllength=fulllength,
	hoopx=hoopx,
	hoopy=hoopy,
	nstirruppoint=nstirruppoint,
	stirruppointcoords=stirruppointcoords,
	stirrupprevcoords=stirrupprevcoords,
	stirruparcpoints=stirruparcpoints,
	stirrupnewpoint=stirrupnewpoint,
	bclosedpolygon=bclosedpolygon,
	bstirrupback1=bstirrupback1,
	bstirrupback2=bstirrupback2,
	stirrupang1=stirrupang1,
	stirrupang2=stirrupang2,
	rot_st = rot_st,
	returned_parameters unid
return
