L=0.01*GLOB_SCALEMUL2   L,LDEFINE STYLE "текст25-3"  fontType, 2.5, 3, rtypeDEFINE STYLE "текст25-5"  fontType, r255, 5, r255typeDEFINE STYLE "текст18-4"  fontType, r184, 4, r184typeDEFINE STYLE "текст20-5"  fontType, r205, 5, r205typeDEFINE STYLE "текст20-4"  fontType, r205, 4, r205typeDEFINE STYLE "текст50-5"  fontType, r505, 5, r505typeDEFINE STYLE "текст18-5"  fontType, r184, 5, r184typen = REQUEST ("HomeDB_info", "", homeDBIntId, homeDBUserId, homeDBName, homeContext)if homeContext<>5 then	is_num = 0else	if diff_type_table then		if homeDBUserId = "1" then			type_table = type_table_first		else			type_table = type_table_next		endif	endifendifif not(is_autotext) then	current_phase = phaseendifif tend_date = " " then tend_date = current_datetn_change = vardim1(change_info)if shifrt_l<>" " and shifrt_l<>"" then	shifr = shifrt_l + delim_part + current_partelse	shifr = shifrt + delim_part + current_partendifIF type_table <> 99 and type_table > 4 THEN 	HOTSPOT2 0,0	is_end = 0	IF type_table = 5 THEN		gosub "table_type_5"		is_end = 1	endif	IF type_table = 6 THEN !Дата изм 0		SET STYLE "текст20-5"		TEXT2  0,0,current_date 		is_end = 1	endif	IF type_table = 7 THEN !Шифр		SET STYLE "текст50-5"		TEXT2  0,0,shifr 		is_end = 1	endif	IF type_table = 8 THEN !Стадия		SET STYLE "текст50-5"		TEXT2  0,0,"Стадия " + current_phase 		is_end = 1	endif	IF type_table = 9 THEN		SET STYLE "текст50-5"		if current_phase = "П" then naen_dok = "Проектная документация" 		if current_phase = "Р" then naen_dok = "Рабочая документация" 		TEXT2  0,0,naen_dok 		is_end = 1	endif	if is_end then endendifif _bERROR then	pen_small = pen_error	pen_osn = pen_error	pen_podp = pen_error	pen_text = pen_error	LINE2  0, 0, hsh, lsh	LINE2  hsh, 0, 0, lshendifIF is_boundary THEN gosub "out_boundary"gosub "inner_boundary"if type_table = 10 then	is_second = 0	if homeContext = 5 then		curren_ID = 0		n1= SPLIT (homeDBUserId, "%n", curren_ID)		if curren_ID>1 then	is_second = 1	endif	if iscont then is_second = 1	if not(is_second) then type_table = 1endifif is_dop_graph and type_table <> 10 then gosub "dop_graph"if is_agreed and type_table <> 10 then gosub "agreed"IF type_table = 98 THEN gosub "table_type_98"IF type_table = 97 THEN gosub "table_type_9"IF type_table = 99 THEN gosub "table_type_99"IF type_table = 4 THEN gosub "table_type_4"IF type_table = 3 THEN gosub "table_type_3"IF type_table = 2 THEN gosub "table_type_2"IF type_table = 1 THEN gosub "table_type_1"IF type_table = 10 THEN gosub "table_type_10"del topEND"table_type_5":	pen SYMB_VIEW_PEN	lsh = 6	hsh = max (2, tn_change*0.5+0.5)	pen pen_osn	RECT2 0, 0, lsh, hsh	RECT2 0, hsh, lsh, hsh-0.5	line2 1,0, 1, hsh	line2 2.5,0, 2.5, hsh	line2 4.5,0, 4.5, hsh	hotspot2 1,0	hotspot2 2.5,0	hotspot2 4.5,0	hotspot2 0,0	hotspot2 lsh,0	hotspot2 lsh,hsh	hotspot2 0,hsh	pen pen_small	for x = 0.5 to hsh-1 step 0.5		line2 0,x, lsh, x		next x	PEN pen_text	SET STYLE "текст18-5"	text2 0.5,hsh-0.25,"Изм."	text2 1.75,hsh-0.25,"№ док."	text2 3.5,hsh-0.25,"Подп."	text2 5.25,hsh-0.25,"Дата"	i = 0	for x = hsh-0.75 to 0 step -0.5		i = i + 1		if i <= tn_change then			if vartype(change_info[i][2]) = 2 then 				if strlen(change_info[i][2])>-1 then					TEXT2  0.5, x, change_info[i][1]					TEXT2  1.75, x, change_info[i][3]					if end_date then change_info[i][5] = tend_date					if tis_date then TEXT2  5.25, x, change_info[i][5]					add2 2.6, x-0.25					surname = change_info[i][4] : gosub "signature"					del 1				endif			endif		endif	next xreturn"table_type_1":	pen SYMB_VIEW_PEN	ADD2 hsh-19, 0.5	hotspot2 13.5, 1.5	hotspot2 0, 0	hotspot2 0, 5.5+(tn_change-4)*0.5*(tn_change>4)	hotspot2 0, 5.5	hotspot2 18.5,5.5	hotspot2 1.7, 0	hotspot2 1.7, 5.5+(tn_change-4)*0.5*(tn_change>4)	hotspot2 4, 0	hotspot2 4, 5.5+(tn_change-4)*0.5*(tn_change>4)	hotspot2 5.5, 0	hotspot2 5.5, 5.5+(tn_change-4)*0.5*(tn_change>4)	hotspot2 6.5, 0	hotspot2 6.5, 5.5+(tn_change-4)*0.5*(tn_change>4)	hotspot2 6.5, 1.5	hotspot2 18.5, 1.5	hotspot2 13.5, 0	hotspot2 13.5, 3.0	hotspot2 15, 1.5	hotspot2 15, 2.5	hotspot2 15, 3.0	hotspot2 16.5, 1.5	hotspot2 16.5, 2.5	hotspot2 16.5, 3.0	hotspot2 13.5, 2.5	hotspot2 18.5, 2.5	hotspot2 6.5, 3.0	hotspot2 18.5, 3.0	hotspot2 6.5, 4.5	hotspot2 18.5, 4.5	pen pen_osn	LINE2  0, 0, 0, 5.5+(tn_change-4)*0.5*(tn_change>4)	LINE2  0, 5.5 ,18.5,5.5	LINE2  1.7, 0, 1.7, 5.5+(tn_change-4)*0.5*(tn_change>4)	LINE2  4, 0, 4, 5.5+(tn_change-4)*0.5*(tn_change>4)	LINE2  5.5, 0, 5.5, 5.5+(tn_change-4)*0.5*(tn_change>4)	LINE2  6.5, 0, 6.5, 5.5+(tn_change-4)*0.5*(tn_change>4)	LINE2  0, 3.0, 18.5, 3.0	LINE2  0, 3.5, 6.5, 3.5	LINE2  6.5, 1.5, 18.5, 1.5	LINE2  13.5, 0.0, 13.5, 3.0	LINE2  15.0, 1.5, 15.0, 3.0	LINE2  16.5, 1.5, 16.5, 3.0	LINE2  13.5, 2.5, 18.5, 2.5	LINE2  6.5, 4.5, 18.5, 4.5	SET STYLE "текст20-5"	PEN pen_text	TEXT2  14.25, 2.75, "Стадия"	TEXT2  15.75,2.75,"Лист"	TEXT2  17.5,2.75,"Листов"	SET STYLE "текст25-5"	TEXT2  14.25, 2, current_phase	TEXT2  15.75,2,sheet_id	SET STYLE "текст50-5"	TEXT2  12.5,5,shifr	SET STYLE "текст25-5"	upper_bound = 5.5	start_change = 3	gosub "position"RETURN"table_type_2":	pen SYMB_VIEW_PEN	ADD2 hsh-19, 0.5	pen pen_osn	LINE2  0, 0, 0, 5.5	LINE2  0, 5.5 ,18.5,5.5	LINE2  1.7, 0, 1.7, 5.5	LINE2  4, 0, 4, 5.5	LINE2  5.5, 0, 5.5, 5.5	LINE2  6.5, 0, 6.5, 5.5	pen pen_small	LINE2  6.5, 1.5, 18.5, 1.5	LINE2  6.5, 4, 18.5, 4	LINE2  13.5, 3.5, 18.5, 3.5	LINE2  13.5, 2, 18.5, 2	LINE2  13.5, 0, 13.5, 4	LINE2  15, 2, 15, 4	LINE2  16.5, 2, 16.5, 4	LINE2  15.5, 1.5, 15.5, 2	SET STYLE "текст20-5"	PEN pen_text	TEXT2  14.25, 3.75, "Стадия"	TEXT2  15.75,3.75,"Масса"	TEXT2  17.5,3.75,"Масштаб"	TEXT2  14.0,1.75,"Лист"	TEXT2  16.5,1.75,"Листов"	SET STYLE "текст25-5"	TEXT2  14.25, 2.75, current_phase	TEXT2  15.75, 2.75, weight	TEXT2  17.5, 2.75, "б/м"	SET STYLE "текст20-5"	TEXT2  15,1.75,sheet_id	SET STYLE "текст50-5"	TEXT2  12.5,4.75,shifr+delim_part+subpos	SET STYLE "текст25-5"	upper_bound = 5.5	start_change = 3	gosub "position"RETURN"table_type_3":	pen SYMB_VIEW_PEN	ADD2 hsh-19, 0.5	LINE2  0, 0, 0, 4	LINE2  0, 4 ,18.5,4	LINE2  1.7, 0, 1.7, 4	LINE2  4, 0, 4, 4	LINE2  5.5, 0, 5.5, 4	LINE2  6.5, 0, 6.5, 4	LINE2  13.5, 0, 13.5, 2.5	LINE2  15, 1.5, 15, 2.5	LINE2  16.5, 1.5, 16.5, 2.5	LINE2  0, 0.5, 6.5, .5	LINE2  0, 1, 6.5, 1	LINE2  0, 1.5, 6.5, 1.5	LINE2  13.5, 1.5, 18.5, 1.5	LINE2  0, 2, 6.5, 2	LINE2  0, 2.5, 18.5, 2.5	LINE2  13.5, 2, 18.5, 2	LINE2  0, 3, 6.5, 3	LINE2  0, 3.5, 6.5, 3.5	SET STYLE "текст20-5"	PEN  pen_text	TEXT2  14.25, 2.25, "Стадия"	TEXT2  15.75,2.25,"Лист"	TEXT2  17.5,2.25,"Листов"	SET STYLE "текст20-5"	TEXT2  14.25, 1.75, current_phase	TEXT2  15.75,1.75,sheet_id	SET STYLE "текст50-5"	TEXT2  12.5,3.2,shifr	SET STYLE "текст25-5"	TEXT2  10,1.25,naen_sheet	gosub "position"RETURN"table_type_4":	pen SYMB_VIEW_PEN	ADD2 hsh-13.5, 0.5	LINE2  0, 0, 0, 1.5	LINE2  0, 1.5 ,13,1.5	LINE2  12, 0, 12, 1.5	LINE2  12, 1, 13, 1	SET STYLE "текст20-5"	PEN pen_text	TEXT2  12.5,1.25,"Лист"	TEXT2  12.5,0.5,sheet_id	SET STYLE "текст50-5"	TEXT2  6.5,0.75,shifr	SET STYLE "текст25-5"RETURN"table_type_99":	pen SYMB_VIEW_PEN	ADD2 hsh-19, 0.5	hotspot2 0.0,	0.0		! НЛ угол ШТАММПА А4	hotspot2 0.0,	2.0		! ВЛ угол ШТАММПА А4	hotspot2 0.0,	0.5	hotspot2 0.0,	1.0	hotspot2 0.0,	1.5	hotspot2 1.7,	0.5	hotspot2 1.7,	1.0	hotspot2 1.7,	1.5	hotspot2 4.0,	0.5	hotspot2 4.0,	1.0	hotspot2 4.0,	1.5	hotspot2 5.5,	0.5	hotspot2 5.5,	1.0	hotspot2 5.5,	1.5	hotspot2 6.5,	0.5	hotspot2 6.5,	1.0	hotspot2 6.5,	1.5	hotspot2 18.5,	0.0		! НП угол ШТАММПА А4	hotspot2 18.5,	2.0		! ВП угол ШТАММПА А4	hotspot2 17.5,	0.0 	hotspot2 17.5,	1.0 	hotspot2 18.5,	1.0 	hotspot2 17.5,	2.0	hotspot2 16.5,	0.0 	hotspot2 16.5,	1.0 	hotspot2 16.5,	2.0	hotspot2 5.5,	0.0	hotspot2 5.5,	2.0	hotspot2 1.7,	0.0	hotspot2 1.7,	2.0	hotspot2 4.0,	0.0	hotspot2 4.0,	2.0	hotspot2 6.5,	0.0	hotspot2 6.5,	2.0	hotspot2 1.5,	2.0	hotspot2 3.0,	2.0	hotspot2 13.5,	2.0	hotspot2 15.0,	2.0	hotspot2 1.5,	23.7	hotspot2 3.0,	23.7	hotspot2 13.5,	23.7	hotspot2 15.0,	23.7	hotspot2 0.0,	23.7	hotspot2 18.5,	23.7	hotspot2 1.5,	24.2	hotspot2 3.0,	24.2	hotspot2 13.5,	24.2	hotspot2 15.0,	24.2	hotspot2 0.0,	24.2	hotspot2 18.5,	24.2	hotspot2 7.5,	24.2	hotspot2 7.5,	26.2	hotspot2 3.0,	26.2	hotspot2 0.0,	26.2	hotspot2 18.5,	26.2	hotspot2 7.5,	27.2	hotspot2 3.0,	27.2	hotspot2 0.0,	27.2	hotspot2 18.5,	27.2	hotspot2 4.0,	27.2	hotspot2 4.0,	28.7	PEN pen_small	LINE2  0, 	0.5, 	6.5, 	0.5	LINE2  0, 	1, 		6.5, 	1	LINE2  0, 	1.5, 	6.5, 	1.5	PEN pen_osn	LINE2  16.5,	0.0,	16.5,	2.0	LINE2  17.5,	0.0,	17.5,	2.0	LINE2  0.0,		2.0,	18.5,	2.0	LINE2  16.5,	1.0,	18.5,	1.0	LINE2  1.5,		2.0,	1.5,	24.2	LINE2  3.0,		2.0,	3.0,	27.2	LINE2  13.5,	2.0,	13.5,	24.2	LINE2  15.0,	2.0,	15.0,	24.2	LINE2  0.0,		23.7,	18.5,	23.7	LINE2  0.0,		24.2,	18.5,	24.2	LINE2  0.0,		26.2,	18.5,	26.2	LINE2  0.0,		27.2,	18.5,	27.2	LINE2  4.0,		27.2,	4.0,	28.7	LINE2  7.5,		24.2,	7.5,	27.2	LINE2  0, 	0, 		0, 		2	LINE2  1.7, 0, 		1.7, 	2	LINE2  5.5, 0, 		5.5, 	2	LINE2  6.5, 0, 		6.5, 	2	LINE2  4, 	0, 		4, 		2	SET STYLE "текст20-5"	PEN  pen_text	TEXT2  17.0,1.5,"Лист"	TEXT2  18.0,1.5,"Листов"	TEXT2  0.8,23.9,"Изм."	TEXT2  2.3,23.9,"Лист"	TEXT2  8.5,23.9,"Содержание изменения"	TEXT2  14.3,23.9,"Код"	TEXT2  16.9,23.9,"Примечание"	TEXT2  1.5,26.7,"Разрешение"	TEXT2  5.3,26.7,"Обозначение"	TEXT2  5.3,25.4,"Наименование объекта"	TEXT2  5.3,25.0,"строительства"	SET STYLE "текст20-4"	PEN  pen_text	TEXT2  0.1,1.7,"Изм. внес"	TEXT2  0.1,1.2,"Составил"	TEXT2  0.1,0.7,"ГИП"	TEXT2  0.1,0.2,"Утв."!	SET STYLE "текст20-5"!	TEXT2  14.25, 1.75, current_phase!	TEXT2  15.75,1.75,sheet_id	SET STYLE "текст50-5"	TEXT2  11.5,27.9,"Разрешение на внесение изменений"	TEXT2  13.0,26.6,shifr!	SET STYLE "текст25-5"!	gosub "position"RETURN"table_type_9":	ADD2 hsh-19.0, 0.5	pen pen_small	LINE2  0.0, 1.0, 6.5, 1.0	LINE2  17.5, 1, 18.5, 1	PEN pen_osn	LINE2  0, 0, 0, 1.5	LINE2  0, 1.5 ,18.5,1.5	LINE2  17.5, 0, 17.5, 1.5	LINE2  0.85, 0, 0.85, 1.5	LINE2  1.7, 0, 1.7, 1.5	LINE2  2.85, 0, 2.85, 1.5	LINE2  4.0, 0, 4.0, 1.5	LINE2  5.5, 0, 5.5, 1.5	LINE2  6.5, 0, 6.5, 1.5	LINE2  0.0, 0.5, 6.5, 0.5	SET STYLE "текст20-5"	PEN pen_text	TEXT2  18,1.25,"Лист"	SET STYLE "текст25-5"	TEXT2  18,0.5,sheet_id	IF is_position = 1 THEN			if tis_position and not(_bERROR) and diff_type_tabe=0 then 				TEXT2 12,1.1,"<NOTES>" + ". Арх. " + position_info[1][2] + ". <SUBSETID>"				endif			ELSE		TEXT2  12.1,0.7,shifr	ENDIF	SET STYLE "текст18-5"	TEXT2  0.45, 0.25, "Изм."	TEXT2  1.30, 0.25, "Кол.уч."	TEXT2  2.3, 0.25, "Лист"	TEXT2  3.4, 0.25, "№ док."	TEXT2  4.8, 0.25, "Подп."	TEXT2  6.0, 0.25, "Дата"	TEXT2  16.5, -0.3, "Формат " + format	FOR y = 0 TO 1.5 STEP 0.5		HOTSPOT2 0.0, y		HOTSPOT2 0.85, y		HOTSPOT2 1.7, y		HOTSPOT2 2.85, y		HOTSPOT2 4.0, y		HOTSPOT2 5.5, y		HOTSPOT2 6.5, y	NEXT y	HOTSPOT2 18.5, 1	HOTSPOT2 18.5, 1.5	HOTSPOT2 17.5, 0	HOTSPOT2 17.5, 1	HOTSPOT2 17.5, 1.5RETURN"table_type_98":	HOTSPOT2 0 , 0	HOTSPOT2 hsh, lsh	HOTSPOT2 hsh, 0	HOTSPOT2 0, lshif tis_position and not(_bERROR) then 	! Подписи	if vardim1(change_info) > 0 THEN		SET STYLE "текст20-5"		TEXT2 2.8,18.2, change_info[vardim1(change_info)][3]		TEXT2 4.2,18.45, "Изм.    ."		TEXT2 4.55,18.45, change_info[vardim1(change_info)][1]		ADD2	6, 7.8		surname = change_info[vardim1(change_info)][4] : gosub "signature"		ADD2	0.3, -1.1		surname = change_info[vardim1(change_info)][4] : gosub "signature"	ELSE		SET STYLE "текст20-5"		TEXT2 2.8,18.2, "1"		ADD2	6, 7.8		surname = position_info[1][2] : gosub "signature"		ADD2	0.3, -1.1		surname = position_info[1][2] : gosub "signature"			ENDIF	ADD2	0.5, -1.0	surname = position_info[6][2] : gosub "signature"endifRETURN"table_type_10":	pen SYMB_VIEW_PEN	ADD2 hsh-19, 0.5	hotspot2 13.5, 1.5	hotspot2 0, 0	hotspot2 0, 1.5+(tn_change-2)*0.5*(tn_change>2)	hotspot2 0, 1.5	hotspot2 18.5,1.5	hotspot2 1.7, 0	hotspot2 1.7, 1.5+(tn_change-2)*0.5*(tn_change>2)	hotspot2 4, 0	hotspot2 4, 1.5+(tn_change-2)*0.5*(tn_change>2)	hotspot2 5.5, 0	hotspot2 5.5, 1.5+(tn_change-2)*0.5*(tn_change>2)	hotspot2 6.5, 0	hotspot2 6.5, 1.5+(tn_change-2)*0.5*(tn_change>2)	hotspot2 6.5, 1.5	hotspot2 18.5, 1.5	pen pen_osn	LINE2  0, 0, 0, 1.5+(tn_change-2)*0.5*(tn_change>2)	LINE2  6.5, 1.5 ,18.5,1.5	LINE2  1.7, 0, 1.7, 1.5+(tn_change-2)*0.5*(tn_change>2)	LINE2  4, 0, 4, 1.5+(tn_change-2)*0.5*(tn_change>2)	LINE2  5.5, 0, 5.5, 1.5+(tn_change-2)*0.5*(tn_change>2)	LINE2  6.5, 0, 6.5, 1.5+(tn_change-2)*0.5*(tn_change>2)	LINE2  17.5, 0 ,17.5,1.5	LINE2  17.5, 1 ,18.5,1	SET STYLE "текст20-5"	PEN pen_text	TEXT2  18,1.25,"Лист"	SET STYLE "текст25-5"	TEXT2  18,0.5,sheet_id	SET STYLE "текст50-5"	TEXT2  12,0.75,shifr	SET STYLE "текст25-5"	upper_bound = 1.5	start_change = 0	gosub "position"RETURN"dop_graph":	pen pen_osn	LINE2  0.8, 0.5, 0.8, 9	LINE2  1.3, 0.5, 1.3, 9	LINE2  0.8, 0.5, 2, .5	LINE2  0.8, 3, 2, 3	LINE2  0.8, 6.5, 2, 6.5	LINE2  0.8, 9, 2, 9	SET STYLE "текст20-5"	PEN pen_text	ADD2 1.05, 1.5	ROT2 90	TEXT2  0, 0, " Инв. N подл."	TEXT2  3,0," Подпись и дата"	TEXT2  6,0,"   Взамен инв. N"	DEL  2return"agreed":	rot2 90	add2 9,-2	ngragr=1	if tis_position and not(_bERROR) then ngragr =  max(1,round_int((vardim1(agreed_info)-2)/3)+2)	pen pen_small	line2 0,0.5,ngragr*6.5,0.5	line2 6.5,1,ngragr*6.5,1	pen pen_osn	line2 6.5,1,0,1	line2 0,1.5,ngragr*6.5,1.5	line2 0,0,ngragr*6.5,0	line2 0,0,0,1.5	line2 2,0,2,1	line2 4,0,4,1	line2 5.5,0,5.5,1	line2 6.5,0,6.5,1.5	if ngragr>1 then		for i=1 to ngragr-1			line2 2+i*6.5,0,2+i*6.5,1.5			line2 4+i*6.5,0,4+i*6.5,1.5			line2 5.5+i*6.5,0,5.5+i*6.5,1.5			line2 6.5+i*6.5,0,6.5+i*6.5,1.5		next i	endif	SET STYLE "текст20-4"	PEN pen_text	text2 0.05,1.20,"Согласовано"	if tis_position and not(_bERROR) then	nfam = 0	x = 0.75	y = 0	for i=1 to vardim1(agreed_info)		if i=2 then nfam = 3		if nfam>3 then			nfam = 1			y = y + 6.5			x = 1.25		endif		if vartype(agreed_info[i][2]) = 2 then 			if strlen(agreed_info[i][2])>2 then				SET STYLE "текст18-4"				PEN pen_text				TEXT2  0.05+y, x, agreed_info[i][1]				if tis_fam then TEXT2  2.05+y, x, agreed_info[i][2]				if end_date then agreed_info[i][3] = tend_date				if tis_date then TEXT2  5.55+y, x, agreed_info[i][3]				add2 4.0+y, x-0.25				surname = agreed_info[i][2] : gosub "signature"				del 1			endif		endif		nfam = nfam + 1		x = x - 0.5	next i	endif	del 2return"out_boundary":	RECT2 0, 0, hsh, lsh	HOTSPOT2 0 , 0	HOTSPOT2 hsh, lsh	HOTSPOT2 hsh, 0	HOTSPOT2 0, lsh	hotline2 0 , 0, hsh, 0	hotline2 hsh, 0, hsh, lsh	hotline2 hsh, lsh, 0, lsh	hotline2 0, lsh, 0, 0return"inner_boundary":	pen pen_osn	RECT2 2 , 0.5, hsh-.5, lsh-.5	HOTSPOT2 2 , lsh-.5	HOTSPOT2 hsh-.5, lsh-.5	HOTSPOT2 2 , 0.5	HOTSPOT2 hsh-.5, 0.5	HOTline2 2 , lsh-.5, hsh-.5, lsh-.5	HOTline2 hsh-.5, lsh-.5,hsh-.5 , 0.5	HOTline2 2 , 0.5,hsh-.5, 0.5	HOTline2 2 , 0.5,2 , lsh-.5	if is_num then 		add2 hsh-.5-0.2, lsh-.5-0.2		MUL2   1/L,1/L		call "Сквозная нумерация листов" PARAMETERS ALL		del 2	endif	PEN pen_text	SET STYLE "текст25-3"	if format<>"ПРОИЗВОЛЬНЫЙ" then		TEXT2  hsh-.5, .4, "Формат " + format	else		TEXT2  hsh-.5, .4, "Формат " + name_custom	endifreturn"position":	IF type_table < 3 or type_table = 10 then		HOTSPOT2 0, upper_bound+(tn_change-4)*0.5*(tn_change>4)		HOTSPOT2 18.5, upper_bound+(tn_change-4)*0.5*(tn_change>4)		HOTSPOT2 0, 0		HOTSPOT2 18.5, 0		hotspot2 0.85, start_change		hotspot2 0.85, upper_bound+(tn_change-4)*0.5*(tn_change>4)		hotspot2 2.85, start_change		hotspot2 2.85, upper_bound+(tn_change-4)*0.5*(tn_change>4)		pen pen_small		if type_table < 3 then			max_change = 3			max_change_2 = 4		else			max_change = 2			max_change_2 = 2		endif		for x = 0.5 to upper_bound+(tn_change-max_change)*0.5*(tn_change>=max_change) - 0.5 step 0.5			LINE2  0, x, 6.5, x			hotspot2 0, x			hotspot2 6.5, x		next x		pen pen_osn		LINE2  0.85, start_change, 0.85, upper_bound+(tn_change-max_change_2)*0.5*(tn_change>max_change_2)		LINE2  2.85, start_change, 2.85, upper_bound+(tn_change-max_change_2)*0.5*(tn_change>max_change_2)		pen pen_osn		LINE2  6.5, upper_bound+(tn_change-max_change_2)*0.5*(tn_change>max_change_2), 0, upper_bound+(tn_change-max_change_2)*0.5*(tn_change>max_change_2)		PEN pen_text		SET STYLE "текст18-5"		TEXT2  0.45, start_change + 0.25, "Изм."		TEXT2  1.30, start_change + 0.25, "Кол.уч."		TEXT2  2.3, start_change + 0.25, "Лист"		TEXT2  3.4, start_change + 0.25, "№ док."		TEXT2  4.8, start_change + 0.25, "Подп."		TEXT2  6.0, start_change + 0.25, "Дата"		if _bERROR then			LINE2  0, 0, 18.5, upper_bound			LINE2 18.5, 0, 0, upper_bound		endif		if not(_bfirstchange) and tis_position then			SET STYLE "текст18-5"			i = 0			for x = start_change + 0.75 to upper_bound+(tn_change-max_change_2)*0.5*(tn_change>max_change_2) step 0.5				i = i + 1				if i <= tn_change then					if vartype(change_info[i][2]) = 2 then 						if strlen(change_info[i][2])>-1 then							TEXT2  0.45, x, change_info[i][1]							TEXT2  1.3, x, change_info[i][6]							TEXT2  2.3, x, change_info[i][2]							TEXT2  3.4, x, change_info[i][3]							add2 4.1, x-0.25							surname = change_info[i][4] : gosub "signature"							del 1							if tis_date then TEXT2  6.0, x, change_info[i][5]						endif					endif				endif			next x		endif	endif	if tis_position and not(_bERROR) then 		SET STYLE "текст18-4"		i = 0		for x = 2.75 to 0.25 step -0.5			i = i + 1			if i <= vardim1(position_info) then				if vartype(position_info[i][2]) = 2 then 					if strlen(position_info[i][2])>2 then						PEN pen_text						TEXT2  0.1, x, position_info[i][1]						if tis_fam then TEXT2  1.8, x, position_info[i][2]						SET STYLE "текст18-5"						if end_date then position_info[i][3] = tend_date						if tis_date then TEXT2  6, x, position_info[i][3]						SET STYLE "текст18-4"						add2 4.0, x-0.3						surname = position_info[i][2] : gosub "signature"						del 1					endif				endif			endif		next x	endifreturn"signature":	if tis_autosign then		PEN pen_podp		CALL "Подпись" parameters surname = surname, pen_podp=pen_podp		PEN pen_text	endifreturn