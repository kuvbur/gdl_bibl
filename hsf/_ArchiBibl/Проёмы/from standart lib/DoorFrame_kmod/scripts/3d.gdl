
if gs_pocket & not(gs_pocket_door_frame) then goto "PlacingPockets"

bSimpleOrCHIModel = (lod3D = 1 | lod3D = 5)

bNoRebate_02 = (gs_optype_m_02 = SASH_FIXED					|\
				gs_optype_m_02 = SASH_HOR_PIVOT				|\
				gs_optype_m_02 = SASH_VER_PIVOT				|\
				gs_optype_m_02 = SASH_VER_PIVOT_M			|\
				gs_optype_m_02 = SASH_SLIDING_HOR			|\
				gs_optype_m_02 = SASH_SLIDING_HOR_M			|\
				gs_optype_m_02 = SASH_DOUBLE_SLIDING_HOR	|\
				gs_optype_m_02 = SASH_DOUBLE_SLIDING_HOR_M	|\
				gs_optype_m_02 = SASH_SLIDING_VER			|\
				gs_optype_m_02 = SASH_DOUBLE_SLIDING_VER	)

bNoRebate_09 = (gs_optype_m_09 = SASH_FIXED					|\
				gs_optype_m_09 = SASH_HOR_PIVOT				|\
				gs_optype_m_09 = SASH_VER_PIVOT				|\
				gs_optype_m_09 = SASH_VER_PIVOT_M			|\
				gs_optype_m_09 = SASH_SLIDING_HOR			|\
				gs_optype_m_09 = SASH_SLIDING_HOR_M			|\
				gs_optype_m_09 = SASH_DOUBLE_SLIDING_HOR	|\
				gs_optype_m_09 = SASH_DOUBLE_SLIDING_HOR_M	|\
				gs_optype_m_09 = SASH_SLIDING_VER			|\
				gs_optype_m_09 = SASH_DOUBLE_SLIDING_VER	)

bNoRebate_10 = (gs_optype_m_10 = SASH_FIXED					|\
				gs_optype_m_10 = SASH_HOR_PIVOT				|\
				gs_optype_m_10 = SASH_VER_PIVOT				|\
				gs_optype_m_10 = SASH_VER_PIVOT_M			|\
				gs_optype_m_10 = SASH_SLIDING_HOR			|\
				gs_optype_m_10 = SASH_SLIDING_HOR_M			|\
				gs_optype_m_10 = SASH_DOUBLE_SLIDING_HOR	|\
				gs_optype_m_10 = SASH_DOUBLE_SLIDING_HOR_M	|\
				gs_optype_m_10 = SASH_SLIDING_VER			|\
				gs_optype_m_10 = SASH_DOUBLE_SLIDING_VER	)

bNoRebate_11 = (gs_optype_m_11 = SASH_FIXED					|\
				gs_optype_m_11 = SASH_HOR_PIVOT				|\
				gs_optype_m_11 = SASH_VER_PIVOT				|\
				gs_optype_m_11 = SASH_VER_PIVOT_M			|\
				gs_optype_m_11 = SASH_SLIDING_HOR			|\
				gs_optype_m_11 = SASH_SLIDING_HOR_M			|\
				gs_optype_m_11 = SASH_DOUBLE_SLIDING_HOR	|\
				gs_optype_m_11 = SASH_DOUBLE_SLIDING_HOR_M	|\
				gs_optype_m_11 = SASH_SLIDING_VER			|\
				gs_optype_m_11 = SASH_DOUBLE_SLIDING_VER	)

bNoRebate_05 = (gs_optype_m_05 = SASH_FIXED					|\
				gs_optype_m_05 = SASH_HOR_PIVOT				|\
				gs_optype_m_05 = SASH_VER_PIVOT				|\
				gs_optype_m_05 = SASH_VER_PIVOT_M			|\
				gs_optype_m_05 = SASH_SLIDING_HOR			|\
				gs_optype_m_05 = SASH_SLIDING_HOR_M			|\
				gs_optype_m_05 = SASH_DOUBLE_SLIDING_HOR	|\
				gs_optype_m_05 = SASH_DOUBLE_SLIDING_HOR_M	|\
				gs_optype_m_05 = SASH_SLIDING_VER			|\
				gs_optype_m_05 = SASH_DOUBLE_SLIDING_VER	)

bNoRebate_06 = (gs_optype_m_06 = SASH_FIXED					|\
				gs_optype_m_06 = SASH_HOR_PIVOT				|\
				gs_optype_m_06 = SASH_VER_PIVOT				|\
				gs_optype_m_06 = SASH_VER_PIVOT_M			|\
				gs_optype_m_06 = SASH_SLIDING_HOR			|\
				gs_optype_m_06 = SASH_SLIDING_HOR_M			|\
				gs_optype_m_06 = SASH_DOUBLE_SLIDING_HOR	|\
				gs_optype_m_06 = SASH_DOUBLE_SLIDING_HOR_M	|\
				gs_optype_m_06 = SASH_SLIDING_VER			|\
				gs_optype_m_06 = SASH_DOUBLE_SLIDING_VER	)

bNoRebate_07 = (gs_optype_m_07 = SASH_FIXED					|\
				gs_optype_m_07 = SASH_HOR_PIVOT				|\
				gs_optype_m_07 = SASH_VER_PIVOT				|\
				gs_optype_m_07 = SASH_VER_PIVOT_M			|\
				gs_optype_m_07 = SASH_SLIDING_HOR			|\
				gs_optype_m_07 = SASH_SLIDING_HOR_M			|\
				gs_optype_m_07 = SASH_DOUBLE_SLIDING_HOR	|\
				gs_optype_m_07 = SASH_DOUBLE_SLIDING_HOR_M	|\
				gs_optype_m_07 = SASH_SLIDING_VER			|\
				gs_optype_m_07 = SASH_DOUBLE_SLIDING_VER	)

bUniformMaterials = (gs_frame_mat = gs_frame_mat2)
if bUniformMaterials then
	offsetEPS = 0
else
	offsetEPS = 0.0001
endif

! Leaf
if gs_frame_style_m = FRAME_STYLE_DOUBLE_REBATE then
	offset_leaf = offsetEPS
else
	offset_leaf = 0
endif

! Transom
if gs_optype_m_02 = SASH_FIXED | iMullionStyle_02 = MULLION_SOLID_PANEL then
	offset_02 = offsetEPS
else
	if bSimpleOrCHIModel then
		if bNoRebate_02 then
			offset_02 = gs_sash_width + offsetEPS
		else
			offset_02 = gs_sash_width - gs_sidelight_rebate_width + offsetEPS
		endif
	else
		if bNoRebate_02 then
			offset_02 = offsetEPS
		else
			offset_02 = 0
		endif
	endif
endif

! Left Sidelight
if gs_optype_m_09 = SASH_FIXED | iMullionStyle_09 = MULLION_SOLID_PANEL then
	offset_09 = offsetEPS
else
	if bSimpleOrCHIModel then
		if bNoRebate_09 then
			offset_09 = gs_sl_sash_width + offsetEPS
		else
			offset_09 = gs_sl_sash_width - gs_sidelight_rebate_width + offsetEPS
		endif
	else
		if bNoRebate_09 then
			offset_09 = offsetEPS
		else
			offset_09 = 0
		endif
	endif
endif

! Left Upper Sidelight
if gs_optype_m_10 = SASH_FIXED | iMullionStyle_10 = MULLION_SOLID_PANEL then
	offset_10 = offsetEPS
else
	if bSimpleOrCHIModel then
		if bNoRebate_10 then
			offset_10 = gs_sash_width + offsetEPS
		else
			offset_10 = gs_sash_width - gs_sidelight_rebate_width + offsetEPS
		endif
	else
		if bNoRebate_10 then
			offset_10 = offsetEPS
		else
			offset_10 = 0
		endif
	endif
endif

! Left Lower Sidelight
if gs_optype_m_11 = SASH_FIXED | iMullionStyle_11 = MULLION_SOLID_PANEL then
	offset_11 = offsetEPS
else
	if bSimpleOrCHIModel then
		if bNoRebate_11 then
			offset_11 = gs_sl_sash_width + offsetEPS
		else
			offset_11 = gs_sl_sash_width - gs_sidelight_rebate_width + offsetEPS
		endif
	else
		if bNoRebate_11 then
			offset_11 = offsetEPS
		else
			offset_11 = 0
		endif
	endif
endif

! Right Sidelight
if gs_optype_m_05 = SASH_FIXED | iMullionStyle_05 = MULLION_SOLID_PANEL then
	offset_05 = offsetEPS
else
	if bSimpleOrCHIModel then
		if bNoRebate_05 then
			offset_05 = gs_sl_sash_width + offsetEPS
		else
			offset_05 = gs_sl_sash_width - gs_sidelight_rebate_width + offsetEPS
		endif
	else
		if bNoRebate_05 then
			offset_05 = offsetEPS
		else
			offset_05 = 0
		endif
	endif
endif

! Right Upper Sidelight
if gs_optype_m_06 = SASH_FIXED | iMullionStyle_06 = MULLION_SOLID_PANEL then
	offset_06 = offsetEPS
else
	if bSimpleOrCHIModel then
		if bNoRebate_06 then
			offset_06 = gs_sash_width + offsetEPS
		else
			offset_06 = gs_sash_width - gs_sidelight_rebate_width + offsetEPS
		endif
	else
		if bNoRebate_06 then
			offset_06 = offsetEPS
		else
			offset_06 = 0
		endif
	endif
endif

! Right Lower Sidelight
if gs_optype_m_07 = SASH_FIXED | iMullionStyle_07 = MULLION_SOLID_PANEL then
	offset_07 = offsetEPS
else
	if bSimpleOrCHIModel then
		if bNoRebate_07 then
			offset_07 = gs_sl_sash_width + offsetEPS
		else
			offset_07 = gs_sl_sash_width - gs_sidelight_rebate_width + offsetEPS
		endif
	else
		if bNoRebate_07 then
			offset_07 = offsetEPS
		else
			offset_07 = 0
		endif
	endif
endif

! =============================================================================

if bSimpleOrCHIModel then
	iSimpleSashFrameType_02 = SIMPLESASH_NORMAL
	if iMullionStyle_02 <> MULLION_SOLID_PANEL then
		if	gs_optype_m_02 = SASH_DOUBLE_SIDE_HUNG |\
			gs_optype_m_02 = SASH_DOUBLE_TILT_TURN |\
			gs_optype_m_02 = SASH_DOUBLE_TILT_TURN_M then iSimpleSashFrameType_02 = SIMPLESASH_SIDEHUNG
		if	gs_optype_m_02 = SASH_SLIDING_HOR |\
			gs_optype_m_02 = SASH_SLIDING_HOR_M |\
			gs_optype_m_02 = SASH_DOUBLE_SLIDING_HOR |\
			gs_optype_m_02 = SASH_DOUBLE_SLIDING_HOR_M then iSimpleSashFrameType_02 = SIMPLESASH_SLIDEHOR
		if	gs_optype_m_02 = SASH_SLIDING_VER |\
			gs_optype_m_02 = SASH_DOUBLE_SLIDING_VER then iSimpleSashFrameType_02 = SIMPLESASH_SLIDEVER
	endif

	iSimpleSashFrameType_09 = SIMPLESASH_NORMAL
	if iMullionStyle_09 <> MULLION_SOLID_PANEL then
		if	gs_optype_m_09 = SASH_DOUBLE_SIDE_HUNG |\
			gs_optype_m_09 = SASH_DOUBLE_TILT_TURN |\
			gs_optype_m_09 = SASH_DOUBLE_TILT_TURN_M then iSimpleSashFrameType_09 = SIMPLESASH_SIDEHUNG
		if	gs_optype_m_09 = SASH_SLIDING_HOR |\
			gs_optype_m_09 = SASH_SLIDING_HOR_M |\
			gs_optype_m_09 = SASH_DOUBLE_SLIDING_HOR |\
			gs_optype_m_09 = SASH_DOUBLE_SLIDING_HOR_M then iSimpleSashFrameType_09 = SIMPLESASH_SLIDEHOR
		if	gs_optype_m_09 = SASH_SLIDING_VER |\
			gs_optype_m_09 = SASH_DOUBLE_SLIDING_VER then iSimpleSashFrameType_09 = SIMPLESASH_SLIDEVER
	endif

	iSimpleSashFrameType_10 = SIMPLESASH_NORMAL
	if iMullionStyle_10 <> MULLION_SOLID_PANEL then
		if	gs_optype_m_10 = SASH_DOUBLE_SIDE_HUNG |\
			gs_optype_m_10 = SASH_DOUBLE_TILT_TURN |\
			gs_optype_m_10 = SASH_DOUBLE_TILT_TURN_M then iSimpleSashFrameType_10 = SIMPLESASH_SIDEHUNG
		if	gs_optype_m_10 = SASH_SLIDING_HOR |\
			gs_optype_m_10 = SASH_SLIDING_HOR_M |\
			gs_optype_m_10 = SASH_DOUBLE_SLIDING_HOR |\
			gs_optype_m_10 = SASH_DOUBLE_SLIDING_HOR_M then iSimpleSashFrameType_10 = SIMPLESASH_SLIDEHOR
		if	gs_optype_m_10 = SASH_SLIDING_VER |\
			gs_optype_m_10 = SASH_DOUBLE_SLIDING_VER then iSimpleSashFrameType_10 = SIMPLESASH_SLIDEVER
	endif

	iSimpleSashFrameType_11 = SIMPLESASH_NORMAL
	if iMullionStyle_11 <> MULLION_SOLID_PANEL then
		if	gs_optype_m_11 = SASH_DOUBLE_SIDE_HUNG |\
			gs_optype_m_11 = SASH_DOUBLE_TILT_TURN |\
			gs_optype_m_11 = SASH_DOUBLE_TILT_TURN_M then iSimpleSashFrameType_11 = SIMPLESASH_SIDEHUNG
		if	gs_optype_m_11 = SASH_SLIDING_HOR |\
			gs_optype_m_11 = SASH_SLIDING_HOR_M |\
			gs_optype_m_11 = SASH_DOUBLE_SLIDING_HOR |\
			gs_optype_m_11 = SASH_DOUBLE_SLIDING_HOR_M then iSimpleSashFrameType_11 = SIMPLESASH_SLIDEHOR
		if	gs_optype_m_11 = SASH_SLIDING_VER |\
			gs_optype_m_11 = SASH_DOUBLE_SLIDING_VER then iSimpleSashFrameType_11 = SIMPLESASH_SLIDEVER
	endif

	iSimpleSashFrameType_05 = SIMPLESASH_NORMAL
	if iMullionStyle_05 <> MULLION_SOLID_PANEL then
		if	gs_optype_m_05 = SASH_DOUBLE_SIDE_HUNG |\
			gs_optype_m_05 = SASH_DOUBLE_TILT_TURN |\
			gs_optype_m_05 = SASH_DOUBLE_TILT_TURN_M then iSimpleSashFrameType_05 = SIMPLESASH_SIDEHUNG
		if	gs_optype_m_05 = SASH_SLIDING_HOR |\
			gs_optype_m_05 = SASH_SLIDING_HOR_M |\
			gs_optype_m_05 = SASH_DOUBLE_SLIDING_HOR |\
			gs_optype_m_05 = SASH_DOUBLE_SLIDING_HOR_M then iSimpleSashFrameType_05 = SIMPLESASH_SLIDEHOR
		if	gs_optype_m_05 = SASH_SLIDING_VER |\
			gs_optype_m_05 = SASH_DOUBLE_SLIDING_VER then iSimpleSashFrameType_05 = SIMPLESASH_SLIDEVER
	endif

	iSimpleSashFrameType_06 = SIMPLESASH_NORMAL
	if iMullionStyle_06 <> MULLION_SOLID_PANEL then
		if	gs_optype_m_06 = SASH_DOUBLE_SIDE_HUNG |\
			gs_optype_m_06 = SASH_DOUBLE_TILT_TURN |\
			gs_optype_m_06 = SASH_DOUBLE_TILT_TURN_M then iSimpleSashFrameType_06 = SIMPLESASH_SIDEHUNG
		if	gs_optype_m_06 = SASH_SLIDING_HOR |\
			gs_optype_m_06 = SASH_SLIDING_HOR_M |\
			gs_optype_m_06 = SASH_DOUBLE_SLIDING_HOR |\
			gs_optype_m_06 = SASH_DOUBLE_SLIDING_HOR_M then iSimpleSashFrameType_06 = SIMPLESASH_SLIDEHOR
		if	gs_optype_m_06 = SASH_SLIDING_VER |\
			gs_optype_m_06 = SASH_DOUBLE_SLIDING_VER then iSimpleSashFrameType_06 = SIMPLESASH_SLIDEVER
	endif

	iSimpleSashFrameType_07 = SIMPLESASH_NORMAL
	if iMullionStyle_07 <> MULLION_SOLID_PANEL then
		if	gs_optype_m_07 = SASH_DOUBLE_SIDE_HUNG |\
			gs_optype_m_07 = SASH_DOUBLE_TILT_TURN |\
			gs_optype_m_07 = SASH_DOUBLE_TILT_TURN_M then iSimpleSashFrameType_07 = SIMPLESASH_SIDEHUNG
		if	gs_optype_m_07 = SASH_SLIDING_HOR |\
			gs_optype_m_07 = SASH_SLIDING_HOR_M |\
			gs_optype_m_07 = SASH_DOUBLE_SLIDING_HOR |\
			gs_optype_m_07 = SASH_DOUBLE_SLIDING_HOR_M then iSimpleSashFrameType_07 = SIMPLESASH_SLIDEHOR
		if	gs_optype_m_07 = SASH_SLIDING_VER |\
			gs_optype_m_07 = SASH_DOUBLE_SLIDING_VER then iSimpleSashFrameType_07 = SIMPLESASH_SLIDEVER
	endif
else
	iSimpleSashFrameType_02 = SIMPLESASH_NONE
	iSimpleSashFrameType_09 = SIMPLESASH_NONE
	iSimpleSashFrameType_10 = SIMPLESASH_NONE
	iSimpleSashFrameType_11 = SIMPLESASH_NONE
	iSimpleSashFrameType_05 = SIMPLESASH_NONE
	iSimpleSashFrameType_06 = SIMPLESASH_NONE
	iSimpleSashFrameType_07 = SIMPLESASH_NONE
endif

! =============================================================================

bNeedCutting = (bNeedCutting & (gs_frame_style_m <> FRAME_STYLE_METAL) & (gs_frame_style_m <> FRAME_STYLE_WRAPPED_EXTRUSION))

if bNeedCutting then
	if gs_frame_thk > EPS then
		cutDxLeft = max(gs_frame_ovhg_left_out, gs_frame_ovhg_left_in)
		addx -ac_unit_width/2 - gs_frame_ovhg_left_out
		roty 90 + atn((gs_frame_ovhg_left_out - gs_frame_ovhg_left_in) / gs_frame_thk)
		cutplane{2} 180, 3+4*gs_stack_left
		del 2

		cutDxRight = max(gs_frame_ovhg_right_out, gs_frame_ovhg_right_in)
		addx ac_unit_width/2 + gs_frame_ovhg_right_out
		roty 90 - atn((gs_frame_ovhg_right_out - gs_frame_ovhg_right_in) / gs_frame_thk)
		CUTPLANE{2} 0, 3+4*gs_stack_right
		del 2

		cutDy = max(gs_frame_ovhg_top_out, gs_frame_ovhg_top_in)
		addy ac_unit_height + gs_frame_ovhg_top_out
		rotz 90
		roty 90 - atn((gs_frame_ovhg_top_out - gs_frame_ovhg_top_in) / gs_frame_thk)
		CUTPLANE{2} 0, 3+4*gs_stack_top
		del 3
	else
		cutDxLeft	= gs_frame_ovhg_left_out
		cutDxRight	= gs_frame_ovhg_right_out
		cutDy		= gs_frame_ovhg_top_out
	endif
else
	cutDxLeft	= 0
	cutDxRight	= 0
	cutDy		= 0
endif

sect_fill fr_sect_fill_type, fr_sect_fill_bg, fr_sect_fill_fg, gs_frame_pen_cont
material gs_frame_mat
pen gs_frame_pen

resol res

outsideFrameThk	= gs_frame_thk
if gs_frame_wthk then
	if gs_sframe | lod3D = 5 then	! Uniform Frame Depth or CHI model
		insideFrameThk	= gs_frame_thk
	else
		insideFrameThk	= gs_frame_thkin
	endif
else
	insideFrameThk	= gs_frame_thk
endif

if abs(outsideFrameThk - insideFrameThk) < EPS then
	mmask=10
	mmask2=10
else
	mmask=12
	mmask2=14
endif

resol nArchResolution

Diff_extra = (gs_unit_extra_right - gs_unit_extra_left)

numCuts = 0
! ------------------------------------------------------------------------------
! Unit hotspots
! ------------------------------------------------------------------------------

if bShowUnitHotspots then
	addx Diff_extra
	if bArchedTop then
		hotspot -A/2 + gs_unit_extra_left + gs_frame_oversize, 0, 0, 100
		hotspot  A/2 - gs_unit_extra_right - gs_frame_oversize, 0, 0, 101
		hotspot -A/2 + gs_unit_extra_left + gs_frame_oversize, 0, outsideFrameThk, 102
		hotspot  A/2 - gs_unit_extra_right, 0, outsideFrameThk, 103

		hotspot -A/2 + gs_unit_extra_left + gs_frame_oversize, gs_shoulder_h, 0, 104
		hotspot  A/2 - gs_unit_extra_right - gs_frame_oversize, gs_shoulder_h, 0, 105
		hotspot -A/2 + gs_unit_extra_left + gs_frame_oversize, gs_shoulder_h, outsideFrameThk, 106
		hotspot  A/2 - gs_unit_extra_right, gs_shoulder_h, outsideFrameThk, 107

		hotspot 0, B, 0, 108
		hotspot 0, B, outsideFrameThk, 109
	else
		hotspot -A/2 + gs_unit_extra_left + gs_frame_oversize, 0, -comy, 100
		hotspot  A/2 - gs_unit_extra_right - gs_frame_oversize, 0, -comy, 101
		hotspot -A/2 + gs_unit_extra_left + gs_frame_oversize, 0, outsideFrameThk + comy, 102
		hotspot  A/2 - gs_unit_extra_right, 0, outsideFrameThk + comy, 103

		hotspot -A/2 + gs_unit_extra_left + gs_frame_oversize, b - gs_frame_oversize, -comy, 104
		hotspot  A/2 - gs_unit_extra_right - gs_frame_oversize, b - gs_frame_oversize, -comy, 105
		hotspot -A/2 + gs_unit_extra_left + gs_frame_oversize, b - gs_frame_oversize, outsideFrameThk + comy, 106
		hotspot  A/2 - gs_unit_extra_right - gs_frame_oversize, b - gs_frame_oversize, outsideFrameThk + comy, 107
	endif
	del 1
endif


!********** Shoulder Height Editing

if bArchedTop then
	addx Diff_extra
	hotspot -A/2 + gs_unit_extra_left + gs_frame_oversize,	gs_shoulder_h,	0, 2000, gs_shoulder_h, 2
	hotspot -A/2 + gs_unit_extra_left + gs_frame_oversize,	0,				0, 2001, gs_shoulder_h, 1+128
	hotspot -A/2 + gs_unit_extra_left + gs_frame_oversize,	-1,				0, 2002, gs_shoulder_h, 3

	hotspot A/2 - gs_unit_extra_right - gs_frame_oversize,	gs_shoulder_h,	0, 2003, gs_shoulder_h, 2
	hotspot A/2 - gs_unit_extra_right - gs_frame_oversize,	0,				0, 2004, gs_shoulder_h, 1+128
	hotspot A/2 - gs_unit_extra_right - gs_frame_oversize,	-1,				0, 2005, gs_shoulder_h, 3
	del 1
endif

if WIDO_REVEAL_SIDE then
	! Flip Corrections

	topmat=gs_frame_mat
	botmat=gs_frame_mat2
	sidemat=gs_frame_mat
else
	!*** default placement

	topmat=gs_frame_mat2
	botmat=gs_frame_mat
	sidemat=gs_frame_mat2
endif

if gs_door_transom then
	addx Diff_extra
	!*** Hotspot Editing of Transom

	hotspot -A/2 + gs_unit_extra_left + gs_frame_oversize, B-gs_frame_oversize, -comy, 1300, gs_transom_height, 1+128
	hotspot -A/2 + gs_unit_extra_left + gs_frame_oversize, B-gs_frame_oversize+1, -comy, 1301, gs_transom_height, 3
	hotspot -A/2 + gs_unit_extra_left + gs_frame_oversize, B-gs_frame_oversize-gs_transom_height, -comy, 1302, gs_transom_height, 2

	hotspot A/2 - gs_unit_extra_right - gs_frame_oversize, B-gs_frame_oversize, -comy, 1310, gs_transom_height, 1+128
	hotspot A/2 - gs_unit_extra_right - gs_frame_oversize, B-gs_frame_oversize+1, -comy, 1311, gs_transom_height, 3
	hotspot A/2 - gs_unit_extra_right - gs_frame_oversize, B-gs_frame_oversize-gs_transom_height, -comy, 1312, gs_transom_height, 2

	if bTransomHeightEditOnTop then
		hotspot 0, ac_egress_height, -comy, 1360, gs_transom_height_top, 1+128
		hotspot 0, ac_egress_height-1, -comy, 1361, gs_transom_height_top, 3
		hotspot 0, ac_egress_height+gs_transom_height_top, -comy, 1362, gs_transom_height_top, 2
	endif
	del 1
endif

if gs_door_transom then
	htpsHeight = B-_transomHeight
else
	htpsHeight = B
endif

!*** Hotspot Editing of Left SideLight

if gs_sidelight_left then
	addx Diff_extra
	hotspot -A/2 + gs_unit_extra_left + gs_frame_oversize, 0, -comy, 1320, gs_sidelight_width_left, 1+128
	hotspot -A/2 + gs_unit_extra_left + gs_frame_oversize-1, 0, -comy, 1321, gs_sidelight_width_left, 3
	hotspot -A/2 + gs_unit_extra_left + gs_frame_oversize+gs_sidelight_width_left, 0, -comy, 1322, gs_sidelight_width_left, 2

	hotspot -A/2 + gs_unit_extra_left + gs_frame_oversize, htpsHeight, -comy, 1330, gs_sidelight_width_left, 1+128
	hotspot -A/2 + gs_unit_extra_left + gs_frame_oversize-1, htpsHeight, -comy, 1331, gs_sidelight_width_left, 3
	hotspot -A/2 + gs_unit_extra_left + gs_frame_oversize+gs_sidelight_width_left, htpsHeight, -comy, 1332, gs_sidelight_width_left, 2

	if gs_bSidelight_fr_hdiv_left then
		hotspot -A/2 + gs_unit_extra_left + gs_frame_oversize, 0, -comy, 1370, gs_sidelight_fr_hdiv_hgt_left, 1+128
		hotspot -A/2 + gs_unit_extra_left + gs_frame_oversize, -1, -comy, 1371, gs_sidelight_fr_hdiv_hgt_left, 3
		hotspot -A/2 + gs_unit_extra_left + gs_frame_oversize, gs_sidelight_fr_hdiv_hgt_left, -comy, 1372, gs_sidelight_fr_hdiv_hgt_left, 2
	endif
	del 1
endif

!!! *** Hotspot Editing of Right SideLight

if gs_sidelight_right then
	addx Diff_extra
	hotspot A/2 - gs_unit_extra_right - gs_frame_oversize, 0, -comy, 1340, gs_sidelight_width_right, 1+128
	hotspot A/2 - gs_unit_extra_right - gs_frame_oversize+1, 0, -comy, 1341, gs_sidelight_width_right, 3
	hotspot A/2 - gs_unit_extra_right - gs_frame_oversize-gs_sidelight_width_right, 0, -comy, 1342, gs_sidelight_width_right, 2

	hotspot A/2 - gs_unit_extra_right - gs_frame_oversize, htpsHeight, -comy, 1350, gs_sidelight_width_right, 1+128
	hotspot A/2 - gs_unit_extra_right - gs_frame_oversize+1, htpsHeight, -comy, 1351, gs_sidelight_width_right, 3
	hotspot A/2 - gs_unit_extra_right - gs_frame_oversize-gs_sidelight_width_right, htpsHeight, -comy, 1352, gs_sidelight_width_right, 2

	if gs_bSidelight_fr_hdiv_right then
		hotspot A/2 - gs_unit_extra_right - gs_frame_oversize, 0, -comy, 1380, gs_sidelight_fr_hdiv_hgt_right, 1+128
		hotspot A/2 - gs_unit_extra_right - gs_frame_oversize, -1, -comy, 1381, gs_sidelight_fr_hdiv_hgt_right, 3
		hotspot A/2 - gs_unit_extra_right - gs_frame_oversize, gs_sidelight_fr_hdiv_hgt_right, -comy, 1382, gs_sidelight_fr_hdiv_hgt_right, 2
	endif
	del 1
endif

!***********************************************************

if bArchedTop & not(gs_door_transom) then
	if	gs_frame_style_m = FRAME_STYLE_SIMPLE_REBATE		|\
 		gs_frame_style_m = FRAME_STYLE_EXTRUSION			|\
		gs_frame_style_m = FRAME_STYLE_WRAPPED_EXTRUSION	then
		rebateWidth = gs_rebate_width
	else
		rebateWidth = offsetEPS
	endif
else
	if bSimpleOrCHIModel then
		rebateWidth = offsetEPS
	else
		if gs_optype_m_02 = SASH_FIXED then
			rebateWidth = offsetEPS
		else
			if bNoRebate_02 then
				rebateWidth = offsetEPS
			else
				rebateWidth = gs_sidelight_rebate_width
			endif
		endif
	endif
endif

if gs_LeftMullion_Top then
	trans_Left = -A/2+gs_sl_w1-rebateWidth+offset_02
else
	trans_Left = -A/2+gs_frw1-rebateWidth+offset_02
endif

if gs_RightMullion_Top then
	trans_Right = A/2-gs_sl_w2+rebateWidth-offset_02
else
	trans_Right = A/2-gs_frw2+rebateWidth-offset_02
endif

!********************* coordinates according to size types

unitleft	= -ac_unit_width / 2
unitright	=  ac_unit_width / 2
leafleft	= -ac_leaf_width / 2 + ((gs_sl_w1 - gs_frw1) / 2)*gs_sidelight_left - ((gs_sl_w2 - gs_frw2) / 2)*gs_sidelight_right
leafright	=  ac_leaf_width / 2 + ((gs_sl_w1 - gs_frw1) / 2)*gs_sidelight_left - ((gs_sl_w2 - gs_frw2) / 2)*gs_sidelight_right
frameDiff	= (gs_frw1 - gs_frw2) / 2
egressDiff 	= (gs_sliding_fixpanel_width_left-gs_sliding_fixpanel_width_right)/2

if gs_pivotdoor then
	egressleft = -ac_unit_width / 2 + gs_frw1 - frameDiff
	egressright = ac_unit_width / 2 - gs_frw2 - gs_pivotOffset - gs_leaf_thk/2 - frameDiff
else
	egressleft = -ac_egress_width / 2 + ((gs_sl_w1 - gs_frw1) / 2)*gs_sidelight_left - ((gs_sl_w2 - gs_frw2) / 2)*gs_sidelight_right + egressDiff
	egressright = ac_egress_width / 2 + ((gs_sl_w1 - gs_frw1) / 2)*gs_sidelight_left - ((gs_sl_w2 - gs_frw2) / 2)*gs_sidelight_right + egressDiff
endif

unittop = ac_unit_height
leaftop = ac_leaf_height

frameleft = unitleft - cutDxLeft * not(bEnableJointMat)
frameright = unitright + cutDxRight * not(bEnableJointMat)
frametop = unittop + cutDy * not(bEnableJointMat)

if gs_frame_style_m = FRAME_STYLE_WRAPPED_EXTRUSION then
	ace = frameright + gs_tolerance_left - gs_frame_oversize
	bce = frametop + gs_tolerance_left - gs_frame_oversize - gs_shoulder_h

	if bce > EPS then
		r2=(ace^2+bce^2)/(2*bce)
		fce=sqr(r2^2-ace^2)
		fce_frame_oversize	= sqr((r2 - gs_tolerance_left + gs_frame_oversize)^2 - (ace - gs_tolerance_left + gs_frame_oversize)^2)
		gs_shoulder_h = gs_shoulder_h - (fce - fce_frame_oversize)
	endif

	gs_tolerance_left			= 0
	gs_tolerance_left_2			= 0
	gs_tolerance_low_left_sl	= 0
	gs_tolerance_right 			= 0
	gs_tolerance_right_2		= 0
	gs_tolerance_low_right_sl	= 0
endif

!! CURVED TOP CALCULATION !!
ace = frameright
bce = frametop-gs_shoulder_h

if bce > EPS then
	r2=(ace^2+bce^2)/(2*bce)
	if abs(ace/r2) > (1 - EPS) then r2=r2+0.0000001

	alphace=2*asn(ace/r2)
	alphafw=2*asn((ace-gs_frw2-gs_tolerance_left)/(r2-gs_frw2-gs_tolerance_left))

	fce=sqr(r2^2-ace^2)
	if gs_door_transom then
		fcefw=sqr((r2-gs_frw2-gs_tolerance_left-offset_02)^2-(ace-gs_frw2-gs_tolerance_left-offset_02)^2)
		fce_Sl_rebate=sqr((r2-gs_frw2+rebateWidth-gs_tolerance_left-offset_02)^2-(ace-gs_frw2+rebateWidth-gs_tolerance_left-offset_02)^2)
	else
		fcefw=sqr((r2-gs_frw2-gs_tolerance_left-offset_leaf)^2-(ace-gs_frw2-gs_tolerance_left-offset_leaf)^2)
		fce_Sl_rebate=sqr((r2-gs_frw2+rebateWidth-gs_tolerance_left-offset_leaf)^2-(ace-gs_frw2+rebateWidth-gs_tolerance_left-offset_leaf)^2)
	endif

	fce_frame_rebate	= sqr((r2 - frameRebateWidth - gs_tolerance_left)^2 - (ace - frameRebateWidth - gs_tolerance_left)^2)
	fce_frame_toler		= sqr((r2 - gs_tolerance_left)^2 - (ace - gs_tolerance_left)^2)
	fceds	= sqr((r2-gs_frw2-gs_ds_w)^2-(ace-gs_frw2-gs_ds_w)^2)
	fcerel	= sqr((r2-gs_frw2+gs_rebate_width)^2-(ace-gs_frw2+gs_rebate_width)^2)

	alphads=2*asn((ace)/(r2))
	alpharel=2*asn((ace)/(r2))
	alpha_Sl_rebate = 2*asn((ace-gs_frw2+rebateWidth-gs_tolerance_left-offset_02)/(r2-gs_frw2+rebateWidth-gs_tolerance_left-offset_02))
else
	bArchedTop = 0
endif

if bArchedTop then
	TopHeighty = gs_shoulder_h
	TopHeightInny = gs_shoulder_h-(fce-fcefw)
else
	if gs_SashText_typ_num = 1 then		!Mitered Joint
		TopHeighty = b + cutDy
		TopHeightInny = unittop-gs_frwt
	else
		TopHeighty = unittop-gs_frwt
		TopHeightInny = unittop-gs_frwt
	endif
endif


!! END OF CURVED TOP CALCULATION !!



if bArchedTop then
	if not(gs_door_transom) then
		if gs_frame_style_m = FRAME_STYLE_BLOCK			then egresstop = gs_shoulder_h-(fce-fcefw)
		if gs_frame_style_m = FRAME_STYLE_DOUBLE_REBATE	then egresstop = gs_shoulder_h-(fce-fceds)
		if	gs_frame_style_m = FRAME_STYLE_SIMPLE_REBATE		|\
	 		gs_frame_style_m = FRAME_STYLE_EXTRUSION			|\
			gs_frame_style_m = FRAME_STYLE_WRAPPED_EXTRUSION	then
			egresstop = gs_shoulder_h-(fce-fcefw)
		endif
		if gs_frame_style_m = FRAME_STYLE_BLOCK			then leaftop = gs_shoulder_h-(fce-fcefw)
		if gs_frame_style_m = FRAME_STYLE_DOUBLE_REBATE	then leaftop = gs_shoulder_h-(fce-fcefw)
		if	gs_frame_style_m = FRAME_STYLE_SIMPLE_REBATE		|\
	 		gs_frame_style_m = FRAME_STYLE_EXTRUSION			|\
			gs_frame_style_m = FRAME_STYLE_WRAPPED_EXTRUSION	then
			leaftop = gs_shoulder_h-(fce-fcerel)
		endif
		egressarch = ac_egress_height
		leafarch = ac_leaf_height

	else
		egresstop = ac_egress_height
		leaftop = ac_leaf_height
		egressarch = ac_egress_height
		leafarch = ac_leaf_height
	endif
else
	egresstop = ac_egress_height
endif

bTolL = 1 * (abs(gs_tolerance_left) < EPS)
bTolR = 1 * (abs(gs_tolerance_right) < EPS)
bTolU = 1 * (abs(gs_tolerance_upper) < EPS)

ovhg			= max(gs_frame_ovhg_bottom_out, gs_frame_ovhg_bottom_in)
ovhgBottom		= ovhg * gs_sill_outside
if LeftSLParapet > EPS then
	ovhgBottomLeft	= ovhg * gs_sill_outside_sl_left
else
	ovhgBottomLeft	= 0
	gs_tolerance_low_left_sl = 0
endif
if RightSLParapet > EPS then
	ovhgBottomRight	= ovhg * gs_sill_outside_sl_right
else
	ovhgBottomRight	= 0
	gs_tolerance_low_right_sl = 0
endif


! ------------------------------------------------------------------------------
! Egress hotspots
! ------------------------------------------------------------------------------

if gs_usaframe then
	egressthk1 = -comy
	if gs_frame_style_m = FRAME_STYLE_DOUBLE_REBATE | gs_frame_style_m = FRAME_STYLE_METAL then
		egressthk1 = egressthk1 + gs_ds_pr
	endif
	if gs_frame_style_m = FRAME_STYLE_SIMPLE_REBATE then
		egressthk1 = egressthk1 + gs_leaf_thk
	endif
else
	egressthk1 = gs_leaf_thk - comy
endif
egressthk2 = egressthk1 + gs_ds_thk

if bShowEgressHotspots then
	addx -Diff_extra/2
	if gs_frame_style_m = FRAME_STYLE_BLOCK then
		hotspot egressleft  + frameDiff, egresstop, 0, 210
		hotspot egressright + frameDiff, egresstop, 0, 211
		if not(gs_door_transom) & bArchedTop then hotspot 0, egressarch, 0, 214
	else
		hotspot egressleft  + frameDiff, egresstop, egressthk1, 210
		hotspot egressright + frameDiff, egresstop, egressthk1, 211
		if not(gs_door_transom) & bArchedTop then hotspot 0, egressarch, egressthk1, 214
	endif

	if gs_frame_style_m = FRAME_STYLE_DOUBLE_REBATE | gs_frame_style_m = FRAME_STYLE_METAL then
		hotspot egressleft  + frameDiff, egresstop, egressthk2, 212
		hotspot egressright + frameDiff, egresstop, egressthk2, 213
		if not(gs_door_transom) & bArchedTop then hotspot 0, egressarch, egressthk2, 215
	else
		hotspot egressleft + frameDiff, egresstop, outsideFrameThk, 212
		hotspot egressright + frameDiff, egresstop, outsideFrameThk, 213
		if not(gs_door_transom) & bArchedTop then hotspot 0, egressarch, outsideFrameThk, 215
	endif

	del 1
endif

if bShowAddHotspotsForIS then
	addx -Diff_extra/2
	if bArchedTop then
		if not(gs_door_transom) then
			if gs_frame_style_m = FRAME_STYLE_BLOCK then
				hotspot 0, 0, 0, 204
			else
				hotspot 0, 0, egressthk1, 204
			endif

			if gs_frame_style_m = FRAME_STYLE_DOUBLE_REBATE | gs_frame_style_m = FRAME_STYLE_METAL then
				hotspot 0, 0, egressthk2, 205
			else
				hotspot 0, 0, outsideFrameThk, 205
			endif
		else
			if gs_frame_style_m = FRAME_STYLE_BLOCK then
				hotspot egressleft  + frameDiff, 0, 0, 200
				hotspot egressright + frameDiff, 0, 0, 201
			else
				hotspot egressleft  + frameDiff, 0, egressthk1, 200
				hotspot egressright + frameDiff, 0, egressthk1, 201
			endif

			if gs_frame_style_m = FRAME_STYLE_DOUBLE_REBATE | gs_frame_style_m = FRAME_STYLE_METAL then
				hotspot egressleft  + frameDiff, 0, egressthk2, 202
				hotspot egressright + frameDiff, 0, egressthk2, 203
			else
				hotspot egressleft  + frameDiff, 0, outsideFrameThk, 202
				hotspot egressright + frameDiff, 0, outsideFrameThk, 203
			endif
		endif
	else
		if gs_frame_style_m = FRAME_STYLE_BLOCK then
			hotspot egressleft  + frameDiff, 0, 0, 200
			hotspot egressright + frameDiff, 0, 0, 201
		else
			hotspot egressleft  + frameDiff, 0, egressthk1, 200
			hotspot egressright + frameDiff, 0, egressthk1, 201
		endif

		if gs_frame_style_m = FRAME_STYLE_DOUBLE_REBATE | gs_frame_style_m = FRAME_STYLE_METAL then
			hotspot egressleft  + frameDiff, 0, egressthk2, 202
			hotspot egressright + frameDiff, 0, egressthk2, 203
		else
			hotspot egressleft  + frameDiff, 0, outsideFrameThk, 202
			hotspot egressright + frameDiff, 0, outsideFrameThk, 203
		endif
	endif
	del 1
endif


! ------------------------------------------------------------------------------
! Leaf hotspots
! ------------------------------------------------------------------------------

leafthk1=gs_leaf_thk
leafleft1=leafleft
leafright1=leafright

if bShowLeafHotspots then
	if	gs_frame_style_m = FRAME_STYLE_SIMPLE_REBATE |\
		gs_frame_style_m = FRAME_STYLE_EXTRUSION |\
		gs_frame_style_m = FRAME_STYLE_WRAPPED_EXTRUSION then
		hotspot leafleft1  + frameDiff, leaftop, 0, 310
		hotspot leafright1 + frameDiff, leaftop, 0, 311
		hotspot leafleft1  + frameDiff, leaftop, gs_leaf_thk, 312
		hotspot leafright1 + frameDiff, leaftop, gs_leaf_thk, 313
		if not(gs_door_transom) & bArchedTop then
			hotspot 0, leafarch, 0, 314
			hotspot 0, leafarch, gs_leaf_thk, 315
		endif
	else
		hotspot leafleft  + frameDiff, leaftop, -comy, 310
		hotspot leafright + frameDiff, leaftop, -comy, 311
		hotspot leafleft  + frameDiff, leaftop, outsideFrameThk + comy, 312
		hotspot leafright + frameDiff, leaftop, outsideFrameThk + comy, 313
		if not(gs_door_transom) & bArchedTop then
			hotspot 0, leafarch, -comy, 314
			hotspot 0, leafarch, outsideFrameThk + comy, 315
		endif
	endif
endif

if bShowAddHotspotsForIS then
	if bArchedTop then
		if not(gs_door_transom) then
			if	gs_frame_style_m = FRAME_STYLE_SIMPLE_REBATE |\
				gs_frame_style_m = FRAME_STYLE_EXTRUSION  |\
				gs_frame_style_m = FRAME_STYLE_WRAPPED_EXTRUSION then
				hotspot 0, 0, 0, 304
				hotspot 0, 0, gs_leaf_thk, 305
			else
				hotspot 0, 0, -comy, 304
				hotspot 0, 0, outsideFrameThk + comy, 305
			endif
		else
			if	gs_frame_style_m = FRAME_STYLE_SIMPLE_REBATE |\
				gs_frame_style_m = FRAME_STYLE_EXTRUSION  |\
				gs_frame_style_m = FRAME_STYLE_WRAPPED_EXTRUSION then
				hotspot leafleft1  + frameDiff, 0, 0, 300
				hotspot leafright1 + frameDiff, 0, 0, 301
				hotspot leafleft1  + frameDiff, 0, gs_leaf_thk, 302
				hotspot leafright1 + frameDiff, 0, gs_leaf_thk, 303
			else
				hotspot leafleft  + frameDiff, 0, -comy, 300
				hotspot leafright + frameDiff, 0, -comy, 301
				hotspot leafleft  + frameDiff, 0, outsideFrameThk + comy, 302
				hotspot leafright + frameDiff, 0, outsideFrameThk + comy, 303
			endif
		endif
	else
		if	gs_frame_style_m = FRAME_STYLE_SIMPLE_REBATE |\
			gs_frame_style_m = FRAME_STYLE_EXTRUSION  |\
			gs_frame_style_m = FRAME_STYLE_WRAPPED_EXTRUSION then
			hotspot leafleft1  + frameDiff, 0, 0, 300
			hotspot leafright1 + frameDiff, 0, 0, 301
			hotspot leafleft1  + frameDiff, 0, gs_leaf_thk, 302
			hotspot leafright1 + frameDiff, 0, gs_leaf_thk, 303
		else
			hotspot leafleft  + frameDiff, 0, -comy, 300
			hotspot leafright + frameDiff, 0, -comy, 301
			hotspot leafleft  + frameDiff, 0, outsideFrameThk + comy, 302
			hotspot leafright + frameDiff, 0, outsideFrameThk + comy, 303
		endif
	endif
endif


! ------------------------------------------------------------------------------
! Sidelight and Transom rebate
! ------------------------------------------------------------------------------

if not(gs_sidelight_left | gs_sidelight_right | gs_door_transom) then
	gs_opening_dir_SL_m = 1
	gs_sidelight_rebate_depth = gs_leaf_thk - EPS
endif

if gs_opening_dir_SL_m = 1 then
	Sl_Tr_op_depth = 0
	Sl_Tr_cutDir = -1

	bMirrored = WIDO_REVEAL_SIDE

	if bMirrored then
		matLeafRange_Leaf	= gs_frame_mat2
		matLeafRange_Sash	= gs_frame_mat
		matSashRange_Leaf	= gs_frame_mat
		matSashRange_Sash	= gs_frame_mat

		matSashRebate	= gs_frame_mat2
		matSashOpposite	= gs_frame_mat
		matLeafRebate	= gs_frame_mat2
		matLeafOpposite	= gs_frame_mat
	else
		matLeafRange_Leaf	= gs_frame_mat
		matLeafRange_Sash	= gs_frame_mat2
		matSashRange_Leaf	= gs_frame_mat2
		matSashRange_Sash	= gs_frame_mat2

		matSashRebate	= gs_frame_mat
		matSashOpposite	= gs_frame_mat2
		matLeafRebate	= gs_frame_mat
		matLeafOpposite	= gs_frame_mat2
	endif
else
	Sl_Tr_op_depth = insideFrameThk
	Sl_Tr_cutDir = 1

	bMirroredLeaf = WIDO_REVEAL_SIDE
	bMirroredSash = (WIDO_REVEAL_SIDE & gs_opening_dir_SL_m = 1) | (not(WIDO_REVEAL_SIDE) & gs_opening_dir_SL_m = 2)

	if bMirroredLeaf then
		matLeafRange_Leaf	= gs_frame_mat2
		matSashRange_Leaf	= gs_frame_mat

		matLeafRebate	= gs_frame_mat2
		matLeafOpposite = gs_frame_mat
	else
		matLeafRange_Leaf	= gs_frame_mat
		matSashRange_Leaf	= gs_frame_mat2

		matLeafRebate	= gs_frame_mat
		matLeafOpposite = gs_frame_mat2
	endif

	if bMirroredSash then
		matLeafRange_Sash	= gs_frame_mat
		matSashRange_Sash	= gs_frame_mat

		matSashRebate	= gs_frame_mat2
		matSashOpposite	= gs_frame_mat
	else
		matLeafRange_Sash	= gs_frame_mat2
		matSashRange_Sash	= gs_frame_mat2

		matSashRebate	= gs_frame_mat
		matSashOpposite	= gs_frame_mat2
	endif
endif

if gs_pocket_door_frame then
	LeafRebate = posLeafy + widthWallCut/2
else
	if bEnableLeafRebateDepth3D then
		LeafRebate = gs_rebate_depth_3D
	else
		LeafRebate = gs_leaf_thk
	endif
endif


if gs_frame_style_m <> FRAME_STYLE_METAL & gs_frame_style_m <> FRAME_STYLE_DOUBLE_EGRESS_METAL then

	horizDivLeftSideLeftUpperPX		= -A/2+gs_frw1+offset_09
	horizDivLeftSideLeftLowerPX		= -A/2+gs_frw1+offset_11
	horizDivLeftSideRightUpperPX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_09
	horizDivLeftSideRightLowerPX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_11
	horizDivLeftSideUpperPY			= gs_sidelight_fr_hdiv_hgt_left + gs_sidelight_fr_hdiv_wdt_left + offset_09
	horizDivLeftSideLowerPY			= gs_sidelight_fr_hdiv_hgt_left - offset_11

	horizDivRightSideLeftUpperPX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_05
	horizDivRightSideLeftLowerPX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_07
	horizDivRightSideRightUpperPX	= A/2-gs_frw2-offset_05
	horizDivRightSideRightLowerPX	= A/2-gs_frw2-offset_07
	horizDivRightSideUpperPY		= gs_sidelight_fr_hdiv_hgt_right + gs_sidelight_fr_hdiv_wdt_right + offset_05
	horizDivRightSideLowerPY		= gs_sidelight_fr_hdiv_hgt_right - offset_07

	if gs_door_transom then

! =============================================================================
! Frame WITH Transom
! =============================================================================

		!*** lh = bottom edge of transom, NOT leaf height in style 3

		lh = B - _transomHeight

! Door Stop -------------------------------------------------------------------

		if gs_frame_style_m = FRAME_STYLE_DOUBLE_REBATE & lod3D > 1 then

			addz LeafRebate*(abs(gs_ds_pr)<eps)+gs_ds_pr*(abs(gs_ds_pr)>eps)

			if gs_SashText_typ_num = 1 then

				base

				cprism_ topmat, botmat, sidemat,
					4, gs_ds_thk,
					-A/2+gs_sl_w1, 0, 15,
					-A/2+gs_sl_w1, lh, 10,
					-A/2+gs_sl_w1+gs_ds_w, lh-gs_ds_w, 13,
					-A/2+gs_sl_w1+gs_ds_w,0,15

				gosub 500

				cprism_ topmat, botmat, sidemat,
					4, gs_ds_thk,
					A/2-gs_sl_w2, 0, 15,
					A/2-gs_sl_w2, lh, 10,
					A/2-gs_sl_w2-gs_ds_w, lh-gs_ds_w, 13,
					A/2-gs_sl_w2-gs_ds_w, 0,15

				gosub 500

				if gs_mf then
					cprism_ topmat, botmat, sidemat,
						4, gs_ds_thk,
						A/2-gs_mf_pos-gs_mf_w/2-gs_ds_w, 0, 	15,
						A/2-gs_mf_pos-gs_mf_w/2-gs_ds_w, lh-gs_ds_w,	10,
						A/2-gs_mf_pos-gs_mf_w/2,	lh,	15,
						A/2-gs_mf_pos-gs_mf_w/2,	0,	15
					body 1

					cprism_ topmat, botmat, sidemat,
						4, gs_ds_thk,
						A/2-gs_mf_pos+gs_mf_w/2+gs_ds_w, 0, 	15,
						A/2-gs_mf_pos+gs_mf_w/2+gs_ds_w, lh-gs_ds_w,	10,
						A/2-gs_mf_pos+gs_mf_w/2,	lh,	15,
						A/2-gs_mf_pos+gs_mf_w/2,	0,	15

					gosub 500
				endif

				if gs_mf then
					cprism_ topmat, botmat, sidemat,
						4, gs_ds_thk,
						-A/2+gs_sl_w1, lh, 10,
						-A/2+gs_sl_w1+gs_ds_w, lh-gs_ds_w, 15,
						A/2-gs_mf_pos-gs_mf_w/2-gs_ds_w, lh-gs_ds_w, 10,
						A/2-gs_mf_pos-gs_mf_w/2, lh,15
					body 1

					cprism_ topmat, botmat, sidemat,
						4, gs_ds_thk,
						A/2-gs_mf_pos+gs_mf_w/2, lh, 10,
						A/2-gs_mf_pos+gs_mf_w/2+gs_ds_w, lh-gs_ds_w, 15,
						A/2-gs_sl_w2-gs_ds_w, lh-gs_ds_w, 10,
						A/2-gs_sl_w2, lh,15
				else
					cprism_ topmat, botmat, sidemat,
						4, gs_ds_thk,
						-A/2+gs_sl_w1, lh, 10,
						-A/2+gs_sl_w1+gs_ds_w, lh-gs_ds_w, 15,
						 A/2-gs_sl_w2-gs_ds_w, lh-gs_ds_w, 10,
						 A/2-gs_sl_w2, lh,15
				endif

				gosub 600

			endif

			if gs_SashText_typ_num = 2 then		! Butt Joint

				base

				cprism_ topmat, botmat, sidemat,
					4, gs_ds_thk,
					-A/2+gs_sl_w1, 0, 15,
					-A/2+gs_sl_w1, lh-gs_ds_w, 10,
					-A/2+gs_sl_w1+gs_ds_w, lh-gs_ds_w, 13,
					-A/2+gs_sl_w1+gs_ds_w, 0, 15

				gosub 500

				cprism_ topmat, botmat, sidemat,
					4, gs_ds_thk,
					A/2-gs_sl_w2, 0, 15,
					A/2-gs_sl_w2, lh-gs_ds_w, 10,
					A/2-gs_sl_w2-gs_ds_w, lh-gs_ds_w, 13,
					A/2-gs_sl_w2-gs_ds_w, 0,15

				gosub 500

				if gs_mf then
					cprism_ topmat, botmat, sidemat,
						4, gs_ds_thk,
						A/2-gs_mf_pos-gs_mf_w/2-gs_ds_w, 0, 	15,
						A/2-gs_mf_pos-gs_mf_w/2-gs_ds_w, lh-gs_ds_w,	10,
						A/2-gs_mf_pos-gs_mf_w/2,	lh-gs_ds_w,	15,
						A/2-gs_mf_pos-gs_mf_w/2,	0,	15
					body 1

					cprism_ topmat, botmat, sidemat,
						4, gs_ds_thk,
						A/2-gs_mf_pos+gs_mf_w/2+gs_ds_w, 0, 	15,
						A/2-gs_mf_pos+gs_mf_w/2+gs_ds_w, lh-gs_ds_w,	10,
						A/2-gs_mf_pos+gs_mf_w/2,	lh-gs_ds_w,	15,
						A/2-gs_mf_pos+gs_mf_w/2,	0,	15

					gosub 500
				endif

				if gs_mf then
					cprism_ topmat, botmat, sidemat,
						6, gs_ds_thk,
						-A/2+gs_sl_w1, lh, 15,
						-A/2+gs_sl_w1, lh-gs_ds_w,8,
						-A/2+gs_sl_w1+gs_ds_w, lh-gs_ds_w, 15,
						A/2-gs_mf_pos-gs_mf_w/2-gs_ds_w, lh-gs_ds_w, 10,
						A/2-gs_mf_pos-gs_mf_w/2, lh-gs_ds_w,13,
						A/2-gs_mf_pos-gs_mf_w/2, lh,15
					body 1

					cprism_ topmat, botmat, sidemat,
						6, gs_ds_thk,
						A/2-gs_mf_pos+gs_mf_w/2, lh, 15,
						A/2-gs_mf_pos+gs_mf_w/2, lh-gs_ds_w,8,
						A/2-gs_mf_pos+gs_mf_w/2+gs_ds_w, lh-gs_ds_w, 15,
						A/2-gs_sl_w2-gs_ds_w, lh-gs_ds_w, 10,
						A/2-gs_sl_w2, lh-gs_ds_w,13,
						A/2-gs_sl_w2, lh,15
				else
					cprism_ topmat, botmat, sidemat,
						6, gs_ds_thk,
						-A/2+gs_sl_w1, lh, 15,
						-A/2+gs_sl_w1, lh-gs_ds_w,8,
						-A/2+gs_sl_w1+gs_ds_w, lh-gs_ds_w, 15,
						 A/2-gs_sl_w2-gs_ds_w, lh-gs_ds_w, 10,
						 A/2-gs_sl_w2, lh-gs_ds_w,13,
						 A/2-gs_sl_w2, lh,15
				endif

			endif

			body -1
			del 1

		endif

! Extrusion Frame Rebate ---------------------------------------------------

		if	gs_frame_style_m = FRAME_STYLE_EXTRUSION |\
			gs_frame_style_m = FRAME_STYLE_WRAPPED_EXTRUSION then
			material gs_frame_mat

			gosub "Metal Frame Rebate"
		endif

! Leaf Rebate -----------------------------------------------------------------
		if	(not(bUniformMaterials) & gs_frame_style_m = FRAME_STYLE_DOUBLE_REBATE & not(bSimpleOrCHIModel)) |\
			(gs_frame_style_m = FRAME_STYLE_SIMPLE_REBATE) |\
			(gs_frame_style_m = FRAME_STYLE_EXTRUSION) |\
			(gs_frame_style_m = FRAME_STYLE_WRAPPED_EXTRUSION) then

			bDoubleCut = (gs_frame_style_m = FRAME_STYLE_DOUBLE_REBATE)
			if	gs_frame_style_m = FRAME_STYLE_SIMPLE_REBATE		|\
				gs_frame_style_m = FRAME_STYLE_EXTRUSION			|\
				gs_frame_style_m = FRAME_STYLE_WRAPPED_EXTRUSION	then
				rebateWidth = gs_rebate_width
			else
				rebateWidth = offsetEPS
			endif

			addz LeafRebate

			if gs_mf then
				material matLeafRebate
				cutform 4, 1, 2 + 16,
					 0, 0, 1, 0,
					A/2-gs_mf_pos+gs_mf_w/2-rebateWidth+offset_leaf,	0,													31,
					A/2-gs_mf_pos+gs_mf_w/2-rebateWidth+offset_leaf,	B-_transomHeight+rebateWidth-offset_leaf,	31,
					A/2-gs_sl_w2+rebateWidth-offset_leaf,				B-_transomHeight+rebateWidth-offset_leaf,	31,
					A/2-gs_sl_w2+rebateWidth-offset_leaf,				0,													31

				cutform 4, 1, 2 + 16,
					 0, 0, 1, 0,
					-A/2+gs_sl_w1-rebateWidth+offset_leaf,				0,													31,
					-A/2+gs_sl_w1-rebateWidth+offset_leaf,				B-_transomHeight+rebateWidth-offset_leaf,	31,
					 A/2-gs_mf_pos-gs_mf_w/2+rebateWidth-offset_leaf,	B-_transomHeight+rebateWidth-offset_leaf,	31,
					 A/2-gs_mf_pos-gs_mf_w/2+rebateWidth-offset_leaf,	0,													31

				if bDoubleCut then
					material matLeafOpposite
					cutform 4, 1, 2 + 16,
						 0, 0, -1, 0,
						A/2-gs_mf_pos+gs_mf_w/2-rebateWidth+offset_leaf,	0,													31,
						A/2-gs_mf_pos+gs_mf_w/2-rebateWidth+offset_leaf,	B-_transomHeight+rebateWidth-offset_leaf,	31,
						A/2-gs_sl_w2+rebateWidth-offset_leaf,				B-_transomHeight+rebateWidth-offset_leaf,	31,
						A/2-gs_sl_w2+rebateWidth-offset_leaf,				0,													31

					cutform 4, 1, 2 + 16,
						 0, 0, -1, 0,
						-A/2+gs_sl_w1-rebateWidth+offset_leaf,				0,													31,
						-A/2+gs_sl_w1-rebateWidth+offset_leaf,				B-_transomHeight+rebateWidth-offset_leaf,	31,
						 A/2-gs_mf_pos-gs_mf_w/2+rebateWidth-offset_leaf,	B-_transomHeight+rebateWidth-offset_leaf,	31,
						 A/2-gs_mf_pos-gs_mf_w/2+rebateWidth-offset_leaf,	0,													31
				endif
				numCuts = numCuts + 2 + 2 * bDoubleCut
			else
				material matLeafRebate
				cutform 4, 1, 2 + 16,
					 0, 0, 1, 0,
					-A/2+gs_sl_w1-rebateWidth+offset_leaf,	0,													31,
					-A/2+gs_sl_w1-rebateWidth+offset_leaf,	B-_transomHeight+rebateWidth-offset_leaf,	31,
					 A/2-gs_sl_w2+rebateWidth-offset_leaf,	B-_transomHeight+rebateWidth-offset_leaf,	31,
					 A/2-gs_sl_w2+rebateWidth-offset_leaf,	0,													31

				if bDoubleCut then
					material matLeafOpposite
					cutform 4, 1, 2 + 16,
						 0, 0, -1, 0,
						-A/2+gs_sl_w1-rebateWidth+offset_leaf,	0,													31,
						-A/2+gs_sl_w1-rebateWidth+offset_leaf,	B-_transomHeight+rebateWidth-offset_leaf,	31,
						 A/2-gs_sl_w2+rebateWidth-offset_leaf,	B-_transomHeight+rebateWidth-offset_leaf,	31,
						 A/2-gs_sl_w2+rebateWidth-offset_leaf,	0,													31
				endif
				numCuts = numCuts + 1 + bDoubleCut
			endif

			del 1

		endif

! Sidelight and Transom Rebate ------------------------------------------------

		if (lod3D > 1) | not(bUniformMaterials) then
			addz Sl_Tr_op_depth
			mulz Sl_Tr_cutDir

			! Transom
			if bArchedTop then
				if not(bUniformMaterials) | (not(bNoRebate_02) & not(bSimpleOrCHIModel)) then
					bDoubleCut = (bNoRebate_02 | bSimpleOrCHIModel)
					if bSimpleOrCHIModel then
						if iMullionStyle_02 = MULLION_SOLID_PANEL then
							cutDepth = gs_sash_thk
						else
							cutDepth = (insideFrameThk + gs_glass_thk) / 2
						endif
						rebateWidth = offsetEPS
					else
						if gs_optype_m_02 = SASH_FIXED then
							cutDepth = gs_sidelight_rebate_depth + gs_glass_thk / 2
							rebateWidth = offsetEPS
						else
							if bNoRebate_02 then
								cutDepth = min(gs_sash_thk, gs_frame_thk / 2)
								rebateWidth = offsetEPS
							else
								cutDepth = gs_sidelight_rebate_depth
								rebateWidth = gs_sidelight_rebate_width
								if rebateWidth < EPS then cutDepth = 0
							endif
						endif
					endif
					if cutDepth > EPS then
						addz -cutDepth
						material matSashRebate
						cutform 7, 1, 2 + 16,
							0, 0, -1, 0,
							trans_Left, B-_transomHeight+gs_frame_width_transom-rebateWidth+offset_02, 15+16+32,
							trans_Left, gs_shoulder_h-(fce-fce_Sl_rebate)-0.0001, 15+16,
							trans_Left, gs_shoulder_h-(fce-fce_Sl_rebate), 15+16+64,
							0, frametop - r2, 900+15+16+32,
							0, B-gs_frwt+rebateWidth, 3000+15+16+64,
							trans_Right, gs_shoulder_h-(fce-fce_Sl_rebate), 3000+15+16+32,
							trans_Right, B-_transomHeight+gs_frame_width_transom-rebateWidth+offset_02, 15+16+32
						if bDoubleCut then
							material matSashOpposite
							cutform 7, 1, 2 + 16,
								0, 0, 1, 0,
								trans_Left, B-_transomHeight+gs_frame_width_transom-rebateWidth+offset_02, 15+16+32,
								trans_Left, gs_shoulder_h-(fce-fce_Sl_rebate)-0.0001, 15+16,
								trans_Left, gs_shoulder_h-(fce-fce_Sl_rebate), 15+16+64,
								0, frametop - r2, 900+15+16+32,
								0, B-gs_frwt+rebateWidth, 3000+15+16+64,
								trans_Right, gs_shoulder_h-(fce-fce_Sl_rebate), 3000+15+16+32,
								trans_Right, B-_transomHeight+gs_frame_width_transom-rebateWidth+offset_02, 15+16+32
						endif
						numCuts = numCuts + 1 + bDoubleCut
						del 1
					endif
				endif
			else
				if gs_sidelight_left & gs_LeftMullion_Top then
					rebateCutShapeLeftPX = -A/2+gs_sl_w1+offset_02
				else
					rebateCutShapeLeftPX = -A/2+gs_frw1+offset_02
				endif
				if gs_sidelight_right & gs_RightMullion_Top then
					rebateCutShapeRightPX = A/2-gs_sl_w2-offset_02
				else
					rebateCutShapeRightPX = A/2-gs_frw2-offset_02
				endif
				rebateCutShapeTopPY		= B-gs_frwt-offset_02
				rebateCutShapeBottomPY	= B-_transomHeight+gs_frame_width_transom+offset_02
				sashWidthToRebateCut	= gs_sash_width
				gs_optype_m_i			= gs_optype_m_02
				bNoRebate_i				= bNoRebate_02
				iMullionStyle_i			= iMullionStyle_02
				iSimpleSashFrameType_i	= iSimpleSashFrameType_02
				offset_i				= offset_02

				gosub "Rectangular Rebate Cutting"
			endif

			if gs_sidelight_left then			! --- Left Sidelight Rebate

				rebateCutShapeLeftPX	= horizDivLeftSideLeftUpperPX
				rebateCutShapeRightPX	= horizDivLeftSideRightUpperPX
				if gs_Transom_toLeft then
					rebateCutShapeTopPY	= B - _transomHeight - offset_09
				else
					rebateCutShapeTopPY	= TopHeightInny - offset_09
				endif
				if gs_bSidelight_fr_hdiv_Left then
					rebateCutShapeBottomPY = horizDivLeftSideUpperPY
				else
					rebateCutShapeBottomPY = LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_09
				endif
				sashWidthToRebateCut	= gs_sl_sash_width
				gs_optype_m_i			= gs_optype_m_09
				bNoRebate_i				= bNoRebate_09
				iMullionStyle_i			= iMullionStyle_09
				iSimpleSashFrameType_i	= iSimpleSashFrameType_09
				offset_i				= offset_09

				gosub "Rectangular Rebate Cutting"

				if gs_bSidelight_fr_hdiv_left then			! --- Left Lower Sidelight Rebate

					rebateCutShapeLeftPX	= horizDivLeftSideLeftLowerPX
					rebateCutShapeRightPX	= horizDivLeftSideRightLowerPX
					rebateCutShapeTopPY		= horizDivLeftSideLowerPY
					rebateCutShapeBottomPY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_11
					sashWidthToRebateCut	= gs_sl_sash_width
					gs_optype_m_i			= gs_optype_m_11
					bNoRebate_i				= bNoRebate_11
					iMullionStyle_i			= iMullionStyle_11
					iSimpleSashFrameType_i	= iSimpleSashFrameType_11
					offset_i				= offset_11

					gosub "Rectangular Rebate Cutting"
				endif

				! --- Left Upper Sidelight Rebate

				if gs_Transom_toLeft & gs_LeftMullion_Top & (not(bUniformMaterials) | (not(bNoRebate_10) & not(bSimpleOrCHIModel))) then

					rebateCutShapeLeftPX	= -A/2+gs_frw1+offset_10
					rebateCutShapeRightPX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_10
					rebateCutShapeTopPY		= B-gs_frwt-offset_10
					rebateCutShapeBottomPY	= B-_transomHeight+gs_frame_width_transom+offset_10
					sashWidthToRebateCut	= gs_sash_width
					gs_optype_m_i			= gs_optype_m_10
					bNoRebate_i				= bNoRebate_10
					iMullionStyle_i			= iMullionStyle_10
					iSimpleSashFrameType_i	= iSimpleSashFrameType_10
					offset_i				= offset_10

					gosub "Rectangular Rebate Cutting"
				endif
			endif

			if gs_sidelight_right then			! --- Right Sidelight Rebate

				rebateCutShapeLeftPX	= horizDivRightSideLeftUpperPX
				rebateCutShapeRightPX	= horizDivRightSideRightUpperPX
				if gs_Transom_toRight then
					rebateCutShapeTopPY	= B - _transomHeight - offset_05
				else
					rebateCutShapeTopPY	= TopHeightInny - offset_05
				endif
				if gs_bSidelight_fr_hdiv_right then
					rebateCutShapeBottomPY = horizDivRightSideUpperPY
				else
					rebateCutShapeBottomPY = RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_05
				endif
				sashWidthToRebateCut	= gs_sl_sash_width
				gs_optype_m_i			= gs_optype_m_05
				bNoRebate_i				= bNoRebate_05
				iMullionStyle_i			= iMullionStyle_05
				iSimpleSashFrameType_i	= iSimpleSashFrameType_05
				offset_i				= offset_05

				gosub "Rectangular Rebate Cutting"

				if gs_bSidelight_fr_hdiv_right then			! --- Right Lower Sidelight Rebate

					rebateCutShapeLeftPX	= horizDivRightSideLeftLowerPX
					rebateCutShapeRightPX	= horizDivRightSideRightLowerPX
					rebateCutShapeTopPY		= horizDivRightSideLowerPY
					rebateCutShapeBottomPY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_07
					sashWidthToRebateCut	= gs_sl_sash_width
					gs_optype_m_i			= gs_optype_m_07
					bNoRebate_i				= bNoRebate_07
					iMullionStyle_i			= iMullionStyle_07
					iSimpleSashFrameType_i	= iSimpleSashFrameType_07
					offset_i				= offset_07

					gosub "Rectangular Rebate Cutting"
				endif

				! --- Right Upper Sidelight Rebate

				if gs_Transom_toRight & gs_RightMullion_Top & (not(bUniformMaterials) | (not(bNoRebate_06) & not(bSimpleOrCHIModel)) ) then

					rebateCutShapeLeftPX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_06
					rebateCutShapeRightPX	= A/2-gs_frw2-offset_06
					rebateCutShapeTopPY		= B-gs_frwt-offset_06
					rebateCutShapeBottomPY	= B-_transomHeight+gs_frame_width_transom+offset_06
					sashWidthToRebateCut	= gs_sash_width
					gs_optype_m_i			= gs_optype_m_06
					bNoRebate_i				= bNoRebate_06
					iMullionStyle_i			= iMullionStyle_06
					iSimpleSashFrameType_i	= iSimpleSashFrameType_06
					offset_i				= offset_06

					gosub "Rectangular Rebate Cutting"
				endif
			endif
			del 2
		endif

! USA Middle Frame ------------------------------------------------------------

		if gs_mf then
			add A/2-gs_mf_pos, 0, 0
			cprism_ topmat, botmat, sidemat,
				4, outsideFrameThk,
				-gs_mf_w/2-offset_leaf, 0, 	15,
				-gs_mf_w/2-offset_leaf, B-_transomHeight-offset_leaf,	10,
				 gs_mf_w/2+offset_leaf,	B-_transomHeight-offset_leaf,	15,
				 gs_mf_w/2+offset_leaf,	0,	15

			gosub 500
			del 1
		endif

! -----------------------------------------------------------------------------

		base

n = 1
		for i=1 to n

			framethick1	= outsideFrameThk
			framethick2	= insideFrameThk
			frameThickOffset = 0

			mat1=topmat
			mat2=sidemat

			if not(WIDO_REVEAL_SIDE) then
				matLeaf = gs_frame_mat2
			else
				matLeaf = gs_frame_mat
			endif

			if gs_opening_dir_SL_m = 1 exor WIDO_REVEAL_SIDE then
				matSash = gs_frame_mat2
			else
				matSash = gs_frame_mat
			endif

			mask1 = 15
			mask2 = 13
			mask3 = 15

			bExtraPrismOnLeftSide		= 0
			bExtraPrismOnLeftSideTop	= 0
			bExtraPrismOnRightSide		= 0
			bExtraPrismOnRightSideTop	= 0
			bDiffFrameThk = (abs(framethick1-framethick2) > EPS)

			bNoExtraPrismOnTop = (bDiffFrameThk & (lod3D = 1) & not(offset_02 > EPS))
			if gs_sidelight_left & gs_LeftMullion_Top then
				if gs_Transom_toLeft then
					iSimpleSashFrameTypeL = iSimpleSashFrameType_10
					offset_L = offset_10
				else
					iSimpleSashFrameTypeL = iSimpleSashFrameType_09
					offset_L = offset_09
				endif
				bNoExtraPrismOnLeftTop = ((bDiffFrameThk & (lod3D = 1) & not(offset_L > EPS)) & bNoExtraPrismOnTop)
			else
				bNoExtraPrismOnLeftTop = 0
			endif

			if gs_sidelight_right & gs_RightMullion_Top then
				if gs_Transom_toRight then
					iSimpleSashFrameTypeR = iSimpleSashFrameType_06
					offset_R = offset_06
				else
					iSimpleSashFrameTypeR = iSimpleSashFrameType_05
					offset_R = offset_05
				endif
				bNoExtraPrismOnRightTop = ((bDiffFrameThk & (lod3D = 1) & not(offset_R > EPS)) & bNoExtraPrismOnTop)
			else
				bNoExtraPrismOnRightTop = 0
			endif

			if gs_SashText_typ_num = 1 then		! Mitered Joint

				if gs_pocket_door_frame & lod3D <> 5 then
					cutHeight = TopHeightInny
					gosub "Pocket Door Cutting"
				endif

				if gs_sidelight_left then

					if not(gs_Transom_toLeft) then
						bExtraPrismOnLeftSide = (bDiffFrameThk & (lod3D = 1) & (offset_09 > EPS))
						if gs_bSidelight_fr_hdiv_left then
							bExtraPrismOnLeftSideLower = (bDiffFrameThk & (lod3D = 1) & (offset_11 > EPS))
						else
							bExtraPrismOnLeftSideLower = bExtraPrismOnLeftSide
						endif

						if bExtraPrismOnLeftSide | bExtraPrismOnLeftSideLower then
							put	-A/2+gs_frw1, TopHeightInny, 0, 8, matSash,
								-A/2+gs_frw1+offset_09, TopHeightInny-offset_09, 0, mask1 - 2, matSash
							if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEVER then
								if gs_bSidelight_fr_hdiv_left then
									SashBottomY	= horizDivLeftSideUpperPY
								else
									SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_09
								endif
								SashTopY	= TopHeightInny-offset_09
								simpleSashX	= -A/2+gs_frw1+offset_09

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
							endif
							if gs_bSidelight_fr_hdiv_left then
								put horizDivLeftSideLeftUpperPX,	horizDivLeftSideUpperPY, 0, 8,	matSash,
									horizDivLeftSideLeftLowerPX,	horizDivLeftSideLowerPY, 0, mask2 - not(bExtraPrismOnLeftSideLower),	matSash

								if (iSimpleSashFrameType_11 = SIMPLESASH_SLIDEVER) & bExtraPrismOnLeftSideLower then
									SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_11
									SashTopY	= horizDivLeftSideLowerPY
									simpleSashX	= horizDivLeftSideLeftLowerPX

									simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
									put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
										simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
								endif
								offset_i = offset_11
							else
								offset_i = offset_09
							endif
							put	-A/2+gs_frw1+offset_i, LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, 8, matSash,
								-A/2+gs_frw1+offset_i, LeftSLParapet-ovhgBottomLeft, 0, mask1, matSash,
								-A/2+gs_frw1, LeftSLParapet-ovhgBottomLeft, 0, 12, matSash

							cprism_{2} mat1, botmat, matSash,
								nsp/5, framethick2,
								get(nsp)
							body 1

						endif

						put	-A/2 - cutDxLeft, LeftSLParapet-ovhgBottomLeft, 0, mask1 - 7*gs_stack_left, matSash,
							-A/2 - cutDxLeft, TopHeighty, 0, 10 - 2*(gs_stack_top | gs_stack_left), matSash,
							-A/2+gs_frw1+offset_09*not(bExtraPrismOnLeftSide), TopHeightInny-offset_09*not(bExtraPrismOnLeftSide), 0, mask1 - 2 - ((i = 1) & bExtraPrismOnLeftSide), matSash
						if (iSimpleSashFrameType_09 = SIMPLESASH_SLIDEVER) & not(bExtraPrismOnLeftSide) then
							if gs_bSidelight_fr_hdiv_left then
								SashBottomY	= horizDivLeftSideUpperPY
							else
								SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_09
							endif
							SashTopY	= TopHeightInny-offset_09
							simpleSashX	= -A/2+gs_frw1+offset_09

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						if gs_bSidelight_fr_hdiv_left then
							put horizDivLeftSideLeftUpperPX - offset_09*bExtraPrismOnLeftSide,	horizDivLeftSideUpperPY, 0, mmask,	matSash,
								horizDivLeftSideLeftLowerPX - offset_11*bExtraPrismOnLeftSideLower,	horizDivLeftSideLowerPY, 0, mask2-bExtraPrismOnLeftSideLower,	matSash

							if (iSimpleSashFrameType_11 = SIMPLESASH_SLIDEVER) & not(bExtraPrismOnLeftSideLower) then
								SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_11
								SashTopY	= horizDivLeftSideLowerPY
								simpleSashX	= horizDivLeftSideLeftLowerPX

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
							endif
							offset_i = offset_11
						else
							offset_i = offset_09
						endif
						if not(bDiffFrameThk) then
							put	-A/2+gs_frw1+offset_i, LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, mmask, matSash
						else
							put	-A/2+gs_frw1+offset_i*not(bExtraPrismOnLeftSideLower), LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, 12, matSash,
								-A/2+gs_frw1+offset_i*not(bExtraPrismOnLeftSideLower), LeftSLParapet-ovhgBottomLeft, 0, mask1, matSash
						endif
						put	-A/2 - cutDxLeft, LeftSLParapet-ovhgBottomLeft, 0, -1, matSash

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick1,
							get(nsp)
						body 1

					else
						bExtraPrismOnLeftSide = (bDiffFrameThk & (lod3D = 1) & (offset_09 > EPS))
						if gs_bSidelight_fr_hdiv_left then
							bExtraPrismOnLeftSideLower = (bDiffFrameThk & (lod3D = 1) & (offset_11 > EPS))
						else
							bExtraPrismOnLeftSideLower = bExtraPrismOnLeftSide
						endif
						if gs_LeftMullion_Top then
							offset_x = offset_10
							offset_y = offset_10
							iSimpleSashFrameType = iSimpleSashFrameType_10
						else
							offset_x = offset_02
							offset_y = offset_02
							iSimpleSashFrameType = iSimpleSashFrameType_02
						endif
						bExtraPrismOnLeftSideTop = (bDiffFrameThk & (lod3D = 1) & (offset_x > EPS))

						if bExtraPrismOnLeftSide | bExtraPrismOnLeftSideTop | bExtraPrismOnLeftSideLower then
							if bExtraPrismOnLeftSideTop then
								put	-A/2+gs_frw1, TopHeightInny, 0, 8, matSash,
									-A/2+gs_frw1+offset_x, TopHeightInny-offset_y*(not(bArchedTop)), 0, mask1 - 2, matSash
								if iSimpleSashFrameType = SIMPLESASH_SLIDEVER then
									SashBottomY	= lh+gs_frame_width_transom+offset_y
									SashTopY	= TopHeightInny-offset_y
									simpleSashX	= -A/2+gs_frw1+offset_x

									simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
									put simpleSashX, simpleSashDivy + gs_sash_width/2, 0, 8, matSash,
										simpleSashX, simpleSashDivy - gs_sash_width/2, 0, mask2, matSash
								endif
								put	-A/2+gs_frw1+offset_x, lh+gs_frame_width_transom+offset_y, 0, 8, matSash
								if not(bExtraPrismOnLeftSide) then
									put	-A/2+gs_frw1, lh-offset_09, 0, 12, matSash
								endif

								if not(bExtraPrismOnLeftSide) & bExtraPrismOnLeftSideLower then
									cprism_{2} mat1, botmat, matSash,
										nsp/5, framethick2,
										get(nsp)
								endif
							endif
							if bExtraPrismOnLeftSide | bExtraPrismOnLeftSideLower then
								if bExtraPrismOnLeftSide then
									put	-A/2+gs_frw1+offset_09, lh-offset_09, 0, mask1 - 2, matSash
									if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEVER then
										if gs_bSidelight_fr_hdiv_left then
											SashBottomY	= horizDivLeftSideUpperPY
										else
											SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_09
										endif
										SashTopY	= lh-offset_09
										simpleSashX	= -A/2+gs_frw1+offset_09

										simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
										put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
											simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
									endif
								endif
								if gs_bSidelight_fr_hdiv_left then
									put horizDivLeftSideLeftUpperPX,	horizDivLeftSideUpperPY, 0, 8,	matSash,
										horizDivLeftSideLeftLowerPX,	horizDivLeftSideLowerPY, 0, mask2 - not(bExtraPrismOnLeftSideLower),	matSash

									if (iSimpleSashFrameType_11 = SIMPLESASH_SLIDEVER) & bExtraPrismOnLeftSideLower then
										SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_11
										SashTopY	= horizDivLeftSideLowerPY
										simpleSashX	= horizDivLeftSideLeftLowerPX

										simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
										put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
											simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
									endif
									offset_i = offset_11
								else
									offset_i = offset_09
								endif
								if bExtraPrismOnLeftSideLower then
									put	-A/2+gs_frw1+offset_i, LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, 8, matSash,
										-A/2+gs_frw1+offset_i, LeftSLParapet-ovhgBottomLeft, 0, mask1-2, matSash,
										-A/2+gs_frw1, LeftSLParapet-ovhgBottomLeft, 0, 12, matSash
								endif
								if not(bExtraPrismOnLeftSideTop) & bExtraPrismOnLeftSide then
									put	-A/2+gs_frw1, lh+gs_frame_width_transom+offset_y, 0, 8, matSash
								endif
							endif

							cprism_{2} mat1, botmat, matSash,
								nsp/5, framethick2,
								get(nsp)
							body 1

						endif

						put	-A/2 - cutDxLeft, LeftSLParapet-ovhgBottomLeft, 0, mask1 - 7*gs_stack_left, matSash,
							-A/2 - cutDxLeft, TopHeighty, 0, 10 - 2*(gs_stack_top | gs_stack_left), matSash,
							-A/2+gs_frw1+offset_x*not(bExtraPrismOnLeftSideTop), TopHeightInny-offset_y*(not(bArchedTop))*not(bExtraPrismOnLeftSideTop), 0, mask1 - 2 - ((i = 1) & bExtraPrismOnLeftSideTop), matSash
						if (iSimpleSashFrameType = SIMPLESASH_SLIDEVER) & not(bExtraPrismOnLeftSideTop) then
							SashBottomY	= lh+gs_frame_width_transom+offset_y
							SashTopY	= TopHeightInny-offset_y
							simpleSashX	= -A/2+gs_frw1+offset_x

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sash_width/2, 0, mask2, matSash
						endif
						if i = 1 | not(bDiffFrameThk) then
							put	-A/2+gs_frw1+offset_x*not(bExtraPrismOnLeftSideTop), lh+gs_frame_width_transom+offset_y, 0, mmask, matSash
						endif
						put	-A/2+gs_frw1+offset_09*not(bExtraPrismOnLeftSide), lh-offset_09, 0, mask1 - 2 - ((i = 1) & bExtraPrismOnLeftSide), matSash
						if (iSimpleSashFrameType_09 = SIMPLESASH_SLIDEVER) & not(bExtraPrismOnLeftSide) then
							if gs_bSidelight_fr_hdiv_left then
								SashBottomY	= horizDivLeftSideUpperPY
							else
								SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_09
							endif
							SashTopY	= lh-offset_09
							simpleSashX	= -A/2+gs_frw1+offset_09

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						if gs_bSidelight_fr_hdiv_left then
							put horizDivLeftSideLeftUpperPX-offset_09*bExtraPrismOnLeftSide,	horizDivLeftSideUpperPY, 0, mmask,	matSash,
								horizDivLeftSideLeftLowerPX-offset_11*bExtraPrismOnLeftSideLower,	horizDivLeftSideLowerPY, 0, mask2-bExtraPrismOnLeftSideLower,	matSash

							if (iSimpleSashFrameType_11 = SIMPLESASH_SLIDEVER) & not(bExtraPrismOnLeftSideLower) then
								SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_11
								SashTopY	= horizDivLeftSideLowerPY
								simpleSashX	= horizDivLeftSideLeftLowerPX

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
							endif
							offset_i = offset_11
						else
							offset_i = offset_09
						endif
						if not(bDiffFrameThk) then
							put	-A/2+gs_frw1+offset_i, LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, mmask, matSash
						else
							put	-A/2+gs_frw1+offset_i*not(bExtraPrismOnLeftSideLower), LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, 12, matSash,
								-A/2+gs_frw1+offset_i*not(bExtraPrismOnLeftSideLower), LeftSLParapet-ovhgBottomLeft, 0, mask1, matSash
						endif
						put	-A/2 - cutDxLeft, LeftSLParapet-ovhgBottomLeft, 0, -1, matSash

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick1,
							get(nsp)
					endif

					gosub 500

					if gs_LeftMullion_Top then
						if gs_Transom_toLeft then
							put	-A/2+gs_sl_w1-gs_frw_Sl_left-offset_10, B-gs_frwt-offset_10, 0, mask1, matSash
							if iSimpleSashFrameType_10 = SIMPLESASH_SLIDEVER then
								SashBottomY	= lh+gs_frame_width_transom+offset_10
								SashTopY	= B-gs_frwt-offset_10
								simpleSashX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_10

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sash_width/2, 0, mask2, matSash
							endif
							put	-A/2+gs_sl_w1-gs_frw_Sl_left-offset_10, lh+gs_frame_width_transom+offset_10, 0, 10, matSash,
								-A/2+gs_sl_w1-gs_frw_Sl_left-offset_09, lh-offset_09, 0, mask1, matSash
						else
							put	-A/2+gs_sl_w1-gs_frw_Sl_left-offset_09, B-gs_frwt-offset_09, 0, mask1, matSash
						endif
					else
						put	-A/2+gs_sl_w1-gs_frw_Sl_left-offset_09, lh-offset_09, 0, mask1, matSash
					endif
					if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEVER then
						if gs_bSidelight_fr_hdiv_left then
							SashBottomY	= horizDivLeftSideUpperPY
						else
							SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_09
						endif
						if gs_Transom_toLeft then
							SashTopY = lh-offset_09
						else
							SashTopY = B-gs_frwt-offset_09
						endif
						simpleSashX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_09

						simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
						put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
							simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
					endif
					if gs_bSidelight_fr_hdiv_left then
						put horizDivLeftSideRightUpperPX,	horizDivLeftSideUpperPY, 0, 8,		matSash,
							horizDivLeftSideRightLowerPX,	horizDivLeftSideLowerPY, 0, mask2,	matSash

						if iSimpleSashFrameType_11 = SIMPLESASH_SLIDEVER then
							SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_11
							SashTopY	= horizDivLeftSideLowerPY
							simpleSashX	= horizDivLeftSideRightLowerPX

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						offset_i = offset_11
					else
						offset_i = offset_09
					endif
					if LeftSLParapet > EPS then
						put -A/2+gs_sl_w1-gs_frw_Sl_left-offset_i, LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, 10, matSash,
							-A/2+gs_sl_w1-gs_frw_SlParapet_left-gs_tolerance_left_2, LeftSLParapet-ovhgBottomLeft, 0, mask1, matSash,
							-A/2+gs_sl_w1-gs_frw_SlParapet_left-gs_tolerance_left_2, -ovhgBottom, 0, mask1, matSash,
							-A/2+gs_sl_w1+offset_leaf, -ovhgBottom, 0, mask3, matLeaf
					else
						put -A/2+gs_sl_w1-gs_frw_Sl_left-offset_i, gs_frame_width_low_left_sl+offset_i, 0, 10, matSash,
							-A/2+gs_sl_w1+offset_leaf, -ovhgBottom, 0, mask3 - 2, matLeaf
					endif
					if gs_LeftMullion_Top then
						if gs_Transom_toLeft then
							put	-A/2+gs_sl_w1+offset_leaf, lh-offset_leaf, 0, 10, matSash,
								-A/2+gs_sl_w1+offset_02, lh+gs_frame_width_transom+offset_02, 0, mask1, matSash
							if iSimpleSashFrameType_02 = SIMPLESASH_SLIDEVER then
								SashBottomY	= lh+gs_frame_width_transom+offset_02
								SashTopY	= B-gs_frwt-offset_02
								simpleSashX	= -A/2+gs_sl_w1+offset_02

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy - gs_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy + gs_sash_width/2, 0, mask2, matSash
							endif
							put	-A/2+gs_sl_w1+offset_02, B-gs_frwt-offset_02, 0, 10+4*(bNoExtraPrismOnLeftTop | (bDiffFrameThk & (lod3D = 2))), matSash,
								-A/2+gs_sl_w1-gs_frw_Sl_left-offset_10, B-gs_frwt-offset_10, 0, -1, matSash
						else
							put	-A/2+gs_sl_w1+offset_leaf, lh-offset_leaf, 0, 10, matSash,
								-A/2+gs_sl_w1+offset_02, lh+gs_frame_width_transom+offset_02, 0, mask1, matSash
							if iSimpleSashFrameType_02 = SIMPLESASH_SLIDEVER then
								SashBottomY	= lh+gs_frame_width_transom+offset_02
								SashTopY	= B-gs_frwt-offset_02
								simpleSashX	= -A/2+gs_sl_w1+offset_02

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy - gs_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy + gs_sash_width/2, 0, mask2, matSash
							endif
							put	-A/2+gs_sl_w1+offset_02, B-gs_frwt-offset_02, 0, 10+4*(bNoExtraPrismOnLeftTop | (bDiffFrameThk & (lod3D = 2))), matSash,
								-A/2+gs_sl_w1-gs_frw_Sl_left-offset_09, B-gs_frwt-offset_09, 0, -1, matSash
						endif
					else
						put	-A/2+gs_sl_w1+offset_leaf, lh-offset_leaf, 0, 10, matSash,
							-A/2+gs_sl_w1-gs_frw_Sl_left-offset_09, lh-offset_09, 0, -1, matSash
					endif

					cprism_{2} mat1, botmat, matSash,
						nsp/5, framethick2,
						get(nsp)

					gosub 500

					if gs_bSidelight_fr_hdiv_left then
						iSimpleSashFrameType_i = iSimpleSashFrameType_11
						offset_i = offset_11
					else
						iSimpleSashFrameType_i = iSimpleSashFrameType_09
						offset_i = offset_09
					endif
					put	-A/2+gs_sl_w1-gs_frw_Sl_left-offset_i, LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, 10, matSash,
						-A/2+gs_sl_w1-(gs_frw_SlParapet_left+gs_tolerance_left_2) * (LeftSLParapet>0), LeftSLParapet-ovhgBottomLeft, 0, mask1, matSash,
						-A/2+(gs_frw1+offset_i)*bDiffFrameThk-gs_tolerance_left*not(bDiffFrameThk), LeftSLParapet-ovhgBottomLeft, 0, mmask2-4*bExtraPrismOnLeftSideLower - 2*gs_stack_left, matSash,
						-A/2+gs_frw1+offset_i, LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, mask1, matSash
					if iSimpleSashFrameType_i = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_i = SIMPLESASH_SIDEHUNG then
						SashLeftX	= -A/2+gs_frw1+offset_i
						SashRightX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_i
						simpleSashZ	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i

						simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
						if iSimpleSashFrameType_i = SIMPLESASH_SLIDEHOR then
							put simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
								simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
						else
							put simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
								simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
						endif
					endif

					cprism_{2} mat1, botmat, matSash,
						nsp/5, framethick2,
						get(nsp)

					gosub 600
				else
					bExtraPrismOnLeftSideTop = (bDiffFrameThk & (lod3D = 1) & (offset_02 > EPS))
					if bExtraPrismOnLeftSideTop then
						put	-A/2+gs_frw1, TopHeightInny, 0, 8, matSash,
							-A/2+gs_frw1+offset_02, TopHeightInny-offset_02*(not(bArchedTop)), 0, mask1 - 2, matSash
						if iSimpleSashFrameType_02 = SIMPLESASH_SLIDEVER then
							SashBottomY	= lh+gs_frame_width_transom+offset_02
							SashTopY	= TopHeightInny-offset_02
							simpleSashX	= -A/2+gs_frw1+offset_02

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sash_width/2, 0, mask2, matSash
						endif
						put	-A/2+gs_frw1+offset_02, lh+gs_frame_width_transom+offset_02, 0, 8, matSash,
							-A/2+gs_frw1, lh, 0, 12, matLeaf

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick2,
							get(nsp)
						body 1
					endif

					put	-A/2 - cutDxLeft, -ovhgBottom, 0, mask1 - 7*gs_stack_left, matSash,
						-A/2 - cutDxLeft, TopHeighty, 0, 10 - 2*(gs_stack_top | gs_stack_left), matSash,
						-A/2+gs_frw1+offset_02*not(bExtraPrismOnLeftSideTop), TopHeightInny-offset_02*(not(bArchedTop))*not(bExtraPrismOnLeftSideTop), 0, mask1 - 2 - ((i = 1) & bExtraPrismOnLeftSideTop), matSash
					if (iSimpleSashFrameType_02 = SIMPLESASH_SLIDEVER) & not(bExtraPrismOnLeftSideTop) then
						SashBottomY	= lh+gs_frame_width_transom+offset_02
						SashTopY	= TopHeightInny-offset_02
						simpleSashX	= -A/2+gs_frw1+offset_02

						simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
						put simpleSashX, simpleSashDivy + gs_sash_width/2, 0, 8, matSash,
							simpleSashX, simpleSashDivy - gs_sash_width/2, 0, mask2, matSash
					endif
					if i = 1 | not(bDiffFrameThk) then
						put	-A/2+gs_frw1+offset_02*not(bExtraPrismOnLeftSideTop), lh+gs_frame_width_transom+offset_02, 0, mmask, matSash
					endif
					put	-A/2+gs_frw1+offset_leaf, lh-offset_leaf, 0, mask1 - 2, matLeaf,
						-A/2+gs_frw1+offset_leaf, -ovhgBottom, 0, mask1, matSash,
						-A/2 - cutDxLeft, -ovhgBottom, 0, mask1 - 7*gs_stack_left, matSash

					cprism_{2} mat1, botmat, matSash,
						nsp/5, framethick1,
						get(nsp)

					gosub 500
				endif

				if gs_sidelight_right then

					if not(gs_Transom_toRight) then
						bExtraPrismOnRightSide = (bDiffFrameThk & (lod3D = 1) & (offset_05 > EPS))
						if gs_bSidelight_fr_hdiv_right then
							bExtraPrismOnRightSideLower = (bDiffFrameThk & (lod3D = 1) & (offset_07 > EPS))
						else
							bExtraPrismOnRightSideLower = bExtraPrismOnRightSide
						endif

						if bExtraPrismOnRightSide | bExtraPrismOnRightSideLower then
							put	A/2-gs_frw2, TopHeightInny, 0, 8, matSash,
								A/2-gs_frw2-offset_05, TopHeightInny-offset_05, 0, mask1 - 2, matSash
							if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEVER then
								if gs_bSidelight_fr_hdiv_right then
									SashBottomY	= horizDivRightSideUpperPY
								else
									SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_05
								endif
								SashTopY	= TopHeightInny-offset_05
								simpleSashX	= A/2-gs_frw2-offset_05

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
							endif
							if gs_bSidelight_fr_hdiv_right then
								put horizDivRightSideRightUpperPX,	horizDivRightSideUpperPY, 0, 8,	matSash,
									horizDivRightSideRightLowerPX,	horizDivRightSideLowerPY, 0, mask2 - not(bExtraPrismOnRightSideLower),	matSash

								if (iSimpleSashFrameType_07 = SIMPLESASH_SLIDEVER) & bExtraPrismOnRightSideLower then
									SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_07
									SashTopY	= horizDivRightSideLowerPY
									simpleSashX	= horizDivRightSideRightLowerPX

									simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
									put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
										simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
								endif
								offset_i = offset_07
							else
								offset_i = offset_05
							endif
							put	A/2-gs_frw2-offset_i, RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, 8, matSash,
								A/2-gs_frw2-offset_i, RightSLParapet-ovhgBottomRight, 0, mask1, matSash,
								A/2-gs_frw2, RightSLParapet-ovhgBottomRight, 0, 12, matSash

							cprism_{2} mat1, botmat, matSash,
								nsp/5, framethick2,
								get(nsp)
							body 1
						endif

						put	A/2 + cutDxRight, RightSLParapet-ovhgBottomRight, 0, mask1 - 7*gs_stack_right, matSash,
							A/2 + cutDxRight, TopHeighty, 0, 10 - 2*(gs_stack_top | gs_stack_right), matSash,
							A/2-gs_frw2-offset_05*not(bExtraPrismOnRightSide), TopHeightInny-offset_05*not(bExtraPrismOnRightSide), 0, mask1 - 2 - ((i = 1) & bExtraPrismOnRightSide), matSash
						if (iSimpleSashFrameType_05 = SIMPLESASH_SLIDEVER) & not(bExtraPrismOnRightSide) then
							if gs_bSidelight_fr_hdiv_right then
								SashBottomY	= horizDivRightSideUpperPY
							else
								SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_05
							endif
							SashTopY	= TopHeightInny-offset_05
							simpleSashX	= A/2-gs_frw2-offset_05

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						if gs_bSidelight_fr_hdiv_right then
							put horizDivRightSideRightUpperPX+offset_05*bExtraPrismOnRightSide,	horizDivRightSideUpperPY, 0, mmask,	matSash,
								horizDivRightSideRightLowerPX+offset_07*bExtraPrismOnRightSideLower,	horizDivRightSideLowerPY, 0, mask2-bExtraPrismOnRightSideLower,	matSash

							if (iSimpleSashFrameType_07 = SIMPLESASH_SLIDEVER) & not(bExtraPrismOnRightSideLower) then
								SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_07
								SashTopY	= horizDivRightSideLowerPY
								simpleSashX	= horizDivRightSideRightLowerPX

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
							endif
							offset_i = offset_07
						else
							offset_i = offset_05
						endif
						if not(bDiffFrameThk) then
							put	A/2-gs_frw2-offset_i, RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, mmask, matSash
						else
							put	A/2-gs_frw2-offset_i*not(bExtraPrismOnRightSideLower), RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, 12, matSash,
								A/2-gs_frw2-offset_i*not(bExtraPrismOnRightSideLower), RightSLParapet-ovhgBottomRight, 0, mask1, matSash
						endif
						put	A/2 + cutDxRight, RightSLParapet-ovhgBottomRight, 0, -1, matSash

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick1,
							get(nsp)
						body 1
					else
						bExtraPrismOnRightSide = (bDiffFrameThk & (lod3D = 1) & (offset_05 > EPS))
						if gs_bSidelight_fr_hdiv_right then
							bExtraPrismOnRightSideLower = (bDiffFrameThk & (lod3D = 1) & (offset_07 > EPS))
						else
							bExtraPrismOnRightSideLower = bExtraPrismOnRightSide
						endif
						if gs_RightMullion_Top then
							offset_x = offset_06
							offset_y = offset_06
							iSimpleSashFrameType = iSimpleSashFrameType_06
						else
							offset_x = offset_02
							offset_y = offset_02
							iSimpleSashFrameType = iSimpleSashFrameType_02
						endif
						bExtraPrismOnRightSideTop = (bDiffFrameThk & (lod3D = 1) & (offset_x > EPS))

						if bExtraPrismOnRightSide | bExtraPrismOnRightSideTop | bExtraPrismOnRightSideLower then
							if bExtraPrismOnRightSideTop then
								put	A/2-gs_frw2, TopHeightInny, 0, 8, matSash,
									A/2-gs_frw2-offset_x, TopHeightInny-offset_y*(not(bArchedTop)), 0, mask1 - 2, matSash
								if iSimpleSashFrameType = SIMPLESASH_SLIDEVER then
									SashBottomY	= lh+gs_frame_width_transom+offset_y
									SashTopY	= TopHeightInny-offset_y
									simpleSashX	= A/2-gs_frw2-offset_x

									simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
									put simpleSashX, simpleSashDivy + gs_sash_width/2, 0, 8, matSash,
										simpleSashX, simpleSashDivy - gs_sash_width/2, 0, mask2, matSash
								endif
								put	A/2-gs_frw2-offset_x, lh+gs_frame_width_transom+offset_y, 0, 8, matSash
								if not(bExtraPrismOnRightSide) then
									put	A/2-gs_frw2, lh-offset_05, 0, 12, matSash
								endif

								if not(bExtraPrismOnRightSide) & bExtraPrismOnRightSideLower then
									cprism_{2} mat1, botmat, matSash,
										nsp/5, framethick2,
										get(nsp)
								endif
							endif
							if bExtraPrismOnRightSide | bExtraPrismOnRightSideLower then
								if bExtraPrismOnRightSide then
									put	A/2-gs_frw2-offset_05, lh-offset_05, 0, mask1 - 2, matSash
									if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEVER then
										if gs_bSidelight_fr_hdiv_right then
											SashBottomY	= horizDivRightSideUpperPY
										else
											SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_05
										endif
										SashTopY	= lh-offset_05
										simpleSashX	= A/2-gs_frw2-offset_05

										simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
										put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
											simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
									endif
								endif
								if gs_bSidelight_fr_hdiv_right then
									put horizDivRightSideRightUpperPX,	horizDivRightSideUpperPY, 0, 8,	matSash,
										horizDivRightSideRightLowerPX,	horizDivRightSideLowerPY, 0, mask2 - not(bExtraPrismOnRightSideLower),	matSash

									if (iSimpleSashFrameType_07 = SIMPLESASH_SLIDEVER) & bExtraPrismOnRightSideLower then
										SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_07
										SashTopY	= horizDivRightSideLowerPY
										simpleSashX	= horizDivRightSideRightLowerPX

										simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
										put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
											simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
									endif
									offset_i = offset_07
								else
									offset_i = offset_05
								endif
								if bExtraPrismOnRightSideLower then
									put	A/2-gs_frw2-offset_i, RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, 8, matSash,
										A/2-gs_frw2-offset_i, RightSLParapet-ovhgBottomRight, 0, mask1-2, matSash,
										A/2-gs_frw2, RightSLParapet-ovhgBottomRight, 0, 12, matSash
								endif
								if not(bExtraPrismOnRightSideTop) & bExtraPrismOnRightSide then
									put A/2-gs_frw2, lh+gs_frame_width_transom+offset_y, 0, 8, matSash
								endif
							endif

							cprism_{2} mat1, botmat, matSash,
								nsp/5, framethick2,
								get(nsp)
							body 1
						endif

						put	A/2 + cutDxRight, RightSLParapet-ovhgBottomRight, 0, mask1 - 7*gs_stack_right, matSash,
							A/2 + cutDxRight, TopHeighty, 0, 10 - 2*(gs_stack_top | gs_stack_right), matSash,
							A/2-gs_frw2-offset_x*not(bExtraPrismOnRightSideTop), TopHeightInny-offset_y*(not(bArchedTop))*not(bExtraPrismOnRightSideTop), 0, mask1 - 2 - ((i = 1) & bExtraPrismOnRightSideTop), matSash
						if (iSimpleSashFrameType = SIMPLESASH_SLIDEVER) & not(bExtraPrismOnRightSideTop) then
							SashBottomY	= lh+gs_frame_width_transom+offset_y
							SashTopY	= TopHeightInny-offset_y
							simpleSashX	= A/2-gs_frw2-offset_x

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sash_width/2, 0, mask2, matSash
						endif
						if i = 1 | not(bDiffFrameThk) then
							put	A/2-gs_frw2-offset_x*not(bExtraPrismOnRightSideTop), lh+gs_frame_width_transom+offset_y, 0, mmask, matSash
						endif
						put	A/2-gs_frw2-offset_05*not(bExtraPrismOnRightSide), lh-offset_05, 0, mask1 - 2 - ((i = 1) & bExtraPrismOnRightSide), matSash
						if (iSimpleSashFrameType_05 = SIMPLESASH_SLIDEVER) & not(bExtraPrismOnRightSide) then
							if gs_bSidelight_fr_hdiv_right then
								SashBottomY	= horizDivRightSideUpperPY
							else
								SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_05
							endif
							SashTopY	= lh-offset_05
							simpleSashX	= A/2-gs_frw2-offset_05

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						if gs_bSidelight_fr_hdiv_right then
							put horizDivRightSideRightUpperPX+offset_05*bExtraPrismOnRightSide,	horizDivRightSideUpperPY, 0, mmask,	matSash,
								horizDivRightSideRightLowerPX+offset_07*bExtraPrismOnRightSideLower,	horizDivRightSideLowerPY, 0, mask2-bExtraPrismOnRightSideLower,	matSash

							if (iSimpleSashFrameType_07 = SIMPLESASH_SLIDEVER) & not(bExtraPrismOnRightSideLower) then
								SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_07
								SashTopY	= horizDivRightSideLowerPY
								simpleSashX	= horizDivRightSideRightLowerPX

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
							endif
							offset_i = offset_07
						else
							offset_i = offset_05
						endif
						if not(bDiffFrameThk) then
							put	A/2-gs_frw2-offset_i, RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, mmask, matSash
						else
							put	A/2-gs_frw2-offset_i*not(bExtraPrismOnRightSideLower), RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, 12, matSash,
								A/2-gs_frw2-offset_i*not(bExtraPrismOnRightSideLower), RightSLParapet-ovhgBottomRight, 0, mask1, matSash
						endif
						put	A/2 + cutDxRight, RightSLParapet-ovhgBottomRight, 0, -1, matSash

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick1,
							get(nsp)
					endif

					gosub 500

					if gs_RightMullion_Top then
						if gs_Transom_toRight then
							put	A/2-gs_sl_w2+gs_frw_Sl_right+offset_06, B-gs_frwt-offset_06, 0, mask1, matSash
							if iSimpleSashFrameType_06 = SIMPLESASH_SLIDEVER then
								SashBottomY	= lh+gs_frame_width_transom+offset_06
								SashTopY	= B-gs_frwt-offset_06
								simpleSashX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_06

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sash_width/2, 0, mask2, matSash
							endif
							put	A/2-gs_sl_w2+gs_frw_Sl_right+offset_06, lh+gs_frame_width_transom+offset_06, 0, 10, matSash,
								A/2-gs_sl_w2+gs_frw_Sl_right+offset_05, lh-offset_05, 0, mask1, matSash
						else
							put	A/2-gs_sl_w2+gs_frw_Sl_right+offset_05, B-gs_frwt-offset_05, 0, mask1, matSash
						endif
					else
						put	A/2-gs_sl_w2+gs_frw_Sl_right+offset_05, lh-offset_05, 0, mask1, matSash
					endif
					if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEVER then
						if gs_bSidelight_fr_hdiv_right then
							SashBottomY	= horizDivRightSideUpperPY
						else
							SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_05
						endif
						if gs_Transom_toRight then
							SashTopY = lh-offset_05
						else
							SashTopY = B-gs_frwt-offset_05
						endif
						simpleSashX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_05

						simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
						put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
							simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
					endif
					if gs_bSidelight_fr_hdiv_right then
						put horizDivRightSideLeftUpperPX,	horizDivRightSideUpperPY, 0, 8,		matSash,
							horizDivRightSideLeftLowerPX,	horizDivRightSideLowerPY, 0, mask2,	matSash

						if iSimpleSashFrameType_07 = SIMPLESASH_SLIDEVER then
							SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_07
							SashTopY	= horizDivRightSideLowerPY
							simpleSashX	= horizDivRightSideLeftLowerPX

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						offset_i = offset_07
					else
						offset_i = offset_05
					endif
					if RightSLParapet > EPS then
						put A/2-gs_sl_w2+gs_frw_Sl_right+offset_i, RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, 10, matSash,
							A/2-gs_sl_w2+gs_frw_SlParapet_right+gs_tolerance_right_2, RightSLParapet-ovhgBottomRight, 0, mask1, matSash,
							A/2-gs_sl_w2+gs_frw_SlParapet_right+gs_tolerance_right_2, -ovhgBottom, 0, mask1, matSash,
							A/2-gs_sl_w2-offset_leaf, -ovhgBottom, 0, mask3, matLeaf
					else
						put A/2-gs_sl_w2+gs_frw_Sl_right+offset_i, gs_frame_width_low_right_sl+offset_i, 0, 10, matSash,
							A/2-gs_sl_w2-offset_leaf, -ovhgBottom, 0, mask3 - 2, matLeaf
					endif
					if gs_RightMullion_Top then
						if gs_Transom_toRight then
							put	A/2-gs_sl_w2-offset_leaf, lh-offset_leaf, 0, 10, matSash,
								A/2-gs_sl_w2-offset_02, lh+gs_frame_width_transom+offset_02, 0, mask1, matSash
							if iSimpleSashFrameType_02 = SIMPLESASH_SLIDEVER then
								SashBottomY	= lh+gs_frame_width_transom+offset_02
								SashTopY	= B-gs_frwt-offset_02
								simpleSashX	= A/2-gs_sl_w2-offset_02

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy - gs_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy + gs_sash_width/2, 0, mask2, matSash
							endif
							put	A/2-gs_sl_w2-offset_02, B-gs_frwt-offset_02, 0, 10+4*(bNoExtraPrismOnRightTop | (bDiffFrameThk & (lod3D = 2))), matSash,
								A/2-gs_sl_w2+gs_frw_Sl_right+offset_06, B-gs_frwt-offset_06, 0, -1, matSash
						else
							put	A/2-gs_sl_w2-offset_leaf, lh-offset_leaf, 0, 10, matSash,
								A/2-gs_sl_w2-offset_02, lh+gs_frame_width_transom+offset_02, 0, mask1, matSash
							if iSimpleSashFrameType_02 = SIMPLESASH_SLIDEVER then
								SashBottomY	= lh+gs_frame_width_transom+offset_02
								SashTopY	= B-gs_frwt-offset_02
								simpleSashX	= A/2-gs_sl_w2-offset_02

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy - gs_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy + gs_sash_width/2, 0, mask2, matSash
							endif
							put	A/2-gs_sl_w2-offset_02, B-gs_frwt-offset_02, 0, 10+4*(bNoExtraPrismOnRightTop | (bDiffFrameThk & (lod3D = 2))), matSash,
								A/2-gs_sl_w2+gs_frw_Sl_right+offset_05, B-gs_frwt-offset_05, 0, -1, matSash
						endif
					else
						put	A/2-gs_sl_w2-offset_leaf, lh-offset_leaf, 0, 10, matSash,
							A/2-gs_sl_w2+gs_frw_Sl_right+offset_05, lh-offset_05, 0, -1, matSash
					endif

					cprism_{2} mat1, botmat, matSash,
						nsp/5, framethick2,
						get(nsp)

					gosub 500

					if gs_bSidelight_fr_hdiv_right then
						iSimpleSashFrameType_i = iSimpleSashFrameType_07
						offset_i = offset_07
					else
						iSimpleSashFrameType_i = iSimpleSashFrameType_05
						offset_i = offset_05
					endif
					put	A/2-gs_sl_w2+gs_frw_Sl_right+offset_i, RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, 10, matSash,
						A/2-gs_sl_w2+(gs_frw_SlParapet_right+gs_tolerance_right_2) * (RightSLParapet>0), RightSLParapet-ovhgBottomRight, 0, mask1, matSash,
						A/2-(gs_frw2+offset_i)*bDiffFrameThk+gs_tolerance_right*not(bDiffFrameThk), RightSLParapet-ovhgBottomRight, 0, mmask2-4*bExtraPrismOnRightSideLower - 2*gs_stack_right, matSash,
						A/2-gs_frw2-offset_i, RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, mask1, matSash
					if iSimpleSashFrameType_i = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_i = SIMPLESASH_SIDEHUNG then
						SashLeftX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_i
						SashRightX	= A/2-gs_frw2-offset_i
						simpleSashZ	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i

						simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
						if iSimpleSashFrameType_i = SIMPLESASH_SLIDEHOR then
							put simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
								simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
						else
							put simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
								simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
						endif
					endif

					cprism_{2} mat1, botmat, matSash,
						nsp/5, framethick2,
						get(nsp)

					gosub 600
				else
					bExtraPrismOnRightSideTop = (bDiffFrameThk & (lod3D = 1) & (offset_02 > EPS))
					if bExtraPrismOnRightSideTop then
						put	A/2-gs_frw2, TopHeightInny, 0, 8, matSash
						put	A/2-gs_frw2-offset_02, TopHeightInny-offset_02*(not(bArchedTop)), 0, mask1 - 2, matSash
						if iSimpleSashFrameType_02 = SIMPLESASH_SLIDEVER then
							SashBottomY	= lh+gs_frame_width_transom+offset_02
							SashTopY	= TopHeightInny-offset_02
							simpleSashX	= A/2-gs_frw2-offset_02

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sash_width/2, 0, mask2, matSash
						endif
						put	A/2-gs_frw2-offset_02, lh+gs_frame_width_transom+offset_02, 0, 8, matSash,
							A/2-gs_frw2, lh, 0, 12, matLeaf

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick2,
							get(nsp)
						body 1
					endif

					put	A/2 + cutDxRight, -ovhgBottom, 0, mask1 - 7*gs_stack_right, matSash,
						A/2 + cutDxRight, TopHeighty, 0, 10 - 2*(gs_stack_top | gs_stack_right), matSash,
						A/2-gs_frw2-offset_02*not(bExtraPrismOnRightSideTop), TopHeightInny-offset_02*(not(bArchedTop))*not(bExtraPrismOnRightSideTop), 0, mask1 - 2 - ((i = 1) & bExtraPrismOnRightSideTop), matSash
					if (iSimpleSashFrameType_02 = SIMPLESASH_SLIDEVER) & not(bExtraPrismOnRightSideTop) then
						SashBottomY	= lh+gs_frame_width_transom+offset_02
						SashTopY	= TopHeightInny-offset_02
						simpleSashX	= A/2-gs_frw2-offset_02

						simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
						put simpleSashX, simpleSashDivy + gs_sash_width/2, 0, 8, matSash,
							simpleSashX, simpleSashDivy - gs_sash_width/2, 0, mask2, matSash
					endif
					if i = 1 | not(bDiffFrameThk) then
						put	A/2-gs_frw2-offset_02*not(bExtraPrismOnRightSideTop), lh+gs_frame_width_transom+offset_02, 0, mmask, matSash
					endif
					put	A/2-gs_frw2-offset_leaf, lh-offset_leaf, 0, mask1 - 2, matLeaf,
						A/2-gs_frw2-offset_leaf, -ovhgBottom, 0, mask1, matSash,
						A/2 + cutDxRight, -ovhgBottom, 0, -1, matSash

					cprism_{2} mat1, botmat, matSash,
						nsp/5, framethick1,
						get(nsp)

					gosub 500
				endif

				if gs_pocket_door_frame & lod3D <> 5 then
					cutend
					if n=2 then cutend
				endif

				if bArchedTop then
					cprism_{2} mat1, botmat, matSash,
						7, framethick1,
						-A/2 - cutDxLeft, gs_shoulder_h, 0, mask1 + 64, matSash,
						0, frametop - r2, 0, 900, matSash,
						0, b + cutDy, 0, 3064 + mask1, matSash,
						A/2 + cutDxRight, gs_shoulder_h, 0, 3010, matSash,
						A/2-gs_frw2-offset_02, gs_shoulder_h-(fce-fcefw), 0, mask1 + 64, matSash,
						0, B-gs_frwt-offset_02, 0, 3064 + mask1, matSash,
						-A/2+gs_frw1+offset_02,  gs_shoulder_h-(fce-fcefw), 0, 3010, matSash
				else
					bExtraPrismOnTop_02 = 0
					bExtraPrismOnTopLeft = 0
					bExtraPrismOnTopRight = 0

					bExtraPrismOnTop_02 = (bDiffFrameThk & (lod3D = 1) & (offset_02 > EPS))
					if gs_sidelight_left & gs_LeftMullion_Top then
						if gs_Transom_toLeft then
							iSimpleSashFrameTypeL = iSimpleSashFrameType_10
							offset_xL = offset_10
							offset_yL = offset_10
							sashWidthL = gs_sash_width
						else
							iSimpleSashFrameTypeL = iSimpleSashFrameType_09
							offset_xL = offset_09
							offset_yL = offset_09
							sashWidthL = gs_sl_sash_width
						endif
					else
						offset_xL = offset_02
						offset_yL = offset_02
						sashWidthL = gs_sash_width
					endif
					bExtraPrismOnTopLeft = (bDiffFrameThk & (lod3D = 1) & (offset_xL > EPS))

					if gs_sidelight_right & gs_RightMullion_Top then
						if gs_Transom_toRight then
							iSimpleSashFrameTypeR = iSimpleSashFrameType_06
							offset_xR = offset_06
							offset_yR = offset_06
							sashWidthR = gs_sash_width
						else
							iSimpleSashFrameTypeR = iSimpleSashFrameType_05
							offset_xR = offset_05
							offset_yR = offset_05
							sashWidthR = gs_sl_sash_width
						endif
					else
						offset_xR = offset_02
						offset_yR = offset_02
						sashWidthR = gs_sash_width
					endif
					bExtraPrismOnTopRight = (bDiffFrameThk & (lod3D = 1) & (offset_xR > EPS))

					if bExtraPrismOnTop_02 | bExtraPrismOnTopLeft | bExtraPrismOnTopRight then
						put	-A/2+gs_frw1, B-gs_frwt, 0, 8, matSash,
							-A/2+gs_frw1+offset_xL, B-gs_frwt-offset_yL, 0, mask1, matSash

						if gs_sidelight_left & gs_LeftMullion_Top then
							if iSimpleSashFrameTypeL = SIMPLESASH_SLIDEHOR | iSimpleSashFrameTypeL = SIMPLESASH_SIDEHUNG then
								SashLeftX	= -A/2+gs_frw1+offset_xL
								SashRightX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_xL
								simpleSashZ	= B-gs_frwt-offset_yL

								simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
								if iSimpleSashFrameTypeL = SIMPLESASH_SLIDEHOR then
									put simpleSashDivx - sashWidthL/2, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + sashWidthL/2, simpleSashZ, 0, mask2, matSash
								else
									put simpleSashDivx - sashWidthL, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + sashWidthL, simpleSashZ, 0, mask2, matSash
								endif
							endif

							put -A/2+gs_sl_w1-gs_frw_Sl_left-offset_xL,  B-gs_frwt-offset_yL, 0, 10, matSash,
								-A/2+gs_sl_w1+offset_02,  B-gs_frwt-offset_02, 0, mask1,  matSash
						endif

						if iSimpleSashFrameType_02 = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_02 = SIMPLESASH_SIDEHUNG then
							if gs_sidelight_left & gs_LeftMullion_Top then
								SashLeftX = -A/2+gs_sl_w1+offset_02
							else
								SashLeftX = -A/2+gs_frw1+offset_02
							endif
							if gs_sidelight_right & gs_RightMullion_Top then
								SashRightX = A/2-gs_sl_w2-offset_02
							else
								SashRightX = A/2-gs_frw2-offset_02
							endif
							simpleSashZ	= B-gs_frwt-offset_02

							simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
							if iSimpleSashFrameType_02 = SIMPLESASH_SLIDEHOR then
								put simpleSashDivx - gs_sash_width/2, simpleSashZ, 0, 8, matSash,
									simpleSashDivx + gs_sash_width/2, simpleSashZ, 0, mask2, matSash
							else
								put simpleSashDivx - gs_sash_width, simpleSashZ, 0, 8, matSash,
									simpleSashDivx + gs_sash_width, simpleSashZ, 0, mask2, matSash
							endif
						endif

						if gs_sidelight_right & gs_RightMullion_Top then
							put A/2-gs_sl_w2-offset_02,  B-gs_frwt-offset_02, 0, 10, matSash,
								A/2-gs_sl_w2+gs_frw_Sl_right+offset_xR,  B-gs_frwt-offset_yR, 0, mask1, matSash

							if iSimpleSashFrameTypeR = SIMPLESASH_SLIDEHOR | iSimpleSashFrameTypeR = SIMPLESASH_SIDEHUNG then
								SashLeftX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_xR
								SashRightX	= A/2-gs_frw2-offset_xR
								simpleSashZ	= B-gs_frwt-offset_yR

								simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
								if iSimpleSashFrameTypeR = SIMPLESASH_SLIDEHOR then
									put simpleSashDivx - sashWidthR/2, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + sashWidthR/2, simpleSashZ, 0, mask2, matSash
								else
									put simpleSashDivx - sashWidthR, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + sashWidthR, simpleSashZ, 0, mask2, matSash
								endif
							endif
						endif

						put	A/2-gs_frw2-offset_xR, B-gs_frwt-offset_yR, 0, 10, matSash,
							A/2-gs_frw2, B-gs_frwt-offset_yR*not(bExtraPrismOnTopRight), 0, 12, matSash

						cprism_{2} mat1, botmat, matSash,
								nsp/5, framethick2,
								get(nsp)
						body 1
					endif

					if abs(cutDy + gs_frwt + offset_yL*not(bExtraPrismOnTopLeft)) > EPS then	! avoiding self intersect. prism
						put	-A/2 - cutDxLeft, b + cutDy, 0, 10 - 2*(gs_stack_top | gs_stack_left), matSash,
							-A/2+gs_frw1+offset_xL*not(bExtraPrismOnTopLeft), B-gs_frwt-offset_yL*not(bExtraPrismOnTopLeft), 0, mask1 - ((i = 1) & bExtraPrismOnTopLeft), matSash
					endif

					if gs_sidelight_left & gs_LeftMullion_Top then
						if offset_yL*not(bExtraPrismOnTopLeft) > EPS | offset_02*not(bExtraPrismOnTop_02) > EPS | gs_frwt > EPS then	! avoiding self intersect. prism
							if (iSimpleSashFrameTypeL = SIMPLESASH_SLIDEHOR | iSimpleSashFrameTypeL = SIMPLESASH_SIDEHUNG) & not(bExtraPrismOnTopLeft) then
								SashLeftX	= -A/2+gs_frw1+offset_xL
								SashRightX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_xL
								simpleSashZ	= B-gs_frwt-offset_yL

								simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
								if iSimpleSashFrameTypeL = SIMPLESASH_SLIDEHOR then
									put simpleSashDivx - sashWidthL/2, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + sashWidthL/2, simpleSashZ, 0, mask2, matSash
								else
									put simpleSashDivx - sashWidthL, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + sashWidthL, simpleSashZ, 0, mask2, matSash
								endif
							endif
							put -A/2+gs_sl_w1-gs_frw_Sl_left-offset_xL, B-gs_frwt-offset_yL*not(bExtraPrismOnTopLeft), 0, 10+2*bDiffFrameThk, matSash,
								-A/2+gs_sl_w1+offset_02, B-gs_frwt-offset_02*not(bExtraPrismOnTop_02), 0, mask1-2*bDiffFrameThk - ((i = 1) & bExtraPrismOnTop_02),  matSash
						endif
					endif

					if (iSimpleSashFrameType_02 = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_02 = SIMPLESASH_SIDEHUNG) & not(bExtraPrismOnTop_02) then
						if gs_sidelight_left & gs_LeftMullion_Top then
							SashLeftX = -A/2+gs_sl_w1+offset_02
						else
							SashLeftX = -A/2+gs_frw1+offset_02
						endif
						if gs_sidelight_right & gs_RightMullion_Top then
							SashRightX = A/2-gs_sl_w2-offset_02
						else
							SashRightX = A/2-gs_frw2-offset_02
						endif
						simpleSashZ	= B-gs_frwt-offset_02

						simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
						if iSimpleSashFrameType_02 = SIMPLESASH_SLIDEHOR then
							put simpleSashDivx - gs_sash_width/2, simpleSashZ, 0, 8, matSash,
								simpleSashDivx + gs_sash_width/2, simpleSashZ, 0, mask2, matSash
						else
							put simpleSashDivx - gs_sash_width, simpleSashZ, 0, 8, matSash,
								simpleSashDivx + gs_sash_width, simpleSashZ, 0, mask2, matSash
						endif
					endif

					if gs_sidelight_right & gs_RightMullion_Top then
						if offset_yR*not(bExtraPrismOnTopRight) > EPS | offset_02*not(bExtraPrismOnTop_02) > EPS | gs_frwt > EPS then	! avoiding self intersect. prism
							put A/2-gs_sl_w2-offset_02,  B-gs_frwt-offset_02*not(bExtraPrismOnTop_02), 0, 10+2*bDiffFrameThk, matSash,
								A/2-gs_sl_w2+gs_frw_Sl_right+offset_xR,  B-gs_frwt-offset_yR*not(bExtraPrismOnTopRight), 0, mask1-2*bDiffFrameThk - ((i = 1) & bExtraPrismOnTopRight), matSash
							if (iSimpleSashFrameTypeR = SIMPLESASH_SLIDEHOR | iSimpleSashFrameTypeR = SIMPLESASH_SIDEHUNG) & not(bExtraPrismOnTopRight) then
								SashLeftX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_xR
								SashRightX	= A/2-gs_frw2-offset_xR
								simpleSashZ	= B-gs_frwt-offset_yR

								simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
								if iSimpleSashFrameTypeR = SIMPLESASH_SLIDEHOR then
									put simpleSashDivx - sashWidthR/2, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + sashWidthR/2, simpleSashZ, 0, mask2, matSash
								else
									put simpleSashDivx - sashWidthR, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + sashWidthR, simpleSashZ, 0, mask2, matSash
								endif
							endif
						endif
					endif

					if abs(cutDy + gs_frwt + offset_yR*not(bExtraPrismOnTopRight)) > EPS then	! avoiding self intersect. prism
						put	A/2-gs_frw2-offset_xR*not(bExtraPrismOnTopRight), B-gs_frwt-offset_yR*not(bExtraPrismOnTopRight), 0, 10 - 2*(gs_stack_top | gs_stack_right), matSash,
							A/2 + cutDxRight, b + cutDy, 0, mask1 - 2*(gs_stack_top | gs_stack_right) - 5*gs_stack_top, matSash
					endif
					if nsp > 0 then
						cprism_{2} mat1, botmat, matSash,
								nsp/5, framethick1,
								get(nsp)
					endif
				endif

				gosub 600

			endif


			if gs_SashText_typ_num = 2 then		! Butt Joint

				if gs_pocket_door_frame & lod3D <> 5 then
					cutHeight = TopHeightInny
					gosub "Pocket Door Cutting"
				endif

				if gs_sidelight_left then
					if not(gs_Transom_toLeft) then
						bExtraPrismOnLeftSide = (bDiffFrameThk & (lod3D = 1) & (offset_09 > EPS))
						if gs_bSidelight_fr_hdiv_left then
							bExtraPrismOnLeftSideLower = (bDiffFrameThk & (lod3D = 1) & (offset_11 > EPS))
						else
							bExtraPrismOnLeftSideLower = bExtraPrismOnLeftSide
						endif

						if bExtraPrismOnLeftSide | bExtraPrismOnLeftSideLower then
							put	-A/2+gs_frw1, TopHeightInny-offset_09, 0, 8, matSash,
								-A/2+gs_frw1+offset_09, TopHeightInny-offset_09, 0, mask1 - 2, matSash
							if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEVER then
								if gs_bSidelight_fr_hdiv_left then
									SashBottomY	= horizDivLeftSideUpperPY
								else
									SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_09
								endif
								SashTopY	= TopHeightInny-offset_09
								simpleSashX	= -A/2+gs_frw1+offset_09

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
							endif
							if gs_bSidelight_fr_hdiv_left then
								put horizDivLeftSideLeftUpperPX,	horizDivLeftSideUpperPY, 0, 8,	matSash,
									horizDivLeftSideLeftLowerPX,	horizDivLeftSideLowerPY, 0, mask2 - not(bExtraPrismOnLeftSideLower),	matSash

								if (iSimpleSashFrameType_11 = SIMPLESASH_SLIDEVER) & bExtraPrismOnLeftSideLower then
									SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_11
									SashTopY	= horizDivLeftSideLowerPY
									simpleSashX	= horizDivLeftSideLeftLowerPX

									simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
									put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
										simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
								endif
								offset_i = offset_11
							else
								offset_i = offset_09
							endif
							put	-A/2+gs_frw1+offset_i, LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, 8, matSash,
								-A/2+gs_frw1+offset_i, LeftSLParapet-ovhgBottomLeft, 0, mask1, matSash,
								-A/2+gs_frw1, LeftSLParapet-ovhgBottomLeft, 0, 12, matSash

							cprism_{2} mat1, botmat, matSash,
								nsp/5, framethick2,
								get(nsp)
							body 1
						endif

						put	-A/2 - cutDxLeft, LeftSLParapet-ovhgBottomLeft, 0, mask1 - 7*gs_stack_left, matSash,
							-A/2 - cutDxLeft, TopHeighty-offset_09*not(bExtraPrismOnLeftSide), 0, 8, matSash,
							-A/2+gs_frw1+offset_09*not(bExtraPrismOnLeftSide), TopHeightInny-offset_09*not(bExtraPrismOnLeftSide), 0, mask1 - 2 - ((i = 1) & bExtraPrismOnLeftSide), matSash
						if (iSimpleSashFrameType_09 = SIMPLESASH_SLIDEVER) & not(bExtraPrismOnLeftSide) then
							if gs_bSidelight_fr_hdiv_left then
								SashBottomY	= horizDivLeftSideUpperPY
							else
								SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_09
							endif
							SashTopY	= TopHeightInny-offset_09
							simpleSashX	= -A/2+gs_frw1+offset_09

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						if gs_bSidelight_fr_hdiv_left then
							put horizDivLeftSideLeftUpperPX - offset_09*bExtraPrismOnLeftSide,	horizDivLeftSideUpperPY, 0, mmask,	matSash,
								horizDivLeftSideLeftLowerPX - offset_11*bExtraPrismOnLeftSideLower,	horizDivLeftSideLowerPY, 0, mask2-bExtraPrismOnLeftSideLower,	matSash

							if (iSimpleSashFrameType_11 = SIMPLESASH_SLIDEVER) & not(bExtraPrismOnLeftSideLower) then
								SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_11
								SashTopY	= horizDivLeftSideLowerPY
								simpleSashX	= horizDivLeftSideLeftLowerPX

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
							endif
							offset_i = offset_11
						else
							offset_i = offset_09
						endif
						if i = 1 | not(bDiffFrameThk) then
							put	-A/2+gs_frw1+offset_i*not(bExtraPrismOnLeftSideLower), LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, mmask, matSash
						endif
						put	-A/2+gs_frw1+offset_i*not(bExtraPrismOnLeftSideLower), LeftSLParapet-ovhgBottomLeft, 0, mask1, matSash,
							-A/2 - cutDxLeft, LeftSLParapet-ovhgBottomLeft, 0, -1, matSash

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick1,
							get(nsp)
					else
						bExtraPrismOnLeftSide = (bDiffFrameThk & (lod3D = 1) & (offset_09 > EPS))
						if gs_bSidelight_fr_hdiv_left then
							bExtraPrismOnLeftSideLower = (bDiffFrameThk & (lod3D = 1) & (offset_11 > EPS))
						else
							bExtraPrismOnLeftSideLower = bExtraPrismOnLeftSide
						endif

						if gs_LeftMullion_Top then
							offset_x = offset_10
							offset_y = offset_10
							iSimpleSashFrameType = iSimpleSashFrameType_10
						else
							offset_x = offset_02
							offset_y = offset_02
							iSimpleSashFrameType = iSimpleSashFrameType_02
						endif
						bExtraPrismOnLeftSideTop = (bDiffFrameThk & (lod3D = 1) & (offset_x > EPS))

						if bExtraPrismOnLeftSide | bExtraPrismOnLeftSideTop | bExtraPrismOnLeftSideLower then
							if bExtraPrismOnLeftSideTop then
								put	-A/2+gs_frw1, TopHeightInny-offset_y*(not(bArchedTop)), 0, 8, matSash,
									-A/2+gs_frw1+offset_x, TopHeightInny-offset_y*(not(bArchedTop)), 0, mask1 - 2, matSash
								if iSimpleSashFrameType = SIMPLESASH_SLIDEVER then
									SashBottomY	= lh+gs_frame_width_transom+offset_y
									SashTopY	= TopHeightInny-offset_y
									simpleSashX	= -A/2+gs_frw1+offset_x

									simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
									put simpleSashX, simpleSashDivy + gs_sash_width/2, 0, 8, matSash,
										simpleSashX, simpleSashDivy - gs_sash_width/2, 0, mask2, matSash
								endif
								put	-A/2+gs_frw1+offset_x, lh+gs_frame_width_transom+offset_y, 0, 8, matSash
								if not(bExtraPrismOnLeftSide) then
									put	-A/2+gs_frw1, lh-offset_09, 0, 12, matSash
								endif

								if not(bExtraPrismOnLeftSide) & bExtraPrismOnLeftSideLower then
									cprism_{2} mat1, botmat, matSash,
										nsp/5, framethick2,
										get(nsp)
								endif
							endif
							if bExtraPrismOnLeftSide | bExtraPrismOnLeftSideLower then
								if bExtraPrismOnLeftSide then
									put	-A/2+gs_frw1+offset_09, lh-offset_09, 0, mask1 - 2, matSash
									if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEVER then
										if gs_bSidelight_fr_hdiv_left then
											SashBottomY	= horizDivLeftSideUpperPY
										else
											SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_09
										endif
										SashTopY	= lh-offset_09
										simpleSashX	= -A/2+gs_frw1+offset_09

										simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
										put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
											simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
									endif
								endif
								if gs_bSidelight_fr_hdiv_left then
									put horizDivLeftSideLeftUpperPX,	horizDivLeftSideUpperPY, 0, 8,	matSash,
										horizDivLeftSideLeftLowerPX,	horizDivLeftSideLowerPY, 0, mask2 - not(bExtraPrismOnLeftSideLower),	matSash

									if (iSimpleSashFrameType_11 = SIMPLESASH_SLIDEVER) & bExtraPrismOnLeftSideLower then
										SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_11
										SashTopY	= horizDivLeftSideLowerPY
										simpleSashX	= horizDivLeftSideLeftLowerPX

										simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
										put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
											simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
									endif
									offset_i = offset_11
								else
									offset_i = offset_09
								endif
								if bExtraPrismOnLeftSideLower then
									put	-A/2+gs_frw1+offset_i, LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, 8, matSash,
										-A/2+gs_frw1+offset_i, LeftSLParapet-ovhgBottomLeft, 0, mask1-2, matSash,
										-A/2+gs_frw1, LeftSLParapet-ovhgBottomLeft, 0, 12, matSash
								endif
								if not(bExtraPrismOnLeftSideTop) & bExtraPrismOnLeftSide then
									put	-A/2+gs_frw1, lh+gs_frame_width_transom+offset_y, 0, 8, matSash
								endif
							endif

							cprism_{2} mat1, botmat, matSash,
								nsp/5, framethick2,
								get(nsp)
							body 1
						endif

						put	-A/2 - cutDxLeft, LeftSLParapet-ovhgBottomLeft, 0, mask1 - 7*gs_stack_left, matSash,
							-A/2 - cutDxLeft, TopHeighty-offset_y*(not(bArchedTop))*not(bExtraPrismOnLeftSideTop), 0, 8, matSash,
							-A/2+gs_frw1+offset_x*not(bExtraPrismOnLeftSideTop), TopHeightInny-offset_y*(not(bArchedTop))*not(bExtraPrismOnLeftSideTop), 0, mask1 - 2 - ((i = 1) & bExtraPrismOnLeftSideTop), matSash
						if (iSimpleSashFrameType = SIMPLESASH_SLIDEVER) & not(bExtraPrismOnLeftSideTop) then
							SashBottomY	= lh+gs_frame_width_transom+offset_y
							SashTopY	= TopHeightInny-offset_y
							simpleSashX	= -A/2+gs_frw1+offset_x

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sash_width/2, 0, mask2, matSash
						endif
						if i = 1 | not(bDiffFrameThk) then
							put	-A/2+gs_frw1+offset_x*not(bExtraPrismOnLeftSideTop), lh+gs_frame_width_transom+offset_y, 0, mmask, matSash
						endif
						put	-A/2+gs_frw1+offset_09*not(bExtraPrismOnLeftSide), lh-offset_09, 0, mask1 - 2 - ((i = 1) & bExtraPrismOnLeftSide), matSash
						if (iSimpleSashFrameType_09 = SIMPLESASH_SLIDEVER) & not(bExtraPrismOnLeftSide) then
							if gs_bSidelight_fr_hdiv_left then
								SashBottomY	= horizDivLeftSideUpperPY
							else
								SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_09
							endif
							SashTopY	= lh-offset_09
							simpleSashX	= -A/2+gs_frw1+offset_09

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						if gs_bSidelight_fr_hdiv_left then
							put horizDivLeftSideLeftUpperPX-offset_09*bExtraPrismOnLeftSide,	horizDivLeftSideUpperPY, 0, mmask,	matSash,
								horizDivLeftSideLeftLowerPX-offset_11*bExtraPrismOnLeftSideLower,	horizDivLeftSideLowerPY, 0, mask2-bExtraPrismOnLeftSideLower,	matSash

							if (iSimpleSashFrameType_11 = SIMPLESASH_SLIDEVER) & not(bExtraPrismOnLeftSideLower) then
								SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_11
								SashTopY	= horizDivLeftSideLowerPY
								simpleSashX	= horizDivLeftSideLeftLowerPX

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
							endif
							offset_i = offset_11
						else
							offset_i = offset_09
						endif
						if i = 1 | not(bDiffFrameThk) then
							put	-A/2+gs_frw1+offset_i*not(bExtraPrismOnLeftSideLower), LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, mmask, matSash
						endif
						put	-A/2+gs_frw1+offset_i*not(bExtraPrismOnLeftSideLower), LeftSLParapet-ovhgBottomLeft, 0, mask1, matSash,
							-A/2 - cutDxLeft, LeftSLParapet-ovhgBottomLeft, 0, -1, matSash

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick1,
							get(nsp)
					endif

					gosub 500

					if gs_LeftMullion_Top then
						if gs_Transom_toLeft then
							put	-A/2+gs_sl_w1-gs_frw_Sl_left-offset_10, B-gs_frwt-offset_10, 0, mask1, matSash
							if iSimpleSashFrameType_10 = SIMPLESASH_SLIDEVER then
								SashBottomY	= lh+gs_frame_width_transom+offset_10
								SashTopY	= B-gs_frwt-offset_10
								simpleSashX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_10

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sash_width/2, 0, mask2, matSash
							endif
							put	-A/2+gs_sl_w1-gs_frw_Sl_left-offset_10, lh+gs_frame_width_transom+offset_10, 0, 10, matSash,
								-A/2+gs_sl_w1-gs_frw_Sl_left-offset_09, lh-offset_09, 0, mask1, matSash
						else
							put	-A/2+gs_sl_w1-gs_frw_Sl_left-offset_09, B-gs_frwt-offset_09, 0, mask1, matSash
						endif
					else
						put	-A/2+gs_sl_w1-gs_frw_Sl_left-offset_09, lh-offset_09, 0, mask1, matSash
					endif
					if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEVER then
						if gs_bSidelight_fr_hdiv_left then
							SashBottomY	= horizDivLeftSideUpperPY
						else
							SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_09
						endif
						if gs_Transom_toLeft then
							SashTopY = lh-offset_09
						else
							SashTopY = B-gs_frwt-offset_09
						endif
						simpleSashX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_09

						simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
						put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
							simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
					endif
					if gs_bSidelight_fr_hdiv_left then
						put horizDivLeftSideRightUpperPX,	horizDivLeftSideUpperPY, 0, 8,		matSash,
							horizDivLeftSideRightLowerPX,	horizDivLeftSideLowerPY, 0, mask2,	matSash

						if iSimpleSashFrameType_11 = SIMPLESASH_SLIDEVER then
							SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_11
							SashTopY	= horizDivLeftSideLowerPY
							simpleSashX	= horizDivLeftSideRightLowerPX

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						offset_i = offset_11
					else
						offset_i = offset_09
					endif
					if LeftSLParapet > EPS then
						put -A/2+gs_sl_w1-gs_frw_Sl_left-offset_i, LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, 10, matSash,
							-A/2+gs_sl_w1-gs_frw_SlParapet_left-gs_tolerance_left_2, LeftSLParapet-ovhgBottomLeft, 0, mask1, matSash,
							-A/2+gs_sl_w1-gs_frw_SlParapet_left-gs_tolerance_left_2, -ovhgBottom, 0, mask1, matSash,
							-A/2+gs_sl_w1+offset_leaf, -ovhgBottom, 0, mask3, matLeaf
					else
						put -A/2+gs_sl_w1-gs_frw_Sl_left-offset_i, gs_frame_width_low_left_sl+offset_i, 0, 10, matSash,
							-A/2+gs_sl_w1-gs_frw_Sl_left, -ovhgBottom, 0, mask2, matSash,
							-A/2+gs_sl_w1+offset_leaf, -ovhgBottom, 0, mask1, matLeaf
					endif
					if gs_LeftMullion_Top then
						if gs_Transom_toLeft then
							put	-A/2+gs_sl_w1+offset_leaf, lh-offset_leaf, 0, 10, matSash,
								-A/2+gs_sl_w1+offset_02, lh+gs_frame_width_transom+offset_02, 0, mask1, matSash
							if iSimpleSashFrameType_02 = SIMPLESASH_SLIDEVER then
								SashBottomY	= lh+gs_frame_width_transom+offset_02
								SashTopY	= B-gs_frwt-offset_02
								simpleSashX	= -A/2+gs_sl_w1+offset_02

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy - gs_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy + gs_sash_width/2, 0, mask2, matSash
							endif
							put	-A/2+gs_sl_w1+offset_02, B-gs_frwt-offset_02, 0, 10+4*(bNoExtraPrismOnLeftTop | (bDiffFrameThk & (lod3D = 2))), matSash,
								-A/2+gs_sl_w1-gs_frw_Sl_left-offset_10, B-gs_frwt-offset_10, 0, -1, matSash
						else
							put	-A/2+gs_sl_w1+offset_leaf, lh-offset_leaf, 0, 10, matSash,
								-A/2+gs_sl_w1+offset_02, lh+gs_frame_width_transom+offset_02, 0, mask1, matSash
							if iSimpleSashFrameType_02 = SIMPLESASH_SLIDEVER then
								SashBottomY	= lh+gs_frame_width_transom+offset_02
								SashTopY	= B-gs_frwt-offset_02
								simpleSashX	= -A/2+gs_sl_w1+offset_02

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy - gs_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy + gs_sash_width/2, 0, mask2, matSash
							endif
							put	-A/2+gs_sl_w1+offset_02, b-gs_frwt-offset_02, 0, 10+4*(bNoExtraPrismOnLeftTop | (bDiffFrameThk & (lod3D = 2))), matSash,
								-A/2+gs_sl_w1-gs_frw_Sl_left-offset_09, B-gs_frwt-offset_09, 0, -1, matSash
						endif
					else
						put	-A/2+gs_sl_w1+offset_leaf, lh-offset_leaf, 0, 10, matSash,
							-A/2+gs_sl_w1-gs_frw_Sl_left-offset_09, lh-offset_09, 0, -1, matSash
					endif

					cprism_{2} mat1, botmat, matSash,
						nsp/5, framethick2,
						get(nsp)

					gosub 500

					if gs_bSidelight_fr_hdiv_left then
						iSimpleSashFrameType_i = iSimpleSashFrameType_11
						offset_i = offset_11
					else
						iSimpleSashFrameType_i = iSimpleSashFrameType_09
						offset_i = offset_09
					endif
					if LeftSLParapet > EPS then
						put	-A/2+gs_sl_w1-gs_frw_Sl_left-offset_i, LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, 10, matSash,
							-A/2+gs_sl_w1-gs_frw_SlParapet_left-gs_tolerance_left_2, LeftSLParapet-ovhgBottomLeft, 0, mask1, matSash,
							-A/2+gs_frw1+offset_i, LeftSLParapet-ovhgBottomLeft, 0, mmask2-4*bExtraPrismOnLeftSideLower, matSash,
							-A/2+gs_frw1+offset_i, LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, mask1, matSash
					else
						put	-A/2+gs_sl_w1-gs_frw_Sl_left-offset_i, gs_frame_width_low_left_sl+offset_i, 0, 10, matSash,
							-A/2+gs_sl_w1-gs_frw_Sl_left, -ovhgBottom, 0, mask2, matSash,
							-A/2+gs_frw1+offset_i, -ovhgBottom, 0, mmask2-4*bExtraPrismOnLeftSideLower, matSash,
							-A/2+gs_frw1+offset_i, gs_frame_width_low_left_sl+offset_i, 0, mask1, matSash
					endif
					if iSimpleSashFrameType_i = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_i = SIMPLESASH_SIDEHUNG then
						SashLeftX	= -A/2+gs_frw1+offset_i
						SashRightX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_i
						simpleSashZ	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i

						simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
						if iSimpleSashFrameType_i = SIMPLESASH_SLIDEHOR then
							put simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
								simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
						else
							put simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
								simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
						endif
					endif

					cprism_{2} mat1, botmat, matSash,
						nsp/5, framethick2,
						get(nsp)

					gosub 600
				else
					bExtraPrismOnLeftSideTop = (bDiffFrameThk & (lod3D = 1) & (offset_02 > EPS))
					if bExtraPrismOnLeftSideTop then
						put	-A/2+gs_frw1, TopHeightInny-offset_02*(not(bArchedTop)), 0, 8, matSash,
							-A/2+gs_frw1+offset_02, TopHeightInny-offset_02*(not(bArchedTop)), 0, mask1 - 2, matSash
						if iSimpleSashFrameType_02 = SIMPLESASH_SLIDEVER then
							SashBottomY	= lh+gs_frame_width_transom+offset_02
							SashTopY	= TopHeightInny-offset_02
							simpleSashX	= -A/2+gs_frw1+offset_02

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sash_width/2, 0, mask2, matSash
						endif
						put	-A/2+gs_frw1+offset_02, lh+gs_frame_width_transom+offset_02, 0, 8, matSash,
							-A/2+gs_frw1, lh, 0, 12, matLeaf

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick2,
							get(nsp)
						body 1
					endif

					put	-A/2 - cutDxLeft, -ovhgBottom, 0, mask1 - 7*gs_stack_left, matSash,
						-A/2 - cutDxLeft, TopHeighty-offset_02*(not(bArchedTop))*not(bExtraPrismOnLeftSideTop), 0, 8, matSash,
						-A/2+gs_frw1+offset_02*not(bExtraPrismOnLeftSideTop), TopHeightInny-offset_02*(not(bArchedTop))*not(bExtraPrismOnLeftSideTop), 0, mask1 - 2 - ((i = 1) & bExtraPrismOnLeftSideTop), matSash
					if (iSimpleSashFrameType_02 = SIMPLESASH_SLIDEVER) & not(bExtraPrismOnLeftSideTop) then
						SashBottomY	= lh+gs_frame_width_transom+offset_02
						SashTopY	= TopHeightInny-offset_02
						simpleSashX	= -A/2+gs_frw1+offset_02

						simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
						put simpleSashX, simpleSashDivy + gs_sash_width/2, 0, 8, matSash,
							simpleSashX, simpleSashDivy - gs_sash_width/2, 0, mask2, matSash
					endif
					if i = 1 | not(bDiffFrameThk) then
						put	-A/2+gs_frw1+offset_02*not(bExtraPrismOnLeftSideTop), lh+gs_frame_width_transom+offset_02, 0, mmask, matSash
					endif
					put	-A/2+gs_frw1+offset_leaf, lh-offset_leaf, 0, mask1 - 2, matLeaf,
						-A/2+gs_frw1+offset_leaf, -ovhgBottom, 0, mask1, matSash,
						-A/2 - cutDxLeft, -ovhgBottom, 0, mask1 - 7*gs_stack_left, matSash

					cprism_{2} mat1, botmat, matSash,
						nsp/5, framethick1,
						get(nsp)

					gosub 500
				endif

				if gs_sidelight_right then

					if not(gs_Transom_toRight) then
						bExtraPrismOnRightSide = (bDiffFrameThk & (lod3D = 1) & (offset_05 > EPS))
						if gs_bSidelight_fr_hdiv_right then
							bExtraPrismOnRightSideLower = (bDiffFrameThk & (lod3D = 1) & (offset_07 > EPS))
						else
							bExtraPrismOnRightSideLower = bExtraPrismOnRightSide
						endif

						if bExtraPrismOnRightSide | bExtraPrismOnRightSideLower then
							put	A/2-gs_frw2, TopHeightInny-offset_05, 0, 8, matSash,
								A/2-gs_frw2-offset_05, TopHeightInny-offset_05, 0, mask1 - 2, matSash
							if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEVER then
								if gs_bSidelight_fr_hdiv_right then
									SashBottomY	= horizDivRightSideUpperPY
								else
									SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_05
								endif
								SashTopY	= TopHeightInny-offset_05
								simpleSashX	= A/2-gs_frw2-offset_05

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
							endif
							if gs_bSidelight_fr_hdiv_right then
								put horizDivRightSideRightUpperPX,	horizDivRightSideUpperPY, 0, 8,	matSash,
									horizDivRightSideRightLowerPX,	horizDivRightSideLowerPY, 0, mask2 - not(bExtraPrismOnRightSideLower),	matSash

								if (iSimpleSashFrameType_07 = SIMPLESASH_SLIDEVER) & bExtraPrismOnRightSideLower then
									SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_07
									SashTopY	= horizDivRightSideLowerPY
									simpleSashX	= horizDivRightSideRightLowerPX

									simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
									put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
										simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
								endif
								offset_i = offset_07
							else
								offset_i = offset_05
							endif
							put	A/2-gs_frw2-offset_i, RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, 8, matSash,
								A/2-gs_frw2-offset_i, RightSLParapet-ovhgBottomRight, 0, mask1, matSash,
								A/2-gs_frw2, RightSLParapet-ovhgBottomRight, 0, 12, matSash

							cprism_{2} mat1, botmat, matSash,
								nsp/5, framethick2,
								get(nsp)
							body 1
						endif

						put	A/2 + cutDxRight, RightSLParapet-ovhgBottomRight, 0, mask1 - 7*gs_stack_right, matSash,
							A/2 + cutDxRight, TopHeighty-offset_05*not(bExtraPrismOnRightSide), 0, 8, matSash,
							A/2-gs_frw2-offset_05*not(bExtraPrismOnRightSide), TopHeightInny-offset_05*not(bExtraPrismOnRightSide), 0, mask1 - 2 - ((i = 1) & bExtraPrismOnRightSide), matSash
						if (iSimpleSashFrameType_05 = SIMPLESASH_SLIDEVER) & not(bExtraPrismOnRightSide) then
							if gs_bSidelight_fr_hdiv_right then
								SashBottomY	= horizDivRightSideUpperPY
							else
								SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_05
							endif
							SashTopY	= TopHeightInny-offset_05
							simpleSashX	= A/2-gs_frw2-offset_05

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						if gs_bSidelight_fr_hdiv_right then
							put horizDivRightSideRightUpperPX+offset_05*bExtraPrismOnRightSide,	horizDivRightSideUpperPY, 0, mmask,	matSash,
								horizDivRightSideRightLowerPX+offset_07*bExtraPrismOnRightSideLower,	horizDivRightSideLowerPY, 0, mask2-bExtraPrismOnRightSideLower,	matSash

							if (iSimpleSashFrameType_07 = SIMPLESASH_SLIDEVER) & not(bExtraPrismOnRightSideLower) then
								SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_07
								SashTopY	= horizDivRightSideLowerPY
								simpleSashX	= horizDivRightSideRightLowerPX

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
							endif
							offset_i = offset_07
						else
							offset_i = offset_05
						endif
						if i = 1 | not(bDiffFrameThk) then
							put	A/2-gs_frw2-offset_i*not(bExtraPrismOnRightSideLower), RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, mmask, matSash
						endif
						put	A/2-gs_frw2-offset_i*not(bExtraPrismOnRightSideLower), RightSLParapet-ovhgBottomRight, 0, mask1, matSash,
							A/2 + cutDxRight, RightSLParapet-ovhgBottomRight, 0, -1, matSash

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick1,
							get(nsp)
						body 1
					else
						bExtraPrismOnRightSide = (bDiffFrameThk & (lod3D = 1) & (offset_05 > EPS))
						if gs_bSidelight_fr_hdiv_right then
							bExtraPrismOnRightSideLower = (bDiffFrameThk & (lod3D = 1) & (offset_07 > EPS))
						else
							bExtraPrismOnRightSideLower = bExtraPrismOnRightSide
						endif

						if gs_RightMullion_Top then
								offset_x = offset_06
							offset_y = offset_06
							iSimpleSashFrameType = iSimpleSashFrameType_06
						else
							offset_x = offset_02
							offset_y = offset_02
							iSimpleSashFrameType = iSimpleSashFrameType_02
						endif
						bExtraPrismOnRightSideTop = (bDiffFrameThk & (lod3D = 1) & (offset_x > EPS))

						if bExtraPrismOnRightSide | bExtraPrismOnRightSideTop | bExtraPrismOnRightSideLower then
							if bExtraPrismOnRightSideTop then
								put	A/2-gs_frw2, TopHeightInny-offset_y*(not(bArchedTop)), 0, 8, matSash,
									A/2-gs_frw2-offset_x, TopHeightInny-offset_y*(not(bArchedTop)), 0, mask1 - 2, matSash
								if iSimpleSashFrameType = SIMPLESASH_SLIDEVER then
									SashBottomY	= lh+gs_frame_width_transom+offset_y
									SashTopY	= TopHeightInny-offset_y
									simpleSashX	= A/2-gs_frw2-offset_x

									simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
									put simpleSashX, simpleSashDivy + gs_sash_width/2, 0, 8, matSash,
										simpleSashX, simpleSashDivy - gs_sash_width/2, 0, mask2, matSash
								endif
								put	A/2-gs_frw2-offset_x, lh+gs_frame_width_transom+offset_y, 0, 8, matSash
								if not(bExtraPrismOnRightSide) then
									put	A/2-gs_frw2, lh-offset_05, 0, 12, matSash
								endif

								if not(bExtraPrismOnRightSide) & bExtraPrismOnRightSideLower then
									cprism_{2} mat1, botmat, matSash,
										nsp/5, framethick2,
										get(nsp)
								endif
							endif
							if bExtraPrismOnRightSide | bExtraPrismOnRightSideLower then
								if bExtraPrismOnRightSide then
									put	A/2-gs_frw2-offset_05, lh-offset_05, 0, mask1 - 2, matSash
									if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEVER then
										if gs_bSidelight_fr_hdiv_right then
											SashBottomY	= horizDivRightSideUpperPY
										else
											SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_05
										endif
										SashTopY	= lh-offset_05
										simpleSashX	= A/2-gs_frw2-offset_05

										simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
										put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
											simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
									endif
								endif
								if gs_bSidelight_fr_hdiv_right then
									put horizDivRightSideRightUpperPX,	horizDivRightSideUpperPY, 0, 8,	matSash,
										horizDivRightSideRightLowerPX,	horizDivRightSideLowerPY, 0, mask2 - not(bExtraPrismOnRightSideLower),	matSash

									if (iSimpleSashFrameType_07 = SIMPLESASH_SLIDEVER) & bExtraPrismOnRightSideLower then
										SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_07
										SashTopY	= horizDivRightSideLowerPY
										simpleSashX	= horizDivRightSideRightLowerPX

										simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
										put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
											simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
									endif
									offset_i = offset_07
								else
									offset_i = offset_05
								endif
								if bExtraPrismOnRightSideLower then
									put	A/2-gs_frw2-offset_i, RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, 8, matSash,
										A/2-gs_frw2-offset_i, RightSLParapet-ovhgBottomRight, 0, mask1-2, matSash,
										A/2-gs_frw2, RightSLParapet-ovhgBottomRight, 0, 12, matSash
								endif
								if not(bExtraPrismOnRightSideTop) & bExtraPrismOnRightSide then
									put A/2-gs_frw2, lh+gs_frame_width_transom+offset_y, 0, 8, matSash
								endif
							endif

							cprism_{2} mat1, botmat, matSash,
								nsp/5, framethick2,
								get(nsp)
							body 1
						endif

						put	A/2 + cutDxRight, RightSLParapet-ovhgBottomRight, 0, mask1 - 7*gs_stack_right, matSash,
							A/2 + cutDxRight, TopHeighty-offset_y*(not(bArchedTop))*not(bExtraPrismOnRightSideTop), 0, 8, matSash,
							A/2-gs_frw2-offset_x*not(bExtraPrismOnRightSideTop), TopHeightInny-offset_y*(not(bArchedTop))*not(bExtraPrismOnRightSideTop), 0, mask1 - 2 - ((i = 1) & bExtraPrismOnRightSideTop), matSash
						if (iSimpleSashFrameType = SIMPLESASH_SLIDEVER)& not(bExtraPrismOnRightSideTop) then
							SashBottomY	= lh+gs_frame_width_transom+offset_y
							SashTopY	= TopHeightInny-offset_y
							simpleSashX	= A/2-gs_frw2-offset_x

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sash_width/2, 0, mask2, matSash
						endif
						if i = 1 | not(bDiffFrameThk) then
							put	A/2-gs_frw2-offset_x*not(bExtraPrismOnRightSideTop), lh+gs_frame_width_transom+offset_y, 0, mmask, matSash
						endif
						put	A/2-gs_frw2-offset_05*not(bExtraPrismOnRightSide), lh-offset_05, 0, mask1 - 2 - ((i = 1) & bExtraPrismOnRightSide), matSash
						if (iSimpleSashFrameType_05 = SIMPLESASH_SLIDEVER) & not(bExtraPrismOnRightSide) then
							if gs_bSidelight_fr_hdiv_right then
								SashBottomY	= horizDivRightSideUpperPY
							else
								SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_05
							endif
							SashTopY	= lh-offset_05
							simpleSashX	= A/2-gs_frw2-offset_05

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						if gs_bSidelight_fr_hdiv_right then
							put horizDivRightSideRightUpperPX+offset_05*bExtraPrismOnRightSide,	horizDivRightSideUpperPY, 0, mmask,	matSash,
								horizDivRightSideRightLowerPX+offset_07*bExtraPrismOnRightSideLower,	horizDivRightSideLowerPY, 0, mask2-bExtraPrismOnRightSideLower,	matSash

							if (iSimpleSashFrameType_07 = SIMPLESASH_SLIDEVER) & not(bExtraPrismOnRightSideLower) then
								SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_07
								SashTopY	= horizDivRightSideLowerPY
								simpleSashX	= horizDivRightSideRightLowerPX

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
							endif
							offset_i = offset_07
						else
							offset_i = offset_05
						endif
						if i = 1 | not(bDiffFrameThk) then
							put	A/2-gs_frw2-offset_i*not(bExtraPrismOnRightSideLower), RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, mmask, matSash
						endif
						put	A/2-gs_frw2-offset_i*not(bExtraPrismOnRightSideLower), RightSLParapet-ovhgBottomRight, 0, mask1, matSash,
							A/2 + cutDxRight, RightSLParapet-ovhgBottomRight, 0, -1, matSash

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick1,
							get(nsp)
						body 1
					endif

					gosub 500

					if gs_RightMullion_Top then
						if gs_Transom_toRight then
							put	A/2-gs_sl_w2+gs_frw_Sl_right+offset_06, B-gs_frwt-offset_06, 0, mask1, matSash
							if iSimpleSashFrameType_06 = SIMPLESASH_SLIDEVER then
								SashBottomY	= lh+gs_frame_width_transom+offset_06
								SashTopY	= B-gs_frwt-offset_06
								simpleSashX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_06

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sash_width/2, 0, mask2, matSash
							endif
							put	A/2-gs_sl_w2+gs_frw_Sl_right+offset_06, lh+gs_frame_width_transom+offset_06, 0, 10, matSash,
								A/2-gs_sl_w2+gs_frw_Sl_right+offset_05, lh-offset_05, 0, mask1, matSash
						else
							put	A/2-gs_sl_w2+gs_frw_Sl_right+offset_05, B-gs_frwt-offset_05, 0, mask1, matSash
						endif
					else
						put	A/2-gs_sl_w2+gs_frw_Sl_right+offset_05, lh-offset_05, 0, mask1, matSash
					endif
					if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEVER then
						if gs_bSidelight_fr_hdiv_right then
							SashBottomY	= horizDivRightSideUpperPY
						else
							SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_05
						endif
						if gs_Transom_toRight then
							SashTopY = lh-offset_05
						else
							SashTopY = B-gs_frwt-offset_05
						endif
						simpleSashX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_05

						simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
						put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
							simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
					endif
					if gs_bSidelight_fr_hdiv_right then
						put horizDivRightSideLeftUpperPX,	horizDivRightSideUpperPY, 0, 8,		matSash,
							horizDivRightSideLeftLowerPX,	horizDivRightSideLowerPY, 0, mask2,	matSash

						if iSimpleSashFrameType_07 = SIMPLESASH_SLIDEVER then
							SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_07
							SashTopY	= horizDivRightSideLowerPY
							simpleSashX	= horizDivRightSideLeftLowerPX

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						offset_i = offset_07
					else
						offset_i = offset_05
					endif
					if RightSLParapet > EPS then
						put A/2-gs_sl_w2+gs_frw_Sl_right+offset_i, RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, 10, matSash,
							A/2-gs_sl_w2+gs_frw_SlParapet_right+gs_tolerance_right_2, RightSLParapet-ovhgBottomRight, 0, mask1, matSash,
							A/2-gs_sl_w2+gs_frw_SlParapet_right+gs_tolerance_right_2, -ovhgBottom, 0, mask1, matSash,
							A/2-gs_sl_w2-offset_leaf, -ovhgBottom, 0, mask3, matLeaf
					else
						put A/2-gs_sl_w2+gs_frw_Sl_right+offset_i, gs_frame_width_low_right_sl+offset_i, 0, 10, matSash,
							A/2-gs_sl_w2+gs_frw_Sl_right, -ovhgBottom, 0, mask2, matSash,
							A/2-gs_sl_w2-offset_leaf, -ovhgBottom, 0, mask1, matLeaf
					endif
					if gs_RightMullion_Top then
						if gs_Transom_toRight then
							put	A/2-gs_sl_w2-offset_leaf, lh-offset_leaf, 0, 10, matSash,
								A/2-gs_sl_w2-offset_02, lh+gs_frame_width_transom+offset_02, 0, mask1, matSash
							if iSimpleSashFrameType_02 = SIMPLESASH_SLIDEVER then
								SashBottomY	= lh+gs_frame_width_transom+offset_02
								SashTopY	= B-gs_frwt-offset_02
								simpleSashX	= A/2-gs_sl_w2-offset_02

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy - gs_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy + gs_sash_width/2, 0, mask2, matSash
							endif
							put	A/2-gs_sl_w2-offset_02, B-gs_frwt-offset_02, 0, 10+4*(bNoExtraPrismOnRightTop | (bDiffFrameThk & (lod3D = 2))), matSash,
								A/2-gs_sl_w2+gs_frw_Sl_right+offset_06, B-gs_frwt-offset_06, 0, -1, matSash
						else
							put	A/2-gs_sl_w2-offset_leaf, lh-offset_leaf, 0, 10, matSash,
								A/2-gs_sl_w2-offset_02, lh+gs_frame_width_transom+offset_02, 0, mask1, matSash
							if iSimpleSashFrameType_02 = SIMPLESASH_SLIDEVER then
								SashBottomY	= lh+gs_frame_width_transom+offset_02
								SashTopY	= B-gs_frwt-offset_02
								simpleSashX	= A/2-gs_sl_w2-offset_02

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy - gs_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy + gs_sash_width/2, 0, mask2, matSash
							endif
							put	A/2-gs_sl_w2-offset_02, B-gs_frwt-offset_02, 0, 10+4*(bNoExtraPrismOnRightTop | (bDiffFrameThk & (lod3D = 2))), matSash,
								A/2-gs_sl_w2+gs_frw_Sl_right+offset_05, B-gs_frwt-offset_05, 0, -1, matSash
						endif
					else
						put	A/2-gs_sl_w2-offset_leaf, lh-offset_leaf, 0, 10, matSash,
							A/2-gs_sl_w2+gs_frw_Sl_right+offset_05, lh-offset_05, 0, -1, matSash
					endif

					cprism_{2} mat1, botmat, matSash,
						nsp/5, framethick2,
						get(nsp)

					gosub 500

					if gs_bSidelight_fr_hdiv_right then
						iSimpleSashFrameType_i = iSimpleSashFrameType_07
						offset_i = offset_07
					else
						iSimpleSashFrameType_i = iSimpleSashFrameType_05
						offset_i = offset_05
					endif
					if RightSLParapet > EPS then
						put	A/2-gs_sl_w2+gs_frw_Sl_right+offset_i, RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, 10, matSash,
							A/2-gs_sl_w2+gs_frw_SlParapet_right+gs_tolerance_right_2, RightSLParapet-ovhgBottomRight, 0, mask1, matSash,
							A/2-gs_frw2-offset_i, RightSLParapet-ovhgBottomRight, 0, mmask2-4*bExtraPrismOnRightSideLower, matSash,
							A/2-gs_frw2-offset_i, RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, mask1, matSash
					else
						put	A/2-gs_sl_w2+gs_frw_Sl_right+offset_i, gs_frame_width_low_right_sl+offset_i, 0, 10, matSash,
							A/2-gs_sl_w2+gs_frw_Sl_right, -ovhgBottom, 0, mask2, matSash,
							A/2-gs_frw2-offset_i, -ovhgBottom, 0, mmask2-4*bExtraPrismOnRightSideLower, matSash,
							A/2-gs_frw2-offset_i, gs_frame_width_low_right_sl+offset_i, 0, mask1, matSash
					endif
					if iSimpleSashFrameType_i = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_i = SIMPLESASH_SIDEHUNG then
						SashLeftX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_i
						SashRightX	= A/2-gs_frw2-offset_i
						simpleSashZ	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i

						simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
						if iSimpleSashFrameType_i = SIMPLESASH_SLIDEHOR then
							put simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
								simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
						else
							put simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
								simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
						endif
					endif

					cprism_{2} mat1, botmat, matSash,
						nsp/5, framethick2,
						get(nsp)

					gosub 600
				else
					bExtraPrismOnRightSideTop = (bDiffFrameThk & (lod3D = 1) & (offset_02 > EPS))
					if bExtraPrismOnRightSideTop then
						put	A/2-gs_frw2, TopHeightInny-offset_02*(not(bArchedTop)), 0, 8, matSash
						put	A/2-gs_frw2-offset_02, TopHeightInny-offset_02*(not(bArchedTop)), 0, mask1 - 2, matSash
						if iSimpleSashFrameType_02 = SIMPLESASH_SLIDEVER then
							SashBottomY	= lh+gs_frame_width_transom+offset_02
							SashTopY	= TopHeightInny-offset_02
							simpleSashX	= A/2-gs_frw2-offset_02

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sash_width/2, 0, mask2, matSash
						endif
						put	A/2-gs_frw2-offset_02, lh+gs_frame_width_transom+offset_02, 0, 8, matSash,
							A/2-gs_frw2, lh, 0, 12, matLeaf

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick2,
							get(nsp)
						body 1
					endif

					put	A/2 + cutDxRight, -ovhgBottom, 0, mask1 - 7*gs_stack_right, matSash,
						A/2 + cutDxRight, TopHeighty-offset_02*(not(bArchedTop))*not(bExtraPrismOnRightSideTop), 0, 8, matSash,
						A/2-gs_frw2-offset_02*not(bExtraPrismOnRightSideTop), TopHeightInny-offset_02*(not(bArchedTop))*not(bExtraPrismOnRightSideTop), 0, mask1 - 2 - ((i = 1) & bExtraPrismOnRightSideTop), matSash
					if (iSimpleSashFrameType_02 = SIMPLESASH_SLIDEVER) & not(bExtraPrismOnRightSideTop) then
						SashBottomY	= lh+gs_frame_width_transom+offset_02
						SashTopY	= TopHeightInny-offset_02
						simpleSashX	= A/2-gs_frw2-offset_02

						simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
						put simpleSashX, simpleSashDivy + gs_sash_width/2, 0, 8, matSash,
							simpleSashX, simpleSashDivy - gs_sash_width/2, 0, mask2, matSash
					endif
					if i = 1 | not(bDiffFrameThk) then
						put	A/2-gs_frw2-offset_02*not(bExtraPrismOnRightSideTop), lh+gs_frame_width_transom+offset_02, 0, mmask, matSash
					endif
					put	A/2-gs_frw2-offset_leaf, lh-offset_leaf, 0, mask1 - 2, matLeaf,
						A/2-gs_frw2-offset_leaf, -ovhgBottom, 0, mask1, matSash,
						A/2 + cutDxRight, -ovhgBottom, 0, -1, matSash

					cprism_{2} mat1, botmat, matSash,
						nsp/5, framethick1,
						get(nsp)

					gosub 500
				endif

				if gs_pocket_door_frame & lod3D <> 5 then
					cutend
					if n=2 then cutend
				endif

				if bArchedTop then
					cprism_{2} mat1, botmat, matSash,
						7, framethick1,
						-A/2 - cutDxLeft, gs_shoulder_h, 0, mask1 + 64, matSash,
						 0, frametop - r2, 0, 900, matSash,
						 0, B + cutDy, 0, 3064 + mask1, matSash,
						 A/2 + cutDxRight, gs_shoulder_h, 0, 3010, matSash,
						 A/2-gs_frw2-offset_02, gs_shoulder_h-(fce-fcefw), 0, mask1 + 64, matSash,
						 0, B-gs_frwt-offset_02, 0, 3064 + mask1, matSash,
						-A/2+gs_frw1+offset_02,  gs_shoulder_h-(fce-fcefw), 0, 3010, matSash
					body 1
				else
					bExtraPrismOnTop_02 = 0
					bExtraPrismOnTopLeft = 0
					bExtraPrismOnTopRight = 0

					bExtraPrismOnTop_02 = (bDiffFrameThk & (lod3D = 1) & (offset_02 > EPS))
					if gs_sidelight_left & gs_LeftMullion_Top then
						if gs_Transom_toLeft then
							iSimpleSashFrameTypeL = iSimpleSashFrameType_10
							offset_xL = offset_10
							offset_yL = offset_10
							sashWidthL = gs_sash_width
						else
							iSimpleSashFrameTypeL = iSimpleSashFrameType_09
							offset_xL = offset_09
							offset_yL = offset_09
							sashWidthL = gs_sl_sash_width
						endif
					else
						offset_xL = offset_02
						offset_yL = offset_02
						sashWidthL = gs_sash_width
					endif
					bExtraPrismOnTopLeft = (bDiffFrameThk & (lod3D = 1) & (offset_xL > EPS))

					if gs_sidelight_right & gs_RightMullion_Top then
						if gs_Transom_toRight then
							iSimpleSashFrameTypeR = iSimpleSashFrameType_06
							offset_xR = offset_06
							offset_yR = offset_06
							sashWidthR = gs_sash_width
						else
							iSimpleSashFrameTypeR = iSimpleSashFrameType_05
							offset_xR = offset_05
							offset_yR = offset_05
							sashWidthR = gs_sl_sash_width
						endif
					else
						offset_xR = offset_02
						offset_yR = offset_02
						sashWidthR = gs_sash_width
					endif
					bExtraPrismOnTopRight = (bDiffFrameThk & (lod3D = 1) & (offset_xR > EPS))

					if bExtraPrismOnTop_02 | bExtraPrismOnTopLeft | bExtraPrismOnTopRight then
						put	-A/2+gs_frw1,			B-gs_frwt, 			0, 12,		matSash,
							-A/2+gs_frw1,			B-gs_frwt-offset_yL, 	0, 8,		matSash,
							-A/2+gs_frw1+offset_xL,	B-gs_frwt-offset_yL, 	0, mask1,	matSash

						if gs_sidelight_left & gs_LeftMullion_Top then
							if iSimpleSashFrameTypeL = SIMPLESASH_SLIDEHOR | iSimpleSashFrameTypeL = SIMPLESASH_SIDEHUNG then
								SashLeftX	= -A/2+gs_frw1+offset_xL
								SashRightX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_xL
								simpleSashZ	= B-gs_frwt-offset_yL

								simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
								if iSimpleSashFrameTypeL = SIMPLESASH_SLIDEHOR then
									put simpleSashDivx - sashWidthL/2, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + sashWidthL/2, simpleSashZ, 0, mask2, matSash
								else
									put simpleSashDivx - sashWidthL, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + sashWidthL, simpleSashZ, 0, mask2, matSash
								endif
							endif

							put -A/2+gs_sl_w1-gs_frw_Sl_left-offset_xL,  B-gs_frwt-offset_yL, 0, 10, matSash,
								-A/2+gs_sl_w1+offset_02,  B-gs_frwt-offset_02, 0, mask1,  matSash
						endif

						if iSimpleSashFrameType_02 = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_02 = SIMPLESASH_SIDEHUNG then
							if gs_sidelight_left & gs_LeftMullion_Top then
								SashLeftX = -A/2+gs_sl_w1+offset_02
							else
								SashLeftX = -A/2+gs_frw1+offset_02
							endif
							if gs_sidelight_right & gs_RightMullion_Top then
								SashRightX = A/2-gs_sl_w2-offset_02
							else
								SashRightX = A/2-gs_frw2-offset_02
							endif
							simpleSashZ	= B-gs_frwt-offset_02

							simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
							if iSimpleSashFrameType_02 = SIMPLESASH_SLIDEHOR then
								put simpleSashDivx - gs_sash_width/2, simpleSashZ, 0, 8, matSash,
									simpleSashDivx + gs_sash_width/2, simpleSashZ, 0, mask2, matSash
							else
								put simpleSashDivx - gs_sash_width, simpleSashZ, 0, 8, matSash,
									simpleSashDivx + gs_sash_width, simpleSashZ, 0, mask2, matSash
							endif
						endif

						if gs_sidelight_right & gs_RightMullion_Top then
							put A/2-gs_sl_w2-offset_02,  B-gs_frwt-offset_02, 0, 10, matSash,
								A/2-gs_sl_w2+gs_frw_Sl_right+offset_xR,  B-gs_frwt-offset_yR, 0, mask1, matSash

							if iSimpleSashFrameTypeR = SIMPLESASH_SLIDEHOR | iSimpleSashFrameTypeR = SIMPLESASH_SIDEHUNG then
								SashLeftX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_xR
								SashRightX	= A/2-gs_frw2-offset_xR
								simpleSashZ	= B-gs_frwt-offset_yR

								simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
								if iSimpleSashFrameTypeR = SIMPLESASH_SLIDEHOR then
									put simpleSashDivx - sashWidthR/2, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + sashWidthR/2, simpleSashZ, 0, mask2, matSash
								else
									put simpleSashDivx - sashWidthR, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + sashWidthR, simpleSashZ, 0, mask2, matSash
								endif
							endif
						endif

						put	A/2-gs_frw2-offset_xR,	B-gs_frwt-offset_yR,	0, 10,			matSash,
							A/2-gs_frw2,			B-gs_frwt-offset_yR,	0, 12,	matSash,
							A/2-gs_frw2,			B-gs_frwt,				0, 12,			matSash

						cprism_{2} mat1, botmat, matSash,
								nsp/5, framethick2,
								get(nsp)
						body 1
					endif

					if abs(cutDy + gs_frwt + offset_yL*not(bExtraPrismOnTopLeft)) > EPS then	! avoiding self intersect. prism
						put	-A/2 - cutDxLeft,		B + cutDy, 						0, mask1 - 2*(gs_stack_top | gs_stack_left) - 5*gs_stack_left,	matSash,
							-A/2 - cutDxLeft,		B-gs_frwt-offset_yL*not(bExtraPrismOnTopLeft), 	0, 8,		matSash,
							-A/2+gs_frw1+offset_xL*not(bExtraPrismOnTopLeft),	B-gs_frwt-offset_yL*not(bExtraPrismOnTopLeft), 	0, mask1 - ((i = 1) & bExtraPrismOnTopLeft),	matSash
					endif

					if gs_sidelight_left & gs_LeftMullion_Top then
						if offset_yL*not(bExtraPrismOnTopLeft) > EPS | offset_02*not(bExtraPrismOnTop_02) > EPS | gs_frwt > EPS then	! avoiding self intersect. prism
							if (iSimpleSashFrameTypeL = SIMPLESASH_SLIDEHOR | iSimpleSashFrameTypeL = SIMPLESASH_SIDEHUNG) & not(bExtraPrismOnTopLeft) then
								SashLeftX	= -A/2+gs_frw1+offset_xL
								SashRightX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_xL
								simpleSashZ	= B-gs_frwt-offset_yL

								simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
								if iSimpleSashFrameTypeL = SIMPLESASH_SLIDEHOR then
									put simpleSashDivx - sashWidthL/2, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + sashWidthL/2, simpleSashZ, 0, mask2, matSash
								else
									put simpleSashDivx - sashWidthL, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + sashWidthL, simpleSashZ, 0, mask2, matSash
								endif
							endif
							put -A/2+gs_sl_w1-gs_frw_Sl_left-offset_xL, B-gs_frwt-offset_yL*not(bExtraPrismOnTopLeft), 0, 10+2*bDiffFrameThk, matSash,
								-A/2+gs_sl_w1+offset_02, B-gs_frwt-offset_02*not(bExtraPrismOnTop_02), 0, mask1-2*bDiffFrameThk - ((i = 1) & bExtraPrismOnTop_02), matSash
						endif
					endif

					if (iSimpleSashFrameType_02 = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_02 = SIMPLESASH_SIDEHUNG) & not(bExtraPrismOnTop_02) then
						if gs_sidelight_left & gs_LeftMullion_Top then
							SashLeftX = -A/2+gs_sl_w1+offset_02
						else
							SashLeftX = -A/2+gs_frw1+offset_02
						endif
						if gs_sidelight_right & gs_RightMullion_Top then
							SashRightX = A/2-gs_sl_w2-offset_02
						else
							SashRightX = A/2-gs_frw2-offset_02
						endif
						simpleSashZ	= B-gs_frwt-offset_02

						simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
						if iSimpleSashFrameType_02 = SIMPLESASH_SLIDEHOR then
							put simpleSashDivx - gs_sash_width/2, simpleSashZ, 0, 8, matSash,
								simpleSashDivx + gs_sash_width/2, simpleSashZ, 0, mask2, matSash
						else
							put simpleSashDivx - gs_sash_width, simpleSashZ, 0, 8, matSash,
								simpleSashDivx + gs_sash_width, simpleSashZ, 0, mask2, matSash
						endif
					endif

					if gs_sidelight_right & gs_RightMullion_Top then
						if offset_02*not(bExtraPrismOnTop_02) > EPS | offset_yR*not(bExtraPrismOnTopRight) > EPS | gs_frwt > EPS then	! avoiding self intersect. prism
							put A/2-gs_sl_w2-offset_02, B-gs_frwt-offset_02*not(bExtraPrismOnTop_02), 0, 10+2*bDiffFrameThk, matSash,
								A/2-gs_sl_w2+gs_frw_Sl_right+offset_xR, B-gs_frwt-offset_yR*not(bExtraPrismOnTopRight), 0, mask1-2*bDiffFrameThk - ((i = 1) & bExtraPrismOnTopRight), matSash

							if (iSimpleSashFrameTypeR = SIMPLESASH_SLIDEHOR | iSimpleSashFrameTypeR = SIMPLESASH_SIDEHUNG) & not(bExtraPrismOnTopRight) then
								SashLeftX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_xR
								SashRightX	= A/2-gs_frw2-offset_xR
								simpleSashZ	= B-gs_frwt-offset_yR

								simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
								if iSimpleSashFrameTypeR = SIMPLESASH_SLIDEHOR then
									put simpleSashDivx - sashWidthR/2, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + sashWidthR/2, simpleSashZ, 0, mask2, matSash
								else
									put simpleSashDivx - sashWidthR, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + sashWidthR, simpleSashZ, 0, mask2, matSash
								endif
							endif
						endif
					endif

					if abs(cutDy + gs_frwt + offset_yR*not(bExtraPrismOnTopRight)) > EPS then	! avoiding self intersect. prism
						put	A/2-gs_frw2-offset_xR*not(bExtraPrismOnTopRight),	B-gs_frwt-offset_yR*not(bExtraPrismOnTopRight),	0, 10,			matSash,
							A/2 + cutDxRight,		B-gs_frwt-offset_yR*not(bExtraPrismOnTopRight),	0, mask1 - 2 - 5*gs_stack_right,	matSash,
							A/2 + cutDxRight,		B + cutDy,						0, mask1 - 2*(gs_stack_top | gs_stack_right) - 5*gs_stack_top,		matSash
					endif
					if nsp > 0 then
						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick1,
							get(nsp)
					endif
				endif

				gosub 600

			endif


			!************* Both in Type1 and Type2

			if gs_frame_wthk = 0 then mmask=10 else mmask=8

			if gs_sidelight_left & gs_LeftMullion_Top then
				SashLeftX = -A/2+gs_sl_w1+offset_02
			else
				SashLeftX = -A/2+gs_frw1+offset_02
			endif
			if gs_sidelight_right & gs_RightMullion_Top then
				SashRightX = A/2-gs_sl_w2-offset_02
			else
				SashRightX = A/2-gs_frw2-offset_02
			endif
			SashBottomY	= lh+gs_frame_width_transom+offset_02
			SashTopY	= B-gs_frwt-offset_02
			sashWidth	= gs_sash_width
			iSimpleSashFrameType_i = iSimpleSashFrameType_02

			gosub "Extra Frame to Simple Sash"

			if gs_sidelight_left then
				if gs_bSidelight_fr_hdiv_left then
					SashLeftX	= -A/2+gs_frw1+offset_11
					SashRightX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_11
					SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_11
					SashTopY	= horizDivLeftSideLowerPY
					sashWidth	= gs_sl_sash_width
					iSimpleSashFrameType_i = iSimpleSashFrameType_11

					gosub "Extra Frame to Simple Sash"
				endif

				SashLeftX	= -A/2+gs_frw1+offset_09
				SashRightX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_09
				if gs_bSidelight_fr_hdiv_left then
					SashBottomY	= horizDivLeftSideUpperPY
				else
					SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_09
				endif
				if gs_Transom_toLeft then
					SashTopY	= lh-offset_09
				else
					SashTopY	= B-gs_frwt-offset_09
				endif
				sashWidth	= gs_sl_sash_width
				iSimpleSashFrameType_i = iSimpleSashFrameType_09

				gosub "Extra Frame to Simple Sash"

				if gs_Transom_toLeft & gs_LeftMullion_Top then

					SashLeftX	= -A/2+gs_frw1+offset_10
					SashRightX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_10
					SashBottomY	= lh+gs_frame_width_transom+offset_10
					SashTopY	= B-gs_frwt-offset_10
					sashWidth	= gs_sash_width
					iSimpleSashFrameType_i = iSimpleSashFrameType_10

					gosub "Extra Frame to Simple Sash"

					put -A/2+gs_frw1+offset_10, B-_transomHeight+gs_frame_width_transom+offset_10, 0, mask1, matSash

					if iSimpleSashFrameType_10 = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_10 = SIMPLESASH_SIDEHUNG then
						SashLeftX	= -A/2+gs_frw1+offset_10
						SashRightX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_10
						simpleSashZ	= B-_transomHeight+gs_frame_width_transom+offset_10

						simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
						if iSimpleSashFrameType_10 = SIMPLESASH_SLIDEHOR then
							put simpleSashDivx - gs_sash_width/2, simpleSashZ, 0, 8, matSash,
								simpleSashDivx + gs_sash_width/2, simpleSashZ, 0, mask2, matSash
						else
							put simpleSashDivx - gs_sash_width, simpleSashZ, 0, 8, matSash,
								simpleSashDivx + gs_sash_width, simpleSashZ, 0, mask2, matSash
						endif
					endif

					put -A/2+gs_sl_w1-gs_frw_Sl_left-offset_10, B-_transomHeight+gs_frame_width_transom+offset_10, 0, 10, matSash,
						-A/2+gs_sl_w1-gs_frw_Sl_left-offset_09, B-_transomHeight-offset_09, 0, mask1, matSash

					if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_09 = SIMPLESASH_SIDEHUNG then
						SashLeftX	= -A/2+gs_frw1+offset_09
						SashRightX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_09
						simpleSashZ	= B-_transomHeight-offset_09

						simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
						if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEHOR then
							put simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
								simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
						else
							put simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
								simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
						endif
					endif

					put -A/2+gs_frw1+offset_09, B-_transomHeight-offset_09, 0, mmask2-4*(bExtraPrismOnLeftSide | bExtraPrismOnLeftSideTop), matSash

					cprism_{2} topmat, botmat, matSash,
						nsp/5, framethick2,
						get(nsp)

					gosub 600
				endif
			endif

			if gs_sidelight_right then
				if gs_bSidelight_fr_hdiv_right then
					SashLeftX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_07
					SashRightX	= A/2-gs_frw2-offset_07
					SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_07
					SashTopY	= horizDivRightSideLowerPY
					sashWidth	= gs_sl_sash_width
					iSimpleSashFrameType_i = iSimpleSashFrameType_07

					gosub "Extra Frame to Simple Sash"
				endif

				SashLeftX	= A/2-gs_frw2-offset_05
				SashRightX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_05
				if gs_bSidelight_fr_hdiv_right then
					SashBottomY	= horizDivRightSideUpperPY
				else
					SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_05
				endif
				if gs_Transom_toRight then
					SashTopY = lh-offset_05
				else
					SashTopY = B-gs_frwt-offset_05
				endif
				sashWidth	= gs_sl_sash_width
				iSimpleSashFrameType_i = iSimpleSashFrameType_05

				gosub "Extra Frame to Simple Sash"

				if gs_Transom_toRight & gs_RightMullion_Top then

					SashLeftX	= A/2-gs_frw2+offset_06
					SashRightX	= A/2-gs_sl_w2+gs_frw_Sl_right-offset_06
					SashBottomY	= lh+gs_frame_width_transom+offset_06
					SashTopY	= B-gs_frwt-offset_06
					sashWidth	= gs_sash_width
					iSimpleSashFrameType_i = iSimpleSashFrameType_06

					gosub "Extra Frame to Simple Sash"

					put	A/2-gs_frw2-offset_06, B-_transomHeight+gs_frame_width_transom+offset_06, 0, mask1, matSash

					if iSimpleSashFrameType_06 = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_06 = SIMPLESASH_SIDEHUNG then
						SashLeftX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_06
						SashRightX	= A/2-gs_frw2-offset_06
						simpleSashZ	= B-_transomHeight+gs_frame_width_transom+offset_06

						simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
						if iSimpleSashFrameType_06 = SIMPLESASH_SLIDEHOR then
							put simpleSashDivx + gs_sash_width/2, simpleSashZ, 0, 8, matSash,
								simpleSashDivx - gs_sash_width/2, simpleSashZ, 0, mask2, matSash
						else
							put simpleSashDivx + gs_sash_width, simpleSashZ, 0, 8, matSash,
								simpleSashDivx - gs_sash_width, simpleSashZ, 0, mask2, matSash
						endif
					endif

					put	A/2-gs_sl_w2+gs_frw_Sl_right+offset_06, B-_transomHeight+gs_frame_width_transom+offset_06, 0, 10, matSash,
						A/2-gs_sl_w2+gs_frw_Sl_right+offset_05, B-_transomHeight-offset_05, 0, mask1, matSash

					if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_05 = SIMPLESASH_SIDEHUNG then
						SashLeftX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_05
						SashRightX	= A/2-gs_frw2-offset_05
						simpleSashZ	= B-_transomHeight-offset_05

						simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
						if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEHOR then
							put simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
								simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
						else
							put simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
								simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
						endif
					endif

					put	A/2-gs_frw2-offset_05, B-_transomHeight-offset_05, 0, mmask2-4*(bExtraPrismOnRightSide | bExtraPrismOnRightSideTop), matSash

					cprism_{2} topmat, botmat, matSash,
						nsp/5, framethick2,
						get(nsp)

					gosub 600
				endif
			endif

			if gs_sidelight_left then
				if not(gs_Transom_toLeft) then
					if gs_LeftMullion_Top then
						put -A/2+gs_sl_w1+offset_02, B-_transomHeight+gs_frame_width_transom+offset_02, 0, 10, matSash,
							-A/2+gs_sl_w1+offset_leaf, B-_transomHeight-offset_leaf, 0, mask3, matLeaf
					else
						put -A/2+gs_sl_w1-gs_frw_Sl_left, B-_transomHeight+gs_frame_width_transom, 0, mask1, matSash,
							-A/2+gs_sl_w1-gs_frw_Sl_left,  B-_transomHeight, 0, 8, matSash,
							-A/2+gs_sl_w1+offset_leaf, B-_transomHeight-offset_leaf, 0, mask3, matLeaf
					endif
				else
					if gs_LeftMullion_Top then
						put -A/2+gs_sl_w1+offset_02, B-_transomHeight+gs_frame_width_transom+offset_02, 0, 10, matSash,
							-A/2+gs_sl_w1+offset_leaf, B-_transomHeight-offset_leaf, 0, mask3, matLeaf
					else
						put -A/2+gs_sl_w1-gs_frw_Sl_left, B-_transomHeight+gs_frame_width_transom+offset_02, 0, mask1 - 2, matSash,
							-A/2+gs_frw1+offset_02, B-_transomHeight+gs_frame_width_transom+offset_02, 0, mmask2-4*(bExtraPrismOnLeftSide | bExtraPrismOnLeftSideTop), matSash,
							-A/2+gs_frw1+offset_09, B-_transomHeight-offset_09, 0, mask1, matSash

						if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_09 = SIMPLESASH_SIDEHUNG then
							SashLeftX	= -A/2+gs_frw1+offset_09
							SashRightX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_09
							simpleSashZ	= B-_transomHeight-offset_09

							simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
							if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEHOR then
								put simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
									simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
							else
								put simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
									simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
							endif
						endif

						put	-A/2+gs_sl_w1-gs_frw_Sl_left-offset_09, B-_transomHeight-offset_09, 0, 10, matSash,
							-A/2+gs_sl_w1+offset_leaf, B-_transomHeight-offset_leaf, 0, mask3, matLeaf
					endif
				endif
			else
				put -A/2+gs_frw1+offset_02, B-_transomHeight+gs_frame_width_transom+offset_02, 0, mmask2-4*bExtraPrismOnLeftSideTop, matSash,
					-A/2+gs_frw1+offset_leaf, B-_transomHeight-offset_leaf, 0, mask1, matLeaf
			endif

			if gs_sidelight_right then
				if not(gs_Transom_toRight) then
					if gs_RightMullion_Top then
						put A/2-gs_sl_w2-offset_leaf, B-_transomHeight-offset_leaf, 0, 10, matSash,
							A/2-gs_sl_w2-offset_02, B-_transomHeight+gs_frame_width_transom+offset_02, 0, mask1, matSash
					else
						put A/2-gs_sl_w2-offset_leaf, B-_transomHeight-offset_leaf, 0, 10, matSash,
							A/2-gs_sl_w2+gs_frw_Sl_right, B-_transomHeight, 0, mask1 - 2, matSash,
							A/2-gs_sl_w2+gs_frw_Sl_right, B-_transomHeight+gs_frame_width_transom, 0, mask1, matSash
					endif
				else
					if gs_RightMullion_Top then
						put A/2-gs_sl_w2-offset_leaf, B-_transomHeight-offset_leaf, 0, 10, matSash,
							A/2-gs_sl_w2-offset_02, B-_transomHeight+gs_frame_width_transom+offset_02, 0, mask1, matSash
					else
						put A/2-gs_sl_w2-offset_leaf, B-_transomHeight-offset_leaf, 0, 10, matSash,
							A/2-gs_sl_w2+gs_frw_Sl_right+offset_05, B-_transomHeight-offset_05, 0, mask1, matSash

						if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_05 = SIMPLESASH_SIDEHUNG then
							SashLeftX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_05
							SashRightX	= A/2-gs_frw2-offset_05
							simpleSashZ	= B-_transomHeight-offset_05

							simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
							if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEHOR then
								put simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
									simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
							else
								put simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
									simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
							endif
						endif

						put	A/2-gs_frw2-offset_05, B-_transomHeight-offset_05, 0, mmask2-4*(bExtraPrismOnRightSide | bExtraPrismOnRightSideTop), matSash,
							A/2-gs_frw2-offset_02, B-_transomHeight+gs_frame_width_transom+offset_02, 0, mask1, matSash,
							A/2-gs_sl_w2, B-_transomHeight+gs_frame_width_transom+offset_02, 0, mask1 - 2, matSash
					endif
				endif
			else
				put A/2-gs_frw2-offset_leaf, B-_transomHeight-offset_leaf, 0, mmask2-4*bExtraPrismOnRightSideTop, matSash,
					A/2-gs_frw2-offset_02, B-_transomHeight+gs_frame_width_transom+offset_02, 0, mask1, matSash
			endif

			if iSimpleSashFrameType_02 = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_02 = SIMPLESASH_SIDEHUNG then
				if gs_LeftMullion_Top then
					SashLeftX = -A/2+gs_sl_w1+offset_02
				else
					SashLeftX = -A/2+gs_frw1+offset_02
				endif
				if gs_RightMullion_Top then
					SashRightX = A/2-gs_sl_w2-offset_02
				else
					SashRightX = A/2-gs_frw2-offset_02
				endif
				simpleSashZ	= B-_transomHeight+gs_frame_width_transom+offset_02

				simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
				if iSimpleSashFrameType_02 = SIMPLESASH_SLIDEHOR then
					put simpleSashDivx + gs_sash_width/2, simpleSashZ, 0, 8, matSash,
						simpleSashDivx - gs_sash_width/2, simpleSashZ, 0, mask2, matSash
				else
					put simpleSashDivx + gs_sash_width, simpleSashZ, 0, 8, matSash,
						simpleSashDivx - gs_sash_width, simpleSashZ, 0, mask2, matSash
				endif
			endif

			if nsp then
				cprism_{2} topmat, botmat, matSash,
						nsp/5, framethick2,
						get(nsp)
			endif

			gosub 600

			addz frameThickOffset

		next i

		del n

		body -1

	else

! =============================================================================
! Frame WITHOUT Transom
! =============================================================================

! Door Stop -------------------------------------------------------------------

		if gs_frame_style_m = FRAME_STYLE_DOUBLE_REBATE & lod3D > 1 then

			addz LeafRebate*(abs(gs_ds_pr)<eps)+gs_ds_pr*(abs(gs_ds_pr)>eps)

			if bArchedTop then
				base

				cprism_ topmat, botmat, sidemat,
					4, gs_ds_thk,
					-A/2+gs_frw1, 0, 15,
					-A/2+gs_frw1, gs_shoulder_h-(fce-fcefw), 10,
					-A/2+gs_frw1+gs_ds_w, gs_shoulder_h-(fce-fceds), 13,
					-A/2+gs_frw1+gs_ds_w, 0, 15

				gosub 500

				cprism_ topmat, botmat, sidemat,
					4, gs_ds_thk,
					A/2-gs_frw2, 0, 15,
					A/2-gs_frw2, gs_shoulder_h-(fce-fcefw), 10,
					A/2-gs_frw2-gs_ds_w, gs_shoulder_h-(fce-fceds), 13,
					A/2-gs_frw2-gs_ds_w, 0, 15

				gosub 500

				if gs_mf then
					addx A/2-gs_mf_pos
					cutform 4, 1, 2 + 16,
						0, 0, -1, 0,
						-gs_mf_w/2-offset_leaf, 0, 	15+16+32,
						-gs_mf_w/2-offset_leaf, B-gs_frwt-offset_leaf,	10+16+32,
						 gs_mf_w/2+offset_leaf,	B-gs_frwt-offset_leaf,	15+16+32,
						 gs_mf_w/2+offset_leaf,	0,	15+16+32
					body 1
					del 1
				endif

				cprism_ topmat, botmat, sidemat,
					7, gs_ds_thk,
					-A/2+gs_frw1, gs_shoulder_h-(fce-fcefw), 79,
					0, frametop - r2, 900,
					0, frametop, 3079,
					A/2-gs_frw2, gs_shoulder_h-(fce-fcefw), 3010,
					A/2-gs_frw2-gs_ds_w, gs_shoulder_h-(fce-fceds), 79,
					0, b-gs_frwt-gs_ds_w, 3079,
					-A/2+gs_frw1+gs_ds_w, gs_shoulder_h-(fce-fceds), 3010

				gosub 600

				if gs_mf then
					cutend

					cutform 6, 1, 2 + 16,
						0, 0, -1, 0,
						frameleft, B, 15+16+32,
						frameright, B, 15+16+32,
						0, frametop - r2, 900,
						A/2-gs_frw2-gs_ds_w, gs_shoulder_h-(fce-fceds), 15+16+32,
						0, b-gs_frwt-gs_ds_w, 3015+16+32,
						-A/2+gs_frw1+gs_ds_w, gs_shoulder_h-(fce-fceds), 3010+16+32

					addx A/2-gs_mf_pos
					cprism_ topmat, botmat, sidemat,
						4, gs_ds_thk,
						gs_mf_w/2, 0, 15,
						gs_mf_w/2, B-gs_frwt, 10,
						gs_mf_w/2+gs_ds_w, B-gs_frwt, 13,
						gs_mf_w/2+gs_ds_w, 0, 15

					gosub 500

					cprism_ topmat, botmat, sidemat,
						4, gs_ds_thk,
						-gs_mf_w/2, 0, 15,
						-gs_mf_w/2, B-gs_frwt, 10,
						-gs_mf_w/2-gs_ds_w, B-gs_frwt, 13,
						-gs_mf_w/2-gs_ds_w, 0, 15

					gosub 500
					del 1

					cutend
				endif
			else
				if gs_SashText_typ_num = 1 then		! Mitered Joint

					base

					cprism_ topmat, botmat, sidemat,
						4, gs_ds_thk,
						-A/2+gs_sl_w1, 0, 15,
						-A/2+gs_sl_w1, b-gs_frwt, 10,
						-A/2+gs_sl_w1+gs_ds_w, b-gs_frwt-gs_ds_w, 13,
						-A/2+gs_sl_w1+gs_ds_w,0,15

					gosub 500

					cprism_ topmat, botmat, sidemat,
						4, gs_ds_thk,
						A/2-gs_sl_w2, 0, 15,
						A/2-gs_sl_w2, b-gs_frwt, 10,
						A/2-gs_sl_w2-gs_ds_w, b-gs_frwt-gs_ds_w, 13,
						A/2-gs_sl_w2-gs_ds_w, 0,15

					gosub 500

					if gs_mf then
						cprism_ topmat, botmat, sidemat,
							4, gs_ds_thk,
							A/2-gs_mf_pos-gs_mf_w/2-gs_ds_w, 0, 	15,
							A/2-gs_mf_pos-gs_mf_w/2-gs_ds_w, b-gs_frwt-gs_ds_w,	10,
							A/2-gs_mf_pos-gs_mf_w/2,	b-gs_frwt,	15,
							A/2-gs_mf_pos-gs_mf_w/2,	0,	15
						body 1

						cprism_ topmat, botmat, sidemat,
							4, gs_ds_thk,
							A/2-gs_mf_pos+gs_mf_w/2+gs_ds_w, 0, 	15,
							A/2-gs_mf_pos+gs_mf_w/2+gs_ds_w, b-gs_frwt-gs_ds_w,	10,
							A/2-gs_mf_pos+gs_mf_w/2,	b-gs_frwt,	15,
							A/2-gs_mf_pos+gs_mf_w/2,	0,	15

						gosub 500
					endif

					if gs_mf then
						cprism_ topmat, botmat, sidemat,
							4, gs_ds_thk,
							-A/2+gs_sl_w1, b-gs_frwt, 10,
							-A/2+gs_sl_w1+gs_ds_w, b-gs_frwt-gs_ds_w, 15,
							A/2-gs_mf_pos-gs_mf_w/2-gs_ds_w, b-gs_frwt-gs_ds_w, 10,
							A/2-gs_mf_pos-gs_mf_w/2, b-gs_frwt,15
						body 1

						cprism_ topmat, botmat, sidemat,
							4, gs_ds_thk,
							A/2-gs_mf_pos+gs_mf_w/2, b-gs_frwt, 10,
							A/2-gs_mf_pos+gs_mf_w/2+gs_ds_w, b-gs_frwt-gs_ds_w, 15,
							A/2-gs_sl_w2-gs_ds_w, b-gs_frwt-gs_ds_w, 10,
							A/2-gs_sl_w2, b-gs_frwt,15
					else
						cprism_ topmat, botmat, sidemat,
							4, gs_ds_thk,
							-A/2+gs_sl_w1, b-gs_frwt, 10,
							-A/2+gs_sl_w1+gs_ds_w,   b-gs_frwt-gs_ds_w, 15,
							 A/2-gs_sl_w2-gs_ds_w, b-gs_frwt-gs_ds_w, 10,
							 A/2-gs_sl_w2, b-gs_frwt,15
					endif

					gosub 600

				endif

				if gs_SashText_typ_num = 2 then		! Butt Joint

					base

					cprism_ topmat, botmat, sidemat,
						4, gs_ds_thk,
						-A/2+gs_sl_w1, 0, 15,
						-A/2+gs_sl_w1, b-gs_frwt-gs_ds_w, 10,
						-A/2+gs_sl_w1+gs_ds_w, b-gs_frwt-gs_ds_w, 13,
						-A/2+gs_sl_w1+gs_ds_w, 0,15

					gosub 500

					cprism_ topmat, botmat, sidemat,
						4, gs_ds_thk,
						A/2-gs_sl_w2,      0, 15,
						A/2-gs_sl_w2, b-gs_frwt-gs_ds_w, 10,
						A/2-gs_sl_w2-gs_ds_w, b-gs_frwt-gs_ds_w, 13,
						A/2-gs_sl_w2-gs_ds_w, 0,15

					gosub 500

					if gs_mf then
						cprism_ topmat, botmat, sidemat,
							4, gs_ds_thk,
							A/2-gs_mf_pos-gs_mf_w/2-gs_ds_w, 0, 	15,
							A/2-gs_mf_pos-gs_mf_w/2-gs_ds_w, b-gs_frwt-gs_ds_w,	10,
							A/2-gs_mf_pos-gs_mf_w/2,	b-gs_frwt-gs_ds_w,	15,
							A/2-gs_mf_pos-gs_mf_w/2,	0,	15
						body 1

						cprism_ topmat, botmat, sidemat,
							4, gs_ds_thk,
							A/2-gs_mf_pos+gs_mf_w/2+gs_ds_w, 0, 	15,
							A/2-gs_mf_pos+gs_mf_w/2+gs_ds_w, b-gs_frwt-gs_ds_w,	10,
							A/2-gs_mf_pos+gs_mf_w/2,	b-gs_frwt-gs_ds_w,	15,
							A/2-gs_mf_pos+gs_mf_w/2,	0,	15

						gosub 500
					endif

					if gs_mf then
						cprism_ topmat, botmat, sidemat,
							6, gs_ds_thk,
							-A/2+gs_sl_w1, b-gs_frwt, 15,
							-A/2+gs_sl_w1, b-gs_frwt-gs_ds_w,8,
							-A/2+gs_sl_w1+gs_ds_w, b-gs_frwt-gs_ds_w, 15,
							A/2-gs_mf_pos-gs_mf_w/2-gs_ds_w, b-gs_frwt-gs_ds_w, 10,
							A/2-gs_mf_pos-gs_mf_w/2, b-gs_frwt-gs_ds_w,13,
							A/2-gs_mf_pos-gs_mf_w/2, b-gs_frwt,15
						body 1

						cprism_ topmat, botmat, sidemat,
							6, gs_ds_thk,
							A/2-gs_mf_pos+gs_mf_w/2, b-gs_frwt, 15,
							A/2-gs_mf_pos+gs_mf_w/2, b-gs_frwt-gs_ds_w,8,
							A/2-gs_mf_pos+gs_mf_w/2+gs_ds_w, b-gs_frwt-gs_ds_w, 15,
							A/2-gs_sl_w2-gs_ds_w, b-gs_frwt-gs_ds_w, 10,
							A/2-gs_sl_w2, b-gs_frwt-gs_ds_w,13,
							A/2-gs_sl_w2, b-gs_frwt,15
					else
						cprism_ topmat, botmat, sidemat,
							6, gs_ds_thk,
							-A/2+gs_sl_w1, b-gs_frwt, 15,
							-A/2+gs_sl_w1, b-gs_frwt-gs_ds_w,8,
							-A/2+gs_sl_w1+gs_ds_w, b-gs_frwt-gs_ds_w, 15,
							 A/2-gs_sl_w2-gs_ds_w, b-gs_frwt-gs_ds_w, 10,
							 A/2-gs_sl_w2, b-gs_frwt-gs_ds_w,13,
							 A/2-gs_sl_w2, b-gs_frwt,15
					endif

					gosub 600
				endif
			endif

			body -1
			del 1
		endif

! Extrusion Frame Rebate ---------------------------------------------------

		if	gs_frame_style_m = FRAME_STYLE_EXTRUSION |\
			gs_frame_style_m = FRAME_STYLE_WRAPPED_EXTRUSION then
			material gs_frame_mat

			gosub "Metal Frame Rebate"
		endif

! Leaf Rebate -----------------------------------------------------------------

		if (not(bUniformMaterials) & gs_frame_style_m = FRAME_STYLE_DOUBLE_REBATE & not(bSimpleOrCHIModel)) |\
			(gs_frame_style_m = FRAME_STYLE_SIMPLE_REBATE) |\
			(gs_frame_style_m = FRAME_STYLE_EXTRUSION) |\
			(gs_frame_style_m = FRAME_STYLE_WRAPPED_EXTRUSION) then

			bDoubleCut = (gs_frame_style_m = FRAME_STYLE_DOUBLE_REBATE)
			if	gs_frame_style_m = FRAME_STYLE_SIMPLE_REBATE		|\
				gs_frame_style_m = FRAME_STYLE_EXTRUSION			|\
				gs_frame_style_m = FRAME_STYLE_WRAPPED_EXTRUSION	then
				rebateWidth = gs_rebate_width
			else
				rebateWidth = offsetEPS
			endif

			addz LeafRebate

			if bArchedTop then
				if gs_mf then
					material matLeafRebate
					rx = (r2-gs_frw1+rebateWidth-offset_leaf)
					dx = (A/2-gs_mf_pos-gs_mf_w/2+rebateWidth-offset_leaf)
					cutform 5, 1, 2 + 16,
						 0, 0, 1, 0,
						-A/2+gs_frw1-rebateWidth+offset_leaf,	0,										31,
						-A/2+gs_frw1-rebateWidth+offset_leaf,	gs_shoulder_h-(fce-fce_Sl_rebate),		31+64,
						 0, frametop - r2,																900,
						 dx, b-gs_frwt+rebateWidth-offset_leaf - (rx - (sqr(rx^2 - dx^2))),	3031+64,
						 dx,	0,																		31

					dx = (A/2-gs_mf_pos+gs_mf_w/2-rebateWidth+offset_leaf)
					cutform 5, 1, 2 + 16,
						 0, 0, 1, 0,
						 A/2-gs_frw2+rebateWidth-offset_leaf,	0,										31,
						 A/2-gs_frw2+rebateWidth-offset_leaf,	gs_shoulder_h-(fce-fce_Sl_rebate),		31+64,
						 0, frametop - r2,																900,
						 dx, b-gs_frwt+rebateWidth-offset_leaf - (rx - (sqr(rx^2 - dx^2))),	3031+64,
						 dx,	0,																		31

					if bDoubleCut then
						material matLeafOpposite
						dx = (A/2-gs_mf_pos-gs_mf_w/2+rebateWidth-offset_leaf)
						cutform 5, 1, 2 + 16,
							 0, 0, 1, 0,
							-A/2+gs_frw1-rebateWidth+offset_leaf,	0,										31,
							-A/2+gs_frw1-rebateWidth+offset_leaf,	gs_shoulder_h-(fce-fce_Sl_rebate),		31+64,
							 0, frametop - r2,																900,
							 dx, b-gs_frwt+rebateWidth-offset_leaf - (rx - (sqr(rx^2 - dx^2))),	3031+64,
							 dx,	0,																		31

						dx = (A/2-gs_mf_pos+gs_mf_w/2-rebateWidth+offset_leaf)
						cutform 5, 1, 2 + 16,
							 0, 0, 1, 0,
							 A/2-gs_frw2+rebateWidth-offset_leaf,	0,										31,
							 A/2-gs_frw2+rebateWidth-offset_leaf,	gs_shoulder_h-(fce-fce_Sl_rebate),		31+64,
							 0, frametop - r2,																900,
							 dx, b-gs_frwt+rebateWidth-offset_leaf - (rx - (sqr(rx^2 - dx^2))),	3031+64,
							 dx,	0,																		31
					endif

					numCuts = numCuts + 2 + 2*bDoubleCut
				else
					material matLeafRebate
					cutform 6, 1, 2 + 16,
						 0, 0, 1, 0,
						-A/2+gs_frw1-rebateWidth+offset_leaf,	0,									31,
						-A/2+gs_frw1-rebateWidth+offset_leaf,	gs_shoulder_h-(fce-fce_Sl_rebate),	31+64,
						 0, frametop - r2,															900,
						 0, b-gs_frwt-offset_leaf,											3031+64,
						 A/2-gs_frw2+rebateWidth-offset_leaf,	gs_shoulder_h-(fce-fce_Sl_rebate),	3031+64,
						 A/2-gs_frw2+rebateWidth-offset_leaf,	0,									31

					if bDoubleCut then
						material matLeafOpposite
						cutform 6, 1, 2 + 16,
							 0, 0, -1, 0,
							-A/2+gs_frw1-rebateWidth+offset_leaf,	0,									31,
							-A/2+gs_frw1-rebateWidth+offset_leaf,	gs_shoulder_h-(fce-fce_Sl_rebate),	31+64,
							 0, frametop - r2,															900,
							 0, b-gs_frwt-offset_leaf,											3031+64,
							 A/2-gs_frw2+rebateWidth-offset_leaf,	gs_shoulder_h-(fce-fce_Sl_rebate),	3031+64,
							 A/2-gs_frw2+rebateWidth-offset_leaf,	0,									31
					endif
					numCuts = numCuts + 1 + bDoubleCut
				endif
			else
				if gs_mf then
					material matLeafRebate
					cutform 4, 1, 2 + 16,
						 0, 0, 1, 0,
						A/2-gs_mf_pos+gs_mf_w/2-rebateWidth+offset_leaf,	0,											31,
						A/2-gs_mf_pos+gs_mf_w/2-rebateWidth+offset_leaf,	B-gs_frwt+rebateWidth-offset_leaf,	31,
						A/2-gs_sl_w2+rebateWidth-offset_leaf,				B-gs_frwt+rebateWidth-offset_leaf,	31,
						A/2-gs_sl_w2+rebateWidth-offset_leaf,				0,											31

					cutform 4, 1, 2 + 16,
						 0, 0, 1, 0,
						-A/2+gs_sl_w1-rebateWidth+offset_leaf,				0,											31,
						-A/2+gs_sl_w1-rebateWidth+offset_leaf,				B-gs_frwt+rebateWidth-offset_leaf,	31,
						 A/2-gs_mf_pos-gs_mf_w/2+rebateWidth-offset_leaf,	B-gs_frwt+rebateWidth-offset_leaf,	31,
						 A/2-gs_mf_pos-gs_mf_w/2+rebateWidth-offset_leaf,	0,											31

					if bDoubleCut then
						material matLeafOpposite
						cutform 4, 1, 2 + 16,
							 0, 0, -1, 0,
							A/2-gs_mf_pos+gs_mf_w/2-rebateWidth+offset_leaf,	0,											31,
							A/2-gs_mf_pos+gs_mf_w/2-rebateWidth+offset_leaf,	B-gs_frwt+rebateWidth-offset_leaf,	31,
							A/2-gs_sl_w2+rebateWidth-offset_leaf,				B-gs_frwt+rebateWidth-offset_leaf,	31,
							A/2-gs_sl_w2+rebateWidth-offset_leaf,				0,											31

						cutform 4, 1, 2 + 16,
							 0, 0, -1, 0,
							-A/2+gs_sl_w1-rebateWidth+offset_leaf,				0,											31,
							-A/2+gs_sl_w1-rebateWidth+offset_leaf,				B-gs_frwt+rebateWidth-offset_leaf,	31,
							 A/2-gs_mf_pos-gs_mf_w/2+rebateWidth-offset_leaf,	B-gs_frwt+rebateWidth-offset_leaf,	31,
							 A/2-gs_mf_pos-gs_mf_w/2+rebateWidth-offset_leaf,	0,											31
					endif
					numCuts = numCuts + 2 + 2 * bDoubleCut
				else
					material matLeafRebate
					cutform 4, 1, 2 + 16,
						 0, 0, 1, 0,
						-A/2+gs_sl_w1-rebateWidth+offset_leaf,	0,											31,
						-A/2+gs_sl_w1-rebateWidth+offset_leaf,	B-gs_frwt+rebateWidth-offset_leaf,	31,
						 A/2-gs_sl_w2+rebateWidth-offset_leaf,	B-gs_frwt+rebateWidth-offset_leaf,	31,
						 A/2-gs_sl_w2+rebateWidth-offset_leaf,	0,											31

					if bDoubleCut then
						material matLeafOpposite
						cutform 4, 1, 2 + 16,
							 0, 0, -1, 0,
							-A/2+gs_sl_w1-rebateWidth+offset_leaf,	0,											31,
							-A/2+gs_sl_w1-rebateWidth+offset_leaf,	B-gs_frwt+rebateWidth-offset_leaf,	31,
							 A/2-gs_sl_w2+rebateWidth-offset_leaf,	B-gs_frwt+rebateWidth-offset_leaf,	31,
							 A/2-gs_sl_w2+rebateWidth-offset_leaf,	0,											31
					endif
					numCuts = numCuts + 1 + bDoubleCut
				endif
			endif

			del 1

		endif

! Sidelight Rebate ------------------------------------------------------------

		if (lod3D > 1) | not(bUniformMaterials) then
			addz Sl_Tr_op_depth
			mulz Sl_Tr_cutDir

			material matSashRebate

			if gs_sidelight_left then			! --- Left Sidelight Rebate

				rebateCutShapeLeftPX	= horizDivLeftSideLeftUpperPX
				rebateCutShapeRightPX	= horizDivLeftSideRightUpperPX
				rebateCutShapeTopPY		= TopHeightInny - offset_09
				if gs_bSidelight_fr_hdiv_left then
					rebateCutShapeBottomPY = horizDivLeftSideUpperPY
				else
					rebateCutShapeBottomPY = LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_09
				endif
				sashWidthToRebateCut	= gs_sl_sash_width
				gs_optype_m_i			= gs_optype_m_09
				bNoRebate_i				= bNoRebate_09
				iMullionStyle_i			= iMullionStyle_09
				iSimpleSashFrameType_i	= iSimpleSashFrameType_09
				offset_i				= offset_09

				gosub "Rectangular Rebate Cutting"

				if gs_bSidelight_fr_hdiv_left then			! --- Left Lower Sidelight Rebate

					rebateCutShapeLeftPX	= horizDivLeftSideLeftLowerPX
					rebateCutShapeRightPX	= horizDivLeftSideRightLowerPX
					rebateCutShapeTopPY		= horizDivLeftSideLowerPY
					rebateCutShapeBottomPY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_11
					sashWidthToRebateCut	= gs_sl_sash_width
					gs_optype_m_i			= gs_optype_m_11
					bNoRebate_i				= bNoRebate_11
					iMullionStyle_i			= iMullionStyle_11
					iSimpleSashFrameType_i	= iSimpleSashFrameType_11
					offset_i				= offset_11

					gosub "Rectangular Rebate Cutting"
				endif
			endif

			if gs_sidelight_right then			! --- Right Sidelight Rebate

				rebateCutShapeLeftPX	= horizDivRightSideLeftUpperPX
				rebateCutShapeRightPX	= horizDivRightSideRightUpperPX
				rebateCutShapeTopPY		= TopHeightInny - offset_05
				if gs_bSidelight_fr_hdiv_right then
					rebateCutShapeBottomPY = horizDivRightSideUpperPY
				else
					rebateCutShapeBottomPY = RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_05
				endif
				sashWidthToRebateCut	= gs_sl_sash_width
				gs_optype_m_i			= gs_optype_m_05
				bNoRebate_i				= bNoRebate_05
				iMullionStyle_i			= iMullionStyle_05
				iSimpleSashFrameType_i	= iSimpleSashFrameType_05
				offset_i				= offset_05

				gosub "Rectangular Rebate Cutting"

				if gs_bSidelight_fr_hdiv_right then			! --- Right Lower Sidelight Rebate

					rebateCutShapeLeftPX	= horizDivRightSideLeftLowerPX
					rebateCutShapeRightPX	= horizDivRightSideRightLowerPX
					rebateCutShapeTopPY		= horizDivRightSideLowerPY
					rebateCutShapeBottomPY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_07
					sashWidthToRebateCut	= gs_sl_sash_width
					gs_optype_m_i			= gs_optype_m_07
					bNoRebate_i				= bNoRebate_07
					iMullionStyle_i			= iMullionStyle_07
					iSimpleSashFrameType_i	= iSimpleSashFrameType_07
					offset_i				= offset_07

					gosub "Rectangular Rebate Cutting"
				endif
			endif

			del 2
		endif

! USA Middle Frame ------------------------------------------------------------

		if gs_mf then
			if bArchedTop then
				cutform 6, 1, 2 + 16,
					0, 0, -1, 0,
					frameleft, B, 15+16+32,
					frameright, B, 15+16+32,
					0, frametop - r2, 900,
					A/2-gs_frw2, gs_shoulder_h-(fce-fcefw), 15+16+32,
					0, b-gs_frwt, 3015+16+32,
					-A/2+gs_frw1, gs_shoulder_h-(fce-fcefw), 3010+16+32
			endif

			add A/2-gs_mf_pos, 0, 0
			cprism_ topmat, botmat, sidemat,
				4, outsideFrameThk,
				-gs_mf_w/2-offset_leaf, 0, 	15,
				-gs_mf_w/2-offset_leaf, B-gs_frwt-offset_leaf,	10,
				 gs_mf_w/2+offset_leaf,	B-gs_frwt-offset_leaf,	15,
				 gs_mf_w/2+offset_leaf,	0,	15

			gosub 500
			del 1

			if bArchedTop then cutend
		endif

! -----------------------------------------------------------------------------

		base

n=1
		for i=1 to n
			framethick1	= outsideFrameThk
			framethick2	= insideFrameThk
			frameThickOffset = 0

			mat1=topmat
			mat2=sidemat

			if not(WIDO_REVEAL_SIDE) then
				matLeaf = gs_frame_mat2
			else
				matLeaf = gs_frame_mat
			endif

			if gs_opening_dir_SL_m = 1 exor WIDO_REVEAL_SIDE then
				matSash = gs_frame_mat2
			else
				matSash = gs_frame_mat
			endif

			mask1 = 15
			mask2 = 13
			mask3 = 15
			mask5 = 14

			bDiffFrameThk = (abs(framethick1 - framethick2) > EPS)

			if gs_SashText_typ_num = 1 then		! Mitered Joint

				if gs_pocket_door_frame & lod3D <> 5 then
					cutHeight = TopHeightInny
					gosub "Pocket Door Cutting"
				endif

				if gs_sidelight_left then

					bExtraPrismOnLeftSide = (bDiffFrameThk & (lod3D = 1) & (offset_09 > EPS))
					if gs_bSidelight_fr_hdiv_left then
						bExtraPrismOnLeftSideLower = (bDiffFrameThk & (lod3D = 1) & (offset_11 > EPS))
					else
						bExtraPrismOnLeftSideLower = bExtraPrismOnLeftSide
					endif

					if bExtraPrismOnLeftSide | bExtraPrismOnLeftSideLower then

						! --- outside part
						put -A/2 - cutDxLeft, LeftSLParapet-ovhgBottomLeft, 0, mask1 - 7*gs_stack_left, matSash,
							-A/2 - cutDxLeft, TopHeighty, 0, 8, matSash
						if gs_bSidelight_fr_hdiv_left & (bExtraPrismOnLeftSide exor bExtraPrismOnLeftSideLower) then
							if bExtraPrismOnLeftSide then
								put	-A/2+gs_frw1, TopHeightInny, 0, mask5, matSash,
									-A/2+gs_frw1, horizDivLeftSideLowerPY, 0, 13, matSash,
									-A/2+gs_frw1, LeftSLParapet-ovhgBottomLeft+gs_frame_width_low_left_sl, 0, 12, matSash
							else
								put	-A/2+gs_frw1, TopHeightInny, 0, 13, matSash,
									-A/2+gs_frw1, horizDivLeftSideUpperPY, 0, 12, matSash
							endif

							put	-A/2+gs_frw1, LeftSLParapet-ovhgBottomLeft, 0, mask1, matSash,
								-A/2 - cutDxLeft, LeftSLParapet-ovhgBottomLeft, 0, -1, matSash
						else
							put -A/2+gs_frw1, TopHeightInny, 0, mask5, matSash,
								-A/2+gs_frw1, LeftSLParapet-ovhgBottomLeft, 0, mask1, matSash,
								-A/2 - cutDxLeft, LeftSLParapet-ovhgBottomLeft, 0, -1, matSash
						endif

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick1,
							get(nsp)

						gosub 500

						! --- inside part
						put -A/2+gs_frw1, LeftSLParapet-ovhgBottomLeft, 0, mask5, matSash
						if bExtraPrismOnLeftSide then
							put	-A/2+gs_frw1, TopHeightInny, 0, 8, matSash,
								-A/2+gs_frw1+offset_09, TopHeightInny-offset_09, 0, mask1, matSash
						endif
						if (iSimpleSashFrameType_09 = SIMPLESASH_SLIDEVER) & bExtraPrismOnLeftSide then
							if gs_bSidelight_fr_hdiv_left then
								SashBottomY	= horizDivLeftSideUpperPY
							else
								SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_09
							endif
							SashTopY	= b-gs_frwt-offset_09
							simpleSashX	= -A/2+gs_frw1+offset_09

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						if gs_bSidelight_fr_hdiv_left then
							put horizDivLeftSideLeftUpperPX,	horizDivLeftSideUpperPY, 0, 8,		matSash,
								horizDivLeftSideLeftLowerPX,	horizDivLeftSideLowerPY, 0, mask2,	matSash

							if (iSimpleSashFrameType_11 = SIMPLESASH_SLIDEVER) & bExtraPrismOnLeftSideLower then
								SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_11
								SashTopY	= horizDivLeftSideLowerPY
								simpleSashX	= horizDivLeftSideLeftLowerPX

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
							endif
							offset_i = offset_11
						else
							offset_i = offset_09
						endif
						if bExtraPrismOnLeftSideLower then
							put	-A/2+gs_frw1+offset_i, LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, 8, matSash,
								-A/2+gs_frw1+offset_i, LeftSLParapet-ovhgBottomLeft, 0, mask1, matSash,
								-A/2+gs_frw1, LeftSLParapet-ovhgBottomLeft, 0, -1, matSash
						endif

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick2,
							get(nsp)

						gosub 500

					else

						put -A/2 - cutDxLeft, LeftSLParapet-ovhgBottomLeft, 0, mask1 - 7*gs_stack_left, matSash,
							-A/2 - cutDxLeft, TopHeighty, 0, 8, matSash,
							-A/2+gs_frw1+offset_09, TopHeightInny-offset_09, 0, mask1 - 2, matSash
						if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEVER then
							if gs_bSidelight_fr_hdiv_left then
								SashBottomY	= horizDivLeftSideUpperPY
							else
								SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_09
							endif
							SashTopY	= b-gs_frwt-offset_09
							simpleSashX	= -A/2+gs_frw1+offset_09

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						if gs_bSidelight_fr_hdiv_left then
							put horizDivLeftSideLeftUpperPX,	horizDivLeftSideUpperPY, 0, mmask,	matSash,
								horizDivLeftSideLeftLowerPX,	horizDivLeftSideLowerPY, 0, mask2,	matSash

							if iSimpleSashFrameType_11 = SIMPLESASH_SLIDEVER then
								SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_11
								SashTopY	= horizDivLeftSideLowerPY
								simpleSashX	= horizDivLeftSideLeftLowerPX

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
							endif
							offset_i = offset_11
						else
							offset_i = offset_09
						endif
						put	-A/2+gs_frw1+offset_i, LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, mmask, matSash
						if bDiffFrameThk then
							put -A/2+gs_frw1+offset_i, LeftSLParapet-ovhgBottomLeft, 0, mask1, matSash
						endif
						put	-A/2 - cutDxLeft, LeftSLParapet-ovhgBottomLeft, 0, -1, matSash

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick1,
							get(nsp)

						gosub 500

					endif

					if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEVER then
						if gs_bSidelight_fr_hdiv_left then
							SashBottomY	= horizDivLeftSideUpperPY
						else
							SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_09
						endif
						SashTopY	= b-gs_frwt-offset_09
						simpleSashX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_09

						simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
						put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
							simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
					endif
					if gs_bSidelight_fr_hdiv_left then
						put horizDivLeftSideRightUpperPX,	horizDivLeftSideUpperPY, 0, 8,		matSash,
							horizDivLeftSideRightLowerPX,	horizDivLeftSideLowerPY, 0, mask2,	matSash

						if iSimpleSashFrameType_11 = SIMPLESASH_SLIDEVER then
							SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_11
							SashTopY	= horizDivLeftSideLowerPY
							simpleSashX	= horizDivLeftSideRightLowerPX

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						offset_i = offset_11
					else
						offset_i = offset_09
					endif
					if LeftSLParapet > EPS then
						put -A/2+gs_sl_w1-gs_frw_Sl_left-offset_i, LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, 10, matSash,
							-A/2+gs_sl_w1-gs_frw_SlParapet_left-gs_tolerance_left_2, LeftSLParapet-ovhgBottomLeft, 0, mask1, matSash,
							-A/2+gs_sl_w1-gs_frw_SlParapet_left-gs_tolerance_left_2, -ovhgBottom, 0, mask1, matSash,
							-A/2+gs_sl_w1+offset_leaf, -ovhgBottom, 0, mask3, matLeaf
					else
						put -A/2+gs_sl_w1-gs_frw_Sl_left-offset_i, gs_frame_width_low_left_sl+offset_i, 0, 10, matSash,
							-A/2+gs_sl_w1+offset_leaf, -ovhgBottom, 0, mask3 - 2, matLeaf
					endif

					cprism_{2} mat1, botmat, matSash,
						3+nsp/5, framethick2,
						-A/2+gs_sl_w1-gs_frw_Sl_left-offset_09, b-gs_frwt-offset_09, 0, mask1, matSash,
						get(nsp),
						-A/2+gs_sl_w1+offset_leaf, b-gs_frwt-offset_leaf, 0, mmask2 - 6*bExtraPrismOnLeftSide, matSash,
						-A/2+gs_sl_w1-gs_frw_Sl_left-offset_09, b-gs_frwt-offset_09, 0, -1, matSash

					gosub 500

					if gs_bSidelight_fr_hdiv_left then
						iSimpleSashFrameType_i = iSimpleSashFrameType_11
						offset_i = offset_11
					else
						iSimpleSashFrameType_i = iSimpleSashFrameType_09
						offset_i = offset_09
					endif
					put	-A/2+gs_sl_w1-gs_frw_Sl_left-offset_i, LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, 10, matSash,
						-A/2+gs_sl_w1-(gs_frw_SlParapet_left+gs_tolerance_left_2) * (LeftSLParapet>0), LeftSLParapet-ovhgBottomLeft, 0, mask1, matSash,
						-A/2+(gs_frw1+offset_i)*bDiffFrameThk-gs_tolerance_left*not(bDiffFrameThk), LeftSLParapet-ovhgBottomLeft, 0, mmask2 - 6*bExtraPrismOnLeftSideLower - 2*gs_stack_left, matSash,
						-A/2+gs_frw1+offset_i, LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, mask1, matSash
					if iSimpleSashFrameType_i = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_i = SIMPLESASH_SIDEHUNG then
						SashLeftX	= -A/2+gs_frw1+offset_i
						SashRightX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_i
						simpleSashZ	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i

						simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
						if iSimpleSashFrameType_i = SIMPLESASH_SLIDEHOR then
							put simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
								simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
						else
							put simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
								simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
						endif
					endif

					cprism_{2} mat1, botmat, matSash,
						nsp/5, framethick2,
						get(nsp)

					gosub 600
				else
					bExtraPrismOnLeftSide = 0

					if abs(cutDxLeft + gs_frw1 + offset_leaf) > EPS then	! avoiding self intersect. prism
						put -A/2 - cutDxLeft, -ovhgBottom, 0, mask1 - 7*gs_stack_left, matSash,
							-A/2 - cutDxLeft, TopHeighty, 0, 8, matSash,
							-A/2+gs_frw1+offset_leaf, TopHeightInny, 0, mask1 - 2, matLeaf,
							-A/2+gs_frw1+offset_leaf, -ovhgBottom, 0, mask1, matSash,
							-A/2 - cutDxLeft, -ovhgBottom, 0, -1, matSash
					endif

					if nsp > 0 then
						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick1,
							get(nsp)
						gosub 500
					endif
				endif


				if gs_sidelight_right then

					bExtraPrismOnRightSide = (bDiffFrameThk & (lod3D = 1) & (offset_05 > EPS))
					if gs_bSidelight_fr_hdiv_right then
						bExtraPrismOnRightSideLower = (bDiffFrameThk & (lod3D = 1) & (offset_07 > EPS))
					else
						bExtraPrismOnRightSideLower = bExtraPrismOnRightSide
					endif

					if bExtraPrismOnRightSide | bExtraPrismOnRightSideLower then

						! --- outside part
						put	A/2 + cutDxRight, RightSLParapet-ovhgBottomRight, 0, mask1 - 7*gs_stack_right, matSash,
							A/2 + cutDxRight, TopHeighty, 0, 10 - 2*(gs_stack_top | gs_stack_right), matSash
						if gs_bSidelight_fr_hdiv_right & (bExtraPrismOnRightSide exor bExtraPrismOnRightSideLower) then
							if bExtraPrismOnRightSide then
								put	A/2-gs_frw2, TopHeightInny, 0, mask5, matSash,
									A/2-gs_frw2, horizDivRightSideLowerPY, 0, 13, matSash,
									A/2-gs_frw2, RightSLParapet-ovhgBottomRight+gs_frame_width_low_right_sl, 0, 12, matSash
							else
								put	A/2-gs_frw2, TopHeightInny, 0, 13, matSash,
									A/2-gs_frw2, horizDivRightSideUpperPY, 0, 12, matSash
							endif
							put	A/2-gs_frw2, RightSLParapet-ovhgBottomRight, 0, mask1, matSash,
								A/2 + cutDxRight, RightSLParapet-ovhgBottomRight, 0, -1, matSash

						else
							put A/2-gs_frw2, TopHeightInny, 0, mask5, matSash,
								A/2-gs_frw2, RightSLParapet-ovhgBottomRight, 0, mask1, matSash,
								A/2 + cutDxRight, RightSLParapet-ovhgBottomRight, 0, -1, matSash
						endif

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick1,
							get(nsp)

						gosub 500

						! --- inside part
						put A/2-gs_frw2, RightSLParapet-ovhgBottomRight, 0, mask5, matSash
						if bExtraPrismOnRightSide then
							put	A/2-gs_frw2, TopHeightInny, 0, 10, matSash,
								A/2-gs_frw2-offset_05, TopHeightInny-offset_05, 0, mask1, matSash
						endif
						if (iSimpleSashFrameType_05 = SIMPLESASH_SLIDEVER) & bExtraPrismOnRightSide then
							if gs_bSidelight_fr_hdiv_right then
								SashBottomY	= horizDivRightSideUpperPY
							else
								SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_05
							endif
							SashTopY	= b-gs_frwt-offset_05
							simpleSashX	= A/2-gs_frw2-offset_05

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						if gs_bSidelight_fr_hdiv_right then
							put horizDivRightSideRightUpperPX,	horizDivRightSideUpperPY, 0, 8,		matSash,
								horizDivRightSideRightLowerPX,	horizDivRightSideLowerPY, 0, mask2,	matSash

							if (iSimpleSashFrameType_07 = SIMPLESASH_SLIDEVER) & bExtraPrismOnRightSideLower then
								SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_07
								SashTopY	= horizDivRightSideLowerPY
								simpleSashX	= horizDivRightSideRightLowerPX

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
							endif
							offset_i = offset_07
						else
							offset_i = offset_05
						endif
						if bExtraPrismOnRightSideLower then
							put	A/2-gs_frw2-offset_i, RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, 8, matSash,
								A/2-gs_frw2-offset_i, RightSLParapet-ovhgBottomRight, 0, mask1, matSash,
								A/2-gs_frw2, RightSLParapet-ovhgBottomRight, 0, -1, matSash
						endif

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick2,
							get(nsp)

						body 1
					else

						put A/2 + cutDxRight, RightSLParapet-ovhgBottomRight, 0, mask1 - 7*gs_stack_right, matSash,
							A/2 + cutDxRight, TopHeighty, 0, 10 - 2*(gs_stack_top | gs_stack_right), matSash,
							A/2-gs_frw2-offset_05, TopHeightInny-offset_05, 0, mask1 - 2, matSash
						if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEVER then
							if gs_bSidelight_fr_hdiv_right then
								SashBottomY	= horizDivRightSideUpperPY
							else
								SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_05
							endif
							SashTopY	= b-gs_frwt-offset_05
							simpleSashX	= A/2-gs_frw2-offset_05

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						if gs_bSidelight_fr_hdiv_right then
							put horizDivRightSideRightUpperPX,	horizDivRightSideUpperPY, 0, mmask,	matSash,
								horizDivRightSideRightLowerPX,	horizDivRightSideLowerPY, 0, mask2,	matSash

							if iSimpleSashFrameType_07 = SIMPLESASH_SLIDEVER then
								SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_07
								SashTopY	= horizDivRightSideLowerPY
								simpleSashX	= horizDivRightSideRightLowerPX

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
							endif
							offset_i = offset_07
						else
							offset_i = offset_05
						endif
						put	A/2-gs_frw2-offset_i, RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, mmask, matSash
						if bDiffFrameThk then
							put A/2-gs_frw2-offset_i, RightSLParapet-ovhgBottomRight, 0, mask1, matSash
						endif
						put A/2 + cutDxRight, RightSLParapet-ovhgBottomRight, 0, -1, matSash

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick1,
							get(nsp)

						gosub 500

					endif

					if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEVER then
						if gs_bSidelight_fr_hdiv_right then
							SashBottomY	= horizDivRightSideUpperPY
						else
							SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_05
						endif
						SashTopY	= b-gs_frwt-offset_05
						simpleSashX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_05

						simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
						put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
							simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
					endif
					if gs_bSidelight_fr_hdiv_right then
						put horizDivRightSideLeftUpperPX,	horizDivRightSideUpperPY, 0, 8,		matSash,
							horizDivRightSideLeftLowerPX,	horizDivRightSideLowerPY, 0, mask2,	matSash

						if iSimpleSashFrameType_07 = SIMPLESASH_SLIDEVER then
							SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_07
							SashTopY	= horizDivRightSideLowerPY
							simpleSashX	= horizDivRightSideLeftLowerPX

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						offset_i = offset_07
					else
						offset_i = offset_05
					endif
					if RightSLParapet > EPS then
						put A/2-gs_sl_w2+gs_frw_Sl_right+offset_i, RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, 10, matSash,
							A/2-gs_sl_w2+gs_frw_SlParapet_right+gs_tolerance_right_2, RightSLParapet-ovhgBottomRight, 0, mask1, matSash,
							A/2-gs_sl_w2+gs_frw_SlParapet_right+gs_tolerance_right_2, -ovhgBottom, 0, mask1, matSash,
							A/2-gs_sl_w2-offset_leaf, -ovhgBottom, 0, mask3, matLeaf
					else
						put A/2-gs_sl_w2+gs_frw_Sl_right+offset_i, gs_frame_width_low_right_sl+offset_i, 0, 10, matSash,
							A/2-gs_sl_w2-offset_leaf, -ovhgBottom, 0, mask3 - 2, matLeaf
					endif
					cprism_{2} mat1, botmat, matSash,
						3+nsp/5, framethick2,
						 A/2-gs_sl_w2+gs_frw_Sl_right+offset_05, b-gs_frwt-offset_05, 0, mask1, matSash,
						get(nsp),
						 A/2-gs_sl_w2-offset_leaf, b-gs_frwt-offset_leaf, 0, mmask2 - 6*bExtraPrismOnRightSide, matSash,
						 A/2-gs_sl_w2+gs_frw_Sl_right+offset_05, b-gs_frwt-offset_05, 0, -1, matSash

					gosub 500

					if gs_bSidelight_fr_hdiv_right then
						iSimpleSashFrameType_i = iSimpleSashFrameType_07
						offset_i = offset_07
					else
						iSimpleSashFrameType_i = iSimpleSashFrameType_05
						offset_i = offset_05
					endif
					put	A/2-gs_sl_w2+gs_frw_Sl_right+offset_i, RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, 10, matSash,
						A/2-gs_sl_w2+(gs_frw_SlParapet_right+gs_tolerance_right_2) * (RightSLParapet>0), RightSLParapet-ovhgBottomRight, 0, mask1, matSash,
						A/2-(gs_frw2+offset_i)*bDiffFrameThk+gs_tolerance_right*not(bDiffFrameThk), RightSLParapet-ovhgBottomRight, 0, mmask2 - 6*bExtraPrismOnRightSideLower - 2*gs_stack_right, matSash,
						A/2-gs_frw2-offset_i, RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, mask1, matSash

					if iSimpleSashFrameType_i = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_i = SIMPLESASH_SIDEHUNG then
						SashLeftX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_i
						SashRightX	= A/2-gs_frw2-offset_i
						simpleSashZ	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i

						simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
						if iSimpleSashFrameType_i = SIMPLESASH_SLIDEHOR then
							put simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
								simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
						else
							put simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
								simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
						endif
					endif

					cprism_{2} mat1, botmat, matSash,
						nsp/5, framethick2,
						get(nsp)

					gosub 600
				else
					bExtraPrismOnRightSide = 0

					if abs(cutDxRight + gs_frw2 + offset_leaf) > EPS then	! avoiding self intersect. prism
						put A/2 + cutDxRight, -ovhgBottom, 0, mask1 - 7*gs_stack_right, matSash,
							A/2 + cutDxRight, TopHeighty, 0, 10 - 2*(gs_stack_top | gs_stack_right), matSash,
							A/2-gs_frw2-offset_leaf, TopHeightInny, 0, mask1 - 2, matLeaf,
							A/2-gs_frw2-offset_leaf, -ovhgBottom, 0, mask1, matSash,
							A/2 + cutDxRight, -ovhgBottom, 0, -1, matSash
					endif

					if nsp > 0 then
						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick1,
							get(nsp)
						gosub 500
					endif
				endif

				if gs_pocket_door_frame & lod3D <> 5 then
					cutend
					if n=2 then cutend
				endif

				if bArchedTop then
					cprism_ topmat, botmat, sidemat,
						7, outsideFrameThk,
						frameleft, gs_shoulder_h, 79,
						0, frametop - r2, 900,
						0, frametop, 3079,
						frameright, gs_shoulder_h, 3010,
						A/2-gs_frw2+offset_leaf, gs_shoulder_h-(fce-fcefw), 79,
						0, b-gs_frwt-offset_leaf, 3079,
						-A/2+gs_frw1-offset_leaf, gs_shoulder_h-(fce-fcefw), 3010
					body 1
				else
					if bExtraPrismOnLeftSide then
						put -A/2+gs_frw1, b-gs_frwt, 0, 8, matSash,
							-A/2+gs_frw1+offset_09, b-gs_frwt-offset_09, 0, mask2, matSash

						if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_09 = SIMPLESASH_SIDEHUNG then
							SashLeftX	= -A/2+gs_frw1+offset_09
							SashRightX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_09
							simpleSashZ	= b-gs_frwt-offset_09

							simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
							if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEHOR then
								put simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
									simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
							else
								put simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
									simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
							endif
						endif

						put	-A/2+gs_sl_w1-gs_frw_Sl_left-offset_09, b-gs_frwt-offset_09, 0, 8, matSash,
							-A/2+gs_sl_w1, b-gs_frwt, 0, mask5, matLeaf

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick2,
							get(nsp)

						gosub 600
					endif
					if bExtraPrismOnRightSide then
						put	 A/2-gs_sl_w2, b-gs_frwt, 0, 10, matSash,
							 A/2-gs_sl_w2+gs_frw_Sl_right+offset_05, b-gs_frwt-offset_05, 0, mask1 - 2, matSash

						if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_05 = SIMPLESASH_SIDEHUNG then
							SashLeftX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_05
							SashRightX	= A/2-gs_frw2-offset_05
							simpleSashZ	= b-gs_frwt-offset_05

							simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
							if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEHOR then
								put simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
									simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
							else
								put simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
									simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
							endif
						endif

						put	 A/2-gs_frw2-offset_05, b-gs_frwt-offset_05, 0, 8, matSash,
							 A/2-gs_frw2, b-gs_frwt, 0, 12, matSash

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick2,
							get(nsp)

						gosub 600
					endif
					if gs_sidelight_left then
						if bExtraPrismOnLeftSide then
							put -A/2 - cutDxLeft, b + cutDy, 0, 10 - 2*(gs_stack_top | gs_stack_left), matSash,
								-A/2+gs_frw1, b-gs_frwt, 0, mask5, matSash,
								-A/2+gs_sl_w1-gs_frw_Sl_left, b-gs_frwt, 0, 12, matSash,
								-A/2+gs_sl_w1, b-gs_frwt, 0, mask3 - 2, matLeaf
						else
							put -A/2 - cutDxLeft, b + cutDy, 0, 10 - 2*(gs_stack_top | gs_stack_left), matSash,
								-A/2+gs_frw1+offset_09, b-gs_frwt-offset_09, 0, mask1, matSash

							if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_09 = SIMPLESASH_SIDEHUNG then
								SashLeftX	= -A/2+gs_frw1+offset_09
								SashRightX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_09
								simpleSashZ	= b-gs_frwt-offset_09

								simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
								if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEHOR then
									put simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
								else
									put simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
								endif
							endif

							put	-A/2+gs_sl_w1-gs_frw_Sl_left-offset_09, b-gs_frwt-offset_09, 0, mmask, matSash,
								-A/2+gs_sl_w1+offset_leaf, b-gs_frwt-offset_leaf, 0, mask3 - 2, matLeaf
						endif
					else
						if abs(cutDy + gs_frwt + offset_leaf) > EPS then	! avoiding self intersect. prism
							put -A/2 - cutDxLeft, b + cutDy, 0, 10 - 2*(gs_stack_top | gs_stack_left), matSash,
								-A/2+gs_frw1+offset_leaf, b-gs_frwt-offset_leaf, 0, mask1, matLeaf
						endif
					endif
					if gs_sidelight_right then
						if bExtraPrismOnRightSide then
							put	 A/2-gs_sl_w2, b-gs_frwt, 0, 12, matSash,
								 A/2-gs_sl_w2+gs_frw_Sl_right, b-gs_frwt, 0, 12, matSash,
								 A/2-gs_frw2, b-gs_frwt, 0, 10 - 2*(gs_stack_top | gs_stack_right), matSash,
								 A/2 + cutDxRight, b + cutDy, 0, mask1 - 2*(gs_stack_top | gs_stack_right) - 5*gs_stack_top, matSash,
								-A/2 - cutDxLeft, b + cutDy, 0, -1, matSash
						else
							put	 A/2-gs_sl_w2-offset_leaf, b-gs_frwt-offset_leaf, 0, mmask, matSash,
								 A/2-gs_sl_w2+gs_frw_Sl_right+offset_05, b-gs_frwt-offset_05, 0, mask1 - 2, matSash

							if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_05 = SIMPLESASH_SIDEHUNG then
								SashLeftX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_05
								SashRightX	= A/2-gs_frw2-offset_05
								simpleSashZ	= b-gs_frwt-offset_05

								simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
								if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEHOR then
									put simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
								else
									put simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
								endif
							endif

							put	 A/2-gs_frw2-offset_05, b-gs_frwt-offset_05, 0, 10 - 2*(gs_stack_top | gs_stack_right), matSash,
								 A/2 + cutDxRight, b + cutDy, 0, mask1 - 2*(gs_stack_top | gs_stack_right) - 5*gs_stack_top, matSash,
								-A/2 - cutDxLeft, b + cutDy, 0, -1, matSash
						endif
					else
						if abs(cutDy + gs_frwt + offset_leaf) > EPS then	! avoiding self intersect. prism
							put	 A/2-gs_frw2-offset_leaf, b-gs_frwt-offset_leaf, 0, 10 - 2*(gs_stack_top | gs_stack_right), matSash,
								 A/2 + cutDxRight, b + cutDy, 0, mask1 - 2*(gs_stack_top | gs_stack_right) - 5*gs_stack_top, matSash,
								-A/2 - cutDxLeft, b + cutDy, 0, -1, matSash
						endif
					endif

					if nsp > 0 then
						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick1,
							get(nsp)
					endif
				endif

				gosub 600

			endif


			if gs_SashText_typ_num = 2 then		! Butt Joint

				if gs_pocket_door_frame & lod3D <> 5 then
					cutHeight = TopHeightInny
					gosub "Pocket Door Cutting"
				endif

				if gs_sidelight_left then

					bExtraPrismOnLeftSide = (bDiffFrameThk & (lod3D = 1) & (offset_09 > EPS))
					if gs_bSidelight_fr_hdiv_left then
						bExtraPrismOnLeftSideLower = (bDiffFrameThk & (lod3D = 1) & (offset_11 > EPS))
					else
						bExtraPrismOnLeftSideLower = bExtraPrismOnLeftSide
					endif

					if bExtraPrismOnLeftSide | bExtraPrismOnLeftSideLower then

						! --- outside part
						put	-A/2 - cutDxLeft, LeftSLParapet-ovhgBottomLeft, 0, mask1 - 7*gs_stack_left, matSash,
							-A/2 - cutDxLeft, TopHeighty, 0, 8, matSash
						if gs_bSidelight_fr_hdiv_left & (bExtraPrismOnLeftSide exor bExtraPrismOnLeftSideLower) then
							if bExtraPrismOnLeftSide then
								put	-A/2+gs_frw1, TopHeightInny, 0, mask5, matSash,
									-A/2+gs_frw1, horizDivLeftSideLowerPY, 0, 13, matSash,
									-A/2+gs_frw1, LeftSLParapet-ovhgBottomLeft+gs_frame_width_low_left_sl, 0, 12, matSash
							else
								put	-A/2+gs_frw1, TopHeightInny, 0, 13, matSash,
									-A/2+gs_frw1, horizDivLeftSideUpperPY, 0, 12, matSash
							endif
							put	-A/2+gs_frw1, LeftSLParapet-ovhgBottomLeft, 0, mask1, matSash
						else
							put	-A/2+gs_frw1, TopHeightInny, 0, mask5, matSash,
								-A/2+gs_frw1, LeftSLParapet-ovhgBottomLeft, 0, mask1, matSash
						endif

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick1,
							get(nsp)

						gosub 500

						! --- inside part
						put	-A/2+gs_frw1, LeftSLParapet-ovhgBottomLeft, 0, mask5, matSash
						if bExtraPrismOnLeftSide then
							put	-A/2+gs_frw1, TopHeighty-offset_09, 0, 8, matSash,
								-A/2+gs_frw1+offset_09, TopHeightInny-offset_09, 0, mask1, matSash
						endif
						if (iSimpleSashFrameType_09 = SIMPLESASH_SLIDEVER) & bExtraPrismOnLeftSide then
							if gs_bSidelight_fr_hdiv_left then
								SashBottomY	= horizDivLeftSideUpperPY
							else
								SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_09
							endif
							SashTopY	= b-gs_frwt-offset_09
							simpleSashX	= -A/2+gs_frw1+offset_09

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						if gs_bSidelight_fr_hdiv_left then
							put horizDivLeftSideLeftUpperPX,	horizDivLeftSideUpperPY, 0, 8,		matSash,
								horizDivLeftSideLeftLowerPX,	horizDivLeftSideLowerPY, 0, mask2,	matSash

							if (iSimpleSashFrameType_11 = SIMPLESASH_SLIDEVER) & bExtraPrismOnLeftSideLower then
								SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_11
								SashTopY	= horizDivLeftSideLowerPY
								simpleSashX	= horizDivLeftSideLeftLowerPX

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
							endif
							offset_i = offset_11
						else
							offset_i = offset_09
						endif
						if bExtraPrismOnLeftSideLower then
							put	-A/2+gs_frw1+offset_i, LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, 8, matSash,
								-A/2+gs_frw1+offset_i, LeftSLParapet-ovhgBottomLeft, 0, mask1, matSash,
								-A/2+gs_frw1, LeftSLParapet-ovhgBottomLeft, 0, -1, matSash
						endif

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick2,
							get(nsp)

						gosub 500

					else

						put	-A/2 - cutDxLeft, LeftSLParapet-ovhgBottomLeft, 0, mask1 - 7*gs_stack_left, matSash,
							-A/2 - cutDxLeft, TopHeighty-offset_09, 0, 8, matSash,
							-A/2+gs_frw1+offset_09, TopHeightInny-offset_09, 0, mask1 - 2, matSash
						if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEVER then
							if gs_bSidelight_fr_hdiv_left then
								SashBottomY	= horizDivLeftSideUpperPY
							else
								SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_09
							endif
							SashTopY	= b-gs_frwt-offset_09
							simpleSashX	= -A/2+gs_frw1+offset_09

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						if gs_bSidelight_fr_hdiv_left then
							put horizDivLeftSideLeftUpperPX,	horizDivLeftSideUpperPY, 0, mmask,	matSash,
								horizDivLeftSideLeftLowerPX,	horizDivLeftSideLowerPY, 0, mask2,	matSash

							if iSimpleSashFrameType_11 = SIMPLESASH_SLIDEVER then
								SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_11
								SashTopY	= horizDivLeftSideLowerPY
								simpleSashX	= horizDivLeftSideLeftLowerPX

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
							endif
							offset_i = offset_11
						else
							offset_i = offset_09
						endif
						put	-A/2+gs_frw1+offset_i, LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, mmask, matSash,
							-A/2+gs_frw1+offset_i, LeftSLParapet-ovhgBottomLeft, 0, mask1, matSash,
							-A/2 - cutDxLeft, LeftSLParapet-ovhgBottomLeft, 0, -1, matSash

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick1,
							get(nsp)

						gosub 500

					endif

					if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEVER then
						if gs_bSidelight_fr_hdiv_left then
							SashBottomY	= horizDivLeftSideUpperPY
						else
							SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_09
						endif
						SashTopY	= b-gs_frwt-offset_09
						simpleSashX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_09

						simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
						put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
							simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
					endif
					if gs_bSidelight_fr_hdiv_left then
						put horizDivLeftSideRightUpperPX,	horizDivLeftSideUpperPY, 0, 8,		matSash,
							horizDivLeftSideRightLowerPX,	horizDivLeftSideLowerPY, 0, mask2,	matSash

						if iSimpleSashFrameType_11 = SIMPLESASH_SLIDEVER then
							SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_11
							SashTopY	= horizDivLeftSideLowerPY
							simpleSashX	= horizDivLeftSideRightLowerPX

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						offset_i = offset_11
					else
						offset_i = offset_09
					endif
					if LeftSLParapet > EPS then
						put -A/2+gs_sl_w1-gs_frw_Sl_left-offset_i, LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, 10, matSash,
							-A/2+gs_sl_w1-gs_frw_SlParapet_left-gs_tolerance_left_2, LeftSLParapet-ovhgBottomLeft, 0, mask1, matSash,
							-A/2+gs_sl_w1-gs_frw_SlParapet_left-gs_tolerance_left_2, -ovhgBottom, 0, mask1, matSash,
							-A/2+gs_sl_w1+offset_leaf, -ovhgBottom, 0, mask3, matLeaf
					else
						put -A/2+gs_sl_w1-gs_frw_Sl_left-offset_i, gs_frame_width_low_left_sl+offset_i, 0, 10, matSash,
							-A/2+gs_sl_w1-gs_frw_Sl_left, -ovhgBottom, 0, mask3 - 2, matSash,
							-A/2+gs_sl_w1+offset_leaf, -ovhgBottom, 0, mask1, matLeaf
					endif

					cprism_{2} mat1, botmat, matSash,
						3+nsp/5, framethick2,
						-A/2+gs_sl_w1-gs_frw_Sl_left-offset_09, b-gs_frwt-offset_09, 0, mask1, matSash,
						get(nsp),
						-A/2+gs_sl_w1+offset_leaf, b-gs_frwt-offset_leaf, 0, mmask2 - 4*bExtraPrismOnLeftSide, matSash,
						-A/2+gs_sl_w1-gs_frw_Sl_left-offset_09, b-gs_frwt-offset_09, 0, -1, matSash

					gosub 500

					if gs_bSidelight_fr_hdiv_left then
						iSimpleSashFrameType_i = iSimpleSashFrameType_11
						offset_i = offset_11
					else
						iSimpleSashFrameType_i = iSimpleSashFrameType_09
						offset_i = offset_09
					endif
					if LeftSLParapet > EPS then
						put	-A/2+gs_sl_w1-gs_frw_Sl_left-offset_i, LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, 10, matSash,
							-A/2+gs_sl_w1-gs_frw_SlParapet_left-gs_tolerance_left_2, LeftSLParapet-ovhgBottomLeft, 0, mask1, matSash,
							-A/2+gs_frw1+offset_i, LeftSLParapet-ovhgBottomLeft, 0, mmask2 - 6*bExtraPrismOnLeftSideLower, matSash,
							-A/2+gs_frw1+offset_i, LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, mask1, matSash
					else
						put	-A/2+gs_sl_w1-gs_frw_Sl_left-offset_i, gs_frame_width_low_left_sl+offset_i, 0, 10, matSash,
							-A/2+gs_sl_w1-gs_frw_Sl_left, -ovhgBottomLeft, 0, mask2, matSash,
							-A/2+gs_frw1+offset_i, -ovhgBottomLeft, 0, mmask2 - 6*bExtraPrismOnLeftSideLower, matSash,
							-A/2+gs_frw1+offset_i, gs_frame_width_low_left_sl+offset_i, 0, mask1, matSash
					endif
					if iSimpleSashFrameType_i = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_i = SIMPLESASH_SIDEHUNG then
						SashLeftX	= -A/2+gs_frw1+offset_i
						SashRightX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_i
						simpleSashZ	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i

						simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
						if iSimpleSashFrameType_i = SIMPLESASH_SLIDEHOR then
							put simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
								simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
						else
							put simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
								simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
						endif
					endif

					cprism_{2} mat1, botmat, matSash,
						nsp/5, framethick2,
						get(nsp)

					gosub 600
				else
					bExtraPrismOnLeftSide = 0

					if abs(cutDxLeft + gs_frw1 + offset_leaf) > EPS then	! avoiding self intersect. prism
						cprism_{2} mat1, botmat, matSash,
							5, framethick1,
							-A/2 - cutDxLeft, -ovhgBottom, 0, mask1 - 7*gs_stack_left, matSash,
							-A/2 - cutDxLeft, TopHeighty, 0, 8, matSash,
							-A/2+gs_frw1+offset_leaf, TopHeightInny, 0, mask1 - 2, matLeaf,
							-A/2+gs_frw1+offset_leaf, -ovhgBottom, 0, mask1, matSash,
							-A/2 - cutDxLeft, -ovhgBottom, 0, -1, matSash

						gosub 500
					endif

				endif

				if gs_sidelight_right then

					bExtraPrismOnRightSide = (bDiffFrameThk & (lod3D = 1) & (offset_05 > EPS))
					if gs_bSidelight_fr_hdiv_right then
						bExtraPrismOnRightSideLower = (bDiffFrameThk & (lod3D = 1) & (offset_07 > EPS))
					else
						bExtraPrismOnRightSideLower = bExtraPrismOnRightSide
					endif

					if bExtraPrismOnRightSide | bExtraPrismOnRightSideLower then

						! --- outside part
						put	A/2 + cutDxRight, RightSLParapet-ovhgBottomRight, 0, mask1 - 7*gs_stack_right, matSash,
							A/2 + cutDxRight, TopHeighty, 0, 8, matSash
						if gs_bSidelight_fr_hdiv_right & (bExtraPrismOnRightSide exor bExtraPrismOnRightSideLower) then
							if bExtraPrismOnRightSide then
								put	A/2-gs_frw2, TopHeightInny, 0, mask5, matSash,
									A/2-gs_frw2, horizDivRightSideLowerPY, 0, 13, matSash,
									A/2-gs_frw2, RightSLParapet-ovhgBottomRight+gs_frame_width_low_right_sl, 0, 12, matSash
							else
								put	A/2-gs_frw2, TopHeightInny, 0, 13, matSash,
									A/2-gs_frw2, horizDivRightSideUpperPY, 0, 12, matSash
							endif
							put	A/2-gs_frw2, RightSLParapet-ovhgBottomRight, 0, mask1, matSash,
								A/2 + cutDxRight, RightSLParapet-ovhgBottomRight, 0, -1, matSash
						else
							put A/2-gs_frw2, TopHeightInny, 0, mask5, matSash,
								A/2-gs_frw2, RightSLParapet-ovhgBottomRight, 0, mask1, matSash,
								A/2 + cutDxRight, RightSLParapet-ovhgBottomRight, 0, -1, matSash
						endif

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick1,
							get(nsp)

						gosub 500

						! --- inside part
						put	A/2-gs_frw2, RightSLParapet-ovhgBottomRight, 0, mask5, matSash
						if bExtraPrismOnRightSide then
							put	A/2-gs_frw2, TopHeighty-offset_05, 0, 8, matSash,
								A/2-gs_frw2-offset_05, TopHeightInny-offset_05, 0, mask1, matSash
						endif
						if (iSimpleSashFrameType_05 = SIMPLESASH_SLIDEVER) & bExtraPrismOnRightSide then
							if gs_bSidelight_fr_hdiv_right then
								SashBottomY	= horizDivRightSideUpperPY
							else
								SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_05
							endif
							SashTopY	= b-gs_frwt-offset_05
							simpleSashX	= A/2-gs_frw2-offset_05

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						if gs_bSidelight_fr_hdiv_right then
							put horizDivRightSideRightUpperPX,	horizDivRightSideUpperPY, 0, 8,		matSash,
								horizDivRightSideRightLowerPX,	horizDivRightSideLowerPY, 0, mask2,	matSash

							if (iSimpleSashFrameType_07 = SIMPLESASH_SLIDEVER) & bExtraPrismOnRightSideLower then
								SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_07
								SashTopY	= horizDivRightSideLowerPY
								simpleSashX	= horizDivRightSideRightLowerPX

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
							endif
							offset_i = offset_07
						else
							offset_i = offset_05
						endif
						if bExtraPrismOnRightSideLower then
							put	A/2-gs_frw2-offset_i, RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, 8, matSash,
								A/2-gs_frw2-offset_i, RightSLParapet-ovhgBottomRight, 0, mask1, matSash,
								A/2-gs_frw2, RightSLParapet-ovhgBottomRight, 0, -1, matSash
						endif

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick2,
							get(nsp)

						gosub 500

					else

						put	A/2 + cutDxRight, RightSLParapet-ovhgBottomRight, 0, mask1 - 7*gs_stack_right, matSash,
							A/2 + cutDxRight, TopHeighty-offset_05, 0, 8, matSash,
							A/2-gs_frw2-offset_05, TopHeightInny-offset_05, 0, mask1 - 2, matSash
						if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEVER then
							if gs_bSidelight_fr_hdiv_right then
								SashBottomY	= horizDivRightSideUpperPY
							else
								SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_05
							endif
							SashTopY	= b-gs_frwt-offset_05
							simpleSashX	= A/2-gs_frw2-offset_05

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						if gs_bSidelight_fr_hdiv_right then
							put horizDivRightSideRightUpperPX,	horizDivRightSideUpperPY, 0, mmask,	matSash,
								horizDivRightSideRightLowerPX,	horizDivRightSideLowerPY, 0, mask2,	matSash

							if iSimpleSashFrameType_07 = SIMPLESASH_SLIDEVER then
								SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_07
								SashTopY	= horizDivRightSideLowerPY
								simpleSashX	= horizDivRightSideRightLowerPX

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
							endif
							offset_i = offset_07
						else
							offset_i = offset_05
						endif
						put	A/2-gs_frw2-offset_i, RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, mmask, matSash,
							A/2-gs_frw2-offset_i, RightSLParapet-ovhgBottomRight, 0, mask1, matSash,
							A/2 + cutDxRight, RightSLParapet-ovhgBottomRight, 0, -1, matSash

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick1,
							get(nsp)

						gosub 500

					endif

					if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEVER then
						if gs_bSidelight_fr_hdiv_right then
							SashBottomY	= horizDivRightSideUpperPY
						else
							SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_05
						endif
						SashTopY	= b-gs_frwt-offset_05
						simpleSashX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_05

						simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
						put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
							simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
					endif
					if gs_bSidelight_fr_hdiv_right then
						put horizDivRightSideLeftUpperPX,	horizDivRightSideUpperPY, 0, 8,		matSash,
							horizDivRightSideLeftLowerPX,	horizDivRightSideLowerPY, 0, mask2,	matSash

						if iSimpleSashFrameType_07 = SIMPLESASH_SLIDEVER then
							SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_07
							SashTopY	= horizDivRightSideLowerPY
							simpleSashX	= horizDivRightSideLeftLowerPX

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						offset_i = offset_07
					else
						offset_i = offset_05
					endif
					if RightSLParapet > EPS then
						put A/2-gs_sl_w2+gs_frw_Sl_right+offset_i, RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, 10, matSash,
							A/2-gs_sl_w2+gs_frw_SlParapet_right+gs_tolerance_right_2, RightSLParapet-ovhgBottomRight, 0, mask1, matSash,
							A/2-gs_sl_w2+gs_frw_SlParapet_right+gs_tolerance_right_2, -ovhgBottom, 0, mask1, matSash,
							A/2-gs_sl_w2-offset_leaf, -ovhgBottom, 0, mask3, matLeaf
					else
						put A/2-gs_sl_w2+gs_frw_Sl_right+offset_i, gs_frame_width_low_right_sl+offset_i, 0, 10, matSash,
							A/2-gs_sl_w2+gs_frw_Sl_right, -ovhgBottom, 0, mask2,  matSash,
							A/2-gs_sl_w2-offset_leaf, -ovhgBottom, 0, mask1,  matLeaf
					endif
					cprism_{2} mat1, botmat, matSash,
						3+nsp/5, framethick2,
						A/2-gs_sl_w2+gs_frw_Sl_right+offset_05, b-gs_frwt-offset_05, 0, mask1, matSash,
						get(nsp),
						A/2-gs_sl_w2-offset_leaf, b-gs_frwt-offset_leaf, 0, mmask2 - 4*bExtraPrismOnRightSide, matSash,
						A/2-gs_sl_w2+gs_frw_Sl_right+offset_05, b-gs_frwt-offset_05, 0, -1, matSash

					gosub 500

					if gs_bSidelight_fr_hdiv_right then
						iSimpleSashFrameType_i = iSimpleSashFrameType_07
						offset_i = offset_07
					else
						iSimpleSashFrameType_i = iSimpleSashFrameType_05
						offset_i = offset_05
					endif
					if RightSLParapet > EPS then
						put	A/2-gs_sl_w2+gs_frw_Sl_right+offset_i, RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, 10, matSash,
							A/2-gs_sl_w2+gs_frw_SlParapet_right+gs_tolerance_right_2, RightSLParapet-ovhgBottomRight, 0, mask1, matSash,
							A/2-gs_frw2-offset_i, RightSLParapet-ovhgBottomRight, 0, mmask2 - 6*bExtraPrismOnRightSideLower, matSash,
							A/2-gs_frw2-offset_i, RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, mask1, matSash
					else
						put	A/2-gs_sl_w2+gs_frw_Sl_right+offset_i, gs_frame_width_low_right_sl+offset_i, 0, 10, matSash,
							A/2-gs_sl_w2+gs_frw_Sl_right, -ovhgBottomRight, 0, mask2, matSash,
							A/2-gs_frw2-offset_i, -ovhgBottomRight, 0, mmask2 - 6*bExtraPrismOnRightSideLower, matSash,
							A/2-gs_frw2-offset_i, gs_frame_width_low_right_sl+offset_i, 0, mask1, matSash
					endif

					if iSimpleSashFrameType_i = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_i = SIMPLESASH_SIDEHUNG then
						SashLeftX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_i
						SashRightX	= A/2-gs_frw2-offset_i
						simpleSashZ	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i

						simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
						if iSimpleSashFrameType_i = SIMPLESASH_SLIDEHOR then
							put simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
								simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
						else
							put simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
								simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
						endif
					endif

					cprism_{2} mat1, botmat, matSash,
						nsp/5, framethick2,
						get(nsp)

					gosub 600
				else
					bExtraPrismOnRightSide = 0

					if abs(cutDxRight + gs_frw2 + offset_leaf) > EPS then	! avoiding self intersect. prism
						cprism_{2} mat1, botmat, matSash,
							5, framethick1,
							A/2 + cutDxRight, -ovhgBottom, 0, mask1 - 7*gs_stack_right, matSash,
							A/2 + cutDxRight, TopHeighty, 0, 8, matSash,
							A/2-gs_frw2-offset_leaf, TopHeightInny, 0, mask1 - 2, matLeaf,
							A/2-gs_frw2-offset_leaf, -ovhgBottom, 0, mask1, matSash,
							A/2 + cutDxRight, -ovhgBottom, 0, -1, matSash

						gosub 500
					endif

				endif

				if gs_pocket_door_frame & lod3D <> 5 then
					cutend
					if n=2 then cutend
				endif

				if bArchedTop then
					cprism_ topmat, botmat, sidemat,
						7, outsideFrameThk,
						frameleft, gs_shoulder_h, 79,
						0, frametop - r2, 900,
						0, frametop, 3079,
						frameright, gs_shoulder_h, 3010,
						A/2-gs_frw2, gs_shoulder_h-(fce-fcefw), 79,
						0, b-gs_frwt, 3079,
						-A/2+gs_frw1, gs_shoulder_h-(fce-fcefw), 3010
					body 1
				else
					if bExtraPrismOnLeftSide then
						put	-A/2+gs_frw1, b-gs_frwt, 0, 12, matSash,
							-A/2+gs_frw1, b-gs_frwt-offset_09, 0, 8, matSash,
							-A/2+gs_frw1+offset_09, b-gs_frwt-offset_09, 0, mask2, matSash
						if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_09 = SIMPLESASH_SIDEHUNG then
							SashLeftX	= -A/2+gs_frw1+offset_09
							SashRightX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_09
							simpleSashZ	= b-gs_frwt-offset_09

							simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
							if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEHOR then
								put simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
									simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
							else
								put simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
									simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
							endif
						endif
						put	-A/2+gs_sl_w1-gs_frw_Sl_left-offset_09, b-gs_frwt-offset_09, 0, 8, matSash,
							-A/2+gs_sl_w1, b-gs_frwt, 0, 12, matSash

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick2,
							get(nsp)

						gosub 600
					endif

					if bExtraPrismOnRightSide then
						put	 A/2-gs_sl_w2, b-gs_frwt, 0, 8, matSash,
							 A/2-gs_sl_w2+gs_frw_Sl_right+offset_05, b-gs_frwt-offset_05, 0, mask2, matSash
						if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_05 = SIMPLESASH_SIDEHUNG then
							SashLeftX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_05
							SashRightX	= A/2-gs_frw2-offset_05
							simpleSashZ	= b-gs_frwt-offset_05

							simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
							if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEHOR then
								put simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
									simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
							else
								put simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
									simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
							endif
						endif
						put	 A/2-gs_frw2-offset_05, b-gs_frwt-offset_05, 0, 8, matSash,
							 A/2-gs_frw2, b-gs_frwt-offset_05, 0, 12, matSash,
							 A/2-gs_frw2, b-gs_frwt, 0, 12, matSash

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick2,
							get(nsp)

						gosub 600
					endif

					if gs_sidelight_left then
						if bExtraPrismOnLeftSide then
							put	-A/2 - cutDxLeft, b + cutDy, 0, mask1 - 2*(gs_stack_top | gs_stack_left) - 5*gs_stack_left, matSash,
								-A/2 - cutDxLeft, b-gs_frwt, 0, 8, matSash,
								-A/2+gs_frw1, b-gs_frwt, 0, 12, matSash,
								-A/2+gs_sl_w1, b-gs_frwt, 0, mask3 - 2, matSash
						else
							put	-A/2 - cutDxLeft, b + cutDy, 0, mask1 - 2*(gs_stack_top | gs_stack_left) - 5*gs_stack_left, matSash,
								-A/2 - cutDxLeft, b-gs_frwt-offset_09, 0, 8, matSash,
								-A/2+gs_frw1+offset_09, b-gs_frwt-offset_09, 0, mask1, matSash

							if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_09 = SIMPLESASH_SIDEHUNG then
								SashLeftX	= -A/2+gs_frw1+offset_09
								SashRightX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_09
								simpleSashZ	= b-gs_frwt-offset_09

								simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
								if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEHOR then
									put simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
								else
									put simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
								endif
							endif

							put	-A/2+gs_sl_w1-gs_frw_Sl_left-offset_09, b-gs_frwt-offset_09, 0, mmask, matSash,
								-A/2+gs_sl_w1+offset_leaf, b-gs_frwt-offset_leaf, 0, mask3 - 2, matLeaf
						endif
					else
						if abs(cutDy + gs_frwt + offset_leaf) > EPS then	! avoiding self intersect. prism
							put	-A/2 - cutDxLeft, b + cutDy, 0, mask1 - 2*(gs_stack_top | gs_stack_left) - 5*gs_stack_left, matSash,
								-A/2 - cutDxLeft, b-gs_frwt, 0, 8, matSash,
								-A/2+gs_frw1+offset_leaf, b-gs_frwt-offset_leaf, 0, mask1, matLeaf
						endif
					endif

					if gs_sidelight_right then
						if bExtraPrismOnRightSide then
							put	 A/2-gs_sl_w2, b-gs_frwt, 0, 12, matSash,
								 A/2-gs_frw2, b-gs_frwt, 0, 10, matSash,
								 A/2 + cutDxRight, b-gs_frwt, 0, mask1 - 2 - 5*gs_stack_right, matSash,
								 A/2 + cutDxRight, b + cutDy, 0, mask1 - 2*(gs_stack_top | gs_stack_right) - 5*gs_stack_top, matSash,
								-A/2 - cutDxLeft, b + cutDy, 0, -1, matSash
						else
							put	 A/2-gs_sl_w2-offset_leaf, b-gs_frwt-offset_leaf, 0, mmask, matSash,
								 A/2-gs_sl_w2+gs_frw_Sl_right+offset_05, b-gs_frwt-offset_05, 0, mask1 - 2, matSash

							if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_05 = SIMPLESASH_SIDEHUNG then
								SashLeftX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_05
								SashRightX	= A/2-gs_frw2-offset_05
								simpleSashZ	= b-gs_frwt-offset_05

								simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
								if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEHOR then
									put simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
								else
									put simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
								endif
							endif

							put	 A/2-gs_frw2-offset_05, b-gs_frwt-offset_05, 0, 10, matSash,
								 A/2 + cutDxRight, b-gs_frwt-offset_05, 0, mask1 - 2 - 5*gs_stack_right, matSash,
								 A/2 + cutDxRight, b + cutDy, 0, mask1 - 2*(gs_stack_top | gs_stack_right) - 5*gs_stack_top, matSash,
								-A/2 - cutDxLeft, b + cutDy, 0, -1, matSash
						endif
					else
						if abs(cutDy + gs_frwt + offset_leaf) > EPS then	! avoiding self intersect. prism
							put	 A/2-gs_frw2-offset_leaf, b-gs_frwt-offset_leaf, 0, 10, matSash,
								 A/2 + cutDxRight, b-gs_frwt, 0, mask1 - 2 - 5*gs_stack_right, matSash,
								 A/2 + cutDxRight, b + cutDy, 0, mask1 - 2*(gs_stack_top | gs_stack_right) - 5*gs_stack_top, matSash,
								-A/2 - cutDxLeft, b + cutDy, 0, -1, matSash
						endif
					endif

					if nsp > 0 then
						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick1,
							get(nsp)
					endif
				endif

				gosub 600

			endif


			!************* Both in Type1 and Type2

			if gs_sidelight_left then
				if gs_bSidelight_fr_hdiv_left then
					SashLeftX	= -A/2+gs_frw1+offset_11
					SashRightX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_11
					SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_11
					SashTopY	= horizDivLeftSideLowerPY
					sashWidth	= gs_sl_sash_width
					iSimpleSashFrameType_i = iSimpleSashFrameType_11

					gosub "Extra Frame to Simple Sash"
				endif

				SashLeftX	= -A/2+gs_frw1+offset_09
				SashRightX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_09
				if gs_bSidelight_fr_hdiv_left then
					SashBottomY	= horizDivLeftSideUpperPY
				else
					SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_09
				endif
				SashTopY	= B-gs_frwt-offset_09
				sashWidth	= gs_sl_sash_width
				iSimpleSashFrameType_i = iSimpleSashFrameType_09

				gosub "Extra Frame to Simple Sash"
			endif

			if gs_sidelight_right then
				if gs_bSidelight_fr_hdiv_right then
					SashLeftX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_07
					SashRightX	= A/2-gs_frw2-offset_07
					SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_07
					SashTopY	= horizDivRightSideLowerPY
					sashWidth	= gs_sl_sash_width
					iSimpleSashFrameType_i = iSimpleSashFrameType_07

					gosub "Extra Frame to Simple Sash"
				endif

				SashLeftX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_05
				SashRightX	= A/2-gs_frw2-offset_05
				if gs_bSidelight_fr_hdiv_right then
					SashBottomY	= horizDivRightSideUpperPY
				else
					SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_05
				endif
				SashTopY	= B-gs_frwt-offset_05
				sashWidth	= gs_sl_sash_width
				iSimpleSashFrameType_i = iSimpleSashFrameType_05

				gosub "Extra Frame to Simple Sash"
			endif

			addz frameThickOffset

		next i

		del n

	endif

! ------------------------------------------------------------------------------
! Horizontal Division in both type transom and type without transom,
! type butt and type mitered joint
! ------------------------------------------------------------------------------

! --- Left horizontal division

	if gs_sidelight_left & gs_bSidelight_fr_hdiv_left then
		put horizDivLeftSideLeftUpperPX,	horizDivLeftSideUpperPY, 0, mmask2-4*(bExtraPrismOnLeftSide | bExtraPrismOnLeftSideLower), matSash,
			horizDivLeftSideLeftLowerPX,	horizDivLeftSideLowerPY, 0, mask1,	matSash
		if iSimpleSashFrameType_11 = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_11 = SIMPLESASH_SIDEHUNG then
			SashLeftX	= -A/2+gs_frw1+offset_11
			SashRightX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_11
			simpleSashZ	= horizDivLeftSideLowerPY

			simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
			if iSimpleSashFrameType_11 = SIMPLESASH_SLIDEHOR then
				put simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
					simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
			else
				put simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
					simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
			endif
		endif
		put	horizDivLeftSideRightLowerPX,	horizDivLeftSideLowerPY, 0, 10,		matSash,
			horizDivLeftSideRightUpperPX,	horizDivLeftSideUpperPY, 0, mask1,	matSash
		if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_09 = SIMPLESASH_SIDEHUNG then
			SashLeftX	= -A/2+gs_frw1+offset_09
			SashRightX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_09
			simpleSashZ	= horizDivLeftSideUpperPY

			simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
			if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEHOR then
				put simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
					simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
			else
				put simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
					simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
			endif
		endif

		cprism_{2} mat1, botmat, matSash,
			nsp/5, framethick2,
			get(nsp)

		gosub 600
	endif


! --- Right horizontal division

	if gs_sidelight_right & gs_bSidelight_fr_hdiv_right then

		put horizDivRightSideLeftUpperPX,	horizDivRightSideUpperPY, 0, 10,	matSash,
			horizDivRightSideLeftLowerPX,	horizDivRightSideLowerPY, 0, mask1,	matSash
		if iSimpleSashFrameType_07 = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_07 = SIMPLESASH_SIDEHUNG then
			SashLeftX	= A/2-gs_frw2-offset_07
			SashRightX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_07
			simpleSashZ	= horizDivRightSideLowerPY

			simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
			if iSimpleSashFrameType_07 = SIMPLESASH_SLIDEHOR then
				put simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
					simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
			else
				put simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
					simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
			endif
		endif
		put	horizDivRightSideRightLowerPX,	horizDivRightSideLowerPY, 0, mmask2-4*(bExtraPrismOnRightSide | bExtraPrismOnRightSideLower), matSash,
			horizDivRightSideRightUpperPX,	horizDivRightSideUpperPY, 0, mask1,	matSash
		if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_05 = SIMPLESASH_SIDEHUNG then
			SashLeftX	= A/2-gs_frw2-offset_05
			SashRightX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_05
			simpleSashZ	= horizDivRightSideUpperPY

			simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
			if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEHOR then
				put simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
					simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
			else
				put simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
					simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
			endif
		endif

		cprism_{2} mat1, botmat, matSash,
			nsp/5, framethick2,
			get(nsp)

		gosub 600
	endif

	body -1

	for i=1 to numCuts
		cutend
	next i
	numCuts = 0


	if bEnableJointMat then
		base

		if gs_SashText_typ_num = 1 then
			if gs_jointmat_out = gs_jointmat_in then

				if gs_tolerance_left > 0 then
					cprism_ topjmat, botjmat, sidejmat,
						4, outsideFrameThk,
						frameleft-cutDxLeft,	0,	15,
						frameleft-cutDxLeft,	frametop+cutDy,	8+7*bTolU,
						frameleft,	frametop,	15,
						frameleft,	0,	15

					gosub 500
				endif

				if gs_tolerance_right > 0 then
					cprism_ topjmat, botjmat, sidejmat,
						4, outsideFrameThk,
						frameright+cutDxRight, 	0, 	15,
						frameright+cutDxRight, 	frametop+cutDy,	8+7*bTolU,
						frameright,	frametop,	15,
						frameright,	0,	15

					gosub 500
				endif

				if gs_tolerance_upper > 0 then
					cprism_ topjmat, botjmat, sidejmat,
						4, outsideFrameThk,
						frameleft-cutDxLeft,	frametop+cutDy,	10+5*bTolL,
						frameleft,	frametop,	15,
						frameright,	frametop,	10+5*bTolR,
						frameright+cutDxRight,	frametop+cutDy,	15

					gosub 600
				endif
			else
				if gs_tolerance_left > 0 then
					cprism_ botjmat, botjmat, botjmat,
						4, LeafRebate,
						frameleft-cutDxLeft,	0,	15,
						frameleft-cutDxLeft,	frametop+cutDy,	8+7*bTolU,
						frameleft,	frametop,	15,
						frameleft,	0,	15
					body 1

					addz LeafRebate

					cprism_ topjmat, botjmat, topjmat,
						4, outsideFrameThk-LeafRebate,
						frameleft-cutDxLeft,	0,	15,
						frameleft-cutDxLeft,	frametop+CutDy,	8+7*bTolU,
						frameleft,	frametop,	15,
						frameleft,	0,	15

					del 1

					gosub 500
				endif

				if gs_tolerance_right > 0 then
					cprism_ botjmat, botjmat, botjmat,
						4, LeafRebate,
						frameright+cutDxRight, 	0, 	15,
						frameright+cutDxRight, 	frametop+CutDy,	8+7*bTolU,
						frameright,	frametop,	15,
						frameright,	0,	15
					body 1

					addz LeafRebate

					cprism_ topjmat, botjmat, topjmat,
						4, outsideFrameThk-LeafRebate,
						frameright+cutDxRight, 	0, 	15,
						frameright+cutDxRight, 	frametop+CutDy,	8+7*bTolU,
						frameright,	frametop,	15,
						frameright,	0,	15

					del 1

					gosub 500
				endif

				if gs_tolerance_upper > 0 then
					cprism_ botjmat, botjmat, botjmat,
						4, LeafRebate,
						frameleft-cutDxLeft,	frametop+cutDy,	10+5*bTolL,
						frameleft,	frametop,	15,
						frameright,	frametop,	10+5*bTolL,
						frameright+cutDxRight,	frametop+cutDy,	15
					body 1

					addz LeafRebate

					cprism_ topjmat, botjmat, topjmat,
						4, outsideFrameThk-LeafRebate,
						frameleft-cutDxLeft,	frametop+cutDy,	10+5*bTolL,
						frameleft,	frametop,	15,
						frameright,	frametop,	10+5*bTolR,
						frameright+cutDxRight,	frametop+cutDy,	15

					del 1

					gosub 600
				endif
			endif

		else

			if gs_jointmat_out = gs_jointmat_in then
				if gs_tolerance_left > 0 then
					cprism_ topjmat, botjmat, sidejmat,
						4, outsideFrameThk,
						frameleft-cutDxLeft,	0,	15,
						frameleft-cutDxLeft,	frametop,	8+7*bTolL,
						frameleft,	frametop,	15,
						frameleft,	0,	15

					gosub 500
				endif

				if gs_tolerance_right > 0 then
					cprism_ topjmat, botjmat, sidejmat,
						4, outsideFrameThk,
						frameright+cutDxRight, 	0, 	15,
						frameright+cutDxRight, 	frametop,	8+7*bTolR,
						frameright,	frametop,	13,
						frameright,	0,	15

					gosub 500
				endif

				if gs_tolerance_upper > 0 then
					cprism_ topjmat, botjmat, sidejmat,
						6, outsideFrameThk,
						frameleft-cutDxLeft,	frametop+cutDy,	15,
						frameleft-cutDxLeft,	frametop,	8+7*bTolL,
						frameleft,	frametop,	15,
						frameright,	frametop,	10+5*bTolR,
						frameright+cutDxRight,	frametop,	13+2*bTolR,
						frameright+cutDxRight,	frametop+cutDy,	15

					gosub 600
				endif
			else
				if gs_tolerance_left > 0 then
					cprism_ botjmat, botjmat, botjmat,
						4, LeafRebate,
						frameleft-cutDxLeft,	0,	15,
						frameleft-cutDxLeft,	frametop,	8+7*bTolL,
						frameleft,	frametop,	15,
						frameleft,	0,	15
					body 1

					addz LeafRebate

					cprism_ topjmat, botjmat, topjmat,
						4, outsideFrameThk-LeafRebate,
						frameleft-cutDxLeft,	0,	15,
						frameleft-cutDxLeft,	frametop,	8+7*bTolL,
						frameleft,	frametop,	15,
						frameleft,	0,	15

					del 1

					gosub 500
				endif

				if gs_tolerance_right > 0 then
					cprism_ botjmat, botjmat, botjmat,
						4, LeafRebate,
						frameright+cutDxRight, 	0, 	15,
						frameright+cutDxRight, 	frametop,	8+7*bTolR,
						frameright,	frametop,	13,
						frameright,	0,	15
					body 1

					addz LeafRebate

					cprism_ topjmat, botjmat, topjmat,
						4, outsideFrameThk-LeafRebate,
						frameright+cutDxRight, 	0, 	15,
						frameright+cutDxRight, 	frametop,	8+7*bTolR,
						frameright,	frametop,	13,
						frameright,	0,	15

					del 1

					gosub 500
				endif

				if gs_tolerance_upper > 0 then
					cprism_ botjmat, botjmat, botjmat,
						6, LeafRebate,
						frameleft-cutDxLeft,	frametop+cutDy,	15,
						frameleft-cutDxLeft,	frametop,	8+7*bTolL,
						frameleft,	frametop,	15,
						frameright,	frametop,	10+5*bTolR,
						frameright+cutDxRight,	frametop,	13+2*bTolR,
						frameright+cutDxRight,	frametop+cutDy,	15
					body 1

					addz LeafRebate

					cprism_ topjmat, botjmat, topjmat,
						6, outsideFrameThk-LeafRebate,
						frameleft-cutDxLeft,	frametop+cutDy,	15,
						frameleft-cutDxLeft,	frametop,	8+7*bTolL,
						frameleft,	frametop,	15,
						frameright,	frametop,	10+5*bTolR,
						frameright+cutDxRight,	frametop,	13+2*bTolR,
						frameright+cutDxRight,	frametop+cutDy,	15

					del 1

					gosub 600
				endif
			endif
		endif

		body -1
	endif
else

! ===========================================================================
! Commercial Door Frame
! ===========================================================================

	if gs_frame_style_m = FRAME_STYLE_METAL then

		fitFrame_top_ovhg	= 0
		fitFrame_left_ovhg	= 0
		fitFrame_right_ovhg	= 0

		if gs_fitframe_slantedreveal then
			fitFrame_top_ovhg	= tan(gs_reveal_top_angle) * outsideFrameThk
			fitFrame_left_ovhg	= tan(gs_reveal_left_angle) * outsideFrameThk
			fitFrame_right_ovhg	= tan(gs_reveal_right_angle) * outsideFrameThk
		endif

		signFlipped = (WIDO_REVEAL_SIDE - not(WIDO_REVEAL_SIDE))

		material gs_frame_mat
		gs_txt = 1
		jp = 1/2"
		fi1 = atn(gs_frw1/gs_frwt)
		fi2 = atn(gs_frw2/gs_frwt)
		ctx = jp * gs_frame_wthk

		if abs(gs_ds_w) > eps then
!!			if gs_side_exist = 0 then add 0, 0, gs_ds_pr - ctx
!!			if gs_side_exist = 1 then add  ac_leaf_width/2 + frameleft  + gs_sl_w1, 0, gs_ds_pr - ctx
!!			if gs_side_exist = 3 then add -ac_leaf_width/2 + frameright - gs_sl_w1, 0, gs_ds_pr - ctx

			add ac_leaf_width/2 + frameleft + gs_sl_w1, 0, gs_ds_pr - ctx

			for i=1 to 2
				cprism_ gs_frame_mat, gs_frame_mat, gs_frame_mat,
					 5, gs_ds_thk,
					-ac_leaf_width/2, 0, 15,
					-ac_leaf_width/2+gs_ds_w, 0, 15,
					-ac_leaf_width/2+gs_ds_w, ac_leaf_height-gs_ds_w*(gs_txt<>1), 15-5*(gs_txt=3),
					-ac_leaf_width/2, ac_leaf_height-gs_ds_w*(gs_txt=2), 15,
					-ac_leaf_width/2, 0, -1
				if i=2 then mulx -1
				teta=90
				tx=0
				gosub 500
				if i=2 then del 1

				mulx -1
			next i
			del 2

			cprism_ gs_frame_mat, gs_frame_mat, gs_frame_mat,
				5, gs_ds_thk,
				-ac_leaf_width/2+gs_ds_w*(gs_txt=1),  ac_leaf_height, 15,
				 ac_leaf_width/2-gs_ds_w*(gs_txt=1),  ac_leaf_height, 15-5*(gs_txt=3),
				 ac_leaf_width/2-gs_ds_w*(gs_txt<>2), ac_leaf_height-gs_ds_w, 15,
				-ac_leaf_width/2+gs_ds_w*(gs_txt<>2), ac_leaf_height-gs_ds_w, 15-5*(gs_txt=3),
				-ac_leaf_width/2+gs_ds_w*(gs_txt=1),  ac_leaf_height, -1
			teta=0
			tx=0.5
			gosub 600

			del 1
		endif

		rotx -90

! Right -----------------------------------------------------------------------

		if gs_fitframe_slantedreveal then		! slanted reveal cuts
			addz frametop + WIDO_REVEAL_SIDE * fitFrame_top_ovhg
			rotx signFlipped  * gs_reveal_top_angle
			cutplane
			del 2
		endif

		addx frameright-gs_frw2

		addz frametop-gs_frwt
		rotx 90
		ang = atn((gs_frwt+fitFrame_top_ovhg)/(gs_frw2+fitFrame_right_ovhg))
		dx = gs_frwt+gs_tolerance_upper*not(gs_frame_wthk)+1+TAN(gs_reveal_right_angle) * gs_fthk * gs_fitframe_slantedreveal
		cutpolya 5, 2, 0,
			0, 0, 15,
			-gs_ds_w-0.01, -gs_ds_w-0.01, 15,
			-gs_ds_w-0.01,  dx, 15,
			dx/tan(ang), dx, 15,
			0, 0, -1
		del 2

		rotz 90

		if gs_fitframe_slantedreveal then
			if gs_frame_ovhg_right_out > gs_frame_ovhg_right_in then
				put	ctx,				0,                            																	15,
					ctx,				-gs_frw2-gs_tolerance_right*not(gs_frame_wthk) - tan(gs_reveal_right_angle) * outsideFrameThk,			15,
					ctx-jp,				-gs_frw2-gs_tolerance_right*not(gs_frame_wthk) - tan(gs_reveal_right_angle) * (outsideFrameThk-jp),	15,
					ctx-jp,				-gs_frw2-gs_tolerance_right+jp*not(gs_frame_wthk),												15,
					-outsideFrameThk+jp-ctx,	-gs_frw2-gs_tolerance_right+jp*not(gs_frame_wthk),												15,
					-outsideFrameThk+jp-ctx,	-gs_frw2-gs_tolerance_right*not(gs_frame_wthk) - tan(gs_reveal_right_angle) * jp,				15,
					-outsideFrameThk-ctx,		-gs_frw2-gs_tolerance_right*not(gs_frame_wthk),													15
			else
				put	ctx,				0,                            																	15,
					ctx,				-gs_frw2-gs_tolerance_right*not(gs_frame_wthk),               									15,
					ctx-jp,				-gs_frw2-gs_tolerance_right*not(gs_frame_wthk) - tan(gs_reveal_right_angle) * jp,				15,
					ctx-jp,				-gs_frw2-gs_tolerance_right+jp*not(gs_frame_wthk),												15,
					-outsideFrameThk+jp-ctx,	-gs_frw2-gs_tolerance_right+jp*not(gs_frame_wthk),												15,
					-outsideFrameThk+jp-ctx,	-gs_frw2-gs_tolerance_right*not(gs_frame_wthk) - tan(gs_reveal_right_angle) * (outsideFrameThk-jp),	15,
					-outsideFrameThk-ctx,		-gs_frw2-gs_tolerance_right*not(gs_frame_wthk) - tan(gs_reveal_right_angle) * outsideFrameThk,			15
			endif
		else
			put	ctx,				0,                            						15,
				ctx,				-gs_frw2-gs_tolerance_right*not(gs_frame_wthk),		15,
				ctx-jp,				-gs_frw2-gs_tolerance_right*not(gs_frame_wthk),		15,
				ctx-jp,				-gs_frw2-gs_tolerance_right+jp*not(gs_frame_wthk),	15,
				-outsideFrameThk+jp-ctx,	-gs_frw2-gs_tolerance_right+jp*not(gs_frame_wthk),	15,
				-outsideFrameThk+jp-ctx,	-gs_frw2-gs_tolerance_right*not(gs_frame_wthk),		15,
				-outsideFrameThk-ctx,		-gs_frw2-gs_tolerance_right*not(gs_frame_wthk),		15
		endif

		prism_ 2+nsp/3, frametop + fitFrame_top_ovhg + max(0, gs_tolerance_upper),
			get(nsp),
			-outsideFrameThk-ctx,	 	0,	15,
			ctx, 				0,	15

		cutend
		if gs_fitframe_slantedreveal then cutend

		del 2

		gosub 500

! Top -------------------------------------------------------------------------

		if gs_fitframe_slantedreveal then		! slanted reveal cuts
			addx frameright + WIDO_REVEAL_SIDE * fitFrame_right_ovhg
			roty 90
			rotx signFlipped  * gs_reveal_right_angle
			cutplane
			del 3

			addx frameleft - WIDO_REVEAL_SIDE *  fitFrame_left_ovhg
			roty -90
			rotx signFlipped  * gs_reveal_left_angle
			cutplane
			del 3
		endif

		add frameleft + gs_frw1, 0, frametop - gs_frwt
		rotx 90
		ang = atn((gs_frwt+fitFrame_top_ovhg)/(gs_frw1+fitFrame_left_ovhg))
		dx = (gs_frwt+gs_tolerance_upper*not(gs_frame_wthk)+1+TAN(gs_reveal_top_angle) * gs_fthk *gs_fitframe_slantedreveal)
		cutpolya 5, 2, 0,
			0, 0, 15,
			gs_ds_w+0.01, -gs_ds_w-0.01, 15,
			-dx/tan(ang), -gs_ds_w-0.01, 15,
			-dx/tan(ang), dx, 15,
			0, 0, -1
		del 1

		add frameright - frameleft - gs_frw1 - gs_frw2, 0, 0
		rotx 90
		ang = atn((gs_frwt+fitFrame_top_ovhg)/(gs_frw2+fitFrame_right_ovhg))
		cutpolya 5, 2, 0,
			0, 0, 15,
			-gs_ds_w-0.01, -gs_ds_w-0.01, 15,
			dx/tan(ang),  -gs_ds_w-0.01, 15,
			dx/tan(ang), dx, 15,
			0, 0, -1
		del 2

		roty 90
		rotz 90
		mulx -1
		addz -fitFrame_left_ovhg - gs_frw1 - max(0, gs_tolerance_left)


		if gs_fitframe_slantedreveal then
			if gs_frame_ovhg_right_out > gs_frame_ovhg_right_in then
				put -ctx,				0,                            																15,
					-ctx,				gs_frwt+gs_tolerance_upper*not(gs_frame_wthk) + tan(gs_reveal_top_angle) * outsideFrameThk,			15,
					-ctx+jp,			gs_frwt+gs_tolerance_upper*not(gs_frame_wthk) + tan(gs_reveal_top_angle) * (outsideFrameThk-jp),	15,
					-ctx+jp,			gs_frwt+gs_tolerance_upper-jp*not(gs_frame_wthk),											15,
					outsideFrameThk-jp+ctx,		gs_frwt+gs_tolerance_upper-jp*not(gs_frame_wthk),											15,
					outsideFrameThk-jp+ctx,		gs_frwt+gs_tolerance_upper*not(gs_frame_wthk) + tan(gs_reveal_top_angle) * jp,				15,
					outsideFrameThk+ctx,		gs_frwt+gs_tolerance_upper*not(gs_frame_wthk),												15
			else
				put -ctx,				0,            																				15,
					-ctx,				gs_frwt+gs_tolerance_upper*not(gs_frame_wthk),												15,
					-ctx+jp,			gs_frwt+gs_tolerance_upper*not(gs_frame_wthk) + tan(gs_reveal_top_angle) * jp,				15,
					-ctx+jp,			gs_frwt+gs_tolerance_upper-jp*not(gs_frame_wthk),											15,
					outsideFrameThk-jp+ctx,		gs_frwt+gs_tolerance_upper-jp*not(gs_frame_wthk),											15,
					outsideFrameThk-jp+ctx,		gs_frwt+gs_tolerance_upper*not(gs_frame_wthk) + tan(gs_reveal_top_angle) * (outsideFrameThk-jp),	15,
					outsideFrameThk+ctx,		gs_frwt+gs_tolerance_upper*not(gs_frame_wthk) + tan(gs_reveal_top_angle) * outsideFrameThk,		15
			endif
		else
			put	-ctx,				0,                            						15,
				-ctx,				gs_frwt+gs_tolerance_upper*not(gs_frame_wthk), 		15,
				-ctx+jp,			gs_frwt+gs_tolerance_upper*not(gs_frame_wthk), 		15,
				-ctx+jp,			gs_frwt+gs_tolerance_upper-jp*not(gs_frame_wthk),	15,
				outsideFrameThk-jp+ctx,		gs_frwt+gs_tolerance_upper-jp*not(gs_frame_wthk),	15,
				outsideFrameThk-jp+ctx,		gs_frwt+gs_tolerance_upper*not(gs_frame_wthk),  	15,
				outsideFrameThk+ctx,		gs_frwt+gs_tolerance_upper*not(gs_frame_wthk),		15
		endif


		prism_ 2+nsp/3, frameright - frameleft + fitFrame_left_ovhg + fitFrame_right_ovhg + max(0, gs_tolerance_left) + max(0, gs_tolerance_right),
			get(nsp),
			outsideFrameThk+ctx,	0,	15,
			-ctx,			0,	15

		cutend
		cutend
		if gs_fitframe_slantedreveal then cutend
		if gs_fitframe_slantedreveal then cutend

		del 5
		gosub 600

! Left ------------------------------------------------------------------------

		if gs_fitframe_slantedreveal then		! slanted reveal cuts
			addz frametop + WIDO_REVEAL_SIDE * fitFrame_top_ovhg
			rotx signFlipped * gs_reveal_top_angle
			cutplane
			del 2
		endif

		addx frameleft+gs_frw1

		addz frametop-gs_frwt
		rotx 90
		ang = atn((gs_frwt+fitFrame_top_ovhg)/(gs_frw1+fitFrame_left_ovhg))
		dx = gs_frwt+gs_tolerance_upper*not(gs_frame_wthk)+1+TAN(gs_reveal_left_angle) * gs_fthk * gs_fitframe_slantedreveal
		cutpolya 5, 2, 0,
			0, 0, 15,
			gs_ds_w+0.01, -gs_ds_w-0.01, 15,
			gs_ds_w+0.01, dx, 15,
			-dx/tan(ang), dx, 15,
			0, 0, -1
		del 2

		rotz 90
		mulx -1

		if gs_fitframe_slantedreveal then
			if gs_frame_ovhg_left_out > gs_frame_ovhg_left_in then
				put -ctx,				0,                            																15,
					-ctx,				gs_frw1+gs_tolerance_left*not(gs_frame_wthk) + tan(gs_reveal_left_angle) * outsideFrameThk, 		15,
					-ctx+jp,			gs_frw1+gs_tolerance_left*not(gs_frame_wthk) + tan(gs_reveal_left_angle) * (outsideFrameThk-jp),	15,
					-ctx+jp,			gs_frw1+gs_tolerance_left-jp*not(gs_frame_wthk),  											15,
					outsideFrameThk-jp+ctx,		gs_frw1+gs_tolerance_left-jp*not(gs_frame_wthk),											15,
					outsideFrameThk-jp+ctx,		gs_frw1+gs_tolerance_left*not(gs_frame_wthk) + tan(gs_reveal_left_angle) * jp,				15,
					outsideFrameThk+ctx,		gs_frw1+gs_tolerance_left*not(gs_frame_wthk),												15
			else
				put-ctx,				0,                            																15,
					-ctx,				gs_frw1+gs_tolerance_left*not(gs_frame_wthk), 												15,
					-ctx+jp,			gs_frw1+gs_tolerance_left*not(gs_frame_wthk) + tan(gs_reveal_left_angle) * jp,				15,
					-ctx+jp,			gs_frw1+gs_tolerance_left-jp*not(gs_frame_wthk),  											15,
					outsideFrameThk-jp+ctx,		gs_frw1+gs_tolerance_left-jp*not(gs_frame_wthk),											15,
					outsideFrameThk-jp+ctx,		gs_frw1+gs_tolerance_left*not(gs_frame_wthk) + tan(gs_reveal_left_angle) * (outsideFrameThk-jp),	15,
					outsideFrameThk+ctx,		gs_frw1+gs_tolerance_left*not(gs_frame_wthk) + tan(gs_reveal_left_angle) * outsideFrameThk,			15
			endif
		else
			put -ctx,				0,                            						15,
				-ctx,				gs_frw1+gs_tolerance_left*not(gs_frame_wthk), 		15,
				-ctx+jp,			gs_frw1+gs_tolerance_left*not(gs_frame_wthk),		15,
				-ctx+jp,			gs_frw1+gs_tolerance_left-jp*not(gs_frame_wthk),  	15,
				outsideFrameThk-jp+ctx,		gs_frw1+gs_tolerance_left-jp*not(gs_frame_wthk),	15,
				outsideFrameThk-jp+ctx,		gs_frw1+gs_tolerance_left*not(gs_frame_wthk),		15,
				outsideFrameThk+ctx,		gs_frw1+gs_tolerance_left*not(gs_frame_wthk),		15
		endif


		prism_ 2+nsp/3, frametop + fitFrame_top_ovhg + max(0, gs_tolerance_upper),
			get(nsp),
			outsideFrameThk+ctx,	 	0,	15,
			-ctx, 				0,	15
		del 1

		cutend
		if gs_fitframe_slantedreveal then cutend

		del 2

		gosub 500

		del 1

		if gs_sidelight_left then
			add 0, 0, -ctx
			cprism_ gs_frame_mat, gs_frame_mat, gs_frame_mat,
				5, outsideFrameThk+2*ctx,
				-A/2+gs_sl_w1, 0, 15,
				-A/2+gs_sl_w1-gs_frw_Sl_left, 0, 15,
				-A/2+gs_sl_w1-gs_frw_Sl_left, ac_leaf_height, 15,
				-A/2+gs_sl_w1, ac_leaf_height, 15,
				-A/2+gs_sl_w1, 0, -1
			body 1
			del 1
		endif

		if gs_sidelight_right then
			add 0, 0, -ctx
			cprism_ gs_frame_mat, gs_frame_mat, gs_frame_mat,
				5, outsideFrameThk+2*ctx,
				A/2-gs_sl_w2, 0, 15,
				A/2-gs_sl_w2+gs_frw_Sl_right, 0, 15,
				A/2-gs_sl_w2+gs_frw_Sl_right, ac_leaf_height, 15,
				A/2-gs_sl_w2, ac_leaf_height, 15,
				A/2-gs_sl_w2, 0, -1
			body 1
			del 1
		endif

		if gs_door_transom then
			add 0, 0, -ctx
			cprism_ gs_frame_mat, gs_frame_mat, gs_frame_mat,
				5, outsideFrameThk+2*ctx,
				-A/2+gs_frw1, ac_leaf_height, 15,
				A/2-gs_frw2, ac_leaf_height, 15,
				A/2-gs_frw2, ac_leaf_height+gs_frwm, 15,
				-A/2+gs_frw1, ac_leaf_height+gs_frwm, 15,
				-A/2+gs_frw1, ac_leaf_height, -1
			body 1
			del 1
		endif
	endif

endif

! ===========================================================================
! Double Egress Metal Door
! ===========================================================================

if gs_frame_style_m = FRAME_STYLE_DOUBLE_EGRESS_METAL then

	signFlipped = -1

	material gs_frame_mat

	xCutFrameRight2 = gs_frw2-gs_rebate_width * 2
	xCutFrameUp2 = gs_frwt - gs_rebate_width * 2
	xCutFrameLeft2 = gs_frw1-gs_rebate_width * 2

	rotx -90

	! Right Side
	! -----------------------------------------------------------------------

	add unitright, -posLeafy - gs_leaf_thk, unittop
	rotx 90
	cutpolya 6, 2, -eps,
		0,									0, 2+8,
		-gs_frw2+gs_rebate_width,			0, 8,
		-gs_frw2+gs_rebate_width,			-xCutFrameUp2, 1+2+8,
		-xCutFrameRight2,					-xCutFrameUp2, 2+8,
		gs_tolerance_right,	gs_tolerance_upper, 8,
		0, 0, 2+8,
		0,0, signFlipped

	roty 180
	cutpolya 5, 2, -eps,
		0, 0, 15,
		gs_frw2, 0, 8,
		gs_frw2,			-gs_frwt, 2+8,
		-gs_tolerance_right, gs_tolerance_upper, 8,
		0, 0, 2+8,
		0,0, signFlipped
	del 3

	add leafright + frameDiff, -gs_frame_thk, 0
	rotz 180

	framex		= gs_frw2
	tolerancex	= gs_tolerance_right
	drawUpper	= 0
	lengthx		= ac_unit_height

	gosub "Egress Metal Profile"

	cutend
	cutend
	del 2

	gosub 500

	! Top Side
	! -----------------------------------------------------------------------

	! right cut
	add unitright, -posLeafy - gs_leaf_thk, unittop
	rotx 90
	cutpolya 5, 2, -eps,
		0,					0,  				2+8,
		0,					-xCutFrameUp2, 		8,
		-xCutFrameRight2,	-xCutFrameUp2, 		2+8,
		gs_tolerance_right, gs_tolerance_upper, 8,
		0, 0, 2+8,
		0,0, signFlipped


	rotx -180
	cutpolya 5, 2,  -eps,
		0, 0, 2+8,
		0, gs_frwt, 8,
		-gs_frw2, gs_frwt, 2+8,
		gs_tolerance_right, -gs_tolerance_upper, 8,
		0, 0, 2+8,
		0,0, signFlipped

	del 3

	add unitright, -gs_frame_thk, leaftop - gs_rebate_width
	rotz 180
	roty 90

	framex		= gs_frwt
	tolerancex	= gs_tolerance_upper
	drawUpper	= 1
	lengthx		= gs_mdpw + gs_frw2 - gs_rebate_width

	gosub "Egress Metal Profile"

	cutend
	cutend
	del 3

	gosub 500

	! left cut
	add unitleft,  -posLeafy, unittop
	rotx 90
	cutpolya 5, 2,  -eps,
		0, 		0, 2+8,
		0, 		-gs_frwt, 8,
		gs_frw1, -gs_frwt, 2+8,
		-gs_tolerance_left, gs_tolerance_upper, 8,
		0, 		0, 2+8,
		0,0, signFlipped


	roty 180
	cutpolya 5, 2, -eps,
		0, 0,					2+8,
		0, 		-xCutFrameUp2, 8,
		-xCutFrameLeft2,	-xCutFrameUp2,	2+8,
		gs_tolerance_left, gs_tolerance_upper,	8,
		0, 0,					2+8,
		0,0, signFlipped

	del 3

	add unitleft, 0, leaftop - gs_rebate_width
	roty 90

	framex		= gs_frwt
	tolerancex	= gs_tolerance_upper
	drawUpper	= 1
	lengthx		= ac_unit_width - (gs_mdpw + gs_frw2 - gs_rebate_width)

	gosub "Egress Metal Profile"

	cutend
	cutend
	del 2

	gosub 500

	! Left Side
	! -----------------------------------------------------------------------

	add unitleft, -posLeafy, unittop
	rotx 90
	cutpolya 5, 2,  -eps,
		0, 0, 2+8,
		gs_frw1, 0, 8,
		gs_frw1, -gs_frwt, 2+8,
		-gs_tolerance_left, gs_tolerance_upper, 8,
		0, 0, 2+8,
		0,0, signFlipped

	roty 180
	cutpolya 6, 2, -eps,
		0, 0, 2+8,
		-xCutFrameLeft2 - gs_rebate_width, 0, 8,
		-xCutFrameLeft2 - gs_rebate_width, -xCutFrameUp2, 1+2+8,
		-xCutFrameLeft2, -xCutFrameUp2, 2+8,
		gs_tolerance_left, gs_tolerance_upper, 8,
		0, 0, 2+8,
		0,0, signFlipped
	del 3

	addx leafleft + frameDiff

	framex		= gs_frw1
	tolerancex	= gs_tolerance_left
	drawUpper	= 0
	lengthx		= ac_unit_height

	gosub "Egress Metal Profile"

	cutend
	cutend
	del 1

	gosub 500

endif

if bNeedCutting & outsideFrameThk > EPS then
	cutend
	cutend
	cutend
endif


! =============================================================================
! Pockets
! =============================================================================
"PlacingPockets":

if gs_pocket & lod3D <> 5 then

	add (gs_tolerance_right - gs_tolerance_left)/2, 0, posLeafy

	if gs_pocket_door_frame then
		heightLeaf = ac_leaf_height
	else
		heightLeaf = ac_wallhole_height
	endif

	unID = 3400

	if bDoubleDoor then
		if gs_usaframe then
			PocketWidth = ac_leaf_width/2-0.005
			if gs_pocket_door_frame then PocketWidth = ac_leaf_width/2 - gs_frame_width_right - gs_tolerance_right-0.005
		else
			if bPocketWidthOverride then
				PocketWidth = gs_pocket_width/2 - (ac_egress_width/2 + gs_frame_width_right + gs_tolerance_right) * gs_pocket_door_frame - ac_wallhole_width/2 * not(gs_pocket_door_frame)
			else
				PocketWidth = ac_wallhole_width/2
				if gs_pocket_door_frame then PocketWidth = ac_egress_width/2 - gs_frame_width_right - gs_tolerance_right
			endif
		endif
	else
		if gs_usaframe then
			PocketWidth = ac_leaf_width-0.005
			if gs_pocket_door_frame then PocketWidth = ac_leaf_width - gs_frame_width_right - gs_tolerance_right -0.005
		else
			if bPocketWidthOverride then
				PocketWidth = gs_pocket_width - (A + gs_tolerance_left + gs_tolerance_right) * gs_pocket_door_frame - ac_wallhole_width * not(gs_pocket_door_frame)
			else
				PocketWidth = ac_wallhole_width
				if gs_pocket_door_frame then PocketWidth = ac_egress_width - gs_frame_width_right - gs_tolerance_right
			endif
		endif
	endif
	gosub "Pocket"


	if bDoubleDoor then
		if gs_usaframe then
			if gs_pocket_door_frame then PocketWidth = ac_leaf_width/2 - gs_frame_width_left - gs_tolerance_left-0.005
		else
			if bPocketWidthOverride then
				PocketWidth = gs_pocket_width/2 - (ac_egress_width/2 + gs_frame_width_left + gs_tolerance_left) * gs_pocket_door_frame - ac_wallhole_width/2 * not(gs_pocket_door_frame)
			else
				if gs_pocket_door_frame then PocketWidth = ac_egress_width/2 - gs_frame_width_left - gs_tolerance_left
			endif
		endif
		mulx -1
		gosub "Pocket"
		del 1
	endif

	del 1
endif



end


! =============================================================================
! Pocket for Pocket Doors
! =============================================================================

"Pocket":

addx ac_wallhole_width/2

if gs_pocket_frame then

	sect_fill fr_sect_fill_type, fr_sect_fill_bg, fr_sect_fill_fg, gs_frame_pen_cont
	material gs_frame_mat
	pen gs_frame_pen

	rotx -90

	hotspot 0,											gs_pocket_frame_thk,					0,		unID	:	unID = unID+1
	hotspot 0,											- widthWallCut - gs_pocket_frame_thk,	0,		unID	:	unID = unID+1
	hotspot PocketWidth + 0.005 + gs_pocket_frame_thk,	- widthWallCut - gs_pocket_frame_thk,	0,		unID	:	unID = unID+1
	hotspot PocketWidth + 0.005 + gs_pocket_frame_thk,	gs_pocket_frame_thk,					0,		unID	:	unID = unID+1
	hotspot 0,											gs_pocket_frame_thk,					heightLeaf + 0.005 + gs_pocket_frame_thk,		unID	:	unID = unID+1
	hotspot 0,											- widthWallCut - gs_pocket_frame_thk,	heightLeaf + 0.005 + gs_pocket_frame_thk,		unID	:	unID = unID+1
	hotspot PocketWidth + 0.005 + gs_pocket_frame_thk,	- widthWallCut - gs_pocket_frame_thk,	heightLeaf + 0.005 + gs_pocket_frame_thk,		unID	:	unID = unID+1
	hotspot PocketWidth + 0.005 + gs_pocket_frame_thk,	gs_pocket_frame_thk,					heightLeaf + 0.005 + gs_pocket_frame_thk,		unID	:	unID = unID+1


	num_lath = INT((heightLeaf) / 0.5) - 1
	dist_lath = (heightLeaf - 0.04) / (num_lath+1)

	lath_lgth_modif = 0
	if not(gs_pocket_door_frame) then lath_lgth_modif = 0.04

	addz 0.02

	for ij = 1 to num_lath+2
		addz -0.02
		prism_	4, 0.04,
			lath_lgth_modif,							gs_pocket_frame_thk,					15,
			lath_lgth_modif,							0,										15,
			PocketWidth + 0.005 + gs_pocket_frame_thk,	0,										15,
			PocketWidth + 0.005 + gs_pocket_frame_thk,	gs_pocket_frame_thk,					15

		prism_	4, 0.04,
			lath_lgth_modif,							- widthWallCut,							15,
			lath_lgth_modif,							- widthWallCut - gs_pocket_frame_thk,	15,
			PocketWidth + 0.005 + gs_pocket_frame_thk,	- widthWallCut - gs_pocket_frame_thk,	15,
			PocketWidth + 0.005 + gs_pocket_frame_thk,	- widthWallCut,							15

		del 1
		addz dist_lath
	next ij
	del num_lath+2+1

	prism_	4, heightLeaf,
		PocketWidth + 0.005,						0,				15,
		PocketWidth + 0.005,						- widthWallCut,	15,
		PocketWidth + 0.005 + gs_pocket_frame_thk,	- widthWallCut,	15,
		PocketWidth + 0.005 + gs_pocket_frame_thk,	0,				15

	if not(gs_pocket_door_frame) then
		prism_	4, heightLeaf,
			lath_lgth_modif,	gs_pocket_frame_thk,	15,
			lath_lgth_modif,	0,						15,
			0,					0,						15,
			0,					gs_pocket_frame_thk,	15

		prism_	4, heightLeaf,
			lath_lgth_modif,	- widthWallCut - gs_pocket_frame_thk,	15,
			lath_lgth_modif,	- widthWallCut,							15,
			0,					- widthWallCut,							15,
			0,					- widthWallCut - gs_pocket_frame_thk,	15
	endif

	del 1

	addz -gs_pocket_frame_thk
	wallniche 5, 1, 1,
		0, 0, 1, widthWallCut + 2 * gs_pocket_frame_thk,
		PocketWidth + 0.005 + gs_pocket_frame_thk,	0,			31,
		0,											0,			31,
		0,											heightLeaf, 31,
		PocketWidth + 0.005 + gs_pocket_frame_thk,	heightLeaf, 31,
		PocketWidth + 0.005 + gs_pocket_frame_thk,	0,			-1
	del 1
else
	wallniche 5, 1, 1,
		0, 0, 1, widthWallCut,
		PocketWidth + 0.005,	0, 15+16,
		0,						0, 15+16,
		0,						heightLeaf, 15+16,
		PocketWidth + 0.005,	heightLeaf, 15+16,
		PocketWidth + 0.005,	0, -1
endif



del 1

return


500:

!********************** texture coordination, vertical

vert 0, 0, 0
vert 0, 1, 0
vert 1, 0, 0
vert 0, 0, 1
coor 2, -1, -2, -3, -4
body 1

base

return



600:

!********************** texture coordination, horozintal

rotz 90
vert 0, 0, 0
vert 0, 1, 0
vert 1, 0, 0
vert 0, 0, 1
coor 2, -1, -2, -3, -4
body 1
del 1

base

return

! ------------------------------------------------------------------------------
"Egress Metal Profile":
! ------------------------------------------------------------------------------

	put 	 gs_rebate_width - framex,				 gs_unit_extra_thk,						0,	15,					gs_frame_mat,
			 gs_rebate_width,						 gs_unit_extra_thk,						0,	15,					gs_frame_mat,
			 gs_rebate_width,						-gs_frame_thk + posLeafy + gs_leaf_thk,	0,	15,					gs_frame_mat,
			-gs_rebate_width * drawUpper,			-gs_frame_thk + posLeafy + gs_leaf_thk,	0,	15,					gs_frame_mat,
			-gs_rebate_width * drawUpper,			-gs_frame_thk + posLeafy,				0,	15,					gs_frame_mat,
			-gs_rebate_width,						-gs_frame_thk + posLeafy,				0,	15 - 2 * drawUpper,	gs_frame_mat,
			-gs_rebate_width,						-gs_frame_thk-gs_unit_extra_thk,		0,	15,					gs_frame_mat,
			 gs_rebate_width - framex,				-gs_frame_thk-gs_unit_extra_thk,		0,	15,					gs_frame_mat,
			 gs_rebate_width - framex,				-gs_frame_thk,							0,	15,					gs_frame_mat,
			 gs_rebate_width - framex - tolerancex,	-gs_frame_thk,							0,	15,					gs_frame_mat,
			 gs_rebate_width - framex - tolerancex,	 0,										0,	15,					gs_frame_mat,
			 gs_rebate_width - framex,				 0,										0,	15,					gs_frame_mat,
			 gs_rebate_width - framex,				 gs_unit_extra_thk,						0,	-1,					gs_frame_mat

	cprism_{2} gs_frame_mat, gs_frame_mat, gs_frame_mat, nsp/5,
		lengthx,
		get(nsp)

	body -1

return


! ------------------------------------------------------------------------------
"Pocket Door Cutting":
! ------------------------------------------------------------------------------

	if bDoubleDoor then
		addz posLeafy + widthWallCut/2
		cutStatus = 2+8+16	! Infinite
	else
		add -A/2+gs_frw1, 0, posLeafy + widthWallCut/2
		cutStatus = 2+16	! Semi Infinite
	endif

	roty 90
	if n = 1 then
		cutform 5, 1, cutStatus,
			 0, 0, -1, 0,
			 widthWallCut/2, 0,			15+16+32,
			 widthWallCut/2, cutHeight,	15+16+32,
			-widthWallCut/2, cutHeight,	15+16+32,
			-widthWallCut/2, 0,			15+16+32,
			 widthWallCut/2, 0,			-1
	else
		addx (i = 2) * FrameThickOffset
		material matLeafRange_Leaf
		cutform 5, 1, cutStatus,
			0, 0, -1, 0,
			widthWallCut/2, 0,			15+16+32,
			widthWallCut/2, cutHeight,	15+16+32,
			0, 				cutHeight,	15+16+32,
			0, 				0,			15+16+32,
			widthWallCut/2, 0,			-1

		material matSashRange_Leaf
		cutform 5, 1, cutStatus,
			 0, 0, -1, 0,
			 0,					0,			15+16+32,
			 0,					cutHeight,	15+16+32,
			-widthWallCut/2,	cutHeight,	15+16+32,
			-widthWallCut/2,	0,			15+16+32,
			 0,					0,			-1
		del 1
	endif
	del 2
return


! ------------------------------------------------------------------------------
"Rectangular Rebate Cutting":
! ------------------------------------------------------------------------------

	if not(bUniformMaterials) | (not(bNoRebate_i) & not(bSimpleOrCHIModel)) then
		bDoubleCut = (bNoRebate_i | bSimpleOrCHIModel)
		if bSimpleOrCHIModel then
			if iMullionStyle_i = MULLION_SOLID_PANEL then
				cutDepth = gs_sash_thk
			else
				cutDepth = (insideFrameThk + gs_glass_thk) / 2
			endif
			rebateWidth = offsetEPS
		else
			if gs_optype_m_i = SASH_FIXED then
				cutDepth = gs_sidelight_rebate_depth + gs_glass_thk / 2
				rebateWidth = offsetEPS
			else
				if bNoRebate_i then
					cutDepth = min(gs_sash_thk, gs_frame_thk / 2)
					rebateWidth = offsetEPS
				else
					cutDepth = gs_sidelight_rebate_depth
					rebateWidth = gs_sidelight_rebate_width
					if rebateWidth < EPS then cutDepth = 0
				endif
			endif
		endif

		if cutDepth > EPS then
			addz -cutDepth
			if iSimpleSashFrameType_i = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_i = SIMPLESASH_SIDEHUNG then
				SashLeftX	= rebateCutShapeLeftPX
				SashRightX	= rebateCutShapeRightPX

				simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
				if iSimpleSashFrameType_i = SIMPLESASH_SLIDEHOR then
					dx = sashWidthToRebateCut/2
				else
					dx = sashWidthToRebateCut
				endif

				material matSashRebate
				cutform 4, 1, 2 + 16,
					0, 0, -1, 0,
					rebateCutShapeRightPX + rebateWidth, rebateCutShapeTopPY + rebateWidth, 15+16+32,
					rebateCutShapeRightPX + rebateWidth, rebateCutShapeBottomPY - rebateWidth, 15+16+32,
					simpleSashDivx+dx, rebateCutShapeBottomPY - rebateWidth, 15+16+32,
					simpleSashDivx+dx, rebateCutShapeTopPY + rebateWidth, 15+16+32

				cutform 4, 1, 2 + 16,
					0, 0, -1, 0,
					simpleSashDivx-dx, rebateCutShapeTopPY + rebateWidth, 15+16+32,
					simpleSashDivx-dx, rebateCutShapeBottomPY - rebateWidth, 15+16+32,
					rebateCutShapeLeftPX - rebateWidth, rebateCutShapeBottomPY - rebateWidth, 15+16+32,
					rebateCutShapeLeftPX - rebateWidth, rebateCutShapeTopPY + rebateWidth, 15+16+32

				if bDoubleCut then
					material matSashOpposite
					cutform 4, 1, 2 + 16,
						0, 0, 1, 0,
						rebateCutShapeRightPX + rebateWidth, rebateCutShapeTopPY + rebateWidth, 15+16+32,
						rebateCutShapeRightPX + rebateWidth, rebateCutShapeBottomPY - rebateWidth, 15+16+32,
						simpleSashDivx+dx, rebateCutShapeBottomPY - rebateWidth, 15+16+32,
						simpleSashDivx+dx, rebateCutShapeTopPY + rebateWidth, 15+16+32

					cutform 4, 1, 2 + 16,
						0, 0, 1, 0,
						simpleSashDivx-dx, rebateCutShapeTopPY + rebateWidth, 15+16+32,
						simpleSashDivx-dx, rebateCutShapeBottomPY - rebateWidth, 15+16+32,
						rebateCutShapeLeftPX - rebateWidth, rebateCutShapeBottomPY - rebateWidth, 15+16+32,
						rebateCutShapeLeftPX - rebateWidth, rebateCutShapeTopPY + rebateWidth, 15+16+32
				endif
				numCuts = numCuts + 2 + 2*bDoubleCut
			else
				if iSimpleSashFrameType_i = SIMPLESASH_SLIDEVER then
					SashTopY	= rebateCutShapeTopPY
					SashBottomY = rebateCutShapeBottomPY

					simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2

					material matSashRebate
					cutform 4, 1, 2 + 16,
						0, 0, -1, 0,
						rebateCutShapeRightPX + rebateWidth, simpleSashDivy - sashWidthToRebateCut/2, 15+16+32,
						rebateCutShapeRightPX + rebateWidth, rebateCutShapeBottomPY - rebateWidth, 15+16+32,
						rebateCutShapeLeftPX - rebateWidth, rebateCutShapeBottomPY - rebateWidth, 15+16+32,
						rebateCutShapeLeftPX - rebateWidth, simpleSashDivy - sashWidthToRebateCut/2, 15+16+32

					cutform 4, 1, 2 + 16,
						0, 0, -1, 0,
						rebateCutShapeRightPX + rebateWidth, rebateCutShapeTopPY + rebateWidth, 15+16+32,
						rebateCutShapeRightPX + rebateWidth, simpleSashDivy + sashWidthToRebateCut/2, 15+16+32,
						rebateCutShapeLeftPX - rebateWidth, simpleSashDivy + sashWidthToRebateCut/2, 15+16+32,
						rebateCutShapeLeftPX - rebateWidth, rebateCutShapeTopPY + rebateWidth, 15+16+32

					if bDoubleCut then
						material matSashOpposite
						cutform 4, 1, 2 + 16,
							0, 0, 1, 0,
							rebateCutShapeRightPX + rebateWidth, simpleSashDivy - sashWidthToRebateCut/2, 15+16+32,
							rebateCutShapeRightPX + rebateWidth, rebateCutShapeBottomPY - rebateWidth, 15+16+32,
							rebateCutShapeLeftPX - rebateWidth, rebateCutShapeBottomPY - rebateWidth, 15+16+32,
							rebateCutShapeLeftPX - rebateWidth, simpleSashDivy - sashWidthToRebateCut/2, 15+16+32

						cutform 4, 1, 2 + 16,
							0, 0, 1, 0,
							rebateCutShapeRightPX + rebateWidth, rebateCutShapeTopPY + rebateWidth, 15+16+32,
							rebateCutShapeRightPX + rebateWidth, simpleSashDivy + sashWidthToRebateCut/2, 15+16+32,
							rebateCutShapeLeftPX - rebateWidth, simpleSashDivy + sashWidthToRebateCut/2, 15+16+32,
							rebateCutShapeLeftPX - rebateWidth, rebateCutShapeTopPY + rebateWidth, 15+16+32
					endif
					numCuts = numCuts + 2 + 2*bDoubleCut
				else
					material matSashRebate
					cutform 4, 1, 2 + 16,
						0, 0, -1, 0,
						rebateCutShapeRightPX + rebateWidth, rebateCutShapeTopPY + rebateWidth, 15+16+32,
						rebateCutShapeRightPX + rebateWidth, rebateCutShapeBottomPY - rebateWidth, 15+16+32,
						rebateCutShapeLeftPX - rebateWidth, rebateCutShapeBottomPY - rebateWidth, 15+16+32,
						rebateCutShapeLeftPX - rebateWidth, rebateCutShapeTopPY + rebateWidth, 15+16+32
					if bDoubleCut then
						material matSashOpposite
						cutform 4, 1, 2 + 16,
							0, 0, 1, 0,
							rebateCutShapeRightPX + rebateWidth, rebateCutShapeTopPY + rebateWidth, 15+16+32,
							rebateCutShapeRightPX + rebateWidth, rebateCutShapeBottomPY - rebateWidth, 15+16+32,
							rebateCutShapeLeftPX - rebateWidth, rebateCutShapeBottomPY - rebateWidth, 15+16+32,
							rebateCutShapeLeftPX - rebateWidth, rebateCutShapeTopPY + rebateWidth, 15+16+32
					endif
					numCuts = numCuts + 1 + bDoubleCut
				endif
			endif
			del 1
		endif
	endif
return


! ------------------------------------------------------------------------------
"Extra Frame to Simple Sash":
! ------------------------------------------------------------------------------

	if iSimpleSashFrameType_i = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_i = SIMPLESASH_SIDEHUNG then
		simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2

		simpleSashZ	= SashBottomY
		if iSimpleSashFrameType_i = SIMPLESASH_SLIDEHOR then
			put simpleSashDivx - sashWidth/2 - offsetEPS, simpleSashZ, 0, 10,		matSash,
				simpleSashDivx + sashWidth/2 + offsetEPS, simpleSashZ, 0, mask1,	matSash
		else
			put simpleSashDivx - sashWidth - offsetEPS, simpleSashZ, 0, 10,		matSash,
				simpleSashDivx + sashWidth + offsetEPS, simpleSashZ, 0, mask1,	matSash
		endif

		simpleSashZ	= SashTopY
		if iSimpleSashFrameType_i = SIMPLESASH_SLIDEHOR then
			put simpleSashDivx + sashWidth/2 + offsetEPS, simpleSashZ, 0, 10,		matSash,
				simpleSashDivx - sashWidth/2 - offsetEPS, simpleSashZ, 0, mask1,	matSash
		else
			put simpleSashDivx + sashWidth + offsetEPS, simpleSashZ, 0, 10,		matSash,
				simpleSashDivx - sashWidth - offsetEPS, simpleSashZ, 0, mask1,	matSash
		endif

		cprism_{2} mat1, botmat, matSash,
			nsp/5, framethick2,
			get(nsp)

		gosub 500
	endif

	if iSimpleSashFrameType_i = SIMPLESASH_SLIDEVER then
		simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2

		simpleSashX	= SashLeftX
		put simpleSashX, simpleSashDivy + sashWidth/2 + offsetEPS, 0, 10,		matSash,
			simpleSashX, simpleSashDivy - sashWidth/2 - offsetEPS, 0, mask1,	matSash

		simpleSashX	= SashRightX
		put simpleSashX, simpleSashDivy - sashWidth/2 - offsetEPS, 0, 10,		matSash,
			simpleSashX, simpleSashDivy + sashWidth/2 + offsetEPS, 0, mask1,	matSash

		cprism_{2} mat1, botmat, matSash,
			nsp/5, framethick2,
			get(nsp)

		gosub 600
	endif
return

! ------------------------------------------------------------------------------
"Metal Frame Rebate":
! ------------------------------------------------------------------------------
	edgeStatus = 0
	if gs_sidelight_left then
		cutDyBottomLeft = LeftSLParapet + gs_tolerance_low_left_sl - ovhgBottomLeft
	else
		cutDyBottomLeft = -ovhgBottom
	endif
	if gs_sidelight_right then
		cutDyBottomRight = RightSLParapet + gs_tolerance_low_right_sl - ovhgBottomRight
	else
		cutDyBottomRight = -ovhgBottom
	endif

	addz frameRebateOffset
	if bArchedTop then
		if abs(cutDxRight) < EPS  then
			cutform 4, 1, 2,
				 0, 0, 1, outsideFrameThk - 2*frameRebateOffset,
				-A/2,						gs_shoulder_h,		31,
				-A/2 + frameRebateWidth,	gs_shoulder_h,		31,
				-A/2 + frameRebateWidth,	cutDyBottomLeft,	31,
				-A/2,						cutDyBottomLeft,	31

			numCuts = numCuts + 1

			cutform 4, 1, 2,
				 0, 0, 1, outsideFrameThk - 2*frameRebateOffset,
				 A/2,						gs_shoulder_h,		31,
				 A/2 - frameRebateWidth,	gs_shoulder_h,		31,
				 A/2 - frameRebateWidth,	cutDyBottomRight,	31,
				 A/2,						cutDyBottomRight,	31

			numCuts = numCuts + 1

			cutform 7, 1, 2,
				 0, 0, 1, outsideFrameThk - 2*frameRebateOffset,
				-A/2,						gs_shoulder_h,							31,
				0,							frametop - r2,							900,
				0,							b + cutDy,								3031,
				A/2,						gs_shoulder_h,							3031,
				A/2 - frameRebateWidth,		gs_shoulder_h - (fce-fce_frame_rebate),	31+64,
				0,							B - frameRebateWidth,					3031+64,
				-A/2 + frameRebateWidth,	gs_shoulder_h-(fce-fce_frame_rebate),	3031

			numCuts = numCuts + 1
		else
			plane_ 4,
				-A/2 + frameRebateWidth, gs_shoulder_h-(fce-fce_frame_rebate),												0,							edgeStatus,
				-A/2 + frameRebateWidth, cutDyBottomLeft + frameRebateWidth*(gs_sidelight_left & (LeftSLParapet > EPS)),	0,							edgeStatus,
				-A/2 + frameRebateWidth, cutDyBottomLeft + frameRebateWidth*(gs_sidelight_left & (LeftSLParapet > EPS)),	outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				-A/2 + frameRebateWidth, gs_shoulder_h-(fce-fce_frame_rebate),												outsideFrameThk - 2*frameRebateOffset,	edgeStatus

			plane_ 4,
				-A/2 + frameRebateWidth,	gs_shoulder_h-(fce-fce_frame_rebate),											0,	edgeStatus,
				-A/2 + frameRebateWidth,	cutDyBottomLeft + frameRebateWidth*(gs_sidelight_left & (LeftSLParapet > EPS)),	0,	edgeStatus,
				-A/2,						cutDyBottomLeft,																0,	edgeStatus,
				-A/2,						gs_shoulder_h-(fce-fce_frame_toler),											0,	edgeStatus

			plane_ 4,
				-A/2,	gs_shoulder_h-(fce-fce_frame_toler),		0,					edgeStatus,
				-A/2,	cutDyBottomLeft,							0,					edgeStatus,
				-A/2,	cutDyBottomLeft,							-frameRebateOffset,	edgeStatus,
				-A/2,	gs_shoulder_h-(fce-fce_frame_toler),		-frameRebateOffset,	edgeStatus

			plane_ 4,
				-A/2 + frameRebateWidth,	gs_shoulder_h-(fce-fce_frame_rebate),											outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				-A/2 + frameRebateWidth,	cutDyBottomLeft + frameRebateWidth*(gs_sidelight_left & (LeftSLParapet > EPS)),	outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				-A/2,						cutDyBottomLeft,																outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				-A/2,						gs_shoulder_h-(fce-fce_frame_toler),											outsideFrameThk - 2*frameRebateOffset,	edgeStatus

			plane_ 4,
				-A/2,	gs_shoulder_h-(fce-fce_frame_toler),	outsideFrameThk - frameRebateOffset,	edgeStatus,
				-A/2,	cutDyBottomLeft,						outsideFrameThk - frameRebateOffset,	edgeStatus,
				-A/2,	cutDyBottomLeft,						outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				-A/2,	gs_shoulder_h-(fce-fce_frame_toler),	outsideFrameThk - 2*frameRebateOffset,	edgeStatus


			plane_ 4,
				A/2 - frameRebateWidth, gs_shoulder_h-(fce-fce_frame_rebate),												0,							edgeStatus,
				A/2 - frameRebateWidth, cutDyBottomRight + frameRebateWidth*(gs_sidelight_right & (RightSLParapet > EPS)),	0,							edgeStatus,
				A/2 - frameRebateWidth, cutDyBottomRight + frameRebateWidth*(gs_sidelight_right & (RightSLParapet > EPS)),	outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				A/2 - frameRebateWidth, gs_shoulder_h-(fce-fce_frame_rebate),												outsideFrameThk - 2*frameRebateOffset,	edgeStatus

			plane_ 4,
				A/2 - frameRebateWidth,	gs_shoulder_h-(fce-fce_frame_rebate),												0,	edgeStatus,
				A/2 - frameRebateWidth,	cutDyBottomRight + frameRebateWidth*(gs_sidelight_right & (RightSLParapet > EPS)),	0,	edgeStatus,
				A/2,					cutDyBottomRight,																	0,	edgeStatus,
				A/2,					gs_shoulder_h-(fce-fce_frame_toler),												0,	edgeStatus

			plane_ 4,
				A/2,	gs_shoulder_h-(fce-fce_frame_toler),	0,					edgeStatus,
				A/2,	cutDyBottomRight,						0,					edgeStatus,
				A/2,	cutDyBottomRight,						-frameRebateOffset,	edgeStatus,
				A/2,	gs_shoulder_h-(fce-fce_frame_toler),	-frameRebateOffset,	edgeStatus

			plane_ 4,
				A/2 - frameRebateWidth,	gs_shoulder_h-(fce-fce_frame_rebate),												outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				A/2 - frameRebateWidth,	cutDyBottomRight + frameRebateWidth*(gs_sidelight_right & (RightSLParapet > EPS)),	outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				A/2,					cutDyBottomRight,																	outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				A/2,					gs_shoulder_h-(fce-fce_frame_toler),												outsideFrameThk - 2*frameRebateOffset,	edgeStatus

			plane_ 4,
				A/2,	gs_shoulder_h-(fce-fce_frame_toler),	outsideFrameThk - frameRebateOffset,	edgeStatus,
				A/2,	cutDyBottomRight,						outsideFrameThk - frameRebateOffset,	edgeStatus,
				A/2,	cutDyBottomRight,						outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				A/2,	gs_shoulder_h-(fce-fce_frame_toler),	outsideFrameThk - 2*frameRebateOffset,	edgeStatus


			extrude 4, 0, 0, outsideFrameThk - 2*frameRebateOffset, (16+32)*edgeStatus,
				0,							frametop - r2,							900,
				A/2 - frameRebateWidth,		gs_shoulder_h - (fce-fce_frame_rebate),	1,
				0,							B - frameRebateWidth,					3001,
				-A/2 + frameRebateWidth,	gs_shoulder_h - (fce-fce_frame_rebate),	3001

			extrude 4, 0, 0, -frameRebateOffset, (16+32)*edgeStatus,
				0,		frametop - r2,							900,
				A/2,	gs_shoulder_h - (fce-fce_frame_toler),	1,
				0,		B ,										3001,
				-A/2,	gs_shoulder_h - (fce-fce_frame_toler),	3001

			poly_ 7,
				-A/2,						gs_shoulder_h - (fce-fce_frame_toler),	edgeStatus,
				0,							frametop - r2,							900,
				0,							b + cutDy,								3000 + edgeStatus,
				A/2,						gs_shoulder_h - (fce-fce_frame_toler),	3000 + edgeStatus,
				A/2 - frameRebateWidth,		gs_shoulder_h - (fce-fce_frame_rebate),	edgeStatus,
				0,							B - frameRebateWidth,					3000 + edgeStatus,
				-A/2 + frameRebateWidth,	gs_shoulder_h - (fce-fce_frame_rebate),	3000 + edgeStatus

			addz outsideFrameThk - 2*frameRebateOffset
			extrude 4, 0, 0, frameRebateOffset, (16+32)*edgeStatus,
				0,		frametop - r2,							900,
				A/2,	gs_shoulder_h - (fce-fce_frame_toler),	1,
				0,		B,										3001,
				-A/2,	gs_shoulder_h - (fce-fce_frame_toler),	3001

			poly_ 7,
				-A/2,						gs_shoulder_h - (fce-fce_frame_toler),	edgeStatus,
				0,							frametop - r2,							900,
				0,							b + cutDy,								3000 + edgeStatus,
				A/2,						gs_shoulder_h - (fce-fce_frame_toler),	3000 + edgeStatus,
				A/2 - frameRebateWidth,		gs_shoulder_h - (fce-fce_frame_rebate),	edgeStatus,
				0,							B - frameRebateWidth,					3000 + edgeStatus,
				-A/2 + frameRebateWidth,	gs_shoulder_h - (fce-fce_frame_rebate),	3000 + edgeStatus
			del 1
		endif
	else
		if abs(cutDxLeft) < EPS then
			cutform 4, 1, 2,
				 0, 0, 1, outsideFrameThk - 2*frameRebateOffset,
				-A/2,						B + cutDy,			31,
				-A/2 + frameRebateWidth,	B + cutDy,			31,
				-A/2 + frameRebateWidth,	cutDyBottomLeft,	31,
				-A/2,						cutDyBottomLeft,	31

			numCuts = numCuts + 1
		else
			plane_ 4,
				-A/2 + frameRebateWidth, B - frameRebateWidth,																0,							edgeStatus,
				-A/2 + frameRebateWidth, cutDyBottomLeft + frameRebateWidth*(gs_sidelight_left & (LeftSLParapet > EPS)),	0,							edgeStatus,
				-A/2 + frameRebateWidth, cutDyBottomLeft + frameRebateWidth*(gs_sidelight_left & (LeftSLParapet > EPS)),	outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				-A/2 + frameRebateWidth, B - frameRebateWidth,																outsideFrameThk - 2*frameRebateOffset,	edgeStatus

			plane_ 4,
				-A/2 + frameRebateWidth,	B - frameRebateWidth,															0,	edgeStatus,
				-A/2 + frameRebateWidth,	cutDyBottomLeft + frameRebateWidth*(gs_sidelight_left & (LeftSLParapet > EPS)),	0,	edgeStatus,
				-A/2,						cutDyBottomLeft,																0,	edgeStatus,
				-A/2,						B,																				0,	edgeStatus

			plane_ 4,
				-A/2,	B,					0,					edgeStatus,
				-A/2,	cutDyBottomLeft,	0,					edgeStatus,
				-A/2,	cutDyBottomLeft,	-frameRebateOffset,	edgeStatus,
				-A/2,	B,					-frameRebateOffset,	edgeStatus

			plane_ 4,
				-A/2 + frameRebateWidth,	B - frameRebateWidth,															outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				-A/2 + frameRebateWidth,	cutDyBottomLeft + frameRebateWidth*(gs_sidelight_left & (LeftSLParapet > EPS)),	outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				-A/2,						cutDyBottomLeft,																outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				-A/2,						B,																				outsideFrameThk - 2*frameRebateOffset,	edgeStatus

			plane_ 4,
				-A/2,	B,					outsideFrameThk - frameRebateOffset,	edgeStatus,
				-A/2,	cutDyBottomLeft,	outsideFrameThk - frameRebateOffset,	edgeStatus,
				-A/2,	cutDyBottomLeft,	outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				-A/2,	B,					outsideFrameThk - 2*frameRebateOffset,	edgeStatus
		endif

		if abs(cutDxRight) < EPS  then
			cutform 4, 1, 2,
				 0, 0, 1, outsideFrameThk - 2*frameRebateOffset,
				 A/2,						B + cutDy,			31,
				 A/2 - frameRebateWidth,	B + cutDy,			31,
				 A/2 - frameRebateWidth,	cutDyBottomRight,	31,
				 A/2,						cutDyBottomRight,	31

			numCuts = numCuts + 1
		else
			plane_ 4,
				A/2 - frameRebateWidth, B - frameRebateWidth,																0,							edgeStatus,
				A/2 - frameRebateWidth, cutDyBottomRight + frameRebateWidth*(gs_sidelight_right & (RightSLParapet > EPS)),	0,							edgeStatus,
				A/2 - frameRebateWidth, cutDyBottomRight + frameRebateWidth*(gs_sidelight_right & (RightSLParapet > EPS)),	outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				A/2 - frameRebateWidth, B - frameRebateWidth,																outsideFrameThk - 2*frameRebateOffset,	edgeStatus

			plane_ 4,
				A/2 - frameRebateWidth,	B - frameRebateWidth,																0,	edgeStatus,
				A/2 - frameRebateWidth,	cutDyBottomRight + frameRebateWidth*(gs_sidelight_right & (RightSLParapet > EPS)),	0,	edgeStatus,
				A/2,					cutDyBottomRight,																	0,	edgeStatus,
				A/2,					B,																					0,	edgeStatus

			plane_ 4,
				A/2,	B,					0,					edgeStatus,
				A/2,	cutDyBottomRight,	0,					edgeStatus,
				A/2,	cutDyBottomRight,	-frameRebateOffset,	edgeStatus,
				A/2,	B,					-frameRebateOffset,	edgeStatus

			plane_ 4,
				A/2 - frameRebateWidth,	B - frameRebateWidth,																outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				A/2 - frameRebateWidth,	cutDyBottomRight + frameRebateWidth*(gs_sidelight_right & (RightSLParapet > EPS)),	outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				A/2,					cutDyBottomRight,																	outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				A/2,					B,																					outsideFrameThk - 2*frameRebateOffset,	edgeStatus

			plane_ 4,
				A/2,	B,					outsideFrameThk - frameRebateOffset,	edgeStatus,
				A/2,	cutDyBottomRight,	outsideFrameThk - frameRebateOffset,	edgeStatus,
				A/2,	cutDyBottomRight,	outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				A/2,	B,					outsideFrameThk - 2*frameRebateOffset,	edgeStatus
		endif

		if abs(cutDy) < EPS then
			cutform 4, 1, 2,
				 0, 0, 1, outsideFrameThk - 2*frameRebateOffset,
				-A/2 - cutDxLeft,	B,						31,
				 A/2 + cutDxRight,	B,						31,
				 A/2 + cutDxRight,	B - frameRebateWidth,	31,
				-A/2 - cutDxLeft,	B - frameRebateWidth,	31

			numCuts = numCuts + 1
		else
			plane_ 4,
				-A/2 + frameRebateWidth, B - frameRebateWidth, 0,										edgeStatus,
				 A/2 - frameRebateWidth, B - frameRebateWidth, 0,										edgeStatus,
				 A/2 - frameRebateWidth, B - frameRebateWidth, outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				-A/2 + frameRebateWidth, B - frameRebateWidth, outsideFrameThk - 2*frameRebateOffset,	edgeStatus

			plane_ 4,
				-A/2,						B, 						0,	edgeStatus,
				 A/2,						B, 						0,	edgeStatus,
				 A/2 - frameRebateWidth,	B - frameRebateWidth,	0,	edgeStatus,
				-A/2 + frameRebateWidth,	B - frameRebateWidth,	0,	edgeStatus

			plane_ 4,
				-A/2,	B,	0,					edgeStatus,
				 A/2,	B,	0,					edgeStatus,
				 A/2,	B,	-frameRebateOffset,	edgeStatus,
				-A/2,	B,	-frameRebateOffset,	edgeStatus

			plane_ 4,
				-A/2,						B, 						outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				 A/2,						B, 						outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				 A/2 - frameRebateWidth,	B - frameRebateWidth,	outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				-A/2 + frameRebateWidth,	B - frameRebateWidth,	outsideFrameThk - 2*frameRebateOffset,	edgeStatus

			plane_ 4,
				-A/2,	B, 	outsideFrameThk - frameRebateOffset,	edgeStatus,
				 A/2,	B, 	outsideFrameThk - frameRebateOffset,	edgeStatus,
				 A/2,	B,	outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				-A/2,	B,	outsideFrameThk - 2*frameRebateOffset,	edgeStatus
		endif
	endif

	if gs_sidelight_left then
		if (LeftSLParapet > EPS) | gs_frame_style_m = FRAME_STYLE_EXTRUSION then
			if abs(gs_tolerance_low_left_sl + ovhgBottomLeft) < EPS then
				cutform 4, 1, 2,
					 0, 0, 1, insideFrameThk - 2*frameRebateOffset,
					-A/2 - cutDxLeft,																									LeftSLParapet,			31,
					-A/2 + gs_sl_w1 - (gs_frw_SlParapet_left + gs_tolerance_left_2) + frameRebateWidth*(abs(gs_tolerance_left_2) < EPS),	LeftSLParapet,			31,
					-A/2 + gs_sl_w1 - (gs_frw_SlParapet_left + gs_tolerance_left_2) + frameRebateWidth*(abs(gs_tolerance_left_2) < EPS),	LeftSLParapet + frameRebateWidth,	31,
					-A/2 - cutDxLeft,																									LeftSLParapet + frameRebateWidth,	31

				numCuts = numCuts + 1
			else
				plane_ 4,
					-A/2 + frameRebateWidth,									LeftSLParapet + gs_tolerance_low_left_sl + frameRebateWidth,	0,						edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left + frameRebateWidth,	LeftSLParapet + gs_tolerance_low_left_sl + frameRebateWidth,	0,						edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left + frameRebateWidth,	LeftSLParapet + gs_tolerance_low_left_sl + frameRebateWidth,	insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					-A/2 + frameRebateWidth,									LeftSLParapet + gs_tolerance_low_left_sl + frameRebateWidth,	insideFrameThk - 2*frameRebateOffset,	edgeStatus

				plane_ 4,
					-A/2 + frameRebateWidth,									LeftSLParapet + gs_tolerance_low_left_sl + frameRebateWidth,	0,	edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left + frameRebateWidth,	LeftSLParapet + gs_tolerance_low_left_sl + frameRebateWidth,	0,	edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left,					LeftSLParapet + gs_tolerance_low_left_sl,					0,	edgeStatus,
					-A/2,														LeftSLParapet + gs_tolerance_low_left_sl,					0,	edgeStatus

				plane_ 4,
					-A/2,										LeftSLParapet + gs_tolerance_low_left_sl,	0,					edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left,	LeftSLParapet + gs_tolerance_low_left_sl,	0,					edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left,	LeftSLParapet + gs_tolerance_low_left_sl,	-frameRebateOffset,	edgeStatus,
					-A/2,										LeftSLParapet + gs_tolerance_low_left_sl,	-frameRebateOffset,	edgeStatus

				plane_ 4,
					-A/2 + frameRebateWidth,									LeftSLParapet + gs_tolerance_low_left_sl + frameRebateWidth,	insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left + frameRebateWidth,	LeftSLParapet + gs_tolerance_low_left_sl + frameRebateWidth,	insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left,					LeftSLParapet + gs_tolerance_low_left_sl,					insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					-A/2,														LeftSLParapet + gs_tolerance_low_left_sl,					insideFrameThk - 2*frameRebateOffset,	edgeStatus

				plane_ 4,
					-A/2,										LeftSLParapet + gs_tolerance_low_left_sl,	insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left,	LeftSLParapet + gs_tolerance_low_left_sl,	insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left,	LeftSLParapet + gs_tolerance_low_left_sl,	insideFrameThk - frameRebateOffset,		edgeStatus,
					-A/2,										LeftSLParapet + gs_tolerance_low_left_sl,	insideFrameThk - frameRebateOffset,		edgeStatus
			endif
		endif

		if (LeftSLParapet > EPS) then
			if abs(gs_tolerance_left_2) < EPS then
				cutform 4, 1, 2,
					 0, 0, 1, insideFrameThk - 2*frameRebateOffset,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left,					LeftSLParapet - ovhgBottomLeft,	31,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left + frameRebateWidth,	LeftSLParapet - ovhgBottomLeft,	31,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left + frameRebateWidth,	-ovhgBottom,					31,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left,					-ovhgBottom,					31

				numCuts = numCuts + 1
			else
				plane_ 4,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left + frameRebateWidth,	-ovhgBottom,												0,						edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left + frameRebateWidth,	LeftSLParapet + gs_tolerance_low_left_sl + frameRebateWidth,	0,						edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left + frameRebateWidth,	LeftSLParapet + gs_tolerance_low_left_sl + frameRebateWidth,	insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left + frameRebateWidth,	-ovhgBottom,												insideFrameThk - 2*frameRebateOffset,	edgeStatus

				plane_ 4,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left,					-ovhgBottom,												0,	edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left,					LeftSLParapet + gs_tolerance_low_left_sl,					0,	edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left + frameRebateWidth,	LeftSLParapet + gs_tolerance_low_left_sl + frameRebateWidth,	0,	edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left + frameRebateWidth,	-ovhgBottom,												0,	edgeStatus

				plane_ 4,
					-A/2 + gs_sl_w1 - gs_frw_SlParapetSl_left,	-ovhgBottom,								0,					edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left,	LeftSLParapet + gs_tolerance_low_left_sl,	0,					edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left,	LeftSLParapet + gs_tolerance_low_left_sl,	-frameRebateOffset,	edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left,	-ovhgBottom,								-frameRebateOffset,	edgeStatus

				plane_ 4,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left,					-ovhgBottom,												insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left,					LeftSLParapet + gs_tolerance_low_left_sl,					insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left + frameRebateWidth,	LeftSLParapet + gs_tolerance_low_left_sl + frameRebateWidth,	insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left + frameRebateWidth,	-ovhgBottom,												insideFrameThk - 2*frameRebateOffset,	edgeStatus

				plane_ 4,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left,	-ovhgBottom,								insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left,	LeftSLParapet + gs_tolerance_low_left_sl,	insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left,	LeftSLParapet + gs_tolerance_low_left_sl,	insideFrameThk - frameRebateOffset,		edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left,	-ovhgBottom,								insideFrameThk - frameRebateOffset,		edgeStatus
			endif
		endif
	endif

	if gs_sidelight_right then
		if (RightSLParapet > EPS) | gs_frame_style_m = FRAME_STYLE_EXTRUSION then
			if abs(gs_tolerance_low_right_sl + ovhgBottomRight) < EPS then
				cutform 4, 1, 2,
					 0, 0, 1, insideFrameThk - 2*frameRebateOffset,
					 A/2 + cutDxRight,																										RightSLParapet,			31,
					 A/2 - gs_sl_w2 + (gs_frw_SlParapet_right + gs_tolerance_right_2) - frameRebateWidth*(abs(gs_tolerance_right_2) < EPS),	RightSLParapet,			31,
					 A/2 - gs_sl_w2 + (gs_frw_SlParapet_right + gs_tolerance_right_2) - frameRebateWidth*(abs(gs_tolerance_right_2) < EPS),	RightSLParapet + frameRebateWidth,	31,
					 A/2 + cutDxRight,																										RightSLParapet + frameRebateWidth,	31

				numCuts = numCuts + 1
			else
				plane_ 4,
					A/2 - frameRebateWidth,										RightSLParapet + gs_tolerance_low_right_sl + frameRebateWidth,	0,						edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right - frameRebateWidth,	RightSLParapet + gs_tolerance_low_right_sl + frameRebateWidth,	0,						edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right - frameRebateWidth,	RightSLParapet + gs_tolerance_low_right_sl + frameRebateWidth,	insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					A/2 - frameRebateWidth,										RightSLParapet + gs_tolerance_low_right_sl + frameRebateWidth,	insideFrameThk - 2*frameRebateOffset,	edgeStatus

				plane_ 4,
					A/2 - frameRebateWidth,										RightSLParapet + gs_tolerance_low_right_sl + frameRebateWidth,	0,	edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right - frameRebateWidth,	RightSLParapet + gs_tolerance_low_right_sl + frameRebateWidth,	0,	edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right,					RightSLParapet + gs_tolerance_low_right_sl,					0,	edgeStatus,
					A/2,														RightSLParapet + gs_tolerance_low_right_sl,					0,	edgeStatus

				plane_ 4,
					A/2,										RightSLParapet + gs_tolerance_low_right_sl,	0,					edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right,	RightSLParapet + gs_tolerance_low_right_sl,	0,					edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right,	RightSLParapet + gs_tolerance_low_right_sl,	-frameRebateOffset,	edgeStatus,
					A/2,										RightSLParapet + gs_tolerance_low_right_sl,	-frameRebateOffset,	edgeStatus

				plane_ 4,
					A/2 - frameRebateWidth,										RightSLParapet + gs_tolerance_low_right_sl + frameRebateWidth,	insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right - frameRebateWidth,	RightSLParapet + gs_tolerance_low_right_sl + frameRebateWidth,	insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right,					RightSLParapet + gs_tolerance_low_right_sl,					insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					A/2,														RightSLParapet + gs_tolerance_low_right_sl,					insideFrameThk - 2*frameRebateOffset,	edgeStatus

				plane_ 4,
					A/2,										RightSLParapet + gs_tolerance_low_right_sl,	insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right,	RightSLParapet + gs_tolerance_low_right_sl,	insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right,	RightSLParapet + gs_tolerance_low_right_sl,	insideFrameThk - frameRebateOffset,		edgeStatus,
					A/2,										RightSLParapet + gs_tolerance_low_right_sl,	insideFrameThk - frameRebateOffset,		edgeStatus
			endif
		endif

		if (RightSLParapet > EPS) then
			if abs(gs_tolerance_right_2) < EPS then
				cutform 4, 1, 2,
					 0, 0, 1, insideFrameThk - 2*frameRebateOffset,
					 A/2 - gs_sl_w2 + gs_frw_SlParapet_right,						RightSLParapet - ovhgBottomRight,	31,
					 A/2 - gs_sl_w2 + gs_frw_SlParapet_right - frameRebateWidth,	RightSLParapet - ovhgBottomRight,	31,
					 A/2 - gs_sl_w2 + gs_frw_SlParapet_right - frameRebateWidth,	-ovhgBottom,						31,
					 A/2 - gs_sl_w2 + gs_frw_SlParapet_right,						-ovhgBottom,						31

				numCuts = numCuts + 1
			else
				plane_ 4,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right - frameRebateWidth,	-ovhgBottom,												0,						edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right - frameRebateWidth,	RightSLParapet + gs_tolerance_low_right_sl + frameRebateWidth,	0,						edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right - frameRebateWidth,	RightSLParapet + gs_tolerance_low_right_sl + frameRebateWidth,	insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right - frameRebateWidth,	-ovhgBottom,												insideFrameThk - 2*frameRebateOffset,	edgeStatus

				plane_ 4,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right,						-ovhgBottom,												0,	edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right,						RightSLParapet + gs_tolerance_low_right_sl,					0,	edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_left - frameRebateWidth,		RightSLParapet + gs_tolerance_low_right_sl + frameRebateWidth,	0,	edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_left - frameRebateWidth,		-ovhgBottom,												0,	edgeStatus

				plane_ 4,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right,	-ovhgBottom,								0,					edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right,	RightSLParapet + gs_tolerance_low_left_sl,	0,					edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right,	RightSLParapet + gs_tolerance_low_left_sl,	-frameRebateOffset,	edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right,	-ovhgBottom,								-frameRebateOffset,	edgeStatus

				plane_ 4,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right,					-ovhgBottom,												insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right,					RightSLParapet + gs_tolerance_low_right_sl,					insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right - frameRebateWidth,	RightSLParapet + gs_tolerance_low_right_sl + frameRebateWidth,	insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right - frameRebateWidth,	-ovhgBottom,												insideFrameThk - 2*frameRebateOffset,	edgeStatus

				plane_ 4,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right,	-ovhgBottom,								insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right,	RightSLParapet + gs_tolerance_low_right_sl,	insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right,	RightSLParapet + gs_tolerance_low_right_sl,	insideFrameThk - frameRebateOffset,		edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right,	-ovhgBottom,								insideFrameThk - frameRebateOffset,		edgeStatus
			endif
		endif
	endif
	del 1
return
