success = LIBRARYGLOBAL ("Libraryflobals-mep", "show_axis", show_axis)success = LIBRARYGLOBAL ("Libraryflobals-mep", "show_axis_and", show_axis_and)success = LIBRARYGLOBAL ("Libraryflobals-mep", "show_isol", show_isol)success = LIBRARYGLOBAL ("Libraryflobals-mep", "show_conventions", show_conventions)success = LIBRARYGLOBAL ("Libraryflobals-mep", "show_size", show_size)success = LIBRARYGLOBAL ("Libraryflobals-mep", "gs_detlevel_3D_m", gs_detlevel_3D_m)success = LIBRARYGLOBAL ("Libraryflobals-mep", "gs_detlevel_2D_m",gs_detlevel_2D_m)HptsUnIDBeginForConnEnds = 30000IF (DrawingNum = 5 OR DrawingNum = 6) AND SYMB_MIRRORED THEN MUL2 -1,1PEN gs_cont_penDIM ConEdit[18]	ConEdit[1] = ConEdit_1	ConEdit[2] = ConEdit_2	ConEdit[3] = ConEdit_3	ConEdit[4] = ConEdit_4	ConEdit[5] = ConEdit_5	ConEdit[6] = ConEdit_6	ConEdit[7] = ConEdit_7	ConEdit[8] = ConEdit_8	ConEdit[9] = ConEdit_9	ConEdit[10] = ConEdit_10	ConEdit[11] = ConEdit_11	ConEdit[12] = ConEdit_12	ConEdit[13] = ConEdit_13	ConEdit[14] = ConEdit_14	ConEdit[15] = ConEdit_15	ConEdit[16] = ConEdit_16	ConEdit[17] = ConEdit_17	ConEdit[18] = ConEdit_18DIM ConShowin2D[18]	ConShowin2D[1] = ConShow_1	ConShowin2D[2] = ConShow_2	ConShowin2D[3] = ConShow_3	ConShowin2D[4] = ConShow_4	ConShowin2D[5] = ConShow_5	ConShowin2D[6] = ConShow_6	ConShowin2D[7] = ConShow_7	ConShowin2D[8] = ConShow_8	ConShowin2D[9] = ConShow_9	ConShowin2D[10] = ConShow_10	ConShowin2D[11] = ConShow_11	ConShowin2D[12] = ConShow_12	ConShowin2D[13] = ConShow_13	ConShowin2D[14] = ConShow_14	ConShowin2D[15] = ConShow_15	ConShowin2D[16] = ConShow_16	ConShowin2D[17] = ConShow_17	ConShowin2D[18] = ConShow_18DIM ConHotspotShowin2D[18]	ConHotspotShowin2D[1] = ConHotspotShow_1	ConHotspotShowin2D[2] = ConHotspotShow_2	ConHotspotShowin2D[3] = ConHotspotShow_3	ConHotspotShowin2D[4] = ConHotspotShow_4	ConHotspotShowin2D[5] = ConHotspotShow_5	ConHotspotShowin2D[6] = ConHotspotShow_6	ConHotspotShowin2D[7] = ConHotspotShow_7	ConHotspotShowin2D[8] = ConHotspotShow_8	ConHotspotShowin2D[9] = ConHotspotShow_9	ConHotspotShowin2D[10] = ConHotspotShow_10	ConHotspotShowin2D[11] = ConHotspotShow_11	ConHotspotShowin2D[12] = ConHotspotShow_12	ConHotspotShowin2D[13] = ConHotspotShow_13	ConHotspotShowin2D[14] = ConHotspotShow_14	ConHotspotShowin2D[15] = ConHotspotShow_15	ConHotspotShowin2D[16] = ConHotspotShow_16	ConHotspotShowin2D[17] = ConHotspotShow_17	ConHotspotShowin2D[18] = ConHotspotShow_18FOR j = 1 TO MEP_NumberConnections	IF MEP_NumConnectionData[j][22] THEN		gosub "set_pen"		PEN gs_cont_pen		IF NOT(SetProgram) THEN			IF j = 1 THEN				ConPosX = ConPosX_1				ConPosY = ConPosY_1				ConPosZ = ConPosZ_1			ENDIF			IF j = 2 THEN				ConPosX = ConPosX_2				ConPosY = ConPosY_2				ConPosZ = ConPosZ_2			ENDIF			IF j = 3 THEN				ConPosX = ConPosX_3				ConPosY = ConPosY_3				ConPosZ = ConPosZ_3			ENDIF			IF j = 4 THEN				ConPosX = ConPosX_4				ConPosY = ConPosY_4				ConPosZ = ConPosZ_4			ENDIF			IF j = 5 THEN				ConPosX = ConPosX_5				ConPosY = ConPosY_5				ConPosZ = ConPosZ_5			ENDIF			IF j = 6 THEN				ConPosX = ConPosX_6				ConPosY = ConPosY_6				ConPosZ = ConPosZ_6			ENDIF			IF j = 7 THEN				ConPosX = ConPosX_7				ConPosY = ConPosY_7				ConPosZ = ConPosZ_7			ENDIF			IF j = 8 THEN				ConPosX = ConPosX_8				ConPosY = ConPosY_8				ConPosZ = ConPosZ_8			ENDIF			IF j = 9 THEN				ConPosX = ConPosX_9				ConPosY = ConPosY_9				ConPosZ = ConPosZ_9			ENDIF			IF j = 10 THEN				ConPosX = ConPosX_10				ConPosY = ConPosY_10				ConPosZ = ConPosZ_10			ENDIF			IF j = 11 THEN				ConPosX = ConPosX_11				ConPosY = ConPosY_11				ConPosZ = ConPosZ_11			ENDIF			IF j = 12 THEN				ConPosX = ConPosX_12				ConPosY = ConPosY_12				ConPosZ = ConPosZ_12			ENDIF			IF j = 13 THEN				ConPosX = ConPosX_13				ConPosY = ConPosY_13				ConPosZ = ConPosZ_13			ENDIF			IF j = 14 THEN				ConPosX = ConPosX_14				ConPosY = ConPosY_14				ConPosZ = ConPosZ_14			ENDIF			IF j = 15 THEN				ConPosX = ConPosX_15				ConPosY = ConPosY_15				ConPosZ = ConPosZ_15			ENDIF			IF j = 16 THEN				ConPosX = ConPosX_16				ConPosY = ConPosY_16				ConPosZ = ConPosZ_16			ENDIF			IF j = 17 THEN				ConPosX = ConPosX_17				ConPosY = ConPosY_17				ConPosZ = ConPosZ_17			ENDIF			IF j = 18 THEN				ConPosX = ConPosX_18				ConPosY = ConPosY_18				ConPosZ = ConPosZ_18			ENDIF		ELSE			ConPosX =  MEP_NumConnectionData[j][1]			ConPosY =  MEP_NumConnectionData[j][2]			ConPosZ =  MEP_NumConnectionData[j][3]		ENDIF		IF j = 1 THEN: ConLength_ = ConLength_1: ConEdgeVisible_ = ConEdgeVisible_1: ENDIF		IF j = 2 THEN: ConLength_ = ConLength_2: ConEdgeVisible_ = ConEdgeVisible_2: ENDIF		IF j = 3 THEN: ConLength_ = ConLength_3: ConEdgeVisible_ = ConEdgeVisible_3: ENDIF		IF j = 4 THEN: ConLength_ = ConLength_4: ConEdgeVisible_ = ConEdgeVisible_4: ENDIF		IF j = 5 THEN: ConLength_ = ConLength_5: ConEdgeVisible_ = ConEdgeVisible_5: ENDIF		IF j = 6 THEN: ConLength_ = ConLength_6: ConEdgeVisible_ = ConEdgeVisible_6: ENDIF		IF j = 7 THEN: ConLength_ = ConLength_7: ConEdgeVisible_ = ConEdgeVisible_7: ENDIF		IF j = 8 THEN: ConLength_ = ConLength_8: ConEdgeVisible_ = ConEdgeVisible_8: ENDIF		IF j = 9 THEN: ConLength_ = ConLength_9: ConEdgeVisible_ = ConEdgeVisible_9: ENDIF		IF j = 10 THEN: ConLength_ = ConLength_10: ConEdgeVisible_ = ConEdgeVisible_10: ENDIF		IF j = 11 THEN: ConLength_ = ConLength_11: ConEdgeVisible_ = ConEdgeVisible_11: ENDIF		IF j = 12 THEN: ConLength_ = ConLength_12: ConEdgeVisible_ = ConEdgeVisible_12: ENDIF		IF j = 13 THEN: ConLength_ = ConLength_13: ConEdgeVisible_ = ConEdgeVisible_13: ENDIF		IF j = 14 THEN: ConLength_ = ConLength_14: ConEdgeVisible_ = ConEdgeVisible_14: ENDIF		IF j = 15 THEN: ConLength_ = ConLength_15: ConEdgeVisible_ = ConEdgeVisible_15: ENDIF		IF j = 16 THEN: ConLength_ = ConLength_16: ConEdgeVisible_ = ConEdgeVisible_16: ENDIF		IF j = 17 THEN: ConLength_ = ConLength_17: ConEdgeVisible_ = ConEdgeVisible_17: ENDIF		IF j = 18 THEN: ConLength_ = ConLength_18: ConEdgeVisible_ = ConEdgeVisible_18: ENDIF		IF ABS(ConLength_) < EPS THEN ConLength_ = EPS		IF DrawingNum = 1 THEN									! ---------------- !									! --- Z vector --- !									! ---------------- !			dZx = -MEP_NumConnectionData[j][8]*MEP_NumConnectionData[j][6]+MEP_NumConnectionData[j][9]*MEP_NumConnectionData[j][5]			dZy = -MEP_NumConnectionData[j][9]*MEP_NumConnectionData[j][4]+MEP_NumConnectionData[j][7]*MEP_NumConnectionData[j][6]			dZz = -MEP_NumConnectionData[j][7]*MEP_NumConnectionData[j][5]+MEP_NumConnectionData[j][8]*MEP_NumConnectionData[j][4]									! ---------------------------- !									! --- second point of pipe --- !									! ---------------------------- !			! --- x,y,z coordinates of 1st point ---			rx1 = ConPosX			ry1 = ConPosY			rz1 = ConPosZ				! --- x,y,z coordinates of 2nd point ---			rx2 = ConPosX+ConLength_*MEP_NumConnectionData[j][4]			ry2 = ConPosY+ConLength_*MEP_NumConnectionData[j][5]			rz2 = ConPosZ+ConLength_*MEP_NumConnectionData[j][6]			! --- direction to 2nd point ---			dx = MEP_NumConnectionData[j][4]			dy = MEP_NumConnectionData[j][5]			dz = MEP_NumConnectionData[j][6]			! --- linxAng of the direction --- !			IF ABS(ABS(MEP_NumConnectionData[j][6])-1) < EPS THEN				 arCosVal = MEP_NumConnectionData[j][7]/1				IF ABS(arCosVal) > 1 AND SGN(arCosVal) = -1 THEN arCosVal = -1				IF ABS(arCosVal) > 1 AND SGN(arCosVal) = 1 THEN arCosVal = 1				linxAng = ACS(arCosVal)-90				IF SGN(MEP_NumConnectionData[j][8]) = -1 THEN linxAng = 180-linxAng			ELSE				IF ABS(dx)>EPS OR ABS(dy)>EPS THEN					arCosVal = dx/(SQR(dx^2+dy^2))					IF ABS(arCosVal) > 1 AND SGN(arCosVal) = -1 THEN arCosVal = -1					IF ABS(arCosVal) > 1 AND SGN(arCosVal) = 1 THEN arCosVal = 1					linxAng = ACS(arCosVal)					IF SGN(dy) = -1 THEN linxAng = 360-linxAng				ENDIF			ENDIF			! --- hotspot editing --- !			IF ABS(MEP_NumConnectionData[j][18]-1) < EPS THEN ConEdit[j] = 0			hceID = HptsUnIDBeginForConnEnds+j*100			IF ConHotspotShowin2D[j] THEN				IF j = 1 THEN					hID = hceID + 1					IF NOT(SetProgram) AND ConEdit[j] THEN						IF ConEdit[j] = 2 OR ConEdit[j] = 5 OR ConEdit[j] = 12 OR ConEdit[j] = 15 THEN							HOTSPOT2 0, ConPosY, hID, ConPosX_1, 1+128: hID = hID+1							HOTSPOT2 -0.1, ConPosY, hID, ConPosX_1, 3: hID = hID+1							HOTSPOT2 ConPosX, ConPosY, hID, ConPosX_1, 2: hID = hID+1						ENDIF						IF ConEdit[j] = 3 OR ConEdit[j] = 5 OR ConEdit[j] = 13 OR ConEdit[j] = 15 THEN							HOTSPOT2 ConPosX, 0, hID, ConPosY_1, 1+128: hID = hID+1							HOTSPOT2 ConPosX, -0.1, hID, ConPosY_1, 3: hID = hID+1							HOTSPOT2 ConPosX, ConPosY, hID, ConPosY_1, 2: hID = hID+1						ENDIF						IF ConEdit[j] > 10 OR ConEdit[j] = 1 THEN							ADD2 rx1, ry1							ROT2 linxAng								HOTSPOT2 0, 0, hID, ConLength_1, 1+128: hID = hID+1								HOTSPOT2 -0.1, 0, hID, ConLength_1, 3: hID = hID+1								HOTSPOT2 ConLength_1, 0, hceID, ConLength_1, 2: hID = hID+1							DEL 2						ENDIF						IF ConEdit[j] = 2 OR ConEdit[j] = 3 OR ConEdit[j] = 4 OR ConEdit[j] = 5 OR ConEdit[j] = 6 OR ConEdit[j] = 7 THEN							HOTSPOT2 ConPosX+MEP_NumConnectionData[j][4]*ConLength_1, ConPosY+MEP_NumConnectionData[j][5]*ConLength_1, hceID						ENDIF					ELSE						HOTSPOT2 ConPosX+MEP_NumConnectionData[j][4]*ConLength_1, ConPosY+MEP_NumConnectionData[j][5]*ConLength_1, hceID					ENDIF				ENDIF				IF j = 2 THEN					hID = hceID + 1					IF NOT(SetProgram) AND ConEdit[j] THEN						IF ConEdit[j] = 2 OR ConEdit[j] = 5 OR ConEdit[j] = 12 OR ConEdit[j] = 15 THEN							HOTSPOT2 0, ConPosY, hID, ConPosX_2, 1+128: hID = hID+1							HOTSPOT2 -0.1, ConPosY, hID, ConPosX_2, 3: hID = hID+1							HOTSPOT2 ConPosX, ConPosY, hID, ConPosX_2, 2: hID = hID+1						ENDIF						IF ConEdit[j] = 3 OR ConEdit[j] = 5 OR ConEdit[j] = 13 OR ConEdit[j] = 15 THEN							HOTSPOT2 ConPosX, 0, hID, ConPosY_2, 1+128: hID = hID+1							HOTSPOT2 ConPosX, -0.1, hID, ConPosY_2, 3: hID = hID+1							HOTSPOT2 ConPosX, ConPosY, hID, ConPosY_2, 2: hID = hID+1						ENDIF						IF ConEdit[j] > 10 OR ConEdit[j] = 1 THEN							ADD2 rx1, ry1							ROT2 linxAng								HOTSPOT2 0, 0, hID, ConLength_2, 1+128: hID = hID+1								HOTSPOT2 -0.1, 0, hID, ConLength_2, 3: hID = hID+1								HOTSPOT2 ConLength_2, 0, hceID, ConLength_2, 2: hID = hID+1							DEL 2						ENDIF						IF ConEdit[j] = 2 OR ConEdit[j] = 3 OR ConEdit[j] = 4 OR ConEdit[j] = 5 OR ConEdit[j] = 6 OR ConEdit[j] = 7 THEN							HOTSPOT2 ConPosX+MEP_NumConnectionData[j][4]*ConLength_2, ConPosY+MEP_NumConnectionData[j][5]*ConLength_2, hceID						ENDIF					ELSE						HOTSPOT2 ConPosX+MEP_NumConnectionData[j][4]*ConLength_2, ConPosY+MEP_NumConnectionData[j][5]*ConLength_2, hceID					ENDIF				ENDIF				IF j = 3 THEN					hID = hceID + 1					IF NOT(SetProgram) AND ConEdit[j] THEN						IF ConEdit[j] = 2 OR ConEdit[j] = 5 OR ConEdit[j] = 12 OR ConEdit[j] = 15 THEN							HOTSPOT2 0, ConPosY, hID, ConPosX_3, 1+128: hID = hID+1							HOTSPOT2 -0.1, ConPosY, hID, ConPosX_3, 3: hID = hID+1							HOTSPOT2 ConPosX, ConPosY, hID, ConPosX_3, 2: hID = hID+1						ENDIF						IF ConEdit[j] = 3 OR ConEdit[j] = 5 OR ConEdit[j] = 13 OR ConEdit[j] = 15 THEN							HOTSPOT2 ConPosX, 0, hID, ConPosY_3, 1+128: hID = hID+1							HOTSPOT2 ConPosX, -0.1, hID, ConPosY_3, 3: hID = hID+1							HOTSPOT2 ConPosX, ConPosY, hID, ConPosY_3, 2: hID = hID+1						ENDIF						IF ConEdit[j] > 10 OR ConEdit[j] = 1 THEN							ADD2 rx1, ry1							ROT2 linxAng								HOTSPOT2 0, 0, hID, ConLength_3, 1+128: hID = hID+1								HOTSPOT2 -0.1, 0, hID, ConLength_3, 3: hID = hID+1								HOTSPOT2 ConLength_3, 0, hceID, ConLength_3, 2: hID = hID+1							DEL 2						ENDIF						IF ConEdit[j] = 2 OR ConEdit[j] = 3 OR ConEdit[j] = 4 OR ConEdit[j] = 5 OR ConEdit[j] = 6 OR ConEdit[j] = 7 THEN							HOTSPOT2 ConPosX+MEP_NumConnectionData[j][4]*ConLength_3, ConPosY+MEP_NumConnectionData[j][5]*ConLength_3, hceID						ENDIF					ELSE						HOTSPOT2 ConPosX+MEP_NumConnectionData[j][4]*ConLength_3, ConPosY+MEP_NumConnectionData[j][5]*ConLength_3, hceID					ENDIF				ENDIF				IF j = 4 THEN					hID = hceID + 1					IF NOT(SetProgram) AND ConEdit[j] THEN						IF ConEdit[j] = 2 OR ConEdit[j] = 5 OR ConEdit[j] = 12 OR ConEdit[j] = 15 THEN							HOTSPOT2 0, ConPosY, hID, ConPosX_4, 1+128: hID = hID+1							HOTSPOT2 -0.1, ConPosY, hID, ConPosX_4, 3: hID = hID+1							HOTSPOT2 ConPosX, ConPosY, hID, ConPosX_4, 2: hID = hID+1						ENDIF						IF ConEdit[j] = 3 OR ConEdit[j] = 5 OR ConEdit[j] = 13 OR ConEdit[j] = 15 THEN							HOTSPOT2 ConPosX, 0, hID, ConPosY_4, 1+128: hID = hID+1							HOTSPOT2 ConPosX, -0.1, hID, ConPosY_4, 3: hID = hID+1							HOTSPOT2 ConPosX, ConPosY, hID, ConPosY_4, 2: hID = hID+1						ENDIF						IF ConEdit[j] > 10 OR ConEdit[j] = 1 THEN							ADD2 rx1, ry1							ROT2 linxAng								HOTSPOT2 0, 0, hID, ConLength_4, 1+128: hID = hID+1								HOTSPOT2 -0.1, 0, hID, ConLength_4, 3: hID = hID+1								HOTSPOT2 ConLength_4, 0, hceID, ConLength_4, 2: hID = hID+1							DEL 2						ENDIF						IF ConEdit[j] = 2 OR ConEdit[j] = 3 OR ConEdit[j] = 4 OR ConEdit[j] = 5 OR ConEdit[j] = 6 OR ConEdit[j] = 7 THEN							HOTSPOT2 ConPosX+MEP_NumConnectionData[j][4]*ConLength_4, ConPosY+MEP_NumConnectionData[j][5]*ConLength_4, hceID						ENDIF					ELSE						HOTSPOT2 ConPosX+MEP_NumConnectionData[j][4]*ConLength_4, ConPosY+MEP_NumConnectionData[j][5]*ConLength_4, hceID					ENDIF				ENDIF				IF j = 5 THEN					hID = hceID + 1					IF NOT(SetProgram) AND ConEdit[j] THEN						IF ConEdit[j] = 2 OR ConEdit[j] = 5 OR ConEdit[j] = 12 OR ConEdit[j] = 15 THEN							HOTSPOT2 0, ConPosY, hID, ConPosX_5, 1+128: hID = hID+1							HOTSPOT2 -0.1, ConPosY, hID, ConPosX_5, 3: hID = hID+1							HOTSPOT2 ConPosX, ConPosY, hID, ConPosX_5, 2: hID = hID+1						ENDIF						IF ConEdit[j] = 3 OR ConEdit[j] = 5 OR ConEdit[j] = 13 OR ConEdit[j] = 15 THEN							HOTSPOT2 ConPosX, 0, hID, ConPosY_5, 1+128: hID = hID+1							HOTSPOT2 ConPosX, -0.1, hID, ConPosY_5, 3: hID = hID+1							HOTSPOT2 ConPosX, ConPosY, hID, ConPosY_5, 2: hID = hID+1						ENDIF						IF ConEdit[j] > 10 OR ConEdit[j] = 1 THEN							ADD2 rx1, ry1							ROT2 linxAng								HOTSPOT2 0, 0, hID, ConLength_5, 1+128: hID = hID+1								HOTSPOT2 -0.1, 0, hID, ConLength_5, 3: hID = hID+1								HOTSPOT2 ConLength_5, 0, hceID, ConLength_5, 2: hID = hID+1							DEL 2						ENDIF						IF ConEdit[j] = 2 OR ConEdit[j] = 3 OR ConEdit[j] = 4 OR ConEdit[j] = 5 OR ConEdit[j] = 6 OR ConEdit[j] = 7 THEN							HOTSPOT2 ConPosX+MEP_NumConnectionData[j][4]*ConLength_5, ConPosY+MEP_NumConnectionData[j][5]*ConLength_5, hceID						ENDIF					ELSE						HOTSPOT2 ConPosX+MEP_NumConnectionData[j][4]*ConLength_5, ConPosY+MEP_NumConnectionData[j][5]*ConLength_5, hceID					ENDIF				ENDIF				IF j = 6 THEN					hID = hceID + 1					IF NOT(SetProgram) AND ConEdit[j] THEN						IF ConEdit[j] = 2 OR ConEdit[j] = 5 OR ConEdit[j] = 12 OR ConEdit[j] = 15 THEN							HOTSPOT2 0, ConPosY, hID, ConPosX_6, 1+128: hID = hID+1							HOTSPOT2 -0.1, ConPosY, hID, ConPosX_6, 3: hID = hID+1							HOTSPOT2 ConPosX, ConPosY, hID, ConPosX_6, 2: hID = hID+1						ENDIF						IF ConEdit[j] = 3 OR ConEdit[j] = 5 OR ConEdit[j] = 13 OR ConEdit[j] = 15 THEN							HOTSPOT2 ConPosX, 0, hID, ConPosY_6, 1+128: hID = hID+1							HOTSPOT2 ConPosX, -0.1, hID, ConPosY_6, 3: hID = hID+1							HOTSPOT2 ConPosX, ConPosY, hID, ConPosY_6, 2: hID = hID+1						ENDIF						IF ConEdit[j] > 10 OR ConEdit[j] = 1 THEN							ADD2 rx1, ry1							ROT2 linxAng								HOTSPOT2 0, 0, hID, ConLength_6, 1+128: hID = hID+1								HOTSPOT2 -0.1, 0, hID, ConLength_6, 3: hID = hID+1								HOTSPOT2 ConLength_6, 0, hceID, ConLength_6, 2: hID = hID+1							DEL 2						ENDIF						IF ConEdit[j] = 2 OR ConEdit[j] = 3 OR ConEdit[j] = 4 OR ConEdit[j] = 5 OR ConEdit[j] = 6 OR ConEdit[j] = 7 THEN							HOTSPOT2 ConPosX+MEP_NumConnectionData[j][4]*ConLength_6, ConPosY+MEP_NumConnectionData[j][5]*ConLength_6, hceID						ENDIF					ELSE						HOTSPOT2 ConPosX+MEP_NumConnectionData[j][4]*ConLength_6, ConPosY+MEP_NumConnectionData[j][5]*ConLength_6, hceID					ENDIF				ENDIF				IF j = 7 THEN					hID = hceID + 1					IF NOT(SetProgram) AND ConEdit[j] THEN						IF ConEdit[j] = 2 OR ConEdit[j] = 5 OR ConEdit[j] = 12 OR ConEdit[j] = 15 THEN							HOTSPOT2 0, ConPosY, hID, ConPosX_7, 1+128: hID = hID+1							HOTSPOT2 -0.1, ConPosY, hID, ConPosX_7, 3: hID = hID+1							HOTSPOT2 ConPosX, ConPosY, hID, ConPosX_7, 2: hID = hID+1						ENDIF						IF ConEdit[j] = 3 OR ConEdit[j] = 5 OR ConEdit[j] = 13 OR ConEdit[j] = 15 THEN							HOTSPOT2 ConPosX, 0, hID, ConPosY_7, 1+128: hID = hID+1							HOTSPOT2 ConPosX, -0.1, hID, ConPosY_7, 3: hID = hID+1							HOTSPOT2 ConPosX, ConPosY, hID, ConPosY_7, 2: hID = hID+1						ENDIF						IF ConEdit[j] > 10 OR ConEdit[j] = 1 THEN							ADD2 rx1, ry1							ROT2 linxAng								HOTSPOT2 0, 0, hID, ConLength_7, 1+128: hID = hID+1								HOTSPOT2 -0.1, 0, hID, ConLength_7, 3: hID = hID+1								HOTSPOT2 ConLength_7, 0, hceID, ConLength_7, 2: hID = hID+1							DEL 2						ENDIF						IF ConEdit[j] = 2 OR ConEdit[j] = 3 OR ConEdit[j] = 4 OR ConEdit[j] = 5 OR ConEdit[j] = 6 OR ConEdit[j] = 7 THEN							HOTSPOT2 ConPosX+MEP_NumConnectionData[j][4]*ConLength_7, ConPosY+MEP_NumConnectionData[j][5]*ConLength_7, hceID						ENDIF					ELSE						HOTSPOT2 ConPosX+MEP_NumConnectionData[j][4]*ConLength_7, ConPosY+MEP_NumConnectionData[j][5]*ConLength_7, hceID					ENDIF				ENDIF				IF j = 8 THEN					hID = hceID + 1					IF NOT(SetProgram) AND ConEdit[j] THEN						IF ConEdit[j] = 2 OR ConEdit[j] = 5 OR ConEdit[j] = 12 OR ConEdit[j] = 15 THEN							HOTSPOT2 0, ConPosY, hID, ConPosX_8, 1+128: hID = hID+1							HOTSPOT2 -0.1, ConPosY, hID, ConPosX_8, 3: hID = hID+1							HOTSPOT2 ConPosX, ConPosY, hID, ConPosX_8, 2: hID = hID+1						ENDIF						IF ConEdit[j] = 3 OR ConEdit[j] = 5 OR ConEdit[j] = 13 OR ConEdit[j] = 15 THEN							HOTSPOT2 ConPosX, 0, hID, ConPosY_8, 1+128: hID = hID+1							HOTSPOT2 ConPosX, -0.1, hID, ConPosY_8, 3: hID = hID+1							HOTSPOT2 ConPosX, ConPosY, hID, ConPosY_8, 2: hID = hID+1						ENDIF						IF ConEdit[j] > 10 OR ConEdit[j] = 1 THEN							ADD2 rx1, ry1							ROT2 linxAng								HOTSPOT2 0, 0, hID, ConLength_8, 1+128: hID = hID+1								HOTSPOT2 -0.1, 0, hID, ConLength_8, 3: hID = hID+1								HOTSPOT2 ConLength_8, 0, hceID, ConLength_8, 2: hID = hID+1							DEL 2						ENDIF						IF ConEdit[j] = 2 OR ConEdit[j] = 3 OR ConEdit[j] = 4 OR ConEdit[j] = 5 OR ConEdit[j] = 6 OR ConEdit[j] = 7 THEN							HOTSPOT2 ConPosX+MEP_NumConnectionData[j][4]*ConLength_8, ConPosY+MEP_NumConnectionData[j][5]*ConLength_8, hceID						ENDIF					ELSE						HOTSPOT2 ConPosX+MEP_NumConnectionData[j][4]*ConLength_8, ConPosY+MEP_NumConnectionData[j][5]*ConLength_8, hceID					ENDIF				ENDIF				IF j = 9 THEN					hID = hceID + 1					IF NOT(SetProgram) AND ConEdit[j] THEN						IF ConEdit[j] = 2 OR ConEdit[j] = 5 OR ConEdit[j] = 12 OR ConEdit[j] = 15 THEN							HOTSPOT2 0, ConPosY, hID, ConPosX_9, 1+128: hID = hID+1							HOTSPOT2 -0.1, ConPosY, hID, ConPosX_9, 3: hID = hID+1							HOTSPOT2 ConPosX, ConPosY, hID, ConPosX_9, 2: hID = hID+1						ENDIF						IF ConEdit[j] = 3 OR ConEdit[j] = 5 OR ConEdit[j] = 13 OR ConEdit[j] = 15 THEN							HOTSPOT2 ConPosX, 0, hID, ConPosY_9, 1+128: hID = hID+1							HOTSPOT2 ConPosX, -0.1, hID, ConPosY_9, 3: hID = hID+1							HOTSPOT2 ConPosX, ConPosY, hID, ConPosY_9, 2: hID = hID+1						ENDIF						IF ConEdit[j] > 10 OR ConEdit[j] = 1 THEN							ADD2 rx1, ry1							ROT2 linxAng								HOTSPOT2 0, 0, hID, ConLength_9, 1+128: hID = hID+1								HOTSPOT2 -0.1, 0, hID, ConLength_9, 3: hID = hID+1								HOTSPOT2 ConLength_9, 0, hceID, ConLength_9, 2: hID = hID+1							DEL 2						ENDIF						IF ConEdit[j] = 2 OR ConEdit[j] = 3 OR ConEdit[j] = 4 OR ConEdit[j] = 5 OR ConEdit[j] = 6 OR ConEdit[j] = 7 THEN							HOTSPOT2 ConPosX+MEP_NumConnectionData[j][4]*ConLength_9, ConPosY+MEP_NumConnectionData[j][5]*ConLength_9, hceID						ENDIF					ELSE						HOTSPOT2 ConPosX+MEP_NumConnectionData[j][4]*ConLength_9, ConPosY+MEP_NumConnectionData[j][5]*ConLength_9, hceID					ENDIF				ENDIF				IF j = 10 THEN					hID = hceID + 1					IF NOT(SetProgram) AND ConEdit[j] THEN						IF ConEdit[j] = 2 OR ConEdit[j] = 5 OR ConEdit[j] = 12 OR ConEdit[j] = 15 THEN							HOTSPOT2 0, ConPosY, hID, ConPosX_10, 1+128: hID = hID+1							HOTSPOT2 -0.1, ConPosY, hID, ConPosX_10, 3: hID = hID+1							HOTSPOT2 ConPosX, ConPosY, hID, ConPosX_10, 2: hID = hID+1						ENDIF						IF ConEdit[j] = 3 OR ConEdit[j] = 5 OR ConEdit[j] = 13 OR ConEdit[j] = 15 THEN							HOTSPOT2 ConPosX, 0, hID, ConPosY_10, 1+128: hID = hID+1							HOTSPOT2 ConPosX, -0.1, hID, ConPosY_10, 3: hID = hID+1							HOTSPOT2 ConPosX, ConPosY, hID, ConPosY_10, 2: hID = hID+1						ENDIF						IF ConEdit[j] > 10 OR ConEdit[j] = 1 THEN							ADD2 rx1, ry1							ROT2 linxAng								HOTSPOT2 0, 0, hID, ConLength_10, 1+128: hID = hID+1								HOTSPOT2 -0.1, 0, hID, ConLength_10, 3: hID = hID+1								HOTSPOT2 ConLength_10, 0, hceID, ConLength_10, 2: hID = hID+1							DEL 2						ENDIF						IF ConEdit[j] = 2 OR ConEdit[j] = 3 OR ConEdit[j] = 4 OR ConEdit[j] = 5 OR ConEdit[j] = 6 OR ConEdit[j] = 7 THEN							HOTSPOT2 ConPosX+MEP_NumConnectionData[j][4]*ConLength_10, ConPosY+MEP_NumConnectionData[j][5]*ConLength_10, hceID						ENDIF					ELSE						HOTSPOT2 ConPosX+MEP_NumConnectionData[j][4]*ConLength_10, ConPosY+MEP_NumConnectionData[j][5]*ConLength_10, hceID					ENDIF				ENDIF				IF j = 11 THEN					hID = hceID + 1					IF NOT(SetProgram) AND ConEdit[j] THEN						IF ConEdit[j] = 2 OR ConEdit[j] = 5 OR ConEdit[j] = 12 OR ConEdit[j] = 15 THEN							HOTSPOT2 0, ConPosY, hID, ConPosX_11, 1+128: hID = hID+1							HOTSPOT2 -0.1, ConPosY, hID, ConPosX_11, 3: hID = hID+1							HOTSPOT2 ConPosX, ConPosY, hID, ConPosX_11, 2: hID = hID+1						ENDIF						IF ConEdit[j] = 3 OR ConEdit[j] = 5 OR ConEdit[j] = 13 OR ConEdit[j] = 15 THEN							HOTSPOT2 ConPosX, 0, hID, ConPosY_11, 1+128: hID = hID+1							HOTSPOT2 ConPosX, -0.1, hID, ConPosY_11, 3: hID = hID+1							HOTSPOT2 ConPosX, ConPosY, hID, ConPosY_11, 2: hID = hID+1						ENDIF						IF ConEdit[j] > 10 OR ConEdit[j] = 1 THEN							ADD2 rx1, ry1							ROT2 linxAng								HOTSPOT2 0, 0, hID, ConLength_11, 1+128: hID = hID+1								HOTSPOT2 -0.1, 0, hID, ConLength_11, 3: hID = hID+1								HOTSPOT2 ConLength_11, 0, hceID, ConLength_10, 2: hID = hID+1							DEL 2						ENDIF						IF ConEdit[j] = 2 OR ConEdit[j] = 3 OR ConEdit[j] = 4 OR ConEdit[j] = 5 OR ConEdit[j] = 6 OR ConEdit[j] = 7 THEN							HOTSPOT2 ConPosX+MEP_NumConnectionData[j][4]*ConLength_11, ConPosY+MEP_NumConnectionData[j][5]*ConLength_11, hceID						ENDIF					ELSE						HOTSPOT2 ConPosX+MEP_NumConnectionData[j][4]*ConLength_11, ConPosY+MEP_NumConnectionData[j][5]*ConLength_11, hceID					ENDIF				ENDIF				IF j = 12 THEN					hID = hceID + 1					IF NOT(SetProgram) AND ConEdit[j] THEN						IF ConEdit[j] = 2 OR ConEdit[j] = 5 OR ConEdit[j] = 12 OR ConEdit[j] = 15 THEN							HOTSPOT2 0, ConPosY, hID, ConPosX_12, 1+128: hID = hID+1							HOTSPOT2 -0.1, ConPosY, hID, ConPosX_12, 3: hID = hID+1							HOTSPOT2 ConPosX, ConPosY, hID, ConPosX_12, 2: hID = hID+1						ENDIF						IF ConEdit[j] = 3 OR ConEdit[j] = 5 OR ConEdit[j] = 13 OR ConEdit[j] = 15 THEN							HOTSPOT2 ConPosX, 0, hID, ConPosY_12, 1+128: hID = hID+1							HOTSPOT2 ConPosX, -0.1, hID, ConPosY_12, 3: hID = hID+1							HOTSPOT2 ConPosX, ConPosY, hID, ConPosY_12, 2: hID = hID+1						ENDIF						IF ConEdit[j] > 10 OR ConEdit[j] = 1 THEN							ADD2 rx1, ry1							ROT2 linxAng								HOTSPOT2 0, 0, hID, ConLength_12, 1+128: hID = hID+1								HOTSPOT2 -0.1, 0, hID, ConLength_12, 3: hID = hID+1								HOTSPOT2 ConLength_12, 0, hceID, ConLength_12, 2: hID = hID+1							DEL 2						ENDIF						IF ConEdit[j] = 2 OR ConEdit[j] = 3 OR ConEdit[j] = 4 OR ConEdit[j] = 5 OR ConEdit[j] = 6 OR ConEdit[j] = 7 THEN							HOTSPOT2 ConPosX+MEP_NumConnectionData[j][4]*ConLength_12, ConPosY+MEP_NumConnectionData[j][5]*ConLength_12, hceID						ENDIF					ELSE						HOTSPOT2 ConPosX+MEP_NumConnectionData[j][4]*ConLength_12, ConPosY+MEP_NumConnectionData[j][5]*ConLength_12, hceID					ENDIF				ENDIF				IF j = 13 THEN					hID = hceID + 1					IF NOT(SetProgram) AND ConEdit[j] THEN						IF ConEdit[j] = 2 OR ConEdit[j] = 5 OR ConEdit[j] = 12 OR ConEdit[j] = 15 THEN							HOTSPOT2 0, ConPosY, hID, ConPosX_13, 1+128: hID = hID+1							HOTSPOT2 -0.1, ConPosY, hID, ConPosX_13, 3: hID = hID+1							HOTSPOT2 ConPosX, ConPosY, hID, ConPosX_13, 2: hID = hID+1						ENDIF						IF ConEdit[j] = 3 OR ConEdit[j] = 5 OR ConEdit[j] = 13 OR ConEdit[j] = 15 THEN							HOTSPOT2 ConPosX, 0, hID, ConPosY_13, 1+128: hID = hID+1							HOTSPOT2 ConPosX, -0.1, hID, ConPosY_13, 3: hID = hID+1							HOTSPOT2 ConPosX, ConPosY, hID, ConPosY_13, 2: hID = hID+1						ENDIF						IF ConEdit[j] > 10 OR ConEdit[j] = 1 THEN							ADD2 rx1, ry1							ROT2 linxAng								HOTSPOT2 0, 0, hID, ConLength_13, 1+128: hID = hID+1								HOTSPOT2 -0.1, 0, hID, ConLength_13, 3: hID = hID+1								HOTSPOT2 ConLength_13, 0, hceID, ConLength_13, 2: hID = hID+1							DEL 2						ENDIF						IF ConEdit[j] = 2 OR ConEdit[j] = 3 OR ConEdit[j] = 4 OR ConEdit[j] = 5 OR ConEdit[j] = 6 OR ConEdit[j] = 7 THEN							HOTSPOT2 ConPosX+MEP_NumConnectionData[j][4]*ConLength_13, ConPosY+MEP_NumConnectionData[j][5]*ConLength_13, hceID						ENDIF					ELSE						HOTSPOT2 ConPosX+MEP_NumConnectionData[j][4]*ConLength_13, ConPosY+MEP_NumConnectionData[j][5]*ConLength_13, hceID					ENDIF				ENDIF				IF j = 14 THEN					hID = hceID + 1					IF NOT(SetProgram) AND ConEdit[j] THEN						IF ConEdit[j] = 2 OR ConEdit[j] = 5 OR ConEdit[j] = 12 OR ConEdit[j] = 15 THEN							HOTSPOT2 0, ConPosY, hID, ConPosX_14, 1+128: hID = hID+1							HOTSPOT2 -0.1, ConPosY, hID, ConPosX_14, 3: hID = hID+1							HOTSPOT2 ConPosX, ConPosY, hID, ConPosX_14, 2: hID = hID+1						ENDIF						IF ConEdit[j] = 3 OR ConEdit[j] = 5 OR ConEdit[j] = 13 OR ConEdit[j] = 15 THEN							HOTSPOT2 ConPosX, 0, hID, ConPosY_14, 1+128: hID = hID+1							HOTSPOT2 ConPosX, -0.1, hID, ConPosY_14, 3: hID = hID+1							HOTSPOT2 ConPosX, ConPosY, hID, ConPosY_14, 2: hID = hID+1						ENDIF						IF ConEdit[j] > 10 OR ConEdit[j] = 1 THEN							ADD2 rx1, ry1							ROT2 linxAng								HOTSPOT2 0, 0, hID, ConLength_14, 1+128: hID = hID+1								HOTSPOT2 -0.1, 0, hID, ConLength_14, 3: hID = hID+1								HOTSPOT2 ConLength_14, 0, hceID, ConLength_14, 2: hID = hID+1							DEL 2						ENDIF						IF ConEdit[j] = 2 OR ConEdit[j] = 3 OR ConEdit[j] = 4 OR ConEdit[j] = 5 OR ConEdit[j] = 6 OR ConEdit[j] = 7 THEN							HOTSPOT2 ConPosX+MEP_NumConnectionData[j][4]*ConLength_14, ConPosY+MEP_NumConnectionData[j][5]*ConLength_14, hceID						ENDIF					ELSE						HOTSPOT2 ConPosX+MEP_NumConnectionData[j][4]*ConLength_14, ConPosY+MEP_NumConnectionData[j][5]*ConLength_14, hceID					ENDIF				ENDIF				IF j = 15 THEN					hID = hceID + 1					IF NOT(SetProgram) AND ConEdit[j] THEN						IF ConEdit[j] = 2 OR ConEdit[j] = 5 OR ConEdit[j] = 12 OR ConEdit[j] = 15 THEN							HOTSPOT2 0, ConPosY, hID, ConPosX_15, 1+128: hID = hID+1							HOTSPOT2 -0.1, ConPosY, hID, ConPosX_15, 3: hID = hID+1							HOTSPOT2 ConPosX, ConPosY, hID, ConPosX_15, 2: hID = hID+1						ENDIF						IF ConEdit[j] = 3 OR ConEdit[j] = 5 OR ConEdit[j] = 13 OR ConEdit[j] = 15 THEN							HOTSPOT2 ConPosX, 0, hID, ConPosY_15, 1+128: hID = hID+1							HOTSPOT2 ConPosX, -0.1, hID, ConPosY_15, 3: hID = hID+1							HOTSPOT2 ConPosX, ConPosY, hID, ConPosY_15, 2: hID = hID+1						ENDIF						IF ConEdit[j] > 10 OR ConEdit[j] = 1 THEN							ADD2 rx1, ry1							ROT2 linxAng								HOTSPOT2 0, 0, hID, ConLength_15, 1+128: hID = hID+1								HOTSPOT2 -0.1, 0, hID, ConLength_15, 3: hID = hID+1								HOTSPOT2 ConLength_15, 0, hceID, ConLength_15, 2: hID = hID+1							DEL 2						ENDIF						IF ConEdit[j] = 2 OR ConEdit[j] = 3 OR ConEdit[j] = 4 OR ConEdit[j] = 5 OR ConEdit[j] = 6 OR ConEdit[j] = 7 THEN							HOTSPOT2 ConPosX+MEP_NumConnectionData[j][4]*ConLength_15, ConPosY+MEP_NumConnectionData[j][5]*ConLength_15, hceID						ENDIF					ELSE						HOTSPOT2 ConPosX+MEP_NumConnectionData[j][4]*ConLength_15, ConPosY+MEP_NumConnectionData[j][5]*ConLength_15, hceID					ENDIF				ENDIF				IF j = 16 THEN					hID = hceID + 1					IF NOT(SetProgram) AND ConEdit[j] THEN						IF ConEdit[j] = 2 OR ConEdit[j] = 5 OR ConEdit[j] = 12 OR ConEdit[j] = 15 THEN							HOTSPOT2 0, ConPosY, hID, ConPosX_16, 1+128: hID = hID+1							HOTSPOT2 -0.1, ConPosY, hID, ConPosX_16, 3: hID = hID+1							HOTSPOT2 ConPosX, ConPosY, hID, ConPosX_16, 2: hID = hID+1						ENDIF						IF ConEdit[j] = 3 OR ConEdit[j] = 5 OR ConEdit[j] = 13 OR ConEdit[j] = 15 THEN							HOTSPOT2 ConPosX, 0, hID, ConPosY_16, 1+128: hID = hID+1							HOTSPOT2 ConPosX, -0.1, hID, ConPosY_16, 3: hID = hID+1							HOTSPOT2 ConPosX, ConPosY, hID, ConPosY_16, 2: hID = hID+1						ENDIF						IF ConEdit[j] > 10 OR ConEdit[j] = 1 THEN							ADD2 rx1, ry1							ROT2 linxAng								HOTSPOT2 0, 0, hID, ConLength_16, 1+128: hID = hID+1								HOTSPOT2 -0.1, 0, hID, ConLength_16, 3: hID = hID+1								HOTSPOT2 ConLength_16, 0, hceID, ConLength_16, 2: hID = hID+1							DEL 2						ENDIF						IF ConEdit[j] = 2 OR ConEdit[j] = 3 OR ConEdit[j] = 4 OR ConEdit[j] = 5 OR ConEdit[j] = 6 OR ConEdit[j] = 7 THEN							HOTSPOT2 ConPosX+MEP_NumConnectionData[j][4]*ConLength_16, ConPosY+MEP_NumConnectionData[j][5]*ConLength_16, hceID						ENDIF					ELSE						HOTSPOT2 ConPosX+MEP_NumConnectionData[j][4]*ConLength_16, ConPosY+MEP_NumConnectionData[j][5]*ConLength_16, hceID					ENDIF				ENDIF				IF j = 17 THEN					hID = hceID + 1					IF NOT(SetProgram) AND ConEdit[j] THEN						IF ConEdit[j] = 2 OR ConEdit[j] = 5 OR ConEdit[j] = 12 OR ConEdit[j] = 15 THEN							HOTSPOT2 0, ConPosY, hID, ConPosX_17, 1+128: hID = hID+1							HOTSPOT2 -0.1, ConPosY, hID, ConPosX_17, 3: hID = hID+1							HOTSPOT2 ConPosX, ConPosY, hID, ConPosX_17, 2: hID = hID+1						ENDIF						IF ConEdit[j] = 3 OR ConEdit[j] = 5 OR ConEdit[j] = 13 OR ConEdit[j] = 15 THEN							HOTSPOT2 ConPosX, 0, hID, ConPosY_17, 1+128: hID = hID+1							HOTSPOT2 ConPosX, -0.1, hID, ConPosY_17, 3: hID = hID+1							HOTSPOT2 ConPosX, ConPosY, hID, ConPosY_17, 2: hID = hID+1						ENDIF						IF ConEdit[j] > 10 OR ConEdit[j] = 1 THEN							ADD2 rx1, ry1							ROT2 linxAng								HOTSPOT2 0, 0, hID, ConLength_17, 1+128: hID = hID+1								HOTSPOT2 -0.1, 0, hID, ConLength_17, 3: hID = hID+1								HOTSPOT2 ConLength_17, 0, hceID, ConLength_17, 2: hID = hID+1							DEL 2						ENDIF						IF ConEdit[j] = 2 OR ConEdit[j] = 3 OR ConEdit[j] = 4 OR ConEdit[j] = 5 OR ConEdit[j] = 6 OR ConEdit[j] = 7 THEN							HOTSPOT2 ConPosX+MEP_NumConnectionData[j][4]*ConLength_17, ConPosY+MEP_NumConnectionData[j][5]*ConLength_17, hceID						ENDIF					ELSE						HOTSPOT2 ConPosX+MEP_NumConnectionData[j][4]*ConLength_17, ConPosY+MEP_NumConnectionData[j][5]*ConLength_17, hceID					ENDIF				ENDIF				IF j = 18 THEN					hID = hceID + 1					IF NOT(SetProgram) AND ConEdit[j] THEN						IF ConEdit[j] = 2 OR ConEdit[j] = 5 OR ConEdit[j] = 12 OR ConEdit[j] = 15 THEN							HOTSPOT2 0, ConPosY, hID, ConPosX_18, 1+128: hID = hID+1							HOTSPOT2 -0.1, ConPosY, hID, ConPosX_18, 3: hID = hID+1							HOTSPOT2 ConPosX, ConPosY, hID, ConPosX_18, 2: hID = hID+1						ENDIF						IF ConEdit[j] = 3 OR ConEdit[j] = 5 OR ConEdit[j] = 13 OR ConEdit[j] = 15 THEN							HOTSPOT2 ConPosX, 0, hID, ConPosY_18, 1+128: hID = hID+1							HOTSPOT2 ConPosX, -0.1, hID, ConPosY_18, 3: hID = hID+1							HOTSPOT2 ConPosX, ConPosY, hID, ConPosY_18, 2: hID = hID+1						ENDIF						IF ConEdit[j] > 10 OR ConEdit[j] = 1 THEN							ADD2 rx1, ry1							ROT2 linxAng								HOTSPOT2 0, 0, hID, ConLength_18, 1+128: hID = hID+1								HOTSPOT2 -0.1, 0, hID, ConLength_18, 3: hID = hID+1								HOTSPOT2 ConLength_18, 0, hceID, ConLength_18, 2: hID = hID+1							DEL 2						ENDIF						IF ConEdit[j] = 2 OR ConEdit[j] = 3 OR ConEdit[j] = 4 OR ConEdit[j] = 5 OR ConEdit[j] = 6 OR ConEdit[j] = 7 THEN							HOTSPOT2 ConPosX+MEP_NumConnectionData[j][4]*ConLength_18, ConPosY+MEP_NumConnectionData[j][5]*ConLength_18, hceID						ENDIF					ELSE						HOTSPOT2 ConPosX+MEP_NumConnectionData[j][4]*ConLength_18, ConPosY+MEP_NumConnectionData[j][5]*ConLength_18, hceID					ENDIF				ENDIF!!				IF ConEdit[j] = 0 THEN HOTSPOT2 ConPosX+ConLength_*MEP_NumConnectionData[j][4], ConPosY+ConLength_*MEP_NumConnectionData[j][5]			ENDIF			 connected			= MEP_NumConnectionData[j][18]			 connectionSex		= MEP_NumConnectionData[j][20]			 connectionStyle	= gs_AddConnections[j][1]			IF ABS(MEP_NumConnectionData[j][19] - 2) < EPS THEN		! --- ToolType = Pipe --- !				connectionWidth		= MEP_NumConnectionData[j][12]				connectorWidth		= MEP_NumConnectionData[j][15]				IF connectorWidth < connectionWidth THEN connectorWidth = connectionWidth				connectorLength	= MEP_NumConnectionData[j][17]				flange = 1				IF connectorLength < EPS THEN flange = 0				IF ABS(connectionStyle-1) < EPS THEN					flange = 0					connectorLength	= 0				ENDIF				cutback = connectorLength				cutbackCL = connectorLength*(ABS(connectionStyle-2) < EPS AND ABS(connectionSex-2) < EPS AND ABS(connected-1) < EPS)				cutbackI = connectorLength*(ABS(connectionStyle-2) < EPS AND ABS(connectionSex-1) < EPS)				IF ABS(connectionStyle-3) < EPS AND ABS(connectionSex-1) < EPS THEN					flange = 0					IF GLOB_CONTEXT = 5 OR ABS(connected) < EPS THEN						cutback = 0						connectorLength = 0					ENDIF				ENDIF				IF flange and not(show_axis) THEN cutback = 0				connectionHalfWidth 	= connectionWidth/2				connectorHalfWidth 		= connectorWidth/2			ENDIF			IF ABS(MEP_NumConnectionData[j][19] - 1) < EPS THEN		! --- ToolType = Duct --- !				IF ABS(MEP_NumConnectionData[j][12]-MEP_NumConnectionData[j][13]) < EPS THEN					connectionWidth		= MEP_NumConnectionData[j][12]+MEP_NumConnectionData[j][14]*2					connectorWidth		= connectionWidth+MEP_NumConnectionData[j][15]*2					connectionHeight	= connectionWidth					connectorHeight		= connectorWidth					IF ABS(MEP_NumConnectionData[j][21] - 3) < EPS THEN MEP_NumConnectionData[j][21] = 2				ELSE					IF ABS(MEP_NumConnectionData[j][9]) < EPS THEN						connectionWidth		= MEP_NumConnectionData[j][12]+MEP_NumConnectionData[j][14]*2						connectionHeight	= MEP_NumConnectionData[j][13]+MEP_NumConnectionData[j][14]*2					ELSE						connectionWidth		= MEP_NumConnectionData[j][13]+MEP_NumConnectionData[j][14]*2						connectionHeight	= MEP_NumConnectionData[j][12]+MEP_NumConnectionData[j][14]*2					ENDIF					connectorWidth		= connectionWidth+MEP_NumConnectionData[j][15]*2					connectorHeight		= connectionHeight+MEP_NumConnectionData[j][15]*2				ENDIF				connectorLength	= MEP_NumConnectionData[j][14]				flange = 1				IF ABS(connectionStyle-1) < EPS THEN					flange = 0					connectorLength	= 0				ENDIF				cutback 	= 0				cutbackCL 	= 0				cutbackI 	= 0				connectionHalfWidth 	= connectionWidth/2				connectorHalfWidth 		= connectorWidth/2				connectionHalfHeight 	= connectionHeight/2				connectorHalfHeight		= connectorHeight/2			ENDIF			IF gs_fill_pen THEN SET FILL gs_fill_type			IF ABS(dx) < EPS THEN dx = 0			IF ABS(dy) < EPS THEN dy = 0			IF ABS(dz) < EPS THEN dz = 0			IF SGN(MEP_NumConnectionData[j][6]) = -1 OR ABS(ConShowin2D[j]) < EPS THEN 				IF SGN(dz) = 0 THEN		! -----< the connection in the xy-plane >----- !					PEN gs_cont_pen					ADD2 rx1, ry1					ROT2 linxAng					 if ((MEP_cline_show and show_axis_and) or show_axis)  THEN		! -----> center line <----- !						PEN MEP_cline_pen						SET LINE_TYPE MEP_cline_type						LINE2 0, 0, ConLength_-cutbackCL, 0					ENDIF					DEL 2					GOTO 1000				endif!				IF SGN(dx) = 0 AND SGN(dy) = 0 THEN!					PEN gs_cont_pen!					ADD2 rx1, ry1!					ROT2 linxAng!					GOTO 1000!				endif				Length=SQR((dx*ConLength_)^2+(dy*ConLength_)^2)				ar = ABS(dz*ConLength_)/ConLength_				br = Length/ConLength_				ADD2 rx1, ry1				ROT2 linxAng				MUL2 ar, 1				if ((MEP_cline_show and show_axis_and) or show_axis)  THEN		! -----> center line <----- !					PEN MEP_cline_pen					SET LINE_TYPE MEP_cline_type					LINE2 0, 0, (ConLength_-cutbackCL)*(br/ar), 0				ENDIF				del 3				GOTO 1000			endif			IF SGN(dz) = 0 THEN		! -----< the connection in the xy-plane >----- !				PEN gs_cont_pen				ADD2 rx1, ry1				ROT2 linxAng					! -----> connection <----- !				connectionHalfWidth = connectionWidth/2				connectorHalfWidth = connectorWidth/2				PUT 0, connectionHalfWidth, ConEdgeVisible_				PUT 0, -connectionHalfWidth, 1				IF flange and not(show_axis) and gs_detlevel_2D_m=2 THEN					POLY2_B 4, 1+2+4+64, gs_fill_pen, gs_back_pen,						ConLength_-connectorLength, -connectorHalfWidth, 1,						ConLength_, -connectorHalfWidth, 1,						ConLength_, connectorHalfWidth, 1,						ConLength_-connectorLength, connectorHalfWidth, 1					IF ABS(ConLength_-connectorLength) > EPS THEN						PUT ConLength_-connectorLength, -connectionHalfWidth, 1						PUT ConLength_-connectorLength, connectionHalfWidth, 1					ENDIF				ELSE					IF ABS(ConLength_-cutback) > EPS THEN						PUT ConLength_-cutback, -connectionHalfWidth, 1						PUT ConLength_-cutback, connectionHalfWidth, 1					ENDIF				ENDIF!!				HOTSPOT2 ConLength_, 0, hceID				POLY2_B NSP/3, 1+2+4+64, gs_fill_pen, gs_back_pen,					GET (NSP)				IF (MEP_InsShow and show_isol and not(show_axis))  THEN			! -----> insulation <----- !					PEN gs_cont_pen					POLY2_ 5, 1,						0, connectionHalfWidth+MEP_InsThickness, ConEdgeVisible_,						0, -connectionHalfWidth-MEP_InsThickness, 1,						ConLength_-cutbackI, -connectionHalfWidth-MEP_InsThickness, 1,						ConLength_-cutbackI, connectionHalfWidth+MEP_InsThickness, 1,						0, connectionHalfWidth+MEP_InsThickness, -1				ENDIF				 if ((MEP_cline_show and show_axis_and) or show_axis)  THEN		! -----> center line <----- !					PEN MEP_cline_pen					SET LINE_TYPE MEP_cline_type					LINE2 0, 0, ConLength_-cutbackCL, 0				ENDIF				DEL 2				GOTO 1000			ENDIF			IF SGN(dx) = 0 AND SGN(dy) = 0 THEN		! -----< the connection on the xy-plane >----- !					! -----> connection <----- !				PEN gs_cont_pen				ADD2 rx1, ry1				ROT2 linxAng				IF ABS(MEP_NumConnectionData[j][21] - 1) < EPS THEN 	! --- ShapeType = Rectangular --- !					SET FILL MEP_symb_fill						PUT connectionHalfHeight, connectionhalfWidth, 1						PUT connectionHalfHeight, -connectionhalfWidth, 1						PUT -connectionHalfHeight, -connectionhalfWidth, 1						PUT -connectionHalfHeight, connectionhalfWidth, 1					POLY2_B NSP/3, 1+2+4+64, MEP_symb_pen, MEP_symb_pen,						GET (NSP)					PEN gs_cont_pen					IF gs_fill_pen THEN SET FILL gs_fill_type					IF flange and not(show_axis) and gs_detlevel_2D_m=2 THEN							PUT connectorHalfHeight, connectorHalfWidth, 1							PUT connectorHalfHeight, -connectorHalfWidth, 1							PUT -connectorHalfHeight, -connectorHalfWidth, 1							PUT -connectorHalfHeight, connectorHalfWidth, 1							PUT connectorHalfHeight, connectorHalfWidth, -1							PUT connectionHalfHeight, connectionhalfWidth, 1							PUT connectionHalfHeight, -connectionhalfWidth, 1							PUT -connectionHalfHeight, -connectionhalfWidth, 1							PUT -connectionHalfHeight, connectionhalfWidth, 1							PUT connectionHalfHeight, connectionhalfWidth, -1						POLY2_B NSP/3, 1+2+4+64, gs_fill_pen, gs_back_pen,							GET (NSP)					ENDIF					IF (MEP_InsShow and show_isol and not(show_axis))  THEN			! -----> insulation <----- !							PUT connectionHalfHeight+MEP_InsThickness, connectionhalfWidth+MEP_InsThickness, 1							PUT connectionHalfHeight+MEP_InsThickness, -connectionhalfWidth+MEP_InsThickness, 1							PUT -connectionHalfHeight+MEP_InsThickness, -connectionhalfWidth+MEP_InsThickness, 1							PUT -connectionHalfHeight+MEP_InsThickness, connectionhalfWidth+MEP_InsThickness, 1						POLY2_ NSP/3, 1,							GET (NSP)					ENDIF				ENDIF				IF ABS(MEP_NumConnectionData[j][21] - 2) < EPS OR ABS(MEP_NumConnectionData[j][21] - 4) < EPS THEN 	! --- ShapeType = Circular --- !					SET FILL MEP_symb_fill						PUT 0, 0, 901						PUT connectionhalfWidth, 360, 4001					POLY2_B NSP/3, 1+2+4+64, MEP_symb_pen, MEP_symb_pen,						GET (NSP)					PEN gs_cont_pen					IF gs_fill_pen THEN SET FILL gs_fill_type					IF flange and not(show_axis) and gs_detlevel_2D_m=2 THEN							PUT 0, 0, 901							PUT connectorHalfWidth, 360, 4001							PUT 0, 0, 901							PUT connectionhalfWidth, 360, 4001						POLY2_B NSP/3, 1+2+4+64, gs_fill_pen, gs_back_pen,							GET (NSP)					ENDIF					IF (MEP_InsShow and show_isol and not(show_axis))  THEN			! -----> insulation <----- !						CIRCLE2 0, 0, connectionhalfWidth+MEP_InsThickness					ENDIF				ENDIF				IF ABS(MEP_NumConnectionData[j][21] - 3) < EPS THEN 	! --- ShapeType = Oval --- !					IF NOT(ABS(connectionhalfWidth-connectionHalfHeight) < EPS) AND connectionhalfWidth > connectionHalfHeight THEN						SET FILL MEP_symb_fill							PUT connectionHalfHeight, -connectionHalfWidth+connectionHalfHeight, 1							PUT connectionHalfHeight, connectionHalfWidth-connectionHalfHeight, 1							PUT -connectionHalfHeight, connectionHalfWidth-connectionHalfHeight, 1001							PUT -connectionHalfHeight, -connectionHalfWidth+connectionHalfHeight, 1							PUT connectionHalfHeight, -connectionHalfWidth+connectionHalfHeight, 1001						POLY2_B NSP/3, 1+2+4+64, MEP_symb_pen, MEP_symb_pen,							GET (NSP)						IF flange and not(show_axis) and gs_detlevel_2D_m=2 THEN								PUT connectorhalfHeight, -connectorHalfWidth+connectorHalfHeight, 1								PUT connectorhalfHeight, connectorHalfWidth-connectorHalfHeight, 1								PUT -connectorhalfHeight, connectorHalfWidth-connectorHalfHeight, 1001								PUT -connectorhalfHeight, -connectorHalfWidth+connectorHalfHeight, 1								PUT connectorhalfHeight, -connectorHalfWidth+connectorHalfHeight, 1001								PUT connectorhalfHeight, -connectorHalfWidth+connectorHalfHeight, -1								PUT connectionHalfHeight, -connectionHalfWidth+connectionHalfHeight, 1								PUT connectionHalfHeight, connectionHalfWidth-connectionHalfHeight, 1								PUT -connectionHalfHeight, connectionHalfWidth-connectionHalfHeight, 1001								PUT -connectionHalfHeight, -connectionHalfWidth+connectionHalfHeight, 1								PUT connectionHalfHeight, -connectionHalfWidth+connectionHalfHeight, 1001								PUT connectionHalfHeight, -connectionHalfWidth+connectionHalfHeight, -1							POLY2_B NSP/3, 1+2+4+64, gs_fill_pen, gs_back_pen,								GET (NSP)						ENDIF						IF (MEP_InsShow and show_isol and not(show_axis))  THEN			! -----> insulation <----- !							rr = connectionHalfHeight+MEP_InsThickness								PUT connectionHalfHeight+MEP_InsThickness, -connectionHalfWidth+MEP_InsThickness+connectionHalfHeight, 1								PUT connectionHalfHeight+MEP_InsThickness, connectionHalfWidth+MEP_InsThickness-connectionHalfHeight, 1								PUT -connectionHalfHeight+MEP_InsThickness, connectionHalfWidth+MEP_InsThickness-connectionHalfHeight, 1001								PUT -connectionHalfHeight+MEP_InsThickness, -connectionHalfWidth+MEP_InsThickness+connectionHalfHeight, 1								PUT connectionHalfHeight+MEP_InsThickness, -connectionHalfWidth+MEP_InsThickness+connectionHalfHeight, 1001							POLY2_B NSP/3, 1+2+4+64, gs_fill_pen, gs_back_pen,								GET (NSP)						ENDIF					ENDIF					IF NOT(ABS(connectionhalfWidth-connectionHalfHeight) < EPS) AND connectionhalfWidth < connectionHalfHeight THEN						SET FILL MEP_symb_fill							PUT connectionhalfHeight-connectionHalfWidth, connectionHalfWidth, 1							PUT -connectionhalfHeight+connectionHalfWidth, connectionHalfWidth, 1							PUT -connectionhalfHeight+connectionHalfWidth, -connectionHalfWidth, 1001							PUT connectionhalfHeight-connectionHalfWidth, -connectionHalfWidth, 1							PUT connectionhalfHeight-connectionHalfWidth, connectionHalfWidth, 1001						POLY2_B NSP/3, 1+2+4+64, MEP_symb_pen, MEP_symb_pen,							GET (NSP)						IF flange and not(show_axis) and gs_detlevel_2D_m=2 THEN								PUT connectorHalfHeight-connectorHalfWidth, connectorHalfWidth, 1								PUT -connectorHalfHeight+connectorHalfWidth, connectorHalfWidth, 1								PUT -connectorHalfHeight+connectorHalfWidth, -connectorHalfWidth, 1001								PUT connectorHalfHeight-connectorHalfWidth, -connectorHalfWidth, 1								PUT connectorHalfHeight-connectorHalfWidth, connectorHalfWidth, 1001								PUT connectorHalfHeight-connectorHalfWidth, connectorHalfWidth, -1								PUT connectionhalfHeight-connectionHalfWidth, connectionHalfWidth, 1								PUT -connectionhalfHeight+connectionHalfWidth, connectionHalfWidth, 1								PUT -connectionhalfHeight+connectionHalfWidth, -connectionHalfWidth, 1001								PUT connectionhalfHeight-connectionHalfWidth, -connectionHalfWidth, 1								PUT connectionhalfHeight-connectionHalfWidth, connectionHalfWidth, 1001								PUT connectionhalfHeight-connectionHalfWidth, connectionHalfWidth, -1							POLY2_B NSP/3, 1+2+4+64, gs_fill_pen, gs_back_pen,								GET (NSP)						ENDIF						IF (MEP_InsShow and show_isol and not(show_axis))  THEN			! -----> insulation <----- !							rr = connectionHalfWidth+MEP_InsThickness								PUT connectionhalfHeight+MEP_InsThickness-connectionHalfWidth, connectionHalfWidth+MEP_InsThickness, 1								PUT -connectionhalfHeight+MEP_InsThickness+connectionHalfWidth, connectionHalfWidth+MEP_InsThickness, 1								PUT -connectionhalfHeight+MEP_InsThickness+connectionHalfWidth, -connectionHalfWidth+MEP_InsThickness, 1001								PUT connectionhalfHeight+MEP_InsThickness-connectionHalfWidth, -connectionHalfWidt+MEP_InsThicknessh, 1								PUT connectionhalfHeight+MEP_InsThickness-connectionHalfWidth, connectionHalfWidth+MEP_InsThickness, 1001							POLY2_B NSP/3, 1+2+4+64, gs_fill_pen, gs_back_pen,								GET (NSP)						ENDIF					ENDIF				ENDIF				DEL 2				GOTO 1000			ENDIF									! -----< other positions of the connection >----- !			PEN gs_cont_pen			Length=SQR((dx*ConLength_)^2+(dy*ConLength_)^2)			ar = ABS(dz*ConLength_)/ConLength_			br = Length/ConLength_			cr = ABS(dz*ConLength_)/Length			length = (ConLength_*br-cutback*br-connectorLength*br*flange)/ar			dist = (ConLength_*br-cutback*br)/ar			InsDist = (ConLength_-cutbackI)*(br/ar)			ADD2 rx1, ry1			ROT2 linxAng			MUL2 ar, 1			IF ABS(MEP_NumConnectionData[j][21] - 1) < EPS THEN 	! --- ShapeType = Rectangular --- !				PEN gs_cont_pen				IF gs_fill_pen THEN SET FILL gs_fill_type				DRAWINDEX 10					PUT -connectionHalfHeight, connectionHalfWidth, 1					PUT length, connectionHalfWidth, 0					PUT length, -connectionHalfWidth, 1					PUT -connectionHalfHeight, -connectionHalfWidth, ConEdgeVisible_					PUT -connectionHalfHeight, connectionHalfWidth, -1				POLY2_B NSP/3, 1+2+4+64, gs_fill_pen, gs_back_pen,					GET (NSP)				DRAWINDEX 20				IF flange and not(show_axis) and gs_detlevel_2D_m=2 THEN						PUT length-connectorHalfHeight, connectorHalfWidth, 1						PUT ConLength_*(br/ar)+connectorHalfHeight, connectorHalfWidth, 1						PUT ConLength_*(br/ar)+connectorHalfHeight, -connectorHalfWidth, 1						PUT length-connectorHalfHeight, -connectorHalfWidth, 1						PUT length-connectorHalfHeight, connectorHalfWidth, -1					POLY2_B NSP/3, 1+2+4+64, gs_fill_pen, gs_back_pen,						GET (NSP)					LINE2 ConLength_*(br/ar)-connectorHalfHeight, connectorHalfWidth, ConLength_*(br/ar)-connectorHalfHeight, -connectorHalfWidth				ENDIF				PEN gs_cont_pen				SET FILL MEP_symb_fill					PUT dist-connectionHalfHeight, connectionHalfWidth, 1					PUT dist+connectionHalfHeight, connectionHalfWidth, 1					PUT dist+connectionHalfHeight, -connectionHalfWidth, 1					PUT dist-connectionHalfHeight, -connectionHalfWidth, 1					PUT dist-connectionHalfHeight, connectionHalfWidth, 1				POLY2_B NSP/3, 1+2+4+64, MEP_symb_pen, MEP_symb_pen,					GET (NSP)!!				IF (MEP_InsShow and show_isol and not(show_axis))  THEN			! -----> insulation <----- !!!					PEN gs_cont_pen!!!!						PUT -connectionHalfHeight-MEP_InsThickness, -connectionHalfWidth-MEP_InsThickness, 1!!						PUT InsDist+connectionHalfHeight+MEP_InsThickness, -connectionHalfWidth-MEP_InsThickness, 1!!						PUT InsDist+connectionHalfHeight+MEP_InsThickness, connectionHalfWidth+MEP_InsThickness, 1!!						PUT -connectionHalfHeight-MEP_InsThickness, connectionHalfWidth+MEP_InsThickness, ConEdgeVisible_!!						PUT -connectionHalfHeight-MEP_InsThickness, -connectionHalfWidth-MEP_InsThickness, -1!!!!					POLY2_ NSP/3, 1,!!!!						GET (NSP)!!!!					LINE2 InsDist-connectionHalfHeight-MEP_InsThickness, -connectionHalfWidth-MEP_InsThickness, InsDist-connectionHalfHeight-MEP_InsThickness, connectionHalfWidth+MEP_InsThickness!!				ENDIF			ENDIF			IF ABS(MEP_NumConnectionData[j][21] - 2) < EPS THEN 	! --- ShapeType = Circular --- !				PEN gs_cont_pen				IF gs_fill_pen THEN SET FILL gs_fill_type				DRAWINDEX 10					PUT 0, connectionHalfWidth, 1					PUT length, connectionHalfWidth, 0					PUT length, -connectionHalfWidth, 1					PUT 0, -connectionHalfWidth, ConEdgeVisible_					PUT 0, connectionHalfWidth, 1001				POLY2_B NSP/3, 1+2+4+64, gs_fill_pen, gs_back_pen,					GET (NSP)				DRAWINDEX 20				IF flange and not(show_axis) and gs_detlevel_2D_m=2 THEN						PUT length, connectorHalfWidth, 1						PUT ConLength_*(br/ar), connectorHalfWidth, 1						PUT ConLength_*(br/ar), -connectorHalfWidth, 1001						PUT length, -connectorHalfWidth, 1						PUT length, connectorHalfWidth, 1001					POLY2_B NSP/3, 1+2+4+64, gs_fill_pen, gs_back_pen,						GET (NSP)					ARC2 ConLength_*(br/ar), 0, connectorHalfWidth, 90, 270				ENDIF				PEN gs_cont_pen				SET FILL MEP_symb_fill					PUT dist, 0, 901					PUT connectionHalfWidth, 360, 4001				POLY2_B NSP/3, 1+2+4+64, MEP_symb_pen, MEP_symb_pen,					GET (NSP)				IF (MEP_InsShow and show_isol and not(show_axis))  THEN			! -----> insulation <----- !					PEN gs_cont_pen						PUT 0, -connectionHalfWidth-MEP_InsThickness, 1						PUT InsDist, -connectionHalfWidth-MEP_InsThickness, 1						PUT InsDist, connectionHalfWidth+MEP_InsThickness, 1001						PUT 0, connectionHalfWidth+MEP_InsThickness, ConEdgeVisible_						PUT 0, -connectionHalfWidth-MEP_InsThickness, 1001					POLY2_ NSP/3, 1,						GET (NSP)					ARC2 InsDist, 0, connectionHalfWidth+MEP_InsThickness, 90, 270				ENDIF			ENDIF			IF ABS(MEP_NumConnectionData[j][21] - 3) < EPS THEN 	! --- ShapeType = Oval --- !				IF NOT(ABS(connectionHalfWidth-connectionHalfHeight) < EPS) AND connectionHalfWidth > connectionHalfHeight THEN					PEN gs_cont_pen					IF gs_fill_pen THEN SET FILL gs_fill_type					DRAWINDEX 10						PUT 0, -connectionHalfWidth, 1						PUT length, -connectionHalfWidth, 0						PUT length, connectionHalfWidth, 1						PUT 0, connectionHalfWidth, ConEdgeVisible_						PUT -connectionHalfHeight, connectionHalfWidth-connectionHalfHeight, 1000+ConEdgeVisible_						PUT -connectionHalfHeight, -connectionHalfWidth+connectionHalfHeight, ConEdgeVisible_						PUT 0, -connectionHalfWidth, 1000+ConEdgeVisible_						PUT 0, -connectionHalfWidth, -1					POLY2_B NSP/3, 1+2+4+64, gs_fill_pen, gs_back_pen,						GET (NSP)					DRAWINDEX 20					IF flange and not(show_axis) and gs_detlevel_2D_m=2 THEN							PUT length, -connectorHalfWidth, 1							PUT ConLength_*(br/ar), -connectorHalfWidth, 1							PUT ConLength_*(br/ar)+connectorHalfHeight, -connectorHalfWidth+connectorHalfHeight, 1001							PUT ConLength_*(br/ar)+connectorHalfHeight, connectorHalfWidth-connectorHalfHeight, 1							PUT ConLength_*(br/ar), connectorHalfWidth, 1001							PUT length, connectorHalfWidth, 1							PUT length-connectorHalfHeight, connectorHalfWidth-connectorHalfHeight, 1001							PUT length-connectorHalfHeight, -connectorHalfWidth+connectorHalfHeight, 1							PUT length, -connectorHalfWidth, 1001							PUT length, -connectorHalfWidth, -1						POLY2_B NSP/3, 1+2+4+64, gs_fill_pen, gs_back_pen,							GET (NSP)						LINE2 ConLength_*(br/ar)-connectorHalfHeight, connectorHalfWidth-connectorHalfHeight, ConLength_*(br/ar)-connectorHalfHeight, -connectorHalfWidth+connectorHalfHeight						ARC2 ConLength_*(br/ar), connectorHalfWidth-connectorHalfHeight, connectorHalfHeight, 90, 180						ARC2 ConLength_*(br/ar), -connectorHalfWidth+connectorHalfHeight, connectorHalfHeight, 180, 270					ENDIF					PEN gs_cont_pen					SET FILL MEP_symb_fill						PUT dist-connectionHalfHeight, -connectionHalfWidth+connectionHalfHeight, 1						PUT dist-connectionHalfHeight, connectionHalfWidth-connectionHalfHeight, 1						PUT dist+connectionHalfHeight, connectionHalfWidth-connectionHalfHeight, 1001						PUT dist+connectionHalfHeight, -connectionHalfWidth+connectionHalfHeight, 1						PUT dist-connectionHalfHeight, -connectionHalfWidth+connectionHalfHeight, 1001					POLY2_B NSP/3, 1+2+4+64, MEP_symb_pen, MEP_symb_pen,						GET (NSP)					IF (MEP_InsShow and show_isol and not(show_axis))  THEN			! -----> insulation <----- !						PEN gs_cont_pen							connectionHalfWidth = connectionHalfWidth+MEP_InsThickness							connectionHalfHeight = connectionHalfHeight+MEP_InsThickness							PUT 0, -connectionHalfWidth, 1							PUT InsDist, -connectionHalfWidth, 1							PUT InsDist+connectionHalfHeight, -connectionHalfWidth+connectionHalfHeight, 1001							PUT InsDist+connectionHalfHeight, connectionHalfWidth-connectionHalfHeight, 1							PUT InsDist, connectionHalfWidth, 1001							PUT 0, connectionHalfWidth, ConEdgeVisible_							PUT -connectionHalfHeight, connectionHalfWidth-connectionHalfHeight, 1000+ConEdgeVisible_							PUT -connectionHalfHeight, -connectionHalfWidth+connectionHalfHeight, ConEdgeVisible_							PUT 0, -connectionHalfWidth, 1000+ConEdgeVisible_							PUT 0, -connectionHalfWidth, -1						POLY2_ NSP/3, 1,							GET (NSP)						LINE2 InsDist-connectionHalfHeight, connectionHalfWidth-connectionHalfHeight, ConLength_*(br/ar)-connectionHalfHeight, -connectionHalfWidth+connectionHalfHeight						ARC2 InsDist, connectionHalfWidth-connectionHalfHeight, connectionHalfHeight, 90, 180						ARC2 InsDist, -connectionHalfWidth+connectionHalfHeight, connectionHalfHeight, 180, 270					ENDIF				ENDIF				IF NOT(ABS(connectionHalfWidth-connectionHalfHeight) < EPS) AND connectionHalfWidth < connectionHalfHeight THEN					PEN gs_cont_pen					IF gs_fill_pen THEN SET FILL gs_fill_type					DRAWINDEX 10						PUT length, -connectionHalfWidth, 0						PUT length, connectionHalfWidth, 1						PUT -connectionHalfHeight+connectionHalfWidth, connectionHalfWidth, ConEdgeVisible_						PUT -connectionHalfHeight+connectionHalfWidth, -connectionHalfWidth, 1001					POLY2_B NSP/3, 1+2+4+64, gs_fill_pen, gs_back_pen,						GET (NSP)					DRAWINDEX 20					IF flange and not(show_axis) and gs_detlevel_2D_m=2 THEN							PUT length-connectorHalfHeight+connectorHalfWidth, connectorHalfWidth, 1							PUT ConLength_*(br/ar)+connectorHalfHeight-connectorHalfWidth, connectorHalfWidth, 1							PUT ConLength_*(br/ar)+connectorHalfHeight-connectorHalfWidth, -connectorHalfWidth, 1001							PUT length-connectorHalfHeight+connectorHalfWidth, -connectorHalfWidth, 1							PUT length-connectorHalfHeight+connectorHalfWidth, connectorHalfWidth, 1001						POLY2_B NSP/3, 1+2+4+64, gs_fill_pen, gs_back_pen,							GET (NSP)						ARC2 ConLength_*(br/ar)-connectorHalfHeight+connectorHalfWidth, 0, connectorHalfWidth, 90, 270					ENDIF					PEN gs_cont_pen					SET FILL MEP_symb_fill						PUT dist-connectionHalfHeight+connectionHalfWidth, connectionHalfWidth, 1						PUT dist+connectionHalfHeight-connectionHalfWidth, connectionHalfWidth, 1						PUT dist+connectionHalfHeight-connectionHalfWidth, -connectionHalfWidth, 1001						PUT dist-connectionHalfHeight+connectionHalfWidth, -connectionHalfWidth, 1						PUT dist-connectionHalfHeight+connectionHalfWidth, connectionHalfWidth, 1001					POLY2_B NSP/3, 1+2+4+64, MEP_symb_pen, MEP_symb_pen,						GET (NSP)					IF (MEP_InsShow and show_isol and not(show_axis))  THEN			! -----> insulation <----- !						PEN gs_cont_pen							connectionHalfWidth = connectionHalfWidth+MEP_InsThickness							connectionHalfHeight = connectionHalfHeight+MEP_InsThickness							PUT InsDist, -connectionHalfWidth, 1							PUT InsDist+connectionHalfHeight-connectionHalfWidth, -connectionHalfWidth, 1							PUT InsDist+connectionHalfHeight-connectionHalfWidth, connectionHalfWidth, 1001							PUT InsDist, connectionHalfWidth, 1							PUT -connectionHalfHeight+connectionHalfWidth, connectionHalfWidth, ConEdgeVisible_							PUT -connectionHalfHeight+connectionHalfWidth, -connectionHalfWidth, 1001							PUT InsDist, -connectionHalfWidth, -1						POLY2_ NSP/3, 1,							GET (NSP)						ARC2 InsDist-connectionHalfHeight+connectionHalfWidth, 0, connectionHalfWidth, 90, 270					ENDIF				ENDIF			ENDIF			 if ((MEP_cline_show and show_axis_and) or show_axis)  THEN		! -----> center line <----- !				PEN MEP_cline_pen				SET LINE_TYPE MEP_cline_type				LINE2 0, 0, (ConLength_-cutbackCL)*(br/ar), 0			ENDIF			DEL 2			1000:		ELSE			ConEndPosX = MEP_NumConnectionData[j][1]+ConLength_*MEP_NumConnectionData[j][4]			ConEndPosY = MEP_NumConnectionData[j][2]+ConLength_*MEP_NumConnectionData[j][5]			ConEndPosZ = MEP_NumConnectionData[j][3]+ConLength_*MEP_NumConnectionData[j][6]			IF DrawingNum = 2 THEN	! Bottom				ConEndPosX = -ConEndPosX				ConEndPosY = ConEndPosY			ENDIF			IF DrawingNum = 3 THEN	! Front				ConEndPosY = ConEndPosZ			ENDIF			IF DrawingNum = 4 THEN	! Back				ConEndPosX = -ConEndPosX				ConEndPosY = ConEndPosZ			ENDIF			IF DrawingNum = 5 THEN	! Right				ConEndPosX = ConEndPosY				ConEndPosY = ConEndPosZ			ENDIF			IF DrawingNum = 6 THEN	! Left				ConEndPosX = -ConEndPosY				ConEndPosY = ConEndPosZ			ENDIF			hceID = HptsUnIDBeginForConnEnds+j*100			HOTSPOT2 ConEndPosX, ConEndPosY, hceID		ENDIF	ENDIFNEXT jgoto 30"set_pen":	CALL "MEP_m_RequestSystemGlobals" PARAMETERS ALL one_ConID=j, MEP_StrConnectionData = MEP_StrConnectionData returned_parameters gs_cont_pen, gs_fill_type, gs_fill_pen, gs_back_pen, MEP_cline_type, MEP_cline_pen, show_el	if not(show_el) then		show_axis=0		show_axis_and=0		show_isol=0		show_conventions=0		show_size=0		ConShowin2D[j]=0	endifreturn30: