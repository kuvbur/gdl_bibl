unposID=1000_pTM = GLOB_SCALE / 1000if show_conventions=0 then goto "end_conventions_3d"if GLOB_SEO_TOOL_MODE or GLOB_PREVIEW_MODE or GLOB_VIEW_TYPE=9 then goto "end_conventions_3d" CALL "MEP_m_RequestSystemGlobals" PARAMETERS ALL one_ConID=0 returned_parameters gs_cont_pen, sMat, gs_InsMat, MEP_cline_pen, show_elpen MEP_cline_pen_nTrans = 0if GLOB_VIEW_TYPE=2 then 	if ABS(dZy)>EPS then 		rotx 90		_nTrans = _nTrans + 1	endif	if ABS(dZx)>EPS then 		roty 90		_nTrans = _nTrans + 1	endifendifXFORM   MEP_Position[2][1], MEP_Position[3][1], dZx, MEP_Position[1][1],		MEP_Position[2][2], MEP_Position[3][2], dZy, MEP_Position[1][2],		MEP_Position[2][3], MEP_Position[3][3], dZz, MEP_Position[1][3]if GLOB_VIEW_TYPE<>2 then 	hotspot  0, 0, dmacro_pos[10]*_pTM, unposID, dmacro_pos[7], 1+128+1024, dmacro_pos[9] : unposID = unposID + 1	hotspot  0, -1, dmacro_pos[10]*_pTM, unposID, dmacro_pos[7], 3 + 1024, dmacro_pos[9] : unposID = unposID + 1	hotspot  0, dmacro_pos[9]*_pTM,  dmacro_pos[10]*_pTM, unposID, dmacro_pos[7], 2 + 1024, dmacro_pos[9] : unposID = unposID + 1	hotspot 0, dmacro_pos[9]*_pTM, 0, unposID, dmacro_pos[8], 1+128+1024, dmacro_pos[10] : unposID = unposID + 1	hotspot 0, dmacro_pos[9]*_pTM, -1, unposID, dmacro_pos[8], 3 + 1024, dmacro_pos[10] : unposID = unposID + 1	hotspot 0, dmacro_pos[9]*_pTM,  dmacro_pos[10]*_pTM, unposID, dmacro_pos[8], 2 + 1024, dmacro_pos[10] : unposID = unposID + 1	addy dmacro_pos[9]*_pTM : _nTrans = _nTrans + 1	addz dmacro_pos[10]*_pTM : _nTrans = _nTrans + 1endif!------------- Решётка ----------------if type_symb = 1 then	if strstr(name, "Потолочн")>0 then		ROTx 90		_nTrans = _nTrans + 1	endif	a_tr = 4*_pTM	h = sqr(a_tr*a_tr - a_tr*a_tr/4)	lin_ y_o-a_tr/2,x_o-h/10,0, y_o+a_tr/2,x_o-h/10,0	hotspot y_o-a_tr/2,x_o-h/10,0,	unposID : unposID = unposID + 1	hotspot y_o+a_tr/2,x_o-h/10,0,	unposID : unposID = unposID + 1	if type_sys<0 then 		addy x_o-h/5 : _nTrans = _nTrans + 1	else		addy -h-h/5 : _nTrans = _nTrans + 1	endif	lin_ y_o-a_tr/2,x_o,0,y_o+a_tr/2,x_o,0	lin_ y_o-a_tr/2,x_o,0,y_o,x_o+h*sgn(type_sys),0	lin_ y_o+a_tr/2,x_o,0,y_o,x_o+h*sgn(type_sys),0	hotspot y_o-a_tr/2,x_o,0,	unposID : unposID = unposID + 1	hotspot y_o+a_tr/2,x_o,0,	unposID : unposID = unposID + 1	hotspot y_o,x_o+h*sgn(type_sys),0,	unposID : unposID = unposID + 1	del 1endif!------------- Заглушка ----------------if type_symb = 2 then	a_tr = 4*_pTM	lin_ x_o-a_tr/2,y_o,0,x_o+a_tr/2,y_o,0endif!------------- Клапан ----------------if type_symb = 31 or type_symb = 32 or type_symb = 33 then	a_pr = 1.5*_pTM	b_pr = 2.5*_pTM	put -a_pr, -b_pr,1	put -a_pr, b_pr,1	put a_pr, b_pr,1	put a_pr, -b_pr,1	if type_symb = 31 then		model wire		lin_ -a_pr, -b_pr,0, a_pr, b_pr,0		CIRCLE _pTM*0.2	endif	if type_symb = 33 then		model wire		POLY_ NSP/3, GET(NSP)		model solid		put a_pr, b_pr,1		put -a_pr, 0,1		put -a_pr, -b_pr,1		put a_pr, 0,1		POLY_ NSP/3, GET(NSP)	endif	if NSP>EPS then POLY_ NSP/3, GET(NSP)endif!if _nTrans>1 then del _nTrans"end_conventions_3d":