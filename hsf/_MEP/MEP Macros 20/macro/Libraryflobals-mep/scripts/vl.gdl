if show_all_system then lock "show_system"values{2} "gs_detlevel_3D_m" igs_detlevel_3D_m, tgs_detlevel_3D_mvalues{2} "gs_detlevel_2D_m" igs_detlevel_3D_m, tgs_detlevel_3D_mvalues{2} "pipe_rule" ipiperule, tpiperulevalues{2} "duct_rule" iductrule, tductrulevalues{2} "show_crane_num" ishow_crane_num, tshow_crane_num!!---------- Чтение списка правил --------------------!dim rule[][] : rule[1][1]=""!ch3=OPEN("TEXT","mep_rule.txt","SEPARATOR=';',MODE=RO,LIBRARY")!i = 1: n=1: j=1 : v0="": v1="": v2="": v3="": v4="": v5="": v6="": v7=""!v8="": v9="": v10="": v11="": v12="": v13="": v14=""!"nxt":!if n <> -1 then!	n=INPUT(ch3,i,1,v0,v1,v2,v3,v4,v5,v6,v7,v8,v9,v10,v11,v12,v13,v14)!	if vartype(v0)=2 then!		if STRSTR(v0,"Тип")=0 then!			rule[j][1] = v0!			rule[j][2] = v1!			rule[j][3] = v2!			rule[j][4] = v3!			rule[j][5] = v4!			rule[j][6] = v5!			rule[j][7] = v6!			rule[j][8] = v7!			rule[j][9] = v8!			rule[j][10] = v9!			rule[j][11] = v10!			rule[j][12] = v11!			rule[j][13] = v12!			rule[j][14] = v13!			rule[j][15] = v14!			j = j + 1!		endif!	endif!	i = i + 1!	goto "nxt"!else!	close (ch3)!endif!dim empty_arr[] : empty_arr[1] = ""!if j>1 then!	for k=1 to vardim1(rule)!		if!	next k!	PARAMETERS rule = rule!endif!!!if GLOB_MODPAR_NAME = "pipe_rule" then!	dim tpipe_inx_rule[]!	for i=1 to vardim1(pipe_rule)!		tpipe_inx_rule[i] = 0!		rule_name = tpiperule[pipe_rule[i]+1]!		for j=1 to vardim1(rule)!			if rule[j][1]="Трубопроводы" and rule[j][2]=rule_name then!				tpipe_inx_rule[i] = j!				j = vardim1(rule)!			endif!		next j!	next i!	parameters pipe_inx_rule = tpipe_inx_rule!endifend!"read_file":!	ch3=OPEN("TEXT",fname+".txt","SEPARATOR='\t',MODE=RO,LIBRARY")!	n=1: j=1 : v0=""!	"nxt":!	if n <> -1 then!		n=INPUT(ch3,j,1,v0)!			arr[j+1] = v0!		endif!		i = i + 1!		goto "nxt"!	else!		close (ch3)!		arr[1] = j!	endif!gosub