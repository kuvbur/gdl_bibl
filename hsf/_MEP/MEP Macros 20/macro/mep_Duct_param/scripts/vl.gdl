!!-------------------------------- Читаем размеры ----------------------------dict con_datamep_bmax = 0if abs(MEP_NumConnectionData[1][21] - 1) < EPS then	con_data.c[1].h = MEP_NumConnectionData[1][12]	con_data.c[1].b = MEP_NumConnectionData[1][13]	con_data.c[1].mh = min(con_data.c[1].h, con_data.c[1].b)	con_data.c[1].mb = max(con_data.c[1].h, con_data.c[1].b)	strmm_num = con_data.c[1].h*1000 : gosub "strmm" : con_data.c[1].h_ = strmm_txt	strmm_num = con_data.c[1].b*1000 : gosub "strmm" : con_data.c[1].b_ = strmm_txt	strmm_num = con_data.c[1].mh*1000 : gosub "strmm" : con_data.c[1].mh_ = strmm_txt	strmm_num = con_data.c[1].mb*1000 : gosub "strmm" : con_data.c[1].mb_ = strmm_txt	con_data.c[1].type_sech_1 = 2else	con_data.c[1].mb = MEP_NumConnectionData[1][12]	con_data.c[1].mh = con_data.c[1].mb	con_data.c[1].type_sech_1 = 1	strmm_num = con_data.c[1].mb*1000 : gosub "strmm" : con_data.c[1].mb_ = "d"+strmm_txtendifcon_data.max = con_data.c[1]con_data.min = con_data.c[1]for i = 2 to MEP_NumberConnections	if i<=vardim1(MEP_NumConnectionData) then		if abs(MEP_NumConnectionData[i][21] - 1) < EPS then			con_data.c[i].type_sech_1 = 2			con_data.c[i].h = MEP_NumConnectionData[i][12]			con_data.c[i].b = MEP_NumConnectionData[i][13]			con_data.c[i].mh = min(con_data.c[i].h, con_data.c[i].b)			con_data.c[i].mb = max(con_data.c[i].h, con_data.c[i].b)			strmm_num = con_data.c[i].h*1000 : gosub "strmm" : con_data.c[i].h_ = strmm_txt			strmm_num = con_data.c[i].b*1000 : gosub "strmm" : con_data.c[i].b_ = strmm_txt			strmm_num = con_data.c[i].mh*1000 : gosub "strmm" : con_data.c[i].mh_ = strmm_txt			strmm_num = con_data.c[i].mb*1000 : gosub "strmm" : con_data.c[i].mb_ = strmm_txt		else			con_data.c[i].type_sech_1 = 1			con_data.c[i].mb = MEP_NumConnectionData[i][12]			con_data.c[i].mh = con_data.c[i].mb			strmm_num = con_data.c[1].mb*1000 : gosub "strmm" : con_data.c[i].mb_ = "d"+strmm_txt		endif		if con_data.c[i].mb>con_data.max.mb or (abs(con_data.c[i].mb-con_data.max.mb)<EPS and con_data.c[i].mh>con_data.max.mh) then con_data.max = con_data.c[i]		if con_data.c[i].mb<con_data.max.mb or (abs(con_data.c[i].mb-con_data.max.mb)<EPS and con_data.c[i].mh<con_data.max.mh) then con_data.min = con_data.c[i]	endifnext i!!----------------------------- Толщина ------------------------------t_ConWallThickness = 1if con_data.max.mb<=0.25 then t_ConWallThickness = 0.5if con_data.max.mb>0.25 and con_data.max.mb<0.8 then t_ConWallThickness = 0.7if con_data.max.mb>=0.8 then t_ConWallThickness = 1mep_th_elem = t_ConWallThickness/1000strmm_num = mep_th_elem*1000 : gosub "strmm" : mep_th_elem_ = strmm_txt!!---------------------------- Длина ------------------------------mep_l = MEP_StraightLengthif mep_l<EPS then mep_l = MEP_BendRadius*(PI/180)*MEP_BendAngleif mep_l<EPS then mep_l = 100/1000mep_l = round_int(mep_l*100)/100!!---------------------- Периметры и площади ------------------------------flange_1 = 0 : if ConConnectorType_1 = "Фланцевое" then flange_1 = 1flange_2 = 0 : if ConConnectorType_2 = "Фланцевое" then flange_2 = 1mep_s_ins_perim = 0mep_s_el = 0if abs(MEP_NumConnectionData[1][21] - 1) < EPS then	mep_s_in = con_data.max.mb*con_data.max.mh	mep_s_perim = 2*(con_data.max.mb+con_data.max.mh)	mep_s_ins_perim = mep_s_perim + MEP_InsThickness*4	if flange_1 = 1 then		mep_s_el = mep_s_el + (MEP_NumConnectionData[1][12]+MEP_NumConnectionData[1][13])*2*40/1000	endif	if flange_2 = 1 and vardim1(MEP_NumConnectionData)>1 then		mep_s_el = mep_s_el + (MEP_NumConnectionData[2][12]+MEP_NumConnectionData[2][13])*2*40/1000	endifelse	mep_s_in = 3.14159 * con_data.max.mb * con_data.max.mb / 4	mep_s_perim = 3.14159 * con_data.max.mb	mep_s_ins_perim = 3.14159 * (con_data.max.mb+MEP_InsThickness*2)	if flange_1 = 1 then		mep_s_el = mep_s_el + mep_s_perim*40/1000	endif	if flange_2 = 1 then		mep_s_el = mep_s_el + mep_s_perim*40/1000	endifendifif abs(MEP_NumConnectionData[1][21] - 1) < EPS then	mep_s_sech = mep_th_elem*(con_data.max.mb + con_data.max.mh + mep_th_elem)else	mep_s_sech = 0.7853975*(mep_th_elem*mep_th_elem+2*mep_th_elem*con_data.max.mb)endifmep_s_el = mep_s_el + mep_s_perim*mep_lmep_s_ins = mep_s_ins_perim*mep_l*MEP_InsShowmep_s_el = round_int(mep_s_el*100)/100mep_s_ins = round_int(mep_s_ins*100)/100!!----------------------------- Отметки, размеры ------------------------------otm_elem = SYMB_POS_Zotm_elem_abs = otm_elemA = mep_lB = con_data.max.mbZZYZX  = con_data.max.mhif con_data.max.mh<EPS then	ZZYZX = con_data.max.mbelse	ZZYZX = con_data.max.mhendifkomment = "кв.м."naen = ""mep_razm_abs = ""mep_razm = ""if abs(con_data.max.type_sech_1 - 1)<EPS then	mep_razm_abs = mep_razm_abs + con_data.max.mb_else	mep_razm_abs = mep_razm_abs + con_data.max.mb_ + "x" + con_data.max.mh_endifif abs(con_data.c[1].type_sech_1 - 1)<EPS then	mep_razm = mep_razm + con_data.c[1].mb_else	mep_razm = mep_razm + con_data.c[1].b_ + "x" + con_data.c[1].h_endifnaen = "Фитинг из оц. стали толщиной " + mep_th_elem_ + " мм. " + mep_razm_abs!!------------------------------ Определяем типы ------------------------------if abs(con_data.max.mb-con_data.min.mb)>EPS and STRSTR(mep_macro_name, "Переход")>0 then	mep_razm_abs = mep_razm_abs + " - "	if abs(con_data.min.type_sech_1 - 1)<EPS then		mep_razm_abs = mep_razm_abs + con_data.min.mb_	else		mep_razm_abs = mep_razm_abs + con_data.min.mb_ + "x" + con_data.min.mh_	endif	mep_razm = mep_razm + " - "	if abs(con_data.c[2].type_sech_1 - 1)<EPS then		mep_razm = mep_razm + con_data.c[2].mb_	else		mep_razm = mep_razm + con_data.c[2].b_ + "x" + con_data.c[2].h_	endif	naen = "Переход из оц. стали толщиной " + mep_th_elem_ + " мм. " + mep_razm_absendifif STRSTR(mep_macro_name, "Тройник")>0 then 	naen = "Тройник из оц. стали толщиной " + mep_th_elem_ + " мм. " + mep_razm_absendifif STRSTR(mep_macro_name, "Отвод")>0 then	type_sech = ""	if abs(con_data.max.type_sech_1 - 2)<EPS then		type_sech = " прямоугольный "	else		type_sech = " круглый "	endif	naen = "Отвод из оц. стали толщиной " + mep_th_elem_ + " мм." + type_sech + str("%.0", MEP_BendAngle) + "град. " + mep_razmendifif STRSTR(mep_macro_name, "Врезка")>0 then	type_sech = ""	if abs(con_data.max.type_sech_1 - 2)<EPS then		type_sech = " прямоугольная "	else		type_sech = " круглая "	endif	naen = "Врезка из оц. стали толщиной " + mep_th_elem_ + " мм." + type_sech + mep_razm_absendifif abs(con_data.max.mb-con_data.min.mb)<EPS and (STRSTR(mep_macro_name, "Воздуховод Прямолинейный")>0 or STRSTR(mep_macro_name, "Переход")>0)then	type_sech = ""	if abs(con_data.max.type_sech_1 - 2)<EPS then		type_sech = " прямоугольные "	else		type_sech = " круглые "	endif	naen = "Воздуховоды из оц. стали толщиной " + mep_th_elem_ + " мм." + type_sech + mep_razm_absendifkol_vo_spec = mep_s_elmep_m_ves = mep_s_sech * 7850ves = mep_m_ves * mep_lmep_m_gost = "Оцинкованная сталь толщиной " + mep_th_elem_ + " мм. "goto "m_end""strmm":	strth = "%.0"	strmm_txt = ""	if vartype(strmm_num)=1 then		if strmm_num>EPS then 			if abs(strmm_num - int(strmm_num))>EPS then strth = "%.1"			strmm_txt = STR(strth, strmm_num)		endif	else		strmm_txt = strmm_num	endifreturn"m_end":PARAMETERS mep_th_elem = mep_th_elemPARAMETERS otm_elem=otm_elemPARAMETERS otm_elem_abs=otm_elem_absPARAMETERS mep_razm_abs=mep_razm_absPARAMETERS mep_razm=mep_razmPARAMETERS mep_s_in=mep_s_inPARAMETERS mep_s_pokr=mep_s_elPARAMETERS mep_s_ins=mep_s_insPARAMETERS mep_s_el=mep_s_elPARAMETERS mep_l=mep_lPARAMETERS mep_vol=mep_s_in*mep_lPARAMETERS A=APARAMETERS B=BPARAMETERS ZZYZX=ZZYZXPARAMETERS kol_vo_spec = kol_vo_specPARAMETERS obozn = oboznPARAMETERS naen = naenPARAMETERS ves = vesPARAMETERS mep_m_gost = mep_m_gostPARAMETERS mep_m_ves = mep_m_ves