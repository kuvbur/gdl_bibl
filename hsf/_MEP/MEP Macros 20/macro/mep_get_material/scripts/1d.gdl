!call "mep_get_material" parameters all mep_get_ma_name_in="" returned_parameters mep_get_ma_name, mep_get_ma_ro, mep_get_ma_groupMEP_UNKNOW = 0MEP_ST3 = 1MEP_AISI = 2MEP_09G2S = 3MEP_PVC = 4MEP_GSH = 5MEP_VG = 6MEP_PE = 7var_t="" : txt_var = "" : ConSystemID = ""dim syst_name_t[] : syst_name_t[1]=""n_sys=0if ConID<=0 then ConID = 1mep_fill_type = 0mep_get_ma_group = MEP_UNKNOWmep_get_ma_name = ""mep_get_ma_ro = 7850print_str = "mep_get_material : "nprint = strlen(print_str)dim group_fill_inx[] : dim group_fill_name[] : dim group_fill_type[] : dim group_fill_ro[]dict mep_type_data : call "mep_common_data" parameters mep_set_type=1 returned_parameters mep_type_dataif haskey(mep_type_data.material) then	group_fill_inx = mep_type_data.material.group_fill_inx	group_fill_name = mep_type_data.material.group_fill_name	group_fill_type = mep_type_data.material.group_fill_type	group_fill_ro = mep_type_data.material.group_fill_roelse	print_str = print_str + "haskey(mep_type_data.material)"	goto "m_end"endifif strlen(mep_get_ma_name_in)>1 then	gosub "get_group_by_name"else	gosub "get_name_by_fill"endifgoto "m_end""get_name_by_fill":	gosub "get_syst_id_by_data"	gosub "get_syst_fill"	if mep_fill_type > 0 then		flag_find=0		for i=1 to vardim1(group_fill_inx)			if mep_fill_type = group_fill_inx[i] then				mep_get_ma_group = group_fill_type[i]				mep_get_ma_name = group_fill_name[i]				mep_get_ma_ro = group_fill_ro[i]				flag_find = 1				i = vardim1(group_fill_inx)			endif		next i		if flag_find=0 then			mep_get_ma_group = MEP_ST3			mep_get_ma_name = "ст. 3"			mep_get_ma_ro = 7850			if flag_find = 0 then print_str = print_str + "Материал по штриховке не найден - " + str("%.0", mep_fill_type)		endif	else		print_str = print_str + "Штриховка не найдена"	endifreturn"get_group_by_name":	for i=1 to vardim1(group_fill_name)		if mep_get_ma_name_in = group_fill_name[i] then			mep_get_ma_group = group_fill_type[i]			mep_get_ma_name = group_fill_name[i]			mep_get_ma_ro = group_fill_ro[i]			flag_find = 1			i = vardim1(group_fill_name)		endif	next i	if flag_find = 0 then print_str = print_str + "Материал по имени не найден - " + mep_get_ma_name_inreturn"get_syst_fill":	queryStr = "GetFillType (" + ConSystemID + ")"	gs_fill_type = 0	n = APPLICATION_QUERY ("MEPSystem", queryStr, mep_fill_type)return"get_syst_id_by_data":	ConSystemID = MEP_StrConnectionData[ConID][2]return"get_syst_id_by_name":	!!!!Добавить поиск ID системы по имениreturn"m_end":if strlen(print_str)>nprint then print print_strend mep_get_ma_name, mep_get_ma_ro, mep_get_ma_group