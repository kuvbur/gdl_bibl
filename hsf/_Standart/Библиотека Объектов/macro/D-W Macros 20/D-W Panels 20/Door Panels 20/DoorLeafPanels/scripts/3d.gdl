
if GLOB_CONTEXT = 6 then	! Window Schedule - 3D view should NOT display sash in open position
	gs_open_3D = 0
endif

bMiddleLine = (bMiddleLine & abs(gs_open_3d) < EPS)


! =============================================================================
! Chinese specific
! =============================================================================

glas_mask5 = 5
glas_mask10 = 5
glas_mask15 = 5

if bStorefrontDoor then
	glas_mask10 = 10
	glas_mask15 = 15
endif

if lod3D = 5 then
	gs_leaf_thk		= gs_frame_thk
	gs_glass_thk	= gs_frame_thk
	glas_mask5		= 13
	glas_mask10		= 13
	glas_mask15		= 13
	gs_grid_thk		= gs_frame_thk
	gz = 0
endif

! =============================================================================

resol res

if gs_fillLeaf < 1 then gs_fillLeaf = SYMB_FILL
if gs_penLeaf_bg < 1 then gs_penLeaf_bg = SYMB_FBGD_PEN
if gs_penLeaf_fg < 1 then gs_penLeaf_fg = SYMB_FILL_PEN

pen gs_leaf_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_leaf_pen_cont

add -a/2 + gs_pivotdoor * (gs_pivotOffset + gs_leaf_thk/2), 0, gs_pivotdoor * gs_leaf_thk/2


! =============================================================================
! inside/outside materials - opening direction
! =============================================================================

if not(WIDO_REVEAL_SIDE) then

	!*** default placement

	topmat=gs_leaf_matin
	botmat=gs_leaf_mat
	sidemat=gs_leaf_matin
	sidematedge=gs_leaf_matin

	multopmat=gs_grill_mat2
	mulbotmat=gs_grill_mat
	mulsidemat=gs_grill_mat2

	louvtopmat=gs_louver_matin
	louvbotmat=gs_louver_mat
	louvsidemat=gs_louver_matin
else

	!*** flip

	topmat=gs_leaf_mat
	botmat=gs_leaf_matin
	sidemat=gs_leaf_mat
	sidematedge=gs_leaf_matin

	multopmat=gs_grill_mat
	mulbotmat=gs_grill_mat2
	mulsidemat=gs_grill_mat

	louvtopmat=gs_louver_mat
	louvbotmat=gs_louver_matin
	louvsidemat=gs_louver_mat
endif

if gs_leaf_mat = gs_leaf_matin then
	!*** same materials inside / outside
	nn=1
	framethick=gs_leaf_thk
	mmask=15
else
	!*** different materials inside / outside
	nn=2
	framethick=gs_leaf_thk/2
	mmask=14
endif

if gs_grill_mat = gs_grill_mat2 | gs_grill_pos_m <> MULLION_THROUGHOUT then
	!*** same materials inside / outside
	mn=1
	multhick=gs_grid_thk
	mmask=15
else
	!*** different materials inside / outside
	mn=2
	multhick=gs_grid_thk/2
	mmask=14
endif


! =============================================================================
! Opening Line
! =============================================================================

if gs_pivotdoor then add -gs_pivotOffset-gs_leaf_thk/2, 0, -gs_leaf_thk/2

if bOplines3d then

	oplineGap = 0.0001

	if sliding_door then
		iOpeningType = 12		! SASH_LEFT_SLIDING
	else
		iOpeningType = 4		! SASH_SIDE_HUNG_M
	endif

	if iLeafShape = LEAF_SHAPE_RECTANGULAR then
		opLineHeight = B
	else
		if iLeafShape = LEAF_SHAPE_ARCHED then
			opLineHeight = 	gs_shoulder_h
		else
			if gs_opline_style_m = 1 then
				opLineHeight = 	gs_shoulder_h
			else
				opLineHeight = B
			endif
		endif
	endif

	frameThickness = gs_leaf_thk + 2 * oplineGap
	addz -oplineGap
	if gs_pivotdoor then
		addx gs_pivotOffset
		call "OpeningLines" parameters a = a - gs_pivotOffset,
					b					= opLineHeight,
					frameThickness		= frameThickness,
					iOpeningType		= 4,
					opLineType3dIn		= opLineType3dIn,
					opLineType3dOut		= opLineType3dOut,
					gs_opLinePen		= gs_opLinePen,
					gs_opline_style_m	= gs_opline_style_m
		mulx -1
		call "OpeningLines" parameters a = gs_pivotOffset,
					b					= opLineHeight,
					frameThickness		= frameThickness,
					iOpeningType		= 4,
					opLineType3dIn		= opLineType3dOut,
					opLineType3dOut		= opLineType3dIn,
					gs_opLinePen		= gs_opLinePen,
					gs_opline_style_m	= gs_opline_style_m
		del 2
	else
		call "OpeningLines" parameters a = a,
					b					= opLineHeight,
					frameThickness		= frameThickness,
					iOpeningType		= iOpeningType,
					opLineType3dIn		= opLineType3dIn,
					opLineType3dOut		= opLineType3dOut,
					gs_opLinePen		= gs_opLinePen,
					gs_opline_style_m	= gs_opline_style_m
	endif

	del 1
endif


! =============================================================================
! Middleline
! =============================================================================

if bMiddleLine then gosub "middleline"


! =============================================================================
! Handle
! =============================================================================

addx a/2

if lod3D = 2 then
	add a/2-gs_han_pos, gs_han_height, gs_leaf_thk
	mulx -1

	bSecondHandle = not(gs_handle_type_m = 18 | gs_handle_type_m = 19 | gs_handle_type_m = 23 | gs_handle_type_m = 24)
	! There was no horizontal bar at the inner side in the D1/D2 Metal and D1/D2 Storefront doors

	if bStorefrontClassic then
		call "DoorHandle" parameters A=A,
			bDifferentHandles		= 1,
			bSecondHandle			= 1,
			gs_handle_type_m		= gs_handle_type_m,
			gs_handle_type_out_m	= gs_handle_type_out_m,
			gs_cust_handle			= gs_cust_handle,
			gs_cust_handle_out		= gs_cust_handle_out,
			gs_leaf_thk				= gs_leaf_thk,
			gs_handle_mat			= gs_handle_mat,
			gs_handle_ac_mat		= gs_handle_ac_mat,
			gs_han_pos				= gs_han_pos,
			gs_han_height			= gs_han_height,
			panicBarLength			= A - 2 * gs_han_pos,
			horizontalBarLength		= A - 2 * gs_han_pos,
			horizontalBarPos		= gs_han_pos,
			verticalBarLength		= 0.3,
			verticalBarHeight		= gs_han_height - 0.3/2

	else
		call "DoorHandle" parameters A=A,
			bDifferentHandles		= 0,
			bSecondHandle			= bSecondHandle,
			gs_handle_type_m		= gs_handle_type_m,
			gs_cust_handle			= gs_cust_handle,
			gs_leaf_thk				= gs_leaf_thk,
			gs_handle_mat			= gs_handle_mat,
			gs_handle_ac_mat		= gs_handle_ac_mat,
			gs_han_pos				= gs_han_pos,
			gs_han_height			= gs_han_height,
			panicBarLength			= A - 2 * gs_han_pos,
			horizontalBarLength		= A - 2 * gs_han_pos,
			horizontalBarPos		= gs_han_pos,
			verticalBarLength		= 0.3,
			verticalBarHeight		= gs_han_height - 0.3/2
	endif
	del 2
endif


! =============================================================================
! Kick Board
! =============================================================================
if bEnableKickBoard then
	addz gs_leaf_thk / 2

	if WIDO_REVEAL_SIDE then mulz -1

	gosub "KickBoard"

	if WIDO_REVEAL_SIDE then del 1

	del 1
endif

! =============================================================================
! Door Panel
! =============================================================================

if bMirroredPanel then mulx -1

if _bSimplePanel then
	gosub 1
else
	gosub iDoorPanelType
endif

if bMirroredPanel then del 1


! =============================================================================
! for panel contour lines
! =============================================================================

if iDoorPanelType=27 or iDoorPanelType=28 then

	addx -a/2

	model wire

	body -1

	prism_ 5, gs_leaf_thk,
		0, 0, 15,
		A, 0, 15,
		A, B, 15,
		0, B, 15,
		0, 0, -1

	body -1

	model solid

	del 1

endif

! =============================================================================
end
! =============================================================================


"KickBoard":
	_kickBoardThickness	= 0.002
	_kickBoardWidth		= a - 0.02

	addz -gs_leaf_thk/2 - _kickBoardThickness

	if bSecondPanel then
		if bKickBoardOut2 then		! Outside
			material matKickBoardOut

			prism_ 5, _kickBoardThickness,
				-_kickBoardWidth/2,	0.01,				15,
				_kickBoardWidth/2,	0.01,				15,
				_kickBoardWidth/2,	kickBoardHeight2,	15,
				-_kickBoardWidth/2,	kickBoardHeight2,	15,
				-_kickBoardWidth/2,	0.01,				-1
		endif

		addz gs_leaf_thk + _kickBoardThickness

		if bKickBoardIn2 then		! Inside
			material matKickBoardIn

			prism_ 5, _kickBoardThickness,
				-_kickBoardWidth/2,	0.01,				15,
				_kickBoardWidth/2,	0.01,				15,
				_kickBoardWidth/2,	kickBoardHeight2,	15,
				-_kickBoardWidth/2,	kickBoardHeight2,	15,
				-_kickBoardWidth/2,	0.01,				-1
		endif

		del 1
	else
		if bKickBoardOut then		! Outside
			material matKickBoardOut

			prism_ 5, _kickBoardThickness,
				-_kickBoardWidth/2,	0.01,				15,
				_kickBoardWidth/2,	0.01,				15,
				_kickBoardWidth/2,	kickBoardHeight,	15,
				-_kickBoardWidth/2,	kickBoardHeight,	15,
				-_kickBoardWidth/2,	0.01,				-1
		endif

		addz gs_leaf_thk + _kickBoardThickness

		if bKickBoardIn then		! Inside
			material matKickBoardIn

			prism_ 5, _kickBoardThickness,
				-_kickBoardWidth/2,	0.01,				15,
				_kickBoardWidth/2,	0.01,				15,
				_kickBoardWidth/2,	kickBoardHeight,	15,
				-_kickBoardWidth/2,	kickBoardHeight,	15,
				-_kickBoardWidth/2,	0.01,				-1
		endif

		del 1
	endif

	del 1
return



! ************************************************************
!  Wooden Internal Panels
! ************************************************************

1:
!!!!!******************** CARRDELUXE !!!!!

material gs_leaf_mat

if iLeafShape = LEAF_SHAPE_RECTANGULAR then
	addx -a/2

	model wire

	body -1

	prism_ 5, gs_leaf_thk,
		0, 0, 15,
		A, 0, 15,
		A, B, 15,
		0, B, 15,
		0, 0, -1

	body -1

	model solid

	sprism_{2} topmat, botmat, sidemat,
		5,
		0,  0,  1,  0,  gs_leaf_thk, 0,
		0,  0,  1, 0,   0,  0,
		0, 0, 15, sidemat,
		A, 0, 15, sidemat,
		A, B, 15, sidemat,
		0, B, 15, sidemat,
		0, 0, -1, sidemat

	gosub 500

	del 1
endif

if iLeafShape = LEAF_SHAPE_ARCHED then

	if abs(bce - (A/2)) < EPS then
		frm = 2
	else
		frm = 0
	endif

	ii = 0
	gosub 900

	base

	sprism_{2} topmat, botmat, sidematedge,
		8,
		0,  0,  1,  0,  framethick, 0,
		0,  0,  1, 0,   0,  0,
		-A/2,0,15, sidematedge,
		 A/2,0,15, sidematedge,
		 A/2,gs_shoulder_h-0.00001, 15-frm, sidematedge,
		 A/2,gs_shoulder_h, 79, sidematedge,
		-1, tan(alphace/2), 800, sidematedge,
		 0,B, 1079-frm, sidematedge,
		-A/2,gs_shoulder_h, 1015-frm, sidematedge,
		-A/2,0,-1, sidematedge

	gosub 500

	body -1
endif


if iLeafShape = LEAF_SHAPE_HALFARCHED then

	if abs(gs_shoulder_h - A) < EPS then
		frm = 2
	else
		frm = 0
	endif

	ii = 0
	gosub 900

	base

	sprism_{2} topmat, botmat, sidemat,
		6,
		0,  0,  1,  0,  gs_leaf_thk, 0,
		0,  0,  1, 0,   0,  0,
		 A/2, 0, 15, sidemat,
		 A/2, B-0.00001, 15, sidemat,
		 A/2, B, 79, sidemat,
		-1, 0, 800, sidemat,
		-A/2,gs_shoulder_h, 1015-frm, sidemat,
		-A/2, 0,15, sidemat

	gosub 500

	body -1

endif

return


2:
!!!!!******************** DOOR PANEL B !!!!!

addx -a/2

!! FRAME !!

c=gs_leaf_thk
d=gs_fw_side
f=gs_int_fw
h=d*b/2/a           !X width

if lod3D = 5 then
	c2=gs_frame_thk
	c3=c
	c4=0
else
	c2=c/2
	c3=c/4
	c4=c/4
endif

material gs_leaf_mat


for ii=1 to nn

	gosub 900

	if gs_SashText_typ_num = 1 then
		base

		sprism_{2} topmat, botmat, sidemat,
			8,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1, 0,   0,  0,
			0, 0, 10, sidematedge,
			d, d, 8, sidemat,
			d, d+h, 15, sidemat,
			d, b/2-h-d, 10, sidemat,
			d, b/2, 15, sidemat,
			d, b-d, 10, sidemat,
			0, b, mmask, sidematedge,
			0, 0, -1, sidematedge

		sprism_{2} topmat, botmat, sidemat,
			8,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1, 0,   0,  0,
			a, 0, 10, sidematedge,
			a-d, d, 8, sidemat,
			a-d, d+h, 15, sidemat,
			a-d, b/2-h-d, 10, sidemat,
			a-d, b/2, 15, sidemat,
			a-d, b-d, 10, sidemat,
			a, b, mmask, sidematedge,
			a, 0, -1, sidematedge

		gosub 500

		sprism_{2} topmat, botmat, sidemat,
			7,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1, 0,   0,  0,
			0, 0, 10, sidematedge,
			d, d, 8, sidemat,
			d+h, d, 15, sidemat,
			a-d-h, d, 10, sidemat,
			a-d, d, 10, sidemat,
			a, 0, mmask, sidematedge,
			0, 0, -1, sidematedge

		cprism_ topmat, botmat, sidemat,
			6, framethick,
			d,b/2,10,
			d,b/2-d,8,
			d+h,b/2-d,15,
			a-d-h,b/2-d,10,
			a-d,b/2-d,10,
			a-d,b/2,15

		sprism_{2} topmat, botmat, sidemat,
			5,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1, 0,   0,  0,
			0, b, 10, sidematedge,
			d, b-d, 15, sidemat,
			a-d, b-d, 10, sidemat,
			a, b, mmask, sidematedge,
			0, b, -1, sidematedge

		gosub 600

	endif


	if gs_SashText_typ_num = 2 then

		base

		sprism_{2} topmat, botmat, sidemat,
			9,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1, 0,   0,  0,
			0, d, 8, sidematedge,
			d, d, 8, sidemat,
			d, d+h, 15, sidemat,
			d, b/2-h-d, 10, sidemat,
			d, b/2-d, 8, sidemat,
			d, b/2, 15, sidemat,
			d, b-d, 10, sidemat,
			0, b-d, mmask2, sidematedge,
			0, d, -1, sidematedge

		sprism_{2} topmat, botmat, sidemat,
			9,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1, 0,   0,  0,
			a, d, 8, sidematedge,
			a-d, d, 8, sidemat,
			a-d, d+h, 15, sidemat,
			a-d, b/2-h-d, 10, sidemat,
			a-d, b/2-d, 8, sidemat,
			a-d, b/2, 15, sidemat,
			a-d, b-d, 10, sidemat,
			a, b-d, mmask2, sidematedge,
			a, d, -1, sidematedge

		gosub 500

		sprism_{2} topmat, botmat, sidemat,
			9,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1, 0,   0,  0,
			0, d, 8, sidematedge,
			d, d, 8, sidemat,
			d+d, d, 15, sidemat,
			a-d-d, d, 10, sidemat,
			a-d, d, 8, sidemat,
			a, d, mmask, sidematedge,
			a, 0, mmask2, sidematedge,
			0, 0, 15, sidematedge,
			0, d, -1, sidematedge

		cprism_ topmat, botmat, sidemat,
			6, framethick,
			d,b/2-d,8,
			d+d,b/2-d,15,
			a-d-d,b/2-d,10,
			a-d,b/2-d,8,
			a-d,b/2,13,
			d,b/2,8

		sprism_{2} topmat, botmat, sidemat,
			7,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1, 0,   0,  0,
			0, b-d, 8, sidematedge,
			d, b-d, 15, sidemat,
			a-d, b-d, 10, sidemat,
			a, b-d, mmask2, sidematedge,
			a, b, mmask2, sidematedge,
			0, b, mmask2, sidematedge,
			0, b-d, -1, sidematedge

		gosub 600

	endif

	!************ Both in type1 and type 2

	alph2=atn(h/d)

	base

	cprism_ topmat, botmat, sidemat,
		6, framethick,
		d+d,d,10,
		d,d,8,
		d,d+h,15,
		a/2-d,b/4,10,
		a/2,b/4,8,
		a/2,b/4-h,15

	cprism_ topmat, botmat, sidemat,
		6, framethick,
		a-d-d,b/2-d,10,
		a-d,b/2-d,8,
		a-d,b/2-d-h,15,
		a/2+d,b/4,10,
		a/2,b/4,8,
		a/2,b/4+h,15

	vert 0, 0, 0
	vert cos(alph2), sin(alph2), 0
	vert sin(alph2), cos(alph2), 0
	vert 0, 0, 1
	coor 2, -1, -2, -3, -4
	body 1

	base

	cprism_ topmat, botmat, sidemat,
		6, framethick,
		a-d-d,d,10,
		a-d,d,8,
		a-d,d+h,15,
		a/2+d,b/4,10,
		a/2,b/4,8,
		a/2,b/4-h,15

	cprism_ topmat, botmat, sidemat,
		6, framethick,
		d+d,b/2-d,10,
		d,b/2-d,8,
		d,b/2-d-h,15,
		a/2-d,b/4,10,
		a/2,b/4,8,
		a/2,b/4+h,15

	vert 0, 0, 0
	vert -cos(alph2), sin(alph2), 0
	vert -sin(alph2), cos(alph2), 0
	vert 0, 0, 1
	coor 2, -1, -2, -3, -4
	body 1

	body -1

	addz framethick

next ii

del nn


addz c4


!! FILLING !!

material gs_leaf_mat3

	base
	prism_ 3,c2,
		d,h+d,15,
		d,b/2-h-d,15,
		a/2-d,b/4,15
	prism_ 3,c2,
		a-d,b/2-h-d,15,
		a-d,h+d,15,
		a/2+d,b/4,15
	vert 0, 0, 0
	vert 0, 1, 0
	vert 1, 0, 0
	vert 0, 0, 1
	coor 2, -1, -2, -3, -4
	body 1

	base
	prism_ 3,c2,
		2*d,d,15,
		a-2*d,d,15,
		a/2,b/4-h,15
	prism_ 3,c2,
		a/2,b/4+h,15,
		2*d,b/2-d,15,
		a-2*d,b/2-d,15
	vert 0, 0, 0
	vert 1, 0, 0
	vert 0, 1, 0
	vert 0, 0, 1
	coor 2, -1, -2, -3, -4
	body 1
body -1


!! GLASS !!
pen gs_glass_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_glass_pen_cont
material gs_glass_mat
addz c3-gs_glass_thk


prism_ 4,gs_glass_thk,
	a-d-f,b/2+f,glas_mask5,
	a-d-f,b-d-f,glas_mask5,
	d+f,b-d-f,glas_mask5,
	d+f,b/2+f,glas_mask5
body -1

!! INNER FRAME !!
pen gs_leaf_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_leaf_pen_cont
material gs_leaf_mat2

del 1
addx d
addy b/2

if gs_SashText_typ_num = 1 then
	base
	prism_ 4,c2,
		0,0,8,
		f,f,15,
		f,b/2-d-f,10,
		0,b/2-d,15
	prism_ 4,c2,
		a-2*d,0,8,
		a-2*d-f,f,15,
		a-2*d-f,b/2-d-f,10,
		a-2*d,b/2-d,15
	vert 0, 0, 0
	vert 0, 1, 0
	vert 1, 0, 0
	vert 0, 0, 1
	coor 2, -1, -2, -3, -4
	body 1

	base
	prism_ 4,c2,
		0,0,8,
		f,f,15,
		a-2*d-f,f,10,
		a-2*d,0,15
	prism_ 4,c2,
		0,b/2-d,8,
		f,b/2-d-f,15,
		a-2*d-f,b/2-d-f,10,
		a-2*d,b/2-d,15
	vert 0, 0, 0
	vert 1, 0, 0
	vert 0, 1, 0
	vert 0, 0, 1
	coor 2, -1, -2, -3, -4
	body 1
endif

if gs_SashText_typ_num = 2 then
	base
	prism_ 4,c2,
		0,f,8,
		f,f,15,
		f,b/2-d-f,10,
		0,b/2-d-f,15
	prism_ 4,c2,
		a-2*d,f,8,
		a-2*d-f,f,15,
		a-2*d-f,b/2-d-f,10,
		a-2*d,b/2-d-f,15
	vert 0, 0, 0
	vert 0, 1, 0
	vert 1, 0, 0
	vert 0, 0, 1
	coor 2, -1, -2, -3, -4
	body 1

	base
	prism_ 6,c2,
		0,0,15,
		0,f,8,
		f,f,15,
		a-2*d-f,f,10,
		a-2*d,f,13,
		a-2*d,0,15
	prism_ 6,c2,
		0,b/2-d,15,
		0,b/2-d-f,8,
		f,b/2-d-f,15,
		a-2*d-f,b/2-d-f,10,
		a-2*d,b/2-d-f,13,
		a-2*d,b/2-d,15
	vert 0, 0, 0
	vert 1, 0, 0
	vert 0, 1, 0
	vert 0, 0, 1
	coor 2, -1, -2, -3, -4
	body 1
endif
body -1


del 4
RETURN



3:
!!!!!******************** DOOR PANEL A !!!!!

c=gs_leaf_thk
d=gs_fw_side
f=gs_int_fw
if iDoorPanelType = 3 then
	g = 2
	h = 4
else
	g = 3
	h = 6
endif

i= (a-(g+1)*d)/g      ! horiz size of panes
j= (b-(h+1)*d)/h      ! vertical size of panes

if lod3D = 5 then
	c2=gs_frame_thk
	c3=c
	c4=0
else
	c2=c/2
	c3=c/4
	c4=c/4
endif

addx -a/2

addz c4

for v=0 to g-1

	for w=0 to h-1

		add (v+1)*d+v*i, (w+1)*d+w*j,0

		material gs_leaf_mat2

		if gs_SashText_typ_num = 1 then

			base

			prism_ 4,c2,
				0,0,10,
				f,f,15,
				f,j-f,10,
				0,j,15

			prism_ 4,c2,
				i,0,10,
				i-f,f,15,
				i-f,j-f,10,
				i,j,15

			gosub 500

			prism_ 4,c2,
				0,0,10,
				f,f,15,
				i-f,f,10,
				i,0,15

			prism_ 4,c2,
				0,j,10,
				f,j-f,15,
				i-f,j-f,10,
				i,j,15

			gosub 600

		endif

		if gs_SashText_typ_num = 2 then

			base

			prism_ 4,c2,
				0,f,8,
				f,f,15,
				f,j-f,10,
				0,j-f,13

			prism_ 4,c2,
				i,f,8,
				i-f,f,15,
				i-f,j-f,10,
				i,j-f,13

			gosub 500

			prism_ 6,c2,
				0,0,15,
				0,f,8,
				f,f,15,
				i-f,f,10,
				i,f,13,
				i,0,15

			prism_ 6,c2,
				0,j,15,
				0,j-f,8,
				f,j-f,15,
				i-f,j-f,10,
				i,j-f,13,
				i,j,15

			gosub 600

		endif

		body -1

		del 1

	next w

next v

del 1


material gs_leaf_mat

fuggtav=(b-((h+1)*d))/(h)
vizsztav=(a-((g+1)*d))/(g)

if gs_SashText_typ_num = 1 then

	base

	for w=1 to h
		blsvgfgtav=d/2
		blskzfgtav=d/2
		if w=h then blsvgfgtav=0
		if w=1 then blskzfgtav=0
		kzfgtav=d/2
		vgfgtav=d/2
		if w=1 then kzfgtav=d
		if w=h then vgfgtav=d

		for ii=1 to nn

			gosub 900

			sprism_{2} topmat, botmat, sidemat,
				7,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				0, 0, 10, sidematedge,
				d, kzfgtav-blskzfgtav, 8, sidemat,
				d, kzfgtav, 15, sidemat,
				d, fuggtav+kzfgtav, 8, sidemat,
				d, fuggtav+kzfgtav+blsvgfgtav, 10, sidemat,
				0, fuggtav+kzfgtav+vgfgtav, mmask, sidematedge,
				0, 0, -1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				7,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				a, 0, 10, sidematedge,
				a-d, kzfgtav-blskzfgtav, 8, sidemat,
				a-d, kzfgtav, 15, sidemat,
				a-d, fuggtav+kzfgtav, 8, sidemat,
				a-d, fuggtav+kzfgtav+blsvgfgtav, 10, sidemat,
				a, fuggtav+kzfgtav+vgfgtav, mmask, sidematedge,
				a, 0, -1, sidematedge

			addz framethick

		next ii

		del nn

		add 0, fuggtav+kzfgtav+vgfgtav,0

	 next w

	del h

	kzfgtav=d/2
	vgfgtav=d/2

	addx d/2

	for ii=1 to nn

		if ii=1 then matside=botmat else matside=topmat

		if h>1 then

			for w=1 to g-1
				tempvalt=d
				for v=1 to h-1
					put -d/2, tempvalt+fuggtav, 10,
						-d/2, tempvalt+fuggtav+kzfgtav+vgfgtav, 15
					tempvalt=tempvalt+fuggtav+kzfgtav+vgfgtav
				next v

				tempvalt=b-d
				for v=1 to h-1
					put d/2, tempvalt-fuggtav, 10,
						d/2,tempvalt-fuggtav-kzfgtav-vgfgtav, 15
					tempvalt=tempvalt-fuggtav-kzfgtav-vgfgtav
				next v

				addx vizsztav+d

				cprism_ topmat, botmat, matside,
					5+nsp/3, framethick,
					-d/2, d, 15,
					get(nsp/2),
					-d/2, b-d, 10,
					d/2, b-d, 15,
					get(nsp),
					d/2, d, 10,
					-d/2, d, -1

			next w

			del g-1

		else

			cprism_ topmat, botmat, matside,
				5, framethick,
				-d/2, d, 15,
				-d/2, b-d, 10,
				 d/2, b-d, 15,
				 d/2, d, 10,
				-d/2, d, -1

		endif

		addz framethick

	next ii

	del nn

	del 1

	gosub 500

	for v=1 to g

		blsvgvztav=d/2
		blskzvztav=d/2
		if v=g then blsvgvztav=0
		if v=1 then blskzvztav=0

		kzvztav=d/2
		vgvztav=d/2
		if v=1 then kzvztav=d
		if v=g then vgvztav=d

		for ii=1 to nn

			gosub 900

			sprism_{2} topmat, botmat, sidemat,
				7,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				0, 0, 10, sidematedge,
				kzvztav-blskzvztav, d, 8, sidemat,
				kzvztav, d, 15, sidemat,
				vizsztav+kzvztav, d, 10, sidemat,
				vizsztav+kzvztav+blsvgvztav, d, 8, sidemat,
				vizsztav+kzvztav+vgvztav, 0, mmask, sidematedge,
				0, 0, -1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				7,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				0, b, 10, sidematedge,
				kzvztav-blskzvztav, b-d, 8, sidemat,
				kzvztav, b-d, 15, sidemat,
				vizsztav+kzvztav, b-d, 10, sidemat,
				vizsztav+kzvztav+blsvgvztav, b-d, 8, sidemat,
				vizsztav+kzvztav+vgvztav, b, mmask, sidematedge,
				0, b, -1, sidematedge

			addz framethick

		next ii

		del nn

		add vizsztav+kzvztav+vgvztav,0,0

	next v

	del g

	for w=1 to h-1
		kzfgtav=d/2
		vgfgtav=d/2
		if w=1 then kzfgtav=d
		if w=h then vgfgtav=d
			add 0, fuggtav+kzfgtav+vgfgtav,0
		for v=1 to g
			kzvztav=d/2
			vgvztav=d/2
			if v=1 then kzvztav=d
			if v=g then vgvztav=d
			add vizsztav+kzvztav+vgvztav,0,0

			for ii=1 to nn

				if ii=1 then matside=botmat else matside=topmat

				cprism_ topmat, botmat, matside,
					5, framethick,
					-vgvztav, d/2, 10,
					-vgvztav, -d/2, 15,
					-vizsztav-vgvztav, -d/2, 10,
					-vizsztav-vgvztav, d/2, 15,
					-vgvztav, d/2, -1

				addz framethick

			next ii

			del nn

		next v
		del g

	next w
	del h-1
	gosub 600
endif


if gs_SashText_typ_num = 2 then

	kzfgtav=d/2
	vgfgtav=d/2

	base

	for ii=1 to nn

		gosub 900

		if h>1 then

			old=d

			for kj=1 to 2
				tempvalt=d
				if kj=2 then old=a-d

				for w=1 to h-1
					put old, tempvalt+fuggtav, 10, sidemat,
						old, tempvalt+fuggtav+kzfgtav+vgfgtav, 15, sidemat
					tempvalt=tempvalt+fuggtav+kzfgtav+vgfgtav
				next w
			next kj

			sprism_{2} topmat, botmat, sidemat,
				5+nsp/2/4,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				0, b-d, mmask, sidematedge,
				0, d, 8, sidematedge,
				d, d, 15, sidemat,
				get(nsp/2),
				d, b-d, 10, sidematedge,
				0, b-d, -1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				5+nsp/4,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				a, b-d, mmask, sidematedge,
				a, d, 8, sidematedge,
				a-d, d, 15, sidemat,
				get(nsp),
				a-d, b-d, 10, sidematedge,
				a, b-d, -1, sidematedge

			gosub 500

		else

			sprism_{2} topmat, botmat, sidemat,
				5+nsp/2/4,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				0, b-d, mmask, sidematedge,
				0, d, 8, sidematedge,
				d, d, 15, sidemat,
				d, b-d, 10, sidematedge,
				0, b-d, -1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				5+nsp/2/4,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				a, b-d, mmask, sidematedge,
				a, d, 8, sidematedge,
				a-d, d, 15, sidemat,
				a-d, b-d, 10, sidematedge,
				a, b-d, -1, sidematedge

			gosub 500

		endif

		addz framethick

	next ii

	del nn


	addx d/2

	for ii=1 to nn

		gosub 900

		if h>1 then
		for w=1 to g-1
			tempvalt=d
			for v=1 to h-1
				put -d/2, tempvalt+fuggtav, 10,
					-d/2, tempvalt+fuggtav+kzfgtav+vgfgtav, 15
				tempvalt=tempvalt+fuggtav+kzfgtav+vgfgtav
			next v

			tempvalt=b-d
			for v=1 to h-1
				put d/2, tempvalt-fuggtav, 10,
					d/2,tempvalt-fuggtav-kzfgtav-vgfgtav, 15
				tempvalt=tempvalt-fuggtav-kzfgtav-vgfgtav
			next v

			addx vizsztav+d

			cprism_ topmat, botmat, sidemat,
				5+nsp/3, framethick,
				-d/2, d, 15,
				get(nsp/2),
				-d/2, b-d, 10,
				 d/2, b-d, mmask,
				 get(nsp),
				 d/2, d, 10,
				-d/2, d, -1

			next w
			del g-1

		else

			cprism_ topmat, botmat, sidemat,
				5, framethick,
				-d/2, d, 15,
				-d/2, b-d, 10,
				 d/2, b-d, mmask,
				 d/2, d, 10,
				-d/2, d, -1

		endif

		addz framethick

	next ii

	del nn


	del 1

	gosub 500

	for ii=1 to nn

		gosub 900

		if g>1 then

			oldd=d

			for kj=1 to 2
				tempvalt=d

				if kj=2 then oldd=b-d

				for v=0 to g-2
					put tempvalt+vizsztav, oldd, 10, sidemat,
						tempvalt+vizsztav+d, oldd, 15, sidemat
					tempvalt=tempvalt+vizsztav+d
				next v
			next kj

			sprism_{2} topmat, botmat, sidemat,
				7+nsp/2/4,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				0, 0, 15, sidematedge,
				0, d, 8, sidematedge,
				d, d, 15, sidemat,
				get(nsp/2),
				a-d, d, 10, sidemat,
				a, d, mmask2, sidematedge,
				a, 0, mmask, sidematedge,
				0, 0, -1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				7+nsp/4,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				0, b, 15, sidematedge,
				0, b-d, 8, sidematedge,
				d, b-d, 15, sidemat,
				get(nsp),
				a-d, b-d, 10, sidemat,
				a, b-d, mmask2, sidematedge,
				a, b, mmask, sidematedge,
				0, b, -1, sidematedge

		else

			sprism_{2} topmat, botmat, sidemat,
				7,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				0, 0, 15, sidematedge,
				0, d, 8, sidematedge,
				d, d, 15, sidemat,
				a-d, d, 10, sidemat,
				a, d, mmask2, sidemat,
				a, 0, mmask, sidematedge,
				0, 0, -1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				7,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				0, b, 15, sidematedge,
				0, b-d, 8, sidematedge,
				d, b-d, 15, sidemat,
				a-d, b-d, 10, sidemat,
				a, b-d, mmask2, sidemat,
				a, b, mmask, sidematedge,
				0, b, -1, sidematedge

		endif

		addz framethick

	next ii

	del nn


	for ii=1 to nn

		gosub 900

		for w=1 to h-1

			addy fuggtav+d

			for v=1 to g

				addx vizsztav+d

				cprism_ topmat, botmat, sidemat,
					5, framethick,
					0, 0, 15,
				   -vizsztav, 0, 10,
				   -vizsztav, d, 15,
					0, d, 10,
					0, 0, -1

			next v
			del g

		next w
		del h-1

		gosub 600

		addz framethick

	next ii

	del nn


endif



body -1
if gs_glass_mat=0 then end

!! GLAZING !!

pen gs_glass_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_glass_pen_cont
material gs_glass_mat
addz c/2-gs_glass_thk/2

for v=0 to g-1
	for w=0 to h-1
		add (v+1)*d+v*i+f, (w+1)*d+w*j+f, 0
		if i-2*f > EPS & j-2*f > EPS then
			block i-2*f, j-2*f, gs_glass_thk
		endif
		body -1
		del 1
	next w
next v

del 2
RETURN

4:
!!!!!******************** DOOR PANEL A !!!!!

goto 3

5:
!!!!!******************** DOVER !!!!!


addx -a/2

a=a+0.138
b=b+0.11

material gs_leaf_mat

gosub 1100

if lod3D = 5 then
	thk = gs_frame_thk
	thk2 = gs_frame_thk
else
	thk = 0.01
	thk2 = 0.026
endif

addz gs_leaf_thk/2-thk/2

base

cprism_ topmat, botmat, sidemat,
	10, thk,
	0.08,0.15,15,
	(A-0.138)/2-0.04,0.15,15,
	(A-0.138)/2-0.04,0.73,15,
	0.08,0.73,15,
	0.08,0.15,-1,
	0.11,0.18,15,
	(A-0.138)/2-0.076,0.18,15,
	(A-0.138)/2-0.076,0.7,15,
	0.11,0.7,15,
	0.11,0.18,-1

cprism_ topmat, botmat, sidemat,
	10, thk,
	(A-0.138)/2+0.04,0.15,15,
	(A-0.138)/2+0.04,0.73,15,
	(A-0.218),0.73,15,
	(A-0.218),0.15,15,
	(A-0.138)/2+0.04,0.15,-1,
	(A-0.138)/2+0.07,0.18,15,
	(A-0.138)/2+0.07,0.7,15,
	(A-0.251),0.7,15,
	(A-0.251),0.18,15,
	(A-0.138)/2+0.07,0.18,-1

cprism_ topmat, botmat, sidemat,
	10, thk,
	0.08,0.88,15,
	(A-0.138)/2-0.04,0.88,15,
	(A-0.138)/2-0.04,B-0.22,15,
	0.08,B-0.22,15,
	0.08,0.88,-1,
	0.11,0.91,15,
	(A-0.138)/2-0.07,0.91,15,
	(A-0.138)/2-0.07,B-0.25,15,
	0.11,B-0.25,15,
	0.11,0.91,-1

cprism_ topmat, botmat, sidemat,
	10, thk,
	(A-0.138)/2+0.04,0.88,15,
	(A-0.138)/2+0.04,B-0.22,15,
	(A-0.218),B-0.22,15,
	(A-0.218),0.88,15,
	(A-0.138)/2+0.04,0.88,-1,
	(A-0.138)/2+0.07,0.91,15,
	(A-0.138)/2+0.07,B-0.25,15,
	(A-0.248),B-0.25,15,
	(A-0.248),0.91,15,
	(A-0.138)/2+0.07,0.91,-1

del 1

thk3 = (thk2-thk)/2

addz gs_leaf_thk/2-thk2/2

cprism_ topmat, botmat, botmat,
	4, thk2-thk3,
	0.11,0.18,15,
	(A-0.138)/2-0.076,0.18,15,
	(A-0.138)/2-0.076,0.7,15,
	0.11,0.7,15

cprism_ topmat, botmat, botmat,
	4, thk2-thk3,
	(A-0.138)/2+0.07,0.18,15,
	(A-0.138)/2+0.07,0.7,15,
	(A-0.251),0.7,15,
	(A-0.251),0.18,15

cprism_ topmat, botmat, botmat,
	4, thk2-thk3,
	0.11,0.91,15,
	(A-0.138)/2-0.07,0.91,15,
	(A-0.138)/2-0.07,B-0.25,15,
	0.11,B-0.25,15

cprism_ topmat, botmat, botmat,
	4, thk2-thk3,
	(A-0.138)/2+0.07,0.91,15,
	(A-0.138)/2+0.07,B-0.25,15,
	(A-0.248),B-0.25,15,
	(A-0.248),0.91,15

if thk3 > EPS then
	material topmat
	addz thk2-thk3
	prism_ 4, thk3,
		0.11,0.18,15,
		(A-0.138)/2-0.076,0.18,15,
		(A-0.138)/2-0.076,0.7,15,
		0.11,0.7,15

	prism_ 4, thk3,
		(A-0.138)/2+0.07,0.18,15,
		(A-0.138)/2+0.07,0.7,15,
		(A-0.251),0.7,15,
		(A-0.251),0.18,15

	prism_ 4, thk3,
		0.11,0.91,15,
		(A-0.138)/2-0.07,0.91,15,
		(A-0.138)/2-0.07,B-0.25,15,
		0.11,B-0.25,15

	prism_ 4, thk3,
		(A-0.138)/2+0.07,0.91,15,
		(A-0.138)/2+0.07,B-0.25,15,
		(A-0.248),B-0.25,15,
		(A-0.248),0.91,15
	del 1
endif

del 2


vert 0.4, 0.3, 0
vert 0.4, 1, 0
vert 1, 0.3, 0
vert 0, 0, 1
coor 2, -1, -2, -3, -4
body 1

RETURN



6:
!!!!!******************** CHATSWORTH !!!!!
addx -a/2
a=a+0.138
b=b+0.11

if lod3D = 5 then
	thk = gs_frame_thk
	thk2 = gs_frame_thk
else
	thk = 0.01
	thk2 = 0.026
endif

material gs_leaf_mat

gosub 1200
addz gs_leaf_thk/2-thk/2

base

cprism_ topmat, botmat, sidemat,
	10, thk,
	0.08,0.15,15,
	(A-0.138)/2-0.04,0.15,15,
	(A-0.138)/2-0.04,0.73,15,
	0.08,0.73,15,
	0.08,0.15,-1,
	0.11,0.18,15,
	(A-0.138)/2-0.07,0.18,15,
	(A-0.138)/2-0.07,0.7,15,
	0.11,0.7,15,
	0.11,0.18,-1

cprism_ topmat, botmat, sidemat,
	10, thk,
	(A-0.138)/2+0.04,0.15,15,
	(A-0.138)/2+0.04,0.73,15,
	(A-0.218),0.73,15,
	(A-0.218),0.15,15,
	(A-0.138)/2+0.04,0.15,-1,
	(A-0.138)/2+0.07,0.18,15,
	(A-0.138)/2+0.07,0.7,15,
	(A-0.248),0.7,15,
	(A-0.248),0.18,15,
	(A-0.138)/2+0.07,0.18,-1

cprism_ topmat, botmat, sidemat,
	10, thk,
	0.08,0.88,15,
	(A-0.138)/2-0.04,0.88,15,
	(A-0.138)/2-0.04,B-0.3-((A-0.316)/2),15,
	0.08,B-0.3-((A-0.316)/2),15,
	0.08,0.88,-1,
	0.11,0.91,15,
	(A-0.138)/2-0.07,0.91,15,
	(A-0.138)/2-0.07,B-0.33-((A-0.316)/2),15,
	0.11,B-0.33-((A-0.316)/2),15,
	0.11,0.91,-1

cprism_ topmat, botmat, sidemat,
	10, thk,
	(A-0.138)/2+0.04,0.88,15,
	(A-0.138)/2+0.04,B-0.3-((A-0.316)/2),15,
	(A-0.218),B-0.3-((A-0.316)/2),15,
	(A-0.218),0.88,15,
	(A-0.138)/2+0.04,0.88,-1,
	(A-0.138)/2+0.07,0.91,15,
	(A-0.138)/2+0.07,B-0.33-((A-0.316)/2),15,
	(A-0.248),B-0.33-((A-0.316)/2),15,
	(A-0.248),0.91,15,
	(A-0.138)/2+0.07,0.91,-1

cprism_ topmat, botmat, sidemat,
	10, thk,
	0.08,B-0.22-((A-0.316)/2),15,
	(A-0.138)/2-0.04,B-0.22-((A-0.316)/2),15,
	(A-0.138)/2-0.04,B-0.22,15,
	0.08,B-0.22,15,
	0.08,B-0.22-((A-0.316)/2),-1,
	0.11,B-0.19-((A-0.316)/2),15,
	(A-0.138)/2-0.07,B-0.19-((A-0.316)/2),15,
	(A-0.138)/2-0.07,B-0.25,15,
	0.11,B-0.25,15,
	0.11,B-0.19-((A-0.316)/2),-1

cprism_ topmat, botmat, sidemat,
	10, thk,
	(A-0.138)/2+0.04,B-0.22-((A-0.316)/2),15,
	(A-0.138)/2+0.04,B-0.22,15,
	(A-0.218),B-0.22,15,
	(A-0.218),B-0.22-((A-0.316)/2),15,
	(A-0.138)/2+0.04,B-0.22-((A-0.316)/2),-1,
	(A-0.138)/2+0.07,B-0.19-((A-0.316)/2),15,
	(A-0.138)/2+0.07,B-0.25,15,
	(A-0.248),B-0.25,15,
	(A-0.248),B-0.19-((A-0.316)/2),15,
	(A-0.138)/2+0.07,B-0.19-((A-0.316)/2),-1

del 1

thk3 = (thk2-thk)/2

addz gs_leaf_thk/2-thk2/2

cprism_ topmat, botmat, botmat,
	4, thk2-thk3,
	0.11,0.18,15,
	(A-0.138)/2-0.07,0.18,15,
	(A-0.138)/2-0.07,0.7,15,
	0.11,0.7,15

cprism_ topmat, botmat, botmat,
	4, thk2-thk3,
	(A-0.138)/2+0.07,0.18,15,
	(A-0.138)/2+0.07,0.7,15,
	(A-0.248),0.7,15,
	(A-0.248),0.18,15

cprism_ topmat, botmat, botmat,
	4, thk2-thk3,
	0.11,0.91,15,
	(A-0.138)/2-0.07,0.91,15,
	(A-0.138)/2-0.07,B-0.33-((A-0.316)/2),15,
	0.11,B-0.33-((A-0.316)/2),15

cprism_ topmat, botmat, botmat,
	4, thk2-thk3,
	(A-0.138)/2+0.07,0.91,15,
	(A-0.138)/2+0.07,B-0.33-((A-0.316)/2),15,
	(A-0.248),B-0.33-((A-0.316)/2),15,
	(A-0.248),0.91,15

cprism_ topmat, botmat, botmat,
	4, thk2-thk3,
	0.11,B-0.19-((A-0.316)/2),15,
	(A-0.138)/2-0.07,B-0.19-((A-0.316)/2),15,
	(A-0.138)/2-0.07,B-0.25,15,
	0.11,B-0.25,15

cprism_ topmat, botmat, botmat,
	4, thk2-thk3,
	(A-0.138)/2+0.07,B-0.19-((A-0.316)/2),15,
	(A-0.138)/2+0.07,B-0.25,15,
	(A-0.248),B-0.25,15,
	(A-0.248),B-0.19-((A-0.316)/2),15

if thk3 > EPS then
	material topmat
	addz thk2-thk3
	prism_ 4, thk3,
		0.11,0.18,15,
		(A-0.138)/2-0.07,0.18,15,
		(A-0.138)/2-0.07,0.7,15,
		0.11,0.7,15

	prism_ 4, thk3,
		(A-0.138)/2+0.07,0.18,15,
		(A-0.138)/2+0.07,0.7,15,
		(A-0.248),0.7,15,
		(A-0.248),0.18,15

	prism_ 4, thk3,
		0.11,0.91,15,
		(A-0.138)/2-0.07,0.91,15,
		(A-0.138)/2-0.07,B-0.33-((A-0.316)/2),15,
		0.11,B-0.33-((A-0.316)/2),15

	prism_ 4, thk3,
		(A-0.138)/2+0.07,0.91,15,
		(A-0.138)/2+0.07,B-0.33-((A-0.316)/2),15,
		(A-0.248),B-0.33-((A-0.316)/2),15,
		(A-0.248),0.91,15

	prism_ 4, thk3,
		0.11,B-0.19-((A-0.316)/2),15,
		(A-0.138)/2-0.07,B-0.19-((A-0.316)/2),15,
		(A-0.138)/2-0.07,B-0.25,15,
		0.11,B-0.25,15

	prism_ 4, thk3,
		(A-0.138)/2+0.07,B-0.19-((A-0.316)/2),15,
		(A-0.138)/2+0.07,B-0.25,15,
		(A-0.248),B-0.25,15,
		(A-0.248),B-0.19-((A-0.316)/2),15
	del 1
endif

del 2

vert 0.4, 0.3, 0
vert 0.4, 1, 0
vert 1, 0.3, 0
vert 0, 0, 1
coor 2, -1, -2, -3, -4
body 1

RETURN



7:
!!!!!******************** PROVINCIAL !!!!!


addx -a/2

a=a+0.138
b=b+0.11

if lod3D = 5 then
	thk = gs_frame_thk
	thk2 = gs_frame_thk
else
	thk = 0.01
	thk2 = 0.026
endif

material gs_leaf_mat

archWidth = (A-0.138)/2-0.08-0.04
R1 = (archWidth/3) / sin(30)
R2 = (2*archWidth/3) / sin(30)

H1 = R1 - (archWidth/3) / tan(30)
H2 = R2 - (2*archWidth/3) / tan(30)
topPos = B - 0.21
shoulderPos = topPos - H1 - H2

if gs_SashText_typ_num = 1 then

	base

	for ii=1 to nn

		gosub 900

		sprism_{2} topmat, botmat, sidemat,
			7,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0,10, sidematedge,
			0.08,0.15,15, sidemat,
			0.08,0.73,10, sidemat,
			0.08,0.88,15, sidemat,
			0.08,shoulderPos,10, sidemat,
			0,B-0.11,mmask, sidematedge,
			0,0,-1, sidematedge

		sprism_{2} topmat, botmat, sidemat,
			7,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			A-0.138,0,10, sidematedge,
			A-0.218,0.15,15, sidemat,
			A-0.218,0.73,10, sidemat,
			A-0.218,0.88,15, sidemat,
			A-0.218,shoulderPos,10, sidemat,
			A-0.138,B-0.11,mmask, sidematedge,
			A-0.138,0,-1, sidematedge

		gosub 500

		sprism_{2} topmat, botmat, sidemat,
			15,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,B-0.11,10, sidematedge,
			0,shoulderPos,8, sidematedge,
			0.08,shoulderPos,79, sidemat,
			0.08,shoulderPos + R1, 979, sidemat,
			0,30,4079, sidemat,
			(A-0.138)/2-0.04, topPos - R2, 915, sidemat,
			0,-30,4010, sidemat,
			(A-0.138)/2+0.04,topPos,79, sidemat,
			(A-0.138)/2+0.04,topPos - R2,915, sidemat,
			0,-30,4079, sidemat,
			A-0.218,shoulderPos + R1,915, sidemat,
			0,30,4010, sidemat,
			A-0.138,shoulderPos,mmask2, sidematedge,
			A-0.138,B-0.11,mmask, sidematedge,
			0,B-0.11,-1, sidematedge

		sprism_{2} topmat, botmat, sidemat,
			7,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0,10, sidematedge,
			0.08,0.15,15, sidemat,
			(A-0.138)/2-0.04,0.15,10, sidemat,
			(A-0.138)/2+0.04,0.15,15, sidemat,
			A-0.218,0.15,10, sidemat,
			A-0.138,0,mmask, sidematedge,
			0,0,-1, sidematedge

		gosub 600

		addz framethick

	next ii

	del nn

endif



if gs_SashText_typ_num = 2 then

	base

	for ii=1 to nn

		gosub 900

		sprism_{2} topmat, botmat, sidemat,
			7,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0.15,8, sidematedge,
			0.08,0.15,15, sidemat,
			0.08,0.73,10, sidemat,
			0.08,0.88,15, sidemat,
			0.08,shoulderPos,10, sidemat,
			0,shoulderPos,mmask2, sidematedge,
			0,0.15,-1, sidematedge

		sprism_{2} topmat, botmat, sidemat,
			7,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			A-0.138,0.15,8, sidematedge,
			A-0.218,0.15,15, sidemat,
			A-0.218,0.73,10, sidemat,
			A-0.218,0.88,15, sidemat,
			A-0.218,shoulderPos,10, sidemat,
			A-0.138,shoulderPos,mmask2, sidematedge,
			A-0.138,0.15,-1, sidematedge

		gosub 500

		sprism_{2} topmat, botmat, sidemat,
			15,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,B-0.11,15, sidematedge,
			0,shoulderPos,8, sidematedge,
			0.08,shoulderPos,79, sidemat,
			0.08,shoulderPos + R1, 979, sidemat,
			0,30,4079, sidemat,
			(A-0.138)/2-0.04, topPos - R2, 915, sidemat,
			0,-30,4010, sidemat,
			(A-0.138)/2+0.04,topPos,79, sidemat,
			(A-0.138)/2+0.04,topPos - R2,915, sidemat,
			0,-30,4079, sidemat,
			A-0.218,shoulderPos + R1,915, sidemat,
			0,30,4010, sidemat,
			A-0.138,shoulderPos,mmask2, sidematedge,
			A-0.138,B-0.11,mmask, sidematedge,
			0,B-0.11,-1, sidematedge

		sprism_{2} topmat, botmat, sidemat,
			9,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0,15, sidematedge,
			0,0.15,8, sidemat,
			0.08,0.15,15, sidemat,
			(A-0.138)/2-0.04,0.15,10, sidemat,
			(A-0.138)/2+0.04,0.15,15, sidemat,
			A-0.218,0.15,10, sidemat,
			A-0.138,0.15,mmask2, sidematedge,
			A-0.138,0,mmask, sidematedge,
			0,0,-1, sidematedge

		gosub 600


	addz framethick

next ii

del nn


endif


!************* both in type 1 and type 2

base

for ii=1 to nn

	gosub 900

	sprism_{2} topmat, botmat, sidemat,
		9,
		0,  0,  1,  0,  framethick, 0,
		0,  0,  1,  0,   0,  0,
		(A-0.138)/2-0.04,0.15,10, sidematedge,
		(A-0.138)/2+0.04,0.15,15, sidemat,
		(A-0.138)/2+0.04,0.73,10, sidemat,
		(A-0.138)/2+0.04,0.88,15, sidemat,
		(A-0.138)/2+0.04,topPos,10, sidemat,
		(A-0.138)/2-0.04,topPos,15, sidemat,
		(A-0.138)/2-0.04,0.88,10, sidemat,
		(A-0.138)/2-0.04,0.73,mmask, sidematedge,
		(A-0.138)/2-0.04,0.15,-1, sidematedge

	gosub 500

	sprism_{2} topmat, botmat, sidemat,
		5,
		0,  0,  1,  0,  framethick, 0,
		0,  0,  1,  0,   0,  0,
		0.08,0.73,10, sidematedge,
		0.08,0.88,15, sidemat,
		(A-0.138)/2-0.04,0.88,10, sidemat,
		(A-0.138)/2-0.04,0.73,mmask, sidematedge,
		0.08,0.73,-1, sidematedge

	sprism_{2} topmat, botmat, sidemat,
		5,
		0,  0,  1,  0,  framethick, 0,
		0,  0,  1,  0,   0,  0,
		A-0.218,0.73,10, sidematedge,
		A-0.218,0.88,15, sidemat,
		(A-0.138)/2+0.04,0.88,10, sidemat,
		(A-0.138)/2+0.04,0.73,mmask, sidematedge,
		A-0.218,0.73,-1, sidematedge

	gosub 600

	addz framethick

next ii

del nn


addz gs_leaf_thk/2-thk/2

cprism_ topmat, botmat, sidemat,
	10, thk,
	0.08,0.15,15,
	(A-0.138)/2-0.04,0.15,15,
	(A-0.138)/2-0.04,0.73,15,
	0.08,0.73,15,
	0.08,0.15,-1,
	0.11,0.18,15,
	(A-0.138)/2-0.076,0.18,15,
	(A-0.138)/2-0.076,0.7,15,
	0.11,0.7,15,
	0.11,0.18,-1

cprism_ topmat, botmat, sidemat,
	10, thk,
	(A-0.138)/2+0.04,0.15,15,
	(A-0.138)/2+0.04,0.73,15,
	(A-0.218),0.73,15,
	(A-0.218),0.15,15,
	(A-0.138)/2+0.04,0.15,-1,
	(A-0.138)/2+0.07,0.18,15,
	(A-0.138)/2+0.07,0.7,15,
	(A-0.251),0.7,15,
	(A-0.251),0.18,15,
	(A-0.138)/2+0.07,0.18,-1

cprism_ topmat, botmat, sidemat,
	15, thk,
	0.08,0.88,15,
	0.08,shoulderPos,79,
	0.08,shoulderPos + R1,915,
	0,30,4079,
	(A-0.138)/2-0.04,topPos - R2,915,
	0,-30,4015,
	(A-0.138)/2-0.04,0.88,15,
	0.08,0.88,-1,
	0.11,0.91,15,
	0.11,shoulderPos - sqr((R1 + 0.03)^2 - 0.03^2) + R1,79,
	0.08,shoulderPos + R1,915,
	0.08 + (R1 + 0.03) * sin(30), shoulderPos + R1 - (R1 + 0.03) * cos(30), 3079,
	(A-0.138)/2-0.07,topPos + sqr((R2 - 0.03)^2 - 0.03^2) - R2,1079,
	(A-0.138)/2-0.07,0.91,15,
	0.11,0.91,-1

cprism_ topmat, botmat, sidemat,
	15, thk,
	(A-0.138)/2+0.04,0.88,15,
	(A-0.218),0.88,15,
	(A-0.218),shoulderPos,79,
	(A-0.218),shoulderPos + R1,915,
	0,-30,4079,
	(A-0.138)/2+0.04,topPos - R2,915,
	0,30,4015,
	(A-0.138)/2+0.04,0.88,-1,
	(A-0.138)/2+0.07,0.91,15,
	(A-0.248),0.91,15,
	(A-0.248),shoulderPos - sqr((R1 + 0.03)^2 - 0.03^2) + R1,79,
	(A-0.218),shoulderPos + R1,915,
	(A-0.218) - (R1 + 0.03) * sin(30), shoulderPos + R1 - (R1 + 0.03) * cos(30), 3079,
	(A-0.138)/2+0.07,topPos + sqr((R2 - 0.03)^2 - 0.03^2) - R2,1079,
	(A-0.138)/2+0.07,0.91,-1

del 1

thk3 = (thk2-thk)/2

addz gs_leaf_thk/2-thk2/2

cprism_ topmat, botmat, botmat,
	5, thk2-thk3,
	0.11,0.18,15,
	(A-0.138)/2-0.076,0.18,15,
	(A-0.138)/2-0.076,0.7,15,
	0.11,0.7,15,
	0.11,0.18,15

cprism_ topmat, botmat, botmat,
	5, thk2-thk3,
	(A-0.138)/2+0.07,0.18,15,
	(A-0.138)/2+0.07,0.7,15,
	(A-0.251),0.7,15,
	(A-0.251),0.18,15,
	(A-0.138)/2+0.07,0.18,15

cprism_ topmat, botmat, botmat,
	7, thk2-thk3,
	0.11,0.91,15,
	0.11,shoulderPos - sqr((R1 + 0.03)^2 - 0.03^2) + R1,79,
	0.08,shoulderPos + R1,979,
	0.08 + (R1 + 0.03) * sin(30), shoulderPos + R1 - (R1 + 0.03) * cos(30), 3079,
	(A-0.138)/2-0.07,topPos + sqr((R2 - 0.03)^2 - 0.03^2) - R2,1079,
	(A-0.138)/2-0.07,0.91,15,
	0.11,0.91,15

cprism_ topmat, botmat, botmat,
	7, thk2-thk3,
	(A-0.138)/2+0.07,0.91,15,
	(A-0.248),0.91,15,
	(A-0.248),shoulderPos - sqr((R1 + 0.03)^2 - 0.03^2) + R1,79,
	(A-0.218),shoulderPos + R1,915,
	(A-0.218) - (R1 + 0.03) * sin(30), shoulderPos + R1 - (R1 + 0.03) * cos(30), 3079,
	(A-0.138)/2+0.07,topPos + sqr((R2 - 0.03)^2 - 0.03^2) - R2,1079,
	(A-0.138)/2+0.07,0.91,-1

if thk3 > EPS then
	material topmat
	addz thk2-thk3
	prism_ 5, thk3,
		0.11,0.18,15,
		(A-0.138)/2-0.076,0.18,15,
		(A-0.138)/2-0.076,0.7,15,
		0.11,0.7,15,
		0.11,0.18,15

	prism_ 5, thk3,
		(A-0.138)/2+0.07,0.18,15,
		(A-0.138)/2+0.07,0.7,15,
		(A-0.251),0.7,15,
		(A-0.251),0.18,15,
		(A-0.138)/2+0.07,0.18,15

	prism_ 7, thk3,
		0.11,0.91,15,
		0.11,shoulderPos - sqr((R1 + 0.03)^2 - 0.03^2) + R1,79,
		0.08,shoulderPos + R1,979,
		0.08 + (R1 + 0.03) * sin(30), shoulderPos + R1 - (R1 + 0.03) * cos(30), 3079,
		(A-0.138)/2-0.07,topPos + sqr((R2 - 0.03)^2 - 0.03^2) - R2,1079,
		(A-0.138)/2-0.07,0.91,15,
		0.11,0.91,15

	prism_ 7, thk3,
		(A-0.138)/2+0.07,0.91,15,
		(A-0.248),0.91,15,
		(A-0.248),shoulderPos - sqr((R1 + 0.03)^2 - 0.03^2) + R1,79,
		(A-0.218),shoulderPos + R1,915,
		(A-0.218) - (R1 + 0.03) * sin(30), shoulderPos + R1 - (R1 + 0.03) * cos(30), 3079,
		(A-0.138)/2+0.07,topPos + sqr((R2 - 0.03)^2 - 0.03^2) - R2,1079,
		(A-0.138)/2+0.07,0.91,-1
	del 1
endif

del 1

gosub 500


RETURN


8:
!!!!!******************** ORLEANS !!!!!


addx -a/2

a=a+0.138
b=b+0.11

if lod3D = 5 then
	thk = gs_frame_thk
	thk2 = gs_frame_thk
else
	thk = 0.01
	thk2 = 0.026
endif

body -1
material gs_leaf_mat

gosub 1100


addz gs_leaf_thk/2-thk/2
body -1

base
material gs_leaf_mat3

prism_ 10,thk,
	0.08,0.15,15,
	(A-0.138)/2-0.04,0.15,15,
	(A-0.138)/2-0.04,0.73,15,
	0.08,0.73,15,
	0.08,0.15,-1,
	0.11,0.18,15,
	(A-0.138)/2-0.076,0.18,15,
	(A-0.138)/2-0.076,0.7,15,
	0.11,0.7,15,
	0.11,0.18,-1

prism_ 10,thk,
	(A-0.138)/2+0.04,0.15,15,
	(A-0.138)/2+0.04,0.73,15,
	(A-0.218),0.73,15,
	(A-0.218),0.15,15,
	(A-0.138)/2+0.04,0.15,-1,
	(A-0.138)/2+0.07,0.18,15,
	(A-0.138)/2+0.07,0.7,15,
	(A-0.251),0.7,15,
	(A-0.251),0.18,15,
	(A-0.138)/2+0.07,0.18,-1

prism_ 10,thk,
	0.08,0.88,15,
	(A-0.138)/2-0.04,0.88,15,
	(A-0.138)/2-0.04,B-0.22,15,
	0.08,B-0.22,15,
	0.08,0.88,-1,
	0.11,0.91,15,
	(A-0.138)/2-0.07,0.91,15,
	(A-0.138)/2-0.07,B-0.25,15,
	0.11,B-0.25,15,
	0.11,0.91,-1

prism_ 10,thk,
	(A-0.138)/2+0.04,0.88,15,
	(A-0.138)/2+0.04,B-0.22,15,
	(A-0.218),B-0.22,15,
	(A-0.218),0.88,15,
	(A-0.138)/2+0.04,0.88,-1,
	(A-0.138)/2+0.07,0.91,15,
	(A-0.138)/2+0.07,B-0.25,15,
	(A-0.248),B-0.25,15,
	(A-0.248),0.91,15,
	(A-0.138)/2+0.07,0.91,-1

del 1
body -1

material gs_leaf_mat2
addz gs_leaf_thk/2-thk2/2

prism_ 4,thk2,
	0.11,0.18,15,
	(A-0.138)/2-0.076,0.18,15,
	(A-0.138)/2-0.076,0.7,15,
	0.11,0.7,15

prism_ 4,thk2,
	(A-0.138)/2+0.07,0.18,15,
	(A-0.138)/2+0.07,0.7,15,
	(A-0.251),0.7,15,
	(A-0.251),0.18,15

prism_ 4,thk2,
	0.11,0.91,15,
	(A-0.138)/2-0.07,0.91,15,
	(A-0.138)/2-0.07,B-0.25,15,
	0.11,B-0.25,15

prism_ 4,thk2,
	 (A-0.138)/2+0.07,0.91,15,
	(A-0.138)/2+0.07,B-0.25,15,
	(A-0.248),B-0.25,15,
	(A-0.248),0.91,15

del 2

gosub 500

RETURN

9:
!!!!!******************** AUSTEN !!!!!


addx -a/2

a=a+0.138
b=b+0.11

if lod3D = 5 then
	thk = gs_frame_thk
	thk2 = gs_frame_thk
else
	thk = 0.01
	thk2 = 0.026
endif

pen gs_leaf_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_leaf_pen_cont
material gs_leaf_mat

gosub 1200

body -1
material gs_leaf_mat2
addz gs_leaf_thk/2-thk/2

base

prism_ 10,thk,
	0.08,0.15,15,
	(A-0.138)/2-0.04,0.15,15,
	(A-0.138)/2-0.04,0.73,15,
	0.08,0.73,15,
	0.08,0.15,-1,
	0.11,0.18,15,
	(A-0.138)/2-0.076,0.18,15,
	(A-0.138)/2-0.076,0.7,15,
	0.11,0.7,15,
	0.11,0.18,-1

prism_ 10,thk,
	(A-0.138)/2+0.04,0.15,15,
	(A-0.138)/2+0.04,0.73,15,
	(A-0.218),0.73,15,
	(A-0.218),0.15,15,
	(A-0.138)/2+0.04,0.15,-1,
	(A-0.138)/2+0.07,0.18,15,
	(A-0.138)/2+0.07,0.7,15,
	(A-0.251),0.7,15,
	(A-0.251),0.18,15,
	(A-0.138)/2+0.07,0.18,-1

prism_ 10,thk,
	0.08,0.88,15,
	(A-0.138)/2-0.04,0.88,15,
	(A-0.138)/2-0.04,B-0.3-((A-0.316)/2),15,
	0.08,B-0.3-((A-0.316)/2),15,
	0.08,0.88,-1,
	0.11,0.91,15,
	(A-0.138)/2-0.07,0.91,15,
	(A-0.138)/2-0.07,B-0.33-((A-0.316)/2),15,
	0.11,B-0.33-((A-0.316)/2),15,
	0.11,0.91,-1

prism_ 10,thk,
	(A-0.138)/2+0.04,0.88,15,
	(A-0.138)/2+0.04,B-0.3-((A-0.316)/2),15,
	(A-0.218),B-0.3-((A-0.316)/2),15,
	(A-0.218),0.88,15,
	(A-0.138)/2+0.04,0.88,-1,
	(A-0.138)/2+0.07,0.91,15,
	(A-0.138)/2+0.07,B-0.33-((A-0.316)/2),15,
	(A-0.248),B-0.33-((A-0.316)/2),15,
	(A-0.248),0.91,15,
	(A-0.138)/2+0.07,0.91,-1

prism_ 10,thk,
	0.08,B-0.22-((A-0.316)/2),15,
	(A-0.138)/2-0.04,B-0.22-((A-0.316)/2),15,
	(A-0.138)/2-0.04,B-0.22,15,
	0.08,B-0.22,15,
	0.08,B-0.22-((A-0.316)/2),-1,
	0.11,B-0.19-((A-0.316)/2),15,
	(A-0.138)/2-0.07,B-0.19-((A-0.316)/2),15,
	(A-0.138)/2-0.07,B-0.25,15,
	0.11,B-0.25,15,
	0.11,B-0.19-((A-0.316)/2),-1

prism_ 10,thk,
	(A-0.138)/2+0.04,B-0.22-((A-0.316)/2),15,
	(A-0.138)/2+0.04,B-0.22,15,
	(A-0.218),B-0.22,15,
	(A-0.218),B-0.22-((A-0.316)/2),15,
	(A-0.138)/2+0.04,B-0.22-((A-0.316)/2),-1,
	(A-0.138)/2+0.07,B-0.19-((A-0.316)/2),15,
	(A-0.138)/2+0.07,B-0.25,15,
	(A-0.248),B-0.25,15,
	(A-0.248),B-0.19-((A-0.316)/2),15,
	(A-0.138)/2+0.07,B-0.19-((A-0.316)/2),-1

del 1

body -1

material gs_leaf_mat3

addz gs_leaf_thk/2-thk2/2

prism_ 4, thk2,
	0.11,0.18,15,
	(A-0.138)/2-0.076,0.18,15,
	(A-0.138)/2-0.076,0.7,15,
	0.11,0.7,15

prism_ 4, thk2,
	(A-0.138)/2+0.07,0.18,15,
	(A-0.138)/2+0.07,0.7,15,
	(A-0.251),0.7,15,
	(A-0.251),0.18,15

prism_ 4, thk2,
	0.11,0.91,15,
	(A-0.138)/2-0.07,0.91,15,
	(A-0.138)/2-0.07,B-0.33-((A-0.316)/2),15,
	0.11,B-0.33-((A-0.316)/2),15

prism_ 4, thk2,
	(A-0.138)/2+0.07,0.91,15,
	(A-0.138)/2+0.07,B-0.33-((A-0.316)/2),15,
	(A-0.248),B-0.33-((A-0.316)/2),15,
	(A-0.248),0.91,15

prism_ 4, thk2,
	0.11,B-0.19-((A-0.316)/2),15,
	(A-0.138)/2-0.07,B-0.19-((A-0.316)/2),15,
	(A-0.138)/2-0.07,B-0.25,15,
	0.11,B-0.25,15

prism_ 4, thk2,
	(A-0.138)/2+0.07,B-0.19-((A-0.316)/2),15,
	(A-0.138)/2+0.07,B-0.25,15,
	(A-0.248),B-0.25,15,
	(A-0.248),B-0.19-((A-0.316)/2),15

del 2

gosub 500

RETURN


10:
!!!!!******************** VERSAILLES !!!!!

addx -a/2

a=a+0.138
b=b+0.11

if lod3D = 5 then
	thk = gs_frame_thk
	thk2 = gs_frame_thk
else
	thk = 0.01
	thk2 = 0.026
endif

material gs_leaf_mat

if gs_SashText_typ_num = 1 then

	base

	for ii=1 to nn

		gosub 900

		sprism_{2} topmat, botmat, sidemat,
			9,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0,10, sidematedge,
			0.08,0.15,15, sidemat,
			0.08,0.65,10, sidemat,
			0.08,0.73,15, sidemat,
			0.08,0.88,10, sidemat,
			0.08,0.96,15, sidemat,
			0.08,B-0.22,10, sidemat,
			0,B-0.11,mmask, sidematedge,
			0,0,-1, sidematedge

		sprism_{2} topmat, botmat, sidemat,
			9,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			A-0.138,0,10, sidematedge,
			A-0.218,0.15,15, sidemat,
			A-0.218,0.65,10, sidemat,
			A-0.218,0.73,15, sidemat,
			A-0.218,0.88,10, sidemat,
			A-0.218,0.96,15, sidemat,
			A-0.218,B-0.22,10, sidemat,
			A-0.138,B-0.11,mmask, sidematedge,
			A-0.138,0,-1, sidematedge

		gosub 500

		sprism_{2} topmat, botmat, sidemat,
			5,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0,10, sidematedge,
			0.08,0.15,15, sidematedge,
			A-0.218,0.15,10, sidemat,
			A-0.138,0,mmask, sidemat,
			0,0,-1, sidematedge

		sprism_{2} topmat, botmat, sidemat,
			5,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,B-0.11,10, sidematedge,
			0.08,B-0.22,15, sidemat,
			A-0.218,B-0.22,10, sidemat,
			A-0.138,B-0.11,mmask, sidematedge,
			0,B-0.11,-1, sidematedge

		gosub 600

		addz framethick

	next ii

	del nn

endif


if gs_SashText_typ_num = 2 then

	base

	for ii=1 to nn

		gosub 900

		sprism_{2} topmat, botmat, sidemat,
			9,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0.15,8, sidematedge,
			0.08,0.15,15, sidemat,
			0.08,0.65,10, sidemat,
			0.08,0.73,15, sidemat,
			0.08,0.88,10, sidemat,
			0.08,0.96,15, sidemat,
			0.08,B-0.22,10, sidemat,
			0,B-0.22,13, sidematedge,
			0,0.15,-1, sidematedge

		sprism_{2} topmat, botmat, sidemat,
			9,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			A-0.138,0.15,8, sidematedge,
			A-0.218,0.15,15, sidemat,
			A-0.218,0.65,10, sidemat,
			A-0.218,0.73,15, sidemat,
			A-0.218,0.88,10, sidemat,
			A-0.218,0.96,15, sidemat,
			A-0.218,B-0.22,10, sidemat,
			A-0.138,B-0.22,mmask2, sidematedge,
			A-0.138,0.15,-1, sidematedge

		gosub 500

		sprism_{2} topmat, botmat, sidemat,
			7,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0,15, sidematedge,
			0,0.15,8, sidematedge,
			0.08,0.15,15, sidemat,
			A-0.218,0.15,10, sidemat,
			A-0.138,0.15,mmask2, sidematedge,
			A-0.138,0,mmask, sidematedge,
			0,0,-1, sidematedge

		sprism_{2} topmat, botmat, sidemat,
			7,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,B-0.11,15, sidematedge,
			0,B-0.22,8, sidematedge,
			0.08,B-0.22,15, sidemat,
			A-0.218,B-0.22,10, sidemat,
			A-0.138,B-0.22,mmask2, sidematedge,
			A-0.138,B-0.11,mmask, sidematedge,
			0,B-0.11,-1, sidematedge

		gosub 600

		addz framethick

	next ii

	del nn

endif


!******************* Both in type 1 and type 2

base

for ii=1 to nn

	gosub 900

	cprism_ topmat, botmat, sidemat,
		5, framethick,
		0.08,0.65,10,
		0.08,0.73,15,
		A-0.218,0.73,10,
		A-0.218,0.65,15,
		0.08,0.65,-1

	cprism_ topmat, botmat, sidemat,
		5, framethick,
		0.08,0.88,10,
		0.08,0.96,15,
		A-0.218,0.96,10,
		A-0.218,0.88,15,
		0.08,0.88,-1

	gosub 600

	addz framethick

next ii

del nn


body -1


addz gs_leaf_thk/2-thk/2

material gs_leaf_mat2

base

prism_ 10,thk,
	0.08,0.15,15,
	(A-0.218),0.15,15,
	(A-0.218),0.65,15,
	0.08,0.65,15,
	0.08,0.15,-1,
	0.11,0.18,15,
	(A-0.251),0.18,15,
	(A-0.251),0.62,15,
	0.11,0.62,15,
	0.11,0.18,-1

prism_ 10,thk,
	0.08,0.73,15,
	(A-0.218),0.73,15,
	(A-0.218),0.88,15,
	0.08,0.88,15,
	0.08,0.73,-1,
	0.11,0.76,15,
	(A-0.248),0.76,15,
	(A-0.248),0.85,15,
	0.11,0.85,15,
	0.11,0.76,-1

prism_ 10,thk,
	0.08,0.96,15,
	(A-0.218),0.96,15,
	(A-0.218),B-0.22,15,
	0.08,B-0.22,15,
	0.08,0.96,-1,
	0.11,0.99,15,
	(A-0.248),0.99,15,
	(A-0.248),B-0.25,15,
	0.11,B-0.25,15,
	0.11,0.99,-1

del 1
body -1


material gs_leaf_mat3

addz gs_leaf_thk/2-thk2/2

prism_ 4,thk2,
	0.11,0.18,15,
	(A-0.251),0.18,15,
	(A-0.251),0.62,15,
	0.11,0.62,15

prism_ 4,thk2,
	 0.11,0.76,15,
	(A-0.248),0.76,15,
	(A-0.248),0.85,15,
	0.11,0.85,15

prism_ 4,thk2,
	0.11,0.99,15,
	(A-0.248),0.99,15,
	(A-0.248),B-0.25,15,
	0.11,B-0.25,15

gosub 600

body -1
del 2

RETURN


11:
!!!!!******************** BRONTE !!!!!

addx -a/2

a=a+0.138
b=b+0.11

if lod3D = 5 then
	thk = gs_frame_thk
	thk2 = gs_frame_thk
else
	thk = 0.01
	thk2 = 0.026
endif

material gs_leaf_mat

for ii=1 to nn

	gosub 900

	if gs_SashText_typ_num = 1 then

		base

		sprism_{2} topmat, botmat, sidemat,
			9,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0,10, sidematedge,
			0.08,0.15,15, sidemat,
			0.08,0.65,10, sidemat,
			0.08,0.73,15, sidemat,
			0.08,0.88,10, sidemat,
			0.08,0.96,15, sidemat,
			0.08,B-0.22,10, sidemat,
			0,B-0.11,15, sidematedge,
			0,0,-1, sidematedge

		sprism_{2} topmat, botmat, sidemat,
			9,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			A-0.138,0,10, sidematedge,
			A-0.218,0.15,15, sidemat,
			A-0.218,0.65,10, sidemat,
			A-0.218,0.73,15, sidemat,
			A-0.218,0.88,10, sidemat,
			A-0.218,0.96,15, sidemat,
			A-0.218,B-0.22,10, sidemat,
			A-0.138,B-0.11,mmask, sidematedge,
			A-0.138,0,-1, sidematedge

		gosub 500

		sprism_{2} topmat, botmat, sidemat,
			7,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0,10, sidemat,
			0.08,0.15,15, sidemat,
			(A-0.138)/2-0.04,0.15,10, sidemat,
			(A-0.138)/2+0.04,0.15,15, sidemat,
			A-0.218,0.15,10, sidemat,
			A-0.138,0,mmask, sidematedge,
			0,0,-1, sidemat

		sprism_{2} topmat, botmat, sidemat,
			7,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,B-0.11,10, sidemat,
			0.08,B-0.22,15, sidemat,
			(A-0.138)/2-0.04,B-0.22,10, sidemat,
			(A-0.138)/2+0.04,B-0.22,15, sidemat,
			A-0.218,B-0.22,10, sidemat,
			A-0.138,B-0.11,mmask, sidematedge,
			0,B-0.11,-1, sidemat

		gosub 600

	endif

	if gs_SashText_typ_num = 2 then

		base

		sprism_{2} topmat, botmat, sidemat,
			9,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0.15,8, sidematedge,
			0.08,0.15,15, sidemat,
			0.08,0.65,10, sidemat,
			0.08,0.73,15, sidemat,
			0.08,0.88,10, sidemat,
			0.08,0.96,15, sidemat,
			0.08,B-0.22,10, sidemat,
			0,B-0.22,mmask2, sidematedge,
			0,0.15,-1, sidematedge

		sprism_{2} topmat, botmat, sidemat,
			9,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			A-0.138,0.15,8, sidematedge,
			A-0.218,0.15,15, sidemat,
			A-0.218,0.65,10, sidemat,
			A-0.218,0.73,15, sidemat,
			A-0.218,0.88,10, sidemat,
			A-0.218,0.96,15, sidemat,
			A-0.218,B-0.22,10, sidemat,
			A-0.138,B-0.22,mmask2, sidematedge,
			A-0.138,0.15,-1, sidematedge

		gosub 500

		sprism_{2} topmat, botmat, sidemat,
			9,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0,15, sidematedge,
			0,0.15,8, sidemat,
			0.08,0.15,15, sidemat,
			(A-0.138)/2-0.04,0.15,10, sidemat,
			(A-0.138)/2+0.04,0.15,15, sidemat,
			A-0.218,0.15,10, sidemat,
			A-0.138,0.15,mmask2, sidematedge,
			A-0.138,0,mmask, sidematedge,
			0,0,-1, sidematedge

		sprism_{2} topmat, botmat, sidemat,
			9,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,B-0.11,15, sidematedge,
			0,B-0.22,8, sidemat,
			0.08,B-0.22,15, sidemat,
			(A-0.138)/2-0.04,B-0.22,10, sidemat,
			(A-0.138)/2+0.04,B-0.22,15, sidemat,
			A-0.218,B-0.22,10, sidemat,
			A-0.138,B-0.22,mmask2, sidematedge,
			A-0.138,B-0.11,mmask, sidematedge,
			0,B-0.11,-1, sidematedge

		gosub 600

	endif

	addz framethick

next ii

del nn



!********** Both in type 1 and type 2

base

for ii=1 to nn

	gosub 900

	cprism_ topmat, botmat, sidemat,
		5, framethick,
		(A-0.138)/2-0.04,0.15,10,
		(A-0.138)/2+0.04,0.15,15,
		(A-0.138)/2+0.04,0.65,10,
		(A-0.138)/2-0.04,0.65,15,
		(A-0.138)/2-0.04,0.15,-1

	cprism_ topmat, botmat, sidemat,
		5, framethick,
		(A-0.138)/2-0.04,0.96,10,
		(A-0.138)/2+0.04,0.96,15,
		(A-0.138)/2+0.04,B-0.22,10,
		(A-0.138)/2-0.04,B-0.22,15,
		(A-0.138)/2-0.04,0.96,-1

	gosub 500

	cprism_ topmat, botmat, sidemat,
		7, framethick,
		0.08,0.65,10,
		0.08,0.73,15,
		A-0.218,0.73,10,
		A-0.218,0.65,15,
		(A-0.138)/2+0.04,0.65,10,
		(A-0.138)/2-0.04,0.65,15,
		0.08,0.65,-1

	cprism_ topmat, botmat, sidemat,
		7, framethick,
		0.08,0.96,10,
		0.08,0.88,15,
		A-0.218,0.88,10,
		A-0.218,0.96,15,
		(A-0.138)/2+0.04,0.96,10,
		(A-0.138)/2-0.04,0.96,15,
		0.08,0.96,-1

	gosub 600

	addz framethick

next ii

del nn


body -1
addz gs_leaf_thk/2-thk/2
material gs_leaf_mat3

base

prism_ 10,thk,
	0.08,0.15,15,
	(A-0.138)/2-0.04,0.15,15,
	(A-0.138)/2-0.04,0.65,15,
	0.08,0.65,15,
	0.08,0.15,-1,
	0.11,0.18,15,
	(A-0.138)/2-0.07,0.18,15,
	(A-0.138)/2-0.07,0.62,15,
	0.11,0.62,15,
	0.11,0.18,-1

prism_ 10,thk,
	(A-0.138)/2+0.04,0.15,15,
	(A-0.138)/2+0.04,0.65,15,
	(A-0.218),0.65,15,
	(A-0.218),0.15,15,
	(A-0.138)/2+0.04,0.15,-1,
	(A-0.138)/2+0.07,0.18,15,
	(A-0.138)/2+0.07,0.62,15,
	(A-0.251),0.62,15,
	(A-0.251),0.18,15,
	(A-0.138)/2+0.07,0.18,-1

prism_ 10,thk,
	0.08,0.73,15,
	(A-0.218),0.73,15,
	(A-0.218),0.88,15,
	0.08,0.88,15,
	0.08,0.73,-1,
	0.11,0.76,15,
	(A-0.248),0.76,15,
	(A-0.248),0.85,15,
	0.11,0.85,15,
	0.11,0.76,-1

prism_ 10,thk,
	0.08,0.96,15,
	(A-0.138)/2-0.04,0.96,15,
	(A-0.138)/2-0.04,B-0.22,15,
	0.08,B-0.22,15,
	0.08,0.96,-1,
	0.11,0.99,15,
	(A-0.138)/2-0.07,0.99,15,
	(A-0.138)/2-0.07,B-0.25,15,
	0.11,B-0.25,15,
	0.11,0.99,-1

prism_ 10,thk,
	(A-0.138)/2+0.04,0.96,15,
	(A-0.138)/2+0.04,B-0.22,15,
	(A-0.218),B-0.22,15,
	(A-0.218),0.96,15,
	(A-0.138)/2+0.04,0.96,-1,
	(A-0.138)/2+0.07,0.99,15,
	(A-0.138)/2+0.07,B-0.25,15,
	(A-0.248),B-0.25,15,
	(A-0.248),0.99,15,
	(A-0.138)/2+0.07,0.99,-1

del 1

body -1
material gs_leaf_mat2
addz gs_leaf_thk/2-thk2/2

prism_ 4,thk2,
	0.11,0.18,15,
	(A-0.138)/2-0.07,0.18,15,
	(A-0.138)/2-0.07,0.62,15,
	0.11,0.62,15

prism_ 4,thk2,
	(A-0.138)/2+0.07,0.18,15,
	(A-0.138)/2+0.07,0.62,15,
	(A-0.251),0.62,15,
	(A-0.251),0.18,15

prism_ 4,thk2,
	 0.11,0.76,15,
	(A-0.248),0.76,15,
	(A-0.248),0.85,15,
	0.11,0.85,15

prism_ 4,thk2,
	0.11,0.99,15,
	(A-0.138)/2-0.07,0.99,15,
	(A-0.138)/2-0.07,B-0.25,15,
	0.11,B-0.25,15

prism_ 4,thk2,
	(A-0.138)/2+0.07,0.99,15,
	(A-0.138)/2+0.07,B-0.25,15,
	(A-0.248),B-0.25,15,
	(A-0.248),0.99,15

gosub 500

body -1
del 2
RETURN



12:
!!!!!******************** MONTROSE !!!!!

addx -a/2

a=a+0.138
b=b+0.11

if lod3D = 5 then
	thk = gs_frame_thk
	thk2 = gs_frame_thk
else
	thk = 0.01
	thk2 = 0.026
endif

Ar=A*0.15-0.075

material gs_leaf_mat

for ii=1 to nn

	gosub 900

	if gs_SashText_typ_num = 1 then

		base

		sprism_{2} topmat, botmat, sidemat,
			7,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0,10, sidematedge,
			0.08,0.15,15, sidemat,
			0.08,0.68,10, sidemat,
			0.08,0.87,15, sidemat,
			0.08,B-0.27-Ar,10, sidemat,
			0,B-0.11,mmask, sidematedge,
			0,0,-1, sidematedge

		sprism_{2} topmat, botmat, sidemat,
			7,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			A-0.138,0,10, sidematedge,
			A-0.218,0.15,15, sidemat,
			A-0.218,0.68,10, sidemat,
			A-0.218,0.87,15, sidemat,
			A-0.218,B-0.27-Ar,10, sidemat,
			A-0.138,B-0.11,mmask, sidematedge,
			A-0.138,0,-1, sidematedge

		gosub 500

		sprism_{2} topmat, botmat, sidemat,
			5,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0,10, sidematedge,
			0.08,0.15,15, sidemat,
			A-0.218,0.15,10, sidemat,
			A-0.138,0,mmask, sidematedge,
			0,0,-1, sidematedge

		sprism_{2} topmat, botmat, sidemat,
			10,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			(A-0.218),B-0.27-Ar,79, sidematedge,
			(A-0.218),B-0.22-Ar,915, sidemat,
			(A-0.268),B-0.22-Ar,3079, sidemat,
			(A-0.138)/2,B-1-Ar,915, sidemat,
			0.13,B-0.22-Ar,3079, sidemat,
			0.08,B-0.22-Ar,915, sidemat,
			0.08,B-0.27-Ar,3010, sidemat,
			0,B-0.11,mmask2, sidemat,
			A-0.138,B-0.11,10, sidematedge,
			(A-0.218),B-0.27-Ar,-1, sidematedge

		gosub 600

	endif


	if gs_SashText_typ_num = 2 then

		base

		sprism_{2} topmat, botmat, sidemat,
			7,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0.15,8, sidematedge,
			0.08,0.15,15, sidemat,
			0.08,0.68,10, sidemat,
			0.08,0.87,15, sidemat,
			0.08,B-0.27-Ar,10, sidemat,
			0,B-0.27-Ar,mmask2, sidematedge,
			0,0.15,-1, sidematedge

		sprism_{2} topmat, botmat, sidemat,
			7,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			A-0.138,0.15,8, sidematedge,
			A-0.218,0.15,15, sidemat,
			A-0.218,0.68,10, sidemat,
			A-0.218,0.87,15, sidemat,
			A-0.218,B-0.27-Ar,10, sidemat,
			A-0.138,B-0.27-Ar,mmask2, sidematedge,
			A-0.138,0.15,-1, sidematedge

		gosub 500

		sprism_{2} topmat, botmat, sidemat,
			7,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0,15, sidematedge,
			0,0.15,8, sidemat,
			0.08,0.15,15, sidemat,
			A-0.218,0.15,10, sidemat,
			A-0.138,0.15,mmask2, sidematedge,
			A-0.138,0,mmask, sidematedge,
			0,0,-1, sidematedge

		sprism_{2} topmat, botmat, sidemat,
			12,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			(A-0.218),B-0.27-Ar,79, sidematedge,
			(A-0.218),B-0.22-Ar,915, sidemat,
			(A-0.268),B-0.22-Ar,3079, sidemat,
			(A-0.138)/2,B-1-Ar,915, sidemat,
			0.13,B-0.22-Ar,3079, sidemat,
			0.08,B-0.22-Ar,915, sidemat,
			0.08,B-0.27-Ar,3010, sidemat,
			0,B-0.27-Ar,13, sidemat,
			0,B-0.11,mmask, sidemat,
			A-0.138,B-0.11,mmask, sidematedge,
			A-0.138,B-0.27-Ar,8, sidematedge,
			(A-0.218),B-0.27-Ar,-1, sidematedge

		gosub 600

	endif

	gosub 600

	addz framethick

next ii

del nn



!****************** both in type1 and type2

base

for ii=1 to nn

	gosub 900

	cprism_ topmat, botmat, sidemat,
		17, framethick,
		(A-0.218),0.87,10,
		(A-0.218),0.68,79,
		(A-0.218),0.73,915,
		0,-90,4079,
		(A-0.138)/2,0.35,915,
		0.13,0.73,3079,
		0.08,0.73,915,
		0.08,0.68,3074,
		0.08,0.87,13,
		0.08,0.82,915,
		0.12,0.82,3079,
		(A-0.138)/2,0.44,915,
		(A-0.268),0.82,3079,
		(A-0.218),0.82,915,
		(A-0.218),0.87,3079,
		(A-0.218),B-0.27-Ar,79,
		(A-0.218),0.87,-1

	gosub 600

	addz framethick

next ii

del nn


addz gs_leaf_thk/2-thk/2

base

cprism_ topmat, botmat, sidemat,
	20, thk,
	0.08,0.15,15,
	(A-0.218),0.15,15,
	(A-0.218),0.68,15,
	(A-0.218),0.73,915,
	0,-90,4015,
	(A-0.138)/2,0.35,915,
	0.13,0.73,3015,
	0.08,0.73,915,
	0.08,0.68,3015,
	0.08,0.15,-1,
	0.11,0.18,15,
	(A-0.248),0.18,15,
	(A-0.248),0.65,15,
	(A-0.248),0.7,915,
	0,-90,4015,
	(A-0.138)/2,0.38,915,
	0.16,0.7,3015,
	0.11,0.7,915,
	0.11,0.65,3015,
	0.11,0.18,-1

cprism_ topmat, botmat, sidemat,
	30, thk,
	0.08,0.87,15,
	0.08,0.82,915,
	0.12,0.82,3015,
	(A-0.138)/2,0.44,915,
	(A-0.268),0.82,3015,
	(A-0.218),0.82,915,
	(A-0.218),0.87,3015,
	(A-0.218),B-0.27-Ar,15,
	(A-0.218),B-0.22-Ar,915,
	(A-0.268),B-0.22-Ar,3015,
	(A-0.138)/2,B-1-Ar,915,
	0.13,B-0.22-Ar,3015,
	0.08,B-0.22-Ar,915,
	0.08,B-0.27-Ar,3015,
	0.08,0.87,-1,
	0.11,0.9,15,
	0.11,0.85,915,
	0.14,0.86,3015,
	(A-0.138)/2,0.44,915,
	(A-0.298),0.86,3015,
	(A-0.248),0.85,915,
	(A-0.248),0.9,3015,
	(A-0.248),B-0.3-Ar,15,
	(A-0.248),B-0.25-Ar,915,
	(A-0.298),B-0.25-Ar,3015,
	(A-0.138)/2,B-1-Ar,915,
	0.16,B-0.25-Ar,3015,
	0.11,B-0.25-Ar,915,
	0.11,B-0.3-Ar,3015,
	0.11,0.9,-1

del 1

thk3 = (thk2-thk)/2

addz gs_leaf_thk/2-thk2/2

cprism_ topmat, botmat, botmat,
	10, thk2-thk3,
	0.11,0.18,15,
	(A-0.248),0.18,15,
	(A-0.248),0.65,15,
	(A-0.248),0.7,915,
	0,-90,4015,
	(A-0.138)/2,0.38,915,
	0.16,0.7,3015,
	0.11,0.7,915,
	0.11,0.65,3015,
	0.11,0.18,15

cprism_ topmat, botmat, botmat,
	15, thk2-thk3,
	0.11,0.9,15,
	0.11,0.85,915,
	0.14,0.86,3015,
	(A-0.138)/2,0.44,915,
	(A-0.298),0.86,3015,
	(A-0.248),0.85,915,
	(A-0.248),0.9,3015,
	(A-0.248),B-0.3-Ar,15,
	(A-0.248),B-0.25-Ar,915,
	(A-0.298),B-0.25-Ar,3015,
	(A-0.138)/2,B-1-Ar,915,
	0.16,B-0.25-Ar,3015,
	0.11,B-0.25-Ar,915,
	0.11,B-0.3-Ar,3015,
	0.11,0.9,15

if thk3 > EPS then
	material topmat
	addz thk2-thk3
	prism_ 10, thk3,
		0.11,0.18,15,
		(A-0.248),0.18,15,
		(A-0.248),0.65,15,
		(A-0.248),0.7,915,
		0,-90,4015,
		(A-0.138)/2,0.38,915,
		0.16,0.7,3015,
		0.11,0.7,915,
		0.11,0.65,3015,
		0.11,0.18,15

	prism_ 15, thk3,
		0.11,0.9,15,
		0.11,0.85,915,
		0.14,0.86,3015,
		(A-0.138)/2,0.44,915,
		(A-0.298),0.86,3015,
		(A-0.248),0.85,915,
		(A-0.248),0.9,3015,
		(A-0.248),B-0.3-Ar,15,
		(A-0.248),B-0.25-Ar,915,
		(A-0.298),B-0.25-Ar,3015,
		(A-0.138)/2,B-1-Ar,915,
		0.16,B-0.25-Ar,3015,
		0.11,B-0.25-Ar,915,
		0.11,B-0.3-Ar,3015,
		0.11,0.9,15
	del 1
endif

gosub 500

del 2

RETURN



13:
!!!!!******************** HUNTINGDON !!!!!

addx -a/2

a=a+0.138
b=b+0.11

Ar=A*0.11

if lod3D = 5 then
	thk = gs_frame_thk
	thk2 = gs_frame_thk
else
	thk = 0.01
	thk2 = 0.026
endif

material gs_leaf_mat

gosub 1300


addz gs_leaf_thk/2-thk/2

base

cprism_ topmat, botmat, sidemat,
	10, thk,
	0.08,0.15,15,
	(A-0.218),0.15,15,
	(A-0.218),0.73,15,
	0.08,0.73,15,
	0.08,0.15,-1,
	0.11,0.18,15,
	(A-0.248),0.18,15,
	(A-0.248),0.7,15,
	0.11,0.7,15,
	0.11,0.18,-1
del 1

gosub 500

body -1

group "glazing 13"
	pen gs_glass_pen
	sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_glass_pen_cont
	material gs_glass_mat

	addz gs_leaf_thk/2-gs_glass_thk/2

	base

	prism_ 9,gs_glass_thk,
		0.08,0.88,15,
		(A-0.218),0.88,15,
		(A-0.218),B-0.18-Ar,13,
		(A-0.218),B+0.32-Ar,913,
		(A-0.138)/2+A/6,B-0.15-Ar,3013,
		(A-0.138)/2,B-0.53-Ar,913,
		(A-0.138)/2-A/6,B-0.15-Ar,3013,
		0.08,B+0.32-Ar,915,
		0.08,B-0.18-Ar,3015
	del 1

	body -1
endgroup

if lod3D = 5 then
	pen gs_leaf_pen
	sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_leaf_pen_cont
	material gs_leaf_mat2
	addz gs_leaf_thk/2-thk2/2
	prism_ 4,thk2,
		0.11,0.18,15,
		(A-0.248),0.18,15,
		(A-0.248),0.7,15,
		0.11,0.7,15

	group "grids 13"
		addz -gs_leaf_thk/2

		material mulbotmat

		cutform 9, 1, 2 + 16,
				0, 0, -1, 0,
				0.08,B,31,
				(A-0.218),B,31,
				(A-0.218),B-0.18-Ar,31,
				(A-0.218),B+0.32-Ar,931,
				(A-0.138)/2+A/6,B-0.15-Ar,3031,
				(A-0.138)/2,B-0.53-Ar,931,
				(A-0.138)/2-A/6,B-0.15-Ar,3031,
				0.08,B+0.32-Ar,931,
				0.08,B-0.18-Ar,3031

		prism_ 4,gs_leaf_thk*2,
			(A-0.138)/2+0.01,0.88,15,
			(A-0.138)/2+0.01,B-0.19,15,
			(A-0.138)/2-0.01,B-0.19,15,
			(A-0.138)/2-0.01,0.88,15
		prism_ 4,gs_leaf_thk*2,
			0.08,0.88+(B-1.04)/3-0.01,15,
			0.08,0.88+(B-1.04)/3+0.01,15,
			(A-0.138)/2-0.01,0.88+(B-1.04)/3+0.01,15,
			(A-0.138)/2-0.01,0.88+(B-1.04)/3-0.01,15
		prism_ 4,gs_leaf_thk*2,
			0.08,0.88+2*((B-1.04)/3)-0.01,15,
			0.08,0.88+2*((B-1.04)/3)+0.01,15,
			(A-0.138)/2-0.01,0.88+2*((B-1.04)/3)+0.01,15,
			(A-0.138)/2-0.01,0.88+2*((B-1.04)/3)-0.01,15
		prism_ 4,gs_leaf_thk*2,
			A-0.218,0.88+(B-1.04)/3-0.01,15,
			A-0.218,0.88+(B-1.04)/3+0.01,15,
			(A-0.138)/2+0.01,0.88+(B-1.04)/3+0.01,15,
			(A-0.138)/2+0.01,0.88+(B-1.04)/3-0.01,15
		prism_ 4,gs_leaf_thk*2,
			A-0.218,0.88+2*((B-1.04)/3)-0.01,15,
			A-0.218,0.88+2*((B-1.04)/3)+0.01,15,
			(A-0.138)/2+0.01,0.88+2*((B-1.04)/3)+0.01,15,
			(A-0.138)/2+0.01,0.88+2*((B-1.04)/3)-0.01,15
		del 1

		cutend
	endgroup

	addz gs_leaf_thk/4
	mulz 0.5
	placegroup "grids 13"
	del 2

	result_13 = subgroup("glazing 13", "grids 13")
	placegroup result_13
	killgroup result_13
	killgroup "grids 13"
else
	placegroup "glazing 13"

	pen gs_leaf_pen
	sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_leaf_pen_cont
	material gs_leaf_mat2
	addz gs_leaf_thk/2-thk2/2
	prism_ 4,thk2,
		0.11,0.18,15,
		(A-0.248),0.18,15,
		(A-0.248),0.7,15,
		0.11,0.7,15

	material mulbotmat

	prism_ 4,0.008,
		(A-0.138)/2+0.01,0.88,15,
		(A-0.138)/2+0.01,B-0.19,15,
		(A-0.138)/2-0.01,B-0.19,15,
		(A-0.138)/2-0.01,0.88,15
	prism_ 4,0.008,
		0.08,0.88+(B-1.04)/3-0.01,15,
		0.08,0.88+(B-1.04)/3+0.01,15,
		(A-0.138)/2-0.01,0.88+(B-1.04)/3+0.01,15,
		(A-0.138)/2-0.01,0.88+(B-1.04)/3-0.01,15
	prism_ 4,0.008,
		0.08,0.88+2*((B-1.04)/3)-0.01,15,
		0.08,0.88+2*((B-1.04)/3)+0.01,15,
		(A-0.138)/2-0.01,0.88+2*((B-1.04)/3)+0.01,15,
		(A-0.138)/2-0.01,0.88+2*((B-1.04)/3)-0.01,15
	prism_ 4,0.008,
		A-0.218,0.88+(B-1.04)/3-0.01,15,
		A-0.218,0.88+(B-1.04)/3+0.01,15,
		(A-0.138)/2+0.01,0.88+(B-1.04)/3+0.01,15,
		(A-0.138)/2+0.01,0.88+(B-1.04)/3-0.01,15
	prism_ 4,0.008,
		A-0.218,0.88+2*((B-1.04)/3)-0.01,15,
		A-0.218,0.88+2*((B-1.04)/3)+0.01,15,
		(A-0.138)/2+0.01,0.88+2*((B-1.04)/3)+0.01,15,
		(A-0.138)/2+0.01,0.88+2*((B-1.04)/3)-0.01,15

	addz 0.018

	material multopmat

	prism_ 4,0.008,
		(A-0.138)/2+0.01,0.88,15,
		(A-0.138)/2+0.01,B-0.19,15,
		(A-0.138)/2-0.01,B-0.19,15,
		(A-0.138)/2-0.01,0.88,15
	prism_ 4,0.008,
		0.08,0.88+(B-1.04)/3-0.01,15,
		0.08,0.88+(B-1.04)/3+0.01,15,
		(A-0.138)/2-0.01,0.88+(B-1.04)/3+0.01,15,
		(A-0.138)/2-0.01,0.88+(B-1.04)/3-0.01,15
	prism_ 4,0.008,
		0.08,0.88+2*((B-1.04)/3)-0.01,15,
		0.08,0.88+2*((B-1.04)/3)+0.01,15,
		(A-0.138)/2-0.01,0.88+2*((B-1.04)/3)+0.01,15,
		(A-0.138)/2-0.01,0.88+2*((B-1.04)/3)-0.01,15
	prism_ 4,0.008,
		A-0.218,0.88+(B-1.04)/3-0.01,15,
		A-0.218,0.88+(B-1.04)/3+0.01,15,
		(A-0.138)/2+0.01,0.88+(B-1.04)/3+0.01,15,
		(A-0.138)/2+0.01,0.88+(B-1.04)/3-0.01,15
	prism_ 4,0.008,
		A-0.218,0.88+2*((B-1.04)/3)-0.01,15,
		A-0.218,0.88+2*((B-1.04)/3)+0.01,15,
		(A-0.138)/2+0.01,0.88+2*((B-1.04)/3)+0.01,15,
		(A-0.138)/2+0.01,0.88+2*((B-1.04)/3)-0.01,15

	vert 0, 0, 0
	vert 0, 1, 0
	vert 1, 0, 0
	vert 0, 0, 1
	coor 2, -1, -2, -3, -4
	body 1

	del 2
endif
killgroup "glazing 13"
del 1
RETURN

14:
!!!!!******************** ALLENDALE !!!!!


a=a+0.138
b=b+0.11

Ar=A*0.11

if lod3D = 5 then
	thk = gs_frame_thk
else
	thk = 0.01
endif

addx -(A-0.138)/2
material gs_leaf_mat


gosub 1300

body -1

addz gs_leaf_thk/2-thk/2

base

cprism_ topmat, botmat, sidemat,
	5, thk,
	0.08,0.15,15,
	(A-0.218),0.15,15,
	(A-0.218),0.73,15,
	0.08,0.73,15,
	0.08,0.15,-1

del 1

gosub 500

pen gs_glass_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_glass_pen_cont
material gs_glass_mat

addz gs_leaf_thk/2-gs_glass_thk/2

	base

prism_ 9,gs_glass_thk,
	0.08,0.88,15,
	(A-0.218),0.88,15,
	(A-0.218),B-0.18-Ar,13,
	(A-0.218),B+0.32-Ar,913,
	(A-0.138)/2+A/6,B-0.15-Ar,3013,
	(A-0.138)/2,B-0.53-Ar,913,
	(A-0.138)/2-A/6,B-0.15-Ar,3013,
	0.08,B+0.32-Ar,915,
	0.08,B-0.18-Ar,3015

gosub 500

del 1
del 1
RETURN


15:

!!!!!******************** ASKDALE !!!!!

a=a+0.138
b=b+0.11

material gs_leaf_mat
addx -(A-0.138)/2

gosub 1400

body -1

addz gs_leaf_thk/2-gs_glass_thk/2

pen gs_glass_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_glass_pen_cont
material gs_glass_mat

prism_ 5,gs_glass_thk,
	 0.08,0.15,15,
	(A-0.218),0.15,15,
	(A-0.218),0.73,15,
	0.08,0.73,15,
	0.08,0.15,15

body -1

prism_ 5,gs_glass_thk,
	 0.08,0.88,15,
	(A-0.218),0.88,15,
	(A-0.218),B-0.22,15,
	0.08,B-0.22,15,
	0.08,0.88,-1

body -1

del 1
del 1
RETURN



16:
!!!!!******************** WARWICK !!!!!

addx -a/2

a=a+0.138
b=b+0.11

material gs_leaf_mat


for ii=1 to nn

	gosub 900

	if gs_SashText_typ_num = 1 then

		base

		sprism_{2} topmat, botmat, sidemat,
			11,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0.08,0.15,mmask, sidemat,
			0.08,0.73,10, sidemat,
			0.08,0.88,mmask, sidemat,
			0.08,0.98,10, sidemat,
			0.08,1,mmask, sidemat,
			0.08,B-0.34,10, sidemat,
			0.08,B-0.32,mmask, sidemat,
			0.08,B-0.22,10, sidemat,
			0,B-0.11,15, sidemat,
			0,0, 8, sidemat,
			0.08,0.15,-1, sidematedge

		sprism_{2} topmat, botmat, sidemat,
			11,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			A-0.138,0,10, sidematedge,
			A-0.218,0.15,mmask, sidemat,
			A-0.218,0.73,10, sidemat,
			A-0.218,0.88,mmask, sidemat,
			A-0.218,0.98,10, sidemat,
			A-0.218,1,mmask, sidemat,
			A-0.218,B-0.34,10, sidemat,
			A-0.218,B-0.32,mmask, sidemat,
			A-0.218,B-0.22,10, sidemat,
			A-0.138,B-0.11, mmask, sidematedge,
			A-0.138,0,-1, sidematedge

		gosub 500

		sprism_{2} topmat, botmat, sidemat,
			7,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0,10, sidematedge,
			0.08,0.15,mmask, sidemat,
			(A-0.138)/2-0.04,0.15,10, sidemat,
			(A-0.138)/2+0.04,0.15,mmask, sidemat,
			A-0.218,0.15,10, sidemat,
			A-0.138,0,mmask, sidematedge,
			0,0,-1, sidematedge

		sprism_{2} topmat, botmat, sidemat,
			9,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,B-0.11,10, sidematedge,
			0.08,B-0.22,mmask, sidemat,
			0.18,B-0.22,10, sidemat,
			0.2,B-0.22,mmask, sidemat,
			A-0.338,B-0.22,10, sidemat,
			A-0.318,B-0.22,mmask, sidemat,
			A-0.218,B-0.22,10, sidemat,
			A-0.138,B-0.11,mmask, sidematedge,
			0,B-0.11,-1, sidematedge

		gosub 600

	endif

	if gs_SashText_typ_num = 2 then

		base

		sprism_{2} topmat, botmat, sidemat,
			11,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0.15,8, sidematedge,
			0.08,0.15,mmask, sidemat,
			0.08,0.73,10, sidemat,
			0.08,0.88,mmask, sidemat,
			0.08,0.98,10, sidemat,
			0.08,1,mmask, sidemat,
			0.08,B-0.34,10, sidemat,
			0.08,B-0.32,mmask, sidemat,
			0.08,B-0.22,10, sidemat,
			0,B-0.22,mmask2, sidematedge,
			0,0.15,-1, sidematedge

		sprism_{2} topmat, botmat, sidemat,
			11,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			A-0.138,0.15,8, sidematedge,
			A-0.218,0.15,mmask, sidemat,
			A-0.218,0.73,10, sidemat,
			A-0.218,0.88,mmask, sidemat,
			A-0.218,0.98,10, sidemat,
			A-0.218,1,mmask, sidemat,
			A-0.218,B-0.34,10, sidemat,
			A-0.218,B-0.32,mmask, sidemat,
			A-0.218,B-0.22,10, sidemat,
			A-0.138,B-0.22,mmask2, sidematedge,
			A-0.138,0.15,-1, sidematedge

		gosub 500

		sprism_{2} topmat, botmat, sidemat,
			9,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0,15, sidematedge,
			0,0.15,8, sidemat,
			0.08,0.15,mmask, sidemat,
			(A-0.138)/2-0.04,0.15,10, sidemat,
			(A-0.138)/2+0.04,0.15,mmask, sidemat,
			A-0.218,0.15,10, sidemat,
			A-0.138,0.15,mmask2, sidematedge,
			A-0.138,0,mmask, sidematedge,
			0,0,-1, sidematedge

		sprism_{2} topmat, botmat, sidemat,
			11,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,B-0.11,15, sidematedge,
			0,B-0.22,8, sidemat,
			0.08,B-0.22,mmask, sidemat,
			0.18,B-0.22,10, sidemat,
			0.2,B-0.22,mmask, sidemat,
			A-0.338,B-0.22,10, sidemat,
			A-0.318,B-0.22,mmask, sidemat,
			A-0.218,B-0.22,10, sidemat,
			A-0.138,B-0.22,mmask2, sidematedge,
			A-0.138,B-0.11,mmask, sidematedge,
			0,B-0.11,-1, sidematedge

		gosub 600

	endif

	addz framethick

next ii

del nn



!********** Both in type1 and type2

base

for ii=1 to nn

	gosub 900

	cprism_ topmat, botmat, sidemat,
		4, framethick,
		(A-0.138)/2-0.04,0.15,10,
		(A-0.138)/2+0.04,0.15,mmask,
		(A-0.138)/2+0.04,0.73,10,
		(A-0.138)/2-0.04,0.73,mmask

	cprism_ topmat, botmat, sidemat,
		4, framethick,
		0.18,0.88,10,
		0.2,0.88,mmask,
		0.2,0.98,10,
		0.18,0.98,mmask

	cprism_ topmat, botmat, sidemat,
		4, framethick,
		0.18,1,10,
		0.2,1,mmask,
		0.2,B-0.34,10,
		0.18,B-0.34,mmask

	cprism_ topmat, botmat, sidemat,
		4, framethick,
		0.18,B-0.32,10,
		0.2,B-0.32,mmask,
		0.2,B-0.22,10,
		0.18,B-0.22,mmask

	cprism_ topmat, botmat, sidemat,
		4, framethick,
		A-0.338,0.88,10,
		A-0.318,0.88,mmask,
		A-0.318,0.98,10,
		A-0.338,0.98,mmask

	cprism_ topmat, botmat, sidemat,
		4, framethick,
		A-0.338,1,10,
		A-0.318,1,mmask,
		A-0.318,B-0.34,10,
		A-0.338,B-0.34,mmask

	cprism_ topmat, botmat, sidemat,
		4, framethick,
		A-0.338,B-0.32,10,
		A-0.318,B-0.32,mmask,
		A-0.318,B-0.22,10,
		A-0.338,B-0.22,mmask

	gosub 500

	cprism_ topmat, botmat, sidemat,
		10, framethick,
		0.08,0.73,10,
		0.08,0.88,mmask,
		0.18,0.88,10,
		0.2,0.88,mmask,
		A-0.338,0.88,10,
		A-0.318,0.88,mmask,
		A-0.218,0.88,10,
		A-0.218,0.73,mmask,
		(A-0.138)/2+0.04,0.73,10,
		(A-0.138)/2-0.04,0.73,mmask

	cprism_ topmat, botmat, sidemat,
		12, framethick,
		0.08,0.98,10,
		0.08,1,mmask,
		0.18,1,10,
		0.2,1,mmask,
		A-0.338,1,10,
		A-0.318,1,mmask,
		A-0.218,1,10,
		A-0.218,0.98,mmask,
		A-0.318,0.98,10,
		A-0.338,0.98,mmask,
		0.2,0.98,10,
		0.18,0.98,mmask

	cprism_ topmat, botmat, sidemat,
		12, framethick,
		0.08,B-0.34,10,
		0.08,B-0.32,mmask,
		0.18,B-0.32,10,
		0.2,B-0.32,mmask,
		A-0.338,B-0.32,10,
		A-0.318,B-0.32,mmask,
		A-0.218,B-0.32,10,
		A-0.218,B-0.34,mmask,
		A-0.318,B-0.34,10,
		A-0.338,B-0.34,mmask,
		0.2,B-0.34,10,
		0.18,B-0.34,mmask

	gosub 600

	addz framethick

next ii

del nn


if lod3D = 5 then
	if nn = 1 then
		thk = gs_frame_thk
		dz = 0
	else
		thk = gs_frame_thk/2
		dz = gs_leaf_thk/2-thk
	endif
else
	thk = 0.005
	dz = gs_leaf_thk/2-thk
endif


for ii=1 to nn

	gosub 900

	addz dz

	base

	cprism_ topmat, botmat, sidemat,
		10, thk,
		0.08,0.15,15,
		(A-0.138)/2-0.04,0.15,15,
		(A-0.138)/2-0.04,0.73,15,
		0.08,0.73,15,
		0.08,0.15,-1,
		0.11,0.18,15,
		(A-0.138)/2-0.076,0.18,15,
		(A-0.138)/2-0.076,0.7,15,
		0.11,0.7,15,
		0.11,0.18,-1

	cprism_ topmat, botmat, sidemat,
		10, thk,
		(A-0.138)/2+0.04,0.15,15,
		(A-0.138)/2+0.04,0.73,15,
		(A-0.218),0.73,15,
		(A-0.218),0.15,15,
		(A-0.138)/2+0.04,0.15,-1,
		(A-0.138)/2+0.07,0.18,15,
		(A-0.138)/2+0.07,0.7,15,
		(A-0.251),0.7,15,
		(A-0.251),0.18,15,
		(A-0.138)/2+0.07,0.18,-1

	del 1

	gosub 600

	addz thk

next ii

del nn


addz gs_leaf_thk/2-gs_glass_thk/2


body -1

pen gs_glass_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_glass_pen_cont
material gs_glass_mat

prism_ 5,gs_glass_thk,
   0.08,0.88,15,
	0.08,0.98,15,
	0.18,0.98,15,
	0.18,0.88,15,
	0.08,0.88,-1

prism_ 5,gs_glass_thk,
	 0.2,0.88,15,
	0.2,0.98,15,
	A-0.338,0.98,15,
	A-0.338,0.88,15,
	0.2,0.88,-1

prism_ 5,gs_glass_thk,
	A-0.318,0.88,15,
	A-0.318,0.98,15,
	A-0.218,0.98,15,
	A-0.218,0.88,15,
	A-0.318,0.88,-1

prism_ 5,gs_glass_thk,
	0.08,1,15,
	0.08,B-0.34,15,
	0.18,B-0.34,15,
	0.18,1,15,
	0.08,1,-1

prism_ 5,gs_glass_thk,
	0.2,1,15,
	0.2,B-0.34,15,
	A-0.338,B-0.34,15,
	A-0.338,1,15,
	0.2,1,-1

prism_ 5,gs_glass_thk,
	 A-0.318,1,15,
	A-0.318,B-0.34,15,
	A-0.218,B-0.34,15,
	A-0.218,1,15,
	A-0.318,1,-1

prism_ 5,gs_glass_thk,
	 0.08,B-0.32,15,
	0.08,B-0.22,15,
	0.18,B-0.22,15,
	0.18,B-0.32,15,
	0.08,B-0.32,-1

prism_ 5,gs_glass_thk,
	0.2,B-0.32,15,
	0.2,B-0.22,15,
	A-0.338,B-0.22,15,
	A-0.338,B-0.32,15,
	0.2,B-0.32,-1

prism_ 5,gs_glass_thk,
	A-0.318,B-0.32,15,
	A-0.318,B-0.22,15,
	A-0.218,B-0.22,15,
	A-0.218,B-0.32,15,
	A-0.318,B-0.32,-1

del 1

body -1
pen gs_leaf_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_leaf_pen_cont
material gs_leaf_mat2

if lod3D = 5 then
	thk = gs_frame_thk
else
	thk = 0.026
endif

addz gs_leaf_thk/2-thk/2

prism_ 5,thk,
	0.11,0.18,15,
	(A-0.138)/2-0.076,0.18,15,
	(A-0.138)/2-0.076,0.7,15,
	0.11,0.7,15,
	0.11,0.18,15

prism_ 5,thk,
	(A-0.138)/2+0.07,0.18,15,
	(A-0.138)/2+0.07,0.7,15,
	(A-0.251),0.7,15,
	(A-0.251),0.18,15,
	(A-0.138)/2+0.07,0.18,15

gosub 500

del 2

RETURN

17:
!!!!!******************** ASKDALE 2 !!!!!


addx -a/2
a=a+0.138
b=b+0.11

material gs_leaf_mat

gosub 1400

body -1
pen gs_glass_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_glass_pen_cont
material gs_glass_mat

if lod3D = 5 then
	prism_ 5,gs_leaf_thk,
		 0.09,0.16,15,
		(A-0.228),0.16,15,
		(A-0.228),0.72,15,
		0.09,0.72,15,
		0.09,0.16,-1
	prism_ 5,gs_leaf_thk,
		0.09,0.89,15,
		(A-0.228),0.89,15,
		(A-0.228),B-0.23,15,
		0.09,B-0.23,15,
		0.09,0.89,-1
else
	prism_ 5,gs_leaf_thk,
		0.08,0.15,15,
		(A-0.218),0.15,15,
		(A-0.218),0.73,15,
		0.08,0.73,15,
		0.08,0.15,-1
	prism_ 5,gs_leaf_thk,
		0.08,0.88,15,
		(A-0.218),0.88,15,
		(A-0.218),B-0.22,15,
		0.08,B-0.22,15,
		0.08,0.88,-1
endif
body -1
pen gs_leaf_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_leaf_pen_cont
material gs_leaf_mat2
if lod3D = 5 then
	prism_ 10,gs_frame_thk,
		0.08,0.15,15,
		(A-0.218),0.15,15,
		(A-0.218),0.73,15,
		0.08,0.73,15,
		0.08,0.15,-1,

		0.09,0.16,15,
		(A-0.228),0.16,15,
		(A-0.228),0.72,15,
		0.09,0.72,15,
		0.09,0.16,-1

	prism_ 10,gs_frame_thk,
		0.08,0.88,15,
		(A-0.218),0.88,15,
		(A-0.218),B-0.22,15,
		0.08,B-0.22,15,
		0.08,0.88,-1,

		0.09,0.89,15,
		(A-0.228),0.89,15,
		(A-0.228),B-0.23,15,
		0.09,B-0.23,15,
		0.09,0.89,-1
else
	addz -0.01
	prism_ 10,0.01,
		0.08,0.15,15,
		(A-0.218),0.15,15,
		(A-0.218),0.73,15,
		0.08,0.73,15,
		0.08,0.15,-1,

		0.09,0.16,15,
		(A-0.228),0.16,15,
		(A-0.228),0.72,15,
		0.09,0.72,15,
		0.09,0.16,-1

	prism_ 10,0.01,
		0.08,0.88,15,
		(A-0.218),0.88,15,
		(A-0.218),B-0.22,15,
		0.08,B-0.22,15,
		0.08,0.88,-1,

		0.09,0.89,15,
		(A-0.228),0.89,15,
		(A-0.228),B-0.23,15,
		0.09,B-0.23,15,
		0.09,0.89,-1
	del 1

	addz gs_leaf_thk
	prism_ 10,0.01,
		0.08,0.15,15,
		(A-0.218),0.15,15,
		(A-0.218),0.73,15,
		0.08,0.73,15,
		0.08,0.15,-1,

		0.09,0.16,15,
		(A-0.228),0.16,15,
		(A-0.228),0.72,15,
		0.09,0.72,15,
		0.09,0.16,-1

	prism_ 10,0.01,
		0.08,0.88,15,
		(A-0.218),0.88,15,
		(A-0.218),B-0.22,15,
		0.08,B-0.22,15,
		0.08,0.88,-1,

		0.09,0.89,15,
		(A-0.228),0.89,15,
		(A-0.228),B-0.23,15,
		0.09,B-0.23,15,
		0.09,0.89,-1
	del 1
endif
del 1
RETURN

18:
!!!!!******************** ASKDALE 4 !!!!!


addx -a/2
a=a+0.138
b=b+0.11

material gs_leaf_mat


gosub 1100

body -1
pen gs_glass_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_glass_pen_cont
material gs_glass_mat
if lod3D = 5 then
	prism_ 5,gs_leaf_thk,
		0.09,0.16,15,
		(A-0.138)/2-0.05,0.16,15,
		(A-0.138)/2-0.05,0.72,15,
		0.09,0.72,15,
		0.09,0.16,-1

	prism_ 5,gs_leaf_thk,
		(A-0.138)/2+0.05,0.16,15,
		(A-0.138)/2+0.05,0.72,15,
		(A-0.228),0.72,15,
		(A-0.228),0.16,15,
		(A-0.138)/2+0.05,0.16,-1

	prism_ 5,gs_leaf_thk,
		0.09,0.89,15,
		(A-0.138)/2-0.05,0.89,15,
		(A-0.138)/2-0.05,B-0.23,15,
		0.09,B-0.23,15,
		0.09,0.89,-1

	prism_ 5,gs_leaf_thk,
		(A-0.138)/2+0.05,0.89,15,
		(A-0.138)/2+0.05,B-0.23,15,
		(A-0.228),B-0.23,15,
		(A-0.228),0.89,15,
		(A-0.138)/2+0.05,0.89,-1
else
	prism_ 4,gs_leaf_thk,
		0.08,0.15,15,
		(A-0.138)/2-0.04,0.15,15,
		(A-0.138)/2-0.04,0.73,15,
		0.08,0.73,15

	prism_ 4,gs_leaf_thk,
		(A-0.138)/2+0.04,0.15,15,
		(A-0.138)/2+0.04,0.73,15,
		(A-0.218),0.73,15,
		(A-0.218),0.15,15

	prism_ 4,gs_leaf_thk,
		0.08,0.88,15,
		(A-0.138)/2-0.04,0.88,15,
		(A-0.138)/2-0.04,B-0.22,15,
		0.08,B-0.22,15

	prism_ 4,gs_leaf_thk,
		(A-0.138)/2+0.04,0.88,15,
		(A-0.138)/2+0.04,B-0.22,15,
		(A-0.218),B-0.22,15,
		(A-0.218),0.88,15
endif

body -1
pen gs_leaf_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_leaf_pen_cont
material gs_leaf_mat2

if lod3D = 5 then
	prism_ 10,gs_frame_thk,
		0.08,0.15,15,
		(A-0.138)/2-0.04,0.15,15,
		(A-0.138)/2-0.04,0.73,15,
		0.08,0.73,15,
		0.08,0.15,-1,

		0.09,0.16,15,
		(A-0.138)/2-0.05,0.16,15,
		(A-0.138)/2-0.05,0.72,15,
		0.09,0.72,15,
		0.09,0.16,-1

	prism_ 10,gs_frame_thk,
		(A-0.138)/2+0.04,0.15,15,
		(A-0.138)/2+0.04,0.73,15,
		(A-0.218),0.73,15,
		(A-0.218),0.15,15,
		(A-0.138)/2+0.04,0.15,-1,

		(A-0.138)/2+0.05,0.16,15,
		(A-0.138)/2+0.05,0.72,15,
		(A-0.228),0.72,15,
		(A-0.228),0.16,15,
		(A-0.138)/2+0.05,0.16,-1

	prism_ 10,gs_frame_thk,
		0.08,0.88,15,
		(A-0.138)/2-0.04,0.88,15,
		(A-0.138)/2-0.04,B-0.22,15,
		0.08,B-0.22,15,
		0.08,0.88,-1,

		0.09,0.89,15,
		(A-0.138)/2-0.05,0.89,15,
		(A-0.138)/2-0.05,B-0.23,15,
		0.09,B-0.23,15,
		0.09,0.89,-1

	prism_ 10,gs_frame_thk,
		(A-0.138)/2+0.04,0.88,15,
		(A-0.138)/2+0.04,B-0.22,15,
		(A-0.218),B-0.22,15,
		(A-0.218),0.88,15,
		(A-0.138)/2+0.04,0.88,-1,

		(A-0.138)/2+0.05,0.89,15,
		(A-0.138)/2+0.05,B-0.23,15,
		(A-0.228),B-0.23,15,
		(A-0.228),0.89,15,
		(A-0.138)/2+0.05,0.89,-1
else
	addz -0.01
	prism_ 10,0.01,
		0.08,0.15,15,
		(A-0.138)/2-0.04,0.15,15,
		(A-0.138)/2-0.04,0.73,15,
		0.08,0.73,15,
		0.08,0.15,-1,

		0.09,0.16,15,
		(A-0.138)/2-0.05,0.16,15,
		(A-0.138)/2-0.05,0.72,15,
		0.09,0.72,15,
		0.09,0.16,-1

	prism_ 10,0.01,
		(A-0.138)/2+0.04,0.15,15,
		(A-0.138)/2+0.04,0.73,15,
		(A-0.218),0.73,15,
		(A-0.218),0.15,15,
		(A-0.138)/2+0.04,0.15,-1,

		(A-0.138)/2+0.05,0.16,15,
		(A-0.138)/2+0.05,0.72,15,
		(A-0.228),0.72,15,
		(A-0.228),0.16,15,
		(A-0.138)/2+0.05,0.16,-1

	prism_ 10,0.01,
		0.08,0.88,15,
		(A-0.138)/2-0.04,0.88,15,
		(A-0.138)/2-0.04,B-0.22,15,
		0.08,B-0.22,15,
		0.08,0.88,-1,

		0.09,0.89,15,
		(A-0.138)/2-0.05,0.89,15,
		(A-0.138)/2-0.05,B-0.23,15,
		0.09,B-0.23,15,
		0.09,0.89,-1

	prism_ 10,0.01,
		(A-0.138)/2+0.04,0.88,15,
		(A-0.138)/2+0.04,B-0.22,15,
		(A-0.218),B-0.22,15,
		(A-0.218),0.88,15,
		(A-0.138)/2+0.04,0.88,-1,

		(A-0.138)/2+0.05,0.89,15,
		(A-0.138)/2+0.05,B-0.23,15,
		(A-0.228),B-0.23,15,
		(A-0.228),0.89,15,
		(A-0.138)/2+0.05,0.89,-1
	del 1

	addz gs_leaf_thk
	prism_ 10,0.01,
		0.08,0.15,15,
		(A-0.138)/2-0.04,0.15,15,
		(A-0.138)/2-0.04,0.73,15,
		0.08,0.73,15,
		0.08,0.15,-1,

		0.09,0.16,15,
		(A-0.138)/2-0.05,0.16,15,
		(A-0.138)/2-0.05,0.72,15,
		0.09,0.72,15,
		0.09,0.16,-1

	prism_ 10,0.01,
		(A-0.138)/2+0.04,0.15,15,
		(A-0.138)/2+0.04,0.73,15,
		(A-0.218),0.73,15,
		(A-0.218),0.15,15,
		(A-0.138)/2+0.04,0.15,-1,

		(A-0.138)/2+0.05,0.16,15,
		(A-0.138)/2+0.05,0.72,15,
		(A-0.228),0.72,15,
		(A-0.228),0.16,15,
		(A-0.138)/2+0.05,0.16,-1

	prism_ 10,0.01,
		0.08,0.88,15,
		(A-0.138)/2-0.04,0.88,15,
		(A-0.138)/2-0.04,B-0.22,15,
		0.08,B-0.22,15,
		0.08,0.88,-1,

		0.09,0.89,15,
		(A-0.138)/2-0.05,0.89,15,
		(A-0.138)/2-0.05,B-0.23,15,
		0.09,B-0.23,15,
		0.09,0.89,-1

	prism_ 10,0.01,
		(A-0.138)/2+0.04,0.88,15,
		(A-0.138)/2+0.04,B-0.22,15,
		(A-0.218),B-0.22,15,
		(A-0.218),0.88,15,
		(A-0.138)/2+0.04,0.88,-1,

		(A-0.138)/2+0.05,0.89,15,
		(A-0.138)/2+0.05,B-0.23,15,
		(A-0.228),B-0.23,15,
		(A-0.228),0.89,15,
		(A-0.138)/2+0.05,0.89,-1
	del 1
endif
del 1
RETURN

19:
!!!!!******************** ASKDALE 6 !!!!!


addx -a/2
a=a+0.138
b=b+0.11

material gs_leaf_mat

gosub 1200


body -1
pen gs_glass_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_glass_pen_cont
material gs_glass_mat
if lod3D = 5 then
	prism_ 5,gs_leaf_thk,
		0.09,0.16,15,
		(A-0.138)/2-0.05,0.16,15,
		(A-0.138)/2-0.05,0.72,15,
		0.09,0.72,15,
		0.09,0.16,-1

	prism_ 5,gs_leaf_thk,
		(A-0.138)/2+0.05,0.16,15,
		(A-0.138)/2+0.05,0.72,15,
		(A-0.228),0.72,15,
		(A-0.228),0.16,15,
		(A-0.138)/2+0.05,0.16,-1

	prism_ 5,gs_leaf_thk,
		0.09,0.89,15,
		(A-0.138)/2-0.05,0.89,15,
		(A-0.138)/2-0.05,B-0.31-((A-0.316)/2),15,
		0.09,B-0.31-((A-0.316)/2),15,
		0.09,0.89,-1

	prism_ 5,gs_leaf_thk,
		0.09,B-0.21-((A-0.316)/2),15,
		(A-0.138)/2-0.05,B-0.21-((A-0.316)/2),15,
		(A-0.138)/2-0.05,B-0.23,15,
		0.09,B-0.23,15,
		0.09,B-0.21-((A-0.316)/2),-1

	prism_ 5,gs_leaf_thk,
		(A-0.138)/2+0.05,0.89,15,
		(A-0.138)/2+0.05,B-0.31-((A-0.316)/2),15,
		(A-0.228),B-0.31-((A-0.316)/2),15,
		(A-0.228),0.89,15,
		(A-0.138)/2+0.05,0.89,-1

	prism_ 5,gs_leaf_thk,
		(A-0.138)/2+0.05,B-0.21-((A-0.316)/2),15,
		(A-0.138)/2+0.05,B-0.23,15,
		(A-0.228),B-0.23,15,
		(A-0.228),B-0.21-((A-0.316)/2),15,
		(A-0.138)/2+0.05,B-0.21-((A-0.316)/2),-1
else
	prism_ 4,gs_leaf_thk,
		0.08,0.15,15,
		(A-0.138)/2-0.04,0.15,15,
		(A-0.138)/2-0.04,0.73,15,
		0.08,0.73,15

	prism_ 4,gs_leaf_thk,
		(A-0.138)/2+0.04,0.15,15,
		(A-0.138)/2+0.04,0.73,15,
		(A-0.218),0.73,15,
		(A-0.218),0.15,15

	prism_ 4,gs_leaf_thk,
		0.08,0.88,15,
		(A-0.138)/2-0.04,0.88,15,
		(A-0.138)/2-0.04,B-0.3-((A-0.316)/2),15,
		0.08,B-0.3-((A-0.316)/2),15

	prism_ 4,gs_leaf_thk,
		(A-0.138)/2+0.04,0.88,15,
		(A-0.138)/2+0.04,B-0.3-((A-0.316)/2),15,
		(A-0.218),B-0.3-((A-0.316)/2),15,
		(A-0.218),0.88,15

	prism_ 4,gs_leaf_thk,
		0.08,B-0.22-((A-0.316)/2),15,
		(A-0.138)/2-0.04,B-0.22-((A-0.316)/2),15,
		(A-0.138)/2-0.04,B-0.22,15,
		0.08,B-0.22,15

	prism_ 4,gs_leaf_thk,
		(A-0.138)/2+0.04,B-0.22-((A-0.316)/2),15,
		(A-0.138)/2+0.04,B-0.22,15,
		(A-0.218),B-0.22,15,
		(A-0.218),B-0.22-((A-0.316)/2),15
endif

body -1
pen gs_leaf_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_leaf_pen_cont
material gs_leaf_mat2
if lod3D = 5 then
	prism_ 10,gs_frame_thk,
		0.08,0.15,15,
		(A-0.138)/2-0.04,0.15,15,
		(A-0.138)/2-0.04,0.73,15,
		0.08,0.73,15,
		0.08,0.15,-1,

		0.09,0.16,15,
		(A-0.138)/2-0.05,0.16,15,
		(A-0.138)/2-0.05,0.72,15,
		0.09,0.72,15,
		0.09,0.16,-1

	prism_ 10,gs_frame_thk,
		(A-0.138)/2+0.04,0.15,15,
		(A-0.138)/2+0.04,0.73,15,
		(A-0.218),0.73,15,
		(A-0.218),0.15,15,
		(A-0.138)/2+0.04,0.15,-1,

		(A-0.138)/2+0.05,0.16,15,
		(A-0.138)/2+0.05,0.72,15,
		(A-0.228),0.72,15,
		(A-0.228),0.16,15,
		(A-0.138)/2+0.05,0.16,-1

	prism_ 10,gs_frame_thk,
		 0.08,0.88,15,
		(A-0.138)/2-0.04,0.88,15,
		(A-0.138)/2-0.04,B-0.3-((A-0.316)/2),15,
		0.08,B-0.3-((A-0.316)/2),15,
		0.08,0.88,-1,

		0.09,0.89,15,
		(A-0.138)/2-0.05,0.89,15,
		(A-0.138)/2-0.05,B-0.31-((A-0.316)/2),15,
		0.09,B-0.31-((A-0.316)/2),15,
		0.09,0.89,-1

	prism_ 10,gs_frame_thk,
		0.08,B-0.22-((A-0.316)/2),15,
		(A-0.138)/2-0.04,B-0.22-((A-0.316)/2),15,
		(A-0.138)/2-0.04,B-0.22,15,
		0.08,B-0.22,15,
		0.08,B-0.22-((A-0.316)/2),-1,

		0.09,B-0.21-((A-0.316)/2),15,
		(A-0.138)/2-0.05,B-0.21-((A-0.316)/2),15,
		(A-0.138)/2-0.05,B-0.23,15,
		0.09,B-0.23,15,
		0.09,B-0.21-((A-0.316)/2),-1

	prism_ 10,gs_frame_thk,
		(A-0.138)/2+0.04,0.88,15,
		(A-0.138)/2+0.04,B-0.3-((A-0.316)/2),15,
		(A-0.218),B-0.3-((A-0.316)/2),15,
		(A-0.218),0.88,15,
		(A-0.138)/2+0.04,0.88,-1,

		(A-0.138)/2+0.05,0.89,15,
		(A-0.138)/2+0.05,B-0.31-((A-0.316)/2),15,
		(A-0.228),B-0.31-((A-0.316)/2),15,
		(A-0.228),0.89,15,
		(A-0.138)/2+0.05,0.89,-1

	prism_ 10,gs_frame_thk,
		(A-0.138)/2+0.04,B-0.22-((A-0.316)/2),15,
		(A-0.138)/2+0.04,B-0.22,15,
		(A-0.218),B-0.22,15,
		(A-0.218),B-0.22-((A-0.316)/2),15,
		(A-0.138)/2+0.04,B-0.22-((A-0.316)/2),-1,

		(A-0.138)/2+0.05,B-0.21-((A-0.316)/2),15,
		(A-0.138)/2+0.05,B-0.23,15,
		(A-0.228),B-0.23,15,
		(A-0.228),B-0.21-((A-0.316)/2),15,
		(A-0.138)/2+0.05,B-0.21-((A-0.316)/2),-1
else
	addz-0.01
	prism_ 10,0.01,
		0.08,0.15,15,
		(A-0.138)/2-0.04,0.15,15,
		(A-0.138)/2-0.04,0.73,15,
		0.08,0.73,15,
		0.08,0.15,-1,

		0.09,0.16,15,
		(A-0.138)/2-0.05,0.16,15,
		(A-0.138)/2-0.05,0.72,15,
		0.09,0.72,15,
		0.09,0.16,-1

	prism_ 10,0.01,
		(A-0.138)/2+0.04,0.15,15,
		(A-0.138)/2+0.04,0.73,15,
		(A-0.218),0.73,15,
		(A-0.218),0.15,15,
		(A-0.138)/2+0.04,0.15,-1,

		(A-0.138)/2+0.05,0.16,15,
		(A-0.138)/2+0.05,0.72,15,
		(A-0.228),0.72,15,
		(A-0.228),0.16,15,
		(A-0.138)/2+0.05,0.16,-1

	prism_ 10,0.01,
		0.08,0.88,15,
		(A-0.138)/2-0.04,0.88,15,
		(A-0.138)/2-0.04,B-0.3-((A-0.316)/2),15,
		0.08,B-0.3-((A-0.316)/2),15,
		0.08,0.88,-1,

		 0.09,0.89,15,
		(A-0.138)/2-0.05,0.89,15,
		(A-0.138)/2-0.05,B-0.31-((A-0.316)/2),15,
		0.09,B-0.31-((A-0.316)/2),15,
		0.09,0.89,-1

	prism_ 10,0.01,
		0.08,B-0.22-((A-0.316)/2),15,
		(A-0.138)/2-0.04,B-0.22-((A-0.316)/2),15,
		(A-0.138)/2-0.04,B-0.22,15,
		0.08,B-0.22,15,
		0.08,B-0.22-((A-0.316)/2),-1,

		0.09,B-0.21-((A-0.316)/2),15,
		(A-0.138)/2-0.05,B-0.21-((A-0.316)/2),15,
		(A-0.138)/2-0.05,B-0.23,15,
		0.09,B-0.23,15,
		0.09,B-0.21-((A-0.316)/2),-1

	prism_ 10,0.01,
		(A-0.138)/2+0.04,0.88,15,
		(A-0.138)/2+0.04,B-0.3-((A-0.316)/2),15,
		(A-0.218),B-0.3-((A-0.316)/2),15,
		(A-0.218),0.88,15,
		(A-0.138)/2+0.04,0.88,-1,

		(A-0.138)/2+0.05,0.89,15,
		(A-0.138)/2+0.05,B-0.31-((A-0.316)/2),15,
		(A-0.228),B-0.31-((A-0.316)/2),15,
		(A-0.228),0.89,15,
		(A-0.138)/2+0.05,0.89,-1

	prism_ 10,0.01,
		(A-0.138)/2+0.04,B-0.22-((A-0.316)/2),15,
		(A-0.138)/2+0.04,B-0.22,15,
		(A-0.218),B-0.22,15,
		(A-0.218),B-0.22-((A-0.316)/2),15,
		(A-0.138)/2+0.04,B-0.22-((A-0.316)/2),-1,

		(A-0.138)/2+0.05,B-0.21-((A-0.316)/2),15,
		(A-0.138)/2+0.05,B-0.23,15,
		(A-0.228),B-0.23,15,
		(A-0.228),B-0.21-((A-0.316)/2),15,
		(A-0.138)/2+0.05,B-0.21-((A-0.316)/2),-1
	del 1

	addz gs_leaf_thk
	prism_ 10,0.01,
		0.08,0.15,15,
		(A-0.138)/2-0.04,0.15,15,
		(A-0.138)/2-0.04,0.73,15,
		0.08,0.73,15,
		0.08,0.15,-1,

		0.09,0.16,15,
		(A-0.138)/2-0.05,0.16,15,
		(A-0.138)/2-0.05,0.72,15,
		0.09,0.72,15,
		0.09,0.16,-1

	prism_ 10,0.01,
		(A-0.138)/2+0.04,0.15,15,
		(A-0.138)/2+0.04,0.73,15,
		(A-0.218),0.73,15,
		(A-0.218),0.15,15,
		(A-0.138)/2+0.04,0.15,-1,

		(A-0.138)/2+0.05,0.16,15,
		(A-0.138)/2+0.05,0.72,15,
		(A-0.228),0.72,15,
		(A-0.228),0.16,15,
		(A-0.138)/2+0.05,0.16,-1

	prism_ 10,0.01,
		0.08,0.88,15,
		(A-0.138)/2-0.04,0.88,15,
		(A-0.138)/2-0.04,B-0.3-((A-0.316)/2),15,
		0.08,B-0.3-((A-0.316)/2),15,
		0.08,0.88,-1,

		0.09,0.89,15,
		(A-0.138)/2-0.05,0.89,15,
		(A-0.138)/2-0.05,B-0.31-((A-0.316)/2),15,
		0.09,B-0.31-((A-0.316)/2),15,
		0.09,0.89,-1

	prism_ 10,0.01,
		0.08,B-0.22-((A-0.316)/2),15,
		(A-0.138)/2-0.04,B-0.22-((A-0.316)/2),15,
		(A-0.138)/2-0.04,B-0.22,15,
		0.08,B-0.22,15,
		0.08,B-0.22-((A-0.316)/2),-1,

		0.09,B-0.21-((A-0.316)/2),15,
		(A-0.138)/2-0.05,B-0.21-((A-0.316)/2),15,
		(A-0.138)/2-0.05,B-0.23,15,
		0.09,B-0.23,15,
		0.09,B-0.21-((A-0.316)/2),-1

	prism_ 10,0.01,
		(A-0.138)/2+0.04,0.88,15,
		(A-0.138)/2+0.04,B-0.3-((A-0.316)/2),15,
		(A-0.218),B-0.3-((A-0.316)/2),15,
		(A-0.218),0.88,15,
		(A-0.138)/2+0.04,0.88,-1,

		(A-0.138)/2+0.05,0.89,15,
		(A-0.138)/2+0.05,B-0.31-((A-0.316)/2),15,
		(A-0.228),B-0.31-((A-0.316)/2),15,
		(A-0.228),0.89,15,
		(A-0.138)/2+0.05,0.89,-1

	prism_ 10,0.01,
		(A-0.138)/2+0.04,B-0.22-((A-0.316)/2),15,
		(A-0.138)/2+0.04,B-0.22,15,
		(A-0.218),B-0.22,15,
		(A-0.218),B-0.22-((A-0.316)/2),15,
		(A-0.138)/2+0.04,B-0.22-((A-0.316)/2),-1,

		(A-0.138)/2+0.05,B-0.21-((A-0.316)/2),15,
		(A-0.138)/2+0.05,B-0.23,15,
		(A-0.228),B-0.23,15,
		(A-0.228),B-0.21-((A-0.316)/2),15,
		(A-0.138)/2+0.05,B-0.21-((A-0.316)/2),-1
	del 1
endif
del 1
RETURN

20:
!!!!!******************** ISA !!!!!


addx -a/2
a=a+0.138
b=b+0.11

material gs_leaf_mat

base

for ii=1 to nn

	gosub 900

	sprism_{2} topmat, botmat, sidemat,
		5,
		0,  0,  1,  0,  framethick, 0,
		0,  0,  1,  0,   0,  0,
		0,0,10, sidematedge,
		0.08,0.15,mmask, sidemat,
		0.08,B-0.22,10, sidemat,
		0,B-0.11,mmask, sidematedge,
		0,0,-1, sidematedge

	sprism_{2} topmat, botmat, sidemat,
		5,
		0,  0,  1,  0,  framethick, 0,
		0,  0,  1,  0,   0,  0,
		A-0.138,0,10, sidematedge,
		A-0.218,0.15,mmask, sidemat,
		A-0.218,B-0.22,10, sidemat,
		A-0.138,B-0.11,mmask, sidematedge,
		A-0.138,0,-1, sidematedge

	gosub 500

	sprism_{2} topmat, botmat, sidemat,
		5,
		0,  0,  1,  0,  framethick, 0,
		0,  0,  1,  0,   0,  0,
		0,0,10, sidematedge,
		0.08,0.15,mmask, sidemat,
		A-0.218,0.15,10, sidemat,
		A-0.138,0,mmask, sidematedge,
		0,0,-1, sidematedge

	sprism_{2} topmat, botmat, sidemat,
		5,
		0,  0,  1,  0,  framethick, 0,
		0,  0,  1,  0,   0,  0,
		0,B-0.11,10, sidematedge,
		0.08,B-0.22,mmask, sidemat,
		A-0.218,B-0.22,10, sidemat,
		A-0.138,B-0.11,mmask, sidematedge,
		0,B-0.11,-1, sidematedge

	gosub 600

	addz framethick

next ii

del nn


body -1


gridWidth = 0.02
gridDistX = (A-0.298+gridWidth)/3
gridDistY = (B-0.37+gridWidth)/5

if lod3D = 5 then
	glassPanelX = gridDistX - gridWidth
	glassPanelY = gridDistY - gridWidth

	pen gs_glass_pen
	sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_glass_pen_cont
	material gs_glass_mat

	dy = 0.15
	for I=1 to 5
		dx = 0.08
		for H=1 to 3
			add dx, dy, 0
			prism_ 5,gs_glass_thk,
				0,0,15,
				glassPanelX,0,15,
				glassPanelX,glassPanelY,15,
				0,glassPanelY,15,
				0,0,-1
			del 1
			dx = dx + gridDistX
		next H
		dy = dy + gridDistY
	next I

	body -1


	base

	pen gs_leaf_pen
	sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_leaf_pen_cont

	material mulbotmat

	dx = 0.08 - gridWidth/2 + gridDistX
	for H=1 to 2
		addx dx
		prism_ 4,gs_frame_thk,
			-gridWidth/2,0.15,15,
			-gridWidth/2,B-0.22,15,
			gridWidth/2,B-0.22,15,
			gridWidth/2,0.15,15
		del 1
		dx = dx + gridDistX
	next H

	gosub 500

	dy = 0.15 - gridWidth/2 + gridDistY
	for I=1 to 4
		dx = 0.08
		for H=1 to 3
			add dx, dy, 0
			prism_ 4,gs_frame_thk,
				0,-gridWidth/2,15,
				0,gridWidth/2,15,
				glassPanelX,gridWidth/2,15,
				glassPanelX,-gridWidth/2,15
			del 1
			dx = dx + gridDistX
		next H
		dy = dy + gridDistY
	next I

	gosub 600

	body -1
else
	pen gs_glass_pen
	sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_glass_pen_cont
	material gs_glass_mat
	addz gs_leaf_thk/2-gs_glass_thk/2

	prism_ 5,gs_glass_thk,
		0.08,0.15,15,
		(A-0.218),0.15,15,
		(A-0.218),B-0.22,15,
		0.08,B-0.22,15,
		0.08,0.15,-1

	del 1

	body -1

	base
	addz gs_leaf_thk/2-0.0125-0.005
	pen gs_leaf_pen
	sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_leaf_pen_cont

	material mulbotmat

	dx = 0.08 - gridWidth/2 + gridDistX
	for H=1 to 2
		addx dx
		prism_ 4,0.0125,
			-gridWidth/2,0.15,15,
			-gridWidth/2,B-0.22,15,
			gridWidth/2,B-0.22,15,
			gridWidth/2,0.15,15
		del 1
		dx = dx + gridDistX
	next H

	gosub 500

	addz 0.0005
	dy = 0.15 - gridWidth/2 + gridDistY
	for I=1 to 4
		addy dy
		prism_ 4,0.012,
			0.08,-gridWidth/2,15,
			0.08,gridWidth/2,15,
			(A-0.218),gridWidth/2,15,
			(A-0.218),-gridWidth/2,15
		del 1
		dy = dy + gridDistY
	next I
	gosub 600

	material multopmat

	addz 0.012+0.01
	dx = 0.08 - gridWidth/2 + gridDistX
	for H=1 to 2
		addx dx
		prism_ 4,0.0125,
			-gridWidth/2,0.15,15,
			-gridWidth/2,B-0.22,15,
			gridWidth/2,B-0.22,15,
			gridWidth/2,0.15,15
		del 1
		dx = dx + gridDistX
	next H

	gosub 500

	dy = 0.15 - gridWidth/2 + gridDistY
	for I=1 to 4
		addy dy
		prism_ 4,0.012,
			0.08,-gridWidth/2,15,
			0.08,gridWidth/2,15,
			(A-0.218),gridWidth/2,15,
			(A-0.218),-gridWidth/2,15
		del 1
		dy = dy + gridDistY
	next I
	del 3

	gosub 600
endif
RETURN


21:
!!!!!******************** ISA_S !!!!!


addx -a/2
a=a+0.138
b=b+0.11
Ar=min(0.10, (A-0.298)/2)

ang = atn(((A-0.298)/2)/Ar)
if ang < 45 then
	archR = Ar
else
	archR = ((A-0.298)/2)/sin(180-2*ang)
endif

material gs_leaf_mat

for ii=1 to nn

	gosub 900

	if gs_SashText_typ_num = 1 then

		base

		sprism_{2} topmat, botmat, sidemat,
			5,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0,10, sidematedge,
			0.08,0.15,mmask, sidemat,
			0.08,B-0.22-Ar,10, sidemat,
			0,B-0.11,mmask, sidematedge,
			0,0,-1, sidematedge

		sprism_{2} topmat, botmat, sidemat,
			5,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			A-0.138,0,10, sidematedge,
			A-0.218,0.15,mmask, sidemat,
			A-0.218,B-0.22-Ar,10, sidemat,
			A-0.138,B-0.11,mmask, sidematedge,
			A-0.138,0,-1, sidematedge

		gosub 500

		sprism_{2} topmat, botmat, sidemat,
			5,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0,10, sidematedge,
			0.08,0.15,mmask, sidemat,
			A-0.218,0.15,10, sidemat,
			A-0.138,0,mmask, sidematedge,
			0,0,-1, sidematedge

		sprism_{2} topmat, botmat, sidemat,
			7,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			(A-0.218),B-0.22-Ar,mmask2, sidemat,
			(A-0.138)/2,B-0.22-archR,900, sidemat,
			(A-0.138)/2,B-0.22,3000+mmask2, sidemat,
			0.08,B-0.22-Ar,3010, sidemat,
			0,B-0.11,mmask, sidemat,
			A-0.138,B-0.11,10, sidematedge,
			(A-0.218),B-0.26-Ar,-1, sidematedge

		gosub 600

	endif

	if gs_SashText_typ_num = 2 then

		base

		sprism_{2} topmat, botmat, sidemat,
			5,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0.15,8, sidematedge,
			0.08,0.15,mmask, sidemat,
			0.08,B-0.22-Ar,10, sidemat,
			0,B-0.22-Ar,mmask2, sidematedge,
			0,0.15,-1, sidematedge

		sprism_{2} topmat, botmat, sidemat,
			5,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			A-0.138,0.15,8, sidematedge,
			A-0.218,0.15,mmask, sidemat,
			A-0.218,B-0.22-Ar,10, sidemat,
			A-0.138,B-0.22-Ar,mmask2, sidematedge,
			A-0.138,0.15,-1, sidematedge

		gosub 500

		sprism_{2} topmat, botmat, sidemat,
			7,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0,15, sidematedge,
			0,0.15,8, sidemat,
			0.08,0.15,mmask, sidemat,
			A-0.218,0.15,10, sidemat,
			A-0.138,0.15,mmask2, sidematedge,
			A-0.138,0,mmask, sidematedge,
			0,0,-1, sidematedge

		sprism_{2} topmat, botmat, sidemat,
			9,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			(A-0.218),B-0.22-Ar,mmask2, sidemat,
			(A-0.138)/2,B-0.22-archR,900, sidemat,
			(A-0.138)/2,B-0.22,3000+mmask2, sidemat,
			0.08,B-0.22-Ar,3010, sidemat,
			0,B-0.22-Ar,13, sidemat,
			0,B-0.11,mmask, sidemat,
			A-0.138,B-0.11,mmask, sidematedge,
			A-0.138,B-0.22-Ar,8, sidematedge,
			(A-0.218),B-0.22-Ar,-1, sidematedge

		gosub 600

	endif

	addz framethick

next ii

del nn

body -1


gridWidth = 0.02
gridDistX = (A-0.298+gridWidth)/3
gridDistY = (B-0.37+gridWidth)/5

if lod3D = 5 then
	glassPanelX = gridDistX - gridWidth
	glassPanelY = gridDistY - gridWidth

	pen gs_glass_pen
	sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_glass_pen_cont
	material gs_glass_mat

	cutform 9, 1, 2 + 16,
			0, 0, -1, 0,
			(A-0.218),B-0.22-Ar,29,
			(A-0.138)/2,B-0.22-archR,931,
			(A-0.138)/2,B-0.22,3029,
			0.08,B-0.22-Ar,3031,
			0,B-0.22-Ar,31,
			0,B-0.11,31,
			A-0.138,B-0.11,31,
			A-0.138,B-0.22-Ar,31,
			(A-0.218),B-0.22-Ar,-1

	dy = 0.15
	for I=1 to 5
		dx = 0.08
		for H=1 to 3
			add dx, dy, 0
			prism_ 5,gs_glass_thk,
				0,0,15,
				glassPanelX,0,15,
				glassPanelX,glassPanelY,15,
				0,glassPanelY,15,
				0,0,-1
			del 1
			dx = dx + gridDistX
		next H
		dy = dy + gridDistY
	next I

	cutend

	body -1


	base

	pen gs_leaf_pen
	sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_leaf_pen_cont

	material mulbotmat

	cutform 9, 1, 2 + 16,
			0, 0, -1, 0,
			(A-0.218),B-0.22-Ar,29,
			(A-0.138)/2,B-0.22-archR,931,
			(A-0.138)/2,B-0.22,3029,
			0.08,B-0.22-Ar,3031,
			0,B-0.22-Ar,31,
			0,B-0.11,31,
			A-0.138,B-0.11,31,
			A-0.138,B-0.22-Ar,31,
			(A-0.218),B-0.22-Ar,-1

	dx = 0.08 - gridWidth/2 + gridDistX
	for H=1 to 2
		addx dx
		prism_ 4,gs_frame_thk,
			-gridWidth/2,0.15,15,
			-gridWidth/2,B-0.22,15,
			gridWidth/2,B-0.22,15,
			gridWidth/2,0.15,15
		del 1
		dx = dx + gridDistX
	next H

	cutend

	gosub 500

	dy = 0.15 - gridWidth/2 + gridDistY
	for I=1 to 4
		dx = 0.08
		for H=1 to 3
			add dx, dy, 0
			prism_ 4,gs_frame_thk,
				0,-gridWidth/2,15,
				0,gridWidth/2,15,
				glassPanelX,gridWidth/2,15,
				glassPanelX,-gridWidth/2,15
			del 1
			dx = dx + gridDistX
		next H
		dy = dy + gridDistY
	next I

	gosub 600

	body -1
else
	pen gs_glass_pen
	sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_glass_pen_cont
	material gs_glass_mat
	addz gs_leaf_thk/2-gs_glass_thk/2

	prism_ 7,gs_glass_thk,
		0.08,0.15,15,
		(A-0.218),0.15,15,
		(A-0.218),B-0.22-Ar,13,
		(A-0.138)/2,B-0.22-archR,900,
		(A-0.138)/2,B-0.22,3013,
		0.08,B-0.22-Ar,3015,
		0.08,0.15,-1

	del 1

	body -1
	addz gs_leaf_thk/2-0.0125-0.005
	pen gs_leaf_pen
	sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_leaf_pen_cont

	material mulbotmat

	for H=1 to 2
		prism_ 4,0.0125,
			0.08+(A-0.298)/3+0.01,0.15,15,
			0.08+(A-0.298)/3+0.01,B-0.21,15,
			0.08+(A-0.298)/3-0.01,B-0.21,15,
			0.08+(A-0.298)/3-0.01,0.15,15
		body -1
		addx (A-0.298)/3
	next H
	del 2

	addz 0.0005
	for I=1 to 4
		prism_ 4,0.012,
			0.08,0.15+(B-0.37)/5-0.01,15,
			0.08,0.15+(B-0.37)/5+0.01,15,
			(A-0.218),0.15+(B-0.37)/5+0.01,15,
			(A-0.218),0.15+(B-0.37)/5-0.01,15
		body -1
		addy (B-0.37)/5
	next I
	del 4

	material multopmat

	addz 0.012+0.01
	for H=1 to 2
		prism_ 4,0.0125,
			0.08+(A-0.298)/3+0.01,0.15,15,
			0.08+(A-0.298)/3+0.01,B-0.21,15,
			0.08+(A-0.298)/3-0.01,B-0.21,15,
			0.08+(A-0.298)/3-0.01,0.15,15
		body -1
		addx (A-0.298)/3
	next H
	del 2
	for I=1 to 4
	prism_ 4,0.012,
		0.08,0.15+(B-0.37)/5-0.01,15,
		0.08,0.15+(B-0.37)/5+0.01,15,
		(A-0.218),0.15+(B-0.37)/5+0.01,15,
		(A-0.218),0.15+(B-0.37)/5-0.01,15

		body -1
		addy (B-0.37)/5
	next I
	del I
endif
del 3
RETURN




22:
!!!!!******************** SPECIAL !!!!!

addx -a/2
a=a+0.138
b=b+0.11

material gs_leaf_mat

mulx -1
addx -A+0.138


for ii=1 to nn

	gosub 900

	if lod3D = 5 then
		sprism_{2} topmat, botmat, sidemat,
			10,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0,mmask, sidematedge,
			A-0.138,0,mmask, sidematedge,
			A-0.138,B-0.11,mmask, sidematedge,
			0,B-0.11,mmask, sidematedge,
			0,0,-1, sidematedge,

			0.07,B-0.22-0.4,mmask, sidemat,
			0.25,B-0.22-0.4,mmask, sidemat,
			0.25,B-0.21,mmask, sidemat,
			0.07,B-0.21,mmask, sidemat,
			0.07,B-0.22-0.4,-1, sidemat
	else
		sprism_{2} topmat, botmat, sidemat,
			10,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0,mmask, sidematedge,
			A-0.138,0,mmask, sidematedge,
			A-0.138,B-0.11,mmask, sidematedge,
			0,B-0.11,mmask, sidematedge,
			0,0,-1, sidematedge,

			0.08,B-0.22-0.39,mmask, sidemat,
			0.24,B-0.22-0.39,mmask, sidemat,
			0.24,B-0.22,mmask, sidemat,
			0.08,B-0.22,mmask, sidemat,
			0.08,B-0.22-0.39,-1, sidemat
	endif

	gosub 600

	addz framethick

next ii

del nn

body -1
pen gs_glass_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_glass_pen_cont
material gs_glass_mat
addz gs_leaf_thk/2-gs_glass_thk/2
prism_ 5,gs_glass_thk,
	0.08,B-0.22-0.39,15,
	0.24,B-0.22-0.39,15,
	0.24,B-0.22,15,
	0.08,B-0.22,15,
	0.08,B-0.22-0.39,-1
del 1

body -1
pen gs_leaf_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_leaf_pen_cont
material gs_leaf_mat2
if lod3D = 5 then
	prism_ 10,gs_frame_thk,
		0.07,B-0.22-0.4,15,
		0.25,B-0.22-0.4,15,
		0.25,B-0.21,15,
		0.07,B-0.21,15,
		0.07,B-0.22-0.4,-1,

		0.08,B-0.22-0.39,15,
		0.24,B-0.22-0.39,15,
		0.24,B-0.22,15,
		0.08,B-0.22,15,
		0.08,B-0.22-0.39,-1
else
	addz -0.01
	prism_ 10,0.01,
		0.07,B-0.22-0.4,15,
		0.25,B-0.22-0.4,15,
		0.25,B-0.21,15,
		0.07,B-0.21,15,
		0.07,B-0.22-0.4,-1,

		0.08,B-0.22-0.39,15,
		0.24,B-0.22-0.39,15,
		0.24,B-0.22,15,
		0.08,B-0.22,15,
		0.08,B-0.22-0.39,-1
	del 1

	addz gs_leaf_thk
	prism_ 10,0.01,
		0.07,B-0.22-0.4,15,
		0.25,B-0.22-0.4,15,
		0.25,B-0.21,15,
		0.07,B-0.21,15,
		0.07,B-0.22-0.4,-1,

		0.08,B-0.22-0.39,15,
		0.24,B-0.22-0.39,15,
		0.24,B-0.22,15,
		0.08,B-0.22,15,
		0.08,B-0.22-0.39,-1
	del 1
endif
del 3
RETURN

23:
!!!!!******************** SPECIAL 2 !!!!!


addx -a/2
a=a+0.138
b=b+0.11

material gs_leaf_mat

mulx -1
addx -A+0.138


for ii=1 to nn

	gosub 900

	if lod3D = 5 then
		sprism_{2} topmat, botmat, sidemat,
			15,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0,mmask, sidematedge,
			A-0.138,0,mmask, sidematedge,
			A-0.138,B-0.11,mmask, sidematedge,
			0,B-0.11,mmask, sidematedge,
			0,0,-1, sidematedge,

			0.07,1.09,mmask, sidemat,
			0.25,1.09,mmask, sidemat,
			0.25,B-0.21,mmask, sidemat,
			0.07,B-0.21,mmask, sidemat,
			0.07,1.09,-1, sidemat,

			0.07,0.14,mmask, sidemat,
			0.25,0.14,mmask, sidemat,
			0.25,0.91,mmask, sidemat,
			0.07,0.91,mmask, sidemat,
			0.07,0.14,-1, sidemat
	else
		sprism_{2} topmat, botmat, sidemat,
			15,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0,mmask, sidematedge,
			A-0.138,0,mmask, sidematedge,
			A-0.138,B-0.11,mmask, sidematedge,
			0,B-0.11,mmask, sidematedge,
			0,0,-1, sidematedge,

			0.08,1.1,mmask, sidemat,
			0.24,1.1,mmask, sidemat,
			0.24,B-0.22,mmask, sidemat,
			0.08,B-0.22,mmask, sidemat,
			0.08,1.1,-1, sidemat,

			0.08,0.15,mmask, sidemat,
			0.24,0.15,mmask, sidemat,
			0.24,0.9,mmask, sidemat,
			0.08,0.9,mmask, sidemat,
			0.08,0.15,-1, sidemat
	endif

		gosub 600

	addz framethick

next ii

del nn



body -1
pen gs_glass_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_glass_pen_cont
material gs_glass_mat
addz gs_leaf_thk/2-gs_glass_thk/2
prism_ 5,gs_glass_thk,
	0.08,1.1,15,
	0.24,1.1,15,
	0.24,B-0.22,15,
	0.08,B-0.22,15,
	0.08,1.1,-1

prism_ 5,gs_glass_thk,
	 0.08,0.15,15,
	0.24,0.15,15,
	0.24,0.9,15,
	0.08,0.9,15,
	0.08,0.15,-1

del 1

body -1
pen gs_leaf_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_leaf_pen_cont
material gs_leaf_mat2
if lod3D = 5 then
	prism_ 10,gs_frame_thk,
		0.07,1.09,15,
		0.25,1.09,15,
		0.25,B-0.21,15,
		0.07,B-0.21,15,
		0.07,1.09,-1,

		0.08,1.1,15,
		0.24,1.1,15,
		0.24,B-0.22,15,
		0.08,B-0.22,15,
		0.08,1.1,-1

	prism_ 10,gs_frame_thk,
		0.07,0.14,15,
		0.25,0.14,15,
		0.25,0.91,15,
		0.07,0.91,15,
		0.07,0.14,-1,

		0.08,0.15,15,
		0.24,0.15,15,
		0.24,0.9,15,
		0.08,0.9,15,
		0.08,0.15,-1
else
	addz -0.01
	prism_ 10,0.01,
		0.07,1.09,15,
		0.25,1.09,15,
		0.25,B-0.21,15,
		0.07,B-0.21,15,
		0.07,1.09,-1,

		0.08,1.1,15,
		0.24,1.1,15,
		0.24,B-0.22,15,
		0.08,B-0.22,15,
		0.08,1.1,-1

	prism_ 10,0.01,
		0.07,0.14,15,
		0.25,0.14,15,
		0.25,0.91,15,
		0.07,0.91,15,
		0.07,0.14,-1,

		0.08,0.15,15,
		0.24,0.15,15,
		0.24,0.9,15,
		0.08,0.9,15,
		0.08,0.15,-1
	del 1

	addz gs_leaf_thk
	prism_ 10,0.01,
		0.07,1.09,15,
		0.25,1.09,15,
		0.25,B-0.21,15,
		0.07,B-0.21,15,
		0.07,1.09,-1,

		0.08,1.1,15,
		0.24,1.1,15,
		0.24,B-0.22,15,
		0.08,B-0.22,15,
		0.08,1.1,-1

	prism_ 10,0.01,
		0.07,0.14,15,
		0.25,0.14,15,
		0.25,0.91,15,
		0.07,0.91,15,
		0.07,0.14,-1,

		0.08,0.15,15,
		0.24,0.15,15,
		0.24,0.9,15,
		0.08,0.9,15,
		0.08,0.15,-1
	del 1
endif
del 3
RETURN

24:
!!!!!******************** SPECIAL 3 !!!!!


addx -a/2
a=a+0.138
b=b+0.11


material gs_leaf_mat

mulx -1
addx -A+0.138

for ii=1 to nn

	gosub 900

	if lod3D = 5 then
		sprism_{2} topmat, botmat, sidemat,
			10,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0,mmask, sidematedge,
			A-0.138,0,mmask, sidematedge,
			A-0.138,B-0.11,mmask, sidematedge,
			0,B-0.11,mmask, sidematedge,
			0,0,-1, sidematedge,

			0.07,1.09,mmask, sidemat,
			0.25,1.09,mmask, sidemat,
			0.25,B-0.21,mmask, sidemat,
			0.07,B-0.21,mmask, sidemat,
			0.07,1.09,-1, sidemat
	else
		sprism_{2} topmat, botmat, sidemat,
			10,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0,mmask, sidematedge,
			A-0.138,0,mmask, sidematedge,
			A-0.138,B-0.11,mmask, sidematedge,
			0,B-0.11,mmask, sidematedge,
			0,0,-1, sidematedge,

			0.08,1.1,mmask, sidemat,
			0.24,1.1,mmask, sidemat,
			0.24,B-0.22,mmask, sidemat,
			0.08,B-0.22,mmask, sidemat,
			0.08,1.1,-1, sidemat
		endif

		gosub 600

	addz framethick

next ii

del nn



body -1
pen gs_glass_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_glass_pen_cont
material gs_glass_mat
addz gs_leaf_thk/2-gs_glass_thk/2
prism_ 5,gs_glass_thk,
	0.08,1.1,15,
	0.24,1.1,15,
	0.24,B-0.22,15,
	0.08,B-0.22,15,
	0.08,1.1,-1
del 1

body -1
pen gs_leaf_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_leaf_pen_cont
material gs_leaf_mat2
if lod3D = 5 then
	prism_ 10,gs_frame_thk,
		0.07,1.09,15,
		0.25,1.09,15,
		0.25,B-0.21,15,
		0.07,B-0.21,15,
		0.07,1.09,-1,

		0.08,1.1,15,
		0.24,1.1,15,
		0.24,B-0.22,15,
		0.08,B-0.22,15,
		0.08,1.1,-1
else
	addz -0.01
	prism_ 10,0.01,
		0.07,1.09,15,
		0.25,1.09,15,
		0.25,B-0.21,15,
		0.07,B-0.21,15,
		0.07,1.09,-1,

		0.08,1.1,15,
		0.24,1.1,15,
		0.24,B-0.22,15,
		0.08,B-0.22,15,
		0.08,1.1,-1
	del 1

	addz gs_leaf_thk
	prism_ 10,0.01,
		0.07,1.09,15,
		0.25,1.09,15,
		0.25,B-0.21,15,
		0.07,B-0.21,15,
		0.07,1.09,-1,

		0.08,1.1,15,
		0.24,1.1,15,
		0.24,B-0.22,15,
		0.08,B-0.22,15,
		0.08,1.1,-1
	del 1
endif
del 3
RETURN

25:
!!!!!******************** SPECIAL 4 !!!!!


addx -a/2
a=a+0.138
b=b+0.11

material gs_leaf_mat

mulx -1
addx -A+0.138

for ii=1 to nn

	gosub 900

	if lod3D = 5 then
		sprism_{2} topmat, botmat, sidemat,
			10,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0,mmask, sidematedge,
			A-0.138,0,mmask, sidematedge,
			A-0.138,B-0.11,mmask, sidematedge,
			0,B-0.11,mmask, sidematedge,
			0,0,-1, sidematedge,

			0.11,B-0.22-0.4,mmask, sidemat,
			A-0.246,B-0.22-0.4,mmask, sidemat,
			A-0.246,B-0.21,mmask, sidemat,
			0.11,B-0.21,mmask, sidemat,
			0.11,B-0.22-0.4,-1, sidemat
	else
		sprism_{2} topmat, botmat, sidemat,
			10,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0,mmask, sidematedge,
			A-0.138,0,mmask, sidematedge,
			A-0.138,B-0.11,mmask, sidematedge,
			0,B-0.11,mmask, sidematedge,
			0,0,-1, sidematedge,

			0.12,B-0.22-0.39,mmask, sidemat,
			A-0.256,B-0.22-0.39,mmask, sidemat,
			A-0.256,B-0.22,mmask, sidemat,
			0.12,B-0.22,mmask, sidemat,
			0.12,B-0.22-0.39,-1, sidemat
	endif

	gosub 600

	addz framethick

next ii

del nn


body -1
pen gs_glass_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_glass_pen_cont
material gs_glass_mat
addz gs_leaf_thk/2-gs_glass_thk/2
prism_ 5,gs_glass_thk,
	0.12,B-0.22-0.39,15,
	A-0.256,B-0.22-0.39,15,
	A-0.256,B-0.22,15,
	0.12,B-0.22,15,
	0.12,B-0.22-0.39,-1
del 1

body -1
pen gs_leaf_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_leaf_pen_cont
material gs_leaf_mat2
if lod3D = 5 then
	prism_ 10,gs_frame_thk,
		0.11,B-0.22-0.4,15,
		A-0.246,B-0.22-0.4,15,
		A-0.246,B-0.21,15,
		0.11,B-0.21,15,
		0.11,B-0.22-0.4,-1,

		0.12,B-0.22-0.39,15,
		A-0.256,B-0.22-0.39,15,
		A-0.256,B-0.22,15,
		0.12,B-0.22,15,
		0.12,B-0.22-0.39,-1
else
	addz -0.01
	prism_ 10,0.01,
		0.11,B-0.22-0.4,15,
		A-0.246,B-0.22-0.4,15,
		A-0.246,B-0.21,15,
		0.11,B-0.21,15,
		0.11,B-0.22-0.4,-1,

		0.12,B-0.22-0.39,15,
		A-0.256,B-0.22-0.39,15,
		A-0.256,B-0.22,15,
		0.12,B-0.22,15,
		0.12,B-0.22-0.39,-1
	del 1

	addz gs_leaf_thk
	prism_ 10,0.01,
		0.11,B-0.22-0.4,15,
		A-0.246,B-0.22-0.4,15,
		A-0.246,B-0.21,15,
		0.11,B-0.21,15,
		0.11,B-0.22-0.4,-1,

		0.12,B-0.22-0.39,15,
		A-0.256,B-0.22-0.39,15,
		A-0.256,B-0.22,15,
		0.12,B-0.22,15,
		0.12,B-0.22-0.39,-1
	del 1
endif
del 3

RETURN

26:
!!!!!******************** SPECIAL 5 !!!!!


addx -a/2
a=a+0.138
b=b+0.11


material gs_leaf_mat

mulx -1
addx -A+0.138

for ii=1 to nn

	gosub 900

	if lod3D = 5 then
		sprism_{2} topmat, botmat, sidemat,
			10,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0,mmask, sidematedge,
			A-0.138,0,mmask, sidematedge,
			A-0.138,B-0.11,mmask, sidematedge,
			0,B-0.11,mmask, sidematedge,
			0,0,-1, sidematedge,

			0.11,1.09,mmask, sidemat,
			A-0.246,1.09,mmask, sidemat,
			A-0.246,B-0.21,mmask, sidemat,
			0.11,B-0.21,mmask, sidemat,
			0.11,1.09,-1, sidemat
	else
		sprism_{2} topmat, botmat, sidemat,
			10,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0,mmask, sidematedge,
			A-0.138,0,mmask, sidematedge,
			A-0.138,B-0.11,mmask, sidematedge,
			0,B-0.11,mmask, sidematedge,
			0,0,-1, sidematedge,

			0.12,1.1,mmask, sidemat,
			A-0.256,1.1,mmask, sidemat,
			A-0.256,B-0.22,mmask, sidemat,
			0.12,B-0.22,mmask, sidemat,
			0.12,1.1,-1, sidemat
	endif

	gosub 600

	addz framethick

next ii

del nn


body -1
pen gs_glass_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_glass_pen_cont
material gs_glass_mat
addz gs_leaf_thk/2-gs_glass_thk/2
prism_ 5,gs_glass_thk,
	0.12,1.1,15,
	A-0.256,1.1,15,
	A-0.256,B-0.22,15,
	0.12,B-0.22,15,
	0.12,1.1,-1
del 1

body -1
pen gs_leaf_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_leaf_pen_cont
material gs_leaf_mat2
if lod3D = 5 then
	prism_ 10,gs_frame_thk,
		0.11,1.09,15,
		A-0.246,1.09,15,
		A-0.246,B-0.21,15,
		0.11,B-0.21,15,
		0.11,1.09,-1,

		0.12,1.1,15,
		A-0.256,1.1,15,
		A-0.256,B-0.22,15,
		0.12,B-0.22,15,
		0.12,1.1,-1
else
	addz -0.01
	prism_ 10,0.01,
		0.11,1.09,15,
		A-0.246,1.09,15,
		A-0.246,B-0.21,15,
		0.11,B-0.21,15,
		0.11,1.09,-1,

		0.12,1.1,15,
		A-0.256,1.1,15,
		A-0.256,B-0.22,15,
		0.12,B-0.22,15,
		0.12,1.1,-1
	del 1

	addz gs_leaf_thk
	prism_ 10,0.01,
		0.11,1.09,15,
		A-0.246,1.09,15,
		A-0.246,B-0.21,15,
		0.11,B-0.21,15,
		0.11,1.09,-1,

		0.12,1.1,15,
		A-0.256,1.1,15,
		A-0.256,B-0.22,15,
		0.12,B-0.22,15,
		0.12,1.1,-1
	del 1
endif
del 3
RETURN


27:
!!!!!******************** HPL !!!!!


pen gs_glass_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_glass_pen_cont
material gs_glass_mat

add -a/2+a/5,b-b/8,gs_leaf_thk/2-gs_glass_thk/2

for i=1 to 3

	prism_ 2,gs_glass_thk,
			0,0,979,
			0.075,360,4079

	addx a/2-a/5

next i

del 4

pen gs_leaf_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_leaf_pen_cont
material gs_leaf_mat

add -a/2+a/5,b-b/8,gs_leaf_thk

for i=1 to 3

	material topmat

	if lod3D = 5 then		! Chinese
		cprism_	topmat, botmat, botmat,
				3,-gs_leaf_thk,
				0,0,979,
				0.09,360,4079,
				0.075,360,4079
	else
		prism_ 3,0.01,
				0,0,979,
				0.09,360,4079,
				0.075,360,4079

		addz -gs_leaf_thk-0.01

		material botmat

		prism_ 3,0.01,
				0,0,979,
				0.09,360,4079,
				0.075,360,4079

		del 1
	endif


	if lod3D = 5 then		! Chinese
		cutpolya 2,1,0,
				0,0,905,
				0.09,360,4005
	else
		cutpolya 2,1,0,
				0,0,905,
				0.075,360,4005
	endif


	addx a/2-a/5

next i

del 4


for ii=1 to nn

	gosub 900

	sprism_{2} topmat, botmat, sidemat,
		5,
		0,  0,  1,  0,  framethick, 0,
		0,  0,  1,  0,   0,  0,
		-a/2,0,mmask, sidematedge,
		-a/2,b,mmask, sidematedge,
		 a/2,b,mmask, sidematedge,
		 a/2,0,mmask, sidematedge,
		-a/2,0,-1, sidematedge

		gosub 600

	addz framethick

next ii

del nn


for i=1 to 3

	cutend

next i
RETURN


28:
!!!!!******************** DE ARTE LENGO !!!!!

bs=0.2

material gs_leaf_mat

f=int(b/bs)

if int(f/2)<>f/2 then
f=f+1

endif

g=bs

cutpolya 4,1,0,
		-bs/2,-b,8,
		-bs/2,b,8,
		bs/2,b,8,
		bs/2,-b,8

for ii=1 to nn

	gosub 900

	sprism_{2} topmat, botmat, sidemat,
		5,
		0,  0,  1,  0,  framethick, 0,
		0,  0,  1,  0,   0,  0,
		-a/2,0,mmask, sidematedge,
		-a/2,b,mmask, sidematedge,
		 a/2,b,mmask, sidematedge,
		 a/2,0,mmask, sidematedge,
		-a/2,0,-1, sidematedge

	gosub 600

	addz framethick
next ii

del nn

cutend

cutpolya 4,1,0,
		-a/2,0,15,
		-a/2,-1,15,
		a/2,-1,15,
		a/2,0,15

addy b-g

for i=1 to f/2+1
material gs_leaf_mat3

prism_ 4,gs_leaf_thk,
	-bs/2,0,15,
	-bs/2,g,15,
	bs/2,g,15,
	bs/2,0,15

material gs_leaf_mat2

addy -g

prism_ 4,gs_leaf_thk,
	-bs/2,0,15,
	-bs/2,g,15,
	bs/2,g,15,
	bs/2,0,15

addy -g

next i

del (f/2+1)*2
del 1

cutend

RETURN



! ************************************************************
!  Wooden Entrance Panels
! ************************************************************

29:


addx -a/2

a=a+0.138
b=b+0.11

r=((a-0.218)-((a-0.138)/2))
s1=2*atn(0.01/r)
s=(90-(1.5*s1))/2
z1=2*atn(0.01/0.1)
z=(90-(1.5*z1))/2

body -1
pen gs_leaf_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_leaf_pen_cont
material gs_leaf_mat


for ii=1 to nn

	gosub 900

	if gs_SashText_typ_num = 1 then

		base

			sprism_{2} topmat, botmat, sidemat,
				22,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				A-0.138,0,10, sidematedge,
				A-0.218,0.15,15, sidemat,
				A-0.218,0.73,10, sidemat,
				A-0.218,0.88,15, sidemat,
				A-0.218,b-0.22-(a-0.432)/2-0.16,10, sidemat,
				(a-0.218),b-0.22-(a-0.432)/2-0.08,mmask2, sidemat,
				(a-0.138)/2,b-0.22-(a-0.432)/2-0.08,913, sidemat,
				(a-0.436)/2,s,4010, sidemat,
				(a-0.436)/2,s1,4000+mmask2, sidemat,
				(a-0.436)/2,s,4010, sidemat,
				(a-0.436)/2,s1,4000+mmask2, sidemat,
				(a-0.436)/2,s,4010, sidemat,
				(a-0.436)/2,s1,4000+mmask2, sidemat,
				(a-0.436)/2,s,4010, sidemat,
				0.08,b-0.22-(a-0.432)/2-0.16,15, sidemat,
				0.08,0.88,10, sidemat,
				0.08,0.73,15, sidemat,
				0.08,0.15,10, sidemat,
				0,0,mmask, sidemat,
				0,B-0.11,mmask, sidemat,
				A-0.138,B-0.11,mmask, sidematedge,
				A-0.138,0,-1, sidematedge

			gosub 500

			sprism_{2} topmat, botmat, sidemat,
				7,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				0, 0, 10, sidematedge,
				0.08,0.15,15, sidemat,
				(a-0.138)/2-0.04, 0.15, 10, sidemat,
				(a-0.138)/2+0.04,0.15,15, sidemat,
				A-0.218,0.15,10, sidemat,
				A-0.138,0,mmask, sidematedge,
				0, 0, -1, sidematedge

			gosub 600

	endif

	if gs_SashText_typ_num = 2 then

		base

			sprism_{2} topmat, botmat, sidemat,
				22,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				A-0.138,0.15,8, sidematedge,
				A-0.218,0.15,15, sidemat,
				A-0.218,0.73,10, sidemat,
				A-0.218,0.88,15, sidemat,
				A-0.218,b-0.22-(a-0.432)/2-0.16,10, sidemat,
				(a-0.218),b-0.22-(a-0.432)/2-0.08,mmask2, sidemat,
				(a-0.138)/2,b-0.22-(a-0.432)/2-0.08,913, sidemat,
				(a-0.436)/2,s,4010, sidemat,
				(a-0.436)/2,s1,4000+mmask2, sidemat,
				(a-0.436)/2,s,4010, sidemat,
				(a-0.436)/2,s1,4000+mmask2, sidemat,
				(a-0.436)/2,s,4010, sidemat,
				(a-0.436)/2,s1,4000+mmask2, sidemat,
				(a-0.436)/2,s,4010, sidemat,
				0.08,b-0.22-(a-0.432)/2-0.16,15, sidemat,
				0.08,0.88,10, sidemat,
				0.08,0.73,15, sidemat,
				0.08,0.15,10, sidemat,
				0,0.15,mmask, sidemat,
				0,B-0.11,mmask, sidemat,
				A-0.138,B-0.11,mmask, sidematedge,
				A-0.138,0.15,-1, sidematedge

			gosub 500

			sprism_{2} topmat, botmat, sidemat,
				9,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				0, 0, 15, sidematedge,
				0, 0.15, 8, sidemat,
				0.08, 0.15, 15, sidemat,
				(a-0.138)/2-0.04, 0.15, 10, sidemat,
				(a-0.138)/2+0.04, 0.15, 15, sidemat,
				A-0.218, 0.15, 10, sidemat,
				A-0.138, 0.15, mmask2, sidemat,
				A-0.138, 0, mmask, sidematedge,
				0, 0, -1, sidematedge

			gosub 600

	endif

	addz framethick

next ii

del nn


!********** Both in type1 and type2

for ii=1 to nn

	gosub 900

	base

	cprism_ topmat, botmat, sidemat,
		16, framethick,
		0.08, b-0.22-(a-0.432)/2-0.16, 10,
		0.08, b-0.22-(a-0.432)/2-0.08, mmask,
		(a-0.138)/2-0.1,b-0.22-(a-0.432)/2-0.08,mmask2,
		(a-0.138)/2,b-0.22-(a-0.432)/2-0.08,915,
		0.1,-z,4010,
		0.1,-z1,4000+mmask2,
		0.1,-z,4010,
		0.1,-z1,4000+mmask2,
		0.1,-z,4010,
		0.1,-z1,4000+mmask2,
		0.1,-z,4000+mmask2,
		A-0.218, b-0.22-(a-0.432)/2-0.08, 10,
		A-0.218, b-0.22-(a-0.432)/2-0.16, 15,
		(a-0.138)/2+0.04, b-0.22-(a-0.432)/2-0.16, 10,
		(a-0.138)/2-0.04, b-0.22-(a-0.432)/2-0.16, 15,
		0.08, b-0.22-(a-0.432)/2-0.16, 10

	cprism_ topmat, botmat, sidemat,
		8, framethick,
		0.08, 0.73, 10,
		0.08, 0.88, 15,
		(a-0.138)/2-0.04, 0.88, 10,
		(a-0.138)/2+0.04, 0.88, 15,
		A-0.218, 0.88, 10,
		A-0.218, 0.73, 15,
		(a-0.138)/2+0.04, 0.73, 10,
		(a-0.138)/2-0.04, 0.73, 15


	gosub 500

	cprism_ topmat, botmat, sidemat,
		4, framethick,
		(a-0.138)/2+0.04, 0.15, 15,
		(a-0.138)/2+0.04, 0.73, 10,
		(a-0.138)/2-0.04, 0.73, 15,
		(a-0.138)/2-0.04, 0.15, 10

	cprism_ topmat, botmat, sidemat,
		4, framethick,
		(a-0.138)/2+0.04, b-0.22-(a-0.432)/2-0.16, 15,
		(a-0.138)/2+0.04, 0.88, 10,
		(a-0.138)/2-0.04, 0.88, 15,
		(a-0.138)/2-0.04, b-0.22-(a-0.432)/2-0.16, 10

	gosub 600

	cprism_ topmat, botmat, sidemat,
		4, framethick,
		(a-0.138)/2-0.01,b-0.2005-(a-0.432)/2,mmask,
		(a-0.138)/2-0.01,b-0.233,10,
		(a-0.138)/2+0.01,b-0.233,mmask,
		(a-0.138)/2+0.01,b-0.2005-(a-0.432)/2,10

	cprism_ topmat, botmat, sidemat,
		4, framethick,
		(a-0.138)/2+0.1*cos(z),b-0.3-(a-0.432)/2+0.1*sin(z),mmask,
		(a-0.138)/2+r*cos(s),b-0.3-(a-0.432)/2+r*sin(s),10,
		(a-0.138)/2+r*cos(s+s1),b-0.3-(a-0.432)/2+r*sin(s+s1),mmask,
		(a-0.138)/2+0.1*cos(z+z1),b-0.3-(a-0.432)/2+0.1*sin(z+z1),10

	cprism_ topmat, botmat, sidemat,
		4, framethick,
		(a-0.138)/2-0.1*cos(z),b-0.3-(a-0.432)/2+0.1*sin(z),mmask,
		(a-0.138)/2-r*cos(s),b-0.3-(a-0.432)/2+r*sin(s),10,
		(a-0.138)/2-r*cos(s+s1),b-0.3-(a-0.432)/2+r*sin(s+s1),mmask,
		(a-0.138)/2-0.1*cos(z+z1),b-0.3-(a-0.432)/2+0.1*sin(z+z1),10

	addz framethick

next ii

del nn

if lod3D = 5 then	!Chinese
	thk = gs_frame_thk
	thk2 = gs_frame_thk
else
	thk = 0.01
	thk2 = 0.008
endif


addz gs_leaf_thk/2-thk/2
body -1
material gs_leaf_mat

base

cprism_ topmat, botmat, sidemat,
	10, thk,
	0.08,0.15,15,
	(a-0.138)/2-0.04,0.15,15,
	(a-0.138)/2-0.04,0.73,15,
	0.08,0.73,15,
	0.08,0.15,-1,
	0.11,0.18,15,
	(a-0.138)/2-0.076,0.18,15,
	(a-0.138)/2-0.076,0.7,15,
	0.11,0.7,15,
	0.11,0.18,-1

cprism_ topmat, botmat, sidemat,
	10, thk,
	(a-0.138)/2+0.04,0.15,15,
	(a-0.138)/2+0.04,0.73,15,
	(a-0.218),0.73,15,
	(a-0.218),0.15,15,
	(a-0.138)/2+0.04,0.15,-1,
	(a-0.138)/2+0.07,0.18,15,
	(a-0.138)/2+0.07,0.7,15,
	(a-0.251),0.7,15,
	(a-0.251),0.18,15,
	(a-0.138)/2+0.07,0.18,-1

cprism_ topmat, botmat, sidemat,
	10, thk,
	0.08,0.88,15,
	(a-0.138)/2-0.04,0.88,15,
	(a-0.138)/2-0.04,b-0.22-(a-0.432)/2-0.16,15,
	0.08,b-0.22-(a-0.432)/2-0.16,15,
	0.08,0.88,-1,
	0.11,0.91,15,
	(a-0.138)/2-0.07,0.91,15,
	(a-0.138)/2-0.07,b-0.22-(a-0.432)/2-0.19,15,
	0.11,b-0.22-(a-0.432)/2-0.19,15,
	0.11,0.91,-1

cprism_ topmat, botmat, sidemat,
	10, thk,
	 (a-0.138)/2+0.04,0.88,15,
	(a-0.138)/2+0.04,b-0.22-(a-0.432)/2-0.16,15,
	(a-0.218),b-0.22-(a-0.432)/2-0.16,15,
	(a-0.218),0.88,15,
	(a-0.138)/2+0.04,0.88,-1,
	 (a-0.138)/2+0.07,0.91,15,
	(a-0.138)/2+0.07,b-0.22-(a-0.432)/2-0.19,15,
	(a-0.248),b-0.22-(a-0.432)/2-0.19,15,
	(a-0.248),0.91,15,
	(a-0.138)/2+0.07,0.91,-1



gosub 500

body -1

pen gs_glass_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_glass_pen_cont
material gs_glass_mat

cutpoly 4,
	(a-0.138)/2-0.01+0.000001,b,
	(a-0.138)/2-0.01+0.000001,0,
	(a-0.138)/2+0.01-0.000001,0,
	(a-0.138)/2+0.01-0.000001,b

cutpoly 4,
	(a-0.138)/2+0.1*cos(z),b-0.3-(a-0.432)/2+0.1*sin(z),
	(a-0.138)/2+r*cos(s),b-0.3-(a-0.432)/2+r*sin(s),
	(a-0.138)/2+r*cos(s+s1),b-0.3-(a-0.432)/2+r*sin(s+s1),
	(a-0.138)/2+0.1*cos(z+z1),b-0.3-(a-0.432)/2+0.1*sin(z+z1)

cutpoly 4,
	(a-0.138)/2-0.1*cos(z),b-0.3-(a-0.432)/2+0.1*sin(z),
	(a-0.138)/2-r*cos(s),b-0.3-(a-0.432)/2+r*sin(s),
	(a-0.138)/2-r*cos(s+s1),b-0.3-(a-0.432)/2+r*sin(s+s1),
	(a-0.138)/2-0.1*cos(z+z1),b-0.3-(a-0.432)/2+0.1*sin(z+z1)

pen gs_glass_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_glass_pen_cont
material gs_glass_mat

prism_ 31,gs_glass_thk,
	(a-0.218),b-0.22-(a-0.432)/2-0.08,glas_mask5,
	(a-0.138)/2,b-0.22-(a-0.432)/2-0.08,900+glas_mask5,
	(a-0.436)/2,s,4010,
	(a-0.138)/2,b-0.22-(a-0.432)/2-0.08,900+glas_mask5,
	(a-0.436)/2,s1,4000+glas_mask5,
	(a-0.138)/2,b-0.22-(a-0.432)/2-0.08,900+glas_mask5,
	(a-0.436)/2,s,4010,
	(a-0.138)/2,b-0.22-(a-0.432)/2-0.08,900+glas_mask5,
	(a-0.436)/2,s1,4005,
	(a-0.138)/2,b-0.22-(a-0.432)/2-0.08,900+glas_mask5,
	(a-0.436)/2,s,4010,
	(a-0.138)/2,b-0.22-(a-0.432)/2-0.08,900+glas_mask5,
	(a-0.436)/2,s1,4000+glas_mask5,
	(a-0.138)/2,b-0.22-(a-0.432)/2-0.08,900+glas_mask5,
	(a-0.436)/2,s,4000+glas_mask5,
	(a-0.138)/2-0.1,b-0.22-(a-0.432)/2-0.08,glas_mask5,
	(a-0.138)/2,b-0.22-(a-0.432)/2-0.08,900+glas_mask5,
	0.1,-z,4010,
	(a-0.138)/2,b-0.22-(a-0.432)/2-0.08,900+glas_mask5,
	0.1,-z1,4000+glas_mask5,
	(a-0.138)/2,b-0.22-(a-0.432)/2-0.08,900+glas_mask5,
	0.1,-z,4010,
	(a-0.138)/2,b-0.22-(a-0.432)/2-0.08,900+glas_mask5,
	0.1,-z1,4000+glas_mask5,
	(a-0.138)/2,b-0.22-(a-0.432)/2-0.08,900+glas_mask5,
	0.1,-z,4010,
	(a-0.138)/2,b-0.22-(a-0.432)/2-0.08,900+glas_mask5,
	0.1,-z1,4000+glas_mask5,
	(a-0.138)/2,b-0.22-(a-0.432)/2-0.08,900+glas_mask5,
	0.1,-z,4000+glas_mask5,
	(a-0.218),b-0.22-(a-0.432)/2-0.08,-1

cutend
cutend
cutend

del 1
if lod3D = 5 then
	addz 0
else
	addz gs_leaf_thk/2-0.008-0.005
endif
body -1
pen gs_leaf_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_leaf_pen_cont
material gs_leaf_mat

base

material botmat

cprism_ topmat,botmat,botmat,
	5,thk2,
	0.11,0.18,15,
	(a-0.138)/2-0.076,0.18,15,
	(a-0.138)/2-0.076,0.7,15,
	0.11,0.7,15,
	0.11,0.18,15

cprism_ topmat,botmat,botmat,
	5,thk2,
	(a-0.138)/2+0.07,0.18,15,
	(a-0.138)/2+0.07,0.7,15,
	(a-0.251),0.7,15,
	(a-0.251),0.18,15,
	(a-0.138)/2+0.07,0.18,15

cprism_ topmat,botmat,botmat,
	5,thk2,
	0.11,0.91,15,
	(a-0.138)/2-0.07,0.91,15,
	(a-0.138)/2-0.07,b-0.22-(a-0.432)/2-0.19,15,
	0.11,b-0.22-(a-0.432)/2-0.19,15,
	0.11,0.91,15

cprism_ topmat,botmat,botmat,
	5,thk2,
	 (a-0.138)/2+0.07,0.91,15,
	(a-0.138)/2+0.07,b-0.22-(a-0.432)/2-0.19,15,
	(a-0.248),b-0.22-(a-0.432)/2-0.19,15,
	(a-0.248),0.91,15,
	(a-0.138)/2+0.07,0.91,15

addz 0.018

material topmat

if lod3D<> 5 then
	addz -thk
	prism_ 5,thk+thk2,
		0.11,0.18,15,
		(a-0.138)/2-0.076,0.18,15,
		(a-0.138)/2-0.076,0.7,15,
		0.11,0.7,15,
		0.11,0.18,15

	prism_ 5,thk+thk2,
		(a-0.138)/2+0.07,0.18,15,
		(a-0.138)/2+0.07,0.7,15,
		(a-0.251),0.7,15,
		(a-0.251),0.18,15,
		(a-0.138)/2+0.07,0.18,15

	prism_ 5,thk+thk2,
		0.11,0.91,15,
		(a-0.138)/2-0.07,0.91,15,
		(a-0.138)/2-0.07,b-0.22-(a-0.432)/2-0.19,15,
		0.11,b-0.22-(a-0.432)/2-0.19,15,
		0.11,0.91,15

	prism_ 5,thk+thk2,
		 (a-0.138)/2+0.07,0.91,15,
		(a-0.138)/2+0.07,b-0.22-(a-0.432)/2-0.19,15,
		(a-0.248),b-0.22-(a-0.432)/2-0.19,15,
		(a-0.248),0.91,15,
		(a-0.138)/2+0.07,0.91,15
	del 1
endif

gosub 500

del 3

RETURN


30:

!!!!!******************** Side 4 !!!!!

addx -a/2

a=a+0.138
b=b+0.11

pen gs_leaf_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_leaf_pen_cont
material gs_leaf_mat

gosub 1100


if lod3D = 5 then	!Chinese
	thk = gs_frame_thk
	thk2 = gs_frame_thk
else
	thk = 0.01
	thk2 = 0.008
endif

addz gs_leaf_thk/2-thk/2

base

cprism_ topmat, botmat, sidemat,
	10, thk,
	0.08,0.15,15,
	(A-0.138)/2-0.04,0.15,15,
	(A-0.138)/2-0.04,0.73,15,
	0.08,0.73,15,
	0.08,0.15,-1,
	0.11,0.18,15,
	(A-0.138)/2-0.076,0.18,15,
	(A-0.138)/2-0.076,0.7,15,
	0.11,0.7,15,
	0.11,0.18,-1

cprism_ topmat, botmat, sidemat,
	10, thk,
	(A-0.138)/2+0.04,0.15,15,
	(A-0.138)/2+0.04,0.73,15,
	(A-0.218),0.73,15,
	(A-0.218),0.15,15,
	(A-0.138)/2+0.04,0.15,-1,
	(A-0.138)/2+0.07,0.18,15,
	(A-0.138)/2+0.07,0.7,15,
	(A-0.251),0.7,15,
	(A-0.251),0.18,15,
	(A-0.138)/2+0.07,0.18,-1

gosub 500

del 1

addz gs_leaf_thk/2-gs_glass_thk/2


pen gs_glass_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_glass_pen_cont
material gs_glass_mat

prism_ 4,gs_glass_thk,
	0.08,0.88,glas_mask5,
	(A-0.138)/2-0.04,0.88,glas_mask5,
	(A-0.138)/2-0.04,B-0.22,glas_mask5,
	0.08,B-0.22,glas_mask5

prism_ 4,gs_glass_thk,
	 (A-0.138)/2+0.04,0.88,glas_mask5,
	(A-0.138)/2+0.04,B-0.22,glas_mask5,
	(A-0.218),B-0.22,glas_mask5,
	(A-0.218),0.88,glas_mask5

del 1

pen gs_leaf_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_leaf_pen_cont
material gs_leaf_mat

if lod3D = 5 then
	addz 0
else
	addz gs_leaf_thk/2-0.008-0.005
endif

base

material botmat

cprism_ topmat,botmat,botmat,
	4,thk2,
	0.11,0.18,15,
	(A-0.138)/2-0.076,0.18,15,
	(A-0.138)/2-0.076,0.7,15,
	0.11,0.7,15

cprism_ topmat,botmat,botmat,
	4,thk2,
	(A-0.138)/2+0.07,0.18,15,
	(A-0.138)/2+0.07,0.7,15,
	(A-0.251),0.7,15,
	(A-0.251),0.18,15

addz 0.018

material topmat


if lod3D<> 5 then
	addz -thk
	prism_ 4,thk+thk2,
		0.11,0.18,15,
		(A-0.138)/2-0.076,0.18,15,
		(a-0.138)/2-0.076,0.7,15,
		0.11,0.7,15

	prism_ 4,thk+thk2,
		(A-0.138)/2+0.07,0.18,15,
		(A-0.138)/2+0.07,0.7,15,
		(A-0.251),0.7,15,
		(A-0.251),0.18,15
	del 1
endif
del 3


gosub 500

RETURN


31:
!!!!!******************** Side 5 !!!!!


addx -a/2

a=a+0.138
b=b+0.11

pen gs_leaf_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_leaf_pen_cont
material gs_leaf_mat

gosub 1200

if lod3D = 5 then	!Chinese
	thk = gs_frame_thk
	thk2 = gs_frame_thk
else
	thk = 0.01
	thk2 = 0.008
endif

addz gs_leaf_thk/2-thk/2

	base

cprism_ topmat, botmat, sidemat,
	10, thk,
	0.08,0.15,15,
	(A-0.138)/2-0.04,0.15,15,
	(A-0.138)/2-0.04,0.73,15,
	0.08,0.73,15,
	0.08,0.15,-1,
	0.11,0.18,15,
	(A-0.138)/2-0.07,0.18,15,
	(A-0.138)/2-0.07,0.7,15,
	0.11,0.7,15,
	0.11,0.18,-1

cprism_ topmat, botmat, sidemat,
	10, thk,
	(A-0.138)/2+0.04,0.15,15,
	(A-0.138)/2+0.04,0.73,15,
	(A-0.218),0.73,15,
	(A-0.218),0.15,15,
	(A-0.138)/2+0.04,0.15,-1,
	(A-0.138)/2+0.07,0.18,15,
	(A-0.138)/2+0.07,0.7,15,
	(A-0.248),0.7,15,
	(A-0.248),0.18,15,
	(A-0.138)/2+0.07,0.18,-1

cprism_ topmat, botmat, sidemat,
	10, thk,
	0.08,0.88,15,
	(A-0.138)/2-0.04,0.88,15,
	(A-0.138)/2-0.04,B-0.3-((A-0.316)/2),15,
	0.08,B-0.3-((A-0.316)/2),15,
	0.08,0.88,-1,
	0.11,0.91,15,
	(A-0.138)/2-0.07,0.91,15,
	(A-0.138)/2-0.07,B-0.33-((A-0.316)/2),15,
	0.11,B-0.33-((A-0.316)/2),15,
	0.11,0.91,-1

cprism_ topmat, botmat, sidemat,
	10, thk,
	 (A-0.138)/2+0.04,0.88,15,
	(A-0.138)/2+0.04,B-0.3-((A-0.316)/2),15,
	(A-0.218),B-0.3-((A-0.316)/2),15,
	(A-0.218),0.88,15,
	 (A-0.138)/2+0.04,0.88,-1,
	 (A-0.138)/2+0.07,0.91,15,
	(A-0.138)/2+0.07,B-0.33-((A-0.316)/2),15,
	(A-0.248),B-0.33-((A-0.316)/2),15,
	(A-0.248),0.91,15,
	 (A-0.138)/2+0.07,0.91,-1

gosub 500

del 1

pen gs_glass_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_glass_pen_cont
material gs_glass_mat

addz gs_leaf_thk/2-gs_glass_thk/2

prism_ 4,gs_glass_thk,
	0.08,B-0.22-((A-0.316)/2),glas_mask5,
	(A-0.138)/2-0.04,B-0.22-((A-0.316)/2),glas_mask5,
	(A-0.138)/2-0.04,B-0.22,glas_mask5,
	0.08,B-0.22,glas_mask5

prism_ 4,gs_glass_thk,
	(A-0.138)/2+0.04,B-0.22-((A-0.316)/2),glas_mask5,
	(A-0.138)/2+0.04,B-0.22,glas_mask5,
	(A-0.218),B-0.22,glas_mask5,
	(A-0.218),B-0.22-((A-0.316)/2),glas_mask5

del 1

pen gs_leaf_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_leaf_pen_cont
material gs_leaf_mat

if lod3D = 5 then
	addz 0
else
	addz gs_leaf_thk/2-0.008-0.005
endif


base

material botmat

cprism_ topmat,botmat,botmat,
	4,thk2,
	0.11,0.18,15,
	(A-0.138)/2-0.07,0.18,15,
	(A-0.138)/2-0.07,0.7,15,
	0.11,0.7,15

cprism_ topmat,botmat,botmat,
	4,thk2,
	(A-0.138)/2+0.07,0.18,15,
	(A-0.138)/2+0.07,0.7,15,
	(A-0.248),0.7,15,
	(A-0.248),0.18,15

cprism_ topmat,botmat,botmat,
	4,thk2,
	0.11,0.91,15,
	(A-0.138)/2-0.07,0.91,15,
	(A-0.138)/2-0.07,B-0.33-((A-0.316)/2),15,
	0.11,B-0.33-((A-0.316)/2),15

cprism_ topmat,botmat,botmat,
	4,thk2,
	 (A-0.138)/2+0.07,0.91,15,
	(A-0.138)/2+0.07,B-0.33-((A-0.316)/2),15,
	(A-0.248),B-0.33-((A-0.316)/2),15,
	(A-0.248),0.91,15

addz 0.018

material topmat

if lod3D<> 5 then
	addz -thk
	prism_ 4,thk+thk2,
		0.11,0.18,15,
		(A-0.138)/2-0.07,0.18,15,
		(A-0.138)/2-0.07,0.7,15,
		0.11,0.7,15

	prism_ 4,thk+thk2,
		(A-0.138)/2+0.07,0.18,15,
		(A-0.138)/2+0.07,0.7,15,
		(A-0.248),0.7,15,
		(A-0.248),0.18,15

	prism_ 4,thk+thk2,
		0.11,0.91,15,
		(A-0.138)/2-0.07,0.91,15,
		(A-0.138)/2-0.07,B-0.33-((A-0.316)/2),15,
		0.11,B-0.33-((A-0.316)/2),15

	prism_ 4,thk+thk2,
		 (A-0.138)/2+0.07,0.91,15,
		(A-0.138)/2+0.07,B-0.33-((A-0.316)/2),15,
		(A-0.248),B-0.33-((A-0.316)/2),15,
		(A-0.248),0.91,15
	del 1
endif

del 3


gosub 500

RETURN


32:
!!!!!******************** Side 6 !!!!!


addx -a/2
a=a+0.138
b=b+0.11

pen gs_leaf_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_leaf_pen_cont
material gs_leaf_mat

dx=((a-0.298)-0.06)/3
dy=(b-0.22-0.88-0.06)/3
ky=0.88
kx=0.08
for i=1 to 3
 for u=1 to 3
	put kx,ky,15
	put kx,ky+dy,15
	put kx+dx,ky+dy,15
	put kx+dx,ky,15
	put kx,ky,-1
	kx=kx+dx+0.03
 next u
kx=0.08
ky=ky+0.03+dy
next i

material gs_leaf_mat


gosub 1500


!*** Both in type1 and type2

for ii=1 to nn

	gosub 900

	base

	cprism_ topmat, botmat, sidemat,
		4, framethick,
		(A-0.138)/2-0.04,0.15,10,
		(A-0.138)/2+0.04,0.15,mmask,
		(A-0.138)/2+0.04,0.73,10,
		(A-0.138)/2-0.04,0.73,mmask

	cprism_ topmat, botmat, sidemat,
		4, framethick,
		0.08+dx,0.88,10,
		0.08+dx+0.03,0.88,mmask,
		0.08+dx+0.03,0.88+dy,10,
		0.08+dx,0.88+dy,mmask

	cprism_ topmat, botmat, sidemat,
		4, framethick,
		0.08+dx,0.88+0.03+dy,10,
		0.08+dx+0.03,0.88+0.03+dy,mmask,
		0.08+dx+0.03,0.88+0.03+2*dy,10,
		0.08+dx,0.88+0.03+2*dy,mmask

	cprism_ topmat, botmat, sidemat,
		4, framethick,
		0.08+dx,0.88+0.06+2*dy,10,
		0.08+dx+0.03,0.88+0.06+2*dy,mmask,
		0.08+dx+0.03,B-0.22,10,
		0.08+dx,B-0.22,mmask

	cprism_ topmat, botmat, sidemat,
		4, framethick,
		A-0.218-dx,0.88,10,
		A-0.218-dx-0.03,0.88,mmask,
		A-0.218-dx-0.03,0.88+dy,10,
		A-0.218-dx,0.88+dy,mmask

	cprism_ topmat, botmat, sidemat,
		4, framethick,
		A-0.218-dx,0.88+0.03+dy,10,
		A-0.218-dx-0.03,0.88+0.03+dy,mmask,
		A-0.218-dx-0.03,0.88+0.03+2*dy,10,
		A-0.218-dx,0.88+0.03+2*dy,mmask

	cprism_ topmat, botmat, sidemat,
		4, framethick,
		A-0.218-dx,0.88+0.06+2*dy,10,
		A-0.218-dx-0.03,0.88+0.06+2*dy,mmask,
		A-0.218-dx-0.03,B-0.22,10,
		A-0.218-dx,B-0.22,mmask

	gosub 500

	cprism_ topmat, botmat, sidemat,
		10, framethick,
		0.08,0.73,10,
		0.08,0.88,mmask,
		0.08+dx,0.88,10,
		0.08+dx+0.03,0.88,mmask,
		A-0.218-dx-0.03,0.88,10,
		A-0.218-dx,0.88,mmask,
		A-0.218,0.88,10,
		A-0.218,0.73,mmask,
		(A-0.138)/2+0.04,0.73,10,
		(A-0.138)/2-0.04,0.73,15


	cprism_ topmat, botmat, sidemat,
		12, framethick,
		0.08,0.88+dy,10,
		0.08,0.88+0.03+dy,mmask,
		0.08+dx,0.88+0.03+dy,10,
		0.08+dx+0.03,0.88+0.03+dy,mmask,
		A-0.218-dx-0.03,0.88+0.03+dy,10,
		A-0.218-dx,0.88+0.03+dy,mmask,
		A-0.218,0.88+0.03+dy,10,
		A-0.218,0.88+dy,mmask,
		A-0.218-dx,0.88+dy,10,
		A-0.218-dx-0.03,0.88+dy,mmask,
		0.08+dx+0.03,0.88+dy,10,
		0.08+dx,0.88+dy,mmask

	cprism_ topmat, botmat, sidemat,
		12, framethick,
		0.08,0.88+0.03+2*dy,10,
		0.08,0.88+0.06+2*dy,mmask,
		0.08+dx,0.88+0.06+2*dy,10,
		0.08+dx+0.03,0.88+0.06+2*dy,mmask,
		A-0.218-dx-0.03,0.88+0.06+2*dy,10,
		A-0.218-dx,0.88+0.06+2*dy,mmask,
		A-0.218,0.88+0.06+2*dy,10,
		A-0.218,0.88+0.03+2*dy,mmask,
		A-0.218-dx,0.88+0.03+2*dy,10,
		A-0.218-dx-0.03,0.88+0.03+2*dy,mmask,
		0.08+dx+0.03,0.88+0.03+2*dy,10,
		0.08+dx,0.88+0.03+2*dy,mmask

	gosub 600

	addz framethick

next ii

del nn


if lod3D = 5 then	!Chinese
	thk = gs_frame_thk
	thk2 = gs_frame_thk
else
	thk = 0.01
	thk2 = 0.008
endif

addz gs_leaf_thk/2-thk/2
body -1
material gs_leaf_mat

base

cprism_ topmat, botmat, sidemat,
	10, thk,
	0.08,0.15,15,
	(a-0.138)/2-0.04,0.15,15,
	(a-0.138)/2-0.04,0.73,15,
	0.08,0.73,15,
	0.08,0.15,-1,
	0.11,0.18,15,
	(a-0.138)/2-0.076,0.18,15,
	(a-0.138)/2-0.076,0.7,15,
	0.11,0.7,15,
	0.11,0.18,-1

cprism_ topmat, botmat, sidemat,
	10, thk,
	(a-0.138)/2+0.04,0.15,15,
	(a-0.138)/2+0.04,0.73,15,
	(a-0.218),0.73,15,
	(a-0.218),0.15,15,
	(a-0.138)/2+0.04,0.15,-1,
	(a-0.138)/2+0.07,0.18,15,
	(a-0.138)/2+0.07,0.7,15,
	(a-0.251),0.7,15,
	(a-0.251),0.18,15,
	(a-0.138)/2+0.07,0.18,-1

gosub 500

del 1


body -1
pen gs_glass_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_glass_pen_cont
material gs_glass_mat

addz gs_leaf_thk/2-gs_glass_thk/2


for ut=1 to 9
prism_ 5,gs_glass_thk,
	get(14),get(1)
next ut
body -1

pen gs_leaf_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_leaf_pen_cont
material gs_leaf_mat

del 1

if lod3D = 5 then
	addz 0
else
	addz gs_leaf_thk/2-0.008-0.005
endif

base

material botmat

cprism_ topmat,botmat,botmat,
	5,thk2,
	0.11,0.18,15,
	(a-0.138)/2-0.076,0.18,15,
	(a-0.138)/2-0.076,0.7,15,
	0.11,0.7,15,
	0.11,0.18,15
cprism_ topmat,botmat,botmat,
	5,thk2,
	(a-0.138)/2+0.07,0.18,15,
	(a-0.138)/2+0.07,0.7,15,
	(a-0.251),0.7,15,
	(a-0.251),0.18,15,
	(a-0.138)/2+0.07,0.18,15

addz 0.018

material topmat

if lod3D<> 5 then
	addz -thk
	prism_ 5,thk+thk2,
		0.11,0.18,15,
		(a-0.138)/2-0.076,0.18,15,
		(a-0.138)/2-0.076,0.7,15,
		0.11,0.7,15,
		0.11,0.18,15
	prism_ 5,thk+thk2,
		(a-0.138)/2+0.07,0.18,15,
		(a-0.138)/2+0.07,0.7,15,
		(a-0.251),0.7,15,
		(a-0.251),0.18,15,
		(a-0.138)/2+0.07,0.18,15
	del 1
endif
del 3


gosub 500

RETURN


33:
!!!!!******************** Side 7 !!!!!

addx -a/2

a=a+0.138
b=b+0.11

pen gs_leaf_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_leaf_pen_cont
material gs_leaf_mat


for ii=1 to nn

	gosub 900

	if gs_SashText_typ_num = 1 then

		base

			sprism_{2} topmat, botmat, sidemat,
				7,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				0,0,10, sidematedge,
				0.08,0.15,15, sidemat,
				0.08,0.73,10, sidemat,
				0.08,0.88,mmask, sidemat,
				0.08,B-0.22,10, sidemat,
				0,B-0.11,mmask, sidematedge,
				0,0,-1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				7,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				A-0.138,0,10, sidematedge,
				A-0.218,0.15,15, sidemat,
				A-0.218,0.73,10, sidemat,
				A-0.218,0.88,mmask, sidemat,
				A-0.218,B-0.22,10, sidemat,
				A-0.138,B-0.11,mmask, sidematedge,
				A-0.138,0,-1, sidematedge

			gosub 500

			sprism_{2} topmat, botmat, sidemat,
				7,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				0,0,10, sidematedge,
				0.08,0.15,15, sidemat,
				(A-0.138)/2-0.04,0.15,10, sidemat,
				(A-0.138)/2+0.04,0.15,15, sidemat,
				A-0.218,0.15,10, sidemat,
				A-0.138,0,mmask, sidematedge,
				0,0,-1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				5,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				0,B-0.11,10, sidematedge,
				0.08,B-0.22,mmask, sidemat,
				A-0.218,B-0.22,10, sidemat,
				A-0.138,B-0.11,mmask, sidematedge,
				0,B-0.11,-1, sidematedge

			gosub 600

	endif

	if gs_SashText_typ_num = 2 then

		base

			sprism_{2} topmat, botmat, sidemat,
				7,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				0,0.15,8, sidematedge,
				0.08,0.15,15, sidemat,
				0.08,0.73,10, sidemat,
				0.08,0.88,mmask, sidemat,
				0.08,B-0.22,10, sidemat,
				0,B-0.22,mmask2, sidematedge,
				0,0.15,-1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				7,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				A-0.138,0.15,8, sidematedge,
				A-0.218,0.15,15, sidemat,
				A-0.218,0.73,10, sidemat,
				A-0.218,0.88,mmask, sidemat,
				A-0.218,B-0.22,10, sidemat,
				A-0.138,B-0.22,mmask2, sidematedge,
				A-0.138,0.15,-1, sidematedge

			gosub 500

			sprism_{2} topmat, botmat, sidemat,
				9,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				0,0,15, sidematedge,
				0,0.15,8, sidemat,
				0.08,0.15,15, sidemat,
				(A-0.138)/2-0.04,0.15,10, sidemat,
				(A-0.138)/2+0.04,0.15,15, sidemat,
				A-0.218,0.15,10, sidemat,
				A-0.138,0.15,mmask2, sidematedge,
				A-0.138,0,mmask, sidematedge,
				0,0,-1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				7,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				0,B-0.11,15, sidematedge,
				0,B-0.22,8, sidemat,
				0.08,B-0.22,mmask, sidemat,
				A-0.218,B-0.22,10, sidemat,
				A-0.138,B-0.22,mmask2, sidematedge,
				A-0.138,B-0.11,mmask, sidematedge,
				0,B-0.11,-1, sidematedge

			gosub 600

	endif

	addz framethick

next ii

del nn


!*********** Both in type1 and type2

for ii=1 to nn

	gosub 900

	base

	cprism_ topmat, botmat, sidemat,
		6, framethick,
		0.08,0.73,10,
		0.08,0.88,mmask,
		A-0.218,0.88,10,
		A-0.218,0.73,15,
		(A-0.138)/2+0.04,0.73,10,
		(A-0.138)/2-0.04,0.73,15

	gosub 600

	cprism_ topmat, botmat, sidemat,
		4, framethick,
		(A-0.138)/2-0.04,0.15,10,
		(A-0.138)/2+0.04,0.15,15,
		(A-0.138)/2+0.04,0.73,10,
		(A-0.138)/2-0.04,0.73,15

	gosub 500

	addz framethick

next ii

del nn

if lod3D = 5 then	!Chinese
	thk = gs_frame_thk
	thk2 = gs_frame_thk
else
	thk = 0.01
	thk2 = 0.008
endif

addz gs_leaf_thk/2-thk/2

	base

cprism_ topmat, botmat, sidemat,
	10, thk,
	0.08,0.15,15,
	(A-0.138)/2-0.04,0.15,15,
	(A-0.138)/2-0.04,0.73,15,
	0.08,0.73,15,
	0.08,0.15,-1,
	0.11,0.18,15,
	(A-0.138)/2-0.076,0.18,15,
	(A-0.138)/2-0.076,0.7,15,
	0.11,0.7,15,
	0.11,0.18,-1

cprism_ topmat, botmat, sidemat,
	10, thk,
	(A-0.138)/2+0.04,0.15,15,
	(A-0.138)/2+0.04,0.73,15,
	(A-0.218),0.73,15,
	(A-0.218),0.15,15,
	(A-0.138)/2+0.04,0.15,-1,
	(A-0.138)/2+0.07,0.18,15,
	(A-0.138)/2+0.07,0.7,15,
	(A-0.251),0.7,15,
	(A-0.251),0.18,15,
	(A-0.138)/2+0.07,0.18,-1

gosub 500

del 1


pen gs_glass_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_glass_pen_cont
material gs_glass_mat

addz gs_leaf_thk/2-gs_glass_thk/2

prism_ 4,gs_glass_thk,
	0.08,0.88,glas_mask5,
	A-0.138-0.08,0.88,glas_mask5,
	A-0.138-0.08,B-0.22,glas_mask5,
	0.08,B-0.22,glas_mask5

del 1

pen gs_leaf_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_leaf_pen_cont
material gs_leaf_mat

if lod3D = 5 then
	addz 0
else
	addz gs_leaf_thk/2-0.008-0.005
endif

base

material botmat

cprism_ topmat,botmat,botmat,
	4,thk2,
	0.11,0.18,15,
	(A-0.138)/2-0.076,0.18,15,
	(A-0.138)/2-0.076,0.7,15,
	0.11,0.7,15
cprism_ topmat,botmat,botmat,
	4,thk2,
	(A-0.138)/2+0.07,0.18,15,
	(A-0.138)/2+0.07,0.7,15,
	(A-0.251),0.7,15,
	(A-0.251),0.18,15

addz 0.018

material topmat


if lod3D<> 5 then
	addz -thk
	prism_ 4,thk+thk2,
		0.11,0.18,15,
		(A-0.138)/2-0.076,0.18,15,
		(a-0.138)/2-0.076,0.7,15,
		0.11,0.7,15

	prism_ 4,thk+thk2,
		(A-0.138)/2+0.07,0.18,15,
		(A-0.138)/2+0.07,0.7,15,
		(A-0.251),0.7,15,
		(A-0.251),0.18,15
	del 1
endif

gosub 500

del 3

RETURN


34:
!!!!!******************** Side 8 !!!!!

addx -a/2

a=a+0.138
b=b+0.11

pen gs_leaf_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_leaf_pen_cont
material gs_leaf_mat


ky=0.15
kx=0.08
dx=(a-0.298-0.12)/3

for u=1 to 3

	put kx,ky,15,
		kx,0.73,15,
		kx+dx,0.73,15,
		kx+dx,ky,15,
		kx,ky,-1,
		kx+0.03,ky+0.03,15,
		kx+0.03,0.7,15,
		kx+dx-0.03,0.7,15,
		kx+dx-0.03,ky+0.03,15,
		kx+0.03,ky+0.03,-1

	kx=kx+dx+0.06

next u

ky=b-0.22-dx*1.6
kx=0.08
dy=dx*1.6


for tu=1 to 3

	put kx,ky,15,
		kx,ky+dy,15,
		kx+dx,ky+dy,15,
		kx+dx,ky,15,
		kx,ky,-1,
		kx+0.03,ky+0.03,15,
		kx+0.03,ky+dy-0.03,15,
		kx+dx-0.03,ky+dy-0.03,15,
		kx+dx-0.03,ky+0.03,15,
		kx+0.03,ky+0.03,-1

	kx=kx+dx+0.06

next tu

kx=0.08
ky=0.88
ky1=b-0.28-dx*1.6
ky2=(ky1-ky-0.06)/2+0.88
ky3=ky2+0.06

	put kx,ky,15,
		kx,ky1,15,
		kx+dx,ky1,15,
		kx+dx,ky,15,
		kx,ky,-1,
		kx+0.03,ky+0.03,15,
		kx+0.03,ky1-0.03,15,
		kx+dx-0.03,ky1-0.03,15,
		kx+dx-0.03,ky+0.03,15,
		kx+0.03,ky+0.03,-1

	kx=kx+dx+0.06

	put kx,ky,15,
		kx,ky2,15,
		kx+dx,ky2,15,
		kx+dx,ky,15,
		kx,ky,-1,
		kx+0.03,ky+0.03,15,
		kx+0.03,ky2-0.03,15,
		kx+dx-0.03,ky2-0.03,15,
		kx+dx-0.03,ky+0.03,15,
		kx+0.03,ky+0.03,-1

	kx=kx+dx+0.06

	put kx,ky,15,
		kx,ky1,15,
		kx+dx,ky1,15,
		kx+dx,ky,15,
		kx,ky,-1,
		kx+0.03,ky+0.03,15,
		kx+0.03,ky1-0.03,15,
		kx+dx-0.03,ky1-0.03,15,
		kx+dx-0.03,ky+0.03,15,
		kx+0.03,ky+0.03,-1

	kx=kx-dx-0.06

	put kx,ky3,15,
		kx,ky1,15,
		kx+dx,ky1,15,
		kx+dx,ky3,15,
		kx,ky3,-1

for ii=1 to nn

	gosub 900

	if gs_SashText_typ_num = 1 then

		base

			sprism_{2} topmat, botmat, sidemat,
				9,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				0,0,10, sidematedge,
				0.08,0.15,15, sidemat,
				0.08,0.73,10, sidemat,
				0.08,0.88,15, sidemat,
				0.08,ky1,10, sidemat,
				0.08,ky1+0.06,15, sidemat,
				0.08,B-0.22,10, sidemat,
				0,B-0.11,mmask, sidematedge,
				0,0,-1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				9,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				A-0.138,0,10, sidematedge,
				A-0.218,0.15,15, sidemat,
				A-0.218,0.73,10, sidemat,
				A-0.218,0.88,15, sidemat,
				A-0.218,ky1,10, sidemat,
				A-0.218,ky1+0.06,15, sidemat,
				A-0.218,B-0.22,10, sidemat,
				A-0.138,B-0.11,mmask, sidematedge,
				A-0.138,0,-1, sidematedge

			gosub 500

			sprism_{2} topmat, botmat, sidemat,
				9,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				0,0,10, sidematedge,
				0.08,0.15,15, sidemat,
				0.08+dx,0.15,10, sidemat,
				0.08+dx+0.06,0.15,15, sidemat,
				0.08+2*dx+0.06,0.15,10, sidemat,
				0.08+2*dx+0.12,0.15,15, sidemat,
				A-0.218,0.15,10, sidemat,
				A-0.138,0,mmask, sidematedge,
				0,0,-1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				9,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				0,B-0.11,10, sidematedge,
				0.08,B-0.22,15, sidemat,
				0.08+dx,B-0.22,10, sidemat,
				0.08+dx+0.06,B-0.22,15, sidemat,
				0.08+2*dx+0.06,B-0.22,10, sidemat,
				0.08+2*dx+0.12,B-0.22,15, sidemat,
				A-0.218,B-0.22,10, sidemat,
				A-0.138,B-0.11,mmask, sidematedge,
				0,B-0.11,-1, sidematedge

			gosub 600

	endif


	if gs_SashText_typ_num = 2 then

		base

			sprism_{2} topmat, botmat, sidemat,
				9,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				0,0.15,8, sidematedge,
				0.08,0.15,15, sidemat,
				0.08,0.73,10, sidemat,
				0.08,0.88,15, sidemat,
				0.08,ky1,10, sidemat,
				0.08,ky1+0.06,15, sidemat,
				0.08,B-0.22,10, sidemat,
				0,B-0.22,mmask2, sidematedge,
				0,0.15,-1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				9,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				A-0.138,0.15,8, sidematedge,
				A-0.218,0.15,15, sidemat,
				A-0.218,0.73,10, sidemat,
				A-0.218,0.88,15, sidemat,
				A-0.218,ky1,10, sidemat,
				A-0.218,ky1+0.06,15, sidemat,
				A-0.218,B-0.22,10, sidemat,
				A-0.138,B-0.22,mmask2, sidematedge,
				A-0.138,0.15,-1, sidematedge

			gosub 500

			sprism_{2} topmat, botmat, sidemat,
				11,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				0,0,15, sidematedge,
				0,0.15,8, sidemat,
				0.08,0.15,15, sidemat,
				0.08+dx,0.15,10, sidemat,
				0.08+dx+0.06,0.15,15, sidemat,
				0.08+2*dx+0.06,0.15,10, sidemat,
				0.08+2*dx+0.12,0.15,15, sidemat,
				A-0.218,0.15,10, sidemat,
				A-0.138,0.15,mmask2, sidematedge,
				A-0.138,0,mmask, sidematedge,
				0,0,-1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				11,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				0,B-0.11,15, sidematedge,
				0,B-0.22,8, sidemat,
				0.08,B-0.22,15, sidemat,
				0.08+dx,B-0.22,10, sidemat,
				0.08+dx+0.06,B-0.22,15, sidemat,
				0.08+2*dx+0.06,B-0.22,10, sidemat,
				0.08+2*dx+0.12,B-0.22,15, sidemat,
				A-0.218,B-0.22,10, sidemat,
				A-0.138,B-0.22,mmask2, sidematedge,
				A-0.138,B-0.11,mmask, sidematedge,
				0,B-0.11,-1, sidematedge

			gosub 600

	endif

	addz framethick

next ii

del nn


!********** Both in type1 and type2

for ii=1 to nn

	gosub 900

	base

	cprism_ topmat, botmat, sidemat,
		4, framethick,
		0.08+dx,0.15,15,
		0.08+dx,0.73,10,
		0.08+dx+0.06,0.73,15,
		0.08+dx+0.06,0.15,10

	cprism_ topmat, botmat, sidemat,
		6, framethick,
		0.08+dx,0.88,15,
		0.08+dx,ky1,10,
		0.08+dx+0.06,ky1,15,
		0.08+dx+0.06,ky3, 10,
		0.08+dx+0.06,ky2, 15,
		0.08+dx+0.06,0.88,10

	cprism_ topmat, botmat, sidemat,
		4, framethick,
		0.08+dx,ky1+0.06,15,
		0.08+dx,B-0.22,10,
		0.08+dx+0.06,B-0.22,15,
		0.08+dx+0.06,ky1+0.06,10

	cprism_ topmat, botmat, sidemat,
		4, framethick,
		0.08+2*dx+0.06,0.15,15,
		0.08+2*dx+0.06,0.73,10,
		0.08+2*dx+0.12,0.73,15,
		0.08+2*dx+0.12,0.15,10

	cprism_ topmat, botmat, sidemat,
		6, framethick,
		0.08+2*dx+0.06,0.88,15,
		0.08+2*dx+0.06,ky2,10,
		0.08+2*dx+0.06,ky3,15,
		0.08+2*dx+0.06,ky1,10,
		0.08+2*dx+0.12,ky1,15,
		0.08+2*dx+0.12,0.88,10

	cprism_ topmat, botmat, sidemat,
		4, framethick,
		0.08+2*dx+0.06,ky1+0.06,15,
		0.08+2*dx+0.06,B-0.22,10,
		0.08+2*dx+0.12,B-0.22,15,
		0.08+2*dx+0.12,ky1+0.06,10

	gosub 500

	cprism_ topmat, botmat, sidemat,
		12, framethick,
		0.08,ky1+0.06,15,
		0.08+dx,ky1+0.06,10,
		0.08+dx+0.06,ky1+0.06,15,
		0.08+2*dx+0.06,ky1+0.06,10,
		0.08+2*dx+0.12,ky1+0.06,15,
		A-0.218,ky1+0.06,10,
		A-0.218,ky1,15,
		0.08+2*dx+0.12,ky1,10,
		0.08+2*dx+0.06,ky1,15,
		0.08+dx+0.06,ky1,10,
		0.08+dx,ky1,15,
		0.08,ky1,10

	cprism_ topmat, botmat, sidemat,
		4, framethick,
		0.08+dx+0.06,ky2,10,
		0.08+dx+0.06,ky3,15,
		0.08+2*dx+0.06,ky3,10,
		0.08+2*dx+0.06,ky2,15


	cprism_ topmat, botmat, sidemat,
		12, framethick,
		0.08,0.88,15,
		0.08+dx,0.88,10,
		0.08+dx+0.06,0.88,15,
		0.08+2*dx+0.06,0.88,10,
		0.08+2*dx+0.12,0.88,15,
		A-0.218,0.88,10,
		A-0.218,0.73,15,
		0.08+2*dx+0.12,0.73,10,
		0.08+2*dx+0.06,0.73,15,
		0.08+dx+0.06,0.73,10,
		0.08+dx,0.73,15,
		0.08,0.73,10


	addz framethick

next ii

del nn


if lod3D = 5 then	!Chinese
	thk = gs_frame_thk
	thk2 = gs_frame_thk
else
	thk = 0.01
	thk2 = 0.008
endif


addz gs_leaf_thk/2-thk/2

body -1
pen gs_leaf_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_leaf_pen_cont
material gs_leaf_mat


for i=1 to 9

	cprism_ topmat, botmat, sidemat,
		10,thk,
		get(30)

next i

body -1



del 1


pen gs_glass_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_glass_pen_cont
material gs_glass_mat

addz gs_leaf_thk/2-gs_glass_thk/2


prism_ 5,gs_glass_thk,
	get(15)

body -1
pen gs_leaf_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_leaf_pen_cont
material gs_leaf_mat



del 1

if lod3D = 5 then
	addz 0
else
	addz gs_leaf_thk/2-0.008-0.005
endif

ky=0.18
kx=0.11
dx=(a-0.298-0.12)/3

for u=1 to 3
	put kx,ky,15,
		kx,0.7,15,
		kx+dx-0.06,0.7,15,
		kx+dx-0.06,ky,15,
		kx,ky,-1
	kx=kx+dx+0.06
next u

ky=b-0.19-dx*1.6
kx=0.11
dy=dx*1.6
for tu=1 to 3
	put kx,ky,15,
		kx,ky+dy-0.06,15,
		kx+dx-0.06,ky+dy-0.06,15,
		kx+dx-0.06,ky,15,
		kx,ky,-1
	kx=kx+dx+0.06
next tu

kx=0.11
ky=0.91
ky1=b-0.31-dx*1.6
ky2=(ky1-ky-0.06)/2+0.88
ky3=ky2+0.12
dx=dx-0.06

	put kx,ky,15,
		kx,ky1,15,
		kx+dx,ky1,15,
		kx+dx,ky,15,
		kx,ky,-1
	kx=kx+dx+0.12

	put kx,ky,15,
		kx,ky2,15,
		kx+dx,ky2,15,
		kx+dx,ky,15,
		kx,ky,-1
	kx=kx+dx+0.12

	put kx,ky,15,
		kx,ky1,15,
		kx+dx,ky1,15,
		kx+dx,ky,15,
		kx,ky,-1
	kx=kx-dx-0.12

material botmat

for op=1 to 9

	cprism_ topmat,botmat,botmat,
		5,thk2,
		get (15)

next op



addz 0.018

if lod3D<> 5 then
	addz -thk

	ky=0.18
	kx=0.11
	dx=(a-0.298-0.12)/3
	for u=1 to 3
		put kx,ky,15,
			kx,0.7,15,
			kx+dx-0.06,0.7,15,
			kx+dx-0.06,ky,15,
			kx,ky,-1
		kx=kx+dx+0.06
	next u

	ky=b-0.19-dx*1.6
	kx=0.11
	dy=dx*1.6
	for tu=1 to 3
		put kx,ky,15,
			kx,ky+dy-0.06,15,
			kx+dx-0.06,ky+dy-0.06,15,
			kx+dx-0.06,ky,15,
			kx,ky,-1
		kx=kx+dx+0.06
	next tu

	kx=0.11
	ky=0.91
	ky1=b-0.31-dx*1.6
	ky2=(ky1-ky-0.06)/2+0.88
	ky3=ky2+0.12
	dx=dx-0.06

		put kx,ky,15,
			kx,ky1,15,
			kx+dx,ky1,15,
			kx+dx,ky,15,
			kx,ky,-1
		kx=kx+dx+0.12

		put kx,ky,15,
			kx,ky2,15,
			kx+dx,ky2,15,
			kx+dx,ky,15,
			kx,ky,-1
		kx=kx+dx+0.12

		put kx,ky,15,
			kx,ky1,15,
			kx+dx,ky1,15,
			kx+dx,ky,15,
			kx,ky,-1
		kx=kx-dx-0.12

	material topmat

	for op=1 to nsp/15

		prism_ 5,thk+thk2,
			get (15)

	next op
	del 1
endif

del 3

RETURN


! ************************************************************
!  Metal Panels
! ************************************************************

35:
!!!!!******************** Mdoor panel 6 !!!!!

pen gs_glass_pen
if bStorefrontDoor then
	sect_fill gs_gsect, gs_penGlass_bg, gs_penGlass_fg, gs_glass_pen_cont
else
	sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_glass_pen_cont
endif
material gs_glass_mat

add 0,b-b/8,gs_leaf_thk/2-gs_glass_thk/2

	cprism_ gs_glass_mat, gs_glass_mat, gs_glass_mat,
			2, gs_glass_thk,
			0,0,979,
			0.075,360,4079

del 1

pen gs_leaf_pen
sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_leaf_pen_cont
material gs_leaf_mat

add 0,b-b/8,gs_leaf_thk

cutpolya 2,1,0,
			0,0,905,
			0.075,360,4005
	base

material topmat

prism_ 2,0.01,
		0,0,979,
		0.09,360,4079

addz -gs_leaf_thk-0.01

material botmat

prism_ 2,0.01,
		0,0,979,
		0.09,360,4079

del 1

del 1

for ii=1 to nn

	gosub 900

	sprism_{2} topmat, botmat, sidemat,
		5,
		0,  0,  1,  0,  framethick, 0,
		0,  0,  1,  0,   0,  0,
		-a/2,0,mmask, sidematedge,
		-a/2,b,mmask, sidematedge,
		 a/2,b,mmask, sidematedge,
		 a/2,0,mmask, sidematedge,
		-a/2,0,-1, sidematedge

		gosub 500

	addz framethick

next ii

del nn
cutend
RETURN



! ************************************************************
!  Metal Entrance Panels
! ************************************************************

36:	!!!!!******************** Mdoor panel 1 !!!!!

	! ------------ glass

	body -1
	pen gs_glass_pen
	if bStorefrontDoor then
		sect_fill gs_gsect, gs_penGlass_bg, gs_penGlass_fg, gs_glass_pen_cont
	else
		sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_glass_pen_cont
	endif
	material gs_glass_mat

	addx -A/2

	addz gs_glass_thk/2

	prism_ 4,gs_leaf_thk-gs_glass_thk,
		0,0,15,
		a,0,15,
		a,b,15,
		0,b,15

	del 1

	! ------------ frame

	body -1

	base

	pen gs_leaf_pen
	sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_leaf_pen_cont
	material gs_leaf_mat

	for m=1 to 2

		if m=1 then material botmat else material topmat

		for n=1 to 2

			prism_ 5, 0.01,
				0,0,15,
				a,0,15,
				a,0.08,15,
				0,0.08,15,
				0,0,-1

			addy b-0.08

		next n
		del 2
		addz gs_leaf_thk-0.01

	next m
	del 2

	gosub 600

	! ------------ locks

	material gs_lock_mat

	addz -0.005
	prism_ 2,0.005,
	a-0.05,0.04,979,
	0.008,360,4079
	del 1
	addz gs_leaf_thk

	prism_ 2,0.005,
		a-0.05,0.04,979,
		0.008,360,4079

	del 1

	! ------------ middleline

	if bMiddleLine then
		lin_ a, 0, 0, a, 0.08, 0
		lin_ a, 0.08, gs_glass_thk/2, a, b-0.08, gs_glass_thk/2
		lin_ a, b-0.08, 0, a, b, 0

		lin_ a, 0, gs_leaf_thk, a, 0.08, gs_leaf_thk
		lin_ a, 0.08, gs_leaf_thk-gs_glass_thk/2, a, b-0.08, gs_leaf_thk-gs_glass_thk/2
		lin_ a, b-0.08, gs_leaf_thk, a, b, gs_leaf_thk
	endif

	del 1
return


37:	!!!!!******************** Mdoor panel 2 !!!!!

	! ------------ glass

	body -1
	pen gs_glass_pen
	if bStorefrontDoor then
		sect_fill gs_gsect, gs_penGlass_bg, gs_penGlass_fg, gs_glass_pen_cont
	else
		sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_glass_pen_cont
	endif
	material gs_glass_mat

	addx -A/2

	addz gs_glass_thk/2

	prism_ 4,gs_leaf_thk-gs_glass_thk,
		0,0,15,
		a,0,15,
		a,b,15,
		0,b,15
	del 1

	! ------------ frame

	body -1
	base
	pen gs_leaf_pen
	sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_leaf_pen_cont
	material gs_leaf_mat

	for m=1 to 2

		if m=1 then material botmat else material topmat

		prism_ 5,0.01,
			0,0,15,
			a,0,15,
			a,0.08,15,
			0,0.08,15,
			0,0,-1

		addz gs_leaf_thk-0.01

	next m

	del 2

	addy b-0.08
	for n=1 to 2

		if n=1 then material botmat else material topmat

		prism_ 4,0.01,
			0,0,15,
			0.20,0,15,
			0.20,0.08,15,
			0,0.08,15

		addz gs_leaf_thk-0.01

	next n
	del 3

	gosub 600

	! ------------  locks

	material gs_lock_mat
	addz -0.005
	prism_ 2,0.005,
		a-0.05,0.04,979,
		0.008,360,4079
	del 1
	addz gs_leaf_thk
	prism_ 2,0.005,
		a-0.05,0.04,979,
		0.008,360,4079
	del 1

	! ------------ middleline

	if bMiddleLine then
		lin_ a, 0, 0, a, 0.08, 0
		lin_ a, 0.08, gs_glass_thk/2, a, b, gs_glass_thk/2

		lin_ a, 0, gs_leaf_thk, a, 0.08, gs_leaf_thk
		lin_ a, 0.08, gs_leaf_thk-gs_glass_thk/2, a, b, gs_leaf_thk-gs_glass_thk/2
	endif

	del 1
return


38: !!!!!******************** Mdoor panel 3 !!!!!

	! ------------ glass

	body -1
	pen gs_glass_pen
	if bStorefrontDoor then
		sect_fill gs_gsect, gs_penGlass_bg, gs_penGlass_fg, gs_glass_pen_cont
	else
		sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_glass_pen_cont
	endif
	material gs_glass_mat

	addx -A/2

	addz gs_glass_thk/2

	prism_ 4,gs_leaf_thk-gs_glass_thk,
		0,0,15,
		a,0,15,
		a,b,15,
		0,b,15
	del 1

	! ------------ frame

	body -1
	base

	pen gs_leaf_pen
	sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_leaf_pen_cont
	material gs_leaf_mat

	for m=1 to 2

		if m=1 then material botmat else material topmat

		for n=1 to 2

			prism_ 4,0.01,
				0,0,15,
				0.20,0,15,
				0.20,0.08,15,
				0,0.08,15

			addy b-0.08

		next n

		del 2
		addz gs_leaf_thk-0.01

	next m

	del 2

	gosub 600

	! ------------ middleline

	if bMiddleLine then
		lin_ a, 0, gs_glass_thk/2, a, b, gs_glass_thk/2
		lin_ a, 0, gs_leaf_thk-gs_glass_thk/2, a, b, gs_leaf_thk-gs_glass_thk/2
	endif

	del 1
return


39:	!!!!!******************** Mdoor panel 4 !!!!!

	! ------------ door leaf

	addx -A/2

	material gs_leaf_mat

	middleRailMat = sidemat
	if bStorefrontClassic then
		_frameWidthSide = gs_fw_side
		_frameWidthLower = gs_fw_lower

		middleRailMat = gs_leafMidrail_mat
		if not(bMiddleRail) then
			gosub "metalPanelFrameWithGlass"
		else
			_midFrameElev = midRailElevation
			_midFrameWidth = gs_int_fw
			gosub "metalPanelDivFrameWithGlass"
		endif
	else
		_frameWidthLower = 0.1
		_frameWidthSide	= 0.1
		_midFrameElev = 1.12
		_midFrameWidth  = 0.16
		gosub "metalPanelDivFrameWithGlass"
	endif


	del 1
return

40:	!!!!!******************** Mdoor panel 8 !!!!!
	_frameWidthSide=gs_fw_side
	if bStorefrontClassic then
		_frameWidthLower = gs_fw_lower
	else
		_frameWidthLower = 0.1
	endif

	addx -A/2

	! ------------ door leaf
	pen gs_leaf_pen
	material gs_leaf_mat

	gosub "metalPanelFrameWithGlass"

RETURN


41:	!!!!!******************** Bifdoor_Panel_B !!!!!


	material gs_leaf_mat

	! ------------ Outer frame

	for ii=1 to nn

		gosub 900

		if gs_SashText_typ_num = 1 then

			base

			sprism_{2} topmat, botmat, sidemat,
				5,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				-a/2, 0, 10, sidematedge,
				-a/2+gs_fw_side, gs_fw_lower, 15, sidemat,
				-a/2+gs_fw_side, b-gs_fw_upper, 10, sidemat,
				-a/2, b, mmask, sidematedge,
				-a/2, 0, -1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				5,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				a/2, 0, 10, sidematedge,
				a/2-gs_fw_side, gs_fw_lower, 15, sidemat,
				a/2-gs_fw_side, b-gs_fw_upper, 10, sidemat,
				a/2, b, mmask, sidematedge,
				a/2, 0, -1, sidematedge

			gosub 500

			sprism_{2} topmat, botmat, sidemat,
				5,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				-a/2, 0, 10, sidematedge,
				-a/2+gs_fw_side, gs_fw_lower, 15, sidemat,
				a/2-gs_fw_side, gs_fw_lower, 10, sidemat,
				a/2, 0, mmask, sidematedge,
				-a/2, 0, -1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				5,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				-a/2, b, 10, sidematedge,
				-a/2+gs_fw_side,   b-gs_fw_upper,   15, sidemat,
				a/2-gs_fw_side, b-gs_fw_upper, 10, sidemat,
				a/2, b, mmask, sidematedge,
				-a/2, b, -1, sidematedge

			gosub 600

		endif

		if gs_SashText_typ_num = 2 then

			base

			sprism_{2} topmat, botmat, sidemat,
				5,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				-a/2, gs_fw_lower, 8, sidematedge,
				-a/2+gs_fw_side, gs_fw_lower, 15, sidemat,
				-a/2+gs_fw_side, b-gs_fw_upper, 10, sidemat,
				-a/2, b-gs_fw_upper, mmask2, sidematedge,
				-a/2, gs_fw_lower, -1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				5,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				a/2, gs_fw_lower, 8, sidematedge,
				a/2-gs_fw_side,   gs_fw_lower, 15, sidemat,
				a/2-gs_fw_side, b-gs_fw_upper, 10, sidemat,
				a/2, b-gs_fw_upper, mmask2, sidematedge,
				a/2, gs_fw_lower, -1, sidematedge

			gosub 500

			sprism_{2} topmat, botmat, sidemat,
				7,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				-a/2, 0, mmask, sidematedge,
				-a/2, gs_fw_lower, 8, sidematedge,
				-a/2+gs_fw_side,   gs_fw_lower,     15, sidemat,
				a/2-gs_fw_side, gs_fw_lower, 10, sidemat,
				a/2, gs_fw_lower, mmask2, sidemat,
				a/2, 0, mmask, sidematedge,
				-a/2, 0, -1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				7,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				-a/2, b, mmask, sidematedge,
				-a/2, b-gs_fw_upper, 8, sidematedge,
				-a/2+gs_fw_side,   b-gs_fw_upper,   15, sidemat,
				a/2-gs_fw_side, b-gs_fw_upper, 10, sidemat,
				a/2, b-gs_fw_upper, mmask2, sidemat,
				a/2, b, mmask, sidematedge,
				-a/2, b, -1, sidematedge

			gosub 600

		endif

		addz framethick

	next ii

	del nn


	body -1

	!!!Inner frame

	addz gs_leaf_thk/4
	mag_hat=b-gs_fw_upper

	gosub 1600


	body -1
	del 1
	!! END OF FRAME !!


	!! LOUVERS !!

	material gs_louver_mat

	d=b-gs_fw_lower-gs_fw_upper-2*gs_int_fw
	n=int(d/gs_shutter_w)
	dp=d/n

	addy gs_fw_lower+gs_int_fw-dp/2
	addz gs_leaf_thk/2
	for i=1 to n step 1
		addy dp

		rotx gs_shutter_ang
		addz -gs_shutter_th/2

		cprism_ louvtopmat, louvbotmat, louvsidemat,
			5, gs_shutter_th,
			-a/2+gs_fw_side+gs_int_fw, -dp/2, 15,
			-a/2+gs_fw_side+gs_int_fw,  dp/2, 15,
			 a/2-gs_fw_side-gs_int_fw,  dp/2, 15,
			 a/2-gs_fw_side-gs_int_fw, -dp/2, 15,
			-a/2+gs_fw_side+gs_int_fw, -dp/2, -1

		body -1
		del 2
	next i
	del n+3

	! ------------ middleline

	if bMiddleLine then gosub "middleline"

return


42: !!!!!******************** Bifdoor_Panel_B !!!!!

	gs_fw_lower=b/2
	!! FRAME !!
	material gs_leaf_mat

	!!!Outer frame

	for ii=1 to nn

		gosub 900

		if gs_SashText_typ_num = 1 then

			base

			sprism_{2} topmat, botmat, sidemat,
				9,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				-a/2, 0, mmask, sidematedge,
				-a/2, b, 10, sidematedge,
				-a/2+gs_fw_side,   b-gs_fw_upper,   15, sidemat,
				-a/2+gs_fw_side, gs_fw_lower, 15, sidemat,
				a/2-gs_fw_side,   gs_fw_lower,     15, sidemat,
				a/2-gs_fw_side, b-gs_fw_upper, 10, sidemat,
				a/2,      b,      15, sidemat,
				a/2, 0 , mmask, sidematedge,
				-a/2, 0, -1, sidematedge

			gosub 500

			sprism_{2} topmat, botmat, sidemat,
				5,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				-a/2, b, 10, sidematedge,
				-a/2+gs_fw_side, b-gs_fw_upper, 15, sidemat,
				a/2-gs_fw_side, b-gs_fw_upper, 10, sidemat,
				a/2, b, mmask, sidematedge,
				-a/2, b, -1, sidematedge

			gosub 600

		endif


		if gs_SashText_typ_num = 2 then

			base

			sprism_{2} topmat, botmat, sidemat,
				9,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				-a/2, 0, mmask, sidematedge,
				-a/2, b-gs_fw_upper, 8, sidematedge,
				-a/2+gs_fw_side,   b-gs_fw_upper,   15, sidemat,
				-a/2+gs_fw_side,   gs_fw_lower,     15, sidemat,
				a/2-gs_fw_side,   gs_fw_lower,     15, sidemat,
				a/2-gs_fw_side, b-gs_fw_upper, 10, sidemat,
				a/2, b-gs_fw_upper, mmask2, sidemat,
				a/2, 0,mmask, sidematedge,
				-a/2, 0, -1, sidematedge

			gosub 500

			sprism_{2} topmat, botmat, sidemat,
				7,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				-a/2, b, mmask, sidematedge,
				-a/2, b-gs_fw_upper, 8, sidematedge,
				-a/2+gs_fw_side, b-gs_fw_upper, 15, sidemat,
				a/2-gs_fw_side, b-gs_fw_upper, 10, sidemat,
				a/2, b-gs_fw_upper, mmask2, sidematedge,
				a/2, b, mmask, sidematedge,
				-a/2, b, -1, sidematedge

			gosub 600

		endif

		addz framethick

	next ii

	del nn



	body -1


	!!!Inner frame
	addz gs_leaf_thk/4
	mag_hat=b-gs_fw_upper

	gosub 1600


	body -1
	del 1
	!! END OF FRAME !!


	!! LOUVERS !!

	material gs_louver_mat

	d=b-gs_fw_lower-gs_fw_upper-2*gs_int_fw

	n=int(d/gs_shutter_w)

	dp=d/n

	addy gs_fw_lower+gs_int_fw-dp/2
	addz gs_leaf_thk/2
	for i=1 to n step 1
		addy dp

		rotx gs_shutter_ang
		addz -gs_shutter_th/2

		cprism_ louvtopmat, louvbotmat, louvsidemat,
			5, gs_shutter_th,
			-a/2+gs_fw_side+gs_int_fw, -dp/2, 15,
			-a/2+gs_fw_side+gs_int_fw,  dp/2, 15,
			 a/2-gs_fw_side-gs_int_fw,  dp/2, 15,
			 a/2-gs_fw_side-gs_int_fw, -dp/2, 15,
			-a/2+gs_fw_side+gs_int_fw, -dp/2, -1

		body -1
		del 2
	next i
	del n+3

	! ------------ middleline

	if bMiddleLine then gosub "middleline"

return

43: !!!!!******************** Bifdoor_Panel_D !!!!!


	bb=(b-gs_fw_lower-gs_fw_upper-gs_fw_mid)/2        ! Height of one hole

	!! FRAME !!
	material gs_leaf_mat


	!!!Outer frame

	for ii=1 to nn

		gosub 900

		if gs_SashText_typ_num = 1 then

			base

			sprism_{2} topmat, botmat, sidemat,
				7,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				-a/2, 0, 10, sidematedge,
			   -a/2+gs_fw_side,   gs_fw_lower,     15, sidemat,
				-a/2+gs_fw_side, bb+gs_fw_lower, 10, sidemat,
				-a/2+gs_fw_side, bb+gs_fw_mid+gs_fw_lower,15, sidemat,
				-a/2+gs_fw_side, b-gs_fw_upper, 10, sidemat,
				-a/2, b, mmask, sidematedge,
				-a/2, 0, -1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				7,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				a/2, 0, 10, sidematedge,
				a/2-gs_fw_side,   gs_fw_lower,     15, sidemat,
				a/2-gs_fw_side, bb+gs_fw_lower, 10, sidemat,
				a/2-gs_fw_side, bb+gs_fw_mid+gs_fw_lower,15, sidemat,
				a/2-gs_fw_side, b-gs_fw_upper, 10, sidemat,
				a/2, b, mmask, sidematedge,
				a/2, 0, -1, sidematedge

			gosub 500

			sprism_{2} topmat, botmat, sidemat,
				5,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				-a/2, 0, 10, sidematedge,
				-a/2+gs_fw_side,   gs_fw_lower,     15, sidemat,
				a/2-gs_fw_side, gs_fw_lower, 10, sidemat,
				a/2, 0, mmask, sidematedge,
				-a/2, 0, -1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				5,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				-a/2, b, 10, sidematedge,
				-a/2+gs_fw_side, b-gs_fw_upper, 15, sidemat,
				a/2-gs_fw_side, b-gs_fw_upper, 10, sidemat,
				a/2, b, mmask, sidematedge,
				-a/2, b, -1,  sidematedge

			gosub 600

		endif


		if gs_SashText_typ_num = 2 then

			base

			sprism_{2} topmat, botmat, sidemat,
				7,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				-a/2, gs_fw_lower, 8, sidematedge,
				-a/2+gs_fw_side, gs_fw_lower, 15, sidemat,
				-a/2+gs_fw_side, bb+gs_fw_lower, 10, sidemat,
				-a/2+gs_fw_side,   bb+gs_fw_mid+gs_fw_lower,   15, sidemat,
				-a/2+gs_fw_side, b-gs_fw_upper, 10, sidemat,
				-a/2, b-gs_fw_upper, mmask2, sidematedge,
				-a/2, gs_fw_lower, -1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				7,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				a/2, gs_fw_lower, 8, sidematedge,
				a/2-gs_fw_side, gs_fw_lower, 15, sidemat,
				a/2-gs_fw_side, bb+gs_fw_lower, 10, sidemat,
				a/2-gs_fw_side,   bb+gs_fw_mid+gs_fw_lower,   15, sidemat,
				a/2-gs_fw_side, b-gs_fw_upper, 10, sidematedge,
				a/2, b-gs_fw_upper, mmask2, sidematedge,
				a/2, gs_fw_lower, -1, sidematedge

			gosub 500

			sprism_{2} topmat, botmat, sidemat,
				7,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				-a/2, 0, mmask, sidematedge,
				-a/2, gs_fw_lower, 8, sidematedge,
				-a/2+gs_fw_side, gs_fw_lower, 15, sidemat,
				a/2-gs_fw_side, gs_fw_lower, 10, sidemat,
				a/2, gs_fw_lower, mmask2, sidemat,
				a/2, 0, mmask, sidematedge,
				-a/2, 0, -1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				7,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				-a/2, b, mmask, sidematedge,
				-a/2, b-gs_fw_upper, 8, sidematedge,
			   -a/2+gs_fw_side,   b-gs_fw_upper,     15, sidemat,
				a/2-gs_fw_side, b-gs_fw_upper, 10, sidemat,
				a/2, b-gs_fw_upper, mmask2, sidemat,
				a/2, b, mmask, sidematedge,
				-a/2, b, -1, sidematedge

			gosub 600

		endif

		addz framethick

	next ii

	del nn


	!*** same in both

	for ii=1 to nn
		gosub 900

		cprism_ topmat, botmat, sidemat,
			5, framethick,
			-a/2+gs_fw_side, bb+gs_fw_lower, 10,
			-a/2+gs_fw_side, bb+gs_fw_mid+gs_fw_lower,15,
			a/2-gs_fw_side, bb+gs_fw_mid+gs_fw_lower,10,
			a/2-gs_fw_side, bb+gs_fw_lower, 15,
			-a/2+gs_fw_side, bb+gs_fw_lower, -1

		gosub 600

		addz framethick/2

	next ii

	del nn


	body -1


	mag_hat=bb+gs_fw_lower
	for I=1 to 2
		addz gs_leaf_thk/4
		gosub 1600

		body -1
		del 1
	addy bb+gs_fw_mid
	next I
	del 2
	!! END OF FRAME !!

	!! LOUVERS !!

	material gs_louver_mat

	for H=1 to 2

		d=bb-2*gs_int_fw
		n=int(d/gs_shutter_w)
		dp=d/n

		addy gs_fw_lower+gs_int_fw-dp/2
		addz gs_leaf_thk/2

		for i=1 to n step 1
			addy dp
			rotx gs_shutter_ang
			addz -gs_shutter_th/2

			cprism_ louvtopmat, louvbotmat, louvsidemat,
				5, gs_shutter_th,
				-a/2+gs_fw_side+gs_int_fw, -dp/2, 15,
				-a/2+gs_fw_side+gs_int_fw,  dp/2, 15,
				 a/2-gs_fw_side-gs_int_fw,  dp/2, 15,
				 a/2-gs_fw_side-gs_int_fw, -dp/2, 15,
				-a/2+gs_fw_side+gs_int_fw, -dp/2, -1

			body -1
			del 2
		next i
		del n+2

		addy bb+gs_fw_mid
	next H
	del 3

	! ------------ middleline

	if bMiddleLine then gosub "middleline"

return


44:	!!!!!******************** Bifdoor_Panel_E !!!!!

	bb=(b-gs_fw_lower-gs_fw_upper-2*gs_fw_mid)/9        ! Height of one hole

	!! FRAME !!
	material gs_leaf_mat

	!!!Outer frame

	for ii=1 to nn

		gosub 900

		if gs_SashText_typ_num = 1 then

			base

			sprism_{2} topmat, botmat, sidemat,
				9,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				-a/2, 0, 10, sidematedge,
				-a/2+gs_fw_side, gs_fw_lower, 15, sidemat,
				-a/2+gs_fw_side, 4*bb+gs_fw_lower, 10, sidemat,
				-a/2+gs_fw_side, 4*bb+gs_fw_mid+gs_fw_lower,15, sidemat,
				-a/2+gs_fw_side, b-gs_fw_upper-bb-gs_fw_mid, 10, sidemat,
				-a/2+gs_fw_side, b-gs_fw_upper-bb,15, sidemat,
				-a/2+gs_fw_side, b-gs_fw_upper, 10, sidemat,
				-a/2, b, mmask, sidematedge,
				-a/2, 0, -1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				9,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				a/2, 0, 10, sidematedge,
				a/2-gs_fw_side,   gs_fw_lower,     15, sidemat,
				a/2-gs_fw_side, 4*bb+gs_fw_lower, 10, sidemat,
				a/2-gs_fw_side, 4*bb+gs_fw_mid+gs_fw_lower,15, sidemat,
				a/2-gs_fw_side, b-gs_fw_upper-bb-gs_fw_mid, 10, sidemat,
				a/2-gs_fw_side, b-gs_fw_upper-bb,15, sidemat,
				a/2-gs_fw_side, b-gs_fw_upper, 10, sidemat,
				a/2, b, mmask, sidematedge,
				a/2, 0, -1, sidematedge

			gosub 500

			sprism_{2} topmat, botmat, sidemat,
				5,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				-a/2, 0, 10, sidematedge,
				-a/2+gs_fw_side,   gs_fw_lower,     15, sidemat,
				a/2-gs_fw_side, gs_fw_lower, 10, sidemat,
				a/2, 0, mmask, sidematedge,
				-a/2, 0, -1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				5,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				-a/2, b, 10, sidematedge,
				-a/2+gs_fw_side, b-gs_fw_upper, 15, sidemat,
				a/2-gs_fw_side, b-gs_fw_upper, 10, sidemat,
				a/2, b, mmask, sidematedge,
				-a/2, b, -1, sidematedge

			gosub 600

		endif


		if gs_SashText_typ_num = 2 then

			base

			sprism_{2} topmat, botmat, sidemat,
				9,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				-a/2, gs_fw_lower, 8, sidematedge,
				-a/2+gs_fw_side, gs_fw_lower, 15, sidemat,
				-a/2+gs_fw_side, 4*bb+gs_fw_lower, 10, sidemat,
				-a/2+gs_fw_side,   4*bb+gs_fw_mid+gs_fw_lower,   15, sidemat,
				-a/2+gs_fw_side, b-gs_fw_upper-bb-gs_fw_mid, 10, sidemat,
				-a/2+gs_fw_side, b-gs_fw_upper-bb,15, sidemat,
				-a/2+gs_fw_side, b-gs_fw_upper, 10, sidemat,
				-a/2, b-gs_fw_upper, mmask2, sidematedge,
				-a/2, gs_fw_lower, -1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				9,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				a/2, gs_fw_lower, 8, sidematedge,
				a/2-gs_fw_side, gs_fw_lower, 15, sidemat,
				a/2-gs_fw_side, 4*bb+gs_fw_lower, 10, sidemat,
				a/2-gs_fw_side,   4*bb+gs_fw_mid+gs_fw_lower,   15, sidemat,
				a/2-gs_fw_side, b-gs_fw_upper-bb-gs_fw_mid, 10, sidemat,
				a/2-gs_fw_side, b-gs_fw_upper-bb,15, sidemat,
				a/2-gs_fw_side, b-gs_fw_upper, 10, sidemat,
				a/2, b-gs_fw_upper, mmask2, sidematedge,
				a/2, gs_fw_lower, -1, sidematedge

			gosub 500

			sprism_{2} topmat, botmat, sidemat,
				7,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				-a/2, 0, mmask, sidematedge,
				-a/2, gs_fw_lower, 8, sidematedge,
				-a/2+gs_fw_side, gs_fw_lower, 15, sidemat,
				a/2-gs_fw_side, gs_fw_lower, 10, sidemat,
				a/2, gs_fw_lower, mmask2, sidematedge,
				a/2, 0, mmask, sidematedge,
				-a/2, 0, -1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				7,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				-a/2, b, mmask, sidematedge,
				-a/2, b-gs_fw_upper, 8, sidematedge,
				-a/2+gs_fw_side,   b-gs_fw_upper,   15, sidemat,
				a/2-gs_fw_side, b-gs_fw_upper, 10, sidemat,
				a/2, b-gs_fw_upper, mmask2, sidematedge,
				a/2, b, mmask, sidematedge,
				-a/2, b, -1, sidematedge

			gosub 600

		endif

		addz framethick/2

	next ii

	del nn



	!*** same in both

	for ii=1 to nn

		gosub 900

		cprism_ topmat, botmat, sidemat,
			5, framethick,
			-a/2+gs_fw_side, 4*bb+gs_fw_lower, 10,
			-a/2+gs_fw_side, 4*bb+gs_fw_mid+gs_fw_lower,15,
			a/2-gs_fw_side, 4*bb+gs_fw_mid+gs_fw_lower,10,
			a/2-gs_fw_side, 4*bb+gs_fw_lower, 15,
			-a/2+gs_fw_side, 4*bb+gs_fw_lower, -1

		cprism_ topmat, botmat, sidemat,
			5, framethick,
			-a/2+gs_fw_side, b-gs_fw_upper-bb-gs_fw_mid, 10,
			-a/2+gs_fw_side,   b-gs_fw_upper-bb,     15,
			a/2-gs_fw_side, b-gs_fw_upper-bb,10,
			a/2-gs_fw_side, b-gs_fw_upper-bb-gs_fw_mid, 15,
			-a/2+gs_fw_side, b-gs_fw_upper-bb-gs_fw_mid, -1

		gosub 600

		addz framethick/2

	next ii

	del nn


	body -1

	mag_hat=4*bb+gs_fw_lower
	for I=1 to 2
		addz gs_leaf_thk/4
		gosub 1600

		body -1
		del 1
		addy 4*bb+gs_fw_mid
	next I
	del 2

	mag_hat=bb+gs_fw_upper
	addz gs_leaf_thk/4
	addy b-gs_fw_lower-gs_fw_upper-bb
	gosub 1600

	body -1
	del 2
	!! END OF FRAME !!

	!! LOUVERS !!

	material gs_louver_mat

	for H=1 to 2

		d=4*bb-2*gs_int_fw
		n=int(d/gs_shutter_w)
		dp=d/n

		addy gs_fw_lower+gs_int_fw-dp/2
		addz gs_leaf_thk/2
		for i=1 to n step 1
			addy dp

			rotx gs_shutter_ang
			addz -gs_shutter_th/2

			cprism_ louvtopmat, louvbotmat, louvsidemat,
					5, gs_shutter_th,
					-a/2+gs_fw_side+gs_int_fw, -dp/2, 15,
					-a/2+gs_fw_side+gs_int_fw,  dp/2, 15,
					 a/2-gs_fw_side-gs_int_fw,  dp/2, 15,
					 a/2-gs_fw_side-gs_int_fw, -dp/2, 15,
					-a/2+gs_fw_side+gs_int_fw, -dp/2, -1

			body -1
			del 2
		next i
		del n+2

		addy 4*bb+gs_fw_mid
	next H
	del 2


	d=bb-2*gs_int_fw
	if d/gs_shutter_w-int(d/gs_shutter_w)<=0.5 then n=int(d/gs_shutter_w)
	if d/gs_shutter_w-int(d/gs_shutter_w)>0.5 then n=ceil(d/gs_shutter_w)
	if n=0 then n=1
	dp=d/n

	addy b-gs_fw_upper-bb+gs_int_fw-dp/2
	addz gs_leaf_thk/2
	for i=1 to n step 1
		addy dp

		rotx gs_shutter_ang
		addz -gs_shutter_th/2

		cprism_ louvtopmat, louvbotmat, louvsidemat,
				5, gs_shutter_th,
				-a/2+gs_fw_side+gs_int_fw, -dp/2, 15,
				-a/2+gs_fw_side+gs_int_fw,  dp/2, 15,
				 a/2-gs_fw_side-gs_int_fw,  dp/2, 15,
				 a/2-gs_fw_side-gs_int_fw, -dp/2, 15,
				-a/2+gs_fw_side+gs_int_fw, -dp/2, -1

		body -1
		del 2
	next i
	del n+3

	! ------------ middleline

	if bMiddleLine then gosub "middleline"

return


! ************************************************************
!  French Panel
! ************************************************************

45:
!! KICK PLATE !!
if gs_kick_plate then
	material gs_kp_mat
	add -a/2, 0, -0.001
		block a, gs_kick_plate_h, 0.001
	body -1
	del 1

	add -a/2, 0, gs_leaf_thk
		block a, gs_kick_plate_h, 0.001
	body -1
	del 1
endif
!! END OF KICK PLATE !!


!!!!!******************** CASEMENT_D !!!!

!**** FRAME !!

	material gs_leaf_mat


for ii=1 to nn

	gosub 900

	if gs_SashText_typ_num = 1 then

		base

			sprism_{2} topmat, botmat, sidemat,
				5,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				-a/2, 0, 10, sidematedge,
				-a/2+gs_fw_side_left,   gs_fw_lower, mmask, sidemat,
				-a/2+gs_fw_side_left, b-gs_fw_upper, 10, sidemat,
				-a/2, b, mmask, sidematedge,
				-a/2, 0, -1, sidematedge


			sprism_{2} topmat, botmat, sidemat,
				5,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				a/2, 0, 10, sidematedge,
				a/2-gs_fw_side_right, gs_fw_lower, mmask, sidemat,
				a/2-gs_fw_side_right, b-gs_fw_upper, 10, sidemat,
				a/2, b, mmask, sidematedge,
				a/2, 0, -1, sidematedge

			gosub 500

			sprism_{2} topmat, botmat, sidemat,
				5,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				-a/2, 0, 10, sidematedge,
				-a/2+gs_fw_side_left, gs_fw_lower, mmask, sidemat,
				a/2-gs_fw_side_right, gs_fw_lower, 10, sidemat,
				a/2, 0, mmask, sidematedge,
				-a/2, 0, -1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				5,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				-a/2, b, 10, sidematedge,
				-a/2+gs_fw_side_left, b-gs_fw_upper, mmask, sidemat,
				a/2-gs_fw_side_right, b-gs_fw_upper, 10, sidemat,
				a/2, b, mmask, sidematedge,
				-a/2, b, -1, sidematedge

			gosub 600

	endif

	if gs_SashText_typ_num = 2 then

		base

			sprism_{2} topmat, botmat, sidemat,
				5,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				-a/2,  gs_fw_lower, 8, sidematedge,
				-a/2+gs_fw_side_left, gs_fw_lower, mmask, sidemat,
				-a/2+gs_fw_side_left, b-gs_fw_upper, 10, sidemat,
				-a/2, b-gs_fw_upper, mmask2, sidematedge,
				-a/2,  gs_fw_lower, -1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				5,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				a/2,  gs_fw_lower, 8, sidematedge,
				a/2-gs_fw_side_right, gs_fw_lower, mmask, sidemat,
				a/2-gs_fw_side_right, b-gs_fw_upper, 10, sidemat,
				a/2, b-gs_fw_upper, mmask2, sidematedge,
				a/2,  gs_fw_lower, -1, sidematedge

			gosub 500

			sprism_{2} topmat, botmat, sidemat,
				7,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				-a/2, 0, mmask, sidematedge,
				-a/2, gs_fw_lower, 8, sidematedge,
				-a/2+gs_fw_side_left, gs_fw_lower, mmask, sidemat,
				a/2-gs_fw_side_right, gs_fw_lower, 10, sidemat,
				a/2, gs_fw_lower,mmask2, sidematedge,
				a/2, 0, mmask, sidematedge,
				-a/2, 0, -1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				7,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				-a/2, b, mmask, sidematedge,
				-a/2, b-gs_fw_upper, 8, sidematedge,
				-a/2+gs_fw_side_left, b-gs_fw_upper, mmask, sidemat,
				a/2-gs_fw_side_right, b-gs_fw_upper, 10, sidemat,
				a/2, b-gs_fw_upper, mmask2, sidematedge,
				a/2, b, mmask, sidematedge,
				-a/2, b, -1, sidematedge

			gosub 600
	endif

	addz framethick

next ii

del nn



body -1


group "glazing 45"

	!********* GLAZING

	pen gs_glass_pen
	sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_glass_pen_cont
	material gs_glass_mat

	addz gs_leaf_thk/2-gs_glass_thk/2

	prism_ 5, gs_glass_thk,
		-a/2+gs_fw_side_left,   gs_fw_lower, glas_mask5,
		 a/2-gs_fw_side_right,   gs_fw_lower, glas_mask5,
		 a/2-gs_fw_side_right, b-gs_fw_upper, glas_mask5,
		-a/2+gs_fw_side_left, b-gs_fw_upper, glas_mask5,
		-a/2+gs_fw_side_left,   gs_fw_lower, -1

	body -1

	del 1

endgroup


group "grids 45"
	if lod3D = 5 then
		addz -multhick/2
		multhick = multhick * 2
	endif

	!! GRIDS !!

	pen gs_leaf_pen
	sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_leaf_pen_cont
	material gs_grill_mat


	!! H-V GRID !!

	for ii=1 to mn

		gosub 910

		!***************** HORIZONTAL GRIDS

		if gs_hor_gnum>0 then
			for i=1 to gs_hor_gnum

				addy gs_hor_d[i]

				for HI=1 to gs_ver_gnum+1

					if HI=1 then hgnn=gs_ver_d[1]-gs_grid_w
					if HI>1 and HI<gs_ver_gnum+1 then hgnn=gs_ver_d[HI]-gs_ver_d[HI-1]-gs_grid_w
					if HI=gs_ver_gnum+1 then
						if gs_ver_gnum>0 then
							hgnn=a-gs_fw_side_left-gs_fw_side_right-gs_ver_d[HI-1]
						else
							hgnn=a-gs_fw_side_left-gs_fw_side_right
						endif
					endif

					add -a/2+gs_fw_side_left, gs_fw_lower-gs_grid_w/2, gz

					cprism_ multopmat, mulbotmat, mulsidemat,
						5, multhick,
						0, -gs_grid_w/2, 15,
						 hgnn, -gs_grid_w/2, 15,
						 hgnn,  gs_grid_w/2, 15,
						0,  gs_grid_w/2, 15,
						0, -gs_grid_w/2, -1

					body -1
					del 1

				addx hgnn+gs_grid_w

				next HI

				del gs_ver_gnum+1

				del 1
			next i
		endif

		!******************* VERTICAL GRIDS

		if gs_ver_gnum>0 then
			for HK=1 to gs_ver_gnum
				addx gs_ver_d[HK]
					add  -a/2+gs_fw_side_left-gs_grid_w/2, 0, gz

					cprism_ multopmat, mulbotmat, mulsidemat,
							5, multhick,
						-gs_grid_w/2,   gs_fw_lower, 15,
						 gs_grid_w/2,   gs_fw_lower, 15,
						 gs_grid_w/2, b-gs_fw_upper, 15,
						-gs_grid_w/2, b-gs_fw_upper, 15,
						-gs_grid_w/2,   gs_fw_lower, -1

					body -1
					del 1
				del 1
			next HK
		endif

		addz multhick

	next ii

	del mn

	if lod3D = 5 then del 1
endgroup

if lod3D = 5 then
	mulz 0.5
	addz multhick/4
	placegroup "grids 45"
	del 2
	result_45 = subgroup("glazing 45", "grids 45")
	placegroup result_45
	killgroup result_45
else
	placegroup "glazing 45"
	placegroup "grids 45"
endif
killgroup "glazing 45"
killgroup "grids 45"

return

46:

!******************** CASEMENT_D !!!!

!********************************* No Grid

material gs_leaf_mat


if iLeafShape = LEAF_SHAPE_RECTANGULAR then
	for ii=1 to nn

		gosub 900

		if gs_SashText_typ_num = 1 then

			base

			sprism_{2} topmat, botmat, sidemat,
				5,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				-a/2,0,10, sidematedge,
				-a/2+gs_fw_side,   gs_fw_lower, mmask, sidemat,
				-a/2+gs_fw_side,b-gs_fw_upper,10, sidemat,
				-a/2,B,mmask, sidematedge,
				-a/2,0,-1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				5,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				a/2,0,10, sidematedge,
				a/2-gs_fw_side,   gs_fw_lower, mmask, sidemat,
				a/2-gs_fw_side,b-gs_fw_upper,10, sidemat,
				a/2,B,mmask, sidematedge,
				a/2,0,-1, sidematedge

			gosub 500

			sprism_{2} topmat, botmat, sidemat,
				5,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				-a/2,0,10, sidematedge,
				-a/2+gs_fw_side,gs_fw_lower,mmask, sidemat,
				a/2-gs_fw_side,gs_fw_lower,10, sidemat,
				a/2,0,mmask, sidematedge,
				-a/2,0,-1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				5,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				-a/2,B,10, sidematedge,
				-a/2+gs_fw_side,B-gs_fw_upper,mmask, sidemat,
				a/2-gs_fw_side,B-gs_fw_upper,10, sidemat,
				a/2,B,mmask, sidematedge,
				-a/2,B,-1, sidematedge

			gosub 600

		endif

		if gs_SashText_typ_num = 2 then

			base

			if B > gs_fw_lower + gs_fw_upper then
				sprism_{2} topmat, botmat, sidemat,
					5,
					0,  0,  1,  0,  framethick, 0,
					0,  0,  1,  0,   0,  0,
					-a/2,gs_fw_lower,8, sidematedge,
					-a/2+gs_fw_side,   gs_fw_lower, mmask, sidemat,
					-a/2+gs_fw_side,B-gs_fw_upper,10, sidemat,
					-a/2,B-gs_fw_upper,mmask2, sidematedge,
					-a/2,gs_fw_lower,-1, sidematedge

				sprism_{2} topmat, botmat, sidemat,
					5,
					0,  0,  1,  0,  framethick, 0,
					0,  0,  1,  0,   0,  0,
					a/2,gs_fw_lower,8, sidematedge,
					a/2-gs_fw_side,   gs_fw_lower, mmask, sidemat,
					a/2-gs_fw_side,B-gs_fw_upper,10, sidemat,
					a/2,B-gs_fw_upper,mmask2, sidematedge,
					a/2,gs_fw_lower,-1, sidematedge
			endif

			gosub 500

			sprism_{2} topmat, botmat, sidemat,
				7,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				-a/2,0,mmask, sidematedge,
				-a/2,gs_fw_lower,8, sidematedge,
				-a/2+gs_fw_side,gs_fw_lower,mmask, sidemat,
				a/2-gs_fw_side,gs_fw_lower,10, sidemat,
				a/2,gs_fw_lower,mmask2, sidematedge,
				a/2,0,mmask, sidematedge,
				-a/2,0,-1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				7,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				-a/2,B,mmask, sidematedge,
				-a/2,B-gs_fw_upper,8, sidematedge,
				-a/2+gs_fw_side,B-gs_fw_upper,mmask, sidemat,
				a/2-gs_fw_side,B-gs_fw_upper,10, sidemat,
				a/2,B-gs_fw_upper,mmask2, sidematedge,
				a/2,B,mmask, sidematedge,
				-a/2,B,-1, sidematedge

			gosub 600

		endif

		addz framethick

	next ii

	del nn


	body -1

	!************GLAZING

	pen gs_glass_pen
	sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_glass_pen_cont
	material gs_glass_mat

	addz gs_leaf_thk/2-gs_glass_thk/2

	if (B > gs_fw_lower + gs_fw_upper) & (A > 2 * gs_fw_side) then
		prism_ 5, gs_glass_thk,
			-a/2+gs_fw_side,   gs_fw_lower, glas_mask5,
			 a/2-gs_fw_side,   gs_fw_lower, glas_mask5,
			 a/2-gs_fw_side, b-gs_fw_upper, glas_mask5,
			-a/2+gs_fw_side, b-gs_fw_upper, glas_mask5,
			-a/2+gs_fw_side,   gs_fw_lower, -1
	endif

	del 1
endif


if iLeafShape = LEAF_SHAPE_ARCHED then

	if abs(bce - (A/2)) < EPS then
		frm = 2
	else
		frm = 0
	endif

	for ii=1 to nn

		gosub 900

		if gs_SashText_typ_num = 1 then

			base

			sprism_{2} topmat, botmat, sidemat,
					13,
					0,  0,  1,  0,  framethick, 0,
					0,  0,  1, 0,   0,  0,
					-a/2,0,10, sidematedge,
					-a/2+gs_fw_side, gs_fw_lower, mmask, sidemat,
					-a/2+gs_fw_side, gs_shoulder_h-(fce-fcefw), 64+mmask, sidemat,
					1, tan(alphafw/2), 800, sidemat,
					0, b-gs_fw_side, 1064+mmask-frm, sidemat,
					a/2-gs_fw_side, gs_shoulder_h-(fce-fcefw), 1064+mmask-frm, sidemat,
					a/2-gs_fw_side, gs_fw_lower, 10, sidemat,
					a/2,0,mmask, sidematedge,
					a/2, gs_shoulder_h, 64+mmask, sidematedge,
					-1, tan(alphace/2), 800, sidematedge,
					0,b, 1064+mmask-frm, sidematedge,
					-a/2,gs_shoulder_h, 1064+mmask-frm, sidematedge,
					-a/2,0,-1, sidematedge

			gosub 500

			sprism_{2} topmat, botmat, sidemat,
					5,
					0,  0,  1,  0,  framethick, 0,
					0,  0,  1, 0,   0,  0,
					-a/2,0,10, sidematedge,
					-a/2+gs_fw_side, gs_fw_lower, mmask, sidemat,
					a/2-gs_fw_side, gs_fw_lower, 10, sidemat,
					a/2,0,mmask, sidematedge,
					-a/2,0,-1, sidematedge

			gosub 600

		endif

		if gs_SashText_typ_num = 2 then

			base

			sprism_{2} topmat, botmat, sidemat,
					13,
					0,  0,  1,  0,  framethick, 0,
					0,  0,  1, 0,   0,  0,
					-a/2,gs_fw_lower,8, sidematedge,
					-a/2+gs_fw_side, gs_fw_lower, mmask, sidemat,
					-a/2+gs_fw_side, gs_shoulder_h-(fce-fcefw), 64+mmask, sidemat,
					1, tan(alphafw/2), 800, sidemat,
					0, b-gs_fw_side, 1064+mmask-frm, sidemat,
					a/2-gs_fw_side, gs_shoulder_h-(fce-fcefw), 1064+mmask-frm, sidemat,
					a/2-gs_fw_side, gs_fw_lower, 10, sidematedge,
					a/2,gs_fw_lower,mmask2, sidematedge,
					a/2, gs_shoulder_h, 64+mmask, sidematedge,
					-1, tan(alphace/2), 800, sidematedge,
					0,b, 1064+mmask-frm, sidematedge,
					-a/2,gs_shoulder_h, 1064+mmask-frm, sidematedge,
					-a/2,gs_fw_lower,-1, sidematedge

			gosub 500

			sprism_{2} topmat, botmat, sidemat,
					7,
					0,  0,  1,  0,  framethick, 0,
					0,  0,  1, 0,   0,  0,
					-a/2, 0, mmask, sidematedge,
					-a/2, gs_fw_lower, 8, sidematedge,
					-a/2+gs_fw_side, gs_fw_lower, mmask, sidemat,
					a/2-gs_fw_side, gs_fw_lower, 10, sidemat,
					a/2, gs_fw_lower, mmask2, sidematedge,
					a/2, 0, mmask, sidematedge,
					-a/2, 0, -1, sidematedge

			gosub 600

		endif

		body -1

		addz framethick

	next ii

	del nn

	!! GLAZING !!

	pen gs_glass_pen
	sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_glass_pen_cont
	material gs_glass_mat

	addz gs_leaf_thk/2-gs_glass_thk/2

		prism_ 7, gs_glass_thk,
		-a/2+gs_fw_side, gs_fw_lower, glas_mask5,
		 a/2-gs_fw_side, gs_fw_lower, glas_mask5,
		 a/2-gs_fw_side, gs_shoulder_h-(fce-fcefw), 79,
		-1, tan(alphafw/2), 800+glas_mask5,
		 0, b-gs_fw_side, 1079,
		-a/2+gs_fw_side, gs_shoulder_h-(fce-fcefw), 1079,
		-a/2+gs_fw_side, gs_fw_lower, -1

	del 1

	!! END OF GLAZING !!
endif


if iLeafShape = LEAF_SHAPE_HALFARCHED then

	if abs(gs_shoulder_h - A) < EPS then
		frm = 2
	else
		frm = 0
	endif

	for ii=1 to nn

		gosub 900

		if gs_SashText_typ_num = 1 then

			base

				sprism_{2} topmat, botmat, sidemat,
					5,
					0,  0,  1,  0,  framethick, 0,
					0,  0,  1, 0,   0,  0,
					a/2, 0, 10, sidematedge,
					a/2-gs_fw_side, gs_fw_lower, mmask, sidemat,
					a/2-gs_fw_side, b-(r2-sqr((r2-gs_fw_side)^2-gs_fw_side^2)), 10, sidemat,
					a/2, b, mmask, sidematedge,
					a/2, 0, -1, sidematedge

				sprism_{2} topmat, botmat, sidemat,
					5,
					0,  0,  1,  0,  framethick, 0,
					0,  0,  1, 0,   0,  0,
					-a/2, 0, 10, sidematedge,
					-a/2+gs_fw_side, gs_fw_lower, mmask, sidemat,
					-a/2+gs_fw_side, gs_shoulder_h-(fce-fcefw), 10, sidemat,
					-a/2,gs_shoulder_h,mmask, sidematedge,
					-a/2, 0, -1, sidematedge

				gosub 500

				sprism_{2} topmat, botmat, sidemat,
					5,
					0,  0,  1,  0,  framethick, 0,
					0,  0,  1, 0,   0,  0,
					a/2,0,10, sidematedge,
					a/2-gs_fw_side, gs_fw_lower, mmask, sidemat,
					-a/2+gs_fw_side, gs_fw_lower, 10, sidemat,
					-a/2,0,mmask, sidematedge,
					a/2,0,-1, sidematedge

				gosub 600

				sprism_{2} topmat, botmat, sidemat,
					7,
					0,  0,  1,  0,  framethick, 0,
					0,  0,  1, 0,   0,  0,
					a/2, b, 64+mmask, sidematedge,
					-1, 0, 800, sidematedge,
					-a/2,gs_shoulder_h, 1010-frm, sidematedge,
					-a/2+gs_fw_side, gs_shoulder_h-(fce-fcefw), 64+mmask, sidemat,
					1, tan(alphafw/2), 800, sidemat,
					a/2-gs_fw_side, b-(r2-sqr((r2-gs_fw_side)^2-gs_fw_side^2)), 1010-frm, sidemat,
					a/2, b, -1, sidematedge

			vert 0, 0, 0
			vert -1, 1, 0
			vert 1, 0, 0
			vert 0, 0, 1
			coor 2, -1, -2, -3, -4
			body 1

		endif

		if gs_SashText_typ_num = 2 then

			base

				sprism_{2} topmat, botmat, sidemat,
					5,
					0,  0,  1,  0,  framethick, 0,
					0,  0,  1, 0,   0,  0,
					a/2, gs_fw_lower, 8, sidematedge,
					a/2-gs_fw_side, gs_fw_lower, mmask, sidemat,
					a/2-gs_fw_side, b-(r2-sqr((r2-gs_fw_side)^2-gs_fw_side^2)), 10, sidemat,
					a/2, b-(r2-sqr((r2-gs_fw_side)^2-gs_fw_side^2)), mmask2, sidematedge,
					a/2, gs_fw_lower, -1, sidematedge

				sprism_{2} topmat, botmat, sidemat,
					5,
					0,  0,  1,  0,  framethick, 0,
					0,  0,  1, 0,   0,  0,
					-a/2, gs_fw_lower, 8, sidematedge,
					-a/2+gs_fw_side, gs_fw_lower, mmask, sidemat,
					-a/2+gs_fw_side, gs_shoulder_h-(fce-fcefw), 10, sidemat,
					-a/2, gs_shoulder_h-(fce-fcefw),mmask2, sidematedge,
					-a/2, gs_fw_lower, -1, sidematedge

				gosub 500

				sprism_{2} topmat, botmat, sidemat,
					7,
					0,  0,  1,  0,  framethick, 0,
					0,  0,  1, 0,   0,  0,
					a/2, 0, mmask, sidematedge,
					a/2, gs_fw_lower, 8, sidematedge,
					a/2-gs_fw_side, gs_fw_lower, mmask, sidemat,
					-a/2+gs_fw_side, gs_fw_lower, 10, sidemat,
					-a/2, gs_fw_lower, mmask2, sidematedge,
					-a/2, 0, mmask, sidematedge,
					a/2, 0, -1, sidematedge

				gosub 600

				sprism_{2} topmat, botmat, sidemat,
					10,
					0,  0,  1,  0,  framethick, 0,
					0,  0,  1, 0,   0,  0,
					a/2,b-(r2-sqr((r2-gs_fw_side)^2-gs_fw_side^2)),mmask2, sidematedge,
					a/2, b-0.00001, mmask, sidematedge,
					a/2, b, 64+mmask, sidematedge,
					-1, 0,      800, sidematedge,
					-a/2, gs_shoulder_h, 1000+mmask, sidematedge,
					-a/2, gs_shoulder_h-(fce-fcefw),8, sidemat,
					-a/2+gs_fw_side, gs_shoulder_h-(fce-fcefw), 64+mmask, sidemat,
					1, tan(alphafw/2), 800, sidemat,
					a/2-gs_fw_side, b-(r2-sqr((r2-gs_fw_side)^2-gs_fw_side^2)), 1010-frm, sidemat,
					a/2,b-(r2-sqr((r2-gs_fw_side)^2-gs_fw_side^2)),-1, sidematedge

			vert 0, 0, 0
			vert -1, 1, 0
			vert 1, 0, 0
			vert 0, 0, 1
			coor 2, -1, -2, -3, -4
			body 1

		endif


		body -1

		addz framethick

	next ii

	del nn

	!! GLAZING !!

	pen gs_glass_pen
	sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_glass_pen_cont
	material gs_glass_mat

	addz gs_leaf_thk/2-gs_glass_thk/2
		prism_ 6, gs_glass_thk,
			a/2-gs_fw_side, gs_fw_lower, glas_mask5,
			-a/2+gs_fw_side, gs_fw_lower, glas_mask5,
			-a/2+gs_fw_side, gs_shoulder_h-(fce-fcefw), 79,
			1, tan(alphafw/2), 800+glas_mask5,
			a/2-gs_fw_side, b-(r2-sqr((r2-gs_fw_side)^2-gs_fw_side^2)), 1079-frm,
			a/2-gs_fw_side, gs_fw_lower, -1
		body -1
	del 1

	!! END OF GLAZING !!
endif



RETURN


47:

!******************** CASEMENT_D !!!!

!********************************* H-V Grid

material gs_leaf_mat

if iLeafShape = LEAF_SHAPE_RECTANGULAR then
	for ii=1 to nn

		gosub 900

		if gs_SashText_typ_num = 1 then

			base

			sprism_{2} topmat, botmat, sidemat,
				5,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				-a/2,0,10, sidematedge,
				-a/2+gs_fw_side, gs_fw_lower, mmask, sidemat,
				-a/2+gs_fw_side, b-gs_fw_upper,10, sidemat,
				-a/2,B,mmask, sidematedge,
				-a/2,0,-1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				5,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				a/2,0,10, sidematedge,
				a/2-gs_fw_side, gs_fw_lower, mmask, sidemat,
				a/2-gs_fw_side, b-gs_fw_upper,10, sidemat,
				a/2,B,mmask, sidematedge,
				a/2,0,-1, sidematedge

			gosub 500

			sprism_{2} topmat, botmat, sidemat,
				5,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				-a/2,0,10, sidematedge,
				-a/2+gs_fw_side,gs_fw_lower,mmask, sidemat,
				a/2-gs_fw_side,gs_fw_lower,10, sidemat,
				a/2,0,mmask, sidematedge,
				-a/2,0,-1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				5,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				-a/2,B,10, sidematedge,
				-a/2+gs_fw_side,B-gs_fw_upper,mmask, sidemat,
				a/2-gs_fw_side,B-gs_fw_upper,10, sidemat,
				a/2,B,mmask, sidematedge,
				-a/2,B,-1, sidematedge

			gosub 600

		endif

		if gs_SashText_typ_num = 2 then

			base

			if B > gs_fw_lower + gs_fw_upper then
				sprism_{2} topmat, botmat, sidemat,
					5,
					0,  0,  1,  0,  framethick, 0,
					0,  0,  1,  0,   0,  0,
					-a/2,gs_fw_lower,8, sidematedge,
					-a/2+gs_fw_side,   gs_fw_lower, mmask, sidemat,
					-a/2+gs_fw_side,B-gs_fw_upper,10, sidemat,
					-a/2,B-gs_fw_upper,mmask2, sidematedge,
					-a/2,gs_fw_lower,-1, sidematedge

				sprism_{2} topmat, botmat, sidemat,
					5,
					0,  0,  1,  0,  framethick, 0,
					0,  0,  1,  0,   0,  0,
					a/2,gs_fw_lower,8, sidematedge,
					a/2-gs_fw_side,   gs_fw_lower, mmask, sidemat,
					a/2-gs_fw_side,B-gs_fw_upper,10, sidemat,
					a/2,B-gs_fw_upper,mmask2, sidematedge,
					a/2,gs_fw_lower,-1, sidematedge
			endif

			gosub 500

			sprism_{2} topmat, botmat, sidemat,
				7,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				-a/2,0,mmask, sidematedge,
				-a/2,gs_fw_lower,8, sidematedge,
				-a/2+gs_fw_side,gs_fw_lower,mmask, sidemat,
				a/2-gs_fw_side,gs_fw_lower,10, sidemat,
				a/2,gs_fw_lower,mmask2, sidematedge,
				a/2,0,mmask, sidematedge,
				-a/2,0,-1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				7,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				-a/2,B,mmask, sidematedge,
				-a/2,B-gs_fw_upper,8, sidematedge,
				-a/2+gs_fw_side,B-gs_fw_upper,mmask, sidemat,
				a/2-gs_fw_side,B-gs_fw_upper,10, sidemat,
				a/2,B-gs_fw_upper,mmask2, sidematedge,
				a/2,B,mmask, sidematedge,
				-a/2,B,-1, sidematedge

			gosub 600

		endif

		addz framethick

	next ii

	del nn


	body -1


	!************GLAZING

	pen gs_glass_pen
	sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_glass_pen_cont
	material gs_glass_mat

	add -a/2+gs_fw_side, gs_fw_lower, gs_leaf_thk/2-gs_glass_thk/2

	if (B > gs_fw_lower + gs_fw_upper) & (A > 2 * gs_fw_side) then

		glazing_x = (a-2*gs_fw_side-gs_grid_w*gs_ver_gnum)/(gs_ver_gnum+1)
		glazing_y = (b-gs_fw_upper-gs_fw_lower-gs_grid_w*gs_hor_gnum)/(gs_hor_gnum+1)

		if gs_grill_pos_m = MULLION_THROUGHOUT | lod3D = 5 then
			for jj = 1 to (gs_hor_gnum + 1)
				for ii = 1 to (gs_ver_gnum + 1)
					prism_ 4, gs_glass_thk,
						0,			0,			glas_mask5,
						0,			glazing_y,	glas_mask5,
						glazing_x,	glazing_y,	glas_mask5,
						glazing_x,	0,			glas_mask5

					addx glazing_x+gs_grid_w
				next ii
				del (gs_ver_gnum + 1)

				addy glazing_y+gs_grid_w
			next jj
			del (gs_hor_gnum + 1)
		else
			prism_ 4, gs_glass_thk,
				0,				0,							glas_mask5,
				0,				B-gs_fw_upper-gs_fw_lower,	glas_mask5,
				A-2*gs_fw_side, B-gs_fw_upper-gs_fw_lower,	glas_mask5,
				A-2*gs_fw_side, 0,							glas_mask5
		endif
	endif

	del 1



	!! GRIDS !!

	pen gs_leaf_pen
	sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_leaf_pen_cont
	material gs_grill_mat

	!! Model Solid

	!*** Vertical grids !!

	for ii=1 to mn

		gosub 910

		if gs_ver_gnum>0 then

			base

			for i=1 to gs_ver_gnum

				addx (a-2*gs_fw_side+gs_grid_w)/(gs_ver_gnum+1)
				add  -a/2+gs_fw_side-gs_grid_w/2, 0, gz

				cprism_ multopmat, mulbotmat, mulsidemat,
					5, multhick,
					-gs_grid_w/2,   gs_fw_lower, mmask,
					 gs_grid_w/2,   gs_fw_lower, mmask,
					 gs_grid_w/2, b-gs_fw_upper, mmask,
					-gs_grid_w/2, b-gs_fw_upper, mmask,
					-gs_grid_w/2,   gs_fw_lower, -1

				del 1

			next i

			del gs_ver_gnum

			gosub 500

		endif

		addz multhick

	next ii

	del mn


	!*** Horizontal grids !!

	if gs_hor_gnum>0 then

		for ii=1 to mn

			gosub 910

			for i=1 to gs_ver_gnum+1

				for j=1 to gs_hor_gnum

					addy (b-gs_fw_lower-gs_fw_upper+gs_grid_w)/(gs_hor_gnum+1)
					add -(a-2*gs_fw_side)/2+hgnn/2, gs_fw_lower-gs_grid_w/2, gz

					cprism_ multopmat, mulbotmat, mulsidemat,
						5, multhick,
						-hgnn/2, -gs_grid_w/2, mmask,
						 hgnn/2, -gs_grid_w/2, mmask,
						 hgnn/2,  gs_grid_w/2, mmask,
						-hgnn/2,  gs_grid_w/2, mmask,
						-hgnn/2, -gs_grid_w/2, -1

					del 1

				next j

				del gs_hor_gnum

				addx (a-2*gs_fw_side+gs_grid_w)/(gs_ver_gnum+1)

			next i

			del gs_ver_gnum+1

			body -1

			addz multhick

		next ii

		del mn

	endif
endif


if iLeafShape = LEAF_SHAPE_ARCHED then
	for ii=1 to nn

		gosub 900

		if gs_SashText_typ_num = 1 then

			base

			sprism_{2} topmat, botmat, sidemat,
					13,
					0,  0,  1,  0,  framethick, 0,
					0,  0,  1, 0,   0,  0,
					-a/2,0,10, sidematedge,
					-a/2+gs_fw_side, gs_fw_lower, mmask, sidemat,
					-a/2+gs_fw_side, gs_shoulder_h-(fce-fcefw), 64+mmask, sidemat,
					1, tan(alphafw/2), 800, sidemat,
					0, b-gs_fw_side, 1064+mmask-frm, sidemat,
					a/2-gs_fw_side, gs_shoulder_h-(fce-fcefw), 1064+mmask-frm, sidemat,
					a/2-gs_fw_side, gs_fw_lower, 10, sidemat,
					a/2,0,mmask, sidematedge,
					a/2, gs_shoulder_h, 64+mmask, sidematedge,
					-1, tan(alphace/2), 800, sidematedge,
					0,b, 1064+mmask-frm, sidematedge,
					-a/2,gs_shoulder_h, 1064+mmask-frm, sidematedge,
					-a/2,0,-1, sidematedge

			gosub 500

			sprism_{2} topmat, botmat, sidemat,
					5,
					0,  0,  1,  0,  framethick, 0,
					0,  0,  1, 0,   0,  0,
					-a/2,0,10, sidematedge,
					-a/2+gs_fw_side, gs_fw_lower, mmask, sidemat,
					a/2-gs_fw_side, gs_fw_lower, 10, sidemat,
					a/2,0,mmask, sidematedge,
					-a/2,0,-1, sidematedge

			gosub 600

		endif

		if gs_SashText_typ_num = 2 then

			base

			sprism_{2} topmat, botmat, sidemat,
					13,
					0,  0,  1,  0,  framethick, 0,
					0,  0,  1, 0,   0,  0,
					-a/2,gs_fw_lower,8, sidematedge,
					-a/2+gs_fw_side, gs_fw_lower, mmask, sidemat,
					-a/2+gs_fw_side, gs_shoulder_h-(fce-fcefw), 64+mmask, sidemat,
					1, tan(alphafw/2), 800, sidemat,
					0, b-gs_fw_side, 1064+mmask-frm, sidemat,
					a/2-gs_fw_side, gs_shoulder_h-(fce-fcefw), 1064+mmask-frm, sidemat,
					a/2-gs_fw_side, gs_fw_lower, 10, sidematedge,
					a/2,gs_fw_lower,mmask2, sidematedge,
					a/2, gs_shoulder_h, 64+mmask, sidematedge,
					-1, tan(alphace/2), 800, sidematedge,
					0,b, 1064+mmask-frm, sidematedge,
					-a/2,gs_shoulder_h, 1064+mmask-frm, sidematedge,
					-a/2,gs_fw_lower,-1, sidematedge

			gosub 500

			sprism_{2} topmat, botmat, sidemat,
					7,
					0,  0,  1,  0,  framethick, 0,
					0,  0,  1, 0,   0,  0,
					-a/2, 0, mmask, sidematedge,
					-a/2, gs_fw_lower, 8, sidematedge,
					-a/2+gs_fw_side, gs_fw_lower, mmask, sidemat,
					a/2-gs_fw_side, gs_fw_lower, 10, sidemat,
					a/2, gs_fw_lower, mmask2, sidematedge,
					a/2, 0, mmask, sidematedge,
					-a/2, 0, -1, sidematedge

			gosub 600

		endif

		body -1

		addz framethick

	next ii

	del nn

	!! GLAZING !!

	pen gs_glass_pen
	sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_glass_pen_cont
	material gs_glass_mat

	if gs_grill_pos_m = MULLION_THROUGHOUT | lod3D = 5 then
		cutpolya 9, 2, 0,
			-a, gs_shoulder_h-(fce-fcefw), 13,
			 -a, gs_shoulder_h*2, 13,
			 a, gs_shoulder_h*2, 13,
			 a, gs_shoulder_h-(fce-fcefw), 13,
			 a/2-gs_fw_side, gs_shoulder_h-(fce-fcefw), 13,
			-1, tan(alphafw/2), 813,
			 0, b-gs_fw_side, 1013,
			-a/2+gs_fw_side, gs_shoulder_h-(fce-fcefw), 1013,
			-a, gs_shoulder_h-(fce-fcefw), -1

		glassPanelH = (b-gs_fw_side-gs_fw_lower+gs_grid_w)/(gs_hor_gnum+1)-gs_grid_w

		for j=1 to gs_hor_gnum+1
			for i=1 to gs_ver_gnum+1
				add -(a-2*gs_fw_side)/2+(hgnn+gs_grid_w)*(i-1), gs_fw_lower+(glassPanelH+gs_grid_w)*(j-1), gs_leaf_thk/2-gs_glass_thk/2
				prism_ 5, gs_glass_thk,
						0,		0,				15,
						hgnn,	0,				15,
						hgnn,	glassPanelH,	15,
						0,		glassPanelH,	15,
						0,		0,				-1
				del 1
			next i
		next j

		cutend
	else
		addz gs_leaf_thk/2-gs_glass_thk/2

		prism_ 7, gs_glass_thk,
			-a/2+gs_fw_side, gs_fw_lower, glas_mask5,
			 a/2-gs_fw_side, gs_fw_lower, glas_mask5,
			 a/2-gs_fw_side, gs_shoulder_h-(fce-fcefw), 79,
			-1, tan(alphafw/2), 800+glas_mask5,
			 0, b-gs_fw_side, 1079,
			-a/2+gs_fw_side, gs_shoulder_h-(fce-fcefw), 1079,
			-a/2+gs_fw_side, gs_fw_lower, -1

		del 1
	endif

	!! END OF GLAZING !!


	!! H-V STYLE GRID !!

	pen gs_leaf_pen
	sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_leaf_pen_cont
	material gs_grill_mat
	resol res

	cutpolya 9, 2, 0,
		-a, gs_shoulder_h-(fce-fcefw), 13,
		 -a, gs_shoulder_h*2, 13,
		 a, gs_shoulder_h*2, 13,
		 a, gs_shoulder_h-(fce-fcefw), 13,
		 a/2-gs_fw_side, gs_shoulder_h-(fce-fcefw), 13,
		-1, tan(alphafw/2), 813,
		 0, b-gs_fw_side, 1013,
		-a/2+gs_fw_side, gs_shoulder_h-(fce-fcefw), 1013,
		-a, gs_shoulder_h-(fce-fcefw), -1

	! VERTICAL GRIDS

	for i=1 to gs_ver_gnum
		addx (a-2*gs_fw_side+gs_grid_w)/(gs_ver_gnum+1)

		add  -a/2+gs_fw_side-gs_grid_w/2, 0, gz

		for ii=1 to mn

			gosub 910

			cprism_ multopmat, mulbotmat, mulsidemat,
				5, multhick,
				-gs_grid_w/2,  gs_fw_lower, mmask,
				 gs_grid_w/2,  gs_fw_lower, mmask,
				 gs_grid_w/2, b-gs_fw_side, mmask,
				-gs_grid_w/2, b-gs_fw_side, mmask,
				-gs_grid_w/2,  gs_fw_lower, -1

			addz multhick

		next ii

		del mn

		del 1

	next i
	del gs_ver_gnum

	!HORIZONTAL GRIDS

	for i=1 to gs_ver_gnum+1

		for j=1 to gs_hor_gnum
			addy (b-gs_fw_side-gs_fw_lower+gs_grid_w)/(gs_hor_gnum+1)

			add -(a-2*gs_fw_side)/2+hgnn/2, gs_fw_lower-gs_grid_w/2, gz

			for ii=1 to mn

				gosub 910

				cprism_ multopmat, mulbotmat, mulsidemat,
					5, multhick,
					-hgnn/2,-gs_grid_w/2,mmask,
					 hgnn/2,-gs_grid_w/2,mmask,
					 hgnn/2, gs_grid_w/2,mmask,
					-hgnn/2, gs_grid_w/2,mmask,
					-hgnn/2,-gs_grid_w/2,-1

				addz multhick

			next ii

			del mn

			del 1

		next j
		del gs_hor_gnum

		addx (a-2*gs_fw_side+gs_grid_w)/(gs_ver_gnum+1)
	next i
	del gs_ver_gnum+1

	cutend
endif


if iLeafShape = LEAF_SHAPE_HALFARCHED then
	for ii=1 to nn

		gosub 900

		if gs_SashText_typ_num = 1 then

			base

				sprism_{2} topmat, botmat, sidemat,
					5,
					0,  0,  1,  0,  framethick, 0,
					0,  0,  1, 0,   0,  0,
					a/2, 0, 10, sidematedge,
					a/2-gs_fw_side, gs_fw_lower, mmask, sidemat,
					a/2-gs_fw_side, b-(r2-sqr((r2-gs_fw_side)^2-gs_fw_side^2)), 10, sidemat,
					a/2, b, mmask, sidematedge,
					a/2, 0, -1, sidematedge

				sprism_{2} topmat, botmat, sidemat,
					5,
					0,  0,  1,  0,  framethick, 0,
					0,  0,  1, 0,   0,  0,
					-a/2, 0, 10, sidematedge,
					-a/2+gs_fw_side, gs_fw_lower, mmask, sidemat,
					-a/2+gs_fw_side, gs_shoulder_h-(fce-fcefw), 10, sidemat,
					-a/2,gs_shoulder_h,mmask, sidematedge,
					-a/2, 0, -1, sidematedge

				gosub 500

				sprism_{2} topmat, botmat, sidemat,
					5,
					0,  0,  1,  0,  framethick, 0,
					0,  0,  1, 0,   0,  0,
					a/2,0,10, sidematedge,
					a/2-gs_fw_side, gs_fw_lower, mmask, sidemat,
					-a/2+gs_fw_side, gs_fw_lower, 10, sidemat,
					-a/2,0,mmask, sidematedge,
					a/2,0,-1, sidematedge

				gosub 600

				sprism_{2} topmat, botmat, sidemat,
					7,
					0,  0,  1,  0,  framethick, 0,
					0,  0,  1, 0,   0,  0,
					a/2, b, 64+mmask, sidematedge,
					-1, 0, 800, sidematedge,
					-a/2,gs_shoulder_h, 1010-frm, sidematedge,
					-a/2+gs_fw_side, gs_shoulder_h-(fce-fcefw), 64+mmask, sidemat,
					1, tan(alphafw/2), 800, sidemat,
					a/2-gs_fw_side, b-(r2-sqr((r2-gs_fw_side)^2-gs_fw_side^2)), 1010-frm, sidemat,
					a/2, b, -1, sidematedge

			vert 0, 0, 0
			vert -1, 1, 0
			vert 1, 0, 0
			vert 0, 0, 1
			coor 2, -1, -2, -3, -4
			body 1

		endif

		if gs_SashText_typ_num = 2 then

			base

				sprism_{2} topmat, botmat, sidemat,
					5,
					0,  0,  1,  0,  framethick, 0,
					0,  0,  1, 0,   0,  0,
					a/2, gs_fw_lower, 8, sidematedge,
					a/2-gs_fw_side, gs_fw_lower, mmask, sidemat,
					a/2-gs_fw_side, b-(r2-sqr((r2-gs_fw_side)^2-gs_fw_side^2)), 10, sidemat,
					a/2, b-(r2-sqr((r2-gs_fw_side)^2-gs_fw_side^2)), mmask2, sidematedge,
					a/2, gs_fw_lower, -1, sidematedge

				sprism_{2} topmat, botmat, sidemat,
					5,
					0,  0,  1,  0,  framethick, 0,
					0,  0,  1, 0,   0,  0,
					-a/2, gs_fw_lower, 8, sidematedge,
					-a/2+gs_fw_side, gs_fw_lower, mmask, sidemat,
					-a/2+gs_fw_side, gs_shoulder_h-(fce-fcefw), 10, sidemat,
					-a/2, gs_shoulder_h-(fce-fcefw),mmask2, sidematedge,
					-a/2, gs_fw_lower, -1, sidematedge

				gosub 500

				sprism_{2} topmat, botmat, sidemat,
					7,
					0,  0,  1,  0,  framethick, 0,
					0,  0,  1, 0,   0,  0,
					a/2, 0, mmask, sidematedge,
					a/2, gs_fw_lower, 8, sidematedge,
					a/2-gs_fw_side, gs_fw_lower, mmask, sidemat,
					-a/2+gs_fw_side, gs_fw_lower, 10, sidemat,
					-a/2, gs_fw_lower, mmask2, sidematedge,
					-a/2, 0, mmask, sidematedge,
					a/2, 0, -1, sidematedge

				gosub 600

				sprism_{2} topmat, botmat, sidemat,
					10,
					0,  0,  1,  0,  framethick, 0,
					0,  0,  1, 0,   0,  0,
					a/2,b-(r2-sqr((r2-gs_fw_side)^2-gs_fw_side^2)),mmask2, sidematedge,
					a/2, b-0.00001, mmask, sidematedge,
					a/2, b, 64+mmask, sidematedge,
					-1, 0,      800, sidematedge,
					-a/2, gs_shoulder_h, 1000+mmask, sidematedge,
					-a/2, gs_shoulder_h-(fce-fcefw),8, sidemat,
					-a/2+gs_fw_side, gs_shoulder_h-(fce-fcefw), 64+mmask, sidemat,
					1, tan(alphafw/2), 800, sidemat,
					a/2-gs_fw_side, b-(r2-sqr((r2-gs_fw_side)^2-gs_fw_side^2)), 1010-frm, sidemat,
					a/2,b-(r2-sqr((r2-gs_fw_side)^2-gs_fw_side^2)),-1, sidematedge

			vert 0, 0, 0
			vert -1, 1, 0
			vert 1, 0, 0
			vert 0, 0, 1
			coor 2, -1, -2, -3, -4
			body 1

		endif

		body -1

		addz framethick

	next ii

	del nn


	!! GLAZING !!

	pen gs_glass_pen
	sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_glass_pen_cont
	material gs_glass_mat

	if gs_grill_pos_m = MULLION_THROUGHOUT | lod3D = 5 then
		cutpolya 6, 2, 0,
			a/2, b, 13,
			-a/2, b, 13,
			-a/2+gs_fw_side, gs_shoulder_h-(fce-fcefw), 13,
			1, tan(alphafw/2), 800,
			a/2-gs_fw_side, b-(r2-sqr((r2-gs_fw_side)^2-gs_fw_side^2)), 1013,
			a/2, b, -1

		glassPanelH = (b-gs_fw_side-gs_fw_lower+gs_grid_w)/(gs_hor_gnum+1)-gs_grid_w

		for j=1 to gs_hor_gnum+1
			for i=1 to gs_ver_gnum+1
				add -(a-2*gs_fw_side)/2+(hgnn+gs_grid_w)*(i-1), gs_fw_lower+(glassPanelH+gs_grid_w)*(j-1), gs_leaf_thk/2-gs_glass_thk/2
				prism_ 5, gs_glass_thk,
						0,		0,				15,
						hgnn,	0,				15,
						hgnn,	glassPanelH,	15,
						0,		glassPanelH,	15,
						0,		0,				-1
				del 1
			next i
		next j

		cutend
	else
		addz gs_leaf_thk/2-gs_glass_thk/2
			prism_ 6, gs_glass_thk,
				a/2-gs_fw_side, gs_fw_lower, glas_mask5,
				-a/2+gs_fw_side, gs_fw_lower, glas_mask5,
				-a/2+gs_fw_side, gs_shoulder_h-(fce-fcefw), 79,
				1, tan(alphafw/2), 800+glas_mask5,
				a/2-gs_fw_side, b-(r2-sqr((r2-gs_fw_side)^2-gs_fw_side^2)), 1079-frm,
				a/2-gs_fw_side, gs_fw_lower, -1
			body -1
		del 1
	endif

	!! H-V STYLE GRID !!

	pen gs_leaf_pen
	sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_leaf_pen_cont
	material gs_grill_mat
	resol res

	!! Model Solid


	! Cutplane for grids (at curve)

	alphah=alphafw/2-asn(gs_fw_side/(r2-gs_fw_side))
	beta=360/res
	nsr1 = max(round_int(alphah/beta), 1)
	beta1=alphah/nsr1
	devr1=(r2-gs_fw_side)-(r2-gs_fw_side)*cos(beta1/2)

	addx a/2
	mulx -1

	addy b-r2
	rotz (90-alphafw/2)+beta1/2
	for I=1 to nsr1
		addx r2-gs_fw_side-devr1
		cutplane 0,1,1,0
		del 1
		rotz beta1
	next I
	del nsr1+2


	for ii=1 to mn

		gosub 910

		!*********** VERTICAL GRIDS

		for i=1 to gs_ver_gnum

			addx (a-2*gs_fw_side+gs_grid_w)/(gs_ver_gnum+1)
			add gs_fw_side-gs_grid_w/2, 0, gz

			cprism_ multopmat, mulbotmat, mulsidemat,
				5, multhick,
				-gs_grid_w/2,  gs_fw_lower, mmask,
				 gs_grid_w/2,  gs_fw_lower, mmask,
				 gs_grid_w/2, b-gs_fw_side, mmask,
				-gs_grid_w/2, b-gs_fw_side, mmask,
				-gs_grid_w/2,  gs_fw_lower, -1

			del 1

		next i

		del gs_ver_gnum


		!*********** HORIZONTAL GRIDS

		for i=1 to gs_ver_gnum+1

			for j=1 to gs_hor_gnum
				addy (b-gs_fw_side-gs_fw_lower+gs_grid_w)/(gs_hor_gnum+1)
				add gs_fw_side+hgnn/2, gs_fw_lower-gs_grid_w/2, gz

				cprism_ multopmat, mulbotmat, mulsidemat,
					5, multhick,
					-hgnn/2,	-gs_grid_w/2,	mmask,
					hgnn/2,		-gs_grid_w/2,	mmask,
					hgnn/2,		gs_grid_w/2,	mmask,
					-hgnn/2,	gs_grid_w/2,	mmask,
					-hgnn/2,	-gs_grid_w/2,	-1

				del 1

			next j

			del gs_hor_gnum
			addx (a-2*gs_fw_side+gs_grid_w)/(gs_ver_gnum+1)

		next i

		del gs_ver_gnum+1

		addz multhick

	next ii

	del mn


	for I=1 to nsr1 step 1
		cutend
	next i

	del 2

	del 2
endif


RETURN


48:

!******************** CASEMENT_D !!!!

!********************************* Prairie

material gs_leaf_mat

for ii=1 to nn

	gosub 900

	if gs_SashText_typ_num = 1 then

		base

		sprism_{2} topmat, botmat, sidemat,
			5,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			-a/2,0,10, sidematedge,
			-a/2+gs_fw_side,   gs_fw_lower, 15, sidemat,
			-a/2+gs_fw_side,b-gs_fw_upper,10, sidemat,
			-a/2,B,mmask, sidematedge,
			-a/2,0,-1, sidematedge

		sprism_{2} topmat, botmat, sidemat,
			5,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			a/2,0,10, sidematedge,
			a/2-gs_fw_side,   gs_fw_lower, 15, sidemat,
			a/2-gs_fw_side,b-gs_fw_upper,10, sidemat,
			a/2,B,mmask, sidematedge,
			a/2,0,-1, sidematedge

		gosub 500

		sprism_{2} topmat, botmat, sidemat,
			5,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			-a/2,0,10, sidematedge,
			-a/2+gs_fw_side,gs_fw_lower,15, sidemat,
			a/2-gs_fw_side,gs_fw_lower,10, sidemat,
			a/2,0,mmask, sidematedge,
			-a/2,0,-1, sidematedge

		sprism_{2} topmat, botmat, sidemat,
			5,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			-a/2,B,10, sidematedge,
			-a/2+gs_fw_side,B-gs_fw_upper,15, sidemat,
			a/2-gs_fw_side,B-gs_fw_upper,10, sidemat,
			a/2,B,mmask, sidematedge,
			-a/2,B,-1, sidematedge

		gosub 600

	endif

	if gs_SashText_typ_num = 2 then

		base

		if B > gs_fw_lower + gs_fw_upper then
			sprism_{2} topmat, botmat, sidemat,
				5,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				-a/2,gs_fw_lower,8, sidematedge,
				-a/2+gs_fw_side,   gs_fw_lower, 15, sidemat,
				-a/2+gs_fw_side,B-gs_fw_upper,10, sidemat,
				-a/2,B-gs_fw_upper,mmask2, sidematedge,
				-a/2,gs_fw_lower,-1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				5,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				a/2,gs_fw_lower,8, sidematedge,
				a/2-gs_fw_side,   gs_fw_lower, 15, sidemat,
				a/2-gs_fw_side,B-gs_fw_upper,10, sidemat,
				a/2,B-gs_fw_upper,mmask2, sidematedge,
				a/2,gs_fw_lower,-1, sidematedge
		endif

		gosub 500

		sprism_{2} topmat, botmat, sidemat,
			7,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			-a/2,0,mmask, sidematedge,
			-a/2,gs_fw_lower,8, sidematedge,
			-a/2+gs_fw_side,gs_fw_lower,15, sidemat,
			a/2-gs_fw_side,gs_fw_lower,10, sidemat,
			a/2,gs_fw_lower,mmask2, sidematedge,
			a/2,0,mmask, sidematedge,
			-a/2,0,-1, sidematedge

		sprism_{2} topmat, botmat, sidemat,
			7,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			-a/2,B,mmask, sidematedge,
			-a/2,B-gs_fw_upper,8, sidematedge,
			-a/2+gs_fw_side,B-gs_fw_upper,15, sidemat,
			a/2-gs_fw_side,B-gs_fw_upper,10, sidemat,
			a/2,B-gs_fw_upper,mmask2, sidematedge,
			a/2,B,mmask, sidematedge,
			-a/2,B,-1, sidematedge

		gosub 600

	endif

	addz framethick

next ii

del nn


body -1


group "glazing 48"

	!************GLAZING

	pen gs_glass_pen
	sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_glass_pen_cont
	material gs_glass_mat

	addz gs_leaf_thk/2-gs_glass_thk/2

	if (B > gs_fw_lower + gs_fw_upper) & (A > 2 * gs_fw_side) then
		prism_ 5, gs_glass_thk,
			-a/2+gs_fw_side,   gs_fw_lower, glas_mask5,
			 a/2-gs_fw_side,   gs_fw_lower, glas_mask5,
			 a/2-gs_fw_side, b-gs_fw_upper, glas_mask5,
			-a/2+gs_fw_side, b-gs_fw_upper, glas_mask5,
			-a/2+gs_fw_side,   gs_fw_lower, -1
	endif

	del 1

endgroup


group "grids 48"
	if lod3D = 5 then
		addz -multhick/2
		multhick = multhick * 2
	endif

	!! GRIDS !!

	pen gs_leaf_pen
	sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_leaf_pen_cont
	material gs_grill_mat


	!*** PRAIRIE STYLE !!

	sx=-a/2+gs_fw_side
	sx2=-sx
	sy=gs_fw_lower
	dy3=(b-gs_fw_lower-gs_fw_upper-6"-3*gs_grid_w)/5
	sx3=a-2*(gs_fw_side)
	pw=gs_grid_w

	addz gz

	for ii=1 to mn

		gosub 910

		cprism_ multopmat, mulbotmat, mulsidemat,
			75, multhick,
			sx,   gs_fw_lower, 15,
			sx2,   gs_fw_lower, 15,
			sx2, b-gs_fw_upper, 15,
			sx, b-gs_fw_upper, 15,
			sx,   gs_fw_lower, -1,

			sx+pw, gs_fw_lower+pw, 15,
			sx+pw+3", gs_fw_lower+pw, 15,
			sx+pw+3", gs_fw_lower+pw+3", 15,
			sx+pw, gs_fw_lower+pw+3", 15,
			sx+pw, gs_fw_lower+pw, -1,

			sx2-pw,sy+pw,15,
			sx2-pw-3",sy+pw,15,
			sx2-pw-3",sy+pw+3",15,
			sx2-pw,sy+pw+3",15,
			sx2-pw,sy+pw,-1,

			sx+pw, b-gs_fw_upper-pw, 15,
			sx+pw+3", b-gs_fw_upper-pw, 15,
			sx+pw+3", b-gs_fw_upper-pw-3", 15,
			sx+pw, b-gs_fw_upper-pw-3", 15,
			sx+pw, b-gs_fw_upper-pw, -1,

			sx2-pw, b-gs_fw_upper-pw, 15,
			sx2-pw-3", b-gs_fw_upper-pw, 15,
			sx2-pw-3", b-gs_fw_upper-pw-3", 15,
			sx2-pw, b-gs_fw_upper-pw-3", 15,
			sx2-pw, b-gs_fw_upper-pw, -1,

			sx+2*pw+3", b-gs_fw_upper-pw, 15,
			sx2-2*pw-3", b-gs_fw_upper-pw, 15,
			sx2-2*pw-3", b-gs_fw_upper-pw-3", 15,
			sx+2*pw+3", b-gs_fw_upper-pw-3", 15,
			sx+2*pw+3", b-gs_fw_upper-pw, -1,

			sx+2*pw+3", sy+pw, 15,
			sx2-2*pw-3", sy+pw, 15,
			sx2-2*pw-3", sy+pw+3", 15,
			sx+2*pw+3", sy+pw+3", 15,
			sx+2*pw+3", sy+pw, -1,

			sx+pw, sy+2*pw+3", 15,
			sx+pw+3", sy+2*pw+3", 15,
			sx+pw+3", b-gs_fw_upper-2*pw-3", 15,
			sx+pw, b-gs_fw_upper-2*pw-3", 15,
			sx+pw, sy+2*pw+3", -1,

			sx2-pw, sy+2*pw+3", 15,
			sx2-pw-3", sy+2*pw+3", 15,
			sx2-pw-3", b-gs_fw_upper-2*pw-3", 15,
			sx2-pw, b-gs_fw_upper-2*pw-3", 15,
			sx2-pw, sy+2*pw+3", -1,

			sx+2*pw+3", sy+2*pw+3", 15,
			sx+2*pw+3", sy+2*pw+3"+3*dy3-pw, 15,
			sx+sx3/2-pw/2, sy+2*pw+3"+3*dy3-pw, 15,
			sx+sx3/2-pw/2, sy+2*pw+3", 15,
			sx+2*pw+3", sy+2*pw+3", -1,

			sx2-2*pw-3",sy+2*pw+3",15,
			sx2-2*pw-3",sy+2*pw+3"+3*dy3-pw,15,
			sx+sx3/2+pw/2,sy+2*pw+3"+3*dy3-pw,15,
			sx+sx3/2+pw/2,sy+2*pw+3",15,
			sx2-2*pw-3",sy+2*pw+3",-1,

			sx+2*pw+3",sy+2*pw+3"+4*dy3-pw,15,
			sx+2*pw+3",sy+2*pw+3"+3*dy3,15,
			sx+sx3/2-pw/2,sy+2*pw+3"+3*dy3,15,
			sx+sx3/2-pw/2,sy+2*pw+3"+4*dy3-pw,15,
			sx+2*pw+3",sy+2*pw+3"+4*dy3-pw,-1,

			sx2-2*pw-3",sy+2*pw+3"+4*dy3-pw,15,
			sx2-2*pw-3",sy+2*pw+3"+3*dy3,15,
			sx+sx3/2+pw/2,sy+2*pw+3"+3*dy3,15,
			sx+sx3/2+pw/2,sy+2*pw+3"+4*dy3-pw,15,
			sx2-2*pw-3",sy+2*pw+3"+4*dy3-pw,-1,

			sx+2*pw+3",sy+2*pw+3"+5*dy3-pw,15,
			sx+2*pw+3",sy+2*pw+3"+4*dy3,15,
			sx+sx3/2-pw/2,sy+2*pw+3"+4*dy3,15,
			sx+sx3/2-pw/2,sy+2*pw+3"+5*dy3-pw,15,
			sx+2*pw+3",sy+2*pw+3"+5*dy3-pw,-1,

			sx2-2*pw-3",sy+2*pw+3"+5*dy3-pw,15,
			sx2-2*pw-3",sy+2*pw+3"+4*dy3,15,
			sx+sx3/2+pw/2,sy+2*pw+3"+4*dy3,15,
			sx+sx3/2+pw/2,sy+2*pw+3"+5*dy3-pw,15,
			sx2-2*pw-3",sy+2*pw+3"+5*dy3-pw,-1

		addz multhick

	next ii

	del mn

	del 1

	if lod3D = 5 then del 1
endgroup

if lod3D = 5 then
	mulz 0.5
	addz multhick/4
	placegroup "grids 48"
	del 2
	result_48 = subgroup("glazing 48", "grids 48")
	placegroup result_48
	killgroup result_48
else
	placegroup "glazing 48"
	placegroup "grids 48"
endif
killgroup "glazing 48"
killgroup "grids 48"

RETURN



! ************************************************************
!  Custom Panel
! ************************************************************

49:

!******************************* Custom panel

aaa=a
bbb=b

if gs_cust_panel<>"" then


	if iLeafShape = LEAF_SHAPE_ARCHED then
		cutpolya	8, 1, 0,
			 A/2 + 1,gs_shoulder_h, 31,
			 A/2,	gs_shoulder_h, 95,
			-1, 	tan(alphace/2), 895,
			 0,		b, 1095,
			-A/2,	gs_shoulder_h, 1095,
			-A/2 - 1,gs_shoulder_h,31,
			-A/2 - 1,			B + 1,	31,
			 A/2 + 1,			B + 1,	31
	endif

	if iLeafShape = LEAF_SHAPE_HALFARCHED then
		cutpolya	7, 1, 0,
			A/2 + 1,b, 31,
			A/2,	b, 95,
			-1,		0, 895,
			-A/2,	gs_shoulder_h, 1095,
			-A/2 - 1,gs_shoulder_h, 31,
			-A/2 - 1,			B + 1,	31,
			 A/2 + 1,			B + 1,	31
	endif


	addx -aaa/2
	call "Door_Panel_Collection" parameters a=aaa, b=bbb, zzyzx=gs_leaf_thk,
			gs_ptype=gs_cust_panel
	del 1

	if iLeafShape = LEAF_SHAPE_ARCHED | iLeafShape = LEAF_SHAPE_HALFARCHED then
		cutend
	endif

endif

return






1100:


for ii=1 to nn

	gosub 900

	if gs_SashText_typ_num = 1 then

		base

		sprism_{2} topmat, botmat, sidemat,
			7,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0, 0, 10, sidematedge,
			0.08, 0.15, mmask, sidemat,
			0.08, 0.73, 10, sidemat,
			0.08, 0.88, mmask, sidemat,
			0.08, b-0.22, 10, sidemat,
			0, b-0.11, mmask, sidematedge,
			0, 0, -1, sidematedge

		sprism_{2} topmat, botmat, sidemat,
			7,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			A-0.138, 0, 10, sidematedge,
			A-0.218, 0.15, mmask, sidemat,
			A-0.218, 0.73, 10, sidemat,
			A-0.218, 0.88, mmask, sidemat,
			A-0.218, b-0.22, 10, sidemat,
			A-0.138, b-0.11, mmask, sidematedge,
			A-0.138, 0, -1, sidematedge

		cprism_ topmat, botmat, sidemat,
			9, framethick,
			(A-0.138)/2-0.04, 0.15, 10,
			(A-0.138)/2+0.04, 0.15, mmask,
			(A-0.138)/2+0.04, 0.73, 10,
			(A-0.138)/2+0.04, 0.88, mmask,
			(A-0.138)/2+0.04, b-0.22, 10,
			(A-0.138)/2-0.04, b-0.22, mmask,
			(A-0.138)/2-0.04, 0.88, 10,
			(A-0.138)/2-0.04, 0.73, mmask,
			(A-0.138)/2-0.04, 0.15, -1

		gosub 500

		base


		sprism_{2} topmat, botmat, sidemat,
			7,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0, 0, 10, sidematedge,
			0.08, 0.15, mmask, sidemat,
			(A-0.138)/2-0.04, 0.15, 10, sidemat,
			(A-0.138)/2+0.04, 0.15, mmask, sidemat,
			A-0.218, 0.15, 10, sidemat,
			A-0.138, 0, mmask, sidematedge,
			0, 0, -1, sidematedge

		sprism_{2} topmat, botmat, sidemat,
			7,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0, b-0.11, 10, sidematedge,
			0.08, b-0.22, mmask, sidemat,
			(A-0.138)/2-0.04, b-0.22, 10, sidemat,
			(A-0.138)/2+0.04, b-0.22, mmask, sidemat,
			A-0.218, b-0.22, 10, sidemat,
			A-0.138, b-0.11, mmask, sidematedge,
			0, b-0.11, -1, sidematedge

		cprism_ topmat, botmat, sidemat,
			5, framethick,
			0.08, 0.73, 10,
			0.08, 0.88, mmask,
			(A-0.138)/2-0.04, 0.88, 10,
			(A-0.138)/2-0.04, 0.73, mmask,
			0.08, 0.73, -1

		cprism_ topmat, botmat, sidemat,
			5, framethick,
			(A-0.138)/2+0.04, 0.73, 10,
			(A-0.138)/2+0.04, 0.88, mmask,
			A-0.218, 0.88, 10,
			A-0.218, 0.73, mmask,
			(A-0.138)/2+0.04, 0.73, -1

		gosub 600

	endif

	if gs_SashText_typ_num = 2 then

		base

		sprism_{2} topmat, botmat, sidemat,
			7,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0, 0.15, 8, sidematedge,
			0.08, 0.15, mmask, sidemat,
			0.08, 0.73, 10, sidemat,
			0.08, 0.88, mmask, sidemat,
			0.08, b-0.22, 10, sidemat,
			0, b-0.22, mmask2, sidematedge,
			0, 0.15, -1, sidematedge

		sprism_{2} topmat, botmat, sidemat,
			7,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			A-0.138, 0.15, 8, sidematedge,
			A-0.218, 0.15, mmask, sidemat,
			A-0.218, 0.73, 10, sidemat,
			A-0.218, 0.88, mmask, sidemat,
			A-0.218, b-0.22, 10, sidemat,
			A-0.138, b-0.22, mmask2, sidematedge,
			A-0.138, 0.15, -1, sidematedge

		cprism_ topmat, botmat, sidemat,
			8, framethick,
			(A-0.138)/2-0.04, 0.15, 8,
			(A-0.138)/2+0.04, 0.15, mmask,
			(A-0.138)/2+0.04, 0.73, 10,
			(A-0.138)/2+0.04, 0.88, mmask,
			(A-0.138)/2+0.04, b-0.22, 10,
			(A-0.138)/2-0.04, b-0.22, mmask2,
			(A-0.138)/2-0.04, 0.88, 10,
			(A-0.138)/2-0.04, 0.73, mmask

		gosub 500

		sprism_{2} topmat, botmat, sidemat,
			9,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0, 0, mmask, sidematedge,
			0, 0.15, 8, sidematedge,
			0.08, 0.15, mmask, sidemat,
			(A-0.138)/2-0.04, 0.15, 10, sidemat,
			(A-0.138)/2+0.04, 0.15, mmask, sidemat,
			A-0.218, 0.15, 10, sidemat,
			A-0.138, 0.15, mmask2, sidematedge,
			A-0.138, 0, mmask, sidematedge,
			0, 0, -1, sidematedge

		sprism_{2} topmat, botmat, sidemat,
			9,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0, b-0.11, mmask, sidematedge,
			0, b-0.22, 8, sidemat,
			0.08, b-0.22, mmask, sidemat,
			(A-0.138)/2-0.04, b-0.22, 10, sidemat,
			(A-0.138)/2+0.04, b-0.22, mmask, sidemat,
			A-0.218, b-0.22, 10, sidemat,
			A-0.138, b-0.22, mmask2, sidematedge,
			A-0.138, b-0.11, mmask, sidematedge,
			0, b-0.11, -1, sidematedge

		cprism_ topmat, botmat, sidemat,
			5, framethick,
			0.08, 0.73, mmask,
			(A-0.138)/2-0.04, 0.73, 10,
			(A-0.138)/2-0.04, 0.88, mmask,
			0.08,0.88, 10,
			0.08, 0.73, -1

		cprism_ topmat, botmat, sidemat,
			5, framethick,
			A-0.218, 0.73, mmask,
			(A-0.138)/2+0.04, 0.73, 10,
			(A-0.138)/2+0.04, 0.88, mmask,
			A-0.218, 0.88, 10,
			A-0.218, 0.73, -1

		gosub 600

	endif

	addz framethick

next ii

del nn

RETURN


51:				! NLD 01
	if lod3D = 5 then
		thk		= gs_frame_thk
		thk2	= gs_frame_thk
		thk3	= gs_frame_thk
		modZ	= 0
		modZ2	= 0
	else
		thk		= gs_leaf_thk
		thk2	= gs_leaf_thk / 2
		thk3	= 0.005
		modZ	= gs_leaf_thk / 4
		modZ2	= gs_leaf_thk / 2-thk3/2
	endif

	addx -a/2

	material gs_leaf_mat
	EXTRUDE 5+5+5, 0, 0, thk, 1+2+4+16+32,
			0,      0,      0,
			0,      b,      0,
			a,      b,      0,
			a,      0,      0,
			0,      0,      -1,

			3*a/4,	b-1,	0,
			3*a/4,	b-0.2,	0,
			a/4,	B-0.2,	0,
			a/4,	B-1,	0,
			3*a/4,	b-1,	-1,

			3*a/4,	b-1.6,	0,
			3*a/4,	b-1.2,	0,
			a/4,	B-1.2,	0,
			a/4,	B-1.6,	0,
			3*a/4,	b-1.6,	-1
	BODY -1

	addz modZ

	prism_ 10,thk2,
			3*a/4,	b-1.6,	15,
			3*a/4,	b-1.2,	15,
			a/4,	B-1.2,	15,
			a/4,	B-1.6,	15,
			3*a/4,	b-1.6,	-1,

			3*a/4-0.025,	b-1.6+0.025,	15,
			3*a/4-0.025,	b-1.2-0.025,	15,
			a/4+0.025,		b-1.2-0.025,	15,
			a/4+0.025,		b-1.6+0.025,	15,
			3*a/4-0.025,	b-1.6+0.025,	-1

	BODY 1

	del 1
	if gs_leaf_mat<1 then 11

	addz modZ
	prism_ 10,thk2,
			3*a/4,	b-1,	15,
			3*a/4,	b-0.2,	15,
			a/4,	B-0.2,	15,
			a/4,	B-1,	15,
			3*a/4,	b-1,	-1,

			3*a/4-0.025,	b-1+0.025,	15,
			3*a/4-0.025,	b-0.2-0.025,	15,
			a/4+0.025,		b-0.2-0.025,	15,
			a/4+0.025,		b-1+0.025,	15,
			3*a/4-0.025,	b-1+0.025,	-1

	BODY 1
	del 1

	material gs_glass_mat
	addz modZ2
	prism_ 5, thk3,
			3*a/4-0.025,	b-1+0.025,	15,
			3*a/4-0.025,	b-0.2-0.025,	15,
			a/4+0.025,		b-0.2-0.025,	15,
			a/4+0.025,		b-1+0.025,	15,
			3*a/4-0.025,	b-1+0.025,	-1

	prism_ 5, thk3,
			3*a/4-0.025,	b-1.6+0.025,	15,
			3*a/4-0.025,	b-1.2-0.025,	15,
			a/4+0.025,		b-1.2-0.025,	15,
			a/4+0.025,		b-1.6+0.025,	15,
			3*a/4-0.025,	b-1.6+0.025,	-1
	del 2
return


52:				! NLD 02
	if lod3D = 5 then
		thk		= gs_frame_thk
		thk2	= gs_frame_thk
		modZ	= 0
	else
		thk		= gs_leaf_thk
		thk2	= 0.02
		modZ	= gs_leaf_thk / 2 - 0.01
	endif

	material gs_leaf_mat
	ADDZ thk
	mulz -1
	addx -A/2

	for loopi = 1 to 2
		prism_ 5, thk,
			0,		0, 			15,
			A/6,	0,			15,
			A/6,	B,			15,
			0,		B,			15,
			0,		0,			-1
		addx A
		mulx -1
	next loopi
	del 4
	BODY -1

	prism_ 5, thk,
		A/6,	0,		15,
		A-A/6,	0,		15,
		A-A/6,	B/8,	15,
		A/6,	B/8,	15,
		A/6,	0,		-1

	BODY -1

	addy B - B/16
	for loopi = 1 to 3
		prism_ 5, thk,
			A/6,	0,		15,
			A-A/6,	0,		15,
			A-A/6,	B/16,	15,
			A/6,	B/16,	15,
			A/6,	0,		-1

		addy -B/3.5
		BODY -1
	next loopi
	del 3+1

	addz modZ
	material gs_glass_mat
	glassHeight = B/3.5 - B/16
	addy B - B/16
	for loopi = 1 to 3
		if loopi = 3 then glassHeight = B - 2* B/3.5 - 3* B/16
		prism_ 5, thk2,
			A/6,	0,		15,
			A-A/6,	0,		15,
			A-A/6,	-glassHeight,	15,
			A/6,	-glassHeight,	15,
			A/6,	0,		-1

		addy -B/3.5
	next loopi
	del 3+2
	BODY -1

	del 3
return


53:				! NLD 03
	if lod3D = 5 then
		thk		= gs_frame_thk
		thk2	= gs_frame_thk
		modZ	= 0
	else
		thk		= gs_leaf_thk
		thk2	= 0.02
		modZ	= gs_leaf_thk / 2 - 0.01
	endif

	MULX	A/    0.83
	MULY	B/    2.115
	ADDX   -7.402386
	ADDY   23.4355

	material gs_leaf_mat

	PRISM_ 5, thk,
				6.987386,     -23.4355,     15,
				7.127386,     -23.4355,     15,
				7.127386,     -21.3205,     15,
				6.987386,     -21.3205,     15,
				6.987386,     -23.4355,     -1
	BODY -1

	PRISM_ 5, thk,
				7.677386,     -23.4355,     15,
				7.817386,     -23.4355,     15,
				7.817386,     -21.3205,     15,
				7.677386,     -21.3205,     15,
				7.677386,     -23.4355,     -1
	BODY -1

	PRISM_ 5, thk,
				7.127386,     -21.4605,     15,
				7.677386,     -21.4605,     15,
				7.677386,     -21.3205,     15,
				7.127386,     -21.3205,     15,
				7.127386,     -21.4605,     -1
	BODY -1

	PRISM_ 5, thk,
				7.677386,     -23.2529,     15,
				7.677386,     -23.4355,     15,
				7.127386,     -23.4355,     15,
				7.127386,     -23.2529,     15,
				7.677386,     -23.2529,     -1
	BODY -1

	PRISM_ 5, thk2,
				7.127386,     -23.2529,     15,
				7.127386,     -23.2478,     15,
				7.677386,     -23.2478,     15,
				7.677386,     -23.2529,     15,
				7.127386,     -23.2529,     -1
	BODY -1

	PRISM_ 5, thk,
				7.677386,     -23.1137,     15,
				7.677386,     -23.2478,     15,
				7.127386,     -23.2478,     15,
				7.127386,     -23.1137,     15,
				7.677386,     -23.1137,     -1
	BODY -1

	PRISM_ 5, thk,
				7.677386,     -22.8095,     15,
				7.127386,     -22.8095,     15,
				7.127386,     -22.6695,     15,
				7.677386,     -22.6695,     15,
				7.677386,     -22.8095,     -1
	BODY -1

	PRISM_ 5, thk,
				7.677386,     -21.889,     15,
				7.127386,     -21.889,     15,
				7.127386,     -21.749,     15,
				7.677386,     -21.749,     15,
				7.677386,     -21.889,     -1
	BODY -1

	PRISM_ 5, thk,
				7.677386,     -22.3493,     15,
				7.127386,     -22.3493,     15,
				7.127386,     -22.2093,     15,
				7.677386,     -22.2093,     15,
				7.677386,     -22.3493,     -1
	BODY -1

	ADDZ  modZ

	cPRISM_ gs_glass_mat,gs_glass_mat,gs_glass_mat,
				 5,     thk2,
				7.677386,     -21.749,     15,
				7.127386,     -21.749,     15,
				7.127386,     -21.4605,     15,
				7.677386,     -21.4605,     15,
				7.677386,     -21.749,     -1
	BODY -1

	cPRISM_ gs_glass_mat,gs_glass_mat,gs_glass_mat,
				5,     thk2,
				7.677386,     -22.2093,     15,
				7.127386,     -22.2093,     15,
				7.127386,     -21.889,     15,
				7.677386,     -21.889,     15,
				7.677386,     -22.2093,     -1
	BODY -1

	cPRISM_ gs_glass_mat,gs_glass_mat,gs_glass_mat,
				5,     thk2,
				7.677386,     -22.6695,     15,
				7.127386,     -22.6695,     15,
				7.127386,     -22.3493,     15,
				7.677386,     -22.3493,     15,
				7.677386,     -22.6695,     -1
	BODY -1

	cPRISM_ gs_glass_mat,gs_glass_mat,gs_glass_mat,
				5,     thk2,
				7.677386,     -23.1137,     15,
				7.127386,     -23.1137,     15,
				7.127386,     -22.8095,     15,
				7.677386,     -22.8095,     15,
				7.677386,     -23.1137,     -1
	BODY -1
	DEL 5
return


54:				! NLD 04
	if lod3D = 5 then
		thk		= gs_frame_thk
		thk2	= gs_frame_thk
		thk3	= gs_frame_thk
		modZ	= 0
		modZ2	= 0
	else
		thk		= gs_leaf_thk
		thk2	= gs_leaf_thk / 2
		thk3	= 0.005
		modZ	= gs_leaf_thk / 2
		modZ2	= gs_leaf_thk / 4
	endif

	addx -a/2
	material gs_leaf_mat

	if A < B then
		__R = a/2 - gs_fw_side
	else
		__R = B/2 - gs_fw_side
	endif

	__RInner = __R - 0.025

	prism_ 12, thk,
		0,	0,	15,
		A,	0,	15,
		A,	B,	15,
		0,	B,	15,
		0,	0,	-1,

		A/2 - __R,	__R + gs_fw_lower, 15+64,
		A/2,		__R + gs_fw_lower, 900,
		0, 180, 4015+64,

		A/2 + __R,	B - __R - gs_fw_upper, 15+64,
		A/2,		B - __R - gs_fw_upper, 900,
		0, 180, 4015+64,
		A/2 - __R,	__R + gs_fw_lower, -1

	addz modZ2
	prism_ 14, thk2,
		A/2 - __R,	__R + gs_fw_lower, 15+64,
		A/2,		__R + gs_fw_lower, 900,
		0, 180, 4015+64,
		A/2 + __R,	B - __R - gs_fw_upper, 15+64,
		A/2,		B - __R - gs_fw_upper, 900,
		0, 180, 4015+64,
		A/2 - __R,	__R + gs_fw_lower, -1,


		A/2 - __RInner,	__R + gs_fw_lower, 15+64,
		A/2,			__R + gs_fw_lower, 900,
		0, 180, 4015+64,

		A/2 + __RInner,	B - __R - gs_fw_upper, 15+64,
		A/2,			B - __R - gs_fw_upper, 900,
		0, 180, 4015+64,
		A/2 - __RInner,	__RInner + gs_fw_lower, -1
	del 1

	BODY -1
	addz modZ
	material gs_glass_mat

	prism_ 7, thk3,
		A/2 - __RInner,	__R + gs_fw_lower, 15+64,
		A/2,			__R + gs_fw_lower, 900,
		0, 180, 4015+64,

		A/2 + __RInner,	B - __R - gs_fw_upper, 15+64,
		A/2,			B - __R - gs_fw_upper, 900,
		0, 180, 4015+64,
		A/2 - __RInner,	__RInner + gs_fw_lower, -1

	BODY -1
	del 2
return

55:				! NLD 05
	if lod3D = 5 then
		thk		= gs_frame_thk
		thk2	= gs_frame_thk
		thk3	= gs_frame_thk
		modZ	= 0
		modZ2	= 0
	else
		thk		= gs_leaf_thk
		thk2	= 0.025
		thk3	= 0.005
		modZ	= gs_leaf_thk / 2
		modZ2	= gs_leaf_thk / 4
	endif

	addx a/2
	mulx -1

	resol 4*res
	material gs_leaf_mat

	if a >= 0.9 then
		Rx = 0
	else
		Rx = -(0.6^2-(2*a/3)^2)/(2*(2*a/3))
	endif

	prism_	9, thk,
			0,      0,      15,
			0,      b,      15,
			a,      b,      15,
			a,      0,      15,
			0,      0,      -1,

			Rx,		b-0.8,		900,
			0.14, 	b-0.2,		615+64,
			0.14,	b-1.4,		3015+64,
			0.14, 	b-0.2,		715+64

	addz modZ2
	prism_	8, thk2,
			Rx,		b-0.8,		900,
			0.14, 	b-0.2,		615+64,
			0.14, 	b-1.4,		3015+64,
			0.14, 	b-0.2,		715+64,

			Rx, 	b-0.8,		900,
			0.165,	b-0.245,	615+64,
			0.165,	b-1.355,	3015+64,
			0.165,	b-0.2,		715+64
	del 1

	BODY -1
	addz modZ
	material gs_glass_mat

	prism_	4, thk3,
			Rx, 	b-0.8,		900,
			0.165,	b-0.245,	615+64,
			0.165,	b-1.355,	3015+64,
			0.165,	b-0.2,		715+64

	BODY -1
	del 3
	resol res
return


56:				! NLD 06
	if lod3D = 5 then
		thk		= gs_frame_thk
		thk2	= gs_frame_thk
		thk3	= gs_frame_thk
		thk4	= gs_frame_thk
		modZ	= 0
		modZ2	= 0
		modZ3	= 0
	else
		thk		= gs_leaf_thk
		thk2	= gs_leaf_thk + 0.01
		thk3	= 0.02
		thk4	= 0.007
		modZ	= -0.005
		modZ2	= gs_leaf_thk/2 - 0.01
		modZ3	= gs_leaf_thk/2 - 0.007/2
	endif

	R=((gs_leaf_thk+0.01)*(gs_leaf_thk+0.01)+(a/2-0.12)*(a/2-0.12))/0.11

	resol 4*res
	material gs_leaf_mat

	prism_   16, thk,
		-a/2, 0, 15,
		 a/2, 0, 15,
		 a/2, b, 15,
		-a/2, b, 15,
		-a/2, 0, -1,

		-a/2+0.12, 0.16, 15,
		 a/2-0.12, 0.16, 15,
		 a/2-0.12, 0.665, 15,
		-a/2+0.12, 0.665, 15,
		-a/2+0.12, 0.16, -1,


		-a/2+0.12, 0.785, 15,
		 a/2-0.12, 0.785, 15,
		 a/2-0.12, b-0.175, 79,
		 0, b-0.12-R, 900,
		 -a/2+0.12, b-0.175, 3015,
		 -a/2+0.12, 0.785, -1

	addz modZ

	prism_ 10, thk2,
		-a/2+0.12, 0.16, 15,
		 a/2-0.12, 0.16, 15,
		 a/2-0.12, 0.665, 15,
		-a/2+0.12, 0.665, 15,
		-a/2+0.12, 0.16, -1,

		-a/2+0.135, 0.175, 15,
		 a/2-0.135, 0.175, 15,
		 a/2-0.135, 0.65, 15,
		-a/2+0.135, 0.65, 15,
		-a/2+0.135, 0.175, -1


	R1=R-0.015
	R2=R1-0.007

	prism_ 12, thk2,
		-a/2+0.12, 0.785, 15,
		 a/2-0.12, 0.785, 15,
		 a/2-0.12, b-0.175, 79,
		 0, b-0.12-R, 900,
		 -a/2+0.12, b-0.175, 3015,
		 -a/2+0.12, 0.785, -1,

		-a/2+0.135, 0.8, 15,
		 a/2-0.135, 0.8, 15,
		 a/2-0.135, b-0.12-R+(R1*cos(ASN((a/2-0.135)/R1))), 79,
		 0, b-0.12-R, 900,
		-a/2+0.135,b-0.12-R+(R1*cos(ASN((a/2-0.135)/R1))), 3015,
		-a/2+0.135, 0.8, -1

	del 1
	addz modZ2

	BODY -1

	 prism_ 10, thk3,
		-a/2+0.135, 0.175, 15,
		 a/2-0.135, 0.175, 15,
		 a/2-0.135, 0.65, 15,
		-a/2+0.135, 0.65, 15,
		-a/2+0.135, 0.175, -1,


		-a/2+0.17, 0.21, 15,
		 a/2-0.17, 0.21, 15,
		 a/2-0.17, 0.615, 15,
		-a/2+0.17, 0.615, 15,
		-a/2+0.17, 0.21, -1
	del 1

	prism_   4, thk,
		-a/2+0.17, 0.21, 15,
		 a/2-0.17, 0.21, 15,
		 a/2-0.17, 0.615, 15,
		-a/2+0.17, 0.615, 15

	addz modZ3

	kx = -a/2+0.12+0.015+0.007
	ky = 0.785+0.015+0.007

	dx = (a-0.135*2-0.007*4) / 3
	dy = (b-0.12-R+(R2*cos(ASN((a/2-0.142)/R2)))-0.807-0.007*3)/4

	for iy = 1 to 3 step 1

		for ix = 1 to 3 step 1
			put kx, ky, 15,
				kx+dx, ky, 15,
				kx+dx, ky+dy, 15,
				kx, ky+dy, 15,
				kx, ky, -1
			kx = kx+dx+0.007
		next ix

		kx = -a/2+0.12+0.015+0.007
		ky = ky+dy+0.007

	next iy

	material gs_leaf_mat

	prism_ 24+nsp/3, thk4,
		-a/2+0.135,		0.8,										15,
		 a/2-0.135,		0.8,										15,
		 a/2-0.135,		b-0.12-R+(R1*cos(ASN((a/2-0.135)/R1))),		79,
		 0,				b-0.12-R,									900,
		-a/2+0.135,		b-0.12-R+(R1*cos(ASN((a/2-0.135)/R1))),		3015,
		-a/2+0.135,		0.8,										-1,

		-a/2+0.142,		0.807+3*dy+3*0.007,							15,
		-dx/2-0.007,	0.807+3*dy+3*0.007,							15,
		-dx/2-0.007,	b-0.12-R+(R2*cos(ASN((a/2-0.142-dx)/R2))),	79,
		 0,				b-0.12-R,									900,
		-a/2+0.142,		b-0.12-R+(R2*cos(ASN((a/2-0.142)/R2))),		3079,
		-a/2+0.142,		0.807+3*dy+3*0.007,							-1,

		a/2-0.142,		0.807+3*dy+3*0.007,							15,
		dx/2+0.007,		0.807+3*dy+3*0.007,							15,
		dx/2+0.007,		b-0.12-R+(R2*cos(ASN((a/2-0.142-dx)/R2))),	79,
		0,				b-0.12-R,									900,
		a/2-0.142,		b-0.12-R+(R2*cos(ASN((a/2-0.142)/R2))),		3079,
		a/2-0.142,		0.807+3*dy+3*0.007,							-1,

		-dx/2,			0.807+3*dy+3*0.007,							15,
		 dx/2,			0.807+3*dy+3*0.007,							15,
		 dx/2,			b-0.12-R+(R2*cos(ASN((dx/2)/R2))),			79,
		 0,				b-0.12-R,									900,
		-dx/2,			b-0.12-R+(R2*cos(ASN((dx/2)/R2))),			3079,
		-dx/2,			0.807+3*dy+3*0.007,							-1,

		use (nsp)

		BODY -1
	material gs_glass_mat

	for ii = 1 to 3*3 step 1
		prism_ 5, thk4,
			get (15)
	next ii

	prism_ 6, thk4,
		-a/2+0.142,		0.807+3*dy+3*0.007,							15,
		-dx/2-0.007,	0.807+3*dy+3*0.007,							15,
		-dx/2-0.007,	b-0.12-R+(R2*cos(ASN((a/2-0.142-dx)/R2))),	79,
		 0,				b-0.12-R,									900,
		-a/2+0.142,		b-0.12-R+(R2*cos(ASN((a/2-0.142)/R2))),		3079,
		-a/2+0.142,		0.807+3*dy+3*0.007,							-1

	prism_ 6, thk4,
		a/2-0.142,		0.807+3*dy+3*0.007,							15,
		dx/2+0.007,		0.807+3*dy+3*0.007,							15,
		dx/2+0.007,		b-0.12-R+(R2*cos(ASN((a/2-0.142-dx)/R2))),	79,
		0,				b-0.12-R,									900,
		a/2-0.142,		b-0.12-R+(R2*cos(ASN((a/2-0.142)/R2))),		3079,
		a/2-0.142,		0.807+3*dy+3*0.007,							-1

	prism_ 6, thk4,
		-dx/2,	0.807+3*dy+3*0.007,					15,
		 dx/2,	0.807+3*dy+3*0.007,					15,
		 dx/2,	b-0.12-R+(R2*cos(ASN((dx/2)/R2))),	79,
		 0,		b-0.12-R,							900,
		-dx/2,	b-0.12-R+(R2*cos(ASN((dx/2)/R2))),	3079,
		-dx/2,	0.807+3*dy+3*0.007,					-1

	BODY -1
	del 1

	resol res
return


57:				! NLD 07
	if lod3D = 5 then
		thk		= gs_frame_thk
		thk2	= gs_frame_thk
		modZ	= 0
	else
		thk		= gs_leaf_thk
		thk2	= 0.02
		modZ	= gs_leaf_thk/2 - 0.01
	endif

	material gs_leaf_mat

	prism_   15, thk,
		-a/2, 0, 15,
		 a/2, 0, 15,
		 a/2, b, 15,
		-a/2, b, 15,
		-a/2, 0, -1,

		-a/2+0.12, 0.25, 15,
		-0.06, 0.25, 15,
		-0.06, b-0.12, 15,
		-a/2+0.12, b-0.12, 15,
		-a/2+0.12, 0.25, -1,

		 0.06, 0.25, 15,
		 a/2-0.12, 0.25, 15,
		 a/2-0.12, b-0.12, 15,
		 0.06, b-0.12, 15,
		 0.06, 0.25, -1

	addz modZ

	prism_  5, thk2,
		-a/2+0.12, 0.25, 15,
		-0.06, 0.25, 15,
		-0.06, b-0.12, 15,
		-a/2+0.12, b-0.12, 15,
		-a/2+0.12, 0.25, -1

	prism_  5, thk2,
		 0.06, 0.25, 15,
		 a/2-0.12, 0.25, 15,
		 a/2-0.12, b-0.12, 15,
		 0.06, b-0.12, 15,
		 0.06, 0.25, -1

	BODY -1
	del 1
return


58:				! NLD 08
	if lod3D = 5 then
		thk		= gs_frame_thk
		thk2	= gs_frame_thk
		thk3	= gs_frame_thk
		modZ	= 0
		modZ2	= 0
	else
		thk		= gs_leaf_thk
		thk2	= gs_leaf_thk + 0.01
		thk3	= 0.02
		modZ	= -0.005
		modZ2	= gs_leaf_thk/2 - 0.01
	endif

	material gs_leaf_mat

	prism_   15, thk,
		-a/2, 0, 15,
		 a/2, 0, 15,
		 a/2, b, 15,
		-a/2, b, 15,
		-a/2, 0, -1,

		-a/2+0.12, 0.16, 15,
		 a/2-0.12, 0.16, 15,
		 a/2-0.12, 0.665, 15,
		-a/2+0.12, 0.665, 15,
		-a/2+0.12, 0.16, -1,

		-a/2+0.12, 0.785, 15,
		 a/2-0.12, 0.785, 15,
		 a/2-0.12, b-0.12, 15,
		 -a/2+0.12, b-0.12, 15,
		 -a/2+0.12, 0.785, -1

	prism_   4, thk,
		-a/2+0.17, 0.21, 15,
		 a/2-0.17, 0.21, 15,
		 a/2-0.17, 0.615, 15,
		-a/2+0.17, 0.615, 15

	prism_   4, thk,
		-a/2+0.17, 0.835, 15,
		 a/2-0.17, 0.835, 15,
		 a/2-0.17, b-0.17, 15,
		 -a/2+0.17, b-0.17, 15

	addz modZ

	prism_ 10, thk2,
		-a/2+0.12, 0.16, 15,
		 a/2-0.12, 0.16, 15,
		 a/2-0.12, 0.665, 15,
		-a/2+0.12, 0.665, 15,
		-a/2+0.12, 0.16, -1,

		-a/2+0.135, 0.175, 15,
		 a/2-0.135, 0.175, 15,
		 a/2-0.135, 0.65, 15,
		-a/2+0.135, 0.65, 15,
		-a/2+0.135, 0.175, -1


	prism_ 10, thk2,
		-a/2+0.12, 0.785, 15,
		 a/2-0.12, 0.785, 15,
		 a/2-0.12, b-0.12, 15,
		 -a/2+0.12, b-0.12, 15,
		 -a/2+0.12, 0.785, -1,

		-a/2+0.135, 0.8, 15,
		 a/2-0.135, 0.8, 15,
		 a/2-0.135, b-0.135, 15,
		 -a/2+0.135, b-0.135, 15,
		 -a/2+0.135, 0.8, -1

	del 1
	addz modZ2

	prism_ 10, thk3,
		-a/2+0.135, 0.175, 15,
		 a/2-0.135, 0.175, 15,
		 a/2-0.135, 0.65, 15,
		-a/2+0.135, 0.65, 15,
		-a/2+0.135, 0.175, -1,

		-a/2+0.17, 0.21, 15,
		 a/2-0.17, 0.21, 15,
		 a/2-0.17, 0.615, 15,
		-a/2+0.17, 0.615, 15,
		-a/2+0.17, 0.21, -1

	prism_ 10, thk3,
		-a/2+0.135, 0.8, 15,
		 a/2-0.135, 0.8, 15,
		 a/2-0.135, b-0.135, 15,
		 -a/2+0.135, b-0.135, 15,
		 -a/2+0.135, 0.8, -1,

		-a/2+0.17, 0.835, 15,
		 a/2-0.17, 0.835, 15,
		 a/2-0.17, b-0.17, 15,
		 -a/2+0.17, b-0.17, 15,
		 -a/2+0.17, 0.835, -1

	BODY -1
	del 1
return


59:				! NLD 09
	if lod3D = 5 then
		thk		= gs_frame_thk
		thk2	= gs_frame_thk
		thk3	= gs_frame_thk
		modZ	= 0
		modZ2	= 0
	else
		thk		= gs_leaf_thk
		thk2	= gs_leaf_thk + 0.01
		thk3	= 0.02
		modZ	= -0.005
		modZ2	= gs_leaf_thk/2 - 0.01
	endif

	R=(0.055*0.055+(a/2-0.12)*(a/2-0.12))/0.11

	resol 4*res
	material gs_leaf_mat

	prism_   16, thk,
		-a/2, 0, 15,
		 a/2, 0, 15,
		 a/2, b, 15,
		-a/2, b, 15,
		-a/2, 0, -1,

		-a/2+0.12, 0.16, 15,
		 a/2-0.12, 0.16, 15,
		 a/2-0.12, 0.665, 15,
		-a/2+0.12, 0.665, 15,
		-a/2+0.12, 0.16, -1,

		-a/2+0.12, 0.785, 15,
		 a/2-0.12, 0.785, 15,
		 a/2-0.12, b-0.175, 79,
		 0, b-0.12-R, 900,
		 -a/2+0.12, b-0.175, 3015,
		 -a/2+0.12, 0.785, -1

	addz modZ

	prism_ 10, thk2,
		-a/2+0.12, 0.16, 15,
		 a/2-0.12, 0.16, 15,
		 a/2-0.12, 0.665, 15,
		-a/2+0.12, 0.665, 15,
		-a/2+0.12, 0.16, -1,

		-a/2+0.135, 0.175, 15,
		 a/2-0.135, 0.175, 15,
		 a/2-0.135, 0.65, 15,
		-a/2+0.135, 0.65, 15,
		-a/2+0.135, 0.175, -1

	R1=R-0.015

	prism_ 12, thk2,
		-a/2+0.12, 0.785, 15,
		 a/2-0.12, 0.785, 15,
		 a/2-0.12, b-0.175, 79,
		 0, b-0.12-R, 900,
		 -a/2+0.12, b-0.175, 3015,
		 -a/2+0.12, 0.785, -1,

		-a/2+0.135, 0.8, 15,
		 a/2-0.135, 0.8, 15,
		 a/2-0.135, b-0.12-R+(R1*cos(ASN((a/2-0.135)/R1))), 79,
		 0, b-0.12-R, 900,
		-a/2+0.135,b-0.12-R+(R1*cos(ASN((a/2-0.135)/R1))), 3015,
		-a/2+0.135, 0.8, -1
	del 1
	addz modZ2

	 prism_ 10, thk3,
		-a/2+0.135, 0.175, 15,
		 a/2-0.135, 0.175, 15,
		 a/2-0.135, 0.65, 15,
		-a/2+0.135, 0.65, 15,
		-a/2+0.135, 0.175, -1,

		-a/2+0.17, 0.21, 15,
		 a/2-0.17, 0.21, 15,
		 a/2-0.17, 0.615, 15,
		-a/2+0.17, 0.615, 15,
		-a/2+0.17, 0.21, -1

	R2=R1-0.035

	prism_ 12, thk3,
		-a/2+0.135, 0.8, 15,
		 a/2-0.135, 0.8, 15,
		 a/2-0.135, b-0.12-R+(R1*cos(ASN((a/2-0.135)/R1))), 79,
		 0, b-0.12-R, 900,
		-a/2+0.135,b-0.12-R+(R1*cos(ASN((a/2-0.135)/R1))), 3015,
		-a/2+0.135, 0.8, -1,

		-a/2+0.17, 0.835, 15,
		 a/2-0.17, 0.835, 15,
		 a/2-0.17, b-0.12-R+(R2*cos(ASN((a/2-0.17)/R2))), 79,
		 0, b-0.12-R, 900,
		-a/2+0.17,b-0.12-R+(R2*cos(ASN((a/2-0.17)/R2))), 3015,
		-a/2+0.17, 0.835, -1
	del 1

	prism_   4, thk,
		-a/2+0.17, 0.21, 15,
		 a/2-0.17, 0.21, 15,
		 a/2-0.17, 0.615, 15,
		-a/2+0.17, 0.615, 15

	prism_   6, thk,
		-a/2+0.17, 0.835, 15,
		 a/2-0.17, 0.835, 15,
		 a/2-0.17, b-0.12-R+(R2*cos(ASN((a/2-0.17)/R2))), 79,
		 0, b-0.12-R, 900,
		-a/2+0.17,b-0.12-R+(R2*cos(ASN((a/2-0.17)/R2))), 3015,
		-a/2+0.17, 0.835, -1

	BODY -1
	resol res
return


60:				! NLD 10
	if lod3D = 5 then
		thk		= gs_frame_thk
		thk2	= gs_frame_thk
		thk3	= gs_frame_thk
		modZ	= 0
		modZ2	= 0
	else
		thk		= gs_leaf_thk
		thk2	= gs_leaf_thk + 0.01
		thk3	= 0.02
		modZ	= -0.005
		modZ2	= gs_leaf_thk/2 - 0.01
	endif

	R=(0.055*0.055+(a/2-0.12)*(a/2-0.12))/0.11

	resol 4*res
	material gs_leaf_mat

	prism_   18, thk,
		-a/2, 0, 15,
		 a/2, 0, 15,
		 a/2, b, 15,
		-a/2, b, 15,
		-a/2, 0, -1,

		-a/2+0.12, 0.16, 15,
		 a/2-0.12, 0.16, 15,
		 a/2-0.12, 0.665, 79,
		 0, 0.720-R, 900,
		-a/2+0.12, 0.665, 3015,
		-a/2+0.12, 0.16, -1,

		-a/2+0.12, 0.785, 79,
		 0, 0.84-R, 900,
		 a/2-0.12, 0.785, 3015,
		 a/2-0.12, b-0.175,79,
		 0, b-0.12-R, 900,
		 -a/2+0.12, b-0.175, 3015,
		 -a/2+0.12, 0.785, -1

	addz modZ

	R1=R-0.015

	prism_ 12, thk2,
		-a/2+0.12, 0.16, 15,
		 a/2-0.12, 0.16, 15,
		 a/2-0.12, 0.665, 79,
		 0, 0.720-R, 900,
		-a/2+0.12, 0.665, 3015,
		-a/2+0.12, 0.16, -1,

		-a/2+0.135, 0.175, 15,
		 a/2-0.135, 0.175, 15,
		 a/2-0.135, 0.72-R+(R1*cos(ASN((a/2-0.135)/R1))), 79,
		 0, 0.72-R, 900,
		-a/2+0.135,0.72-R+(R1*cos(ASN((a/2-0.135)/R1))), 3015,
		-a/2+0.135, 0.175, -1

	R2=R+0.015
	prism_ 14, thk2,
		-a/2+0.12, 0.785, 79,
		 0, 0.84-R, 900,
		 a/2-0.12, 0.785, 3015,
		 a/2-0.12, b-0.175,79,
		 0, b-0.12-R, 900,
		 -a/2+0.12, b-0.175, 3015,
		 -a/2+0.12, 0.785, -1,

		-a/2+0.135, 0.84-R+(R2*cos(ASN((a/2-0.135)/R2))), 79,
		 0, 0.84-R, 900,
		 a/2-0.135, 0.84-R+(R2*cos(ASN((a/2-0.135)/R2))), 3015,
		 a/2-0.135, b-0.12-R+(R1*cos(ASN((a/2-0.135)/R1))), 79,
		 0, b-0.12-R, 900,
		 -a/2+0.135, b-0.12-R+(R1*cos(ASN((a/2-0.135)/R1))), 3015,
		 -a/2+0.135, 0.84-R+(R2*cos(ASN((a/2-0.135)/R2))), -1

	del 1
	addz modZ2

	R3=R-0.05

	 prism_ 12, thk3,
		-a/2+0.135, 0.175, 15,
		 a/2-0.135, 0.175, 15,
		 a/2-0.135, 0.72-R+(R1*cos(ASN((a/2-0.135)/R1))), 79,
		 0, 0.72-R, 900,
		-a/2+0.135,0.72-R+(R1*cos(ASN((a/2-0.135)/R1))), 3015,
		-a/2+0.135, 0.175, -1,

		-a/2+0.17, 0.21, 15,
		 a/2-0.17, 0.21, 15,
		 a/2-0.17, 0.72-R+(R3*cos(ASN((a/2-0.17)/R3))), 79,
		 0, 0.72-R, 900,
		-a/2+0.17,0.72-R+(R3*cos(ASN((a/2-0.17)/R3))), 3015,
		-a/2+0.17, 0.21, -1

	R4=R+0.05

	prism_ 14, thk3,
		-a/2+0.135, 0.84-R+(R2*cos(ASN((a/2-0.135)/R2))), 79,
		 0, 0.84-R, 900,
		 a/2-0.135, 0.84-R+(R2*cos(ASN((a/2-0.135)/R2))), 3015,
		 a/2-0.135, b-0.12-R+(R1*cos(ASN((a/2-0.135)/R1))), 79,
		 0, b-0.12-R, 900,
		 -a/2+0.135, b-0.12-R+(R1*cos(ASN((a/2-0.135)/R1))), 3015,
		 -a/2+0.135, 0.84-R+(R2*cos(ASN((a/2-0.135)/R2))), -1,

		-a/2+0.17, 0.84-R+(R4*cos(ASN((a/2-0.17)/R4))), 79,
		 0, 0.84-R, 900,
		 a/2-0.17, 0.84-R+(R4*cos(ASN((a/2-0.17)/R4))), 3015,
		 a/2-0.17, b-0.12-R+(R3*cos(ASN((a/2-0.17)/R3))), 79,
		 0, b-0.12-R, 900,
		 -a/2+0.17, b-0.12-R+(R3*cos(ASN((a/2-0.17)/R3))), 3015,
		 -a/2+0.17, 0.84-R+(R4*cos(ASN((a/2-0.17)/R4))), -1

	del 1
	prism_  6, thk,
		-a/2+0.17, 0.21, 15,
		 a/2-0.17, 0.21, 15,
		 a/2-0.17, 0.72-R+(R3*cos(ASN((a/2-0.17)/R3))), 79,
		 0, 0.72-R, 900,
		-a/2+0.17,0.72-R+(R3*cos(ASN((a/2-0.17)/R3))), 3015,
		-a/2+0.17, 0.21, -1

	prism_   7, thk,
		-a/2+0.17, 0.84-R+(R4*cos(ASN((a/2-0.17)/R4))), 79,
		 0, 0.84-R, 900,
		 a/2-0.17, 0.84-R+(R4*cos(ASN((a/2-0.17)/R4))), 3015,
		 a/2-0.17, b-0.12-R+(R3*cos(ASN((a/2-0.17)/R3))), 79,
		 0, b-0.12-R, 900,
		 -a/2+0.17, b-0.12-R+(R3*cos(ASN((a/2-0.17)/R3))), 3015,
		 -a/2+0.17, 0.84-R+(R4*cos(ASN((a/2-0.17)/R4))), -1

	BODY -1
return


61:				! NLD 11
	if lod3D = 5 then
		thk		= gs_frame_thk
		thk2	= gs_frame_thk
		thk3	= gs_frame_thk
		thk4	= gs_frame_thk
		modZ	= 0
		modZ2	= 0
		modZ3	= 0
	else
		thk		= gs_leaf_thk
		thk2	= 0.02
		thk3	= gs_leaf_thk + 0.01
		thk4	= 0.007
		modZ	= 0.0125
		modZ2	= -0.005
		modZ3	= gs_leaf_thk/2 - 0.007
	endif

	material gs_leaf_mat

	prism_   15, thk,
		-a/2, 0, 15,
		 a/2, 0, 15,
		 a/2, b, 15,
		-a/2, b, 15,
		-a/2, 0, -1,

		-a/2+0.12, 0.16, 15,
		 a/2-0.12, 0.16, 15,
		 a/2-0.12, 0.665, 15,
		-a/2+0.12, 0.665, 15,
		-a/2+0.12, 0.16, -1,

		-a/2+0.12, 0.785, 15,
		 a/2-0.12, 0.785, 15,
		 a/2-0.12, b-0.12, 15,
		-a/2+0.12, b-0.12, 15,
		-a/2+0.12, 0.785, -1

	prism_  5, thk,
		-a/2+0.155,0.195, 15,
		 a/2-0.155,0.195, 15,
		 a/2-0.155, 0.63, 15,
		-a/2+0.155, 0.63, 15,
		-a/2+0.155,0.195, -1

	addz modZ

	prism_ 10, thk2,
		-a/2+0.12, 0.16, 15,
		 a/2-0.12, 0.16, 15,
		 a/2-0.12, 0.665, 15,
		-a/2+0.12, 0.665, 15,
		-a/2+0.12, 0.16, -1,

		-a/2+0.155,0.195, 15,
		 a/2-0.155,0.195, 15,
		 a/2-0.155, 0.63, 15,
		-a/2+0.155, 0.63, 15,
		-a/2+0.155,0.195, -1

	del 1

	addz modZ2

	kx = -a/2+0.135
	ky = 0.8

	dx = (a-0.135*2-0.015) / 2
	dy = (b-0.135-0.8-0.015*2) / 3

	for iy = 1 to 3 step 1
		for ix = 1 to 2 step 1
			put kx, ky, 15,
				kx+dx, ky, 15,
				kx+dx, ky+dy, 15,
				kx, ky+dy, 15,
				kx, ky, -1

			kx = kx+dx+0.015
		next ix

		kx = -a/2+0.135
		ky = ky+dy+0.015
	next iy

	prism_ 5+nsp/3, thk3,
		-a/2+0.12, 0.785, 15,
		 a/2-0.12, 0.785, 15,
		 a/2-0.12, b-0.12, 15,
		-a/2+0.12, b-0.12, 15,
		-a/2+0.12, 0.785, -1,

		use (nsp)

	BODY -1
	del 1

	material gs_glass_mat
	addz modZ3

	for ii = 1 to 3*2 step 1
		prism_ 5, thk4,
			get (15)
	next ii

	BODY -1
	del 1
return


62:				! NLD 12
	if lod3D = 5 then
		thk		= gs_frame_thk
		thk2	= gs_frame_thk
		thk3	= gs_frame_thk
		thk4	= gs_frame_thk
		modZ	= 0
		modZ2	= 0
		modZ3	= 0
	else
		thk		= gs_leaf_thk
		thk2	= gs_leaf_thk + 0.01
		thk3	= 0.02
		thk4	= 0.007
		modZ	= -0.005
		modZ2	= gs_leaf_thk/2 - 0.005
		modZ3	= gs_leaf_thk/2 - thk4/2
	endif

	R=((gs_leaf_thk+0.01)*(gs_leaf_thk+0.01)+(a/2-0.12)*(a/2-0.12))/0.11

	resol 4*res
	material gs_leaf_mat

	prism_   18, thk,
		-a/2, 0, 15,
		 a/2, 0, 15,
		 a/2, b, 15,
		-a/2, b, 15,
		-a/2, 0, -1,

		-a/2+0.12, 0.16, 15,
		 a/2-0.12, 0.16, 15,
		 a/2-0.12, 0.665, 79,
		 0, 0.720-R, 900,
		-a/2+0.12, 0.665, 3015,
		-a/2+0.12, 0.16, -1,

		-a/2+0.12, 0.785, 79,
		 0, 0.84-R, 900,
		 a/2-0.12, 0.785, 3015,
		 a/2-0.12, b-0.175,79,
		 0, b-0.12-R, 900,
		 -a/2+0.12, b-0.175, 3015,
		 -a/2+0.12, 0.785, -1

	addz modZ

	R1=R-0.015

	prism_ 12, thk2,
		-a/2+0.12, 0.16, 15,
		 a/2-0.12, 0.16, 15,
		 a/2-0.12, 0.665, 79,
		 0, 0.720-R, 900,
		-a/2+0.12, 0.665, 3015,
		-a/2+0.12, 0.16, -1,

		-a/2+0.135, 0.175, 15,
		 a/2-0.135, 0.175, 15,
		 a/2-0.135, 0.72-R+(R1*cos(ASN((a/2-0.135)/R1))), 79,
		 0, 0.72-R, 900,
		-a/2+0.135,0.72-R+(R1*cos(ASN((a/2-0.135)/R1))), 3015,
		-a/2+0.135, 0.175, -1

	R2=R+0.015
	prism_ 14, thk2,
		-a/2+0.12, 0.785, 79,
		 0, 0.84-R, 900,
		 a/2-0.12, 0.785, 3015,
		 a/2-0.12, b-0.175,79,
		 0, b-0.12-R, 900,
		 -a/2+0.12, b-0.175, 3015,
		 -a/2+0.12, 0.785, -1,

		-a/2+0.135, 0.84-R+(R2*cos(ASN((a/2-0.135)/R2))), 79,
		 0, 0.84-R, 900,
		 a/2-0.135, 0.84-R+(R2*cos(ASN((a/2-0.135)/R2))), 3015,
		 a/2-0.135, b-0.12-R+(R1*cos(ASN((a/2-0.135)/R1))), 79,
		 0, b-0.12-R, 900,
		 -a/2+0.135, b-0.12-R+(R1*cos(ASN((a/2-0.135)/R1))), 3015,
		 -a/2+0.135, 0.84-R+(R2*cos(ASN((a/2-0.135)/R2))), -1

	addz modZ2

	R3=R-0.05

	 prism_ 12, thk3,
		-a/2+0.135, 0.175, 15,
		 a/2-0.135, 0.175, 15,
		 a/2-0.135, 0.72-R+(R1*cos(ASN((a/2-0.135)/R1))), 79,
		 0, 0.72-R, 900,
		-a/2+0.135,0.72-R+(R1*cos(ASN((a/2-0.135)/R1))), 3015,
		-a/2+0.135, 0.175, -1,

		-a/2+0.17, 0.21, 15,
		 a/2-0.17, 0.21, 15,
		 a/2-0.17, 0.72-R+(R3*cos(ASN((a/2-0.17)/R3))), 79,
		 0, 0.72-R, 900,
		-a/2+0.17,0.72-R+(R3*cos(ASN((a/2-0.17)/R3))), 3015,
		-a/2+0.17, 0.21, -1

	R4=R+0.05
	R5=R2+0.015
	R6=R1-0.015

	del 2

	prism_   6, thk,
		-a/2+0.17, 0.21, 15,
		 a/2-0.17, 0.21, 15,
		 a/2-0.17, 0.72-R+(R3*cos(ASN((a/2-0.17)/R3))), 79,
		 0, 0.72-R, 900,
		-a/2+0.17,0.72-R+(R3*cos(ASN((a/2-0.17)/R3))), 3015,
		-a/2+0.17, 0.21, -1

	kx = -a/2+0.15
	ky = 0.87+0.015+(b-(0.15+0.87)-0.015*3)/4

	dx = (a-0.12*2-0.015*6) / 3
	dy = (b-(0.15+0.87)-0.015*3)/4

	for iy = 1 to 2 step 1
		for ix = 1 to 3 step 1
			put kx, ky, 15,
				kx+dx, ky, 15,
				kx+dx, ky+dy, 15,
				kx, ky+dy, 15,
				kx, ky, -1

			kx = kx+dx+0.015
		next ix

		kx = -a/2+0.15
		ky = ky+dy+0.015
	next iy

	prism_ 43+nsp/3, thk,
		 -a/2+0.135, 0.84-R+(R2*cos(ASN((a/2-0.135)/R2))), 79,
		  0, 0.84-R, 900,
		  a/2-0.135, 0.84-R+(R2*cos(ASN((a/2-0.135)/R2))), 3079,
		  a/2-0.135, b-0.12-R+(R1*cos(ASN((a/2-0.135)/R1))), 79,
		  0, b-0.12-R, 900,
		 -a/2+0.135, b-0.12-R+(R1*cos(ASN((a/2-0.135)/R1))), 3015,
		 -a/2+0.135, 0.84-R+(R2*cos(ASN((a/2-0.135)/R2))), -1,

		 -a/2+0.15, b-0.15-dy, 15,
		 -a/2+0.15+dx, b-0.15-dy, 15,
		 -a/2+0.15+dx, b-0.12-R+(R6*cos(ASN((a/2-(dx+0.15))/R6))), 79,
		  0, b-0.12-R, 900,
		 -a/2+0.15,  b-0.12-R+(R6*cos(ASN((a/2-0.15)/R6))), 3079,
		 -a/2+0.15, b-0.15-dy, -1,

		  a/2-0.15-dx, b-0.15-dy, 15,
		  a/2-0.15, b-0.15-dy, 15,
		  a/2-0.15, b-0.12-R+(R6*cos(ASN((a/2-0.15)/R6))), 79,
		  0, b-0.12-R, 900,
		  a/2-0.15-dx, b-0.12-R+(R6*cos(ASN((a/2-(dx+0.15))/R6))), 3079,
		  a/2-0.15-dx, b-0.15-dy, -1,

		 -dx/2, b-0.15-dy, 15,
		  dx/2, b-0.15-dy, 15,
		  dx/2, b-0.12-R+(R6*cos(ASN((a/2-(dx+0.15+0.015))/R6))), 79,
		  0, b-0.12-R, 900,
		 -dx/2,  b-0.12-R+(R6*cos(ASN((a/2-(dx+0.15+0.015))/R6))),3079,
		 -dx/2, b-0.15-dy, -1,

		 -a/2+0.15, 0.84-R+(R5*cos(ASN((a/2-0.15)/R5))), 79,
		  0, 0.84-R, 900,
		 -a/2+0.15+dx, 0.84-R+(R5*cos(ASN((a/2-0.15-dx)/R5))), 3079,
		 -a/2+0.15+dx, 0.87+dy, 15,
		 -a/2+0.15, 0.87+dy, 15,
		 -a/2+0.15, 0.84-R+(R5*cos(ASN((a/2-0.15)/R5))), -1,

		  a/2-0.15-dx, 0.84-R+(R5*cos(ASN((a/2-0.15-dx)/R5))), 79,
		  0, 0.84-R, 900,
		  a/2-0.15, 0.84-R+(R5*cos(ASN((a/2-0.15)/R5))), 3079,
		  a/2-0.15, 0.87+dy, 15,
		  a/2-0.15-dx, 0.87+dy, 15,
		  a/2-0.15-dx, 0.84-R+(R5*cos(ASN((a/2-0.15-dx)/R5))), -1,

		 -dx/2, 0.84-R+(R5*cos(ASN((a/2-0.15-dx-0.015)/R5))), 79,
		  0, 0.84-R, 900,
		  dx/2, 0.84-R+(R5*cos(ASN((a/2-0.15-dx-0.015)/R5))), 3079,
		  dx/2, 0.87+dy, 15,
		 -dx/2, 0.87+dy, 15,
		 -dx/2, 0.84-R+(R5*cos(ASN((a/2-0.15-dx-0.015)/R5))), -1,

	   use (nsp)

	BODY -1

	material gs_glass_mat
	addz modZ3

	for ii = 1 to 3*2 step 1
		prism_ 5, thk4,
			get (15)
	next ii

	prism_ 6, thk4,
		 -a/2+0.15, b-0.15-dy, 15,
		 -a/2+0.15+dx, b-0.15-dy, 15,
		 -a/2+0.15+dx, b-0.12-R+(R6*cos(ASN((a/2-(dx+0.15))/R6))), 79,
		  0, b-0.12-R, 900,
		 -a/2+0.15,  b-0.12-R+(R6*cos(ASN((a/2-0.15)/R6))), 3079,
		 -a/2+0.15, b-0.15-dy, -1

	prism_ 6, thk4,
		  a/2-0.15-dx, b-0.15-dy, 15,
		  a/2-0.15, b-0.15-dy, 15,
		  a/2-0.15, b-0.12-R+(R6*cos(ASN((a/2-0.15)/R6))), 79,
		  0, b-0.12-R, 900,
		  a/2-0.15-dx, b-0.12-R+(R6*cos(ASN((a/2-(dx+0.15))/R6))), 3079,
		  a/2-0.15-dx, b-0.15-dy, -1

	prism_ 6, thk4,
		 -dx/2, b-0.15-dy, 15,
		  dx/2, b-0.15-dy, 15,
		  dx/2, b-0.12-R+(R6*cos(ASN((a/2-(dx+0.15+0.015))/R6))), 79,
		  0, b-0.12-R, 900,
		 -dx/2,  b-0.12-R+(R6*cos(ASN((a/2-(dx+0.15+0.015))/R6))),3079,
		 -dx/2, b-0.15-dy, -1

	prism_ 6, thk4,
		 -a/2+0.15, 0.84-R+(R5*cos(ASN((a/2-0.15)/R5))), 79,
		  0, 0.84-R, 900,
		 -a/2+0.15+dx, 0.84-R+(R5*cos(ASN((a/2-0.15-dx)/R5))), 3079,
		 -a/2+0.15+dx, 0.87+dy, 15,
		 -a/2+0.15, 0.87+dy, 15,
		 -a/2+0.15, 0.84-R+(R5*cos(ASN((a/2-0.15)/R5))), -1

	prism_ 6, thk4,
		  a/2-0.15-dx, 0.84-R+(R5*cos(ASN((a/2-0.15-dx)/R5))), 79,
		  0, 0.84-R, 900,
		  a/2-0.15, 0.84-R+(R5*cos(ASN((a/2-0.15)/R5))), 3079,
		  a/2-0.15, 0.87+dy, 15,
		  a/2-0.15-dx, 0.87+dy, 15,
		  a/2-0.15-dx, 0.84-R+(R5*cos(ASN((a/2-0.15-dx)/R5))), -1

	prism_ 6, thk4,
		 -dx/2, 0.84-R+(R5*cos(ASN((a/2-0.15-dx-0.015)/R5))), 79,
		  0, 0.84-R, 900,
		  dx/2, 0.84-R+(R5*cos(ASN((a/2-0.15-dx-0.015)/R5))), 3079,
		  dx/2, 0.87+dy, 15,
		 -dx/2, 0.87+dy, 15,
		 -dx/2, 0.84-R+(R5*cos(ASN((a/2-0.15-dx-0.015)/R5))), -1

	BODY -1
	del 1
return


63:				! NLD 13
	if lod3D = 5 then
		thk		= gs_frame_thk
		thk2	= gs_frame_thk
		thk3	= gs_frame_thk
		thk4	= gs_frame_thk
		modZ	= 0
		modZ2	= 0
		modZ3	= 0
	else
		thk		= gs_leaf_thk
		thk2	= gs_leaf_thk + 0.01
		thk3	= 0.02
		thk4	= 0.007
		modZ	= -0.005
		modZ2	= 0.0175
		modZ3	= gs_leaf_thk/2 - 0.007/2
	endif

	dx			= (a-0.199*2-0.007*2) / 3
	dy			= (b-0.135-0.864-0.007*2-0.05) / 3

	R			= (a/2-0.12)^2/0.11
	R1			= R - 0.015 !glass frame
	R2			= R1 - 0.007 !Outer grill thk
	R4			= R2 - 0.050 !Outer glass thk
	R3			= R4 - 0.007 !Inneer glass thk
	arcOrigo	= b-0.12-R

	shoulder	= SQR(R^2 - ((A - 0.24)/2)^2)
	shoulder1	= SQR(R1^2 - ((A - 0.27)/2)^2)
	shoulder2	= SQR(R2^2 - ((A - 0.284)/2)^2)
	shoulder2In	= SQR(R2^2 - 0.0035^2)

	shoulder4	= SQR(R4^2 - ((A - 0.384)/2)^2)
	shoulder4In	= SQR(R4^2 - 0.0035^2)

	shoulder3	= SQR(R3^2 - ((A - 0.398)/2)^2)
	shoulder3In	= SQR(R3^2 - (dx/2+0.007)^2)
	shoulder3Center	= SQR(R3^2 - (dx/2)^2)


	resol 4*res
	material gs_leaf_mat

	prism_   16, thk,
		-a/2, 0, 15,
		 a/2, 0, 15,
		 a/2, b, 15,
		-a/2, b, 15,
		-a/2, 0, -1,

		-a/2+0.12, 0.16, 15,
		 a/2-0.12, 0.16, 15,
		 a/2-0.12, 0.665, 15,
		-a/2+0.12, 0.665, 15,
		-a/2+0.12, 0.16, -1,

		-a/2+0.12, 0.785, 15,
		 a/2-0.12, 0.785, 15,
		 a/2-0.12,	arcOrigo + shoulder, 79,
		 0, 		ArcOrigo, 900,
		 -a/2+0.12,	arcOrigo + shoulder, 3015,
		 -a/2+0.12, 0.785, -1

	addz modZ

	prism_ 12, thk2,
		-a/2+0.12,	0.785, 15,
		 a/2-0.12,	0.785, 15,
		 a/2-0.12,	arcOrigo + shoulder, 79,
		 0, 		arcOrigo, 900,
		 -a/2+0.12,	arcOrigo + shoulder, 3015,
		 -a/2+0.12,	0.785, -1,

		-a/2+0.135,	0.8, 15,
		 a/2-0.135,	0.8, 15,
		 a/2-0.135, arcOrigo + shoulder1, 79,
		 0,			arcOrigo, 900,
		-a/2+0.135,	arcOrigo + shoulder1, 3015,
		-a/2+0.135, 0.8, -1


	prism_ 10, thk2,
		-a/2+0.12, 0.16, 15,
		 a/2-0.12, 0.16, 15,
		 a/2-0.12, 0.665, 15,
		-a/2+0.12, 0.665, 15,
		-a/2+0.12, 0.16, -1,

		-a/2+0.135, 0.175, 15,
		 a/2-0.135, 0.175, 15,
		 a/2-0.135, 0.65, 15,
		-a/2+0.135, 0.65, 15,
		-a/2+0.135, 0.175, -1

	addz modZ2

	 prism_ 10, thk3,
		-a/2+0.135, 0.175, 15,
		 a/2-0.135, 0.175, 15,
		 a/2-0.135, 0.65, 15,
		-a/2+0.135, 0.65, 15,
		-a/2+0.135, 0.175, -1,


		-a/2+0.17, 0.21, 15,
		 a/2-0.17, 0.21, 15,
		 a/2-0.17, 0.615, 15,
		-a/2+0.17, 0.615, 15,
		-a/2+0.17, 0.21, -1

	del 2

	prism_   4, thk,
		-a/2+0.17, 0.21, 15,
		 a/2-0.17, 0.21, 15,
		 a/2-0.17, 0.615, 15,
		-a/2+0.17, 0.615, 15

	kx = -a/2+0.12+0.015+0.007*2+0.05
	ky = 0.864

	for iy = 1 to 2 step 1
		for ix = 1 to 3 step 1
			put kx, ky, 15,
				kx+dx, ky, 15,
				kx+dx, ky+dy, 15,
				kx, ky+dy, 15,
				kx, ky, -1

			kx = kx+dx+0.007
		next ix

		kx =  -a/2+0.12+0.015+0.007*2+0.05
		ky = ky+dy+0.007
	next iy

	material gs_leaf_mat
	addz modZ3

	prism_ 72+nsp/3, thk4,
		-a/2+0.135, 0.8, 15,
		 a/2-0.135, 0.8, 15,
		 a/2-0.135,	arcOrigo + shoulder1, 79,
		 0,			arcOrigo, 900,
		-a/2+0.135,	arcOrigo + shoulder1, 3015,
		-a/2+0.135, 0.8, -1,

		-a/2+0.142,			0.864+2*dy+2*0.007, 15,
		-dx/2-0.007*2-dx,	0.864+2*dy+2*0.007, 15,
		-dx/2-0.007*2-dx,	arcOrigo + shoulder4, 79,
		 0,					arcOrigo, 900,
		-0.0035,			arcOrigo + shoulder4In, 3079,
		-0.0035,			arcOrigo + shoulder2In, 79,
		 0,					arcOrigo, 900,
		-a/2+0.142,			arcOrigo + shoulder2, 3079,
		-a/2+0.142,			0.864+2*dy+2*0.007, -1,

		 a/2-0.142,			0.864+2*dy+2*0.007, 15,
		 dx/2+0.007*2+dx,	0.864+2*dy+2*0.007, 15,
		 dx/2+0.007*2+dx,	arcOrigo + shoulder4, 79,
		 0,					arcOrigo, 900,
		 0.0035,			arcOrigo + shoulder4In, 3079,
		 0.0035,			arcOrigo + shoulder2In, 79,
		 0,					arcOrigo, 900,
		 a/2-0.142,			arcOrigo + shoulder2, 3079,
		 a/2-0.142,			0.864+2*dy+2*0.007, -1,

		-dx/2-0.007-dx, 0.864+2*0.007+2*dy, 15,
		-dx/2-0.007, 0.864+2*0.007+2*dy, 15,
		-dx/2-0.007,		arcOrigo + shoulder3In, 79,
		 0,					arcOrigo, 900,
		-dx/2-0.007-dx,		arcOrigo + shoulder3, 3079,
		-dx/2-0.007-dx, 0.864+2*0.007+2*dy, -1,

		 dx/2+0.007+dx, 0.864+2*0.007+2*dy, 15,
		 dx/2+0.007, 0.864+2*0.007+2*dy, 15,
		 dx/2+0.007,		arcOrigo+ shoulder3In, 79,
		 0,					arcOrigo, 900,
		 dx/2+0.007+dx,		arcOrigo + shoulder3, 3079,
		 dx/2+0.007+dx, 0.864+2*0.007+2*dy, -1,

		-dx/2, 0.864+2*0.007+2*dy, 15,
		 dx/2, 0.864+2*0.007+2*dy, 15,
		 dx/2,				arcOrigo + shoulder3Center, 79,
		 0,					arcOrigo, 900,
		-dx/2,				arcOrigo + shoulder3Center, 3079,
		-dx/2, 0.864+2*0.007+2*dy, -1,

		-a/2+0.12+0.015+0.007+sqr(2*0.0035^2), 0.807, 15,
		-0.0035, 0.807, 15,
		-0.0035, 0.857, 15,
		-a/2+0.12+0.015+0.007+sqr(2*0.0035^2)+0.05, 0.857, 15,
		-a/2+0.12+0.015+0.007+sqr(2*0.0035^2), 0.807, -1,

		a/2-0.12-0.015-0.007-sqr(2*0.0035^2), 0.807, 15,
		0.0035, 0.807, 15,
		0.0035, 0.857, 15,
		a/2-0.12-0.015-0.007-sqr(2*0.0035^2)-0.05, 0.857, 15,
		a/2-0.12-0.015-0.007-sqr(2*0.0035^2), 0.807, -1,

		-a/2+0.142, 0.807+sqr(2*0.0035^2), 15,
		-dx/2-0.007*2-dx, 0.857+sqr(2*0.0035^2), 15,
		-dx/2-0.007*2-dx, 0.864+dy, 15,
		-a/2+0.142, 0.864+dy, 15,
		-a/2+0.142, 0.807+sqr(2*0.0035^2), -1,

		a/2-0.142, 0.807+sqr(2*0.0035^2), 15,
		dx/2+0.007*2+dx, 0.857+sqr(2*0.0035^2), 15,
		dx/2+0.007*2+dx, 0.864+dy, 15,
		a/2-0.142, 0.864+dy, 15,
		a/2-0.142, 0.807+sqr(2*0.0035^2), -1,

		-a/2+0.142, 0.864+dy+0.007, 15,
		-dx/2-0.007*2-dx, 0.864+dy+0.007, 15,
		-dx/2-0.007*2-dx, 0.864+2*dy+0.007, 15,
		-a/2+0.142, 0.864+2*dy+0.007, 15,
		-a/2+0.142, 0.864+dy+0.007, -1,

		a/2-0.142, 0.864+dy+0.007, 15,
		dx/2+0.007*2+dx, 0.864+dy+0.007, 15,
		dx/2+0.007*2+dx, 0.864+2*dy+0.007, 15,
		a/2-0.142, 0.864+2*dy+0.007, 15,
		a/2-0.142, 0.864+dy+0.007, -1,

		use (nsp)

	BODY -1
	material gs_glass_mat

	for ii = 1 to 3*2 step 1
		prism_ 5, thk4,
			get (15)
	next ii

	prism_   6, thk4,
		-dx/2-0.007-dx, 0.864+2*0.007+2*dy, 15,
		-dx/2-0.007, 0.864+2*0.007+2*dy, 15,
		-dx/2-0.007,		arcOrigo + shoulder3In, 79,
		 0,					arcOrigo, 900,
		-dx/2-0.007-dx,		arcOrigo + shoulder3, 3079,
		-dx/2-0.007-dx, 0.864+2*0.007+2*dy, -1

	prism_   6, thk4,
		 dx/2+0.007+dx, 0.864+2*0.007+2*dy, 15,
		 dx/2+0.007, 0.864+2*0.007+2*dy, 15,
		 dx/2+0.007,		arcOrigo+ shoulder3In, 79,
		 0,					arcOrigo, 900,
		 dx/2+0.007+dx,		arcOrigo + shoulder3, 3079,
		 dx/2+0.007+dx, 0.864+2*0.007+2*dy, -1

	prism_   6, thk4,
		-dx/2, 0.864+2*0.007+2*dy, 15,
		 dx/2, 0.864+2*0.007+2*dy, 15,
		 dx/2,				arcOrigo + shoulder3Center, 79,
		 0,					arcOrigo, 900,
		-dx/2,				arcOrigo + shoulder3Center, 3079,
		-dx/2, 0.864+2*0.007+2*dy, -1

	prism_   5, thk4,
		-a/2+0.12+0.015+0.007+sqr(2*0.0035^2), 0.807, 15,
		-0.0035, 0.807, 15,
		-0.0035, 0.857, 15,
		-a/2+0.12+0.015+0.007+sqr(2*0.0035^2)+0.05, 0.857, 15,
		-a/2+0.12+0.015+0.007+sqr(2*0.0035^2), 0.807, -1

	prism_   5, thk4,
		a/2-0.12-0.015-0.007-sqr(2*0.0035^2), 0.807, 15,
		0.0035, 0.807, 15,
		0.0035, 0.857, 15,
		a/2-0.12-0.015-0.007-sqr(2*0.0035^2)-0.05, 0.857, 15,
		a/2-0.12-0.015-0.007-sqr(2*0.0035^2), 0.807, -1

	prism_   5, thk4,
		-a/2+0.142, 0.807+sqr(2*0.0035^2), 15,
		-dx/2-0.007*2-dx, 0.857+sqr(2*0.0035^2), 15,
		-dx/2-0.007*2-dx, 0.864+dy, 15,
		-a/2+0.142, 0.864+dy, 15,
		-a/2+0.142, 0.807+sqr(2*0.0035^2), -1

	prism_   5, thk4,
		a/2-0.142, 0.807+sqr(2*0.0035^2), 15,
		dx/2+0.007*2+dx, 0.857+sqr(2*0.0035^2), 15,
		dx/2+0.007*2+dx, 0.864+dy, 15,
		a/2-0.142, 0.864+dy, 15,
		a/2-0.142, 0.807+sqr(2*0.0035^2), -1

	prism_   5, thk4,
		-a/2+0.142, 0.864+dy+0.007, 15,
		-dx/2-0.007*2-dx, 0.864+dy+0.007, 15,
		-dx/2-0.007*2-dx, 0.864+2*dy+0.007, 15,
		-a/2+0.142, 0.864+2*dy+0.007, 15,
		-a/2+0.142, 0.864+dy+0.007, -1

	prism_   5, thk4,
		a/2-0.142, 0.864+dy+0.007, 15,
		dx/2+0.007*2+dx, 0.864+dy+0.007, 15,
		dx/2+0.007*2+dx, 0.864+2*dy+0.007, 15,
		a/2-0.142, 0.864+2*dy+0.007, 15,
		a/2-0.142, 0.864+dy+0.007, -1

	prism_   9, thk4,
		-a/2+0.142, 0.864+2*dy+2*0.007, 15,
		-dx/2-0.007*2-dx, 0.864+2*dy+2*0.007, 15,
		-dx/2-0.007*2-dx,	arcOrigo + shoulder4, 79,
		 0,					arcOrigo, 900,
		-0.0035,			arcOrigo + shoulder4In, 3079,
		-0.0035,			arcOrigo + shoulder2In, 79,
		 0,					arcOrigo, 900,
		-a/2+0.142,			arcOrigo + shoulder2, 3079,
		-a/2+0.142, 0.864+2*dy+2*0.007, -1

	prism_   9, thk4,
		 a/2-0.142, 0.864+2*dy+2*0.007, 15,
		 dx/2+0.007*2+dx, 0.864+2*dy+2*0.007, 15,
		 dx/2+0.007*2+dx,	arcOrigo + shoulder4, 79,
		 0,					arcOrigo, 900,
		 0.0035,			arcOrigo + shoulder4In, 3079,
		 0.0035,			arcOrigo + shoulder2In, 79,
		 0,					arcOrigo, 900,
		 a/2-0.142,			arcOrigo + shoulder2, 3079,
		 a/2-0.142, 0.864+2*dy+2*0.007, -1

	BODY -1
	del 1
	resol res
return


64:				! NLD 14
	if lod3D = 5 then
		thk		= gs_frame_thk
		thk2	= gs_frame_thk
		thk3	= gs_frame_thk
		modZ	= 0
		modZ2	= 0
	else
		thk		= gs_leaf_thk
		thk2	= gs_leaf_thk / 2
		thk3	= 0.004
		modZ	= gs_leaf_thk / 4
		modZ2	= gs_leaf_thk / 8
	endif

	addx -a/2
	material gs_leaf_mat

	d = 2"	! panel frame width
	f = 1"	! f=internal frame width of fill
	g = 3	! g= no. of horizontal panes

	i=(a-(g+1)*d)/g

	for v=0 to g-1
	  put	d+v*(d+i),		d,				15,
			(v+1)*(d+i),	d,				15,
			(v+1)*(d+i),	3*b/7-d/2,		15,
			d+v*(d+i),		3*b/7-d/2,		15,
			d+v*(d+i),		d,				-1,
			d+v*(d+i),		3*b/7+d/2,		15,
			(v+1)*(d+i),	3*b/7+d/2,		15,
			(v+1)*(d+i),	6*b/7-d,		15,
			d+v*(d+i),		6*b/7-d,		15,
			d+v*(d+i),		3*b/7+d/2,		-1,
			d+v*(d+i),		6*b/7,			15,
			(v+1)*(d+i),	6*b/7,			15,
			(v+1)*(d+i),	b-d,			15,
			d+v*(d+i),		b-d,			15,
			d+v*(d+i),		6*b/7,			-1
	next v

	prism_ 5+nsp/3, thk,
		0,	0,	15,
		0,	b,	15,
		a,	b,	15,
		a,	0,	15,
		0,	0,	-1,

		use (nsp)

	addz modZ

	for v=0 to g-1
	  prism_ 10, thk2,
			get (3*5),
			d+v*(d+i)+f,	d+f,			15,
			(v+1)*(d+i)-f,	d+f,			15,
			(v+1)*(d+i)-f,	3*b/7-d/2-f,	15,
			d+v*(d+i)+f,	3*b/7-d/2-f,	15,
			d+v*(d+i)+f,	d+f,			-1

	   prism_ 10, thk2,
			get (3*5),
			d+v*(d+i)+f,	3*b/7+d/2+f,	15,
			(v+1)*(d+i)-f,	3*b/7+d/2+f,	15,
			(v+1)*(d+i)-f,	6*b/7-d-f,		15,
			d+v*(d+i)+f,	6*b/7-d-f,		15,
			d+v*(d+i)+f,	3*b/7+d/2+f,	-1

	   prism_ 10, thk2,
			get (3*5),
			d+v*(d+i)+f,	6*b/7+f,		15,
			(v+1)*(d+i)-f,	6*b/7+f,		15,
			(v+1)*(d+i)-f,	b-d-f,			15,
			d+v*(d+i)+f,	b-d-f,			15,
			d+v*(d+i)+f,	6*b/7+f,		-1
	next v

	material gs_glass_mat
	addz modZ2
	   for v=0 to g-1
		  prism_ 4, thk3,
			d+v*(d+i)+f,	d+f,			15,
			(v+1)*(d+i)-f,	d+f,			15,
			(v+1)*(d+i)-f,	3*b/7-d/2-f,	15,
			d+v*(d+i)+f,	3*b/7-d/2-f,	15

		  prism_ 4, thk3,
			d+v*(d+i)+f,	3*b/7+d/2+f,	15,
			(v+1)*(d+i)-f,	3*b/7+d/2+f,	15,
			(v+1)*(d+i)-f,	6*b/7-d-f,		15,
			d+v*(d+i)+f,	6*b/7-d-f,		15

		  prism_ 4, thk3,
			d+v*(d+i)+f,	6*b/7+f,		15,
			(v+1)*(d+i)-f,	6*b/7+f,		15,
			(v+1)*(d+i)-f,	b-d-f,			15,
			d+v*(d+i)+f,	b-d-f,			15
	  next v

	del 3
return


65:				! NLD 15
	if lod3D = 5 then
		thk		= gs_frame_thk
		thk2	= gs_frame_thk
		thk3	= gs_frame_thk
		modZ	= 0
		modZ2	= 0
	else
		thk		= 0.03
		thk2	= 0.02
		thk3	= gs_leaf_thk
		modZ	= 0.005
		modZ2	= 0.01
	endif

	material gs_leaf_mat

	addz modZ

	PRISM_ 10, thk,
		0,				3*b/4-0.035,		15,
		0.35/2+0.035,	3*b/4+0.35/2,		15,
		0,				3*b/4+0.35+0.035,	15,
		-0.35/2-0.035,	3*b/4+0.35/2,		15,
		0,				3*b/4-0.035,		-1,

		0,			3*b/4,			15,
		0.35/2,		3*b/4+0.35/2,	15,
		0,			3*b/4 + 0.35,	15,
		-0.35/2,	3*b/4+0.35/2,	15,
		0,			3*b/4,			-1

	del 1
	addz modZ2

	cPRISM_ gs_glass_mat,gs_glass_mat,gs_glass_mat,
		5, thk2,
		0,			3*b/4,			15,
		0.35/2,		3*b/4+0.35/2,	15,
		0,			3*b/4 + 0.35,	15,
		-0.35/2,	3*b/4+0.35/2,	15,
		0,			3*b/4,			-1

	del 1

	EXTRUDE 5+5, 0, 0, thk3, 1+2+4+16+32,
		-a/2,     		0,     		 0,
		 a/2,     		0,     		 0,
		 a/2,     		b,     		 0,
		-a/2,     		b,    		 0,
		-a/2,     		0,     		-1,

		0,				3*b/4-0.035,		15,
		0.35/2+0.035,	3*b/4+0.35/2,		15,
		0,				3*b/4+0.35+0.035,	15,
		-0.35/2-0.035,	3*b/4+0.35/2,		15,
		0,				3*b/4-0.035,		-1

return


66:				! NLD 16
	if lod3D = 5 then
		thk		= gs_frame_thk
		thk2	= gs_frame_thk
		thk3	= gs_frame_thk
		modZ	= gs_frame_thk
		modZ2	= 0
		modZ3	= gs_frame_thk+0.038
	else
		thk		= gs_leaf_thk
		thk2	= gs_leaf_thk - 0.003
		thk3	= 0.02
		modZ	= gs_leaf_thk
		modZ2	= bk/2 - 0.02/2 + gs_leaf_thk/2
		modZ3	= gs_leaf_thk + 0.038
	endif

	MULX	A/0.83
	MULY	B/2.115
	ADDX -10.734
	ADDY  20.3664

	material gs_leaf_mat
	addz modZ
	mulz -1

	PRISM_ 5,thk,
		10.319,     -20.3664,     15,
		10.459,     -20.3664,     15,
		10.459,     -18.2514,     15,
		10.319,     -18.2514,     15,
		10.319,     -20.3664,     -1

	PRISM_ 5,thk,
		11.009,     -20.3664,     15,
		11.149,     -20.3664,     15,
		11.149,     -18.2514,     15,
		11.009,     -18.2514,     15,
		11.009,     -20.3664,     -1

	PRISM_ 5,thk,
		10.459,     -18.3914,     15,
		11.009,     -18.3914,     15,
		11.009,     -18.2514,     15,
		10.459,     -18.2514,     15,
		10.459,     -18.3914,     -1

	PRISM_ 5,thk2,
		10.897,     -20.0924,     15,
		10.791,     -20.0924,     15,
		10.791,     -19.1914,     15,
		10.897,     -19.1914,     15,
		10.897,     -20.0924,     -1

	PRISM_ 5,thk,
		11.009,     -20.3664,     15,
		10.459,     -20.3664,     15,
		10.459,     -20.0924,     15,
		11.009,     -20.0924,     15,
		11.009,     -20.3664,     -1

	ADDZ  modZ2
	body -1

	cPRISM_ gs_glass_mat,gs_glass_mat,gs_glass_mat,
		5,     thk3,
		11.009,     -18.9111,     15,
		10.459,     -18.9111,     15,
		10.459,     -18.3914,     15,
		11.009,     -18.3914,     15,
		11.009,     -18.9111,     -1
	body -1
	DEL 1

	PRISM_ 5,thk,
		11.009,     -19.1914,     15,
		10.459,     -19.1914,     15,
		10.459,     -18.9111,     15,
		11.009,     -18.9111,     15,
		11.009,     -19.1914,     -1

	PRISM_ 5,thk2,
		10.567,     -20.0924,     15,
		10.463,     -20.0924,     15,
		10.463,     -19.1914,     15,
		10.567,     -19.1914,     15,
		10.567,     -20.0924,     -1

	PRISM_ 5,thk2,
		10.677,     -20.0924,     15,
		10.571,     -20.0924,     15,
		10.571,     -19.1914,     15,
		10.677,     -19.1914,     15,
		10.677,     -20.0924,     -1

	PRISM_ 5,thk2,
		10.787,     -20.0924,     15,
		10.681,     -20.0924,     15,
		10.681,     -19.1914,     15,
		10.787,     -19.1914,     15,
		10.787,     -20.0924,     -1

	PRISM_ 5,thk2,
		11.005,     -20.0924,     15,
		10.901,     -20.0924,     15,
		10.901,     -19.1914,     15,
		11.005,     -19.1914,     15,
		11.005,     -20.0924,     -1

	PRISM_ 5,thk3,
		10.459,     -19.1914,     15,
		10.463,     -19.1914,     15,
		10.463,     -20.0924,     15,
		10.459,     -20.0924,     15,
		10.459,     -19.1914,     -1

	PRISM_ 5,thk3,
		10.567,     -19.1914,     15,
		10.571,     -19.1914,     15,
		10.571,     -20.0924,     15,
		10.567,     -20.0924,     15,
		10.567,     -19.1914,     -1

	PRISM_ 5,thk3,
		10.677,     -19.1914,     15,
		10.681,     -19.1914,     15,
		10.681,     -20.0924,     15,
		10.677,     -20.0924,     15,
		10.677,     -19.1914,     -1

	PRISM_ 5,thk3,
		10.787,     -19.1914,     15,
		10.791,     -19.1914,     15,
		10.791,     -20.0924,     15,
		10.787,     -20.0924,     15,
		10.787,     -19.1914,     -1

	PRISM_ 5,thk3,
		10.897,     -19.1914,     15,
		10.901,     -19.1914,     15,
		10.901,     -20.0924,     15,
		10.897,     -20.0924,     15,
		10.897,     -19.1914,     -1

	PRISM_ 5,thk3,
		11.005,     -19.1914,     15,
		11.009,     -19.1914,     15,
		11.009,     -20.0924,     15,
		11.005,     -20.0924,     15,
		11.005,     -19.1914,     -1

	if lod3D <> 5 then
		ADDZ modZ3

		MASS	 "DEFAULT", "DEFAULT", "DEFAULT",
			7,      0,    117,    -0.038,
			10.329,     -20.3664,     0.0,     15,
			11.139,     -20.3664,     0.0,     15,
			11.139,     -20.3355,     0.0,     13,
			11.139,     -20.3149,    -0.03,     15,
			10.329,     -20.3149,    -0.03,     15,
			10.329,     -20.3355,     0.0,     13,
			10.329,     -20.3664,     0.0,     -1

		MASS	 "DEFAULT", "DEFAULT", "DEFAULT",
			7,      0,    117,    -0.038,
			10.319,     -19.0514,     0.0,     15,
			11.149,     -19.0514,     0.0,     15,
			11.149,     -19.0205,     0.0,     13,
			11.149,     -18.9999,    -0.03,     15,
			10.319,     -18.9999,    -0.03,     15,
			10.319,     -19.0205,     0.0,     13,
			10.319,     -19.0514,     0.0,     -1

		DEL 1
	endif
	del 6
return


67:				! NLD 17
	if lod3D = 5 then
		thk		= gs_frame_thk
		thk2	= gs_frame_thk
		modZ	= gs_frame_thk
		modZ2	= 0
	else
		thk		= gs_leaf_thk
		thk2	= gs_leaf_thk / 2
		modZ	= gs_leaf_thk
		modZ2	= gs_leaf_thk / 4
	endif
	resol 4*res
	material gs_leaf_mat
	ADDZ modZ
	mulz -1
	addx -A/2

	for loopi = 1 to 2
		prism_ 7, thk,
			0,		0, 			15,
			A/6,	0,			8,
			A/6,	B/2+B/8,	15,
			A/6,	B-B/8,		10,
			A/6,	B,			13,
			0,		B,			15,
			0,		0,			-1
		addx A
		mulx -1
	next loopi
	del 4

	prism_ 5, thk,
		A/6,	0,		15,
		A-A/6,	0,		10,
		A-A/6,	B/8,	15,
		A/6,	B/8,	10,
		A/6,	0,		-1

	addy B/2
	prism_ 5, thk,
		A/6,	0,		15,
		A-A/6,	0,		10,
		A-A/6,	B/8,	15,
		A/6,	B/8,	10,
		A/6,	0,		-1
	del 1

	addy B - B/8
	prism_ 6, thk,
		A/6,	0,		13,
		A/2,	-B/2,	900,
		A-A/6,	0,		3008,
		A-A/6,	B/8,	13,
		A/6,	B/8,	8,
		A/6,	0,		-1
	del 1

	addx A/6
	prism_ 5, thk,
		0,		B/8, 15,
		0.002,	B/8, 15,
		0.002,	B/2, 15,
		0,		B/2, 15,
		0,		B/8, -1
	del 1

	for loopi = 1 to 4
		addx A/6

		prism_ 5, thk ,
			0 + 0.002,		B/8, 15,
			A/6 - 0.002,	B/8, 15,
			A/6 - 0.002,	B/2, 15,
			0 + 0.002,		B/2, 15,
			0 + 0.002,		B/8, -1

		addx A/6
		if loopi < 4 then
			prism_ 5,thk,
				-0.002,	B/8, 15,
				0.002,	B/8, 15,
				0.002,	B/2, 15,
				-0.002,	B/2, 15,
				-0.002,	B/8, -1
		else
			prism_ 5, thk,
				-0.002,	B/8, 15,
				0,		B/8, 15,
				0,		B/2, 15,
				-0.002,	B/2, 15,
				-0.002,	B/8, -1
		endif
		del 1
	next loopi
	del 4

	roty -90
	add modZ,0,-A + 0.02
	if lod3D <> 5 then
		for loopi = 1 to 2
			prism_ 6, A - 0.04,
				0,		0,		15,
				0,		0.05,	15,
				0.01,	0.05,	15,
				0.04,	0.03,	15,
				0.04,	0,		15,
				0,		0,		-1

			addy b/2 + b/16
		next loopi
		del 2
	endif
	del 2

	BODY -1

	material gs_glass_mat
	addz modZ2
	addy B/2 + B/8
	prism_ 6, thk2,
		A/6,	B/4,		79,
		A/2,	B/4-B/2,	979,
		A-A/6,	B/4,		3079,
		A-A/6,	0,	79,
		A/6,	0,	79,
		A/6,	B/4,		-1
	del 2

	BODY -1
	del 3
	resol res
return


68:				! NLD 18
	if lod3D = 5 then
		thk		= gs_frame_thk
		thk2	= gs_frame_thk
		thk3	= gs_frame_thk
		modZ	= 0
		modZ2	= gs_frame_thk
		modZ3	= 0
	else
		thk		= gs_leaf_thk
		thk2	= 0.04
		thk3	= 0.007
		modZ	= 0.0125
		modZ2	= gs_leaf_thk
		modZ3	= gs_leaf_thk/2 - 0.007/2
	endif

	material gs_leaf_mat
	dx=(a-2*(0.13)-0.05*2)/3

	prism_  35, thk,
		-a/2, 0, 15,
		 a/2, 0, 15,
		 a/2, b-tsz, 15,
		-a/2, b-tsz, 15,
		-a/2, 0, -1,

		-a/2+0.13, 0.31, 15,
		-a/2+0.13+dx, 0.31, 15,
		-a/2+0.13+dx, 0.81, 15,
		-a/2+0.13, 0.81, 15,
		-a/2+0.13, 0.31, -1,

		-a/2+0.13+0.05+dx, 0.31, 15,
		-a/2+0.13+0.05+2*dx, 0.31, 15,
		-a/2+0.13+0.05+2*dx, 0.81, 15,
		-a/2+0.13+0.05+dx, 0.81, 15,
		-a/2+0.13+0.05+dx, 0.31, -1,

		-a/2+0.13+(0.05+dx)*2, 0.31, 15,
		-a/2+0.13+2*0.05+3*dx, 0.31, 15,
		-a/2+0.13+2*0.05+3*dx, 0.81, 15,
		-a/2+0.13+2*0.05+2*dx, 0.81, 15,
		-a/2+0.13+2*0.05+2*dx, 0.31, -1,

		-a/2+0.13, 0.96, 15,
		-a/2+0.13+dx, 0.96, 15,
		-a/2+0.13+dx, b-0.13, 15,
		-a/2+0.13, b-0.13, 15,
		-a/2+0.13, 0.96, -1,

		-a/2+0.13+0.05+dx, 0.96, 15,
		-a/2+0.13+0.05+2*dx, 0.96, 15,
		-a/2+0.13+0.05+2*dx, b-0.13, 15,
		-a/2+0.13+0.05+dx, b-0.13, 15,
		-a/2+0.13+0.05+dx, 0.96, -1,

		-a/2+0.13+(0.05+dx)*2, 0.96, 15,
		-a/2+0.13+2*0.05+3*dx, 0.96, 15,
		-a/2+0.13+2*0.05+3*dx, b-0.13, 15,
		-a/2+0.13+2*0.05+2*dx, b-0.13, 15,
		-a/2+0.13+2*0.05+2*dx, 0.96, -1

	addz modZ

	prism_ 10, thk2,
		-a/2+0.13, 0.31, 15,
		-a/2+0.13+dx, 0.31, 15,
		-a/2+0.13+dx, 0.81, 15,
		-a/2+0.13, 0.81, 15,
		-a/2+0.13, 0.31, -1,

		-a/2+0.165, 0.345, 15,
		-a/2+0.095+dx, 0.345, 15,
		-a/2+0.095+dx, 0.775, 15,
		-a/2+0.165, 0.775, 15,
		-a/2+0.165, 0.345, -1

	prism_ 10, thk2,
		-a/2+0.13+0.05+dx, 0.31, 15,
		-a/2+0.13+0.05+2*dx, 0.31, 15,
		-a/2+0.13+0.05+2*dx, 0.81, 15,
		-a/2+0.13+0.05+dx, 0.81, 15,
		-a/2+0.13+0.05+dx, 0.31, -1,

		-a/2+0.13+0.085+dx, 0.345, 15,
		-a/2+0.13+0.015+2*dx, 0.345, 15,
		-a/2+0.13+0.0155+2*dx, 0.775, 15,
		-a/2+0.13+0.085+dx, 0.775, 15,
		-a/2+0.13+0.085+dx, 0.345, -1

	prism_ 10, thk2,
		-a/2+0.13+(0.05+dx)*2, 0.31, 15,
		-a/2+0.13+2*0.05+3*dx, 0.31, 15,
		-a/2+0.13+2*0.05+3*dx, 0.81, 15,
		-a/2+0.13+2*0.05+2*dx, 0.81, 15,
		-a/2+0.13+2*0.05+2*dx, 0.31, -1,

		-a/2+0.165+(0.05+dx)*2, 0.345, 15,
		-a/2+0.095+2*0.05+3*dx, 0.345, 15,
		-a/2+0.095+2*0.05+3*dx, 0.775, 15,
		-a/2+0.165+2*0.05+2*dx, 0.775, 15,
		-a/2+0.165+2*0.05+2*dx, 0.345, -1

	del 1

	prism_ 5, thk,
		-a/2+0.165, 0.345, 15,
		-a/2+0.095+dx, 0.345, 15,
		-a/2+0.095+dx, 0.775, 15,
		-a/2+0.165, 0.775, 15,
		-a/2+0.165, 0.345, -1

	prism_ 5, thk,
		-a/2+0.13+0.085+dx, 0.345, 15,
		-a/2+0.13+0.015+2*dx, 0.345, 15,
		-a/2+0.13+0.0155+2*dx, 0.775, 15,
		-a/2+0.13+0.085+dx, 0.775, 15,
		-a/2+0.13+0.085+dx, 0.345, -1

	prism_ 5, thk,
		-a/2+0.165+(0.05+dx)*2, 0.345, 15,
		-a/2+0.095+2*0.05+3*dx, 0.345, 15,
		-a/2+0.095+2*0.05+3*dx, 0.775, 15,
		-a/2+0.165+2*0.05+2*dx, 0.775, 15,
		-a/2+0.165+2*0.05+2*dx, 0.345, -1

	addz modZ2
	addx a/2
	addy 0.01
	roty -90
	rotz 90

	prism_ 5, a,
		  0, 0, 15,
		  0.07, 0, 15,
		  0.07, -0.005, 15,
		  0.05, -0.02, 15,
		  0, -0.02, 15

	del 5

	BODY -1
	addz modZ3
	material gs_glass_mat

	prism_ 5, thk3,
		-a/2+0.13, 0.96, 15,
		-a/2+0.13+dx, 0.96, 15,
		-a/2+0.13+dx, b-0.13, 15,
		-a/2+0.13, b-0.13, 15,
		-a/2+0.13, 0.96, -1

	prism_ 5, thk3,
		-a/2+0.13+0.05+dx, 0.96, 15,
		-a/2+0.13+0.05+2*dx, 0.96, 15,
		-a/2+0.13+0.05+2*dx, b-0.13, 15,
		-a/2+0.13+0.05+dx, b-0.13, 15,
		-a/2+0.13+0.05+dx, 0.96, -1

	prism_ 5, thk3,
		-a/2+0.13+(0.05+dx)*2, 0.96, 15,
		-a/2+0.13+2*0.05+3*dx, 0.96, 15,
		-a/2+0.13+2*0.05+3*dx, b-0.13, 15,
		-a/2+0.13+2*0.05+2*dx, b-0., 15,
		-a/2+0.13+2*0.05+2*dx, 0.96, -1

	BODY -1
	del 1
return


69:				! NLD 19
	if lod3D = 5 then
		thk		= gs_frame_thk
		thk2	= gs_frame_thk
		modZ	= 0
		modZ2	= gs_frame_thk
	else
		thk		= gs_leaf_thk
		thk2	=  gs_leaf_thk + 0.01
		modZ	= -0.005
		modZ2	= gs_leaf_thk
	endif

	material gs_leaf_mat

	kx = -a/2+0.13
	ky = 0.31

	dx = (a-0.26-0.03)/2
	dy = (b-ky-0.13-0.06)/3

	for iy = 1 to 3 step 1
		for ix = 1 to 2 step 1
			 put kx, ky, 15,
				 kx+dx, ky, 15,
				 kx+dx, ky+dy, 15,
				 kx, ky+dy, 15,
				 kx, ky, -1

			kx = kx+dx+0.03
		next ix

		kx = -a/2+0.13
		ky = ky+dy+0.03

	next iy

	kx = -a/2+0.13
	ky = 0.31

	for iy = 1 to 3 step 1
		for ix = 1 to 2 step 1

			put kx, ky, 15,
				kx+dx, ky, 15,
				kx+dx, ky+dy, 15,
				kx, ky+dy, 15,
				kx, ky, -1

			put kx+0.015, ky+0.015, 15,
				kx+dx-0.015, ky+0.015, 15,
				kx+dx-0.015, ky+dy-0.015, 15,
				kx+0.015, ky+dy-0.015, 15,
				kx+0.015, ky+0.015, -1

			put kx+0.05, ky+0.05, 15,
				kx+dx-0.05, ky+0.05, 15,
				kx+dx-0.05, ky+dy-0.05, 15,
				kx+0.05, ky+dy-0.05, 15,
				kx+0.05, ky+0.05, -1

			put kx+0.065, ky+0.065, 15,
				kx+dx-0.065, ky+0.065, 15,
				kx+dx-0.065, ky+dy-0.065, 15,
				kx+0.065, ky+dy-0.065, 15,
				kx+0.065, ky+0.065, -1

			kx = kx+dx+0.03

		 next ix

		 kx = -a/2+0.13
		 ky = ky+dy+0.03

	next iy

	prism_ 5+30, thk,
		-a/2, 0, 15,
		 a/2, 0, 15,
		 a/2, b, 15,
		-a/2, b, 15,
		-a/2, 0, -1,

		get (90)

	for ii = 1 to 6 step 1

		addz modZ
		prism_ 10, thk2,
			get (15),
			use (15)
		del 1

		prism_ 10, thk,
			get (15),
			use (15)

		addz modZ
		prism_ 10, thk2,
			get (15),
			use (15)
		del 1

		prism_ 5, thk,
			get (15)

	next ii

	addz modZ2
	addx a/2
	addy 0.01
	roty -90
	rotz 90

	prism_ 5, a,
		0, 0, 15,
		0.07, 0, 15,
		0.07, -0.005, 15,
		0.05, -0.02, 15,
		0, -0.02, 15

	del 5
return


70:				! NLD 20
	if lod3D = 5 then
		thk		= gs_frame_thk
		thk2	= gs_frame_thk
		thk3	= gs_frame_thk
		modZ	= 0
		modZ2	= gs_frame_thk
		modZ3	= 0
	else
		thk		= gs_leaf_thk
		thk2	= 0.045
		thk3	= 0.007
		modZ	= gs_leaf_thk/2 - 0.045/2
		modZ2	= gs_leaf_thk
		modZ3	= (gs_leaf_thk - 0.007)/2
	endif

	material gs_leaf_mat

	kx = -a/2+0.13
	ky = 0.31

	dx = (a-0.13*2-0.05)/2
	dy = (b-0.31-0.13-4*0.05)/4

	for iy = 1 to 3 step 1
		for ix = 1 to 2 step 1
			 put kx, ky, 15,
				 kx+dx, ky, 15,
				 kx+dx, ky+dy, 15,
				 kx, ky+dy, 15,
				 kx, ky, -1

			kx = kx+dx+0.05
		next ix

		kx = -a/2+0.13
		ky = ky+dy+0.05

	next iy

	kx = -a/2+0.13
	ky = 0.31

	for iy = 1 to 3 step 1
		for ix = 1 to 2 step 1
		   put  kx, ky, 15,
				kx+dx, ky, 15,
				kx+dx, ky+dy, 15,
				kx, ky+dy, 15,
				kx, ky, -1

		   put  kx+0.035, ky+0.035, 15,
				kx+dx-0.035, ky+0.035, 15,
				kx+dx-0.035, ky+dy-0.035, 15,
				kx+0.035, ky+dy-0.035, 15,
				kx+0.035, ky+0.035, -1

			kx = kx+dx+0.05

		 next ix

		 kx = -a/2+0.13
		 ky = ky+dy+0.05

	next iy

	prism_ 15+30, thk,
		-a/2, 0, 15,
		 a/2, 0, 15,
		 a/2, b, 15,
		-a/2, b, 15,
		-a/2, 0, -1,

		-a/2+0.13, b-0.13-dy, 15,
		-0.025, b-0.13-dy, 15,
		-0.025, b-0.13, 15,
		-a/2+0.13, b-0.13, 15,
		-a/2+0.13, b-0.13-dy, -1,

		a/2-0.13, b-0.13-dy, 15,
		0.025, b-0.13-dy, 15,
		0.025, b-0.13, 15,
		a/2-0.13, b-0.13, 15,
		a/2-0.13, b-0.13-dy, -1,

		get (90)

	for ii = 1 to 6 step 1
		addz modZ
		prism_ 10, thk2,
			get (15),
			use (15)

		del 1

		prism_ 5, thk,
			get (15)
	next ii

	add a/2, 0.01, modZ2
	roty -90
	rotz 90

	prism_   5, a,
		  0, 0, 15,
		  0.07, 0, 15,
		  0.07, -0.005, 15,
		  0.05, -0.02, 15,
		  0, -0.02, 15
	del 3

	BODY -1
	material gs_glass_mat
	addz modZ3

	prism_   5, thk3,
		-a/2+0.13, b-0.13-dy, 15,
		-0.025, b-0.13-dy, 15,
		-0.025, b-0.13, 15,
		-a/2+0.13, b-0.13, 15,
		-a/2+0.13, b-0.13-dy, -1

	prism_   5, thk3,
		 a/2-0.13, b-0.13-dy, 15,
		 0.025, b-0.13-dy, 15,
		 0.025, b-0.13, 15,
		 a/2-0.13, b-0.13, 15,
		 a/2-0.13, b-0.13-dy, -1

	BODY -1
	del 1
return


71:				! NLD 21
	if lod3D = 5 then
		thk		= gs_frame_thk
		thk2	= gs_frame_thk
		modZ	= 0
		modZ2	= gs_frame_thk
		modZ3	= 0
	else
		thk		= gs_leaf_thk
		thk2	= 0.007
		modZ	= 0.0125
		modZ2	= gs_leaf_thk
		modZ3	= 0.063/2
	endif

	material gs_leaf_mat

	addz modZ

	prism_ 10, thk,
		-a/2+0.13, 0.31, 15,
		a/2-0.13, 0.31, 15,
		a/2-0.13, 0.81, 15,
		-a/2+0.13, 0.81, 15,
		-a/2+0.13, 0.31, -1,

		-a/2+0.165, 0.345, 15,
		a/2-0.165, 0.345, 15,
		a/2-0.165, 0.775, 15,
		-a/2+0.165, 0.775, 15,
		-a/2+0.165, 0.345, -1

	del 1

	prism_ 5, thk,
		-a/2+0.165, 0.345, 15,
		a/2-0.165, 0.345, 15,
		a/2-0.165, 0.775, 15,
		-a/2+0.165, 0.775, 15,
		-a/2+0.165, 0.345, -1

	kx = -a/2+0.13
	ky = 0.96

	dx = (a-0.13*2-0.03) / 2
	dy = (b-0.96-0.16-0.03) / 2

	for iy = 1 to 2 step 1
		for ix = 1 to 2 step 1
			put kx, ky, 15,
				kx+dx, ky, 15,
				kx+dx, ky+dy, 15,
				kx, ky+dy, 15,
				kx, ky, -1

			kx = kx+dx+0.03

		next ix

		kx = -a/2+0.13
		ky = ky+dy+0.03

	next iy

	prism_ 10+nsp/3, thk,
		-a/2, 0, 15,
		a/2, 0, 15,
		a/2, b, 15,
		-a/2, b, 15,
		-a/2, 0, -1,

		-a/2+0.13, 0.31, 15,
		a/2-0.13, 0.31, 15,
		a/2-0.13, 0.81, 15,
		-a/2+0.13, 0.81, 15,
		-a/2+0.13, 0.31, -1,

		use (nsp)

	add a/2, 0.01, modZ2
	roty -90
	rotz 90

	prism_   5, a,
		0, 0, 15,
		0.07, 0, 15,
		0.07, -0.005, 15,
		0.05, -0.02, 15,
		0, -0.02, 15

	del 3

	BODY -1
	material gs_glass_mat
	addz modZ3

	for ii = 1 to 2*2 step 1
		prism_ 5, thk2,
			get (15)
	next ii

	BODY -1
	del 1
return


72:				! NLD 22
	if lod3D = 5 then
		thk		= gs_frame_thk
		thk2	= gs_frame_thk
		thk3	= gs_frame_thk
		thk4	= gs_frame_thk
		modZ	= 0
		modZ2	= 0
		modZ3	= gs_frame_thk
		modZ4	= 0
		modZ5	= 0
	else
		thk		= gs_leaf_thk+0.01
		thk2	= 0.045
		thk3	= gs_leaf_thk
		thk4	= 0.007
		modZ	= -0.005
		modZ2	= (gs_leaf_thk-0.045)/2
		modZ3	= gs_leaf_thk
		modZ4	= 0.005+gs_leaf_thk/2-0.007/2
		modZ5	= gs_leaf_thk/2-0.007/2
	endif

	material gs_leaf_mat

	R=(0.055^2+(a/2-0.13)^2)/0.11
	R1=R-0.015

	resol 4*res

	addz modZ

	prism_ 10, thk,
		-a/2+0.13, 0.31, 15,
		 a/2-0.13, 0.31, 15,
		 a/2-0.13, 0.81, 15,
		-a/2+0.13, 0.81, 15,
		-a/2+0.13, 0.31, -1,

		-a/2+0.145, 0.325, 15,
		 a/2-0.145, 0.325, 15,
		 a/2-0.145, 0.795, 15,
		-a/2+0.145, 0.795, 15,
		-a/2+0.145, 0.325, -1

	del 1

	addz modZ2

	prism_ 10, thk2,
		-a/2+tsz+0.145, 0.325, 15,
		 a/2-0.145, 0.325, 15,
		 a/2-0.145, 0.795, 15,
		-a/2+0.145, 0.795, 15,
		-a/2+0.145, 0.325, -1,

		-a/2+0.18, 0.36, 15,
		 a/2-0.18, 0.36, 15,
		 a/2-0.18, 0.76, 15,
		-a/2+0.18, 0.76, 15,
		-a/2+0.18, 0.36, -1

	del 1

	prism_ 5, thk3,
		-a/2+0.18, 0.36, 15,
		 a/2-0.18, 0.36, 15,
		 a/2-0.18, 0.76, 15,
		-a/2+0.18, 0.76, 15,
		-a/2+0.18, 0.36, -1

	kx = -a/2+0.13
	ky = 0.96

	dx = (a-0.13*2-0.03)/2
	dy = (b-0.96-0.16-0.03)/2

	for ix = 1 to 2 step 1
		put kx, ky, 15,
				kx+dx, ky, 15,
				kx+dx, ky+dy, 15,
				kx, ky+dy, 15,
				kx, ky, -1

		kx = kx+dx+0.03
	next ix

	kx = -a/2+0.13

	for ix = 1 to 2 step 1

			put kx, ky, 15,
				kx+dx, ky, 15,
				kx+dx, ky+dy, 15,
				kx, ky+dy, 15,
				kx, ky, -1

			put kx+0.015, ky+0.015, 15,
				kx+dx-0.015, ky+0.015, 15,
				kx+dx-0.015, ky+dy-0.015, 15,
				kx+0.015, ky+dy-0.015, 15,
				kx+0.015, ky+0.015, -1

		kx = kx+dx+0.03
	next ix

	prism_ 22+10, thk3,
		-a/2, 0, 15,
		 a/2, 0, 15,
		 a/2, b, 15,
		-a/2, b, 15,
		-a/2, 0, -1,

		-a/2+0.13, 0.31, 15,
		 a/2-0.13, 0.31, 15,
		 a/2-0.13, 0.81, 15,
		-a/2+0.13, 0.81, 15,
		-a/2+0.13, 0.31, -1,

		-a/2+0.13, 0.96+dy+0.03, 15,
		-0.015, 0.96+dy+0.03, 15,
		-0.015, b-0.13-R+(R*cos(ASN(0.015/R))), 79,
		 0, b-0.13-R, 900,
		-a/2+0.13, b-0.13-R+(R*cos(ASN((a/2-0.13)/R))), 3079,
		-a/2+0.13, 0.96+dy+0.03, -1,

		a/2-0.13, 0.96+dy+0.03, 15,
		0.015, 0.96+dy+0.03, 15,
		0.015, b-0.13-R+(R*cos(ASN(0.015/R))), 79,
		0, b-0.13-R, 900,
		a/2-0.13, b-0.13-R+(R*cos(ASN((a/2-0.13)/R))), 3079,
		a/2-0.13, 0.96+dy+0.03, -1,

		get (30)

	add a/2, 0.01, modZ3
	roty -90
	rotz 90

	prism_   5, a,
		0, 0, 15,
		0.07, 0, 15,
		0.07, -0.005, 15,
		0.05, -0.02, 15,
		0, -0.02, 15

	del 3
	addz modZ

	prism_ 12, thk,
		a/2-0.13, 0.96+dy+0.03, 15,
		0.015, 0.96+dy+0.03, 15,
		0.015, b-0.13-R+(R*cos(ASN(0.015/R))), 79,
		0, b-0.13-R, 900,
		a/2-0.13, b-0.13-R+(R*cos(ASN((a/2-0.13)/R))), 3079,
		a/2-0.13, 0.96+dy+0.03, -1,

		a/2-0.145, 0.96+dy+0.045, 15,
		0.03, 0.96+dy+0.045, 15,
		0.03, b-0.13-R+(R1*cos(ASN(0.03/R1))), 79,
		0, b-0.13-R, 900,
		a/2-0.145, b-0.13-R+(R1*cos(ASN((a/2-0.145)/R1))), 3079,
		a/2-0.145, 0.96+dy+0.045, -1

	prism_ 12, thk,
		-a/2+0.13, 0.96+dy+0.03, 15,
		-0.015, 0.96+dy+0.03, 15,
		-0.015, b-0.13-R+(R*cos(ASN(0.015/R))), 79,
		0, b-0.13-R, 900,
		-a/2+0.13, b-0.13-R+(R*cos(ASN((a/2-0.13)/R))), 3079,
		-a/2+0.13, 0.96+dy+0.03, -1,

		-a/2+0.145, 0.96+dy+0.045, 15,
		-0.03, 0.96+dy+0.045, 15,
		-0.03, b-0.13-R+(R1*cos(ASN(0.03/R1))), 79,
		0, b-0.13-R, 900,
		-a/2+0.145, b-0.13-R+(R1*cos(ASN((a/2-0.145)/R1))), 3079,
		-a/2+0.145, 0.96+dy+0.045, -1

	addz modZ4

	BODY -1
	material gs_glass_mat

	prism_ 6, thk4,
		-a/2+0.145, 0.96+dy+0.045, 15,
		-0.03, 0.96+dy+0.045, 15,
		-0.03, b-0.13-R+(R1*cos(ASN(0.03/R1))), 79,
		 0, b-0.13-R, 900,
		-a/2+0.145, b-0.13-R+(R1*cos(ASN((a/2-0.145)/R1))), 3079,
		-a/2+0.145, 0.96+dy+0.045, -1

	prism_ 6, thk4,
		a/2-0.145, 0.96+dy+0.045, 15,
		0.03, 0.96+dy+0.045, 15,
		0.03, b-0.13-R+(R1*cos(ASN(0.03/R1))), 79,
		0, b-0.13-R, 900,
		a/2-0.145, b-0.13-R+(R1*cos(ASN((a/2-0.145)/R1))), 3079,
		a/2-0.145, 0.96+dy+0.045, -1

	del 1

	BODY -1

	for ii = 1 to 2 step 1
		material gs_leaf_mat
		prism_ 10, thk,
			get (15),
			use (15)
		addz modZ5
		BODY -1

		material gs_glass_mat
		prism_ 5, thk4,
			get (15)
		del 1
		BODY -1
	next ii

	del 1
	resol res
return


73:				! NLD 23
	if lod3D = 5 then
		thk		= gs_frame_thk
		thk2	= gs_frame_thk
		modZ	= 0
		modZ2	= gs_frame_thk
	else
		thk		= gs_leaf_thk
		thk2	= 0.045
		modZ	= gs_leaf_thk/2 - 0.045/2
		modZ2	= gs_leaf_thk
	endif
	material gs_leaf_mat

	prism_ 15, thk,
		-a/2, 0, 15,
		 a/2, 0, 15,
		 a/2, b, 15,
		-a/2, b, 15,
		-a/2, 0, -1,

		-a/2+0.13, 0.31, 15,
		 a/2-0.13, 0.31, 15,
		 a/2-0.13, 0.81, 15,
		-a/2+0.13, 0.81, 15,
		-a/2+0.13, 0.31, -1,

		-a/2+0.13, 0.96, 15,
		 a/2-0.13, 0.96, 15,
		 a/2-0.13, b-0.13, 15,
		-a/2+0.13, b-0.13, 15,
		-a/2+0.13, 0.96, -1

	addz modZ
	resol 4*res

	prism_ 19, thk2,
		-a/2+0.13, 0.31, 15,
		 a/2-0.13, 0.31, 15,
		 a/2-0.13, 0.81, 15,
		-a/2+0.13, 0.81, 15,
		-a/2+0.13, 0.31, -1,

		 0, 0.345, 15,
		 a/2-0.2, 0.345, 79,
		 a/2-0.13, 0.31, 900,
		 a/2-0.165, 0.38, 3079,
		 a/2-0.165, 0.74, 79,
		 a/2-0.13, 0.81, 900,
		 a/2-0.2, 0.775, 3079,
		-a/2+0.2, 0.775, 79,
		-a/2+0.13, 0.81, 900,
		-a/2+0.165, 0.74, 3079,
		-a/2+0.165, 0.38, 79,
		-a/2+0.13, 0.31, 900,
		-a/2+0.2, 0.345, 3079,
		 0, 0.345, -1

	prism_ 19, thk2,
		-a/2+0.13, 0.96, 15,
		 a/2-0.13, 0.96, 15,
		 a/2-0.13, b-0.13, 15,
		-a/2+0.13, b-0.13, 15,
		-a/2+0.13, 0.96, -1,

		 0, 0.995, 15,
		 a/2-0.2, 0.995, 79,
		 a/2-0.13, 0.96, 900,
		 a/2-0.165, 1.03, 3079,
		 a/2-0.165, b-0.2, 79,
		 a/2-0.13, b-0.13, 900,
		 a/2-0.2, b-0.165, 3079,
		-a/2+0.2, b-0.165, 79,
		-a/2+0.13, b-0.13, 900,
		-a/2+0.165, b-0.2, 3079,
		-a/2+0.165, 1.03, 79,
		-a/2+0.13, 0.96, 900,
		-a/2+0.2, 0.995, 3079,
		 0, 0.995, -1

	del 1

	prism_ 14, thk,
		 0, 0.345, 15,
		 a/2-0.2, 0.345, 79,
		 a/2-0.13, 0.31, 900,
		 a/2-0.165, 0.38, 3079,
		 a/2-0.165, 0.74, 79,
		 a/2-0.13, 0.81, 900,
		 a/2-0.2, 0.775, 3079,
		-a/2+0.2, 0.775, 79,
		-a/2+0.13, 0.81, 900,
		-a/2+0.165, 0.74, 3079,
		-a/2+0.165, 0.38, 79,
		-a/2+0.13, 0.31, 900,
		-a/2+0.2, 0.345, 3079,
		 0, 0.345, -1

	prism_ 14, thk,
		 0, 0.995, 15,
		 a/2-0.2, 0.995, 79,
		 a/2-0.13, 0.96, 900,
		 a/2-0.165, 1.03, 3079,
		 a/2-0.165, b-0.2, 79,
		 a/2-0.13, b-0.13, 900,
		 a/2-0.2, b-0.165, 3079,
		-a/2+0.2, b-0.165, 79,
		-a/2+0.13, b-0.13, 900,
		-a/2+0.165, b-0.2, 3079,
		-a/2+0.165, 1.03, 79,
		-a/2+0.13, 0.96, 900,
		-a/2+0.2, 0.995, 3079,
		 0, 0.995, -1

	add a/2, 0.01, modZ2
	roty -90
	rotz 90

	prism_   5, a,
		  0, 0, 15,
		  0.07, 0, 15,
		  0.07, -0.005, 15,
		  0.05, -0.02, 15,
		  0, -0.02, 15

	del 3
	resol res
return


74:				! NLD 24
	if lod3D = 5 then
		thk		= gs_frame_thk
		thk2	= gs_frame_thk
		thk3	= gs_frame_thk
		modZ	= 0
		modZ2	= 0
		modZ3	= gs_frame_thk
	else
		thk		= gs_leaf_thk
		thk2	= gs_leaf_thk + 0.01
		thk3	= 0.045
		modZ	= -0.005
		modZ2	= gs_leaf_thk/2 - 0.045/2
		modZ3	= gs_leaf_thk
	endif

	material gs_leaf_mat

	kx = -a/2+0.13
	ky = 0.31

	dx = (a-0.13*2-0.03)/2
	dy = (b-0.31-0.13-3*0.03)/4

	for iy = 1 to 4 step 1
		for ix = 1 to 2 step 1
			 put kx, ky, 15,
				 kx+dx, ky, 15,
				 kx+dx, ky+dy, 15,
				 kx, ky+dy, 15,
				 kx, ky, -1

			kx = kx+dx+0.03
		next ix

		kx = -a/2+0.13
		ky = ky+dy+0.03

	next iy

	kx = -a/2+0.13
	ky = 0.31

	for iy = 1 to 4 step 1
		for ix = 1 to 2 step 1

		   put  kx, ky, 15,
				kx+dx, ky, 15,
				kx+dx, ky+dy, 15,
				kx, ky+dy, 15,
				kx, ky, -1

		   put  kx+0.015, ky+0.015, 15,
				kx+dx-0.015, ky+0.015, 15,
				kx+dx-0.015, ky+dy-0.015, 15,
				kx+0.015, ky+dy-0.015, 15,
				kx+0.015, ky+0.015, -1

		   put  kx+0.05, ky+0.05, 15,
				kx+dx-0.05, ky+0.05, 15,
				kx+dx-0.05, ky+dy-0.05, 15,
				kx+0.05, ky+dy-0.05, 15,
				kx+0.05, ky+0.05, -1

			kx = kx+dx+0.03

		 next ix

		 kx = -a/2+0.13
		 ky = ky+dy+0.03

	next iy

	prism_ 5+40, thk,
		-a/2, 0, 15,
		 a/2, 0, 15,
		 a/2, b, 15,
		-a/2, b, 15,
		-a/2, 0, -1,

		get (120)

	for ii = 1 to 8 step 1

		addz modZ
		prism_ 10, thk2,
			get (15),
			use (15)

		del 1
		addz modZ2
		prism_ 10, thk3,
			get (15),
			use (15)

		del 1
		prism_ 5, thk,
			get (15)

	next ii

	add a/2, 0.01, modZ3
	roty -90
	rotz 90

	prism_   5, a,
		0, 0, 15,
		0.07, 0, 15,
		0.07, -0.005, 15,
		0.05, -0.02, 15,
		0, -0.02, 15

	del 3
return


75:				! NLD 25
	if lod3D = 5 then
		thk		= gs_frame_thk
		modZ	= 0
	else
		thk		= gs_leaf_thk
		thk2	= 0.01
		modZ	= (gs_leaf_thk - 0.01)/2
	endif

	addx -a/2

	material gs_leaf_mat

	prism_ 10,thk,
		0,0,15,
		0,b,15,
		a,b,15,
		a,0,15,
		0,0,-1,

		a-0.05,0.05,15,
		a-0.05,b-0.05,15,
		0.05,b-0.05,15,
		0.05,0.05,15,
		a-0.05,0.05,-1

	BODY -1
	material gs_glass_mat
	if bStorefrontDoor then
		sect_fill gs_gsect, gs_penGlass_bg, gs_penGlass_fg, gs_glass_pen_cont
	else
		sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_glass_pen_cont
	endif

	addz modZ

	prism_ 4,thk2,
		a-0.05,0.05,15,
		a-0.05,b-0.05,15,
		0.05,b-0.05,15,
		0.05,0.05,15

	BODY -1
	del 2
return


76:				! NOR 16 - Style 59
	win=0

	gosub "76-77"
return


77:				! NOR 17 - Style 60
	win=1

	gosub "76-77"
return


"76-77":
	addx -a/2

	a=a+0.138
	b=b+0.11

	dx=0.1

	material gs_leaf_mat1

	if gs_SashText_typ_num = 1 then

		base

		for ii=1 to nn

			gosub 900

			sprism_{2} topmat, botmat, sidemat,
				5,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				0,0,10, sidematedge,
				0.08,0.15,15, sidemat,
				0.08,B-0.22,10, sidemat,
				0,B-0.11,mmask, sidematedge,
				0,0,-1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				5,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				A-0.138,0,10, sidematedge,
				A-0.218,0.15,15, sidemat,
				A-0.218,B-0.22,10, sidemat,
				A-0.138,B-0.11,mmask, sidematedge,
				A-0.138,0,-1, sidematedge

			gosub 500

			sprism_{2} topmat, botmat, sidemat,
				5,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				0,B-0.11,10, sidematedge,
				0.08,B-0.22,15, sidemat,
				A-0.218,B-0.22,10, sidemat,
				A-0.138,B-0.11,mmask, sidematedge,
				0,B-0.11,-1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				5,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				0,0,10, sidematedge,
				0.08,0.15,15, sidematedge,
				A-0.218,0.15,10, sidemat,
				A-0.138,0,mmask, sidemat,
				0,0,-1, sidematedge

			gosub 600

			addz framethick

		next ii

		del nn

	endif


	if gs_SashText_typ_num = 2 then

		base

		for ii=1 to nn

			gosub 900

			sprism_{2} topmat, botmat, sidemat,
				5,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				0,0.15,8, sidematedge,
				0.08,0.15,15, sidemat,
				0.08,B-0.22,10, sidemat,
				0,B-0.22,13, sidematedge,
				0,0.15,-1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				5,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				A-0.138,0.15,8, sidematedge,
				A-0.218,0.15,15, sidemat,
				A-0.218,B-0.22,10, sidemat,
				A-0.138,B-0.22,mmask2, sidematedge,
				A-0.138,0.15,-1, sidematedge

			gosub 500

			sprism_{2} topmat, botmat, sidemat,
				7,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				0,B-0.11,15, sidematedge,
				0,B-0.22,8, sidematedge,
				0.08,B-0.22,15, sidemat,
				A-0.218,B-0.22,10, sidemat,
				A-0.138,B-0.22,mmask2, sidematedge,
				A-0.138,B-0.11,mmask, sidematedge,
				0,B-0.11,-1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				7,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				0,0,15, sidematedge,
				0,0.15,8, sidematedge,
				0.08,0.15,15, sidemat,
				A-0.218,0.15,10, sidemat,
				A-0.138,0.15,mmask2, sidematedge,
				A-0.138,0,mmask, sidematedge,
				0,0,-1, sidematedge

			gosub 600

			addz framethick

		next ii

		del nn

	endif

	wina=(dx*3+0.01*2)

	if win=1 then
		add (a-0.138)/2-0.005, 0.15+(dx+0.01)/sin(45)*7, gs_leaf_thk/2-(0.008*2+0.01+0.01*2)/2
		rotz -45
		add 0, 0.01*sin(45), 0

		material gs_leaf_mat2
		prism_ 10, 0.008*2+0.01+0.01*2,
			-wina, 0, 15,
			0, 0, 15,
			0, wina, 15,
			-wina, wina, 15,
			-wina, 0, -1,

			-wina+0.01, 0.01, 15,
			-0.01, 0.01, 15,
			-0.01, wina-0.01, 15,
			-wina+0.01, wina-0.01, 15,
			-wina+0.01, 0.01, -1

		addz (0.008*2+0.01+0.01*2)/2-0.005
		pen gs_glass_pen
		material gs_glass_mat
		prism_ 5, 0.01,
			-wina+0.01, 0.01, 15,
			-0.01, 0.01, 15,
			-0.01, wina-0.01, 15,
			-wina+0.01, wina-0.01, 15,
			-wina+0.01, 0.01, -1
		del 1

		pen gs_leaf_pen
		cutpolya 4,1,0,
			-wina, 0, 15,
			0, 0, 15,
			0, wina, 15,
			-wina, wina, 15

		del 3
	endif

	addz gs_leaf_thk/2-0.005

	material gs_leaf_mat3

	base

	prism_ 4,0.01,
	   0.08,0.15,15,
		(A-0.218),0.15,15,
		(A-0.218),b-0.22,15,
		0.08,b-0.22,15

	del 1
	body -1

	addy 0.15
	rotx 90

	cutplane

	del 2
	addy b-0.11-0.11
	rotx -90

	cutplane

	del 2
	addx 0.08
	roty -90

	cutplane

	del 2
	addx a-0.138-0.08
	roty 90

	cutplane

	del 2

	material gs_leaf_mat2

	if win=1 then
		add (a-0.138)/2-0.005, 0.15+(dx+0.01)/sin(45)*7, gs_leaf_thk/2-(0.008*2+0.01+0.01*2)/2
		rotz -45
		add 0, 0.01*sin(45), 0

		cutpolya 4,1,0,
			-wina, -0.01, 15,
			0.01, -0.01, 15,
			0.01, wina, 15,
			-wina, wina, 15

		del 3
	endif

	for tk=1 to 2

		addz gs_leaf_thk/2-0.008-0.005

		for i=1 to int(b/((dx+0.01)/sin(45)))+3
			add (a-0.138)/2-0.005, 0.15, 0
			rotz -45
			add 0, dx, 0
			prism_ 4,0.008,
				0,-dx,15,
				-dx,0,15,
				-dx,-a,15,
				0,-a,15
			del 3
			addy (dx+0.01)/sin(45)
		next i
		del int(b/((dx+0.01)/sin(45)))+3

		addz 0.008+0.01

		for i=1 to int(b/((dx+0.01)/sin(45)))+3
			add (a-0.138)/2-0.005, 0.15, 0
			rotz -45
			add 0, dx, 0
			prism_ 4,0.008,
				0,-dx,15,
				-dx,0,15,
				-dx,-a,15,
				0,-a,15
			del 3
			addy (dx+0.01)/sin(45)
		next i
		del int(b/((dx+0.01)/sin(45)))+3

		gosub 600

		body -1
		del 2

		addx a-0.138
		mulx -1
	next tk
	del 4

	if win=1 then
		cutend
		cutend
	endif

	cutend
	cutend
	cutend
	cutend

	del 1
return

! =============================================================================

1200:

for ii=1 to nn

	gosub 900

	if gs_SashText_typ_num = 1 then

		base

		sprism_{2} topmat, botmat, sidemat,
			9,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0,10, sidematedge,
			0.08,0.15,mmask, sidemat,
			0.08,0.73,10, sidemat,
			0.08,0.88,mmask, sidemat,
			0.08,B-0.3-((A-0.316)/2),10, sidemat,
			0.08,B-0.22-((A-0.316)/2),mmask, sidemat,
			0.08,B-0.22,10, sidemat,
			0,B-0.11,mmask, sidematedge,
			0,0,-1, sidematedge

		sprism_{2} topmat, botmat, sidemat,
			9,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			A-0.138,0,10, sidematedge,
			A-0.218,0.15,mmask, sidemat,
			A-0.218,0.73,10, sidemat,
			A-0.218,0.88,mmask, sidemat,
			A-0.218,B-0.3-((A-0.316)/2),10, sidemat,
			A-0.218,B-0.22-((A-0.316)/2),mmask, sidemat,
			A-0.2188,B-0.22,10, sidemat,
			A-0.138,B-0.11,mmask, sidematedge,
			A-0.138,0,-1, sidematedge

		cprism_ topmat, botmat, sidemat,
			12, framethick,
			(A-0.138)/2-0.04,0.15,10,
			(A-0.138)/2+0.04,0.15,mmask,
			(A-0.138)/2+0.04,0.73,10,
			(A-0.138)/2+0.04,0.88,mmask,
			(A-0.138)/2+0.04,B-0.3-((A-0.316)/2),10,
			(A-0.138)/2+0.04,B-0.22-((A-0.316)/2),mmask,
			(A-0.138)/2+0.04,B-0.22,10,
			(A-0.138)/2-0.04,B-0.22,mmask,
			(A-0.138)/2-0.04,B-0.22-((A-0.316)/2),10,
			(A-0.138)/2-0.04,B-0.3-((A-0.316)/2),mmask,
			(A-0.138)/2-0.04,0.88,10,
			(A-0.138)/2-0.04,0.73,mmask

		gosub 500

		base

		sprism_{2} topmat, botmat, sidemat,
			7,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0,10, sidematedge,
			0.08,0.15,mmask, sidemat,
			(A-0.138)/2-0.04,0.15,10, sidemat,
			(A-0.138)/2+0.04,0.15,mmask, sidemat,
			A-0.218,0.15,10, sidemat,
			A-0.138,0,mmask, sidematedge,
			0,0,-1, sidematedge

		sprism_{2} topmat, botmat, sidemat,
			7,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,b-0.11,10, sidematedge,
			0.08,b-0.22,mmask, sidemat,
			(A-0.138)/2-0.04,b-0.22,10, sidemat,
			(A-0.138)/2+0.04,b-0.22,mmask, sidemat,
			A-0.218,b-0.22,10, sidemat,
			A-0.138,b-0.11,mmask, sidematedge,
			0,b-0.11,-1, sidematedge

		cprism_ topmat, botmat, sidemat,
			4, framethick,
			0.08,0.73,10,
			0.08,0.88,mmask,
			(A-0.138)/2-0.04,0.88,10,
			(A-0.138)/2-0.04,0.73,mmask

		cprism_ topmat, botmat, sidemat,
			4, framethick,
			(A-0.138)/2+0.04,0.73,10,
			(A-0.138)/2+0.04,0.88,mmask,
			A-0.218,0.88,10,
			A-0.218,0.73,mmask

		cprism_ topmat, botmat, sidemat,
			4, framethick,
			0.08,B-0.3-((A-0.316)/2),10,
			0.08,B-0.22-((A-0.316)/2),mmask,
			(A-0.138)/2-0.04,B-0.22-((A-0.316)/2),10,
			(A-0.138)/2-0.04,B-0.3-((A-0.316)/2),mmask

		cprism_ topmat, botmat, sidemat,
			4, framethick,
			(A-0.138)/2+0.04,B-0.3-((A-0.316)/2),10,
			(A-0.138)/2+0.04,B-0.22-((A-0.316)/2),mmask,
			A-0.218,B-0.22-((A-0.316)/2),10,
			A-0.218,B-0.3-((A-0.316)/2),mmask

		gosub 600

	endif


	if gs_SashText_typ_num = 2 then

		base

		sprism_{2} topmat, botmat, sidemat,
			9,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0.15,8, sidematedge,
			0.08,0.15,mmask, sidemat,
			0.08,0.73,10, sidemat,
			0.08,0.88,mmask, sidemat,
			0.08,B-0.3-((A-0.316)/2),10, sidemat,
			0.08,B-0.22-((A-0.316)/2),mmask, sidemat,
			0.08,b-0.22,10, sidemat,
			0,b-0.22,mmask2, sidematedge,
			0,0.15,-1, sidematedge

		sprism_{2} topmat, botmat, sidemat,
			9,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			A-0.138,0.15,8, sidematedge,
			A-0.218,0.15,mmask, sidemat,
			A-0.218,0.73,10, sidemat,
			A-0.218,0.88,mmask, sidemat,
			A-0.218,B-0.3-((A-0.316)/2),10, sidemat,
			A-0.218,B-0.22-((A-0.316)/2),mmask, sidemat,
			A-0.218,b-0.22,10, sidemat,
			A-0.138,b-0.22,mmask2, sidematedge,
			A-0.138,0.15,-1, sidematedge

		cprism_ topmat, botmat, sidemat,
			12, framethick,
			(A-0.138)/2-0.04,0.15,8,
			(A-0.138)/2+0.04,0.15,mmask,
			(A-0.138)/2+0.04,0.73,10,
			(A-0.138)/2+0.04,0.88,mmask,
			(A-0.138)/2+0.04,B-0.3-((A-0.316)/2),10,
			(A-0.138)/2+0.04,B-0.22-((A-0.316)/2),mmask,
			(A-0.138)/2+0.04,b-0.22,10,
			(A-0.138)/2-0.04,b-0.22,mmask2,
			(A-0.138)/2-0.04,B-0.22-((A-0.316)/2),10,
			(A-0.138)/2-0.04,B-0.3-((A-0.316)/2),mmask,
			(A-0.138)/2-0.04,0.88,10,
			(A-0.138)/2-0.04,0.73,mmask

		gosub 500

		sprism_{2} topmat, botmat, sidemat,
			9,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0,mmask, sidematedge,
			0,0.15,8, sidematedge,
			0.08,0.15,mmask, sidemat,
			(A-0.138)/2-0.04,0.15,10, sidemat,
			(A-0.138)/2+0.04,0.15,mmask, sidemat,
			A-0.218,0.15,10, sidemat,
			A-0.138,0.15,mmask2, sidematedge,
			A-0.138,0,mmask, sidematedge,
			0,0,-1, sidematedge

		sprism_{2} topmat, botmat, sidemat,
			9,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,b-0.11,mmask, sidematedge,
			0,b-0.22,8, sidematedge,
			0.08,b-0.22,mmask, sidemat,
			(A-0.138)/2-0.04,b-0.22,10, sidemat,
			(A-0.138)/2+0.04,b-0.22,mmask, sidemat,
			A-0.218,b-0.22,10, sidemat,
			A-0.138,b-0.22,mmask2, sidematedge,
			A-0.138,b-0.11,mmask, sidematedge,
			0,b-0.11,-1, sidematedge

		cprism_ topmat, botmat, sidemat,
			4, framethick,
			0.08,0.73,mmask,
			(A-0.138)/2-0.04,0.73,10,
			(A-0.138)/2-0.04,0.88,mmask,
			0.08,0.88,10

		cprism_ topmat, botmat, sidemat,
			4, framethick,
			A-0.218,0.73,mmask,
			(A-0.138)/2+0.04,0.73,10,
			(A-0.138)/2+0.04,0.88,mmask,
			A-0.218,0.88,10

		cprism_ topmat, botmat, sidemat,
			4, framethick,
			0.08,B-0.3-((A-0.316)/2),mmask,
			(A-0.138)/2-0.04,B-0.3-((A-0.316)/2),10,
			(A-0.138)/2-0.04,B-0.22-((A-0.316)/2),mmask,
			0.08,B-0.22-((A-0.316)/2),10

		cprism_ topmat, botmat, sidemat,
			4, framethick,
			A-0.218,B-0.3-((A-0.316)/2),mmask,
			(A-0.138)/2+0.04,B-0.3-((A-0.316)/2),10,
			(A-0.138)/2+0.04,B-0.22-((A-0.316)/2),mmask,
			A-0.218,B-0.22-((A-0.316)/2),10

		gosub 600

	endif

	addz framethick

next ii

del nn


RETURN



1300:

for ii=1 to nn

	gosub 900

	if gs_SashText_typ_num = 1 then

		base

		sprism_{2} topmat, botmat, sidemat,
			7,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0,10, sidematedge,
			0.08,0.15,mmask, sidemat,
			0.08,0.73,10, sidemat,
			0.08,0.88,mmask, sidemat,
			0.08,B-0.18-Ar,10, sidemat,
			0,B-0.11,mmask, sidematedge,
			0,0,-1, sidematedge

		sprism_{2} topmat, botmat, sidemat,
			7,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			A-0.138,0,10, sidematedge,
			A-0.218,0.15,mmask, sidemat,
			A-0.218,0.73,10, sidemat,
			A-0.218,0.88,mmask, sidemat,
			A-0.218,B-0.18-Ar,10, sidemat,
			A-0.138,B-0.11,mmask, sidematedge,
			A-0.138,0,-1, sidematedge

		gosub 500

		sprism_{2} topmat, botmat, sidemat,
			5,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0,10, sidematedge,
			0.08,0.15,15, sidemat,
			A-0.218,0.15,10, sidemat,
			A-0.138,0,mmask, sidematedge,
			0,0,-1, sidematedge

		cprism_ topmat, botmat, sidemat,
			5, framethick,
			0.08,0.73,10,
			0.08,0.88,mmask,
			A-0.218,0.88,10,
			A-0.218,0.73,15,
			0.08,0.73,-1

		sprism_{2} topmat, botmat, sidemat,
			10,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			A-0.218,B-0.18-Ar,mmask2, sidemat,
			(A-0.218),B+0.32-Ar,913, sidemat,
			(A-0.138)/2+A/6,B-0.15-Ar,3000+mmask2, sidemat,
			(A-0.138)/2,B-0.53-Ar,913, sidemat,
			(A-0.138)/2-A/6,B-0.15-Ar,3000+mmask2, sidemat,
			0.08,B+0.32-Ar,915, sidemat,
			0.08,B-0.18-Ar,3010, sidemat,
			0,B-0.11,mmask, sidematedge,
			A-0.138,B-0.11,10, sidematedge,
			A-0.218,B-0.18-Ar,-1, sidematedge

		gosub 600

	endif

	if gs_SashText_typ_num = 2 then

		base

		sprism_{2} topmat, botmat, sidemat,
			7,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0.15,8, sidematedge,
			0.08,0.15,15, sidemat,
			0.08,0.73,10, sidemat,
			0.08,0.88,mmask, sidemat,
			0.08,B-0.18-Ar,10, sidemat,
			0,B-0.18-Ar,mmask2, sidematedge,
			0,0.15,-1, sidematedge

		sprism_{2} topmat, botmat, sidemat,
			7,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			A-0.138,0.15,8, sidematedge,
			A-0.218,0.15,15, sidemat,
			A-0.218,0.73,10, sidemat,
			A-0.218,0.88,mmask, sidemat,
			A-0.218,B-0.18-Ar,10, sidemat,
			A-0.138,B-0.18-Ar,mmask2, sidematedge,
			A-0.138,0.15,-1, sidematedge

		gosub 500

		sprism_{2} topmat, botmat, sidemat,
			7,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0,15, sidematedge,
			0,0.15,8, sidemat,
			0.08,0.15,15, sidemat,
			A-0.218,0.15,10, sidemat,
			A-0.138,0.15,mmask2, sidemat,
			A-0.138,0,mmask, sidematedge,
			0,0,-1, sidematedge

		cprism_ topmat, botmat, sidemat,
			5, framethick,
			0.08,0.73,10,
			0.08,0.88,mmask,
			A-0.218,0.88,10,
			A-0.218,0.73,15,
			0.08,0.73,-1

		sprism_{2} topmat, botmat, sidemat,
			12,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			A-0.218,B-0.18-Ar,mmask2, sidemat,
			(A-0.218),B+0.32-Ar,900+mmask2, sidemat,
			(A-0.138)/2+A/6,B-0.15-Ar,3000+mmask2, sidemat,
			(A-0.138)/2,B-0.53-Ar,913, sidemat,
			(A-0.138)/2-A/6,B-0.15-Ar,3000+mmask2, sidemat,
			0.08,B+0.32-Ar,915, sidemat,
			0.08,B-0.18-Ar,3010, sidemat,
			0,B-0.18-Ar,13, sidemat,
			0,B-0.11,mmask, sidemat,
			A-0.138,B-0.11,mmask2, sidematedge,
			A-0.138,B-0.18-Ar,8, sidematedge,
			A-0.218,B-0.18-Ar,-1, sidematedge

		gosub 600

	endif

	addz framethick

next ii

del nn



RETURN


1400:

for ii=1 to nn

	gosub 900

	if gs_SashText_typ_num = 1 then

		base

		sprism_{2} topmat, botmat, sidemat,
			7,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0,10, sidematedge,
			0.08,0.15,mmask, sidemat,
			0.08,0.73,10, sidemat,
			0.08,0.88,mmask, sidemat,
			0.08,B-0.22,10, sidemat,
			0,B-0.11,mmask, sidematedge,
			0,0,-1, sidematedge

		sprism_{2} topmat, botmat, sidemat,
			7,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			A-0.138,0,10, sidematedge,
			A-0.218,0.15,mmask, sidemat,
			A-0.218,0.73,10, sidemat,
			A-0.218,0.88,mmask, sidemat,
			A-0.218,B-0.22,10, sidemat,
			A-0.138,B-0.11,mmask, sidematedge,
			A-0.138,0,-1, sidematedge

		gosub 500

		sprism_{2} topmat, botmat, sidemat,
			5,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0,10, sidematedge,
			0.08,0.15,mmask, sidemat,
			A-0.218,0.15,10, sidemat,
			A-0.138,0,mmask, sidematedge,
			0,0,-1, sidematedge

		cprism_ topmat, botmat, sidemat,
			4, framethick,
			0.08,0.73,10,
			0.08,0.88,mmask,
			A-0.218,0.88,10,
			A-0.218,0.73,mmask

		sprism_{2} topmat, botmat, sidemat,
			5,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,B-0.11,10, sidematedge,
			0.08,B-0.22,mmask, sidemat,
			A-0.218,B-0.22,10, sidemat,
			A-0.138,B-0.11,mmask, sidematedge,
			0,B-0.11,-1, sidematedge

		gosub 600

	endif

	if gs_SashText_typ_num = 2 then

		base

		sprism_{2} topmat, botmat, sidemat,
			7,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0.15,8, sidematedge,
			0.08,0.15,mmask, sidemat,
			0.08,0.73,10, sidemat,
			0.08,0.88,mmask, sidemat,
			0.08,B-0.22,10, sidemat,
			0,B-0.22,mmask2, sidematedge,
			0,0.15,-1, sidematedge

		sprism_{2} topmat, botmat, sidemat,
			7,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			A-0.138,0.15,8, sidematedge,
			A-0.218,0.15,mmask, sidemat,
			A-0.218,0.73,10, sidemat,
			A-0.218,0.88,mmask, sidemat,
			A-0.218,B-0.22,10, sidemat,
			A-0.138,B-0.22,mmask2, sidematedge,
			A-0.138,0.15,-1, sidematedge

		gosub 500

		sprism_{2} topmat, botmat, sidemat,
			7,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0,15, sidematedge,
			0,0.15,8, sidemat,
			0.08,0.15,mmask, sidemat,
			A-0.218,0.15,10, sidemat,
			A-0.138,0.15,mmask2, sidematedge,
			A-0.138,0,mmask, sidematedge,
			0,0,-1, sidematedge

		cprism_ topmat, botmat, sidemat,
			4, framethick,
			0.08,0.73,10,
			0.08,0.88,mmask,
			A-0.218,0.88,10,
			A-0.218,0.73,mmask

		sprism_{2} topmat, botmat, sidemat,
			7,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,B-0.11,15, sidematedge,
			0,B-0.22,8, sidemat,
			0.08,B-0.22,mmask, sidemat,
			A-0.218,B-0.22,10, sidemat,
			A-0.138,B-0.22,mmask2, sidematedge,
			A-0.138,B-0.11,mmask, sidematedge,
			0,B-0.11,-1, sidematedge

		gosub 600

	endif

	addz framethick

next ii

del nn


RETURN


1500:

for ii=1 to nn

	gosub 900

	if gs_SashText_typ_num = 1 then

		base

		sprism_{2} topmat, botmat, sidemat,
			11,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0,10, sidematedge,
			0.08,0.15,15, sidemat,
			0.08,0.73,10, sidemat,
			0.08,0.88,mmask, sidemat,
			0.08,0.88+dy,10, sidemat,
			0.08,0.88+0.03+dy,mmask, sidemat,
			0.08,0.88+0.03+2*dy,10, sidemat,
			0.08,0.88+0.06+2*dy,mmask, sidemat,
			0.08,B-0.22,10, sidemat,
			0,B-0.11,mmask, sidematedge,
			0,0,-1, sidematedge

		sprism_{2} topmat, botmat, sidemat,
			11,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			A-0.138,0,10, sidematedge,
			A-0.218,0.15,15, sidemat,
			A-0.218,0.73,10, sidemat,
			A-0.218,0.88,mmask, sidemat,
			A-0.218,0.88+dy,10, sidemat,
			A-0.218,0.88+0.03+dy,mmask, sidemat,
			A-0.218,0.88+0.03+2*dy,10, sidemat,
			A-0.218,0.88+0.06+2*dy,mmask, sidemat,
			A-0.218,B-0.22,10, sidemat,
			A-0.138,B-0.11,mmask, sidematedge,
			A-0.138,0,-1, sidematedge

		gosub 500

		sprism_{2} topmat, botmat, sidemat,
			7,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0,10, sidematedge,
			0.08,0.15,15, sidemat,
			(A-0.138)/2-0.04,0.15,10, sidemat,
			(A-0.138)/2+0.04,0.15,15, sidemat,
			A-0.218,0.15,10, sidemat,
			A-0.138,0,15, sidematedge,
			0,0,-1, sidematedge

		sprism_{2} topmat, botmat, sidemat,
			9,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,B-0.11,10, sidematedge,
			0.08,B-0.22,mmask, sidemat,
			0.08+dx,B-0.22,10, sidemat,
			0.08+dx+0.03,B-0.22,mmask, sidemat,
			A-0.218-dx-0.03,B-0.22,10, sidemat,
			A-0.218-dx,B-0.22,mmask, sidemat,
			A-0.218,B-0.22,10, sidemat,
			A-0.138,B-0.11,15, sidematedge,
			0,B-0.11,-1, sidematedge

		gosub 600

	endif

	if gs_SashText_typ_num = 2 then

		base

		sprism_{2} topmat, botmat, sidemat,
			11,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0.15,8, sidematedge,
			0.08,0.15,15, sidemat,
			0.08,0.73,10, sidemat,
			0.08,0.88,mmask, sidemat,
			0.08,0.88+dy,10, sidemat,
			0.08,0.88+0.03+dy,mmask, sidemat,
			0.08,0.88+0.03+2*dy,10, sidemat,
			0.08,0.88+0.06+2*dy,mmask, sidemat,
			0.08,B-0.22,10, sidemat,
			0,B-0.22,mmask2, sidematedge,
			0,0.15,-1, sidematedge

		sprism_{2} topmat, botmat, sidemat,
			11,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			A-0.138,0.15,8, sidematedge,
			A-0.218,0.15,15, sidemat,
			A-0.218,0.73,10, sidemat,
			A-0.218,0.88,mmask, sidemat,
			A-0.218,0.88+dy,10, sidemat,
			A-0.218,0.88+0.03+dy,mmask, sidemat,
			A-0.218,0.88+0.03+2*dy,10, sidemat,
			A-0.218,0.88+0.06+2*dy,mmask, sidemat,
			A-0.218,B-0.22,10, sidemat,
			A-0.138,B-0.22,mmask2, sidematedge,
			A-0.138,0.15,-1, sidematedge

		gosub 500

		sprism_{2} topmat, botmat, sidemat,
			9,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,0,15, sidematedge,
			0,0.15,8, sidemat,
			0.08,0.15,15, sidemat,
			(A-0.138)/2-0.04,0.15,10, sidemat,
			(A-0.138)/2+0.04,0.15,15, sidemat,
			A-0.218,0.15,10, sidemat,
			A-0.138,0.15,mmask2, sidematedge,
			A-0.138,0,mmask, sidematedge,
			0,0,-1, sidematedge

		sprism_{2} topmat, botmat, sidemat,
			11,
			0,  0,  1,  0,  framethick, 0,
			0,  0,  1,  0,   0,  0,
			0,B-0.11,15, sidematedge,
			0,B-0.22,8, sidemat,
			0.08,B-0.22,mmask, sidemat,
			0.08+dx,B-0.22,10, sidemat,
			0.08+dx+0.03,B-0.22,mmask, sidemat,
			A-0.218-dx-0.03,B-0.22,10, sidemat,
			A-0.218-dx,B-0.22,mmask, sidemat,
			A-0.218,B-0.22,10, sidemat,
			A-0.138,B-0.22,mmask2, sidematedge,
			A-0.138,B-0.11,mmask, sidematedge,
			0,B-0.11,-1, sidematedge

		gosub 600

	endif

	addz framethick

next ii

del nn

return



1600:
if gs_SashText_typ_num = 1 then

	base

	cprism_ topmat, botmat, sidemat,
		5, gs_leaf_thk/2,
		-a/2+gs_fw_side, gs_fw_lower, 10,
		-a/2+gs_fw_side+gs_int_fw, gs_fw_lower+gs_int_fw, 15,
		-a/2+gs_fw_side+gs_int_fw, mag_hat-gs_int_fw, 10,
		-a/2+gs_fw_side, mag_hat, 15,
		-a/2+gs_fw_side, gs_fw_lower, -1

	cprism_ topmat, botmat, sidemat,
		5, gs_leaf_thk/2,
		a/2-gs_fw_side, gs_fw_lower, 10,
		a/2-gs_fw_side-gs_int_fw, gs_fw_lower+gs_int_fw, 15,
		a/2-gs_fw_side-gs_int_fw, mag_hat-gs_int_fw, 10,
		a/2-gs_fw_side, mag_hat, 15,
		a/2-gs_fw_side, gs_fw_lower, -1

	gosub 500

	cprism_ topmat, botmat, sidemat,
		5, gs_leaf_thk/2,
		-a/2+gs_fw_side, gs_fw_lower, 10,
		-a/2+gs_fw_side+gs_int_fw, gs_fw_lower+gs_int_fw, 15,
		a/2-gs_fw_side-gs_int_fw, gs_fw_lower+gs_int_fw, 10,
		a/2-gs_fw_side, gs_fw_lower, 15,
		-a/2+gs_fw_side, gs_fw_lower, -1

	cprism_ topmat, botmat, sidemat,
		5, gs_leaf_thk/2,
		-a/2+gs_fw_side, mag_hat, 10,
		-a/2+gs_fw_side+gs_int_fw, mag_hat-gs_int_fw, 15,
		a/2-gs_fw_side-gs_int_fw, mag_hat-gs_int_fw, 10,
		a/2-gs_fw_side, mag_hat, 15,
		-a/2+gs_fw_side, mag_hat, -1

	gosub 600

endif


if gs_SashText_typ_num = 2 then

	base

	cprism_ topmat, botmat, sidemat,
		5, gs_leaf_thk/2,
		-a/2+gs_fw_side, gs_fw_lower+gs_int_fw, 8,
		-a/2+gs_fw_side+gs_int_fw, gs_fw_lower+gs_int_fw, 15,
		-a/2+gs_fw_side+gs_int_fw, mag_hat-gs_int_fw, 10,
		-a/2+gs_fw_side, mag_hat-gs_int_fw, 13,
		-a/2+gs_fw_side, gs_fw_lower+gs_int_fw, -1

	cprism_ topmat, botmat, sidemat,
		5, gs_leaf_thk/2,
		a/2-gs_fw_side, gs_fw_lower+gs_int_fw, 8,
		a/2-gs_fw_side-gs_int_fw, gs_fw_lower+gs_int_fw, 15,
		a/2-gs_fw_side-gs_int_fw, mag_hat-gs_int_fw, 10,
		a/2-gs_fw_side, mag_hat-gs_int_fw, 13,
		a/2-gs_fw_side, gs_fw_lower+gs_int_fw, -1

	gosub 500

	cprism_ topmat, botmat, sidemat,
		7, gs_leaf_thk/2,
		-a/2+gs_fw_side, gs_fw_lower, 15,
		-a/2+gs_fw_side, gs_fw_lower+gs_int_fw, 8,
		-a/2+gs_fw_side+gs_int_fw, gs_fw_lower+gs_int_fw, 15,
		a/2-gs_fw_side-gs_int_fw, gs_fw_lower+gs_int_fw, 10,
		a/2-gs_fw_side, gs_fw_lower+gs_int_fw, 13,
		a/2-gs_fw_side, gs_fw_lower, 15,
		-a/2+gs_fw_side, gs_fw_lower, -1

	cprism_ topmat, botmat, sidemat,
		7, gs_leaf_thk/2,
		-a/2+gs_fw_side, mag_hat, 15,
		-a/2+gs_fw_side, mag_hat-gs_int_fw, 8,
		-a/2+gs_fw_side+gs_int_fw, mag_hat-gs_int_fw, 15,
		a/2-gs_fw_side-gs_int_fw, mag_hat-gs_int_fw, 10,
		a/2-gs_fw_side, mag_hat-gs_int_fw, 13,
		a/2-gs_fw_side, mag_hat, 15,
		-a/2+gs_fw_side, mag_hat, -1

	gosub 600

endif


RETURN



end

500:

!**************** texture coordination horizontal

vert 0, 0, 0
vert 0, 1, 0
vert 1, 0, 0
vert 0, 0, 1
coor 2, -1, -2, -3, -4
body 1

base

return

end



600:

!**************** texture coordination vertical

vert 0, 0, 0
vert 1, 0, 0
vert 0, 1, 0
vert 0, 0, 1
coor 2, -1, -2, -3, -4
body 1

base

return

end



900:
	if ii=1 then
		sidemat=botmat
		if gs_leaf_mat = gs_leaf_matin then mmask=15 else mmask=11
		if gs_leaf_mat = gs_leaf_matin then mmask2=13 else mmask2=9
	else
		sidemat=topmat
		mmask=14
		mmask2=12
	endif
return


910:
	if ii=1 then
		if gs_grill_pos_m = MULLION_INSIDE exor WIDO_REVEAL_SIDE then
			mulsidemat=multopmat
		else
			mulsidemat=mulbotmat
		endif
		if gs_grill_mat = gs_grill_mat2 | gs_grill_pos_m <> MULLION_THROUGHOUT then
			mmask=15
			mmask2=13
		else
			mmask=11
			mmask2=9
		endif
	else
		mulsidemat=multopmat
		mmask=14
		mmask2=12
	endif
return


"middleline":
	model wire
	plane 4,
		a, b, 0,
		a, b, gs_leaf_thk,
		a, 0, gs_leaf_thk,
		a, 0, 0
	model solid
return

end


"metalPanelFrameWithGlass":
	sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_leaf_pen_cont

	for ii=1 to nn

		gosub 900

		if gs_SashText_typ_num = 1 then

			base

			sprism_{2} topmat, botmat, sidemat,
				5,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				0, 					0,					10, sidematedge,
				_frameWidthSide,	_frameWidthLower,	15, sidemat,
				_frameWidthSide,	b-_frameWidthSide,	10, sidemat,
				0,					b,					mmask, sidematedge,
				0,					0,					-1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				5,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				a, 					0, 					10, sidematedge,
				a-_frameWidthSide,	_frameWidthLower,	15, sidemat,
				a-_frameWidthSide,	b-_frameWidthSide, 	10, sidemat,
				a,					b, 					mmask, sidematedge,
				a, 					0, 					-1, sidematedge

			gosub 500

			sprism_{2} topmat, botmat, sidemat,
				5,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				0, 					0, 					10, sidematedge,
				_frameWidthSide,	_frameWidthLower, 	15, sidemat,
				a-_frameWidthSide,	_frameWidthLower, 	10, sidemat,
				a, 					0, 					mmask, sidematedge,
				0, 					0, 					-1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				5,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				0,					b,					10, sidematedge,
				_frameWidthSide,	b-_frameWidthSide,	15, sidemat,
				a-_frameWidthSide,	b-_frameWidthSide, 	10, sidemat,
				a,					b, 					mmask, sidematedge,
				0,					b, 					-1, sidematedge

			gosub 600

		endif

		if gs_SashText_typ_num = 2 then

			base

			sprism_{2} topmat, botmat, sidemat,
				5,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				0, 					_frameWidthLower, 8, sidematedge,
				_frameWidthSide,	_frameWidthLower, 15, sidemat,
				_frameWidthSide,	b-_frameWidthSide, 10, sidemat,
				0,					b-_frameWidthSide, mmask2, sidematedge,
				0,					_frameWidthLower, -1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				5,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				a,					_frameWidthLower, 8, sidematedge,
				a-_frameWidthSide,	_frameWidthLower, 15, sidemat,
				a-_frameWidthSide,	b-_frameWidthSide, 10, sidemat,
				a,					b-_frameWidthSide, mmask2, sidematedge,
				a,					_frameWidthLower, -1, sidematedge

			gosub 500

			sprism_{2} topmat, botmat, sidemat,
				7,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				0, 0, mmask, sidematedge,
				0,					_frameWidthLower, 8, sidemat,
				_frameWidthSide,	_frameWidthLower,15, sidemat,
				a-_frameWidthSide,	_frameWidthLower, 10, sidemat,
				a,					_frameWidthLower, mmask2, sidematedge,
				a,					0, mmask, sidematedge,
				0,					0, -1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				7,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				0,					b, mmask, sidematedge,
				0,					b-_frameWidthSide, 8, sidemat,
				_frameWidthSide,	b-_frameWidthSide, 15, sidemat,
				a-_frameWidthSide,	b-_frameWidthSide, 10, sidemat,
				a,					b-_frameWidthSide, mmask2, sidematedge,
				a,					b, mmask, sidematedge,
				0,					b, -1, sidematedge

			gosub 600

		endif

		addz framethick

	next ii

	del nn

	! ------------ glass

	body -1
	pen gs_glass_pen
	if bStorefrontDoor then
		sect_fill gs_gsect, gs_penGlass_bg, gs_penGlass_fg, gs_glass_pen_cont
	else
		sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_glass_pen_cont
	endif
	material gs_glass_mat
	addz (gs_leaf_thk-gs_glass_thk)/2

	cprism_ gs_glass_mat, gs_glass_mat, gs_glass_mat,
			5, gs_glass_thk,
			a-_frameWidthSide,	_frameWidthLower,	glas_mask10,
			a-_frameWidthSide,	b-_frameWidthSide,	glas_mask15,
			_frameWidthSide,	b-_frameWidthSide,	glas_mask10,
			_frameWidthSide,	_frameWidthLower,	glas_mask15,
			a-_frameWidthSide,	_frameWidthLower,	-1

	del 1

	body -1

	! ------------ middleline

	if bMiddleLine then gosub "middleline"

return


"metalPanelDivFrameWithGlass":

	sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_leaf_pen_cont
	for ii=1 to nn

		gosub 900

		if gs_SashText_typ_num = 1 then

			base

			sprism_{2} topmat, botmat, sidemat,
				7,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				0, 0, 10, sidematedge,
				_frameWidthSide,	_frameWidthLower, 15, sidemat,
				_frameWidthSide,	_midFrameElev-(_midFrameWidth)/2, 10, sidemat,
				_frameWidthSide, 	_midFrameElev+(_midFrameWidth)/2, 15, sidemat,
				_frameWidthSide, 	b-_frameWidthSide, 10, sidemat,
				0,					b, mmask, sidematedge,
				0, 					0, -1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				7,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				a, 0, 10, sidematedge,
				a-_frameWidthSide, 	_frameWidthLower, 15, sidemat,
				a-_frameWidthSide, 	_midFrameElev-(_midFrameWidth)/2, 10, sidemat,
				a-_frameWidthSide,	_midFrameElev+(_midFrameWidth)/2,15, sidemat,
				a-_frameWidthSide,	b-_frameWidthSide, 10, sidemat,
				a, 					b, mmask, sidematedge,
				a, 					0, -1, sidematedge

			gosub 500

			sprism_{2} topmat, botmat, sidemat,
				5,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				0,		0, 10, sidematedge,
				_frameWidthSide, 	_frameWidthLower, 15, sidemat,
				a-_frameWidthSide, 	_frameWidthLower, 10, sidemat,
				a, 					0, mmask, sidematedge,
				0, 					0, -1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				5,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				0, 					b, 10, sidematedge,
				_frameWidthSide,	b-_frameWidthSide,15, sidemat,
				a-_frameWidthSide, 	b-_frameWidthSide, 10, sidemat,
				a, 					b, mmask, sidematedge,
				0, 					b, -1, sidematedge

			gosub 600

		endif

		if gs_SashText_typ_num = 2 then

			base

			sprism_{2} topmat, botmat, sidemat,
				7,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				0,					_frameWidthLower,	8, sidematedge,
				_frameWidthSide,	_frameWidthLower,	15, sidemat,
				_frameWidthSide,	_midFrameElev-(_midFrameWidth)/2,	10, sidemat,
				_frameWidthSide,	_midFrameElev+(_midFrameWidth)/2,	15, sidemat,
				_frameWidthSide,	b-_frameWidthSide,	10, sidemat,
				0,					b-_frameWidthSide,	mmask2, sidematedge,
				0,					_frameWidthLower,	-1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				7,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				a, 					_frameWidthLower, 8, sidematedge,
				a-_frameWidthSide,	_frameWidthLower,	15, sidemat,
				a-_frameWidthSide, 	_midFrameElev-(_midFrameWidth)/2, 10, sidemat,
				a-_frameWidthSide, 	_midFrameElev+(_midFrameWidth)/2, 15, sidemat,
				a-_frameWidthSide, 	b-_frameWidthSide,	10, sidemat,
				a, 					b-_frameWidthSide,	mmask2, sidematedge,
				a,					_frameWidthLower,	-1, sidematedge

			gosub 500

			sprism_{2} topmat, botmat, sidemat,
				7,
				0,  		0,  1,	0,	framethick, 0,
				0,  		0,  1,
				0,   		0,  0,
				0, 			0, mmask, sidematedge,
				0, 					_frameWidthLower, 8, sidemat,
				_frameWidthSide,	_frameWidthLower,15, sidemat,
				a-_frameWidthSide, 	_frameWidthLower, 10, sidemat,
				a, 					_frameWidthLower, mmask2, sidematedge,
				a, 					0, mmask, sidematedge,
				0, 					0, -1, sidematedge

			sprism_{2} topmat, botmat, sidemat,
				7,
				0,  0,  1,  0,  framethick, 0,
				0,  0,  1,  0,   0,  0,
				0,					b, mmask, sidematedge,
				0,					b-_frameWidthSide, 8, sidemat,
				_frameWidthSide,	b-_frameWidthSide, 15, sidemat,
				a-_frameWidthSide,	b-_frameWidthSide, 10, sidemat,
				a, 					b-_frameWidthSide,mmask2, sidematedge,
				a,					b, mmask, sidematedge,
				0,					b, -1, sidematedge

			gosub 600

		endif

		addz framethick

	next ii

	del nn


	! ------------ Both in type1 and type2

	for ii=1 to nn

		gosub 900

		cprism_ middleRailMat, middleRailMat, middleRailMat,
			5, framethick,
			_frameWidthSide,	_midFrameElev-(_midFrameWidth)/2, 15 - 5 * (middleRailMat = sidemat),
			_frameWidthSide,	_midFrameElev+(_midFrameWidth)/2, 15,
			a-_frameWidthSide,	_midFrameElev+(_midFrameWidth)/2, 15 - 5 * (middleRailMat = sidemat),
			a-_frameWidthSide,	_midFrameElev-(_midFrameWidth)/2, 15,
			_frameWidthSide,	_midFrameElev-(_midFrameWidth)/2, -1

		gosub 600

		addz framethick

	next ii

	del nn


	! ------------ glass

	body -1
	pen gs_glass_pen
	if bStorefrontDoor then
		sect_fill gs_gsect, gs_penGlass_bg, gs_penGlass_fg, gs_glass_pen_cont
	else
		sect_fill gs_fillLeaf, gs_penLeaf_bg, gs_penLeaf_fg, gs_glass_pen_cont
	endif

	material gs_glass_mat
	addz (gs_leaf_thk-gs_glass_thk)/2

	cprism_ gs_glass_mat, gs_glass_mat, gs_glass_mat,
		5, gs_glass_thk,
		a-_frameWidthSide,	_midFrameElev+(_midFrameWidth)/2,	glas_mask10,
		a-_frameWidthSide,	b-_frameWidthSide,					glas_mask15,
		_frameWidthSide,	b-_frameWidthSide,					glas_mask10,
		_frameWidthSide,	_midFrameElev+(_midFrameWidth)/2,	glas_mask15,
		a-_frameWidthSide,	_midFrameElev+(_midFrameWidth)/2,	-1


	cprism_ gs_glass_mat, gs_glass_mat, gs_glass_mat,
		5, gs_glass_thk,
		a-_frameWidthSide,	_frameWidthLower,					glas_mask10,
		a-_frameWidthSide,	_midFrameElev-(_midFrameWidth)/2,	glas_mask15,
		_frameWidthSide,	_midFrameElev-(_midFrameWidth)/2,	glas_mask10,
		_frameWidthSide,	_frameWidthLower,					glas_mask15,
		a-_frameWidthSide,	_frameWidthLower,					-1

	del 1

	body -1

	! ------------ middleline

	if bMiddleLine then gosub "middleline"
return


