
! =============================================================================
! Main Definitions
! =============================================================================

EPS = 0.0001

gs_IsCurved			= 0
bParalellInCurvedWalls = 0
bDisabeMirroring	= 0
iWindowShape		= 0

bCornerWindow	= (ac_cw_function & ac_corner_window)

! const values for parameter: iWindowType

WIN_W2HorizontalSlide	= 16
WIN_W4HorizontalSlide	= 17
WIN_W3HorizontalSlide	= 46
WIN_W6HorizontalSlide	= 47

_bHasMainOptype		= 0
_bPossibleTransom	= 0
_bHasRailConfig		= 0
_bHasPaneSizeConfig	= 0

if iWindowType = WIN_W2HorizontalSlide | iWindowType = WIN_W4HorizontalSlide |\
	iWindowType = WIN_W3HorizontalSlide then

	_bHasMainOptype = 1
	_bHasPaneSizeConfig = 1
endif

if iWindowType = WIN_W4HorizontalSlide | iWindowType = WIN_W3HorizontalSlide then
	_bPossibleTransom = 1
else
	gs_UTrans = 0
endif

if iWindowType = WIN_W6HorizontalSlide then
	_bHasRailConfig = 1
endif


! =============================================================================
! Constant values
! =============================================================================

! const values for parameter: iDWDet2D
DETLEVEL_DW2D_MVO     = 1
DETLEVEL_DW2D_SCSENS  = 2
DETLEVEL_DW2D_50      = 3
DETLEVEL_DW2D_100     = 4
DETLEVEL_DW2D_MIDDET  = 5
DETLEVEL_DW2D_SMPL2L  = 6
DETLEVEL_DW2D_200     = 7
DETLEVEL_DW2D_OFF     = 8
DETLEVEL_DW2D_MIDUSA  = 9
DETLEVEL_DW2D_CHISMPL = 10
DETLEVEL_DW2D_CHIDET  = 11
DETLEVEL_DW2D_20      = 12


! const values for parameter: iBoardInPolyWall
BOARD_PARALLEL_WINDOW      = 1
BOARD_PARALLEL_WALLPOLYGON = 2


! const values for parameter: iDWDet3D
DETLEVEL_DW3D_SCALESENS    = 1
DETLEVEL_DW3D_DETAILED     = 2
DETLEVEL_DW3D_SIMPLE       = 3
DETLEVEL_DW3D_OFF          = 4
DETLEVEL_DW3D_CHI_SIMPLE   = 5
DETLEVEL_DW3D_CHI_DETAILED = 6


! const values for parameter: iTypeDemolitionFill
RENOVATION_FILL_EXIST		= 1
RENOVATION_FILL_DEMOLISHED	= 2
RENOVATION_FILL_NEW			= 3
RENOVATION_FILL_NEW_FULL	= 4


! const values for parameter: iCornerConnTypeRight, iCornerConnTypeLeft
CONNECTION_TYPE_FRAME  = 1
CONNECTION_TYPE_COLUMN = 2
CONNECTION_TYPE_GLASS  = 3


! const values for parameter: iBrickSilldetlevel
BRICKSILL_SIMPLE   = 1
BRICKSILL_DETAILED = 2


! const values for parameter: iCustomCCEditWallSide
EDITED_WALL_FACE_OUTSIDE = 1
EDITED_WALL_FACE_INSIDE  = 2


! const values for parameter: iCustomCCEditJambSide
EDITED_JAMB_SIDE_BOTH  = 1
EDITED_JAMB_SIDE_LEFT  = 2
EDITED_JAMB_SIDE_RIGHT = 3


! const values for parameter: iCustomCCThicknessType
THICKNESS_TYPE_ORIGINAL = 1
THICKNESS_TYPE_CUSTOM   = 2


! const values for parameter: iCustomCCEditSkin
EDITED_SKIN_1 = 1
EDITED_SKIN_2 = 2
EDITED_SKIN_3 = 3
EDITED_SKIN_4 = 4


! const values for parameter: iCustomCCOrientation
ORIENTATION_ORIGINAL  = 1
ORIENTATION_TURNED_IN = 2


! const values for parameter: gs_SashText_typ_num
MITERED_JOINT = 1
BUTT_JOINT    = 2


! const values for parameter: iSillType
SILL_TIMBER       = 1
SILL_SOLID_22     = 10
SILL_METAL_1      = 11
SILL_PARALLEL     = 12
SILL_METAL_2      = 13
SILL_PARALLEL_2   = 14
SILL_SIMPLEBLOCK  = 15
SILL_BLOCK        = 16
SILL_DUTCH        = 17
SILL_BRICK        = 2
SILL_STONE        = 3
SILL_CERAMIC      = 4
SILL_ETHERNIT     = 5
SILL_CONCRETE_TUB = 6
SILL_ALUMINIUM    = 7
SILL_SOLID_11     = 8
SILL_SOLID_12     = 9

! lod2D
DET2D_FS_OFF				= 0
DET2D_FS_SCALESENS			= -1
DET2D_FS_SIMPLE_ONE			= 11
DET2D_FS_SIMPLE_TWO			= 12
DET2D_FS_MIDDLE				= 21
DET2D_FS_MIDDLE_USA			= 22
DET2D_FS_DETAILED			= 30
DET2D_FS_DETAILED_FIX_GRID	= 31
DET2D_FS_DETAILED_USA		= 32
DET2D_FS_SIMPLE_CHI			= 51
DET2D_FS_DETAILED_CHI		= 52

! iLoD2D
SYMBW_OFF					= 0
SYMBW_SCALESENS				= 1
SYMBW_S_1LINE				= 11
SYMBW_S_2LINE				= 12
SYMBW_S_CENTERLINE			= 13
SYMBW_S_2LINE_ACC			= 14
SYMBW_S_5					= 15
SYMBW_S_6					= 16
SYMBW_S_7					= 17
SYMBW_S_8					= 18
SYMBW_S_9					= 19
SYMBW_M_2LINE_NOGLASS		= 21
SYMBW_M_2LINE_GLASS			= 22
SYMBW_M_FRAMESASH			= 23
SYMBW_M_2LINE_FRAME			= 24
SYMBW_M_5					= 25
SYMBW_M_6					= 26
SYMBW_M_7					= 27
SYMBW_M_8					= 28
SYMBW_M_9					= 29
SYMBW_D_SGLASS				= 31
SYMBW_D_2GLASS				= 32
SYMBW_D_2LINE_HS			= 33
SYMBW_D_NOGLASS				= 34
SYMBW_D_REBATEONGLASS		= 35
SYMBW_D_2GLASS_OVERLAP		= 36
SYMBW_D_7					= 37
SYMBW_D_8					= 38
SYMBW_D_9					= 39

! gs_optype_m
SASH_FIXED					= 1		! Fixed Glass
SASH_FIXED_SCREW			= 2		! Fixed Sash
SASH_SIDE_HUNG				= 3		! Side Hung
SASH_SIDE_HUNG_M			= 4		! Side Hung Mirrored
SASH_TILT_TURN				= 5		! Tilt and Turn
SASH_TILT_TURN_M			= 6		! Tilt and Turn Mirrored
SASH_BOTTOM_HUNG			= 7		! Bottom Hung
SASH_TOP_HUNG				= 8		! Top Hung
SASH_HOR_PIVOT				= 9		! Horizontal Pivot Hung
SASH_VER_PIVOT				= 10	! Vertical Pivotted
SASH_TILT_SLIDE				= 11	! Tilt and Slide
SASH_LEFT_SLIDING			= 12	! Left Sliding
SASH_RIGHT_SLIDING			= 13	! Right Sliding
SASH_UP_SLIDING				= 14	! Sliding Up
SASH_DOWN_SLIDING			= 15	! Sliding Down
SASH_VER_PIVOT_M			= 16	! Vertical Pivotted Mirrored
SASH_FIXED_SLIDE			= 17	! Fixed Sliding Sash
SASH_DOUBLE_SIDE_HUNG		= 18	! Double Sash
SASH_DOUBLE_TILT_TURN		= 19	! Double Tilt and Turn
SASH_DOUBLE_TILT_TURN_M		= 20	! Double Tilt and Turn Mirrored
SASH_SLIDING_HOR			= 21	! Sliding
SASH_SLIDING_HOR_M			= 22	! Sliding Mirrored
SASH_DOUBLE_SLIDING_HOR		= 23	! Double Sliding
SASH_DOUBLE_SLIDING_HOR_M	= 24	! Double Sliding Mirrored
SASH_SLIDING_VER			= 25	! Single Hung
SASH_DOUBLE_SLIDING_VER		= 26	! Double Hung

! iMullionStyle
MULLION_NONE			= 1
MULLION_HVGRID			= 2
MULLION_EDITABLEGRID	= 3
MULLION_CUSTOM			= 4
MULLION_PRAIRIE			= 5
MULLION_DIVIDED			= 6
MULLION_SOLID_PANEL		= 15
MULLION_VENT_PANEL		= 16

! iMullionPosition
MULLION_OUTSIDE		= 1
MULLION_INSIDE		= 2
MULLION_THROUGHOUT	= 3

! iVentilationProfileType
VENTPROFILE_OVER_FRAME		= 2
VENTPROFILE_OVER_GLAZING	= 3

! iNumberOfRails
RAILSNUMBER_2		= 2
RAILSNUMBER_3		= 3

dim stNumberOfRails[2]
	stNumberOfRails[1] = `2 Направляющие`
	stNumberOfRails[2] = `3 Направляющие`

! iOpeningTypeMain
OPENINGTYPE_MAIN_SINGLE		= 1
OPENINGTYPE_MAIN_DOUBLE		= 2

OPENINGTYPE_MAIN_2SASHES	= 1
OPENINGTYPE_MAIN_3SASHES	= 2
OPENINGTYPE_MAIN_1SIDE		= 3
OPENINGTYPE_MAIN_1MIDDLE	= 4

OPENINGTYPE_MAIN_SAMERAIL	= 1
OPENINGTYPE_MAIN_DIFFRAIL	= 2
OPENINGTYPE_MAIN_4SASHES	= 3

dim stOpeningTypeMain[]
if iWindowType = WIN_W6HorizontalSlide then
	stOpeningTypeMain[1] = ""
else
	if iWindowType = WIN_W2HorizontalSlide then
			stOpeningTypeMain[1] = `Одна Раздвижная`
			stOpeningTypeMain[2] = `Двойная Раздвижная`
	endif
	
	if iWindowType = WIN_W3HorizontalSlide then
			stOpeningTypeMain[1] = `2 Раздвижные Створки`
			stOpeningTypeMain[2] = `3 Раздвижные Створки`
			stOpeningTypeMain[3] = `1 Раздвижная Створка (Боковая)`
			stOpeningTypeMain[4] = `1 Раздвижная Створка (Средняя)`
	endif
	
	if iWindowType = WIN_W4HorizontalSlide then
			stOpeningTypeMain[1] = `Средние Раздвижные Створки (Одна Направляющая)`
			stOpeningTypeMain[2] = `Средние Раздвижные Створки (Разные Направляющие)`
			stOpeningTypeMain[3] = `4 Раздвижные Створки`
	endif
endif

! iUTrans
TRANSOM_NONE		= 0
TRANSOM_4SASHES		= 1
TRANSOM_2SASHES		= 2
TRANSOM_3SASHES		= 3
TRANSOM_UNDIVIDED	= 4

dim stTransomType[]
if iWindowType = WIN_W4HorizontalSlide then
	stTransomType[1] = `Нет`
	stTransomType[2] = `Тип 1`
	stTransomType[3] = `Тип 2`
	stTransomType[4] = `Тип 3`
	stTransomType[5] = `Тип 4`
else
	if iWindowType = WIN_W3HorizontalSlide then
		stTransomType[1] = `Нет`
		stTransomType[2] = `Разделенный`
		stTransomType[3] = `Единая`
	else
	   ! inicialize for WIN_W2HorizontalSlide
		stTransomType[1] = ""
	endif
endif

! iPanesSizeConfig
PANES_UNIFORM	= 1
PANES_CUSTOM	= 2

dim stPaneSizeConfig[2]
	stPaneSizeConfig[1] = `Одинаковое Остекление`
	stPaneSizeConfig[2] = `Специальный`


! --------------------------------------------------------------------------------
! Select Sash to Edit
! --------------------------------------------------------------------------------
dim _validSashID[]
dim _stValidSashName[]

_idx = 1
if iWindowType = WIN_W2HorizontalSlide then
	_validSashID[_idx] = 3
	_stValidSashName[_idx] = `Сторона 2`
	_idx = _idx + 1

	_validSashID[_idx] = 1
	_stValidSashName[_idx] = `Сторона 1`
	_idx = _idx + 1
endif

if iWindowType = WIN_W3HorizontalSlide then
	_validSashID[_idx] = 3
	_stValidSashName[_idx] = `Основная 1`
	_idx = _idx + 1

	_validSashID[_idx] = 1
	_stValidSashName[_idx] = `Основная 2`
	_idx = _idx + 1

	_validSashID[_idx] = 4
	_stValidSashName[_idx] = `Основная 3`
	_idx = _idx + 1

	if iUTrans <> TRANSOM_NONE then
		_validSashID[_idx] = 5
		if iUTrans = TRANSOM_UNDIVIDED then
			_stValidSashName[_idx] = `Вверху`
		else
			_stValidSashName[_idx] = `Верхняя Средняя`
		endif
		_idx = _idx + 1

		if iUTrans = TRANSOM_3SASHES then
			_validSashID[_idx] = 7
			_stValidSashName[_idx] = `Верхняя Боковая`
			_idx = _idx + 1
		endif
	endif 
endif

if iWindowType = WIN_W4HorizontalSlide then
	_validSashID[_idx] = 3
	_stValidSashName[_idx] = `Боковая`
	_idx = _idx + 1

	_validSashID[_idx] = 1
	_stValidSashName[_idx] = `Основная`
	_idx = _idx + 1

	if iUTrans = TRANSOM_4SASHES | iUTrans = TRANSOM_3SASHES | iUTrans = TRANSOM_2SASHES then
		_validSashID[_idx] = 7

		if iUTrans = TRANSOM_3SASHES | iUTrans = TRANSOM_4SASHES then
			_stValidSashName[_idx] = `Верхняя Боковая`
		else
			_stValidSashName[_idx] = `Верхняя 2`
		endif
		_idx = _idx + 1
	endif
	if iUTrans <> TRANSOM_NONE then
		_validSashID[_idx] = 5
		if iUTrans = TRANSOM_UNDIVIDED then
			_stValidSashName[_idx] = `Вверху`
		else
			if iUTrans = TRANSOM_3SASHES | iUTrans = TRANSOM_4SASHES then
				_stValidSashName[_idx] = `Верхняя Средняя`
			else
				_stValidSashName[_idx] = `Верхняя 1`
			endif
		endif
		_idx = _idx + 1
	endif
endif

if iWindowType = WIN_W6HorizontalSlide then
	_validSashID[_idx] = 5
	_stValidSashName[_idx] = `Сторона 2`
	_idx = _idx + 1

	_validSashID[_idx] = 3
	_stValidSashName[_idx] = `Сторона 1`
	_idx = _idx + 1

	_validSashID[_idx] = 1
	_stValidSashName[_idx] = `Середина`
	_idx = _idx + 1
endif

! =============================================================================
! Localization
! =============================================================================

dim stDetail[6]
	stDetail[1] = `Зависит от Масштаба`
	stDetail[2] = `Детальный`
	stDetail[3] = `Простой`
	stDetail[4] = `Откл.`
	stDetail[5] = `Китайский Простой`
	stDetail[6] = `Китайский Детальный`

dim stSashType[17]
	stSashType[1] = `Без Раскладки`
	stSashType[2] = `Г/В-Раскладка`
	stSashType[3] = `Редактируемая Раскладка`
	stSashType[4] = `Специальная Створка`
	stSashType[5] = `Стиль Прерия`
	stSashType[6] = `Разделенный`
	stSashType[7] = `Солнечные Лучи 1`
	stSashType[8] = `Солнечные Лучи 2`
	stSashType[9] = `Солнечные Лучи 3`
	stSashType[10] = `Солнечные Лучи 4`
	stSashType[11] = `Солнечные Лучи 5`
	stSashType[12] = `Солнечные Лучи 6`
	stSashType[13] = `Сплошное Остекление`
	stSashType[14] = `Разделенная Рама`
	stSashType[15] = `Сплошная Панель`
	stSashType[16] = `Вентиляционная Створка`
	stSashType[17] = `Французская Панель`

dim stMullionPosition[3]
	stMullionPosition[1] = `Снаружи`
	stMullionPosition[2] = `Внутри`
	stMullionPosition[3] = `Посередине`

dim stVentilationProfileType[3]
	stVentilationProfileType[1] = `Нет`
	stVentilationProfileType[2] = `В Раме`
	stVentilationProfileType[3] = `В Остеклении`

dim st_optype[]
	st_optype[1] = `Фиксированное Остекление`
	st_optype[2] = `Раздвижная`
	st_optype[3] = `Распашная`
	st_optype[4] = `Распашная Зеркальная`
	st_optype[5] = `Нижнеподвесная`
	st_optype[6] = `Верхнеподвесная`
	st_optype[7] = `Наклонно-Поворотная `
	st_optype[8] = `Наклонно-Поворотная Зеркальная`
	st_optype[9] = `Среднеповоротная Вертикальная`

! =============================================================================
! Window Handle Type Enable
! =============================================================================

iHandleCategoryEnable	= 1 + 4 + 128

! =============================================================================
! Ventilation Profile Type Enable
! =============================================================================

bEnableVentilationProfile = 1
gs_VentilationProfileTypeEnable = 1+2

if not(bEnableVentilationProfile & bVentilationProfile & (iVentilationProfileType = VENTPROFILE_OVER_GLAZING)) then
	isVentilationProfileInSash_01	= 0
	isVentilationProfileInSash_02	= 0
	isVentilationProfileInSash_03	= 0
	isVentilationProfileInSash_04	= 0
	isVentilationProfileInSash_05	= 0
	isVentilationProfileInSash_06	= 0
	isVentilationProfileInSash_07	= 0
	isVentilationProfileInSash_08	= 0
endif

! =============================================================================
! Other Enable Functions
! =============================================================================

bEnableParapetInset	= 1
bEnableMasonryArch	= 1
bEnableSill			= 1
bEnableBoard		= 1
bEnableFaschen		= 0
bEnableThreshold	= 0
bEnableCasing		= 1
bEnableShutter		= 1
bEnableCustomCornerLeft		= 1
bEnableCustomCornerRight	= 1

stack_mask_l = 13
if gs_stack_left then stack_mask_l = 8
stack_mask_r = 13
if gs_stack_right then stack_mask_r = 8

stack_mask_b = 15
if gs_stack_bottom then stack_mask_b = 8
stack_mask_t = 15
if gs_stack_top then stack_mask_t = 8

! =============================================================================
! Uniform Frame Width
! =============================================================================

if gs_uniform_framewidth then
	gs_frame_width_left		= gs_frame_width
	gs_frame_width_upper	= gs_frame_width
	gs_frame_width_lower	= gs_frame_width

	if _bPossibleTransom then
		gs_UTrans_w				= gs_frame_width
		gs_Mullion_w			= gs_frame_width
	endif
endif

if _bPossibleTransom then
	gs_Mullion_w_mid		= gs_Mullion_w
	gs_Mullion_w_left		= gs_Mullion_w
endif


! =============================================================================
! Sash thickness calculations
! =============================================================================
_iNumberOfRails = 1

if iWindowType = WIN_W2HorizontalSlide | iWindowType = WIN_W4HorizontalSlide then
	_iNumberOfRails = 2
endif

if iWindowType = WIN_W3HorizontalSlide then
	if iOpeningTypeMain = OPENINGTYPE_MAIN_3SASHES then
		_iNumberOfRails = 3
	else
		_iNumberOfRails = 2
	endif
endif

if iWindowType = WIN_W6HorizontalSlide then
	if iNumberOfRails = RAILSNUMBER_2 then
		_iNumberOfRails = 2
	else
		_iNumberOfRails = 3
	endif
endif

_slidingSashThk = gs_frame_thk / _iNumberOfRails

! =============================================================================
! Sash width configurations
! =============================================================================
if iWindowType = WIN_W2HorizontalSlide then
	if iPanesSizeConfig = PANES_UNIFORM then
		sashWidth1 = (ac_unit_width - gs_frame_width - gs_frame_width_left - gs_sash_width * 3) / 2 + gs_sash_width * 2
		sashWidth2 = sashWidth1
	else
		! sashWidth1 is editable only
		sashWidth2 = ac_unit_width - gs_frame_width - gs_frame_width_left - sashWidth1 + gs_sash_width
	endif
	parameters sashWidth1 = sashWidth1
endif

if iWindowType = WIN_W3HorizontalSlide then
	if iPanesSizeConfig = PANES_UNIFORM then
		if iOpeningTypeMain = OPENINGTYPE_MAIN_1SIDE then
			sashWidth1 = (ac_unit_width - gs_frame_width - gs_frame_width_left + gs_sash_width) / 3
		else
			if iOpeningTypeMain = OPENINGTYPE_MAIN_1MIDDLE then
				sashWidth1 = (ac_unit_width - gs_frame_width - gs_frame_width_left - gs_sash_width * 5) / 3 + gs_sash_width * 2
			endif
			if iOpeningTypeMain = OPENINGTYPE_MAIN_2SASHES | iOpeningTypeMain = OPENINGTYPE_MAIN_3SASHES then 
				sashWidth1 = (ac_unit_width - gs_frame_width - gs_frame_width_left - gs_sash_width * 4) / 3 + gs_sash_width * 2
			endif
		endif
		sashWidth2 = sashWidth1
		sashWidth3 = sashWidth1
	else
		if iOpeningTypeMain = OPENINGTYPE_MAIN_1MIDDLE then
			sashWidth3 = sashWidth2
		endif
		if iOpeningTypeMain = OPENINGTYPE_MAIN_1SIDE then
			sashWidth3 = sashWidth2
		endif
		if iOpeningTypeMain = OPENINGTYPE_MAIN_2SASHES | iOpeningTypeMain = OPENINGTYPE_MAIN_3SASHES then 
			sashWidth3 = sashWidth1
		endif
	endif
	parameters	sashWidth1 = sashWidth1,
				sashWidth2 = sashWidth2
endif

if iWindowType = WIN_W4HorizontalSlide then
	if iPanesSizeConfig = PANES_UNIFORM then
		if iOpeningTypeMain = OPENINGTYPE_MAIN_SAMERAIL then
			sashWidth1 = (ac_unit_width - gs_frame_width - gs_frame_width_left - gs_sash_width * 6) / 4 + gs_sash_width * 2
		else
			sashWidth1 = (ac_unit_width - gs_frame_width - gs_frame_width_left - gs_sash_width * 5) / 4 + gs_sash_width * 2
		endif
		sashWidth2 = sashWidth1
		sashWidth3 = sashWidth1
		_sashWidth4 = sashWidth1
	else
		if iOpeningTypeMain = OPENINGTYPE_MAIN_SAMERAIL then
			! sashWidth2 is editable only
			sashWidth1 = (ac_unit_width - gs_frame_width - gs_frame_width_left)/2 - sashWidth2 + gs_sash_width
			sashWidth3 = sashWidth2
			_sashWidth4 = sashWidth1
		else
			_sashWidth4 = ac_unit_width - gs_frame_width - gs_frame_width_left - sashWidth1 - sashWidth2 - sashWidth3 + 3*gs_sash_width
		endif
	endif
	parameters	sashWidth1 = sashWidth1,
				sashWidth2 = sashWidth2,
				sashWidth3 = sashWidth3
endif

if iWindowType = WIN_W6HorizontalSlide then
	if iNumberOfRails = RAILSNUMBER_2 then
		sashWidth1 = (ac_unit_width - gs_frame_width - gs_frame_width_left - gs_sash_width * 7) / 6 + gs_sash_width * 2
	else
		sashWidth1 = ((ac_unit_width - gs_frame_width - gs_frame_width_left) / 2 - gs_sash_width * 4) / 3 + gs_sash_width * 2
	endif
	sashWidth2 = sashWidth1
	sashWidth3 = sashWidth1
endif


! =============================================================================
! Sub-optypes and opening lengths
! =============================================================================
gs_optype_m_01	= SASH_FIXED
gs_optype_m_02	= SASH_FIXED
gs_optype_m_03	= SASH_FIXED
gs_optype_m_04	= SASH_FIXED
gs_optype_m_05	= SASH_FIXED
gs_optype_m_06	= SASH_FIXED
gs_optype_m_07	= SASH_FIXED
gs_optype_m_08	= SASH_FIXED

openingMaxLength_01 = 0
openingMaxLength_02 = 0
openingMaxLength_03 = 0
openingMaxLength_04 = 0
openingMaxLength_05 = 0
openingMaxLength_06 = 0

if iWindowType = WIN_W2HorizontalSlide then
	if iOpeningTypeMain = OPENINGTYPE_MAIN_SINGLE then
		gs_optype_m_01 = SASH_LEFT_SLIDING
		gs_optype_m_03 = SASH_FIXED_SLIDE

		openingMaxLength_03 = 0
	endif
	if iOpeningTypeMain = OPENINGTYPE_MAIN_DOUBLE then
		gs_optype_m_01 = SASH_LEFT_SLIDING
		gs_optype_m_03 = SASH_RIGHT_SLIDING

		openingMaxLength_03 = sashWidth1-gs_sash_width
	endif

	openingMaxLength_01 = sashWidth2-gs_sash_width
endif

if iWindowType = WIN_W3HorizontalSlide then
	if iOpeningTypeMain = OPENINGTYPE_MAIN_2SASHES then
		gs_optype_m_03 = SASH_RIGHT_SLIDING
		gs_optype_m_01 = SASH_FIXED_SLIDE
		gs_optype_m_04 = SASH_LEFT_SLIDING

		openingMaxLength_03 = (sashWidth2-2*gs_sash_width-openingLength_04)
		openingMaxLength_01 = 0
		openingMaxLength_04 = (sashWidth2-2*gs_sash_width-openingLength_03)
	endif

	if iOpeningTypeMain = OPENINGTYPE_MAIN_3SASHES then
		gs_optype_m_03 = SASH_RIGHT_SLIDING
		gs_optype_m_01 = SASH_RIGHT_SLIDING
		gs_optype_m_04 = SASH_LEFT_SLIDING

		openingMaxLength_03 = (sashWidth2 + sashWidth3)-2*gs_sash_width
		openingMaxLength_01 = sashWidth3-gs_sash_width
		openingMaxLength_04 = (sashWidth1 + sashWidth2)-2*gs_sash_width
	endif

	if iOpeningTypeMain = OPENINGTYPE_MAIN_1SIDE then
		gs_optype_m_03 = SASH_RIGHT_SLIDING
		gs_optype_m_01 = SASH_FIXED_SLIDE
		gs_optype_m_04 = SASH_FIXED_SLIDE

		openingMaxLength_03 = (sashWidth2 + sashWidth3)-gs_sash_width
		openingMaxLength_01 = 0
		openingMaxLength_04 = 0
	endif

	if iOpeningTypeMain = OPENINGTYPE_MAIN_1MIDDLE then
		gs_optype_m_03 = SASH_FIXED_SLIDE
		gs_optype_m_01 = SASH_RIGHT_SLIDING
		gs_optype_m_04 = SASH_FIXED_SLIDE

		openingMaxLength_03 = 0
		openingMaxLength_01 = sashWidth3-gs_sash_width
		openingMaxLength_04 = 0
	endif
endif

if iWindowType = WIN_W4HorizontalSlide then
	if iOpeningTypeMain = OPENINGTYPE_MAIN_SAMERAIL | iOpeningTypeMain = OPENINGTYPE_MAIN_DIFFRAIL then
		gs_optype_m_03 = SASH_FIXED_SLIDE
		gs_optype_m_01 = SASH_LEFT_SLIDING
		gs_optype_m_02 = SASH_RIGHT_SLIDING
		gs_optype_m_04 = SASH_FIXED_SLIDE

		openingMaxLength_03 = 0
		openingMaxLength_01 = sashWidth1-gs_sash_width
		openingMaxLength_02 = _sashWidth4-gs_sash_width
		openingMaxLength_04 = 0
	endif

	if iOpeningTypeMain = OPENINGTYPE_MAIN_4SASHES then
		gs_optype_m_03 = SASH_RIGHT_SLIDING
		gs_optype_m_01 = SASH_LEFT_SLIDING
		gs_optype_m_02 = SASH_RIGHT_SLIDING
		gs_optype_m_04 = SASH_LEFT_SLIDING

		openingMaxLength_03 = sashWidth2-2*gs_sash_width
		openingMaxLength_01 = sashWidth1-gs_sash_width
		openingMaxLength_02 = _sashWidth4-gs_sash_width
		openingMaxLength_04 = sashWidth3-2*gs_sash_width
	endif
endif

if iWindowType = WIN_W6HorizontalSlide then
	if iNumberOfRails = RAILSNUMBER_2 then
		gs_optype_m_01	= SASH_RIGHT_SLIDING
		gs_optype_m_02	= SASH_LEFT_SLIDING
		gs_optype_m_03	= SASH_LEFT_SLIDING
		gs_optype_m_04	= SASH_RIGHT_SLIDING
		gs_optype_m_05	= SASH_RIGHT_SLIDING
		gs_optype_m_06	= SASH_LEFT_SLIDING
	
		openingMaxLength_01 = sashWidth1 - gs_sash_width * 2
		openingMaxLength_02 = sashWidth1 - gs_sash_width * 2
		openingMaxLength_03 = sashWidth1 - gs_sash_width
		openingMaxLength_04 = sashWidth1 - gs_sash_width
		openingMaxLength_05 = sashWidth1 - gs_sash_width * 2
		openingMaxLength_06 = sashWidth1 - gs_sash_width * 2
	else
		gs_optype_m_01	= SASH_LEFT_SLIDING
		gs_optype_m_02	= SASH_RIGHT_SLIDING
		gs_optype_m_03	= SASH_LEFT_SLIDING
		gs_optype_m_04	= SASH_RIGHT_SLIDING
		gs_optype_m_05	= SASH_RIGHT_SLIDING
		gs_optype_m_06	= SASH_LEFT_SLIDING
	
		openingMaxLength_01 = sashWidth1 * 2 - gs_sash_width * 2
		openingMaxLength_02 = sashWidth1 * 2 - gs_sash_width * 2
		openingMaxLength_03 = 0
		openingMaxLength_04 = 0
		openingMaxLength_05 = 0
		openingMaxLength_06 = 0
	endif
endif

! =============================================================================
! Transom settings
! =============================================================================
if _bPossibleTransom then
	gs_UTrans = (iUTrans > 0)
	
	if gs_UTrans then
		! Upper main Transom Sashes
		gs_optype_m_05 = SASH_FIXED	
		gs_optype_m_06 = SASH_FIXED

		if iOpeningTypeTransMain = SASH_SIDE_HUNG then
			gs_optype_m_05 = SASH_SIDE_HUNG	
			gs_optype_m_06 = SASH_SIDE_HUNG_M		! might change(3 or 1)
		endif
		if iOpeningTypeTransMain = SASH_SIDE_HUNG_M then
			gs_optype_m_05 = SASH_SIDE_HUNG_M
			gs_optype_m_06 = SASH_SIDE_HUNG			! might change(3 or 1)
		endif
		if iOpeningTypeTransMain = SASH_BOTTOM_HUNG then
			gs_optype_m_05 = SASH_BOTTOM_HUNG
			gs_optype_m_06 = SASH_BOTTOM_HUNG		
		endif
		if iOpeningTypeTransMain = SASH_TOP_HUNG then
			gs_optype_m_05 = SASH_TOP_HUNG
			gs_optype_m_06 = SASH_TOP_HUNG
		endif
		if iOpeningTypeTransMain = SASH_TILT_TURN then
			gs_optype_m_05 = SASH_TILT_TURN
			gs_optype_m_06 = SASH_TILT_TURN_M		! might change(30 or 31)
		endif
		if iOpeningTypeTransMain = SASH_TILT_TURN_M then
			gs_optype_m_05 = SASH_TILT_TURN_M
			gs_optype_m_06 = SASH_TILT_TURN			! might change(30 or 31)
		endif
	
		! Upper Side Transom Sashes
		gs_optype_m_07 = SASH_FIXED	
		gs_optype_m_08 = SASH_FIXED

		if iOpeningTypeTransSide = SASH_SIDE_HUNG then
			gs_optype_m_07 = SASH_SIDE_HUNG_M
			gs_optype_m_08 = SASH_SIDE_HUNG			! might change(3 or 1)
		endif
		if iOpeningTypeTransSide = SASH_SIDE_HUNG_M then
			gs_optype_m_07 = SASH_SIDE_HUNG	
			gs_optype_m_08 = SASH_SIDE_HUNG_M		! might change(3 or 1)
		endif
		if iOpeningTypeTransSide = SASH_BOTTOM_HUNG then
			gs_optype_m_07 = SASH_BOTTOM_HUNG
			gs_optype_m_08 = SASH_BOTTOM_HUNG
		endif
		if iOpeningTypeTransSide = SASH_TOP_HUNG then
			gs_optype_m_07 = SASH_TOP_HUNG
			gs_optype_m_08 = SASH_TOP_HUNG
		endif
		if iOpeningTypeTransSide = SASH_TILT_TURN then
			gs_optype_m_07 = SASH_TILT_TURN
			gs_optype_m_08 = SASH_TILT_TURN_M		! might change(30 or 31)
		endif
		if iOpeningTypeTransSide = SASH_TILT_TURN_M then
			gs_optype_m_07 = SASH_TILT_TURN_M
			gs_optype_m_08 = SASH_TILT_TURN			! might change (30 or 31)
		endif
	endif
endif

! =============================================================================
! Sash Types
! =============================================================================
_bHasCustomPanel = 0
_actSashType = MULLION_NONE
gosub "actualSashTypeVar"


! =============================================================================
! Casement IDs
! =============================================================================
dim CasementIDArray[][]
if iWindowType = WIN_W2HorizontalSlide then
	gs_panes_number = 2

	CasementIDArray[1][1]	= 0
	CasementIDArray[1][2]	= 0

	CasementIDArray[2][1]	= 3
	CasementIDArray[2][2]	= 1

	CasementIDArray[3][1]	= 0
	CasementIDArray[3][2]	= 0
endif

if iWindowType = WIN_W3HorizontalSlide then
	gs_panes_number = 3 + 1*(iUTrans <> TRANSOM_NONE) + 2*(iUTrans = TRANSOM_3SASHES)

	CasementIDArray[1][1]	= 7 * (iUTrans = TRANSOM_3SASHES)
	CasementIDArray[1][2]	= 5 * (iUTrans <> TRANSOM_NONE)
	CasementIDArray[1][3]	= 8 * (iUTrans = TRANSOM_3SASHES)

	CasementIDArray[2][1]	= 3
	CasementIDArray[2][2]	= 1
	CasementIDArray[2][3]	= 4

	CasementIDArray[3][1]	= 0
	CasementIDArray[3][2]	= 0
	CasementIDArray[3][3]	= 0
endif

if iWindowType = WIN_W4HorizontalSlide then
	gs_panes_number = 4 + 1*(iUTrans = TRANSOM_UNDIVIDED) + 2*(iUTrans = TRANSOM_2SASHES) + 3*(iUTrans = TRANSOM_3SASHES) + 4*(iUTrans = TRANSOM_4SASHES)

	CasementIDArray[1][1]	= 7 * ((iUTrans <> TRANSOM_NONE) & (iUTrans <> TRANSOM_UNDIVIDED))
	CasementIDArray[1][2]	= 5 * (iUTrans <> TRANSOM_NONE)
	CasementIDArray[1][3]	= 6 * (iUTrans = TRANSOM_4SASHES)
	CasementIDArray[1][4]	= 8 * ((iUTrans = TRANSOM_3SASHES) | (iUTrans = TRANSOM_4SASHES))

	CasementIDArray[2][1]	= 3
	CasementIDArray[2][2]	= 1
	CasementIDArray[2][3]	= 2
	CasementIDArray[2][4]	= 4

	CasementIDArray[3][1]	= 0
	CasementIDArray[3][2]	= 0
	CasementIDArray[3][3]	= 0
	CasementIDArray[3][4]	= 0
endif

if iWindowType = WIN_W6HorizontalSlide then
	gs_panes_number = 6

	CasementIDArray[1][1]	= 0
	CasementIDArray[1][2]	= 0
	CasementIDArray[1][3]	= 0
	CasementIDArray[1][4]	= 0
	CasementIDArray[1][5]	= 0
	CasementIDArray[1][6]	= 0
	
	CasementIDArray[2][1]	= 1
	CasementIDArray[2][2]	= 2
	CasementIDArray[2][3]	= 3
	CasementIDArray[2][4]	= 4
	CasementIDArray[2][5]	= 5
	CasementIDArray[2][6]	= 6
	
	CasementIDArray[3][1]	= 0
	CasementIDArray[3][2]	= 0
	CasementIDArray[3][3]	= 0
	CasementIDArray[3][4]	= 0
	CasementIDArray[3][5]	= 0
	CasementIDArray[3][6]	= 0
endif


! --------------------------------------------------------------------------------
! Check lock cases
! --------------------------------------------------------------------------------
bLockMullionParams			= 0
bLockMullionSizeParams		= 0
bLockGlassParams			= 0
bLockSashFrameParams		= 0
bLockSolidPanelParams		= 0
bLockVentPanelParams		= 0

! if UI or Paramscript
if GLOB_SCRIPT_TYPE = 4 | GLOB_SCRIPT_TYPE = 5 then
	call "casement_paramhandling_m" parameters	iWindowType			= iWindowType,
											gs_bLeftSLight		= 0,
											gs_bSLight			= 0,
											gs_UTrans			= gs_UTrans,
											gs_UTrans_Div		= 0,
											gs_LTrans			= 0,
											gs_LTrans_Div		= 0,
											gs_sash_uniform		= gs_sash_uniform,
											gs_panes_number		= gs_panes_number,
											CasementIDArray		= CasementIDArray,
											iMullionStyle_00	= iMullionStyle_00,
											iMullionStyle_01	= iMullionStyle_01,
											iMullionStyle_02	= iMullionStyle_02,
											iMullionStyle_03	= iMullionStyle_03,
											iMullionStyle_04	= iMullionStyle_04,
											iMullionStyle_05	= iMullionStyle_05,
											iMullionStyle_06	= iMullionStyle_06,
											iMullionStyle_07	= iMullionStyle_07,
											iMullionStyle_08	= iMullionStyle_08,
											gs_optype_m_01		= gs_optype_m_01,
											gs_optype_m_02		= gs_optype_m_02,
											gs_optype_m_03		= gs_optype_m_03,
											gs_optype_m_04		= gs_optype_m_04,
											gs_optype_m_05		= gs_optype_m_05,
											gs_optype_m_06		= gs_optype_m_06,
											gs_optype_m_07		= gs_optype_m_07,
											gs_optype_m_08		= gs_optype_m_08,
								returned_parameters bLockMullionParams,
													bLockMullionSizeParams,
													bLockGlassParams,
													bLockSashFrameParams,
													dummy,
													bLockSolidPanelParams,
													bLockVentPanelParams,
													dummy,
													dummy
endif

! =============================================================================
! Grid recalculate
! =============================================================================
_idxSash = 1
dim _sashID[]
dim _sashWidth[]
dim _sashHeight[]
dim _bTransomSash[]
dim _addTransRebate[]

gosub "sashDefinitions"

_idx = 1
dim _bEditAllGridPars[]
	_bEditAllGridPars[_idx] = (GLOB_MODPAR_NAME = "A")							: _idx =_idx + 1
	_bEditAllGridPars[_idx] = (GLOB_MODPAR_NAME = "B") 						: _idx =_idx + 1
	_bEditAllGridPars[_idx] = (GLOB_MODPAR_NAME = "ac_unit_width" )			: _idx =_idx + 1
	_bEditAllGridPars[_idx] = (GLOB_MODPAR_NAME = "ac_unit_height" )			: _idx =_idx + 1
	_bEditAllGridPars[_idx] = (GLOB_MODPAR_NAME = "gs_tolerance")				: _idx =_idx + 1
	_bEditAllGridPars[_idx] = (GLOB_MODPAR_NAME = "gs_frame_width")	 		: _idx =_idx + 1
	_bEditAllGridPars[_idx] = (GLOB_MODPAR_NAME = "gs_frame_width_left")		: _idx =_idx + 1
	_bEditAllGridPars[_idx] = (GLOB_MODPAR_NAME = "gs_frame_width_upper")		: _idx =_idx + 1
	_bEditAllGridPars[_idx] = (GLOB_MODPAR_NAME = "gs_frame_width_lower")		: _idx =_idx + 1
	_bEditAllGridPars[_idx] = (GLOB_MODPAR_NAME = "gs_sash_width")				: _idx =_idx + 1
	_bEditAllGridPars[_idx] = (GLOB_MODPAR_NAME = "gs_sash_uniform")			: _idx =_idx + 1
	_bEditAllGridPars[_idx] = (GLOB_MODPAR_NAME = "bVentilationProfile")		: _idx =_idx + 1
	_bEditAllGridPars[_idx] = (GLOB_MODPAR_NAME = "iMullionStyle_00")
_idx =_idx + 1
	_bEditAllGridPars[_idx] = bVentilationProfile & (iVentilationProfileType = VENTPROFILE_OVER_GLAZING) & (GLOB_MODPAR_NAME = "VentilationProfileHeight")
_idx =_idx + 1

if iWindowType <> WIN_W6HorizontalSlide then
	_bEditAllGridPars[_idx] = (GLOB_MODPAR_NAME = "iPanesSizeConfig")			: _idx =_idx + 1
endif

if _bPossibleTransom then
	_bEditAllGridPars[_idx] = (GLOB_MODPAR_NAME = "iUTrans")		: _idx =_idx + 1
	_bEditAllGridPars[_idx] = (GLOB_MODPAR_NAME = "gs_UTrans_w")	: _idx =_idx + 1
	_bEditAllGridPars[_idx] = (GLOB_MODPAR_NAME = "gs_Mullion_w")	: _idx =_idx + 1
	_bEditAllGridPars[_idx] = (GLOB_MODPAR_NAME = "gs_UTrans_h")	: _idx =_idx + 1
endif

if iWindowType = WIN_W2HorizontalSlide then
	_bEditAllGridPars[_idx] = (GLOB_MODPAR_NAME = "sashWidth1"	)			: _idx =_idx + 1
endif

if iWindowType = WIN_W3HorizontalSlide then
	_bEditAllGridPars[_idx] = (GLOB_MODPAR_NAME = "sashWidth1"	)			: _idx =_idx + 1
	_bEditAllGridPars[_idx] = (GLOB_MODPAR_NAME = "sashWidth2"	)			: _idx =_idx + 1
	_bEditAllGridPars[_idx] = (GLOB_MODPAR_NAME = "tempSashWidth2"	)		: _idx =_idx + 1
endif

if iWindowType = WIN_W4HorizontalSlide then
	_bEditAllGridPars[_idx] = (GLOB_MODPAR_NAME = "sashWidth1"	)			: _idx =_idx + 1
	_bEditAllGridPars[_idx] = (GLOB_MODPAR_NAME = "sashWidth2"	)			: _idx =_idx + 1
	_bEditAllGridPars[_idx] = (GLOB_MODPAR_NAME = "sashWidth3"	)			: _idx =_idx + 1
	_bEditAllGridPars[_idx] = (GLOB_MODPAR_NAME = "iOpeningTypeMain"	)	: _idx =_idx + 1
endif

if iWindowType = WIN_W6HorizontalSlide then
	_bEditAllGridPars[_idx] = (GLOB_MODPAR_NAME = "iOpeningTypeMain"	)	: _idx =_idx + 1
endif

_bResetAllGrids = 0
for _iPar = 1 to vardim1(_bEditAllGridPars)
	if _bEditAllGridPars[_iPar] then
		_bResetAllGrids = 1
		_nameModPar = _bEditAllGridPars[_iPar]
	endif
next _iPar

_dLedgeOffsetY = sashLedgeHeight * bSashLedge

for _nSash = 1 to vardim1(_sashID)
	if _sashID[_nSash] = 1 then
		if	(not(gs_sash_uniform) & GLOB_MODPAR_NAME = "iMullionStyle_01")	|\
			GLOB_MODPAR_NAME = "vgn_01"	|\
			GLOB_MODPAR_NAME = "hgn_01"	|\
			GLOB_MODPAR_NAME = "vgn2_01"	|\
			GLOB_MODPAR_NAME = "hgn2_01"	|\
			GLOB_MODPAR_NAME = "gs_horiz_div_height_01"	|\
			GLOB_MODPAR_NAME = "bSashLedge"	|\
			GLOB_MODPAR_NAME = "tempSashWidth2" |\
			(bSashLedge & GLOB_MODPAR_NAME = "sashLedgeHeight")	|\
			(bVentilationProfile & GLOB_MODPAR_NAME = "isVentilationProfileInSash_01") |\ 
			(vardim1(vergrid_01) < (vgn_01 - 1)) |\
			(vardim1(horgrid_01) < (hgn_01 - 1)) |\
			(((not(gs_sash_uniform) & iMullionStyle_01 = MULLION_DIVIDED) | (gs_sash_uniform & iMullionStyle_00 = MULLION_DIVIDED)) &\
				((vardim1(vergrid2_01) < (vgn2_01 - 1)) |\
				 (vardim1(horgrid2_01) < (hgn2_01 - 1)))) |\
			_bResetAllGrids then

			_ventSashMod = VentilationProfileHeight * isVentilationProfileInSash_01

			if not(gs_sash_uniform) & iMullionStyle_01 = MULLION_DIVIDED | \
				(gs_sash_uniform & iMullionStyle_00 = MULLION_DIVIDED) then

				gridHeight = gs_horiz_div_height_01 - gs_sash_width - _dLedgeOffsetY

				for i=1 to vgn_01-1
					 parameters vergrid_01[i][1] = i * (_sashWidth[_nSash] - 2 * gs_sash_width + gw) / (vgn_01)
					 parameters vergrid_01[i][2] = gs_sash_width + _dLedgeOffsetY
					 parameters vergrid_01[i][3] = gridHeight + _dLedgeOffsetY
				next i
	
				for i=1 to hgn_01-1
					parameters horgrid_01[i][1] = _dLedgeOffsetY + i*(gridHeight - gs_sash_width + gw) / (hgn_01)
					parameters horgrid_01[i][2] = gs_sash_width
					parameters horgrid_01[i][3] = _sashWidth[_nSash] - gs_sash_width
				next i

				for i=1 to vgn2_01-1
					 parameters vergrid2_01[i][1] = i * (_sashWidth[_nSash] - 2 * gs_sash_width + gw) / (vgn2_01)
					 parameters vergrid2_01[i][2] = gs_horiz_div_height_01
					 parameters vergrid2_01[i][3] = _sashHeight[_nSash] - gs_sash_width - _ventSashMod
				next i

				for i=1 to hgn2_01-1
					parameters horgrid2_01[i][1] = (gs_horiz_div_height_01-gs_sash_width)+ i*(_sashHeight[_nSash] - gs_sash_width - _ventSashMod - gs_horiz_div_height_01 + gw) / (hgn2_01)
					parameters horgrid2_01[i][2] = gs_sash_width
					parameters horgrid2_01[i][3] = _sashWidth[_nSash] - gs_sash_width
				next i
			else
				for i = 1 to vgn_01-1
					parameters vergrid_01[i][1] = i*(_sashWidth[_nSash] - 2*gs_sash_width + gw)/(vgn_01)
					parameters vergrid_01[i][2] = gs_sash_width + _dLedgeOffsetY
					parameters vergrid_01[i][3] = _sashHeight[_nSash] - gs_sash_width - _ventSashMod
				next i
	
				for i = 1 to hgn_01-1
					parameters horgrid_01[i][1] = _dLedgeOffsetY + i*(_sashHeight[_nSash]-2*gs_sash_width+gw - _ventSashMod - _dLedgeOffsetY)/(hgn_01)
					parameters horgrid_01[i][2] = gs_sash_width
					parameters horgrid_01[i][3] = _sashWidth[_nSash] - gs_sash_width
				next i
			endif
		endif
	endif

	if _sashID[_nSash] = 2 then
		if	(not(gs_sash_uniform) & GLOB_MODPAR_NAME = "iMullionStyle_01")	|\	! sashID 1-2 pair
			GLOB_MODPAR_NAME = "vgn_01"	|\
			GLOB_MODPAR_NAME = "hgn_01"	|\
			GLOB_MODPAR_NAME = "gs_horiz_div_height_02"	|\
			GLOB_MODPAR_NAME = "bSashLedge"	|\
			(bSashLedge & GLOB_MODPAR_NAME = "sashLedgeHeight")	|\
			(bVentilationProfile & GLOB_MODPAR_NAME = "isVentilationProfileInSash_02") |\ 
			(vardim1(vergrid_02) < (vgn_02 - 1)) |\
			(vardim1(horgrid_02) < (hgn_02 - 1)) |\
			_bResetAllGrids then

			_ventSashMod = VentilationProfileHeight * isVentilationProfileInSash_02
			for i = 1 to vgn_02-1
				parameters vergrid_02[i][1] = i*(_sashWidth[_nSash]-2*gs_sash_width+gw)/(vgn_02)
				parameters vergrid_02[i][2] = gs_sash_width + _dLedgeOffsetY
				parameters vergrid_02[i][3] = _sashHeight[_nSash]-gs_sash_width - _ventSashMod
			next i

			for i = 1 to hgn_02-1
				parameters horgrid_02[i][1] = _dLedgeOffsetY + i*(_sashHeight[_nSash]-2*gs_sash_width+gw - _ventSashMod - _dLedgeOffsetY)/(hgn_02)
				parameters horgrid_02[i][2] = gs_sash_width
				parameters horgrid_02[i][3] = _sashWidth[_nSash] - gs_sash_width
			next i
		endif
	endif

	if _sashID[_nSash] = 3 then

		if gs_sash_uniform & (iMullionStyle_00 = MULLION_DIVIDED) then
			! use sash 1 parameters for sash 3 calculations
			vgn_03 = vgn_01
			hgn_03 = hgn_01
			vgn2_03 = vgn2_01
			hgn2_03 = hgn2_01
		else
			if (gs_sash_uniform & (iMullionStyle_00 = MULLION_EDITABLEGRID)) then
				! use sash 1 parameters for sash 3 calculations
				vgn_03 = vgn_01
				hgn_03 = hgn_01
			endif
		endif

		if	(not(gs_sash_uniform) & GLOB_MODPAR_NAME = "iMullionStyle_03")	|\
			GLOB_MODPAR_NAME = "vgn_03"	|\
			GLOB_MODPAR_NAME = "hgn_03"	|\
			GLOB_MODPAR_NAME = "vgn2_03"	|\
			GLOB_MODPAR_NAME = "hgn2_03"	|\
			GLOB_MODPAR_NAME = "gs_horiz_div_height_03"	|\
			GLOB_MODPAR_NAME = "bSashLedge"	|\
			(bSashLedge & GLOB_MODPAR_NAME = "sashLedgeHeight")	|\
			bVentilationProfile & GLOB_MODPAR_NAME = "isVentilationProfileInSash_03" |\ 
			(gs_sash_uniform & (iMullionStyle_00 = MULLION_DIVIDED) & \
				((GLOB_MODPAR_NAME = "gs_horiz_div_height_01") | (GLOB_MODPAR_NAME = "vgn_01") | (GLOB_MODPAR_NAME = "hgn_01") |\
				(GLOB_MODPAR_NAME = "vgn2_01") | (GLOB_MODPAR_NAME = "hgn2_01"))) |\
			(vardim1(vergrid_03) < (vgn_03 - 1)) |\
			(vardim1(horgrid_03) < (hgn_03 - 1)) |\
			(((not(gs_sash_uniform) & iMullionStyle_03 = MULLION_DIVIDED) | (gs_sash_uniform & iMullionStyle_00 = MULLION_DIVIDED)) &\
				((vardim1(vergrid2_03) < (vgn2_03 - 1)) |\
				 (vardim1(horgrid2_03) < (hgn2_03 - 1)))) |\
			_bResetAllGrids then

			_ventSashMod = VentilationProfileHeight * isVentilationProfileInSash_03

			if (not(gs_sash_uniform) & iMullionStyle_03 = MULLION_DIVIDED) |\
				(gs_sash_uniform & (iMullionStyle_00 = MULLION_DIVIDED)) then

				if gs_sash_uniform & (iMullionStyle_00 = MULLION_DIVIDED) then
					! use sash 1 parameters for sash 3 calculations
					gridHeight = gs_horiz_div_height_01 - gs_sash_width - _dLedgeOffsetY

					gs_horiz_div_height_03 = gs_horiz_div_height_01
				else
					gridHeight = gs_horiz_div_height_03 - gs_sash_width - _dLedgeOffsetY
				endif

				for i=1 to vgn_03-1
					 parameters vergrid_03[i][1] = i * (_sashWidth[_nSash] - 2 * gs_sash_width + gw) / (vgn_03)
					 parameters vergrid_03[i][2] = gs_sash_width + _dLedgeOffsetY
					 parameters vergrid_03[i][3] = gridHeight + _dLedgeOffsetY
				next i
	
				for i=1 to hgn_03-1
					parameters horgrid_03[i][1] = _dLedgeOffsetY + i*(gridHeight - gs_sash_width + gw) / (hgn_03)
					parameters horgrid_03[i][2] = gs_sash_width
					parameters horgrid_03[i][3] = _sashWidth[_nSash] - gs_sash_width
				next i

				for i=1 to vgn2_03-1
					 parameters vergrid2_03[i][1] = i * (_sashWidth[_nSash] - 2 * gs_sash_width + gw) / (vgn2_03)
					 parameters vergrid2_03[i][2] = gs_horiz_div_height_03
					 parameters vergrid2_03[i][3] = _sashHeight[_nSash] - gs_sash_width - _ventSashMod
				next i

				for i=1 to hgn2_03-1
					parameters horgrid2_03[i][1] = (gs_horiz_div_height_03-gs_sash_width) + i * (_sashHeight[_nSash] - gs_sash_width - _ventSashMod - gs_horiz_div_height_03 + gw) / (hgn2_03)
					parameters horgrid2_03[i][2] = gs_sash_width
					parameters horgrid2_03[i][3] = _sashWidth[_nSash] - gs_sash_width
				next i
			else
				for i = 1 to vgn_03-1
					parameters vergrid_03[i][1] = i*(_sashWidth[_nSash]-2*gs_sash_width+gw)/(vgn_03)
					parameters vergrid_03[i][2] = gs_sash_width + _dLedgeOffsetY
					parameters vergrid_03[i][3] = _sashHeight[_nSash]-gs_sash_width - _ventSashMod
				next i
	
				for i = 1 to hgn_03-1
					parameters horgrid_03[i][1] = _dLedgeOffsetY + i*(_sashHeight[_nSash]-2*gs_sash_width+gw - _ventSashMod - _dLedgeOffsetY)/(hgn_03)
					parameters horgrid_03[i][2] = gs_sash_width
					parameters horgrid_03[i][3] = _sashWidth[_nSash] - gs_sash_width
				next i
			endif
		endif
	endif

	if _sashID[_nSash] = 4 then
		if	(not(gs_sash_uniform) & GLOB_MODPAR_NAME = "iMullionStyle_04")	|\		! as standalone sash in W3
			(iWindowType = WIN_W6HorizontalSlide & GLOB_MODPAR_NAME = "iMullionStyle_03")	|\ ! as paired 3-4 in W6 sliding
			(iWindowType = WIN_W6HorizontalSlide & GLOB_MODPAR_NAME = "vgn_03")	|\ ! as paired 3-4 in W6 sliding
			(iWindowType = WIN_W6HorizontalSlide & GLOB_MODPAR_NAME = "hgn_03")	|\ ! as paired 3-4 in W6 sliding
			(iWindowType = WIN_W6HorizontalSlide & GLOB_MODPAR_NAME = "gs_horiz_div_height_03")	|\ ! as paired 3-4 in W6 sliding
			GLOB_MODPAR_NAME = "vgn_04"	|\	! as standalone sash in W3
			GLOB_MODPAR_NAME = "hgn_04"	|\	! as standalone sash in W3
			GLOB_MODPAR_NAME = "gs_horiz_div_height_04"	|\	! as standalone sash in W3
			GLOB_MODPAR_NAME = "bSashLedge"	|\
			(bSashLedge & GLOB_MODPAR_NAME = "sashLedgeHeight")	|\
			bVentilationProfile & GLOB_MODPAR_NAME = "isVentilationProfileInSash_04" |\ 
			(vardim1(vergrid_04) < (vgn_04 - 1)) |\
			(vardim1(horgrid_04) < (hgn_04 - 1)) |\
			_bResetAllGrids then

			_ventSashMod = VentilationProfileHeight * isVentilationProfileInSash_04

			for i = 1 to vgn_04-1
				parameters vergrid_04[i][1] = i*(_sashWidth[_nSash]-2*gs_sash_width+gw)/(vgn_04)
				parameters vergrid_04[i][2] = gs_sash_width + _dLedgeOffsetY
				parameters vergrid_04[i][3] = _sashHeight[_nSash] - gs_sash_width - _ventSashMod
			next i

			for i = 1 to hgn_04-1
				parameters horgrid_04[i][1] = _dLedgeOffsetY + i*(_sashHeight[_nSash]-2*gs_sash_width+gw - _ventSashMod - _dLedgeOffsetY)/(hgn_04)
				parameters horgrid_04[i][2] = gs_sash_width
				parameters horgrid_04[i][3] = _sashWidth[_nSash] - gs_sash_width
			next i
		endif
	endif

	if _sashID[_nSash] = 5 then
		_ventSashMod = VentilationProfileHeight * isVentilationProfileInSash_05

		if iWindowType = WIN_W3HorizontalSlide | iWindowType = WIN_W4HorizontalSlide  then
			if	(not(gs_sash_uniform) & GLOB_MODPAR_NAME = "iMullionStyle_05")	|\
				GLOB_MODPAR_NAME = "vgn_05"	|\
				GLOB_MODPAR_NAME = "hgn_05"	|\
				GLOB_MODPAR_NAME = "gs_horiz_div_height_05"	|\
				bVentilationProfile & GLOB_MODPAR_NAME = "isVentilationProfileInSash_05" |\
				GLOB_MODPAR_NAME = "gs_UTrans_w"	|\
				GLOB_MODPAR_NAME = "gs_UTrans_h"	|\
				GLOB_MODPAR_NAME = "gs_Mullion_w"	|\
				GLOB_MODPAR_NAME="iUTrans" |\			
				(vardim1(vergrid_05) < (vgn_05 - 1)) |\
				(vardim1(horgrid_05) < (hgn_05 - 1)) |\
				_bResetAllGrids then

				_bFix = (gs_optype_m_05 <> SASH_FIXED)
				for i=1 to vgn_05-1
					parameters vergrid_05[i][1] = i*(_sashWidth[_nSash]-2*gs_sash_width*bFix+gw)/(vgn_05)
					parameters vergrid_05[i][2] = gs_sash_width*bFix
					parameters vergrid_05[i][3] = _sashHeight[_nSash]-gs_sash_width*bFix+gs_rebate_width*not(bFix) - _ventSashMod
				next i
	
				for i=1 to hgn_05-1
					parameters horgrid_05[i][1] = i*(_sashHeight[_nSash]-2*gs_sash_width*bFix+gw - _ventSashMod)/(hgn_05)
					parameters horgrid_05[i][2] = gs_sash_width*bFix
					parameters horgrid_05[i][3] = _sashWidth[_nSash] - gs_sash_width*bFix + gs_rebate_width*not(bFix)
				next i
			endif
		else
			if	(not(gs_sash_uniform) & GLOB_MODPAR_NAME = "iMullionStyle_05")	|\
				GLOB_MODPAR_NAME = "vgn_05"	|\
				GLOB_MODPAR_NAME = "hgn_05"	|\
				GLOB_MODPAR_NAME = "gs_horiz_div_height_05"	|\
				GLOB_MODPAR_NAME = "bSashLedge"	|\
				(bSashLedge & GLOB_MODPAR_NAME = "sashLedgeHeight")	|\
				bVentilationProfile & GLOB_MODPAR_NAME = "isVentilationProfileInSash_05" |\
				(vardim1(vergrid_05) < (vgn_05 - 1)) |\
				(vardim1(horgrid_05) < (hgn_05 - 1)) |\
				_bResetAllGrids then

				for i=1 to vgn_05-1
					parameters vergrid_05[i][1] = i*(_sashWidth[_nSash]-2*gs_sash_width+gw)/(vgn_05)
					parameters vergrid_05[i][2] = gs_sash_width + _dLedgeOffsetY
					parameters vergrid_05[i][3] = _sashHeight[_nSash] - gs_sash_width - _ventSashMod
				next i
	
				for i=1 to hgn_05-1
					parameters horgrid_05[i][1] = _dLedgeOffsetY + i*(_sashHeight[_nSash]-2*gs_sash_width+gw - _ventSashMod - _dLedgeOffsetY)/(hgn_05)
					parameters horgrid_05[i][2] = gs_sash_width
					parameters horgrid_05[i][3] = _sashWidth[_nSash] - gs_sash_width
				next i
			endif
		endif
	endif

	if _sashID[_nSash] = 6 then
		_ventSashMod = VentilationProfileHeight * isVentilationProfileInSash_06

		if iWindowType = WIN_W4HorizontalSlide  then
			if	(not(gs_sash_uniform) & GLOB_MODPAR_NAME = "iMullionStyle_05")	|\ ! sashID 5-6 pair
				GLOB_MODPAR_NAME = "vgn_05"	|\
				GLOB_MODPAR_NAME = "hgn_05"	|\
				GLOB_MODPAR_NAME = "gs_horiz_div_height_05"	|\
				bVentilationProfile & GLOB_MODPAR_NAME = "isVentilationProfileInSash_06" |\
				GLOB_MODPAR_NAME = "gs_UTrans_w"	|\
				GLOB_MODPAR_NAME = "gs_UTrans_h"	|\
				GLOB_MODPAR_NAME = "gs_Mullion_w"	|\
				GLOB_MODPAR_NAME="iUTrans" |\			
				(vardim1(vergrid_06) < (vgn_06 - 1)) |\
				(vardim1(horgrid_06) < (hgn_06 - 1)) |\
				_bResetAllGrids then
	
				_bFix = (gs_optype_m_06 <> SASH_FIXED)
	
				for i=1 to vgn_06-1
					parameters vergrid_06[i][1] = i*(_sashWidth[_nSash]-2*gs_sash_width*_bFix+gw)/(vgn_06)
					parameters vergrid_06[i][2] = gs_sash_width*_bFix
					parameters vergrid_06[i][3] = _sashHeight[_nSash] - gs_sash_width*_bFix + gs_rebate_width*not(_bFix) - _ventSashMod
				next i
	
				for i=1 to hgn_06-1
					parameters horgrid_06[i][1] = i*(_sashHeight[_nSash]-2*gs_sash_width*_bFix+gw - _ventSashMod)/(hgn_06)
					parameters horgrid_06[i][2] = gs_sash_width*_bFix
					parameters horgrid_06[i][3] = _sashWidth[_nSash] - gs_sash_width*_bFix + gs_rebate_width*not(_bFix)
				next i
			endif
		else
			if	(not(gs_sash_uniform) & GLOB_MODPAR_NAME = "iMullionStyle_05")	|\	! sashID 5-6 pair
				GLOB_MODPAR_NAME = "vgn_05"	|\
				GLOB_MODPAR_NAME = "hgn_05"	|\
				GLOB_MODPAR_NAME = "gs_horiz_div_height_05"	|\
				GLOB_MODPAR_NAME = "bSashLedge"	|\
				(bSashLedge & GLOB_MODPAR_NAME = "sashLedgeHeight")	|\
				bVentilationProfile & GLOB_MODPAR_NAME = "isVentilationProfileInSash_06" |\
				(vardim1(vergrid_06) < (vgn_06 - 1)) |\
				(vardim1(horgrid_06) < (hgn_06 - 1)) |\
				_bResetAllGrids then

				for i=1 to vgn_06-1
					parameters vergrid_06[i][1] =i*(_sashWidth[_nSash]-2*gs_sash_width+gw)/(vgn_06)
					parameters vergrid_06[i][2] = gs_sash_width + _dLedgeOffsetY
					parameters vergrid_06[i][3] = _sashHeight[_nSash] - gs_sash_width - _ventSashMod
				next i
	
				for i=1 to hgn_06-1
					parameters horgrid_06[i][1] = _dLedgeOffsetY + i*(_sashHeight[_nSash]-2*gs_sash_width+gw - _ventSashMod - _dLedgeOffsetY)/(hgn_06)
					parameters horgrid_06[i][2] = gs_sash_width
					parameters horgrid_06[i][3] = _sashWidth[_nSash] - gs_sash_widths
				next i
			endif
		endif
	endif

	if _sashID[_nSash] = 7 then
		_ventSashMod = VentilationProfileHeight * isVentilationProfileInSash_07

		if iWindowType = WIN_W3HorizontalSlide | iWindowType = WIN_W4HorizontalSlide then
			if	(not(gs_sash_uniform) & GLOB_MODPAR_NAME = "iMullionStyle_07")	|\
				GLOB_MODPAR_NAME = "vgn_07"	|\
				GLOB_MODPAR_NAME = "hgn_07"	|\
				GLOB_MODPAR_NAME = "gs_horiz_div_height_07"	|\
				bVentilationProfile & GLOB_MODPAR_NAME = "isVentilationProfileInSash_07" |\
				GLOB_MODPAR_NAME = "gs_UTrans_w"	|\
				GLOB_MODPAR_NAME = "gs_UTrans_h"	|\
				GLOB_MODPAR_NAME = "gs_Mullion_w"	|\
				GLOB_MODPAR_NAME="iUTrans" |\			
				(vardim1(vergrid_07) < (vgn_07 - 1)) |\
				(vardim1(horgrid_07) < (hgn_07 - 1)) |\
				_bResetAllGrids then
	
				_bFix = (gs_optype_m_07 <> SASH_FIXED)

				for i=1 to vgn_07-1
					parameters vergrid_07[i][1] = i*(_sashWidth[_nSash]-2*gs_sash_width*_bFix+gw)/(vgn_07)
					parameters vergrid_07[i][2] = gs_sash_width*_bFix
					parameters vergrid_07[i][3] = _sashHeight[_nSash] - gs_sash_width*_bFix + gs_rebate_width*not(_bFix) - _ventSashMod
				next i
	
				for i=1 to hgn_07-1
					parameters horgrid_07[i][1] = i*(_sashHeight[_nSash]-2*gs_sash_width*_bFix+gw - _ventSashMod)/(hgn_07)
					parameters horgrid_07[i][2] = gs_sash_width*_bFix
					parameters horgrid_07[i][3] = _sashWidth[_nSash] - gs_sash_width*_bFix + gs_rebate_width*not(_bFix)
				next i
			endif
		endif
	endif

	if _sashID[_nSash] = 8 then
		if iWindowType = WIN_W3HorizontalSlide | iWindowType = WIN_W4HorizontalSlide then
			_ventSashMod = VentilationProfileHeight * isVentilationProfileInSash_08

			if	(not(gs_sash_uniform) & GLOB_MODPAR_NAME = "iMullionStyle_07")	|\ ! pair 7-8
				GLOB_MODPAR_NAME = "vgn_07"	|\
				GLOB_MODPAR_NAME = "hgn_07"	|\
				GLOB_MODPAR_NAME = "gs_horiz_div_height_07"	|\
				bVentilationProfile & GLOB_MODPAR_NAME = "isVentilationProfileInSash_08" |\
				GLOB_MODPAR_NAME = "gs_UTrans_w"	|\
				GLOB_MODPAR_NAME = "gs_UTrans_h"	|\
				GLOB_MODPAR_NAME = "gs_Mullion_w"	|\
				GLOB_MODPAR_NAME="iUTrans" |\			
				(vardim1(vergrid_08) < (vgn_08 - 1)) |\
				(vardim1(horgrid_08) < (hgn_08 - 1)) |\
				_bResetAllGrids then
	
				bFix = _addTransRebate[_nSash]
	
				for i=1 to vgn_08-1
					parameters vergrid_08[i][1] = i*(_sashWidth[_nSash]-2*gs_sash_width*bFix+gw)/(vgn_08)
					parameters vergrid_08[i][2] = gs_sash_width*bFix
					parameters vergrid_08[i][3] = _sashHeight[_nSash] - gs_sash_width*bFix + gs_rebate_width*not(bFix) - _ventSashMod
				next i
	
				for i=1 to hgn_08-1
					parameters horgrid_08[i][1] = i*(_sashHeight[_nSash] - 2*gs_sash_width*bFix+gw - _ventSashMod)/(hgn_08)
					parameters horgrid_08[i][2] = gs_sash_width*bFix
					parameters horgrid_08[i][3] = _sashWidth[_nSash] - gs_sash_width*bFix + gs_rebate_width*not(bFix)
				next i
			endif
		endif
	endif
next _nSash


goto "MasterEnd"


! --------------------------------------------------------------------------------
"actualSashTypeVar":
! --------------------------------------------------------------------------------
	if gs_sash_uniform then
		if iMullionStyle_00 = MULLION_CUSTOM then
			_bHasCustomPanel = 1
		endif
	else
		for _ii = 1 to vardim1(_validSashID)
			if _validSashID[_ii] = 1 then
				_actSashType = iMullionStyle_01
			endif
			if _validSashID[_ii] = 2 then
				_actSashType = iMullionStyle_02
			endif
			if _validSashID[_ii] = 3 then
				_actSashType = iMullionStyle_03
			endif
			if _validSashID[_ii] = 4 then
				_actSashType = iMullionStyle_04
			endif
			if _validSashID[_ii] = 5 then
				_actSashType = iMullionStyle_05
			endif
			if _validSashID[_ii] = 6 then
				_actSashType = iMullionStyle_06
			endif
			if _validSashID[_ii] = 7 then
				_actSashType = iMullionStyle_07
			endif
			if _validSashID[_ii] = 8 then
				_actSashType = iMullionStyle_08
			endif
	
			if _actSashType = MULLION_CUSTOM then
				_bHasCustomPanel = 1
			endif
		next _ii
	endif
return


! --------------------------------------------------------------------------------
! set all sash IDs and calculate sash sizes
"sashDefinitions":
! --------------------------------------------------------------------------------
	if iUTrans = TRANSOM_NONE | not(gs_UTrans) then
		__sashHeight = ac_unit_height - gs_frame_width_lower - gs_frame_width_upper
		__transomSashHeight = 0
	else
		__sashHeight = gs_UTrans_h - gs_UTrans_w/2 - gs_frame_width_lower
		__transomSashHeight = ac_unit_height - gs_UTrans_h - gs_UTrans_w/2 - gs_frame_width_upper
	endif

	if iWindowType = WIN_W2HorizontalSlide then
		_sashID[_idxSash]			= 1
		_bTransomSash[_idxSash]		= 0
		_addTransRebate[_idxSash]	= 0
		_sashWidth[_idxSash]		= sashWidth1
		_sashHeight[_idxSash]		= __sashHeight
		_idxSash = _idxSash + 1

		_sashID[_idxSash]			= 3
		_bTransomSash[_idxSash]		= 0
		_addTransRebate[_idxSash]	= 0
		_sashWidth[_idxSash]		= sashWidth2
		_sashHeight[_idxSash]		= __sashHeight
		_idxSash = _idxSash + 1
	endif
	
	if iWindowType = WIN_W3HorizontalSlide then
		_sashID[_idxSash]			= 1
		_bTransomSash[_idxSash]		= 0
		_addTransRebate[_idxSash]	= 0
		_sashWidth[_idxSash]		= sashWidth2
		_sashHeight[_idxSash]		= __sashHeight
		_idxSash = _idxSash + 1

		_sashID[_idxSash]			= 3
		_bTransomSash[_idxSash]		= 0
		_addTransRebate[_idxSash]	= 0
		_sashWidth[_idxSash]		= sashWidth1
		_sashHeight[_idxSash]		= __sashHeight
		_idxSash = _idxSash + 1

		_sashID[_idxSash]			= 4
		_bTransomSash[_idxSash]		= 0
		_addTransRebate[_idxSash]	= 0
		_sashWidth[_idxSash]		= sashWidth3
		_sashHeight[_idxSash]		= __sashHeight
		_idxSash = _idxSash + 1
	
		if iUTrans = TRANSOM_3SASHES then
			_sashID[_idxSash]			= 5
			_bTransomSash[_idxSash]		= 1
			_addTransRebate[_idxSash]	= (gs_optype_m_05 <> SASH_FIXED)*2*gs_rebate_width
			if iOpeningTypeMain = OPENINGTYPE_MAIN_1SIDE | iOpeningTypeMain = OPENINGTYPE_MAIN_1MIDDLE then
				_sashWidth[_idxSash]	= sashWidth2 - gs_Mullion_w_left/2 - gs_Mullion_w/2 + _addTransRebate[_idxSash] - gs_sash_width/2
			else
				_sashWidth[_idxSash]	= sashWidth2 - gs_Mullion_w_left/2 - gs_Mullion_w/2 + _addTransRebate[_idxSash] - gs_sash_width
			endif
			_sashHeight[_idxSash]		= __transomSashHeight + _addTransRebate[_idxSash]
			_idxSash = _idxSash + 1

			_sashID[_idxSash]			= 7
			_bTransomSash[_idxSash]		= 1
			_addTransRebate[_idxSash]	= (gs_optype_m_07 <> SASH_FIXED)*2*gs_rebate_width
			if iOpeningTypeMain = OPENINGTYPE_MAIN_1MIDDLE then
				_sashWidth[_idxSash]	= sashWidth1 - gs_Mullion_w_left/2 + _addTransRebate[_idxSash]
			else
				_sashWidth[_idxSash]	= sashWidth1 - gs_sash_width/2 - gs_Mullion_w_left/2 + _addTransRebate[_idxSash]
			endif
			_sashHeight[_idxSash]		= __transomSashHeight + _addTransRebate[_idxSash]
			_idxSash = _idxSash + 1

			_sashID[_idxSash]			= 8
			_bTransomSash[_idxSash]		= 1
			_addTransRebate[_idxSash]	= (gs_optype_m_08 <> SASH_FIXED)*2*gs_rebate_width
			if iOpeningTypeMain = OPENINGTYPE_MAIN_1SIDE then
				_sashWidth[_idxSash]	= sashWidth3 - gs_Mullion_w/2 + _addTransRebate[_idxSash]
			else
				_sashWidth[_idxSash]	= sashWidth3 - gs_sash_width/2 - gs_Mullion_w/2 + _addTransRebate[_idxSash]
			endif
			_sashHeight[_idxSash]		= __transomSashHeight + _addTransRebate[_idxSash]
			_idxSash = _idxSash + 1
		endif

		if iUTrans = TRANSOM_UNDIVIDED then
			_sashID[_idxSash]			= 5
			_bTransomSash[_idxSash]		= 1
			_addTransRebate[_idxSash]	= (gs_optype_m_05 <> SASH_FIXED)*2*gs_rebate_width
			_sashWidth[_idxSash]		= ac_unit_width - gs_frame_width - gs_frame_width_left + _addTransRebate[_idxSash]
			_sashHeight[_idxSash]		= __transomSashHeight + _addTransRebate[_idxSash]
			_idxSash = _idxSash + 1
		endif
	endif
	
	if iWindowType = WIN_W4HorizontalSlide then
		_sashID[_idxSash]			= 1
		_bTransomSash[_idxSash]		= 0
		_addTransRebate[_idxSash]	= 0
		_sashWidth[_idxSash]		= sashWidth2
		_sashHeight[_idxSash]		= __sashHeight
		_idxSash = _idxSash + 1

		_sashID[_idxSash] 			= 2
		_bTransomSash[_idxSash]		= 0
		_addTransRebate[_idxSash]	= 0
		_sashWidth[_idxSash]		= sashWidth3
		_sashHeight[_idxSash]		= __sashHeight
		_idxSash = _idxSash + 1

		_sashID[_idxSash] 			= 3
		_bTransomSash[_idxSash]		= 0
		_addTransRebate[_idxSash]	= 0
		_sashWidth[_idxSash]		= sashWidth1
		_sashHeight[_idxSash]		= __sashHeight
		_idxSash = _idxSash + 1

		_sashID[_idxSash] 			= 4
		_bTransomSash[_idxSash]		= 0
		_addTransRebate[_idxSash]	= 0
		_sashWidth[_idxSash]	= _sashWidth4
		_sashHeight[_idxSash]	= __sashHeight
		_idxSash = _idxSash + 1

		if iUTrans = TRANSOM_2SASHES then
			_sashID[_idxSash]			= 5
			_bTransomSash[_idxSash]		= 1
			_addTransRebate[_idxSash]	= (gs_optype_m_05 <> SASH_FIXED)*2*gs_rebate_width
			if iOpeningTypeMain = OPENINGTYPE_MAIN_SAMERAIL then
				_sashWidth[_idxSash]		= sashWidth3 + _sashWidth4 - gs_sash_width - gs_Mullion_w/2 + _addTransRebate[_idxSash]
			else
				_sashWidth[_idxSash]		= sashWidth3 + _sashWidth4 - 1.5*gs_sash_width - gs_Mullion_w/2 + _addTransRebate[_idxSash]
			endif
			_sashHeight[_idxSash]		= __transomSashHeight + _addTransRebate[_idxSash]
			_idxSash = _idxSash + 1

			_sashID[_idxSash]			= 7
			_bTransomSash[_idxSash]		= 1
			_addTransRebate[_idxSash]	= (gs_optype_m_07 <> SASH_FIXED)*2*gs_rebate_width
			if iOpeningTypeMain = OPENINGTYPE_MAIN_SAMERAIL then
				_sashWidth[_idxSash]		= sashWidth1 + sashWidth2 - gs_sash_width - gs_Mullion_w/2 + _addTransRebate[_idxSash]
			else
				_sashWidth[_idxSash]		= sashWidth1 + sashWidth2 - 1.5*gs_sash_width - gs_Mullion_w/2 + _addTransRebate[_idxSash]
			endif
			_sashHeight[_idxSash]		= __transomSashHeight + _addTransRebate[_idxSash]
			_idxSash = _idxSash + 1
		endif
		if iUTrans = TRANSOM_3SASHES then
			_sashID[_idxSash]			= 5
			_bTransomSash[_idxSash]		= 1
			_addTransRebate[_idxSash]	= (gs_optype_m_05 <> SASH_FIXED)*2*gs_rebate_width
			if iOpeningTypeMain = OPENINGTYPE_MAIN_SAMERAIL then
				_sashWidth[_idxSash]		= sashWidth2 + sashWidth3 - gs_Mullion_w + _addTransRebate[_idxSash] - gs_sash_width
			else
				_sashWidth[_idxSash]		= sashWidth2 + sashWidth3 - gs_Mullion_w + _addTransRebate[_idxSash] - 2*gs_sash_width
			endif
			_sashHeight[_idxSash]		= __transomSashHeight + _addTransRebate[_idxSash]
			_idxSash = _idxSash + 1

			_sashID[_idxSash]			= 7
			_bTransomSash[_idxSash]		= 1
			_addTransRebate[_idxSash]	= (gs_optype_m_07 <> SASH_FIXED)*2*gs_rebate_width
			_sashWidth[_idxSash]		= sashWidth1 - gs_Mullion_w/2 + _addTransRebate[_idxSash] - gs_sash_width/2
			_sashHeight[_idxSash]		= __transomSashHeight + _addTransRebate[_idxSash]
			_idxSash = _idxSash + 1

			_sashID[_idxSash]			= 8
			_bTransomSash[_idxSash]		= 1
			_addTransRebate[_idxSash]	= (gs_optype_m_08 <> SASH_FIXED)*2*gs_rebate_width
			_sashWidth[_idxSash]		= sashWidth3 - gs_Mullion_w/2 + _addTransRebate[_idxSash] - gs_sash_width/2
			_sashHeight[_idxSash]		= __transomSashHeight + _addTransRebate[_idxSash]
			_idxSash = _idxSash + 1
		endif
		if iUTrans = TRANSOM_4SASHES then
			_sashID[_idxSash]			= 5
			_bTransomSash[_idxSash]		= 1
			_addTransRebate[_idxSash]	= (gs_optype_m_05 <> SASH_FIXED)*2*gs_rebate_width
			if iOpeningTypeMain = OPENINGTYPE_MAIN_SAMERAIL then
				_sashWidth[_idxSash]	= sashWidth2 - gs_Mullion_w + _addTransRebate[_idxSash] - gs_sash_width/2
			else
				_sashWidth[_idxSash]	= sashWidth2 - gs_Mullion_w + _addTransRebate[_idxSash] - gs_sash_width
			endif
			_sashHeight[_idxSash]		= __transomSashHeight + _addTransRebate[_idxSash]
			_idxSash = _idxSash + 1

			_sashID[_idxSash]			= 6
			_bTransomSash[_idxSash]		= 1
			_addTransRebate[_idxSash]	= (gs_optype_m_06 <> SASH_FIXED)*2*gs_rebate_width
			if iOpeningTypeMain = OPENINGTYPE_MAIN_SAMERAIL then
				_sashWidth[_idxSash]	= sashWidth3 - gs_Mullion_w + _addTransRebate[_idxSash] - gs_sash_width/2
			else
				_sashWidth[_idxSash]	= sashWidth3 - gs_Mullion_w + _addTransRebate[_idxSash] - gs_sash_width
			endif
			_sashHeight[_idxSash]		= __transomSashHeight + _addTransRebate[_idxSash]
			_idxSash = _idxSash + 1

			_sashID[_idxSash]			= 7
			_bTransomSash[_idxSash]		= 1
			_addTransRebate[_idxSash]	= (gs_optype_m_07 <> SASH_FIXED)*2*gs_rebate_width
			_sashWidth[_idxSash]		= sashWidth1 - gs_Mullion_w/2 + _addTransRebate[_idxSash] - gs_sash_width/2
			_sashHeight[_idxSash]		= __transomSashHeight + _addTransRebate[_idxSash]
			_idxSash = _idxSash + 1

			_sashID[_idxSash]			= 8
			_bTransomSash[_idxSash]		= 1
			_addTransRebate[_idxSash]	= (gs_optype_m_08 <> SASH_FIXED)*2*gs_rebate_width
			_sashWidth[_idxSash]		= _sashWidth4 - gs_Mullion_w/2 + _addTransRebate[_idxSash] - gs_sash_width/2
			_sashHeight[_idxSash]		= __transomSashHeight + _addTransRebate[_idxSash]
			_idxSash = _idxSash + 1
		endif
		if iUTrans = TRANSOM_UNDIVIDED then
			_sashID[_idxSash]			= 5
			_bTransomSash[_idxSash]		= 1
			_addTransRebate[_idxSash]	= (gs_optype_m_05 <> SASH_FIXED)*2*gs_rebate_width
			_sashWidth[_idxSash]		= ac_unit_width - gs_frame_width - gs_frame_width_left + _addTransRebate[_idxSash]
			_sashHeight[_idxSash]		= __transomSashHeight + _addTransRebate[_idxSash]
			_idxSash = _idxSash + 1
		endif
	endif
	
	if iWindowType = WIN_W6HorizontalSlide then
		for _idxSash = 1 to 6
			_sashID[_idxSash]			= _idxSash
			_bTransomSash[_idxSash]		= 0
			_addTransRebate[_idxSash]	= 0
			_sashWidth[_idxSash]		= sashWidth1
			_sashHeight[_idxSash]		= __sashHeight
		next _idxSash
	endif
return


"MasterEnd":



