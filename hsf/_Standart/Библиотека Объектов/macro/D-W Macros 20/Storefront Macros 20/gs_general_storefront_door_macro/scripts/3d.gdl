
! Contact person: <SzL, NJ>

lod3D = 0										! Don't draw anything
if iDWDet3D = DETLEVEL_DW3D_SIMPLE then lod3D = 1	! Simple
if iDWDet3D = DETLEVEL_DW3D_DETAILED then lod3D = 2	! Detailed
if iDWDet3D = DETLEVEL_DW3D_CHI_SIMPLE | iDWDet3D = DETLEVEL_DW3D_CHI_DETAILED then
	if (GLOB_CONTEXT = 4 | GLOB_CONTEXT = 24 | GLOB_CONTEXT = 6) then
		lod3D = 5								! Chinese
	else
		lod3D = 2
	endif
endif

gs_fillFr		= gs_bFills * gs_fillFr
gs_penFr_fg		= gs_bFills * gs_penFr_fg
gs_penFr_bg		= gs_bFills * gs_penFr_bg

gs_fillLeaf		= gs_bFills * gs_fillLeaf
gs_penLeaf_fg	= gs_bFills * gs_penLeaf_fg
gs_penLeaf_bg	= gs_bFills * gs_penLeaf_bg

gs_gsect		= gs_bFills * gs_gsect
gs_penGlass_fg 	= gs_bFills * gs_penGlass_fg
gs_penGlass_bg 	= gs_bFills * gs_penGlass_bg

gs_FillSdl		= gs_bFills * gs_FillSdl
gs_penSdl_fg	= gs_bFills * gs_penSdl_fg
gs_penSdl_bg	= gs_bFills * gs_penSdl_bg

xpltp = 0
xprtp = 0
xpr = 0
xpl = 0


! =============================================================================
! GS Storefront Door Functions
! =============================================================================

call "GS Storefront Door Functions",
	parameters all	lod3D						= lod3D,
					bEnableVentilationProfile	= bEnableVentilationProfile,
					bEnableParapetInset			= bEnableParapetInset,
					bEnableMasonryArch			= bEnableMasonryArch,
					bEnableSill					= bEnableSill,
					bEnableBoard				= bEnableBoard,
					bEnableFaschen				= bEnableFaschen,
					bEnableThreshold			= bEnableThreshold,
					bEnableCasing				= bEnableCasing,
					bEnableShutter				= bEnableShutter,
					bEnableCustomCornerLeft		= bEnableCustomCornerLeft,
					bEnableCustomCornerRight	= bEnableCustomCornerRight,
				! --- Corner Functions
					bLeftCornerFunction	 		= gs_cl,
					leftCornerAngle		 		= leftCornerAngle,
					leftConnWallThk		 		= WALL_THICKNESS,
					bRightCornerFunction 		= gs_cr,
					rightCornerAngle	 		= rightCornerAngle,
					rightConnWallThk			= WALL_THICKNESS,
					gs_left_oversize			= gs_left_oversize - gs_cl * abs((gs_fthk)*TAN(90-leftCornerAngle/2)),
					gs_right_oversize			= gs_right_oversize - gs_cr * abs((gs_fthk)*TAN(90-rightCornerAngle/2)),
	returned_parameters	ac_unit_width,
						ac_unit_height,
						gs_frame_ovhg_left_out,
						gs_frame_ovhg_right_out,
						gs_frame_ovhg_top_out,
						gs_frame_ovhg_bottom_out,
						gs_frame_ovhg_left_in,
						gs_frame_ovhg_right_in,
						gs_frame_ovhg_top_in,
						gs_frame_ovhg_bottom_in,
						gs_fthk,
						bMirrored,
						xform11, xform12, xform13, xform14,
						xform21, xform22, xform23, xform24,
						xform31, xform32, xform33, xform34,
						bOplines3d,	opLineType3dIn,	opLineType3dOut, opLineTypeSecondary, gs_opline_style_m, gs_opLinePen,
						bShowAddHotspots, bShowAddHotspotsForIS, bShowUnitHotspots, bShowEgressHotspots, bShowLeafHotspots


if lod3D = 0 then end

xform	xform11, xform12, xform13, xform14,
		xform21, xform22, xform23, xform24,
		xform31, xform32, xform33, xform34
ROTx 90

if (gs_cl | gs_cr) & gs_opening_dir_sl_m = OPENING_DIR_FLIPPED_INSIDE then
	leftCornerAngle = 360 - leftCornerAngle
	rightCornerAngle = 360 - rightCornerAngle
endif



! =============================================================================
! Chinese Specific
! =============================================================================

if lod3D = 5 then
	! Move the whole door to middle of wall with half of the original thickness
	if WIDO_REVEAL_SIDE then
		addz (WIDO_SILL - WALL_THICKNESS/2 + gs_fthk/4) + gs_fthk/2
	else
		addz -(WIDO_SILL - WALL_THICKNESS/2 + gs_fthk/4)
	endif

	if abs(gs_frame_thk) > EPS then
		gs_frame_thk	= gs_frame_thk/2
	else
		gs_frame_thk	= gs_leaf_thk/2
	endif

	gs_hor_gnum 		= 0
	gs_ver_gnum 		= 0
	gs_hor_gnumtr		= 0
	gs_ver_gnumtr		= 0
	gs_hor_gtp			= 0
	gs_ver_gtp			= 0
	gs_gsb				= 0
	gs_wthk				= 0
	gs_fthk				= gs_frame_thk
	gs_glass_thk		= gs_frame_thk
	bEnableDoorStop 	= 0

	fr_sect_fill_type	= gs_FillSdl
	fr_sect_fill_fg		= gs_penSdl_fg
	fr_sect_fill_bg		= gs_penSdl_bg

	sh_sect_fill_type	= gs_FillSdl
	sh_sect_fill_fg		= gs_penSdl_fg
	sh_sect_fill_bg		= gs_penSdl_bg

	gl_sect_fill_type	= gs_FillSdl
	gl_sect_fill_fg		= gs_penSdl_fg
	gl_sect_fill_bg		= gs_penSdl_bg
else
	fr_sect_fill_type	= gs_fillFr
	fr_sect_fill_fg		= gs_penFr_fg
	fr_sect_fill_bg		= gs_penFr_bg

	sh_sect_fill_type	= gs_fillLeaf
	sh_sect_fill_fg		= gs_penLeaf_fg
	sh_sect_fill_bg		= gs_penLeaf_bg

	gl_sect_fill_type	= gs_gsect
	gl_sect_fill_fg		= gs_penGlass_fg
	gl_sect_fill_bg		= gs_penGlass_bg
endif


! =============================================================================

if gs_wthk then
	if WIDO_REVEAL_SIDE then
		addz -WALL_THICKNESS + WIDO_FRAME_THICKNESS + WIDO_SILL
	else
		addz -WIDO_SILL
	endif
endif

! =============================================================================
! Hotspots
! =============================================================================

nFlipTrans = 0
if bOpeningDirectionSL then
	addz gs_fthk
	mulz -1
	nFlipTrans = 2
endif

unID=50

if gs_full_edit=1 then
	!! MIDDLE RAIL HEIGHT !!
	if bEnableMiddleRail then
		if bMiddleRail then
			hotspot (ac_unit_width/2-gs_fw_side_right)*gs_sidelight_right+(ac_unit_width/2-gs_fw_side_right)*not(gs_sidelight_right),  0, 0, unID, midRailElevation,1+128
			unID=unID+1
			hotspot (ac_unit_width/2-gs_fw_side_right)*gs_sidelight_right+(ac_unit_width/2-gs_fw_side_right)*not(gs_sidelight_right), -1, 0, unID, midRailElevation,3
			unID=unID+1
			hotspot (ac_unit_width/2-gs_fw_side_right)*gs_sidelight_right+(ac_unit_width/2-gs_fw_side_right)*not(gs_sidelight_right), midRailElevation, 0, unID, midRailElevation,2
			unID=unID+1
		else
			unID=unID+3
		endif
	else
		unID=unID+3
	endif

	!! TOP PANEL HEIGHT !!

	if gs_door_transom then
		hotspot (ac_unit_width/2-gs_fw_side_right)*gs_sidelight_right+(-ac_unit_width/2+gs_fw_side_left)*not(gs_sidelight_right),  ac_unit_height, 0, unID, gs_transom_height,1+128
		unID=unID+1
		hotspot (ac_unit_width/2-gs_fw_side_right)*gs_sidelight_right+(-ac_unit_width/2+gs_fw_side_left)*not(gs_sidelight_right), ac_unit_height+1, 0, unID, gs_transom_height,3
		unID=unID+1
		hotspot (ac_unit_width/2-gs_fw_side_right)*gs_sidelight_right+(-ac_unit_width/2+gs_fw_side_left)*not(gs_sidelight_right), ac_unit_height-gs_transom_height, 0, unID, gs_transom_height,2
		unID=unID+1
	else
		unID=unID+3
	endif

! First Panel Width ===========================================================

	if gs_sidelight_left then
		hotspot -ac_unit_width/2,  gs_fw_lower, 0, unID, gs_sidelight_width_left,1+128
		unID=unID+1
		hotspot -ac_unit_width/2-1, gs_fw_lower, 0, unID, gs_sidelight_width_left,3
		unID=unID+1
		hotspot -ac_unit_width/2+gs_sidelight_width_left, gs_fw_lower, 0, unID, gs_sidelight_width_left,2
		unID=unID+1
	else
		unID = unID + 3
	endif


! End Panel Width =============================================================

	if gs_sidelight_right then
		hotspot ac_unit_width/2,  gs_fw_lower, 0, unID, gs_sidelight_width_right,1+128
		unID=unID+1
		hotspot ac_unit_width/2+1, gs_fw_lower, 0, unID, gs_sidelight_width_right,3
		unID=unID+1
		hotspot ac_unit_width/2-gs_sidelight_width_right, gs_fw_lower, 0, unID, gs_sidelight_width_right,2
		unID=unID+1
	else
		unID = unID + 3
	endif

! Horizontal Grids ============================================================

	if gs_hor_gnum >0 AND (gs_sidelight_right OR gs_sidelight_left) and bMiddleRail then
		for i=1 to gs_hor_gnum
			ADD  (iFrameStyleMullion = FRAME_STYLE_BUTT_GLAZED)*gs_fw_side_right, gs_fw_lower-gs_grid_w/2,0
			hotspot (ac_unit_width/2-gs_fw_side_right)*gs_sidelight_right+(-ac_unit_width/2+gs_fw_side_left)*not(gs_sidelight_right),  0, 0, unID, gs_hor_d[i],1+128
			unID=unID+1
			hotspot (ac_unit_width/2-gs_fw_side_right)*gs_sidelight_right+(-ac_unit_width/2+gs_fw_side_left)*not(gs_sidelight_right), -1, 0, unID, gs_hor_d[i],3
			unID=unID+1
			hotspot (ac_unit_width/2-gs_fw_side_right)*gs_sidelight_right+(-ac_unit_width/2+gs_fw_side_left)*not(gs_sidelight_right), gs_hor_d[i], 0, unID, gs_hor_d[i],2
			unID=unID+1
			DEL 1
		next i
	else
		unID = unID + 3*gs_hor_gnum
	endif


! Horizontal Grids Transom ====================================================

	if gs_hor_gnumtr >0 AND (gs_sidelight_right OR gs_sidelight_left) then
		for i=1 to gs_hor_gnumtr
			ADD  (iFrameStyleMullion = FRAME_STYLE_BUTT_GLAZED)*gs_fw_side_right, ac_unit_height-gs_fw_upper-middlePanelHeight-gs_grid_w/2,0
			hotspot (ac_unit_width/2-gs_fw_side_right)*gs_sidelight_right+(-ac_unit_width/2+gs_fw_side_left)*not(gs_sidelight_right),  0, 0, unID, gs_hor_dtr[i],1+128
			unID=unID+1
			hotspot (ac_unit_width/2-gs_fw_side_right)*gs_sidelight_right+(-ac_unit_width/2+gs_fw_side_left)*not(gs_sidelight_right), -1, 0, unID, gs_hor_dtr[i],3
			unID=unID+1
			hotspot (ac_unit_width/2-gs_fw_side_right)*gs_sidelight_right+(-ac_unit_width/2+gs_fw_side_left)*not(gs_sidelight_right), gs_hor_dtr[i], 0, unID, gs_hor_dtr[i],2
			unID=unID+1
			DEL 1
		next i
	else
		unID = unID + 3*gs_hor_gnumtr
	endif


! Horizontal Grids Top Panel ==================================================

	if gs_hor_gtp >0 AND gs_door_transom then
		for i=1 to gs_hor_gtp
			ADD  (iFrameStyleMullion = FRAME_STYLE_BUTT_GLAZED)*gs_fw_side_right, ac_unit_height-topPanelHeight-gs_grid_w/2,0
			hotspot (ac_unit_width/2-gs_fw_side_right)*gs_sidelight_right+(-ac_unit_width/2+gs_fw_side_left)*not(gs_sidelight_right),  0, 0, unID, gs_hor_dtp[i],1+128
			unID=unID+1
			hotspot (ac_unit_width/2-gs_fw_side_right)*gs_sidelight_right+(-ac_unit_width/2+gs_fw_side_left)*not(gs_sidelight_right), -1, 0, unID, gs_hor_dtp[i],3
			unID=unID+1
			hotspot (ac_unit_width/2-gs_fw_side_right)*gs_sidelight_right+(-ac_unit_width/2+gs_fw_side_left)*not(gs_sidelight_right), gs_hor_dtp[i], 0, unID, gs_hor_dtp[i],2
			unID=unID+1
			DEL 1
		next i
	else
		unID = unID + 3*gs_hor_gtp
	endif

! Vertica Grids ===============================================================

	if gs_ver_gnum >0 AND gs_door_transom then
		for i=1 to gs_ver_gnum
			ADD -ac_unit_width/2+frameOrSLightWidthLeft-gridWidthVert/2, ac_unit_height-topPanelHeight, 0
			hotspot 0,  0, 0, unID, gs_ver_d[i],1+128
			unID=unID+1
			hotspot -1, 0, 0, unID, gs_ver_d[i],3
			unID=unID+1
			hotspot gs_ver_d[i], 0, 0, unID, gs_ver_d[i],2
			unID=unID+1
			DEL 1
		next i
	else
		unID = unID + 3*gs_ver_gnum
	endif
endif

del nFlipTrans

! =============================================================================
! Hotspots
! =============================================================================
! ------------------------------------------------------------------------------
! Unit hotspots
! ------------------------------------------------------------------------------

if bShowUnitHotspots then
	hotspot -ac_unit_width/2, 0, 0, 100
	hotspot  ac_unit_width/2, 0, 0, 101
	hotspot -ac_unit_width/2, 0, gs_fthk, 102
	hotspot  ac_unit_width/2, 0, gs_fthk, 103

	hotspot -ac_unit_width/2, ac_unit_height, 0, 104
	hotspot  ac_unit_width/2, ac_unit_height, 0, 105
	hotspot -ac_unit_width/2, ac_unit_height, gs_fthk, 106
	hotspot  ac_unit_width/2, ac_unit_height, gs_fthk, 107
endif

!********************* coordinates according to size types

unitleft = -ac_unit_width / 2
unitright = ac_unit_width / 2
unittop = ac_unit_height
leaftop = ac_leaf_height
egresstop = ac_egress_height

if iStorefrontType = SFTYPE_DOOR_ONLY or  iStorefrontType = SFTYPE_DOOR_TRANSOM then
	leafleft = -ac_leaf_width / 2 + (gs_fw_side_left - gs_fw_side_right)/2
	leafright = ac_leaf_width / 2 - (gs_fw_side_right- gs_fw_side_left)/2

	egressleft = -ac_egress_width / 2 + (gs_fw_side_left - gs_fw_side_right)/2
	egressright = ac_egress_width / 2  - (gs_fw_side_right- gs_fw_side_left)/2
endif

if iStorefrontType = SFTYPE_DOOR_TRSL then
	leafleft	= unitleft  + frameOrSLightWidthLeft
	leafright	= unitright - frameOrSLightWidthRight
	egressleft	= unitleft  + frameOrSLightWidthLeft + gs_ds_w * bEnableDoorStop
	egressright	= unitright - frameOrSLightWidthRight - gs_ds_w * bEnableDoorStop
endif

frameleftout	= unitleft  - gs_frame_ovhg_left_out
framerightout	= unitright + gs_frame_ovhg_right_out
frameleftin		= unitleft  - gs_frame_ovhg_left_in
framerightin	= unitright + gs_frame_ovhg_right_in
frametopin		= unittop + gs_frame_ovhg_top_in
frametopout		= unittop + gs_frame_ovhg_top_out

leftFrame = -ac_unit_width/2
if (abs(gs_tolerance_left) > EPS) then
	leftFrame = frameleftout
	if abs(frameleftout) > abs(frameleftin) then
		leftFrame = frameleftin
	endif
endif

rightFrame = ac_unit_width/2
if (abs(gs_tolerance_right) > EPS) then
	rightFrame = framerightout
	if abs(framerightout) > abs(framerightin) then
		rightFrame = framerightin
	endif
endif

topFrame = ac_unit_height
if (abs(gs_tolerance_upper) > EPS) | (bEnableVentilationProfile & bVentilationProfile & (iVentilationProfileType = VENTPROFILE_OVER_FRAME)) then
	topFrame = frametopout
	if  abs(frametopout) > abs(frametopin) then
		topFrame = frametopin
	endif
endif

! ------------------------------------------------------------------------------
! Egress hotspots
! ------------------------------------------------------------------------------
flipMod = -1
if WIDO_REVEAL_SIDE then
	flipMod = 1
endif

egressthk1 = gs_leaf_thk
egressthk2 = egressthk1 - bEnableDoorStop * gs_ds_thk * flipMod

if bShowEgressHotspots then
	if not(gs_ds) then
		hotspot egressleft, egresstop, 0, 210
		hotspot egressright, egresstop, 0, 211
	else
		hotspot egressleft, egresstop, egressthk1, 210
		hotspot egressright, egresstop, egressthk1, 211
	endif

	if gs_ds then
		hotspot egressleft, egresstop, egressthk2, 212
		hotspot egressright, egresstop, egressthk2, 213
	else
		hotspot egressleft, egresstop, gs_fthk, 212
		hotspot egressright, egresstop, gs_fthk, 213
	endif
endif

if bShowAddHotspotsForIS then
	if not(gs_ds) then
		hotspot egressleft, 0, 0, 200
		hotspot egressright, 0, 0, 201
	else
		hotspot egressleft, 0, egressthk1, 200
		hotspot egressright, 0, egressthk1, 201
	endif

	if gs_ds then
		hotspot egressleft, 0, egressthk2, 202
		hotspot egressright, 0, egressthk2, 203
	else
		hotspot egressleft, 0, gs_fthk, 202
		hotspot egressright, 0, gs_fthk, 203
	endif
endif

! ------------------------------------------------------------------------------
! Leaf hotspots
! ------------------------------------------------------------------------------

if bShowLeafHotspots then
	hotspot leafleft, leaftop, 0, 310
	hotspot leafright, leaftop, 0, 311
	hotspot leafleft, leaftop, gs_fthk, 312
	hotspot leafright, leaftop, gs_fthk, 313
endif

if bShowAddHotspotsForIS then
	hotspot leafleft, 0, 0, 300
	hotspot leafright, 0, 0, 301
	hotspot leafleft, 0, gs_fthk, 302
	hotspot leafright, 0, gs_fthk, 303
endif


! =============================================================================
! Draw Ventilation Profile
! =============================================================================

isVentilationOverFrame = (bEnableVentilationProfile & bVentilationProfile & (iVentilationProfileType = VENTPROFILE_OVER_FRAME))

if isVentilationOverFrame then
	addy ac_unit_height
	if WIDO_REVEAL_SIDE then
		addz gs_fthk
		mulz -1
	endif
	call "Ventilation_profile" parameters	A							= ac_unit_width,
											VentilationProfileThickness	= VentilationProfileThickness,
											VentilationProfileHeight	= VentilationProfileHeight,
											gs_frame_thk				= gs_fthk,
											bVentilationProfile			= bVentilationProfile,
											iVentilationProfileType		= iVentilationProfileType,
											gs_ventProfile_pen			= gs_frame_pen,
											gs_ventProfile_pen_cont		= gs_pen_2D,
											gs_ventProfile_fill			= gs_ventProfile_fill,
											gs_ventProfile_pen_bg		= gs_ventProfile_pen_bg,
											gs_ventProfile_pen_fg		= gs_ventProfile_pen_fg,
											gs_ventProfile_mat			= gs_ventProfile_mat
	if WIDO_REVEAL_SIDE then del 2
	del 1
endif


! =============================================================================
! Frame
! =============================================================================

pen gs_frame_pen
material gs_frame_mat

nFlipTrans = 0
if bOpeningDirectionSL then
	addz gs_fthk
	mulz -1
	nFlipTrans = 2
endif

sect_fill fr_sect_fill_type, fr_sect_fill_bg, fr_sect_fill_fg, gs_pen_2D

GROUP "frame"

! Cut Ventilation Profile =====================================================

if isVentilationOverFrame then
	addy ac_unit_height
	cutpolya 5, 2, 0,
		-ac_unit_width/2, 0, 11+3*(WIDO_REVEAL_SIDE),
		-ac_unit_width/2, VentilationProfileHeight, 11+3*(WIDO_REVEAL_SIDE),
		ac_unit_width/2, VentilationProfileHeight, 11+3*(WIDO_REVEAL_SIDE),
		ac_unit_width/2, 0, 11+3*(WIDO_REVEAL_SIDE),
		-ac_unit_width/2, 0, -1
	del 1
endif

sect_fill fr_sect_fill_type, fr_sect_fill_bg, fr_sect_fill_fg, gs_pen_2D

! Corner ======================================================================

if gs_cl AND leftCornerAngle<180 then
	ADDX -ac_unit_width/2
	ROTY -leftCornerAngle/2
		CUTPLANE
	DEL 2
endif

if gs_cl AND leftCornerAngle>180 then
	ADD -ac_unit_width/2-WIDO_REVEAL_SIDE*gs_fthk*TAN(90-leftCornerAngle/2), 0, (1-WIDO_REVEAL_SIDE)*gs_fthk
	ROTY -leftCornerAngle/2
	CUTPLANE
	DEL 2
endif

if gs_cr AND rightCornerAngle<180 then
	ADDX ac_unit_width/2
	ROTY rightCornerAngle/2
	CUTPLANE
	DEL 2
endif

if gs_cr AND rightCornerAngle>180 then
	ADD ac_unit_width/2+WIDO_REVEAL_SIDE*gs_fthk*TAN(90-rightCornerAngle/2), 0, (1-WIDO_REVEAL_SIDE)*gs_fthk
	ROTY rightCornerAngle/2
	CUTPLANE
	DEL 2
endif


! Butt Glazed =================================================================

if bMiddleRail then
	if gs_sidelight_right then
		if iFrameStyleRight = FRAME_STYLE_BUTT_GLAZED then
			CUTFORM 5, 1, 1+2,
				 0, 0, 1, gs_gsb+gs_glass_thk,
				ac_unit_width/2,         gs_fw_lower, 2+8+16,
				(ac_unit_width/2-rightPanelWidth),  gs_fw_lower,  2+8+16,
				(ac_unit_width/2-rightPanelWidth), midRailElevation+midRailWidth/2, 2+8+16,
				ac_unit_width/2, midRailElevation+midRailWidth/2,  2+8+16,
				ac_unit_width/2,         gs_fw_lower,  -1
		endif

		if iFrameStyleRight = FRAME_STYLE_BUTT_GLAZED AND gs_cr AND rightCornerAngle<180 then
			ROTX 90
			ADDZ -gs_fw_lower
				CUTFORM 5, 1, 1+2,
						0,0,1, -(midRailElevation-midRailWidth/2-gs_fw_lower),
						ac_unit_width/2-gs_fw_side_right-(gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)-gs_fw_side_right)*(rightCornerAngle<60), 0, 1+2+4+8+16+64,
						ac_unit_width/2-(gs_frame_width/2)/SIN(rightCornerAngle/2), 0,     1+2+4+8+16+64,
						ac_unit_width/2-gs_fthk*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(rightCornerAngle/2), gs_fthk,      1+2+4+8+16+64,
						ac_unit_width/2-gs_fw_side_right-(gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)-gs_fw_side_right)*(rightCornerAngle<60), gs_fthk, 1+2+4+8+16+64,
						ac_unit_width/2-gs_fw_side_right-(gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)-gs_fw_side_right)*(rightCornerAngle<60), 0,      -1
			DEL 2
			xpr=gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)
		endif

		if iFrameStyleRight = FRAME_STYLE_BUTT_GLAZED_WO_FRAME AND gs_cr then
			ROTX 90
			ADDZ -gs_fw_lower
				CUTFORM 5, 1, 1+2,
						0,0,1, -(midRailElevation-midRailWidth/2-gs_fw_lower),
						ac_unit_width/2-gs_fw_side_right, 0, 1+2+4+8+16,
						ac_unit_width/2, 0,     1+2+4+8+16,
						ac_unit_width/2, gs_fthk,      1+2+4+8+16,
						ac_unit_width/2-gs_fw_side_right, gs_fthk, 1+2+4+8+16,
						ac_unit_width/2-gs_fw_side_right, 0,      -1
			DEL 2
			xpr=0
		endif

		if iFrameStyleRight = FRAME_STYLE_ANGLE_FRAME AND gs_cr AND rightCornerAngle<180 then
			ROTX 90
			ADDZ -gs_fw_lower

			CUTFORM 6, 1, 1+2,
				0,0,1, -(midRailElevation-midRailWidth/2-gs_fw_lower),
				ac_unit_width/2-gs_fw_side_right-(gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)-gs_fw_side_right)*(rightCornerAngle<60), 0, 1+2+4+8+16,
				ac_unit_width/2-(gs_gsb+gs_glass_thk)*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(rightCornerAngle/2), 0,     1+2+4+8+16,
				ac_unit_width/2-(gs_gsb+gs_glass_thk)*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(rightCornerAngle/2), (gs_gsb+gs_glass_thk),     1+2+4+8+16,
				ac_unit_width/2-gs_fthk*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(rightCornerAngle/2), gs_fthk,      1+2+4+8+16,
				ac_unit_width/2-gs_fw_side_right-(gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)-gs_fw_side_right)*(rightCornerAngle<60), gs_fthk, 1+2+4+8+16,
				ac_unit_width/2-gs_fw_side_right-(gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)-gs_fw_side_right)*(rightCornerAngle<60), 0,      -1

			DEL 2
			xpr=gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)
		endif

		if iFrameStyleRight = FRAME_STYLE_BUTT_GLAZED AND gs_cr AND rightCornerAngle>180 then
			ROTX 90
			ADDZ -gs_fw_lower
			CUTFORM 5, 1, 1+2,
					0,0,1, -(midRailElevation-midRailWidth/2-gs_fw_lower),
					ac_unit_width/2-gs_fw_side_right, 0,      95,
					ac_unit_width/2+gs_fthk*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(180-rightCornerAngle/2), 0,    95,
					ac_unit_width/2-(gs_frame_width/2)/SIN(180-rightCornerAngle/2), gs_fthk,      95,
					ac_unit_width/2-gs_fw_side_right, gs_fthk,     95,
					ac_unit_width/2-gs_fw_side_right, 0,      -1
			DEL 2
			xpr=-gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)
		endif

		if iFrameStyleRight = FRAME_STYLE_ANGLE_FRAME AND gs_cr AND rightCornerAngle>180 then
			ROTX 90
			ADDZ -gs_fw_lower
			CUTFORM 6, 1, 1+2,
					0,0,1, -(midRailElevation-midRailWidth/2-gs_fw_lower),
					ac_unit_width/2-gs_fw_side_right, 0,      31,
					ac_unit_width/2+(gs_fthk-gs_gsb-gs_glass_thk)*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(180-rightCornerAngle/2), 0,    31,
					ac_unit_width/2+(gs_fthk-gs_gsb-gs_glass_thk)*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(180-rightCornerAngle/2), (gs_gsb+gs_glass_thk),    31,
					ac_unit_width/2-(gs_frame_width/2)/SIN(180-rightCornerAngle/2), gs_fthk,      31,
					ac_unit_width/2-gs_fw_side_right, gs_fthk,     31,
					ac_unit_width/2-gs_fw_side_right, 0,      -1
			DEL 2
			xpr=-gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)
		endif
	endif

	if gs_sidelight_left then

		if iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED then
			CUTFORM 5, 1, 1+2,
				0, 0, 1, gs_gsb+gs_glass_thk,
				-ac_unit_width/2,         gs_fw_lower,  2+8+16,
				(-ac_unit_width/2+leftPanelWidth),  gs_fw_lower,  2+8+16,
				(-ac_unit_width/2+leftPanelWidth), midRailElevation+midRailWidth/2,  2+8+16,
				-ac_unit_width/2, midRailElevation+midRailWidth/2, 2+8+16,
				-ac_unit_width/2,         gs_fw_lower,  -1
		endif

		if iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED AND gs_cl AND leftCornerAngle<180 then
			ROTX 90
			ADDZ -gs_fw_lower
			CUTFORM 5, 1, 1+2,
				0,0,1, -(midRailElevation-midRailWidth/2-gs_fw_lower),
				-ac_unit_width/2+(gs_frame_width/2)/SIN(leftCornerAngle/2),0,95,
				-ac_unit_width/2+gs_fw_side_left+(gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)-gs_fw_side_left)*(leftCornerAngle<60),0,95,
				-ac_unit_width/2+gs_fw_side_left+(gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)-gs_fw_side_left)*(leftCornerAngle<60), gs_fthk,95,
				-ac_unit_width/2+gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2),gs_fthk,95,
				-ac_unit_width/2+(gs_frame_width/2)/SIN(leftCornerAngle/2),0,-1
			DEL 2
			xpl=gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)
		endif

		if iFrameStyleLeft = FRAME_STYLE_ANGLE_FRAME AND gs_cl AND leftCornerAngle<180 then
			ROTX 90
			ADDZ -gs_fw_lower
			CUTFORM 6, 1, 1+2,
				0,0,1, -(midRailElevation-midRailWidth/2-gs_fw_lower),
				-ac_unit_width/2+(gs_gsb+gs_glass_thk)*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), gs_gsb+gs_glass_thk,31,
				-ac_unit_width/2+(gs_gsb+gs_glass_thk)*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), 0,31,
				-ac_unit_width/2+gs_fw_side_left+(gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)-gs_fw_side_left)*(leftCornerAngle<60),0,31,
				-ac_unit_width/2+gs_fw_side_left+(gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)-gs_fw_side_left)*(leftCornerAngle<60), gs_fthk,31,
				-ac_unit_width/2+gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2),gs_fthk,31,
				-ac_unit_width/2+(gs_gsb+gs_glass_thk)*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), gs_gsb+gs_glass_thk,-1
			DEL 2
			xpl=gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)
		endif

		if iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED AND gs_cl AND leftCornerAngle >180 then
			ROTX 90
			ADDZ -gs_fw_lower
			CUTFORM 5, 1, 1+2,
					0,0,1, -(midRailElevation-midRailWidth/2-gs_fw_lower),
					-ac_unit_width/2+gs_fthk*TAN(90+leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), 0, 95,
					-ac_unit_width/2+gs_fw_side_left, 0, 95,
					-ac_unit_width/2+gs_fw_side_left, gs_fthk, 95,
					-ac_unit_width/2+(gs_frame_width/2)/SIN(leftCornerAngle/2), gs_fthk, 95,
					-ac_unit_width/2+gs_fthk*TAN(90+leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), 0, -1
			DEL 2
			xpl=-gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)
		endif

		if iFrameStyleLeft = FRAME_STYLE_ANGLE_FRAME AND gs_cl AND leftCornerAngle >180 then
			ROTX 90
			ADDZ -gs_fw_lower
			CUTFORM 6, 1, 1+2,
					0,0,1, -(midRailElevation-midRailWidth/2-gs_fw_lower),
					-ac_unit_width/2+(gs_fthk-gs_gsb-gs_glass_thk)*TAN(90+leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), 0, 31,
					-ac_unit_width/2+gs_fw_side_left, 0, 31,
					-ac_unit_width/2+gs_fw_side_left, gs_fthk, 31,
					-ac_unit_width/2+(gs_frame_width/2)/SIN(leftCornerAngle/2), gs_fthk, 31,
					-ac_unit_width/2+(gs_fthk-gs_gsb-gs_glass_thk)*TAN(90+leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), gs_gsb+gs_glass_thk, 31,
					-ac_unit_width/2+(gs_fthk-gs_gsb-gs_glass_thk)*TAN(90+leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), 0, -1
			DEL 2
			xpl=-gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)
		endif

		if iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED_WO_FRAME AND gs_cl then
			ROTX 90
			ADDZ -gs_fw_lower
			CUTFORM 5, 1, 1+2,
					0,0,1, -(midRailElevation-midRailWidth/2-gs_fw_lower),
					-ac_unit_width/2+gs_fw_side_left, 0, 1+2+4+8+16,
					-ac_unit_width/2, 0,     1+2+4+8+16,
					-ac_unit_width/2, gs_fthk,      1+2+4+8+16,
					-ac_unit_width/2+gs_fw_side_left, gs_fthk, 1+2+4+8+16,
					-ac_unit_width/2+gs_fw_side_left, 0,      -1
			DEL 2
			xpl=0
		endif
	endif
endif


! Butt Glazed of Transom ======================================================

if gs_sidelight_right then

	if iFrameStyleRight = FRAME_STYLE_BUTT_GLAZED then
		CUTFORM 5, 1, 1+2,
				0, 0, 1, gs_gsb+gs_glass_thk,
				ac_unit_width/2, ac_unit_height-frameOrTransomHeight, 2+8+16,
				(ac_unit_width/2-rightPanelWidth), ac_unit_height-frameOrTransomHeight,  2+8+16,
				(ac_unit_width/2-rightPanelWidth),(midRailElevation)*bMiddleRail+midRailWidth/2,  2+8+16,
				ac_unit_width/2, (midRailElevation)*bMiddleRail+midRailWidth/2,  2+8+16,
				ac_unit_width/2, ac_unit_height-frameOrTransomHeight,  -1
	endif

	if iFrameStyleRight = FRAME_STYLE_BUTT_GLAZED AND gs_cr AND rightCornerAngle<180 then
		ROTX 90
		ADDZ -ac_unit_height+frameOrTransomHeight
		CUTFORM 5, 1, 1+2,
				0,0,1, ac_unit_height-frameOrTransomHeight-(midRailElevation)*bMiddleRail-midRailWidth/2,
				ac_unit_width/2-gs_fw_side_right-(gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)-gs_fw_side_right)*(rightCornerAngle<60), 0,     95,
				ac_unit_width/2-(gs_frame_width/2)/SIN(rightCornerAngle/2), 0,     95,
				ac_unit_width/2-gs_fthk*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(rightCornerAngle/2), gs_fthk,      95,
				ac_unit_width/2-gs_fw_side_right-(gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)-gs_fw_side_right)*(rightCornerAngle<60), gs_fthk,      95,
				ac_unit_width/2-gs_fw_side_right-(gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)-gs_fw_side_right)*(rightCornerAngle<60), 0,      -1
		DEL 2
		xprtr=gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)
	endif

	if iFrameStyleRight = FRAME_STYLE_ANGLE_FRAME AND gs_cr AND rightCornerAngle<180 then
		ROTX 90
		ADDZ -ac_unit_height+frameOrTransomHeight
		CUTFORM 6, 1, 1+2,
				0,0,1, ac_unit_height-frameOrTransomHeight-(midRailElevation)*bMiddleRail-midRailWidth/2,
				ac_unit_width/2-gs_fw_side_right-(gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)-gs_fw_side_right)*(rightCornerAngle<60), 0, 1+2+4+8+16,
				ac_unit_width/2-(gs_gsb+gs_glass_thk)*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(rightCornerAngle/2), 0,     1+2+4+8+16,
				ac_unit_width/2-(gs_gsb+gs_glass_thk)*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(rightCornerAngle/2), (gs_gsb+gs_glass_thk),     1+2+4+8+16,
				ac_unit_width/2-gs_fthk*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(rightCornerAngle/2), gs_fthk,      1+2+4+8+16,
				ac_unit_width/2-gs_fw_side_right-(gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)-gs_fw_side_right)*(rightCornerAngle<60), gs_fthk, 1+2+4+8+16,
				ac_unit_width/2-gs_fw_side_right-(gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)-gs_fw_side_right)*(rightCornerAngle<60), 0,      -1

		DEL 2
		xprtr=gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)
	endif

	if iFrameStyleRight = FRAME_STYLE_BUTT_GLAZED AND gs_cr AND rightCornerAngle >180 then
		ROTX 90
		ADDZ -ac_unit_height+frameOrTransomHeight
		CUTFORM 5, 1, 1+2,
				0,0,1, ac_unit_height-frameOrTransomHeight-(midRailElevation)*bMiddleRail-midRailWidth/2,
				ac_unit_width/2-gs_fw_side_right, 0,      95,
				ac_unit_width/2+gs_fthk*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(180-rightCornerAngle/2), 0,    95,
				ac_unit_width/2-(gs_frame_width/2)/SIN(180-rightCornerAngle/2), gs_fthk,      95,
				ac_unit_width/2-gs_fw_side_right,gs_fthk,     95,
				ac_unit_width/2-gs_fw_side_right, 0,      -1
		DEL 2
		xprtr=-gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)
	endif

	if iFrameStyleRight = FRAME_STYLE_ANGLE_FRAME AND gs_cr AND rightCornerAngle>180 then
		ROTX 90
		ADDZ -ac_unit_height+frameOrTransomHeight
		CUTFORM 6, 1, 1+2,
				0,0,1, ac_unit_height-frameOrTransomHeight-(midRailElevation)*bMiddleRail-midRailWidth/2,
				ac_unit_width/2-gs_fw_side_right, 0,      31,
				ac_unit_width/2+(gs_fthk-gs_gsb-gs_glass_thk)*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(180-rightCornerAngle/2), 0,    31,
				ac_unit_width/2+(gs_fthk-gs_gsb-gs_glass_thk)*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(180-rightCornerAngle/2), (gs_gsb+gs_glass_thk),    31,
				ac_unit_width/2-(gs_frame_width/2)/SIN(180-rightCornerAngle/2), gs_fthk,      31,
				ac_unit_width/2-gs_fw_side_right, gs_fthk,     31,
				ac_unit_width/2-gs_fw_side_right, 0,      -1
		DEL 2
		xprtr=-gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)
	endif

	if iFrameStyleRight = FRAME_STYLE_BUTT_GLAZED_WO_FRAME AND gs_cr then
		ROTX 90
		ADDZ -ac_unit_height+frameOrTransomHeight
		CUTFORM 5, 1, 1+2,
				0,0,1, ac_unit_height-frameOrTransomHeight-(midRailElevation)*bMiddleRail-midRailWidth/2,
				ac_unit_width/2-gs_fw_side_right, 0, 1+2+4+8+16,
				ac_unit_width/2, 0,     1+2+4+8+16,
				ac_unit_width/2, gs_fthk,      1+2+4+8+16,
				ac_unit_width/2-gs_fw_side_right, gs_fthk, 1+2+4+8+16,
				ac_unit_width/2-gs_fw_side_right, 0,      -1
		DEL 2
		xprtr=0
	endif

endif

if gs_sidelight_left then
	if iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED then
		CUTFORM 5, 1, 1+2,
				 0, 0, 1, gs_gsb+gs_glass_thk,
				-ac_unit_width/2, ac_unit_height-frameOrTransomHeight, 2+8+16,
				(-ac_unit_width/2+leftPanelWidth), ac_unit_height-frameOrTransomHeight,  2+8+16,
				(-ac_unit_width/2+leftPanelWidth),(midRailElevation)*bMiddleRail+midRailWidth/2,  2+8+16,
				-ac_unit_width/2, (midRailElevation)*bMiddleRail+midRailWidth/2,  2+8+16,
				-ac_unit_width/2, ac_unit_height-frameOrTransomHeight,  -1
	endif

	if iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED AND gs_cl AND leftCornerAngle<180 then
		ROTX 90
		ADDZ -ac_unit_height+frameOrTransomHeight
		CUTFORM 5, 1, 1+2,
				0,0,1, ac_unit_height-frameOrTransomHeight-(midRailElevation)*bMiddleRail-midRailWidth/2,
				-ac_unit_width/2+(gs_frame_width/2)/SIN(leftCornerAngle/2),0,95,
				-ac_unit_width/2+gs_fw_side_left+(gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)-gs_fw_side_left)*(leftCornerAngle<60),0,95,
				-ac_unit_width/2+gs_fw_side_left+(gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)-gs_fw_side_left)*(leftCornerAngle<60), gs_fthk,95,
				-ac_unit_width/2+gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2),gs_fthk,95,
				-ac_unit_width/2+(gs_frame_width/2)/SIN(leftCornerAngle/2),0,-1
		DEL 2
		xpltr=gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)
	endif

	if iFrameStyleLeft = FRAME_STYLE_ANGLE_FRAME AND gs_cl AND leftCornerAngle<180 then
		ROTX 90
		ADDZ -ac_unit_height+frameOrTransomHeight
		CUTFORM 6, 1, 1+2,
				0,0,1, ac_unit_height-frameOrTransomHeight-(midRailElevation)*bMiddleRail-midRailWidth/2,
				-ac_unit_width/2+(gs_gsb+gs_glass_thk)*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), gs_gsb+gs_glass_thk,31,
				-ac_unit_width/2+(gs_gsb+gs_glass_thk)*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), 0,31,
				-ac_unit_width/2+gs_fw_side_left+(gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)-gs_fw_side_left)*(leftCornerAngle<60),0,31,
				-ac_unit_width/2+gs_fw_side_left+(gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)-gs_fw_side_left)*(leftCornerAngle<60), gs_fthk,31,
				-ac_unit_width/2+gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2),gs_fthk, 31,
				-ac_unit_width/2+(gs_gsb+gs_glass_thk)*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), gs_gsb+gs_glass_thk,-1
		DEL 2
		xpltr=gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)
	endif

	if iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED AND gs_cl AND leftCornerAngle >180 then
		ROTX 90
		ADDZ -ac_unit_height+frameOrTransomHeight
		CUTFORM 5, 1, 1+2,
				0,0,1, ac_unit_height-frameOrTransomHeight-(midRailElevation)*bMiddleRail-midRailWidth/2,
				-ac_unit_width/2+gs_fthk*TAN(90+leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), 0, 95,
				-ac_unit_width/2+gs_fw_side_left, 0, 95,
				-ac_unit_width/2+gs_fw_side_left, gs_fthk, 95,
				-ac_unit_width/2+(gs_frame_width/2)/SIN(leftCornerAngle/2), gs_fthk, 95,
				-ac_unit_width/2+gs_fthk*TAN(90+leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), 0, -1
		DEL 2
		xpltr=-gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)
	endif

	if iFrameStyleLeft = FRAME_STYLE_ANGLE_FRAME AND gs_cl AND leftCornerAngle >180 then
		ROTX 90
		ADDZ -ac_unit_height+frameOrTransomHeight
		CUTFORM 6, 1, 1+2,
				0,0,1, ac_unit_height-frameOrTransomHeight-(midRailElevation)*bMiddleRail-midRailWidth/2,
				-ac_unit_width/2+(gs_fthk-gs_gsb-gs_glass_thk)*TAN(90+leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), 0, 31,
				-ac_unit_width/2+gs_fw_side_left, 0, 31,
				-ac_unit_width/2+gs_fw_side_left, gs_fthk, 31,
				-ac_unit_width/2+(gs_frame_width/2)/SIN(leftCornerAngle/2), gs_fthk, 31,
				-ac_unit_width/2+(gs_fthk-gs_gsb-gs_glass_thk)*TAN(90+leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), gs_gsb+gs_glass_thk, 31,
				-ac_unit_width/2+(gs_fthk-gs_gsb-gs_glass_thk)*TAN(90+leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), 0, -1
		DEL 2
		xpltr=-gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)
	endif

	if iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED_WO_FRAME AND gs_cl then
		ROTX 90
		ADDZ -ac_unit_height+frameOrTransomHeight
		CUTFORM 5, 1, 1+2,
				0,0,1, ac_unit_height-frameOrTransomHeight-(midRailElevation)*bMiddleRail-midRailWidth/2,
				-ac_unit_width/2+gs_fw_side_left, 0, 1+2+4+8+16,
				-ac_unit_width/2, 0,     1+2+4+8+16,
				-ac_unit_width/2, gs_fthk,      1+2+4+8+16,
				-ac_unit_width/2+gs_fw_side_left, gs_fthk, 1+2+4+8+16,
				-ac_unit_width/2+gs_fw_side_left, 0,      -1
		DEL 2
		xpltr=0
	endif

endif


! Top Panel ===================================================================

if iFrameStyleRight = FRAME_STYLE_BUTT_GLAZED AND gs_door_transom then
	CUTFORM 5, 1, 1+2,
			0, 0, 1, gs_gsb+gs_glass_thk,
			ac_unit_width/2, ac_unit_height-topPanelHeight,  2+8+16,
			(ac_unit_width/2-rightPanelWidth)*gs_sidelight_right, ac_unit_height-topPanelHeight, 2+8+16,
			(ac_unit_width/2-rightPanelWidth)*gs_sidelight_right, ac_unit_height-gs_fw_upper, 2+8+16,
			ac_unit_width/2, ac_unit_height-gs_fw_upper, 2+8+16,
			ac_unit_width/2, ac_unit_height-topPanelHeight,  -1
endif

if iFrameStyleRight = FRAME_STYLE_BUTT_GLAZED AND gs_door_transom AND gs_cr AND rightCornerAngle<180 then
	ROTX 90
	ADDZ -ac_unit_height+gs_fw_upper
	CUTFORM 5, 1, 1+2,
			0,0,1, topPanelHeight-gs_fw_upper,
			ac_unit_width/2-gs_fw_side_right-(gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)-gs_fw_side_right)*(rightCornerAngle<60), 0,     95,
			ac_unit_width/2-(gs_frame_width/2)/SIN(rightCornerAngle/2), 0,     95,
			ac_unit_width/2-gs_fthk*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(rightCornerAngle/2), gs_fthk,      95,
			ac_unit_width/2-gs_fw_side_right-(gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)-gs_fw_side_right)*(rightCornerAngle<60),gs_fthk,      95,
			ac_unit_width/2-gs_fw_side_right-(gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)-gs_fw_side_right)*(rightCornerAngle<60), 0,      -1
	DEL 2
	xprtp=gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)
endif

if gs_door_transom then

	if iFrameStyleRight = FRAME_STYLE_ANGLE_FRAME AND gs_cr AND rightCornerAngle<180 then
		ROTX 90
		ADDZ -ac_unit_height+gs_fw_upper
		CUTFORM 6, 1, 1+2,
				0,0,1, topPanelHeight-gs_fw_upper,
				ac_unit_width/2-gs_fw_side_right-(gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)-gs_fw_side_right)*(rightCornerAngle<60), 0, 1+2+4+8+16,
				ac_unit_width/2-(gs_gsb+gs_glass_thk)*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(rightCornerAngle/2), 0,     1+2+4+8+16,
				ac_unit_width/2-(gs_gsb+gs_glass_thk)*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(rightCornerAngle/2), (gs_gsb+gs_glass_thk),     1+2+4+8+16,
				ac_unit_width/2-gs_fthk*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(rightCornerAngle/2), gs_fthk,      1+2+4+8+16,
				ac_unit_width/2-gs_fw_side_right-(gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)-gs_fw_side_right)*(rightCornerAngle<60), gs_fthk, 1+2+4+8+16,
				ac_unit_width/2-gs_fw_side_right-(gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)-gs_fw_side_right)*(rightCornerAngle<60), 0,      -1

		DEL 2
		xprtp=gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)
	endif

	if iFrameStyleRight = FRAME_STYLE_BUTT_GLAZED AND gs_door_transom AND gs_cr AND rightCornerAngle>180 then
		ROTX 90
		ADDZ -ac_unit_height+gs_fw_upper
		CUTFORM 5, 1, 1+2,
				0,0,1, topPanelHeight-gs_fw_upper,
				ac_unit_width/2-gs_fw_side_right, 0,      95,
				ac_unit_width/2+gs_fthk*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(180-rightCornerAngle/2), 0,    95,
				ac_unit_width/2-(gs_frame_width/2)/SIN(180-rightCornerAngle/2), gs_fthk,      95,
				ac_unit_width/2-gs_fw_side_right,gs_fthk,     95,
				ac_unit_width/2-gs_fw_side_right, 0,      -1
		DEL 2
		xprtp=-gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)
	endif

	if iFrameStyleRight = FRAME_STYLE_ANGLE_FRAME AND gs_cr AND rightCornerAngle>180 then
		ROTX 90
		ADDZ -ac_unit_height+gs_fw_upper
		CUTFORM 6, 1, 1+2,
				0,0,1, topPanelHeight-gs_fw_upper,
				ac_unit_width/2-gs_fw_side_right, 0,      31,
				ac_unit_width/2+(gs_fthk-gs_gsb-gs_glass_thk)*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(180-rightCornerAngle/2), 0,    31,
				ac_unit_width/2+(gs_fthk-gs_gsb-gs_glass_thk)*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(180-rightCornerAngle/2), (gs_gsb+gs_glass_thk),    31,
				ac_unit_width/2-(gs_frame_width/2)/SIN(180-rightCornerAngle/2), gs_fthk,      31,
				ac_unit_width/2-gs_fw_side_right, gs_fthk,     31,
				ac_unit_width/2-gs_fw_side_right, 0,      -1
		DEL 2
		xprtp=-gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)
	endif

	if iFrameStyleRight = FRAME_STYLE_BUTT_GLAZED_WO_FRAME AND gs_cr then
		ROTX 90
		ADDZ -ac_unit_height+gs_fw_upper
		CUTFORM 5, 1, 1+2,
				0,0,1, topPanelHeight-gs_fw_upper,
				ac_unit_width/2-gs_fw_side_right, 0, 1+2+4+8+16,
				ac_unit_width/2, 0,     1+2+4+8+16,
				ac_unit_width/2, gs_fthk,      1+2+4+8+16,
				ac_unit_width/2-gs_fw_side_right, gs_fthk, 1+2+4+8+16,
				ac_unit_width/2-gs_fw_side_right, 0,      -1
		DEL 2
		xprtp=0
	endif

endif

if iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED AND gs_door_transom then
	CUTFORM 5, 1, 1+2,
			 0, 0, 1, gs_gsb+gs_glass_thk,
			-ac_unit_width/2, ac_unit_height-topPanelHeight,  2+8+16,
			(-ac_unit_width/2+leftPanelWidth)*gs_sidelight_left, ac_unit_height-topPanelHeight, 2+8+16,
			(-ac_unit_width/2+leftPanelWidth)*gs_sidelight_left, ac_unit_height-gs_fw_upper, 2+8+16,
			-ac_unit_width/2, ac_unit_height-gs_fw_upper, 2+8+16,
			-ac_unit_width/2, ac_unit_height-topPanelHeight,  -1
endif

if gs_door_transom then
	if iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED AND gs_door_transom AND gs_cl AND leftCornerAngle <180 then
		ROTX 90
		ADDZ -ac_unit_height+gs_fw_upper
		CUTFORM 5, 1, 1+2,
				0,0,1, topPanelHeight-gs_fw_upper,
				-ac_unit_width/2+(gs_frame_width/2)/SIN(leftCornerAngle/2),0,95,
				-ac_unit_width/2+gs_fw_side_left+(gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)-gs_fw_side_left)*(leftCornerAngle<60),0,95,
				-ac_unit_width/2+gs_fw_side_left+(gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)-gs_fw_side_left)*(leftCornerAngle<60), gs_fthk,95,
				-ac_unit_width/2+gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2),gs_fthk,95,
				-ac_unit_width/2+(gs_frame_width/2)/SIN(leftCornerAngle/2),0,-1
		DEL 2
		xpltp=gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)
	endif

	if iFrameStyleLeft = FRAME_STYLE_ANGLE_FRAME AND gs_cl AND leftCornerAngle<180 then
		ROTX 90
		ADDZ -ac_unit_height+gs_fw_upper
		CUTFORM 6, 1, 1+2,
				0,0,1, topPanelHeight-gs_fw_upper,
				-ac_unit_width/2+(gs_gsb+gs_glass_thk)*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), gs_gsb+gs_glass_thk,31,
				-ac_unit_width/2+(gs_gsb+gs_glass_thk)*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), 0,31,
				-ac_unit_width/2+gs_fw_side_left+(gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)-gs_fw_side_left)*(leftCornerAngle<60),0,31,
				-ac_unit_width/2+gs_fw_side_left+(gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)-gs_fw_side_left)*(leftCornerAngle<60), gs_fthk,31,
				-ac_unit_width/2+gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2),gs_fthk, 31,
				-ac_unit_width/2+(gs_gsb+gs_glass_thk)*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), gs_gsb+gs_glass_thk,-1
		DEL 2
		xpltp=gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)
	endif

	if iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED AND gs_door_transom AND gs_cl AND leftCornerAngle>180 then
		ROTX 90
		ADDZ -ac_unit_height+gs_fw_upper
			CUTFORM 5, 1, 1+2,
					0,0,1, topPanelHeight-gs_fw_upper,
					-ac_unit_width/2+gs_fthk*TAN(90+leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), 0, 95,
					-ac_unit_width/2+gs_fw_side_left, 0, 95,
					-ac_unit_width/2+gs_fw_side_left, gs_fthk, 95,
					-ac_unit_width/2+(gs_frame_width/2)/SIN(leftCornerAngle/2), gs_fthk, 95,
					-ac_unit_width/2+gs_fthk*TAN(90+leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), 0, -1
		DEL 2
		xpltp=-gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)
	endif

	if iFrameStyleLeft = FRAME_STYLE_ANGLE_FRAME AND gs_cl AND leftCornerAngle>180 then
		ROTX 90
		ADDZ -ac_unit_height+gs_fw_upper
		CUTFORM 6, 1, 1+2,
				0,0,1, topPanelHeight-gs_fw_upper,
				-ac_unit_width/2+(gs_fthk-gs_gsb-gs_glass_thk)*TAN(90+leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), 0, 31,
				-ac_unit_width/2+gs_fw_side_left, 0, 31,
				-ac_unit_width/2+gs_fw_side_left, gs_fthk, 31,
				-ac_unit_width/2+(gs_frame_width/2)/SIN(leftCornerAngle/2), gs_fthk, 31,
				-ac_unit_width/2+(gs_fthk-gs_gsb-gs_glass_thk)*TAN(90+leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), gs_gsb+gs_glass_thk, 31,
				-ac_unit_width/2+(gs_fthk-gs_gsb-gs_glass_thk)*TAN(90+leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), 0, -1
		DEL 2
		xpltp=-gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)
	endif

	if iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED_WO_FRAME AND gs_cl then
		ROTX 90
		ADDZ -ac_unit_height+gs_fw_upper
		CUTFORM 5, 1, 1+2,
				0,0,1, topPanelHeight-gs_fw_upper,
				-ac_unit_width/2+gs_fw_side_left, 0, 1+2+4+8+16,
				-ac_unit_width/2, 0, 1+2+4+8+16,
				-ac_unit_width/2, gs_fthk, 1+2+4+8+16,
				-ac_unit_width/2+gs_fw_side_left, gs_fthk, 1+2+4+8+16,
				-ac_unit_width/2+gs_fw_side_left, 0, -1
		DEL 2
		xpltp=0
	endif
endif


! =============================================================================
! Contour Frame
! =============================================================================
sect_fill fr_sect_fill_type, fr_sect_fill_bg, fr_sect_fill_fg, gs_pen_2D

if not(gs_sidelight_left) & not(gs_sidelight_right) & not(gs_door_transom) then

if gs_SashText_typ_num = 1 then  ! Mitered Joint
	base
		Prism_ 4, gs_fthk,
			leftFrame, topFrame, mask4,
			leftFrame, 0, 15,
			-ac_unit_width/2+gs_fw_side_left, 0, 15,
			-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 10
	gosub "textures1"
	body 1

	base
		Prism_ 4, gs_fthk,
			rightFrame, 0, mask2,
			rightFrame, topFrame, 10,
			ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 15,
			ac_unit_width/2-gs_fw_side_right, 0, 15
	gosub "textures1"
	body 1

	base
		Prism_ 4, gs_fthk,
			rightFrame, topFrame, mask3,
			leftFrame, topFrame, 10,
			-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 15,
			ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 10
	gosub "textures2"
	body 1
else  ! Butt Joint
	base
		Prism_ 4, gs_fthk,
			leftFrame,	ac_unit_height-gs_fw_upper, mask4,
			leftFrame,	0, 15,
			-ac_unit_width/2+gs_fw_side_left, 0, 15,
			-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 10
	gosub "textures1"
	body 1

	base
		Prism_ 4, gs_fthk,
			rightFrame, 0,mask2,
			rightFrame, ac_unit_height-gs_fw_upper, 8,
			ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 15,
			ac_unit_width/2-gs_fw_side_right, 0, 15
	gosub "textures1"
	body 1

	base
		Prism_ 6, gs_fthk,
			rightFrame,	topFrame,mask3,
			leftFrame,	topFrame,mask4,
			leftFrame,	ac_unit_height-gs_fw_upper, 8+maskLeftButFr,
			-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 15,
			ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 10+maskRightButFr,
			rightFrame, ac_unit_height-gs_fw_upper, mask2
	gosub "textures2"
	body 1
endif
endif



!!!!With Left Sidelight
if gs_sidelight_left & not(gs_sidelight_right) & not(gs_door_transom) then
	if gs_SashText_typ_num = 1 then ! Mittered Joint
		base
			Prism_ 4, gs_fthk,
				leftFrame, topFrame, mask4,
				leftFrame, 0, 10,
				-ac_unit_width/2+gs_fw_side_left, gs_fw_lower, 15,
				-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 10
		gosub "textures1"
		body 1

		base
			Prism_ 4, gs_fthk,
				-ac_unit_width/2+leftPanelWidth, ac_unit_height-gs_fw_upper, 15,
				-ac_unit_width/2+leftPanelWidth, gs_fw_lower, 10,
				-ac_unit_width/2+frameOrSLightWidthLeft, 0, 15,
				-ac_unit_width/2+frameOrSLightWidthLeft, ac_unit_height-gs_fw_upper, 10
		gosub "textures1"
		body 1

		base
			Prism_ 4, gs_fthk,
				rightFrame, 0,mask2,
				rightFrame, topFrame, 10,
				ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 15,
				ac_unit_width/2-gs_fw_side_right, 0, 15
		gosub "textures1"
		body 1

		base
			Prism_ 4, gs_fthk,
				leftFrame, 0, 10,
				-ac_unit_width/2+gs_fw_side_left, gs_fw_lower, 15,
				-ac_unit_width/2+leftPanelWidth, gs_fw_lower, 10,
				-ac_unit_width/2+frameOrSLightWidthLeft, 0, 15
		gosub "textures2"
		body 1

		base
			Prism_ 6, gs_fthk,
				rightFrame, topFrame,mask3,
				leftFrame, topFrame, 10,
				-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 15,
				-ac_unit_width/2+leftPanelWidth, ac_unit_height-gs_fw_upper, 10,
				-ac_unit_width/2+frameOrSLightWidthLeft, ac_unit_height-gs_fw_upper, 15,
				ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 10
		gosub "textures2"
		body 1
	else  ! Butt Joint
		base
			Prism_ 4, gs_fthk,
				leftFrame, ac_unit_height-gs_fw_upper, mask4,
				leftFrame, gs_fw_lower, 8,
				-ac_unit_width/2+gs_fw_side_left, gs_fw_lower, 15,
				-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 10
		gosub "textures1"
		body 1

		base
			Prism_ 4, gs_fthk,
				-ac_unit_width/2+leftPanelWidth, ac_unit_height-gs_fw_upper, 15,
				-ac_unit_width/2+leftPanelWidth, gs_fw_lower, 10,
				-ac_unit_width/2+frameOrSLightWidthLeft, gs_fw_lower, 13,
				-ac_unit_width/2+frameOrSLightWidthLeft, ac_unit_height-gs_fw_upper, 10
		gosub "textures1"
		body 1

		base
			Prism_ 4, gs_fthk,
				rightFrame, 0,mask2,
				rightFrame, ac_unit_height-gs_fw_upper, 8,
				ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 15,
				ac_unit_width/2-gs_fw_side_right, 0, 15
		gosub "textures1"
		body 1

		base
		gosub "leftSidelightBottomFrame"
		gosub "textures2"
		body 1

		base
			Prism_ 8, gs_fthk,
				rightFrame, ac_unit_height,mask3,
				leftFrame, ac_unit_height,mask4,
				leftFrame, ac_unit_height-gs_fw_upper, 8+maskLeftButFr,
				-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 15,
				-ac_unit_width/2+leftPanelWidth, ac_unit_height-gs_fw_upper, 10,
				-ac_unit_width/2+frameOrSLightWidthLeft, ac_unit_height-gs_fw_upper, 15,
				ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 10+maskRightButFr,
				rightFrame, ac_unit_height-gs_fw_upper, mask2
		gosub "textures2"
		body 1
	endif

	!!!Both in Type1 and Type2

	if bMiddleRail then
		gosub "leftMidRail"
	endif
endif

!!!!With Right sidelight
if not(gs_sidelight_left) & gs_sidelight_right & not(gs_door_transom) then
	if gs_SashText_typ_num = 1 then ! Mittered Joint
		base
			Prism_ 4, gs_fthk,
				rightFrame, topFrame, mask4,
				rightFrame, 0, 10,
				ac_unit_width/2-gs_fw_side_right, gs_fw_lower, 15,
				ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 10
		gosub "textures1"
		body 1

		base
			Prism_ 4, gs_fthk,
				ac_unit_width/2-rightPanelWidth, ac_unit_height-gs_fw_upper, 15,
				ac_unit_width/2-rightPanelWidth, gs_fw_lower, 10,
				ac_unit_width/2-frameOrSLightWidthRight, 0, 15,
				ac_unit_width/2-frameOrSLightWidthRight, ac_unit_height-gs_fw_upper, 10
		gosub "textures1"
		body 1

		base
			Prism_ 4, gs_fthk,
				leftFrame, 0, mask2,
				leftFrame, topFrame, 10,
				-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 15,
				-ac_unit_width/2+gs_fw_side_left, 0, 15
		gosub "textures1"
		body 1

		base
			Prism_ 4, gs_fthk,
				rightFrame, 0, 10,
				ac_unit_width/2-gs_fw_side_right, gs_fw_lower, 15,
				ac_unit_width/2-rightPanelWidth, gs_fw_lower, 10,
				ac_unit_width/2-frameOrSLightWidthRight, 0, 15
		gosub "textures2"
		body 1

		base
			Prism_ 6, gs_fthk,
				leftFrame, topFrame, mask3,
				rightFrame, topFrame, 10,
				ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 15,
				ac_unit_width/2-rightPanelWidth, ac_unit_height-gs_fw_upper, 10,
				ac_unit_width/2-frameOrSLightWidthRight, ac_unit_height-gs_fw_upper, 15,
				-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 10
		gosub "textures2"
		body 1
	else  ! Butt Joint
		base
			Prism_ 4, gs_fthk,
				rightFrame, ac_unit_height-gs_fw_upper, mask4,
				rightFrame, gs_fw_lower, 8,
				ac_unit_width/2-gs_fw_side_right, gs_fw_lower, 15,
				ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 10
		gosub "textures1"
		body 1

		base
			Prism_ 4, gs_fthk,
				ac_unit_width/2-rightPanelWidth,  ac_unit_height-gs_fw_upper, 15,
				ac_unit_width/2-rightPanelWidth, gs_fw_lower, 10,
				ac_unit_width/2-frameOrSLightWidthRight, gs_fw_lower, 13,
				ac_unit_width/2-frameOrSLightWidthRight, ac_unit_height-gs_fw_upper, 10
		gosub "textures1"
		body 1

		base
			Prism_ 4, gs_fthk,
				leftFrame, 0, mask2,
				leftFrame, ac_unit_height-gs_fw_upper, 8,
				-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 15,
				-ac_unit_width/2+gs_fw_side_left, 0, 15
		gosub "textures1"
		body 1

		base
		gosub "rightSidelightBottomFrame"
		gosub "textures2"
		body 1

		base
			Prism_ 8, gs_fthk,
				leftFrame, topFrame, mask3,
				rightFrame, topFrame, mask4,
				rightFrame, ac_unit_height-gs_fw_upper, 8+maskRightButFr,
				ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 15,
				ac_unit_width/2-rightPanelWidth, ac_unit_height-gs_fw_upper, 10,
				ac_unit_width/2-frameOrSLightWidthRight, ac_unit_height-gs_fw_upper, 15,
				-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 10+maskLeftButFr,
				leftFrame, ac_unit_height-gs_fw_upper, mask2
		gosub "textures2"
		body 1
	endif


	!!!Both in Type1 and Type2

	if bMiddleRail then
		gosub "rightMidRail"
	endif
endif

!!!With left and right sidelights

if gs_sidelight_left & gs_sidelight_right & not(gs_door_transom) then
	if gs_SashText_typ_num = 1 then ! Mittered Joint

		base
			Prism_ 4, gs_fthk,
				-ac_unit_width/2+leftPanelWidth, ac_unit_height-gs_fw_upper, 15,
				-ac_unit_width/2+leftPanelWidth, gs_fw_lower, 10,
				-ac_unit_width/2+frameOrSLightWidthLeft, 0, 15,
				-ac_unit_width/2+frameOrSLightWidthLeft, ac_unit_height-gs_fw_upper, 10
		gosub "textures1"
		body 1

		base
			Prism_ 4, gs_fthk,
				rightFrame, topFrame, mask4,
				rightFrame, 0, 10,
				ac_unit_width/2-gs_fw_side_right, gs_fw_lower, 15,
				ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 10
		gosub "textures1"
		body 1

		base
			Prism_ 4, gs_fthk,
				ac_unit_width/2-rightPanelWidth,  ac_unit_height-gs_fw_upper, 15,
				ac_unit_width/2-rightPanelWidth, gs_fw_lower, 10,
				ac_unit_width/2-frameOrSLightWidthRight, 0, 15,
				ac_unit_width/2-frameOrSLightWidthRight, ac_unit_height-gs_fw_upper, 10
		gosub "textures1"
		body 1

		base
			Prism_ 4, gs_fthk,
				leftFrame, 0, mask2,
				leftFrame, topFrame, 10,
				-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 15,
				-ac_unit_width/2+gs_fw_side_left, gs_fw_lower, 10
		gosub "textures1"
		body 1

		base
			Prism_ 4, gs_fthk,
				rightFrame, 0, 10,
				ac_unit_width/2-gs_fw_side_right, gs_fw_lower, 15,
				ac_unit_width/2-rightPanelWidth, gs_fw_lower, 10,
				ac_unit_width/2-frameOrSLightWidthRight, 0, 15
		gosub "textures2"
		body 1

		base
			Prism_ 8, gs_fthk,
				leftFrame, topFrame, mask3,
				rightFrame, topFrame, 10,
				ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 15,
				ac_unit_width/2-rightPanelWidth, ac_unit_height-gs_fw_upper, 10,
				ac_unit_width/2-frameOrSLightWidthRight, ac_unit_height-gs_fw_upper, 15,
				-ac_unit_width/2+frameOrSLightWidthLeft, ac_unit_height-gs_fw_upper,10,
				-ac_unit_width/2+leftPanelWidth, ac_unit_height-gs_fw_upper,15,
				-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 10
		gosub "textures2"
		body 1

		base
			Prism_ 4, gs_fthk,
				leftFrame, 0, 10,
				-ac_unit_width/2+gs_fw_side_left, gs_fw_lower, 15,
				-ac_unit_width/2+leftPanelWidth, gs_fw_lower, 10,
				-ac_unit_width/2+frameOrSLightWidthLeft, 0, 15
		gosub "textures2"
		body 1
	else  ! Butt Joint
		base
			Prism_ 4, gs_fthk,
				-ac_unit_width/2+leftPanelWidth, ac_unit_height-gs_fw_upper, 15,
				-ac_unit_width/2+leftPanelWidth, gs_fw_lower, 10,
				-ac_unit_width/2+frameOrSLightWidthLeft, gs_fw_lower, 13,
				-ac_unit_width/2+frameOrSLightWidthLeft, ac_unit_height-gs_fw_upper, 10
		gosub "textures1"
		body 1

		base
			Prism_ 4, gs_fthk,
				rightFrame, ac_unit_height-gs_fw_upper, mask4,
				rightFrame, gs_fw_lower, 8,
				ac_unit_width/2-gs_fw_side_right, gs_fw_lower, 15,
				ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 10
		gosub "textures1"
		body 1

		base
			Prism_ 4, gs_fthk,
				ac_unit_width/2-rightPanelWidth,  ac_unit_height-gs_fw_upper, 15,
				ac_unit_width/2-rightPanelWidth, gs_fw_lower, 10,
				ac_unit_width/2-frameOrSLightWidthRight, gs_fw_lower, 13,
				ac_unit_width/2-frameOrSLightWidthRight, ac_unit_height-gs_fw_upper, 10
		gosub "textures1"
		body 1

		base
			Prism_ 4, gs_fthk,
				leftFrame, gs_fw_lower, mask2,
				leftFrame, ac_unit_height-gs_fw_upper, 8,
				-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 15,
				-ac_unit_width/2+gs_fw_side_left, gs_fw_lower, 10
		gosub "textures1"
		body 1

		base
		gosub "rightSidelightBottomFrame"
		gosub "textures2"
		body 1

		base

			Prism_ 10, gs_fthk,
				leftFrame, topFrame, mask3,
				rightFrame, topFrame, mask4,
				rightFrame, ac_unit_height-gs_fw_upper, 8+maskRightButFr,
				ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 15,
				ac_unit_width/2-rightPanelWidth, ac_unit_height-gs_fw_upper, 10,
				ac_unit_width/2-frameOrSLightWidthRight, ac_unit_height-gs_fw_upper, 15,
				-ac_unit_width/2+frameOrSLightWidthLeft, ac_unit_height-gs_fw_upper,10,
				-ac_unit_width/2+leftPanelWidth, ac_unit_height-gs_fw_upper,15,
				-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 10+maskLeftButFr,
				leftFrame, ac_unit_height-gs_fw_upper, mask2


		gosub "textures2"
		body 1

		base
		gosub "leftSidelightBottomFrame"
		gosub "textures2"
		body 1
	endif

	!!!Both in Type1 and Type2
	if bMiddleRail then
		gosub "rightMidRail"
		gosub "leftMidRail"
	endif
endif


!!!With Transom
if not(gs_sidelight_left) & not(gs_sidelight_right) & gs_door_transom then
	if gs_SashText_typ_num = 1 then ! Mittered Joint
		base
			Prism_ 6, gs_fthk,
				leftFrame, topFrame, mask4,
				leftFrame, 0, 15,
				-ac_unit_width/2+gs_fw_side_left+(xpltp-gs_fw_side_left)*(xpltp>gs_fw_side_left)*(iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED), 0, 15,
				-ac_unit_width/2+gs_fw_side_left+(xpltp-gs_fw_side_left)*(xpltp>gs_fw_side_left)*(iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED),ac_unit_height-frameOrTransomHeight,10,
				-ac_unit_width/2+gs_fw_side_left+(xpltp-gs_fw_side_left)*(xpltp>gs_fw_side_left)*(iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED), ac_unit_height-topPanelHeight , 15,
				-ac_unit_width/2+gs_fw_side_left+(xpltp-gs_fw_side_left)*(xpltp>gs_fw_side_left)*(iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED), ac_unit_height-gs_fw_upper, 10
		gosub "textures1"
		body 1

		base
			Prism_ 6, gs_fthk,
				rightFrame, 0, mask2,
				rightFrame, topFrame, 10,
				ac_unit_width/2-gs_fw_side_right-(xprtp-gs_fw_side_right)*(xprtp>gs_fw_side_right), ac_unit_height-gs_fw_upper, 15,
				ac_unit_width/2-gs_fw_side_right-(xprtp-gs_fw_side_right)*(xprtp>gs_fw_side_right), ac_unit_height-topPanelHeight , 10,
				ac_unit_width/2-gs_fw_side_right-(xprtp-gs_fw_side_right)*(xprtp>gs_fw_side_right), ac_unit_height-frameOrTransomHeight,15,
				ac_unit_width/2-gs_fw_side_right-(xprtp-gs_fw_side_right)*(xprtp>gs_fw_side_right), 0, 15
		gosub "textures1"
		body 1

		base
			Prism_ 4, gs_fthk,
				rightFrame, topFrame, mask3,
				leftFrame, topFrame, 10,
				-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 15,
				ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 10
		gosub "textures2"
		body 1
	else  ! Butt Joint
		base
			Prism_ 6, gs_fthk,
				leftFrame, ac_unit_height-gs_fw_upper, mask4,
				leftFrame, 0, 15,
				-ac_unit_width/2+gs_fw_side_left+(xpltp-gs_fw_side_left)*(xpltp>gs_fw_side_left)*(iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED), 0, 15,
				-ac_unit_width/2+gs_fw_side_left+(xpltp-gs_fw_side_left)*(xpltp>gs_fw_side_left)*(iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED),ac_unit_height-frameOrTransomHeight,10,
				-ac_unit_width/2+gs_fw_side_left+(xpltp-gs_fw_side_left)*(xpltp>gs_fw_side_left)*(iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED), ac_unit_height-topPanelHeight , 15,
				-ac_unit_width/2+gs_fw_side_left+(xpltp-gs_fw_side_left)*(xpltp>gs_fw_side_left)*(iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED), ac_unit_height-gs_fw_upper, 10
		gosub "textures1"
		body 1

		base
			Prism_ 6, gs_fthk,
				rightFrame, 0,mask2,
				rightFrame, ac_unit_height-gs_fw_upper, 10,
				ac_unit_width/2-gs_fw_side_right-(xprtp-gs_fw_side_right)*(xprtp>gs_fw_side_right), ac_unit_height-gs_fw_upper, 15,
				ac_unit_width/2-gs_fw_side_right-(xprtp-gs_fw_side_right)*(xprtp>gs_fw_side_right), ac_unit_height-topPanelHeight , 10,
				ac_unit_width/2-gs_fw_side_right-(xprtp-gs_fw_side_right)*(xprtp>gs_fw_side_right), ac_unit_height-frameOrTransomHeight,15,
				ac_unit_width/2-gs_fw_side_right-(xprtp-gs_fw_side_right)*(xprtp>gs_fw_side_right), 0, 15
		gosub "textures1"
		body 1

		base
			Prism_ 6, gs_fthk,
				rightFrame, topFrame,mask3,
				leftFrame, topFrame,mask4,
				leftFrame, ac_unit_height-gs_fw_upper, 8+maskLeftButFr,
				-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 15,
				ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 10+maskRightButFr,
				rightFrame, ac_unit_height-gs_fw_upper, mask2
		gosub "textures2"
		body 1
	endif

	!!!Both in Type1 and Type2
	base
		Prism_ 4, gs_fthk,
			ac_unit_width/2-gs_fw_side_right-(xprtp-gs_fw_side_right)*(xprtp>gs_fw_side_right), ac_unit_height-topPanelHeight , 10,
			ac_unit_width/2-gs_fw_side_right-(xprtp-gs_fw_side_right)*(xprtp>gs_fw_side_right), ac_unit_height-frameOrTransomHeight,15,
			-ac_unit_width/2+gs_fw_side_left+(xpltp-gs_fw_side_left)*(xpltp>gs_fw_side_left)*(iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED),ac_unit_height-frameOrTransomHeight,10,
			-ac_unit_width/2+gs_fw_side_left+(xpltp-gs_fw_side_left)*(xpltp>gs_fw_side_left)*(iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED), ac_unit_height-topPanelHeight , 15
	gosub "textures2"
	body 1
endif



!!!Left sidelight and transom
if gs_sidelight_left & not(gs_sidelight_right) & gs_door_transom then
	if gs_SashText_typ_num = 1 then ! Mittered Joint
		base
			Prism_ 6, gs_fthk,
				leftFrame, topFrame,mask4,
				leftFrame, 0, 10,
				-ac_unit_width/2+gs_fw_side_left, gs_fw_lower, 15,
				-ac_unit_width/2+gs_fw_side_left, ac_unit_height-frameOrTransomHeight,10,
				-ac_unit_width/2+gs_fw_side_left, ac_unit_height-topPanelHeight, 15,
				-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 10
		gosub "textures1"
		body 1

		base
			Prism_ 8, gs_fthk,
				-ac_unit_width/2+leftPanelWidth, ac_unit_height-gs_fw_upper, 15,
				-ac_unit_width/2+leftPanelWidth, ac_unit_height-topPanelHeight, 10,
				-ac_unit_width/2+leftPanelWidth,ac_unit_height-frameOrTransomHeight,15,
				-ac_unit_width/2+leftPanelWidth, gs_fw_lower, 10,
				-ac_unit_width/2+frameOrSLightWidthLeft, 0, 15,
				-ac_unit_width/2+frameOrSLightWidthLeft,ac_unit_height-frameOrTransomHeight,10,
				-ac_unit_width/2+frameOrSLightWidthLeft,ac_unit_height-topPanelHeight,15,
				-ac_unit_width/2+frameOrSLightWidthLeft, ac_unit_height-gs_fw_upper, 10
		gosub "textures1"
		body 1

		base
			Prism_ 6, gs_fthk,
				rightFrame, 0, mask2,
				rightFrame, topFrame, 10,
				ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 15,
				ac_unit_width/2-gs_fw_side_right, ac_unit_height-topPanelHeight,10,
				ac_unit_width/2-gs_fw_side_right, ac_unit_height-frameOrTransomHeight,15,
				ac_unit_width/2-gs_fw_side_right, 0, 15
		gosub "textures1"
		body 1

		base
			Prism_ 4, gs_fthk,
				leftFrame, 0, 10,
				-ac_unit_width/2+gs_fw_side_left, gs_fw_lower, 15,
				-ac_unit_width/2+leftPanelWidth, gs_fw_lower, 10,
				-ac_unit_width/2+frameOrSLightWidthLeft, 0, 15
		gosub "textures2"
		body 1

		base
			Prism_ 6, gs_fthk,
				rightFrame, topFrame, mask3,
				leftFrame, topFrame, 10,
				-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 15,
				-ac_unit_width/2+leftPanelWidth, ac_unit_height-gs_fw_upper, 10,
				-ac_unit_width/2+frameOrSLightWidthLeft, ac_unit_height-gs_fw_upper, 15,
				ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 10
		gosub "textures2"
		body 1
	else  ! Butt Joint
		base

			Prism_ 6, gs_fthk,
				leftFrame, ac_unit_height-gs_fw_upper, mask4,
				leftFrame, gs_fw_lower, 8,
				-ac_unit_width/2+gs_fw_side_left, gs_fw_lower, 15,
				-ac_unit_width/2+gs_fw_side_left, ac_unit_height-frameOrTransomHeight,10,
				-ac_unit_width/2+gs_fw_side_left, ac_unit_height-topPanelHeight, 15,
				-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 10
		gosub "textures1"
		body 1

		base
			Prism_ 8, gs_fthk,
				-ac_unit_width/2+leftPanelWidth, ac_unit_height-gs_fw_upper, 15,
				-ac_unit_width/2+leftPanelWidth, ac_unit_height-topPanelHeight, 10,
				-ac_unit_width/2+leftPanelWidth, ac_unit_height-frameOrTransomHeight,15,
				-ac_unit_width/2+leftPanelWidth, gs_fw_lower, 10,
				-ac_unit_width/2+frameOrSLightWidthLeft, gs_fw_lower, 13,
				-ac_unit_width/2+frameOrSLightWidthLeft,ac_unit_height-frameOrTransomHeight,10,
				-ac_unit_width/2+frameOrSLightWidthLeft,ac_unit_height-topPanelHeight,15,
				-ac_unit_width/2+frameOrSLightWidthLeft, ac_unit_height-gs_fw_upper, 10
		gosub "textures1"
		body 1

		base
			Prism_ 6, gs_fthk,
				rightFrame, 0,mask2,
				rightFrame, ac_unit_height-gs_fw_upper, 8,
				ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 15,
				ac_unit_width/2-gs_fw_side_right, ac_unit_height-topPanelHeight, 10,
				ac_unit_width/2-gs_fw_side_right, ac_unit_height-frameOrTransomHeight,15,
				ac_unit_width/2-gs_fw_side_right, 0, 15
		gosub "textures1"
		body 1

		base
		gosub "leftSidelightBottomFrame"

		gosub "textures2"
		body 1

		base
		Prism_ 8, gs_fthk,
				rightFrame, topFrame,mask3,
				leftFrame, topFrame,mask4,
				leftFrame, ac_unit_height-gs_fw_upper, 8+maskLeftButFr,
				-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 15,
				-ac_unit_width/2+leftPanelWidth, ac_unit_height-gs_fw_upper, 10,
				-ac_unit_width/2+frameOrSLightWidthLeft, ac_unit_height-gs_fw_upper, 15,
				ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 10+maskRightButFr,
				rightFrame, ac_unit_height-gs_fw_upper, mask2
		gosub "textures2"
		body 1
	endif

	!!!Both in Type1 and Type2
	base
	if bMiddleRail then
		gosub "leftMidRail"
	endif
	Prism_ 4, gs_fthk,
			ac_unit_width/2-gs_fw_side_right, ac_unit_height-topPanelHeight,10,
			ac_unit_width/2-gs_fw_side_right, ac_unit_height-frameOrTransomHeight,15,
			-ac_unit_width/2+frameOrSLightWidthLeft, ac_unit_height-frameOrTransomHeight, 10,
			-ac_unit_width/2+frameOrSLightWidthLeft, ac_unit_height-topPanelHeight, 15
	Prism_ 4, gs_fthk,
			-ac_unit_width/2+gs_fw_side_left, ac_unit_height-topPanelHeight,10,
			-ac_unit_width/2+gs_fw_side_left, ac_unit_height-frameOrTransomHeight,15,
			-ac_unit_width/2+leftPanelWidth, ac_unit_height-frameOrTransomHeight, 10,
			-ac_unit_width/2+leftPanelWidth, ac_unit_height-topPanelHeight, 15
	gosub "textures2"
	body 1
endif


!!!With Right Sidelight and Transom
if not(gs_sidelight_left) AND gs_sidelight_right AND gs_door_transom then
	if gs_SashText_typ_num = 1 then ! Mittered Joint
		base
			Prism_ 6, gs_fthk,
				rightFrame, topFrame, mask4,
				rightFrame, 0, 10,
				ac_unit_width/2-gs_fw_side_right, gs_fw_lower, 15,
				ac_unit_width/2-gs_fw_side_right, ac_unit_height-frameOrTransomHeight,10,
				ac_unit_width/2-gs_fw_side_right, ac_unit_height-topPanelHeight, 15,
				ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 10
		gosub "textures1"
		body 1

		base
			Prism_ 8, gs_fthk,
				ac_unit_width/2-rightPanelWidth, ac_unit_height-gs_fw_upper, 15,
				ac_unit_width/2-rightPanelWidth, ac_unit_height-topPanelHeight, 10,
				ac_unit_width/2-rightPanelWidth,ac_unit_height-frameOrTransomHeight,15,
				ac_unit_width/2-rightPanelWidth, gs_fw_lower, 10,
				ac_unit_width/2-frameOrSLightWidthRight, 0, 15,
				ac_unit_width/2-frameOrSLightWidthRight,ac_unit_height-frameOrTransomHeight,10,
				ac_unit_width/2-frameOrSLightWidthRight,ac_unit_height-topPanelHeight,15,
				ac_unit_width/2-frameOrSLightWidthRight, ac_unit_height-gs_fw_upper, 10
		gosub "textures1"
		body 1

		base
			Prism_ 6, gs_fthk,
				leftFrame, 0, mask2,
				leftFrame, topFrame, 10,
				-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 15,
				-ac_unit_width/2+gs_fw_side_left, ac_unit_height-topPanelHeight,10,
				-ac_unit_width/2+gs_fw_side_left, ac_unit_height-frameOrTransomHeight,15,
				-ac_unit_width/2+gs_fw_side_left, 0, 15
		gosub "textures1"
		body 1

		base
			Prism_ 4, gs_fthk,
				rightFrame, 0, 10,
				ac_unit_width/2-gs_fw_side_right, gs_fw_lower, 15,
				ac_unit_width/2-rightPanelWidth, gs_fw_lower, 10,
				ac_unit_width/2-frameOrSLightWidthRight, 0, 15
		gosub "textures2"
		body 1

		base
			Prism_ 6, gs_fthk,
				leftFrame, topFrame, mask3,
				rightFrame, topFrame, 10,
				ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 15,
				ac_unit_width/2-rightPanelWidth, ac_unit_height-gs_fw_upper, 10,
				ac_unit_width/2-frameOrSLightWidthRight, ac_unit_height-gs_fw_upper, 15,
				-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 10
		gosub "textures2"
		body 1
	else  ! Butt Joint
		base
			Prism_ 6, gs_fthk,
				rightFrame, ac_unit_height-gs_fw_upper, mask4,
				rightFrame, gs_fw_lower, 8,
				ac_unit_width/2-gs_fw_side_right, gs_fw_lower, 15,
				ac_unit_width/2-gs_fw_side_right, ac_unit_height-frameOrTransomHeight,10,
				ac_unit_width/2-gs_fw_side_right, ac_unit_height-topPanelHeight, 15,
				ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 10
		gosub "textures1"
		body 1

		base
			Prism_ 8, gs_fthk,
				ac_unit_width/2-rightPanelWidth,  ac_unit_height-gs_fw_upper, 15,
				ac_unit_width/2-rightPanelWidth, ac_unit_height-topPanelHeight, 10,
				ac_unit_width/2-rightPanelWidth, ac_unit_height-frameOrTransomHeight,15,
				ac_unit_width/2-rightPanelWidth, gs_fw_lower, 10,
				ac_unit_width/2-frameOrSLightWidthRight, gs_fw_lower, 13,
				ac_unit_width/2-frameOrSLightWidthRight,ac_unit_height-frameOrTransomHeight,10,
				ac_unit_width/2-frameOrSLightWidthRight,ac_unit_height-topPanelHeight,15,
				ac_unit_width/2-frameOrSLightWidthRight, ac_unit_height-gs_fw_upper, 10
		gosub "textures1"
		body 1

		base
			Prism_ 6, gs_fthk,
				leftFrame, 0, mask2,
				leftFrame, ac_unit_height-gs_fw_upper, 8,
				-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 15,
				-ac_unit_width/2+gs_fw_side_left, ac_unit_height-topPanelHeight, 10,
				-ac_unit_width/2+gs_fw_side_left, ac_unit_height-frameOrTransomHeight,15,
				-ac_unit_width/2+gs_fw_side_left, 0, 15
		gosub "textures1"
		body 1

		base
		gosub "rightSidelightBottomFrame"
		gosub "textures2"
		body 1

		base
			Prism_ 8, gs_fthk,
				leftFrame, topFrame, mask3,
				rightFrame, topFrame, mask4,
				rightFrame, ac_unit_height-gs_fw_upper, 8+maskRightButFr,
				ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 15,
				ac_unit_width/2-rightPanelWidth, ac_unit_height-gs_fw_upper, 10,
				ac_unit_width/2-frameOrSLightWidthRight, ac_unit_height-gs_fw_upper, 15,
				-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 10+maskLeftButFr,
				leftFrame, ac_unit_height-gs_fw_upper, mask2
		gosub "textures2"
		body 1
	endif

	!!!Both in Type1 and Type2
	base
	if bMiddleRail then
		gosub "rightMidRail"
	endif
	Prism_ 4, gs_fthk,
		-ac_unit_width/2+gs_fw_side_left, ac_unit_height-topPanelHeight,10,
		-ac_unit_width/2+gs_fw_side_left, ac_unit_height-frameOrTransomHeight,15,
		ac_unit_width/2-frameOrSLightWidthRight, ac_unit_height-frameOrTransomHeight, 10,
		ac_unit_width/2-frameOrSLightWidthRight, ac_unit_height-topPanelHeight, 15
	Prism_ 4, gs_fthk,
		ac_unit_width/2-gs_fw_side_right, ac_unit_height-topPanelHeight,10,
		ac_unit_width/2-gs_fw_side_right, ac_unit_height-frameOrTransomHeight,15,
		ac_unit_width/2-rightPanelWidth, ac_unit_height-frameOrTransomHeight, 10,
		ac_unit_width/2-rightPanelWidth, ac_unit_height-topPanelHeight, 15
	gosub "textures2"
	body 1
endif


!!!With left, right sidelight and transom
if gs_sidelight_left AND gs_sidelight_right AND gs_door_transom then
	if gs_SashText_typ_num = 1 then ! Mittered Joint
		base
			Prism_ 8, gs_fthk,
				-ac_unit_width/2+leftPanelWidth, ac_unit_height-gs_fw_upper, 15,
				-ac_unit_width/2+leftPanelWidth, ac_unit_height-topPanelHeight, 10,
				-ac_unit_width/2+leftPanelWidth, ac_unit_height-frameOrTransomHeight,15,
				-ac_unit_width/2+leftPanelWidth, gs_fw_lower, 10,
				-ac_unit_width/2+frameOrSLightWidthLeft, 0, 15,
				-ac_unit_width/2+frameOrSLightWidthLeft,ac_unit_height-frameOrTransomHeight,10,
				-ac_unit_width/2+frameOrSLightWidthLeft,ac_unit_height-topPanelHeight,15,
				-ac_unit_width/2+frameOrSLightWidthLeft, ac_unit_height-gs_fw_upper, 10
		gosub "textures1"
		body 1


		base
			Prism_ 6, gs_fthk,
				rightFrame, topFrame, mask4,
				rightFrame, 0, 10,
				ac_unit_width/2-gs_fw_side_right, gs_fw_lower, 15,
				ac_unit_width/2-gs_fw_side_right, ac_unit_height-frameOrTransomHeight,10,
				ac_unit_width/2-gs_fw_side_right, ac_unit_height-topPanelHeight, 15,
				ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 10
		gosub "textures1"
		body 1

		base
			Prism_ 8, gs_fthk,
				ac_unit_width/2-rightPanelWidth,  ac_unit_height-gs_fw_upper, 15,
				ac_unit_width/2-rightPanelWidth, ac_unit_height-topPanelHeight, 10,
				ac_unit_width/2-rightPanelWidth, ac_unit_height-frameOrTransomHeight,15,
				ac_unit_width/2-rightPanelWidth, gs_fw_lower, 10,
				ac_unit_width/2-frameOrSLightWidthRight, 0, 15,
				ac_unit_width/2-frameOrSLightWidthRight,ac_unit_height-frameOrTransomHeight,10,
				ac_unit_width/2-frameOrSLightWidthRight,ac_unit_height-topPanelHeight,15,
				ac_unit_width/2-frameOrSLightWidthRight, ac_unit_height-gs_fw_upper, 10
		gosub "textures1"
		body 1

		base
			Prism_ 6, gs_fthk,
				leftFrame, 0, mask2,
				leftFrame, topFrame, 10,
				-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 15,
				-ac_unit_width/2+gs_fw_side_left, ac_unit_height-topPanelHeight,10,
				-ac_unit_width/2+gs_fw_side_left, ac_unit_height-frameOrTransomHeight,15,
				-ac_unit_width/2+gs_fw_side_left, gs_fw_lower, 10
		gosub "textures1"
		body 1

		base
			Prism_ 4, gs_fthk,
				rightFrame, 0, 10,
				ac_unit_width/2-gs_fw_side_right, gs_fw_lower, 15,
				ac_unit_width/2-rightPanelWidth, gs_fw_lower, 10,
				ac_unit_width/2-frameOrSLightWidthRight, 0, 15
			Prism_ 4, gs_fthk,
				leftFrame, 0, 10,
				-ac_unit_width/2+gs_fw_side_left, gs_fw_lower, 15,
				-ac_unit_width/2+leftPanelWidth, gs_fw_lower, 10,
				-ac_unit_width/2+frameOrSLightWidthLeft, 0, 15
		gosub "textures2"
		body 1
		base
			Prism_ 8, gs_fthk,
				leftFrame, topFrame, mask3,
				rightFrame, topFrame, 10,
				ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 15,
				ac_unit_width/2-rightPanelWidth, ac_unit_height-gs_fw_upper, 10,
				ac_unit_width/2-frameOrSLightWidthRight, ac_unit_height-gs_fw_upper, 15,
				-ac_unit_width/2+frameOrSLightWidthLeft, ac_unit_height-gs_fw_upper,10,
				-ac_unit_width/2+leftPanelWidth, ac_unit_height-gs_fw_upper,15,
				-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 10
		gosub "textures2"
		body 1
	else  ! Butt joint
		base
			Prism_ 8, gs_fthk,
				-ac_unit_width/2+leftPanelWidth, ac_unit_height-gs_fw_upper, 15,
				-ac_unit_width/2+leftPanelWidth, ac_unit_height-topPanelHeight, 10,
				-ac_unit_width/2+leftPanelWidth, ac_unit_height-frameOrTransomHeight,15,
				-ac_unit_width/2+leftPanelWidth, gs_fw_lower, 10,
				-ac_unit_width/2+frameOrSLightWidthLeft, gs_fw_lower, 13,
				-ac_unit_width/2+frameOrSLightWidthLeft,ac_unit_height-frameOrTransomHeight,10,
				-ac_unit_width/2+frameOrSLightWidthLeft,ac_unit_height-topPanelHeight,15,
				-ac_unit_width/2+frameOrSLightWidthLeft, ac_unit_height-gs_fw_upper, 10
		gosub "textures1"
		body 1


		base
			Prism_ 6, gs_fthk,
				rightFrame, ac_unit_height-gs_fw_upper, mask4,
				rightFrame, gs_fw_lower, 8,
				ac_unit_width/2-gs_fw_side_right, gs_fw_lower, 15,
				ac_unit_width/2-gs_fw_side_right, ac_unit_height-frameOrTransomHeight,10,
				ac_unit_width/2-gs_fw_side_right, ac_unit_height-topPanelHeight, 15,
				ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 10
		gosub "textures1"
		body 1

		base
			Prism_ 8, gs_fthk,
				ac_unit_width/2-rightPanelWidth, ac_unit_height-gs_fw_upper, 15,
				ac_unit_width/2-rightPanelWidth, ac_unit_height-topPanelHeight, 10,
				ac_unit_width/2-rightPanelWidth, ac_unit_height-frameOrTransomHeight,15,
				ac_unit_width/2-rightPanelWidth, gs_fw_lower, 10,
				ac_unit_width/2-frameOrSLightWidthRight, gs_fw_lower, 13,
				ac_unit_width/2-frameOrSLightWidthRight,ac_unit_height-frameOrTransomHeight,10,
				ac_unit_width/2-frameOrSLightWidthRight,ac_unit_height-topPanelHeight,15,
				ac_unit_width/2-frameOrSLightWidthRight, ac_unit_height-gs_fw_upper, 10
		gosub "textures1"
		body 1

		base
			Prism_ 6, gs_fthk,
				leftFrame, gs_fw_lower, mask2,
				leftFrame, ac_unit_height-gs_fw_upper, 8,
				-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 15,
				-ac_unit_width/2+gs_fw_side_left, ac_unit_height-topPanelHeight, 10,
				-ac_unit_width/2+gs_fw_side_left, ac_unit_height-frameOrTransomHeight,15,
				-ac_unit_width/2+gs_fw_side_left, gs_fw_lower, 10
		gosub "textures1"
		body 1

		base
		gosub "rightSidelightBottomFrame"
		gosub "leftSidelightBottomFrame"
		gosub "textures2"
		body 1

		base
			Prism_ 10, gs_fthk,
				leftFrame, topFrame, mask3,
				rightFrame, topFrame, mask4,
				rightFrame, ac_unit_height-gs_fw_upper, 8+maskRightButFr,
				ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 15,
				ac_unit_width/2-rightPanelWidth, ac_unit_height-gs_fw_upper, 10,
				ac_unit_width/2-frameOrSLightWidthRight, ac_unit_height-gs_fw_upper, 15,
				-ac_unit_width/2+frameOrSLightWidthLeft, ac_unit_height-gs_fw_upper,10,
				-ac_unit_width/2+leftPanelWidth, ac_unit_height-gs_fw_upper,15,
				-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 10+maskLeftButFr,
				leftFrame, ac_unit_height-gs_fw_upper, mask2
		gosub "textures2"
		body 1
	endif

	!!!Both in Type1 and Type2
	if bMiddleRail then
		material gs_midrail_mat
		gosub "rightMidRail"
		gosub "leftMidRail"
	endif

	material gs_frame_mat
	Prism_ 4, gs_fthk,
		ac_unit_width/2-gs_fw_side_right, ac_unit_height-topPanelHeight,10,
		ac_unit_width/2-gs_fw_side_right, ac_unit_height-frameOrTransomHeight,15,
		ac_unit_width/2-rightPanelWidth, ac_unit_height-frameOrTransomHeight, 10,
		ac_unit_width/2-rightPanelWidth, ac_unit_height-topPanelHeight, 15
	Prism_ 4, gs_fthk,
		-ac_unit_width/2+gs_fw_side_left, ac_unit_height-topPanelHeight,10,
		-ac_unit_width/2+gs_fw_side_left, ac_unit_height-frameOrTransomHeight,15,
		-ac_unit_width/2+leftPanelWidth, ac_unit_height-frameOrTransomHeight, 10,
		-ac_unit_width/2+leftPanelWidth, ac_unit_height-topPanelHeight, 15
	Prism_ 4, gs_fthk,
		ac_unit_width/2-frameOrSLightWidthRight, ac_unit_height-frameOrTransomHeight, 10,
		ac_unit_width/2-frameOrSLightWidthRight, ac_unit_height-topPanelHeight, 15,
		-ac_unit_width/2+frameOrSLightWidthLeft, ac_unit_height-topPanelHeight, 10,
		-ac_unit_width/2+frameOrSLightWidthLeft, ac_unit_height-frameOrTransomHeight, 15
endif

if iFrameStyleLeft <> FRAME_STYLE_VISIBLE_MULLIONS AND gs_door_transom AND gs_cl then CUTEND

if iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED AND gs_door_transom then CUTEND

if iFrameStyleRight <> FRAME_STYLE_VISIBLE_MULLIONS AND gs_door_transom AND gs_cr then CUTEND

if iFrameStyleRight = FRAME_STYLE_BUTT_GLAZED AND gs_door_transom then CUTEND

if iFrameStyleLeft <> FRAME_STYLE_VISIBLE_MULLIONS AND gs_cl AND gs_sidelight_left then CUTEND

if iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED AND gs_sidelight_left then CUTEND

if iFrameStyleRight <> FRAME_STYLE_VISIBLE_MULLIONS AND gs_cr AND gs_sidelight_right then CUTEND

if iFrameStyleRight = FRAME_STYLE_BUTT_GLAZED AND gs_sidelight_right then CUTEND

if iFrameStyleLeft <> FRAME_STYLE_VISIBLE_MULLIONS AND gs_cl AND gs_sidelight_left AND bMiddleRail then CUTEND

if iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED AND gs_sidelight_left AND bMiddleRail then CUTEND

if iFrameStyleRight <> FRAME_STYLE_VISIBLE_MULLIONS AND gs_cr AND gs_sidelight_right AND bMiddleRail then CUTEND

if iFrameStyleRight = FRAME_STYLE_BUTT_GLAZED AND gs_sidelight_right AND bMiddleRail then CUTEND

if gs_cl then CUTEND
if gs_cr then CUTEND

if isVentilationOverFrame then
	cutend
endif

!! END OF FRAME !!

ENDGROUP

GROUP "middle rail"
sect_fill fr_sect_fill_type, fr_sect_fill_bg, fr_sect_fill_fg, gs_pen_2D

if bMiddleRail then
	MATERIAL gs_midrail_mat

	if gs_cl AND leftCornerAngle<180 then
		ADDX -ac_unit_width/2
		ROTY -leftCornerAngle/2
			CUTPLANE
		DEL 2
	endif

	if gs_cl AND leftCornerAngle>180 then
		ADD -ac_unit_width/2-WIDO_REVEAL_SIDE*gs_fthk*TAN(90-leftCornerAngle/2), 0, (1-WIDO_REVEAL_SIDE)*gs_fthk
		ROTY -leftCornerAngle/2
		CUTPLANE
		DEL 2
	endif

	if gs_cr AND rightCornerAngle<180 then
		ADDX ac_unit_width/2
		ROTY rightCornerAngle/2
			CUTPLANE
		DEL 2
	endif

	if gs_cr AND rightCornerAngle>180 then
		ADD ac_unit_width/2+WIDO_REVEAL_SIDE*gs_fthk*TAN(90-rightCornerAngle/2), 0, (1-WIDO_REVEAL_SIDE)*gs_fthk
		ROTY rightCornerAngle/2
			CUTPLANE
		DEL 2
	endif

	if gs_cl=1 then CUTEND
	if gs_cr=1 then CUTEND
endif
ENDGROUP

sect_fill fr_sect_fill_type, fr_sect_fill_bg, fr_sect_fill_fg, gs_pen_2D
PLACEGROUP SUBGROUP ("middle rail", "frame")

if not(gs_mf) | iDoorType = 1 then
	CUTPOLYA 5, 1, 0,	!gs_fthk+gs_grid_thk,
		-ac_unit_width/2+frameOrSLightWidthLeft,	0,	15,
		-ac_unit_width/2+frameOrSLightWidthLeft,	ac_unit_height-frameOrTransomHeight,	15,
		ac_unit_width/2-frameOrSLightWidthRight,	ac_unit_height-frameOrTransomHeight,	15,
		ac_unit_width/2-frameOrSLightWidthRight,	0,	15,
		-ac_unit_width/2+frameOrSLightWidthLeft,	0,	-1
endif

PLACEGROUP "frame"

if not(gs_mf) | iDoorType = 1 then CUTEND


! =============================================================================
! Horizontal Grids
! =============================================================================

GROUP "gridsh"
	sect_fill fr_sect_fill_type, fr_sect_fill_bg, fr_sect_fill_fg, gs_pen_2D

	MATERIAL gs_sash_mat

! =============================================================================
! Corner
! =============================================================================

	if gs_cl AND leftCornerAngle<180 then
		ADDX -ac_unit_width/2
		ROTY -leftCornerAngle/2
			CUTPLANE
		DEL 2
	endif

	if gs_cl AND leftCornerAngle>180 then
		ADD -ac_unit_width/2-WIDO_REVEAL_SIDE*gs_fthk*TAN(90-leftCornerAngle/2), 0, (1-WIDO_REVEAL_SIDE)*gs_fthk
		ROTY -leftCornerAngle/2
		CUTPLANE
		DEL 2
	endif

	if gs_cr AND rightCornerAngle<180 then
		ADDX ac_unit_width/2
		ROTY rightCornerAngle/2
			CUTPLANE
		DEL 2
	endif

	if gs_cr AND rightCornerAngle>180 then
		ADD ac_unit_width/2+WIDO_REVEAL_SIDE*gs_fthk*TAN(90-rightCornerAngle/2), 0, (1-WIDO_REVEAL_SIDE)*gs_fthk
		ROTY rightCornerAngle/2
			CUTPLANE
		DEL 2
	endif


! =============================================================================
! Butt Glazed
! =============================================================================

	if iFrameStyleRight = FRAME_STYLE_ANGLE_FRAME AND gs_cr=1 AND rightCornerAngle<180 then
		ROTX 90
		CUTPOLYA 6, 1, 0,
			ac_unit_width/2, 0, 15,
			ac_unit_width/2-(gs_gsb+gs_glass_thk)*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(rightCornerAngle/2), 0,     15,
			ac_unit_width/2-(gs_gsb+gs_glass_thk)*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(rightCornerAngle/2), (gs_gsb+gs_glass_thk),     15,
			ac_unit_width/2-gs_fthk*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(rightCornerAngle/2), gs_fthk,      15,
			ac_unit_width/2, gs_fthk, 15,
			ac_unit_width/2, 0,      -1
		DEL 1
	endif

	if iFrameStyleRight = FRAME_STYLE_ANGLE_FRAME AND gs_cr=1 AND rightCornerAngle>180 then
		ROTX 90
		CUTPOLYA 6, 1, 0,
			ac_unit_width/2, 0,      15,
			ac_unit_width/2+(gs_fthk-gs_gsb-gs_glass_thk)*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(180-rightCornerAngle/2), 0,    15,
			ac_unit_width/2+(gs_fthk-gs_gsb-gs_glass_thk)*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(180-rightCornerAngle/2), (gs_gsb+gs_glass_thk),    15,
			ac_unit_width/2-(gs_frame_width/2)/SIN(180-rightCornerAngle/2), gs_fthk,      15,
			ac_unit_width/2, gs_fthk,     15,
			ac_unit_width/2, 0,      -1
		DEL 1
	endif

	if iFrameStyleLeft = FRAME_STYLE_ANGLE_FRAME AND gs_cl=1 AND leftCornerAngle<180 then
		ROTX 90
		CUTPOLYA 6, 1, 0,
			-ac_unit_width/2+(gs_gsb+gs_glass_thk)*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), gs_gsb+gs_glass_thk,15,
			-ac_unit_width/2+(gs_gsb+gs_glass_thk)*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), 0,15,
			-ac_unit_width/2,0,15,
			-ac_unit_width/2, gs_fthk,15,
			-ac_unit_width/2+gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2),gs_fthk, 15,
			-ac_unit_width/2+(gs_gsb+gs_glass_thk)*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), gs_gsb+gs_glass_thk,-1
		DEL 1
	endif

	if iFrameStyleLeft = FRAME_STYLE_ANGLE_FRAME AND gs_cl=1 AND leftCornerAngle>180 then
		ROTX 90
		CUTPOLYA 6, 1, 0,
			-ac_unit_width/2+(gs_fthk-gs_gsb-gs_glass_thk)*TAN(90+leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), 0, 15,
			-ac_unit_width/2, 0, 15,
			-ac_unit_width/2, gs_fthk, 15,
			-ac_unit_width/2+(gs_frame_width/2)/SIN(leftCornerAngle/2), gs_fthk, 15,
			-ac_unit_width/2+(gs_fthk-gs_gsb-gs_glass_thk)*TAN(90+leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), gs_gsb+gs_glass_thk, 15,
			-ac_unit_width/2+(gs_fthk-gs_gsb-gs_glass_thk)*TAN(90+leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), 0, -1
		DEL 1
	endif

	if iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED AND gs_cl=1 AND leftCornerAngle<180 then
		ROTX 90
		CUTPOLYA 5, 1, 0,
			-ac_unit_width/2+(gs_frame_width/2)/SIN(leftCornerAngle/2)+(gs_gsb+gs_glass_thk)/TAN(leftCornerAngle/2), (gs_gsb+gs_glass_thk),15,
			-ac_unit_width/2, (gs_gsb+gs_glass_thk),15,
			-ac_unit_width/2, gs_fthk,15,
			-ac_unit_width/2+(gs_fthk)*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2),gs_fthk,15,
			-ac_unit_width/2+(gs_frame_width/2)/SIN(leftCornerAngle/2)+(gs_gsb+gs_glass_thk)/TAN(leftCornerAngle/2), (gs_gsb+gs_glass_thk),-1
		DEL 1
	endif

	if iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED AND gs_cl=1 AND leftCornerAngle>180 then
		ROTX 90
		CUTPOLYA 5, 1, 0,
			-ac_unit_width/2+(gs_fthk-(gs_gsb+gs_glass_thk))*TAN(90+leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), (gs_gsb+gs_glass_thk), 95,
			-ac_unit_width/2, (gs_gsb+gs_glass_thk), 95,
			-ac_unit_width/2, gs_fthk, 95,
			-ac_unit_width/2+(gs_frame_width/2)/SIN(leftCornerAngle/2), gs_fthk, 95,
			-ac_unit_width/2+(gs_fthk-(gs_gsb+gs_glass_thk))*TAN(90+leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), (gs_gsb+gs_glass_thk), -1
		DEL 1
	endif

	if iFrameStyleRight = FRAME_STYLE_BUTT_GLAZED AND gs_cr=1 AND rightCornerAngle<180 then
		ROTX 90
		CUTPOLYA 5, 1, 0,
			ac_unit_width/2, (gs_gsb+gs_glass_thk),     95,
			ac_unit_width/2-(gs_frame_width/2)/SIN(rightCornerAngle/2)-(gs_gsb+gs_glass_thk)/TAN(rightCornerAngle/2), (gs_gsb+gs_glass_thk),     95,
			ac_unit_width/2-gs_fthk*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(rightCornerAngle/2), gs_fthk,      95,
			ac_unit_width/2,gs_fthk,      95,
			ac_unit_width/2, (gs_gsb+gs_glass_thk),      -1
		DEL 1
	endif

	if iFrameStyleRight = FRAME_STYLE_BUTT_GLAZED AND gs_cr=1 AND rightCornerAngle>180 then
		ROTX 90
		CUTPOLYA 5, 1, 0,
			ac_unit_width/2, (gs_gsb+gs_glass_thk),      95,
			ac_unit_width/2+(gs_fthk-(gs_gsb+gs_glass_thk))*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(180-rightCornerAngle/2), (gs_gsb+gs_glass_thk),    95,
			ac_unit_width/2-(gs_frame_width/2)/SIN(180-rightCornerAngle/2), gs_fthk,      95,
			ac_unit_width/2,gs_fthk,     95,
			ac_unit_width/2, (gs_gsb+gs_glass_thk),      -1
		DEL 1
	endif

	if iFrameStyleRight = FRAME_STYLE_BUTT_GLAZED AND gs_cr=0 then
		ROTX 90
		CUTPOLYA 5, 1, 0,
			ac_unit_width/2,         gs_gsb+gs_glass_thk, 15,
			ac_unit_width/2-gs_fw_side_right,  gs_gsb+gs_glass_thk,  15,
			ac_unit_width/2-gs_fw_side_right, gs_fthk, 15,
			ac_unit_width/2, gs_fthk,  15,
			ac_unit_width/2,         gs_gsb+gs_glass_thk,  -1
		DEL 1
	endif

	if iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED AND gs_cl=0 then
		ROTX 90
		CUTPOLYA 5, 1, 0,
			-ac_unit_width/2,         gs_gsb+gs_glass_thk, 15,
			-ac_unit_width/2+gs_fw_side_left,  gs_gsb+gs_glass_thk,  15,
			-ac_unit_width/2+gs_fw_side_left, gs_fthk, 15,
			-ac_unit_width/2, gs_fthk,  15,
			-ac_unit_width/2,         gs_gsb+gs_glass_thk,  -1
		DEL 1
	endif


! =============================================================================
! Horizontal Grids
! =============================================================================

	MATERIAL gs_sash_mat

	if gs_hor_gnum >0 AND bMiddleRail then
		for i=1 to gs_hor_gnum
			ADDY gs_hor_d[i]

			for HI=1 to gs_ver_gnum+1

				if HI=1 AND gs_ver_gnum=0 then hgnn=ac_unit_width-gs_fw_side_right-gs_fw_side_left
				if HI=1 AND gs_ver_gnum>0 then hgnn=gs_ver_d[1]-gs_grid_w+leftPanelWidth-(gs_fw_side_left-gs_frame_width)*gs_sidelight_left
				if HI>1 AND HI<gs_ver_gnum+1 then hgnn=gs_ver_d[HI]-gs_ver_d[HI-1]-gs_grid_w
				if HI>1 AND HI=gs_ver_gnum+1 then hgnn=ac_unit_width-gs_fw_side_left-gs_fw_side_right-gs_ver_d[HI-1]-leftPanelWidth+(gs_fw_side_left-gs_frame_width)*gs_sidelight_left

				ADD -ac_unit_width/2+gs_fw_side_left, gs_fw_lower-gs_grid_w/2, (gs_gsb+gs_glass_thk)*(iFrameStyleMullion = FRAME_STYLE_BUTT_GLAZED)
				if HI=1 AND gs_sidelight_left then
					PRISM_ 5, gs_grid_thk,
						-gs_fw_side_left*(iFrameStyleLeft <> FRAME_STYLE_VISIBLE_MULLIONS), -gs_grid_w/2, 15,
						 leftPanelWidth-gs_fw_side_left, -gs_grid_w/2, 15,
						 leftPanelWidth-gs_fw_side_left,  gs_grid_w/2, 15,
						-gs_fw_side_left*(iFrameStyleLeft <> FRAME_STYLE_VISIBLE_MULLIONS),  gs_grid_w/2, 15,
						-gs_fw_side_left*(iFrameStyleLeft <> FRAME_STYLE_VISIBLE_MULLIONS), -gs_grid_w/2, -1
				endif
				if HI=gs_ver_gnum+1 AND gs_sidelight_right then
					PRISM_ 5, gs_grid_thk,
						hgnn-rightPanelWidth+gs_fw_side_right, -gs_grid_w/2, 15,
						hgnn+gs_fw_side_right*(iFrameStyleRight <> FRAME_STYLE_VISIBLE_MULLIONS), -gs_grid_w/2, 15,
						hgnn+gs_fw_side_right*(iFrameStyleRight <> FRAME_STYLE_VISIBLE_MULLIONS),  gs_grid_w/2, 15,
						hgnn-rightPanelWidth+gs_fw_side_right,  gs_grid_w/2, 15,
						hgnn-rightPanelWidth+gs_fw_side_right, -gs_grid_w/2, -1
				endif
				DEL 1

			ADDX hgnn+gs_grid_w
			next HI

			DEL gs_ver_gnum + 2
		next i
	endif


! =============================================================================
! Horizontal Grids Middle
! =============================================================================

	if gs_hor_gnumtr >0 then
		for i=1 to gs_hor_gnumtr
			ADDY gs_hor_dtr[i]
			for HI=1 to gs_ver_gnum+1

				if HI=1 AND gs_ver_gnum=0 then hgnn=ac_unit_width-gs_fw_side_right-gs_fw_side_left
				if HI=1 AND gs_ver_gnum>0 then hgnn=gs_ver_d[1]-gs_grid_w+leftPanelWidth-(gs_fw_side_left-gs_frame_width)*gs_sidelight_left
				if HI>1 AND HI<gs_ver_gnum+1 then hgnn=gs_ver_d[HI]-gs_ver_d[HI-1]-gs_grid_w
				if HI>1 AND HI=gs_ver_gnum+1 then hgnn=ac_unit_width-gs_fw_side_left-gs_fw_side_right-gs_ver_d[HI-1]-leftPanelWidth+(gs_fw_side_left-gs_frame_width)*gs_sidelight_left

				ADD -ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper*not(gs_door_transom)-gs_frame_width*gs_door_transom-middlePanelHeight-gs_grid_w/2, (gs_gsb+gs_glass_thk)*(iFrameStyleMullion = FRAME_STYLE_BUTT_GLAZED)
				if HI=1 AND gs_sidelight_left then
					PRISM_ 5, gs_grid_thk,
						-gs_fw_side_left*(iFrameStyleLeft <> FRAME_STYLE_VISIBLE_MULLIONS), -gs_grid_w/2, 15,
						 leftPanelWidth-gs_fw_side_left, -gs_grid_w/2, 15,
						 leftPanelWidth-gs_fw_side_left,  gs_grid_w/2, 15,
						-gs_fw_side_left*(iFrameStyleLeft <> FRAME_STYLE_VISIBLE_MULLIONS),  gs_grid_w/2, 15,
						-gs_fw_side_left*(iFrameStyleLeft <> FRAME_STYLE_VISIBLE_MULLIONS), -gs_grid_w/2, -1
				endif
				if HI=gs_ver_gnum+1 AND gs_sidelight_right then
					PRISM_ 5, gs_grid_thk,
						hgnn-rightPanelWidth+gs_fw_side_right, -gs_grid_w/2, 15,
						 hgnn+gs_fw_side_right*(iFrameStyleRight <> FRAME_STYLE_VISIBLE_MULLIONS), -gs_grid_w/2, 15,
						 hgnn+gs_fw_side_right*(iFrameStyleRight <> FRAME_STYLE_VISIBLE_MULLIONS),  gs_grid_w/2, 15,
						hgnn-rightPanelWidth+gs_fw_side_right,  gs_grid_w/2, 15,
						hgnn-rightPanelWidth+gs_fw_side_right, -gs_grid_w/2, -1
				endif
				DEL 1
				ADDX hgnn+gs_grid_w
			next HI
			DEL gs_ver_gnum + 2
		next i
	endif


! =============================================================================
! Horizontal Grids Top Panel
! =============================================================================

	if gs_hor_gtp >0 AND gs_door_transom then
		base
		for i=1 to gs_hor_gtp
			ADDY gs_hor_dtp[i]
			hgnn=ac_unit_width-gs_fw_side_right-gs_fw_side_left
			ADD -ac_unit_width/2+gs_fw_side_left, ac_unit_height-topPanelHeight-gs_grid_w/2, (gs_gsb+gs_glass_thk)*(iFrameStyleMullion = FRAME_STYLE_BUTT_GLAZED)
				PRISM_ 5, gs_grid_thk,
					-gs_fw_side_left*(iFrameStyleLeft <> FRAME_STYLE_VISIBLE_MULLIONS), -gs_grid_w/2, 15,
					 hgnn+gs_fw_side_right*(iFrameStyleRight <> FRAME_STYLE_VISIBLE_MULLIONS), -gs_grid_w/2, 15,
					 hgnn+gs_fw_side_right*(iFrameStyleRight <> FRAME_STYLE_VISIBLE_MULLIONS),  gs_grid_w/2, 15,
					-gs_fw_side_left*(iFrameStyleLeft <> FRAME_STYLE_VISIBLE_MULLIONS),  gs_grid_w/2, 15,
					-gs_fw_side_left*(iFrameStyleLeft <> FRAME_STYLE_VISIBLE_MULLIONS), -gs_grid_w/2, -1
			DEL 2
		next i

		vert 0, 0, 0
		vert 1, 0, 0
		vert 0, 1, 0
		vert 0, 0, 1
		coor 2, -1, -2, -3, -4
		body 1
	endif

	if iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED AND gs_cl=0 then CUTEND
	if iFrameStyleRight = FRAME_STYLE_BUTT_GLAZED AND gs_cr=0 then CUTEND

	if iFrameStyleRight = FRAME_STYLE_BUTT_GLAZED AND gs_cr=1 then CUTEND
	if iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED AND gs_cl=1 then CUTEND
	if iFrameStyleLeft = FRAME_STYLE_ANGLE_FRAME AND gs_cl=1 then CUTEND
	if iFrameStyleRight = FRAME_STYLE_ANGLE_FRAME AND gs_cr=1 then CUTEND

	if gs_cl=1 then CUTEND
	if gs_cr=1 then CUTEND

ENDGROUP


! =============================================================================
! Vertical Grids
! =============================================================================

GROUP "gridsv"

	sect_fill fr_sect_fill_type, fr_sect_fill_bg, fr_sect_fill_fg, gs_pen_2D
	!material "!-06"
	material gs_vertMull_mat
if iDivisionMethod = DIVISION_WIDTH then
	if gs_sidelight_left and divWidthHor>0 then
		n_left_vert = int(abs(gs_sidelight_width_left/divWidthHor))
		if n_left_vert>0 then
			shag_vert_left = gs_sidelight_width_left/n_left_vert
			addx -ac_unit_width/2
			for i = 1 to n_left_vert-1
					addx i*shag_vert_left

					hotspot 0,  0, 0
					hotspot 0,  ac_unit_height, 0

					PRISM_ 5,gridThkVert,
						-gridWidthVert/2,   gs_fw_lower, 15,
						 gridWidthVert/2,   gs_fw_lower, 15,
						 gridWidthVert/2, ac_unit_height-gs_fw_upper, 15,
						-gridWidthVert/2, ac_unit_height-gs_fw_upper, 15,
						-gridWidthVert/2,   gs_fw_lower, -1
					DEL 1
			next i
			del 1
		endif
	endif

	if gs_sidelight_right and divWidthHor>0 then
		n_right_vert = int(abs(gs_sidelight_width_right/divWidthHor))
		if n_right_vert>0 then
			shag_vert_right = gs_sidelight_width_right/n_right_vert
			addx ac_unit_width/2
			for i = 1 to n_right_vert-1
					addx -i*shag_vert_left
					hotspot 0,  0, 0
					hotspot 0,  ac_unit_height, 0
					PRISM_ 5,gridThkVert,
						-gridWidthVert/2,   gs_fw_lower, 15,
						 gridWidthVert/2,   gs_fw_lower, 15,
						 gridWidthVert/2, ac_unit_height-gs_fw_upper, 15,
						-gridWidthVert/2, ac_unit_height-gs_fw_upper, 15,
						-gridWidthVert/2,   gs_fw_lower, -1
					DEL 1
			next i
			del 1
		endif
	endif
endif
	if gs_ver_gnum > 0 AND gs_door_transom then
		base
		for HK=1 to gs_ver_gnum
			ADDX gs_ver_d[HK]
				ADD  -ac_unit_width/2+frameOrSLightWidthLeft-gridWidthVert/2, 0, (gs_gsb+gs_glass_thk)*(iFrameStyleMullion = FRAME_STYLE_BUTT_GLAZED)

				PRISM_ 5,gridThkVert,
					-gridWidthVert/2,   ac_unit_height-topPanelHeight, 15,
					 gridWidthVert/2,   ac_unit_height-topPanelHeight, 15,
					 gridWidthVert/2, ac_unit_height-gs_fw_upper, 15,
					-gridWidthVert/2, ac_unit_height-gs_fw_upper, 15,
					-gridWidthVert/2,   ac_unit_height-topPanelHeight, -1
				DEL 1
			DEL 1
		next HK

		vert 0, 0, 0
		vert 0, 1, 0
		vert 1, 0, 0
		vert 0, 0, 1
		coor 2, -1, -2, -3, -4
		body 1
	endif
ENDGROUP

! =============================================================================


sect_fill fr_sect_fill_type, fr_sect_fill_bg, fr_sect_fill_fg, gs_pen_2D

PLACEGROUP SUBGROUP (SUBGROUP("gridsh","gridsv"), "frame")
PLACEGROUP "gridsv"

! =============================================================================
! Glass
! =============================================================================

SECT_FILL gl_sect_fill_type, gl_sect_fill_bg, gl_sect_fill_fg, gs_pen_glass

MATERIAL gs_glass_mat
PEN gs_glass_pen

! CORNER !

if gs_cl=1 AND leftCornerAngle<180 then
	ADDX -ac_unit_width/2
	ROTY -leftCornerAngle/2
		CUTPLANE
	DEL 2
endif

if gs_cl=1 AND leftCornerAngle>180 then
	ADD -ac_unit_width/2-WIDO_REVEAL_SIDE*gs_fthk*TAN(90-leftCornerAngle/2), 0, (1-WIDO_REVEAL_SIDE)*gs_fthk
	ROTY -leftCornerAngle/2
	CUTPLANE
	DEL 2
endif

if gs_cr=1 AND rightCornerAngle<180 then
	ADDX ac_unit_width/2
	ROTY rightCornerAngle/2
		CUTPLANE
	DEL 2
endif

if gs_cr=1 AND rightCornerAngle>180 then
	ADD ac_unit_width/2+WIDO_REVEAL_SIDE*gs_fthk*TAN(90-rightCornerAngle/2), 0, (1-WIDO_REVEAL_SIDE)*gs_fthk
	ROTY rightCornerAngle/2
		CUTPLANE
	DEL 2
endif

! END OF CORNER !

if bMiddleRail then
	ADDZ gs_gsb
	for HJ=1 to gs_hor_gnum+1
		if HJ=1 AND gs_hor_gnum=0 then vgnn=ac_unit_height-gs_fw_upper*not(gs_door_transom)-gs_frame_width*gs_door_transom-middlePanelHeight-gs_fw_lower-midRailWidth
		if HJ=1 AND gs_hor_gnum>0 then vgnn=gs_hor_d[1]-gs_grid_w
		if HJ>1 AND HJ<gs_hor_gnum+1 then vgnn=gs_hor_d[HJ]-gs_hor_d[HJ-1]-gs_grid_w
		if HJ>1 AND HJ=gs_hor_gnum+1 then vgnn=ac_unit_height-gs_fw_upper*not(gs_door_transom)-gs_frame_width*gs_door_transom-middlePanelHeight-gs_hor_d[HJ-1]-gs_fw_lower-midRailWidth

		for HI=1 to gs_ver_gnum+1
			if HI=1 AND gs_ver_gnum=0 then hgnn=ac_unit_width-frameOrSLightWidthLeft-frameOrSLightWidthRight
			if HI=1 AND gs_ver_gnum>0 then hgnn=gs_ver_d[1]-gs_grid_w
			if HI>1 AND HI<gs_ver_gnum+1 then hgnn=gs_ver_d[HI]-gs_ver_d[HI-1]-gs_grid_w
			if HI>1 AND HI=gs_ver_gnum+1 then hgnn=ac_unit_width-gs_ver_d[HI-1]-frameOrSLightWidthLeft-frameOrSLightWidthRight

			ADDX hgnn+gs_grid_w
		next HI
		DEL gs_ver_gnum+1

		if gs_sidelight_left then
			ADD -ac_unit_width/2+gs_fw_side_left, gs_fw_lower,0
			if iFrameStyleMullion = FRAME_STYLE_BUTT_GLAZED then
				PRISM_ 5, gs_glass_thk,
					-gs_left_g,-(gs_grid_w-buttGalzedJoint)/2*(HJ<>1),15,
					leftPanelWidth-gs_fw_side_left,-(gs_grid_w-buttGalzedJoint)/2*(HJ<>1),15,
					leftPanelWidth-gs_fw_side_left,vgnn+(gs_grid_w-buttGalzedJoint)/2*(HJ<>gs_hor_gnum+1),15,
					-gs_left_g,vgnn+(gs_grid_w-buttGalzedJoint)/2*(HJ<>gs_hor_gnum+1),15,
					-gs_left_g,-(gs_grid_w-buttGalzedJoint)/2*(HJ<>1),-1
			else
				PRISM_ 5, gs_glass_thk,
					-gs_left_g, 0, 15,
					leftPanelWidth-gs_fw_side_left, 0, 15,
					leftPanelWidth-gs_fw_side_left, vgnn, 15,
					-gs_left_g, vgnn, 15,
					-gs_left_g, 0, -1
			endif
			DEL 1
		endif

		if gs_sidelight_right then
			ADD +ac_unit_width/2-rightPanelWidth, gs_fw_lower,0
			if iFrameStyleMullion = FRAME_STYLE_BUTT_GLAZED then
				PRISM_ 5, gs_glass_thk,
					0,-(gs_grid_w-buttGalzedJoint)/2*(HJ<>1),15,
					rightPanelWidth-gs_fw_side_right+gs_right_g,-(gs_grid_w-buttGalzedJoint)/2*(HJ<>1),15,
					rightPanelWidth-gs_fw_side_right+gs_right_g,vgnn+(gs_grid_w-buttGalzedJoint)/2*(HJ<>gs_hor_gnum+1),15,
					0,vgnn+(gs_grid_w-buttGalzedJoint)/2*(HJ<>gs_hor_gnum+1),15,
					0,-(gs_grid_w-buttGalzedJoint)/2*(HJ<>1),-1
			else
				PRISM_ 5, gs_glass_thk,
					0, 0, 15,
					rightPanelWidth-gs_fw_side_right+gs_right_g, 0, 15,
					rightPanelWidth-gs_fw_side_right+gs_right_g, vgnn, 15,
					0, vgnn, 15,
					0, 0, -1
			endif
			DEL 1
		endif
		ADDY vgnn+gs_grid_w
	next HJ
	DEL gs_hor_gnum+1
	DEL 1
endif
!! END OF GLASS !!

!! TRANSOM GLASS !!

MATERIAL gs_glass_mat
PEN gs_glass_pen

ADDZ gs_gsb

for HW=1 to gs_hor_gnumtr+1
	if HW=1 AND gs_hor_gnumtr=0 then vgnt=middlePanelHeight-topPanelHeight
	if HW=1 AND gs_hor_gnumtr>0 then vgnt=gs_hor_dtr[1]-gs_grid_w
	if HW>1 AND HW<gs_hor_gnumtr+1 then vgnt=gs_hor_dtr[HW]-gs_hor_dtr[HW-1]-gs_grid_w
	if HW>1 AND HW=gs_hor_gnumtr+1 then vgnt=middlePanelHeight-gs_hor_dtr[HW-1]-topPanelHeight

	for HA=1 to gs_ver_gnum+1
		if abs(HA-1)<eps AND gs_ver_gnum=0 then
			hgnn=ac_unit_width-frameOrSLightWidthLeft-frameOrSLightWidthRight
		endif
		if abs(HA-1)<eps AND gs_ver_gnum>0 then hgnn=gs_ver_d[1]-gs_grid_w
		if HA>1 AND HA<gs_ver_gnum+1 then hgnn=gs_ver_d[HA]-gs_ver_d[HA-1]-gs_grid_w
		if HA>1 AND abs(HA-gs_ver_gnum-1)<eps then
			hgnn=ac_unit_width-gs_ver_d[HA-1]-frameOrSLightWidthLeft-frameOrSLightWidthRight
		endif

		ADD -ac_unit_width/2+frameOrSLightWidthLeft, midRailElevation*bMiddleRail+midRailWidth/2,0
		DEL 1

		ADDX hgnn+gs_grid_w
	next HA
	DEL gs_ver_gnum+1

	if gs_sidelight_left then
		ADD -ac_unit_width/2+gs_fw_side_left, midRailElevation*bMiddleRail+midRailWidth/2,0
		if iFrameStyleMullion = FRAME_STYLE_BUTT_GLAZED then
			PRISM_ 5, gs_glass_thk,
				-gs_left_g,-(gs_grid_w-buttGalzedJoint)/2*(HW<>1),15,
				leftPanelWidth-gs_fw_side_left,-(gs_grid_w-buttGalzedJoint)/2*(HW<>1),15,
				leftPanelWidth-gs_fw_side_left,vgnt+(gs_grid_w-buttGalzedJoint)/2*(Hw<>gs_hor_gnumtr+1),15,
				-gs_left_g,vgnt+(gs_grid_w-buttGalzedJoint)/2*(Hw<>gs_hor_gnumtr+1),15,
				-gs_left_g,-(gs_grid_w-buttGalzedJoint)/2*(HW<>1),-1
		else
			PRISM_ 5, gs_glass_thk,
				-gs_left_g, 0, 15,
				leftPanelWidth-gs_fw_side_left, 0, 15,
				leftPanelWidth-gs_fw_side_left, vgnt, 15,
				-gs_left_g, vgnt, 15,
				-gs_left_g, 0, -1
		endif
		DEL 1
	endif

	if gs_sidelight_right then
		ADD +ac_unit_width/2-rightPanelWidth, midRailElevation*bMiddleRail+midRailWidth/2,0
		if iFrameStyleMullion = FRAME_STYLE_BUTT_GLAZED then
			PRISM_ 5, gs_glass_thk,
				0,-(gs_grid_w-buttGalzedJoint)/2*(HW<>1),15,
				rightPanelWidth-gs_fw_side_right+gs_right_g,-(gs_grid_w-buttGalzedJoint)/2*(HW<>1),15,
				rightPanelWidth-gs_fw_side_right+gs_right_g,vgnt+(gs_grid_w-buttGalzedJoint)/2*(Hw<>gs_hor_gnumtr+1),15,
				0,vgnt+(gs_grid_w-buttGalzedJoint)/2*(Hw<>gs_hor_gnumtr+1),15,
				0,-(gs_grid_w-buttGalzedJoint)/2*(HW<>1),-1
		else
			PRISM_ 5, gs_glass_thk,
				0, 0, 15,
				rightPanelWidth-gs_fw_side_right+gs_right_g, 0, 15,
				rightPanelWidth-gs_fw_side_right+gs_right_g, vgnt, 15,
				0, vgnt, 15,
				0, 0, -1
		endif
		DEL 1
	endif
	ADDY vgnt+gs_grid_w
next HW
DEL gs_hor_gnumtr+1

DEL 1

! END OF TRANSOM GLASS !!

!! TOP PANEL GLASS !!

if gs_door_transom then

MATERIAL gs_glass_mat
PEN gs_glass_pen
ADDZ gs_gsb

for HW=1 to gs_hor_gtp+1
		if HW=1 AND gs_hor_gtp=0 then vgnt=topPanelHeight-gs_fw_upper
		if HW=1 AND gs_hor_gtp>0 then vgnt=gs_hor_dtp[1]-gs_grid_w
		if HW>1 AND HW<gs_hor_gtp+1 then vgnt=gs_hor_dtp[HW]-gs_hor_dtp[HW-1]-gs_grid_w
		if HW>1 AND HW=gs_hor_gtp+1 then vgnt=topPanelHeight-gs_hor_dtp[HW-1]-gs_fw_upper

	for HA=1 to gs_ver_gnum+1
		if iStorefrontType = SFTYPE_DOOR_TRSL then
			if abs(HA-1)<eps AND gs_ver_gnum=0 then
				hgnn=ac_unit_width-frameOrSLightWidthLeft-frameOrSLightWidthRight
			endif
		else
			if abs(HA-1)<eps AND gs_ver_gnum=0 then  hgnn=ac_unit_width-gs_fw_side_left-gs_fw_side_right-leftPanelWidth-rightPanelWidth
		endif

		if abs(HA-1)<eps AND gs_ver_gnum>0 then hgnn=gs_ver_d[1]-gridWidthVert
		if HA>1 AND HA<gs_ver_gnum+1 then hgnn=gs_ver_d[HA]-gs_ver_d[HA-1]-gridWidthVert
		if HA>1 AND abs(HA-gs_ver_gnum-1)<eps then
			hgnn=ac_unit_width-gs_ver_d[HA-1]-frameOrSLightWidthLeft-frameOrSLightWidthRight
		endif

		ADD -ac_unit_width/2+frameOrSLightWidthLeft, ac_unit_height-topPanelHeight,0

		if iFrameStyleMullion = FRAME_STYLE_BUTT_GLAZED then
			PRISM_ 5, gs_glass_thk,
				-gs_left_g*(abs(HA-1)<eps)*not(gs_sidelight_left)-(gridWidthVert-buttGalzedJoint)/2*(HA>1), -(gs_grid_w-buttGalzedJoint)/2*(HW<>1), 15,
				hgnn+(gridWidthVert-buttGalzedJoint)/2*(HA<gs_ver_gnum+1)+gs_right_g*(abs(HA-gs_ver_gnum-1)<eps)*not(gs_sidelight_right),
					-(gs_grid_w-buttGalzedJoint)/2*(HW<>1), 15,
				hgnn+(gridWidthVert-buttGalzedJoint)/2*(HA<gs_ver_gnum+1)+gs_right_g*(abs(HA-gs_ver_gnum-1)<eps)*not(gs_sidelight_right),
					vgnt+(gs_grid_w-buttGalzedJoint)/2*(HW<>gs_hor_gtp+1), 15,
				-gs_left_g*(abs(HA-1)<eps)*not(gs_sidelight_left)-(gridWidthVert-buttGalzedJoint)/2*(HA>1),	vgnt+(gs_grid_w-buttGalzedJoint)/2*(HW<>gs_hor_gtp+1), 15,
				-gs_left_g*(abs(HA-1)<eps)*not(gs_sidelight_left)-(gridWidthVert-buttGalzedJoint)/2*(HA>1),	-(gs_grid_w-buttGalzedJoint)/2*(HW<>1), -1
		else
			PRISM_ 5, gs_glass_thk,
				-gs_left_g*(abs(HA-1)<eps)*not(gs_sidelight_left), 0, 15,
				hgnn+gs_right_g*(abs(HA-gs_ver_gnum-1)<eps)*not(gs_sidelight_right), 0, 15,
				hgnn+gs_right_g*(abs(HA-gs_ver_gnum-1)<eps)*not(gs_sidelight_right), vgnt, 15,
				-gs_left_g*(abs(HA-1)<eps)*not(gs_sidelight_left), vgnt, 15,
				-gs_left_g*(abs(HA-1)<eps)*not(gs_sidelight_left), 0, -1
		endif
		DEL 1
		ADDX hgnn+gridWidthVert
	next HA
	DEL gs_ver_gnum+1

	if gs_sidelight_left then
		ADD -ac_unit_width/2+gs_fw_side_left,  ac_unit_height-topPanelHeight,0
		if iFrameStyleMullion = FRAME_STYLE_BUTT_GLAZED then
			PRISM_ 5, gs_glass_thk,
				-gs_left_g,-(gs_grid_w-buttGalzedJoint)/2*(HW<>1),15,
				leftPanelWidth-gs_fw_side_left,-(gs_grid_w-buttGalzedJoint)/2*(HW<>1),15,
				leftPanelWidth-gs_fw_side_left,vgnt+(gs_grid_w-buttGalzedJoint)/2*(Hw<>gs_hor_gtp+1),15,
				-gs_left_g,vgnt+(gs_grid_w-buttGalzedJoint)/2*(Hw<>gs_hor_gtp+1),15,
				-gs_left_g,-(gs_grid_w-buttGalzedJoint)/2*(HW<>1),-1
		else
			PRISM_ 5, gs_glass_thk,
				-gs_left_g, 0, 15,
				leftPanelWidth-gs_fw_side_left, 0, 15,
				leftPanelWidth-gs_fw_side_left, vgnt, 15,
				-gs_left_g, vgnt, 15,
				-gs_left_g, 0, -1
		endif
		DEL 1
	endif

	if gs_sidelight_right then
		ADD ac_unit_width/2-rightPanelWidth, ac_unit_height-topPanelHeight,0
		if iFrameStyleMullion = FRAME_STYLE_BUTT_GLAZED then
			PRISM_ 5, gs_glass_thk,
				0,-(gs_grid_w-buttGalzedJoint)/2*(HW<>1),15,
				rightPanelWidth-gs_fw_side_right+gs_right_g,-(gs_grid_w-buttGalzedJoint)/2*(HW<>1),15,
				rightPanelWidth-gs_fw_side_right+gs_right_g,vgnt+(gs_grid_w-buttGalzedJoint)/2*(Hw<>gs_hor_gtp+1),15,
				0,vgnt+(gs_grid_w-buttGalzedJoint)/2*(Hw<>gs_hor_gtp+1),15,
				0,-(gs_grid_w-buttGalzedJoint)/2*(HW<>1),-1
		else
			PRISM_ 5, gs_glass_thk,
				0, 0, 15,
				rightPanelWidth-gs_fw_side_right+gs_right_g, 0, 15,
				rightPanelWidth-gs_fw_side_right+gs_right_g, vgnt, 15,
				0, vgnt, 15,
				0, 0, -1
		endif
		DEL 1
	endif
	ADDY vgnt+gs_grid_w
next HW
DEL gs_hor_gtp+1

DEL 1

endif
!! END OF TOP PANEL GLASS !!

if gs_cl=1 then CUTEND
if gs_cr=1 then CUTEND

!! DOOR PANELS !!

del nFlipTrans

! =============================================================================
! Door Stop
! =============================================================================

pen gs_frame_pen
material gs_frame_mat
sect_fill fr_sect_fill_type, fr_sect_fill_bg, fr_sect_fill_fg, gs_pen_2D

add -ac_unit_width/2+frameOrSLightWidthLeft,0,gs_leaf_thk

if gs_ds & bEnableDoorStop then
	if not(gs_mf) then
		if gs_SashText_typ_num = 1 then ! Mittered Joint
			base
			Prism_ 4,gs_ds_thk,
				0, 0, 15,
				0,ac_unit_height-frameOrTransomHeight, 10,
				gs_ds_w, ac_unit_height-frameOrTransomHeight-gs_ds_w, 13,
				gs_ds_w, 0, 15
			vert 0, 0, 0
			vert 0, 1, 0
			vert 1, 0, 0
			vert 0, 0, 1
			coor 2, -1, -2, -3, -4
			body 1

			base
				Prism_ 4,gs_ds_thk,
					lw, 0, 15,
					lw,ac_unit_height-frameOrTransomHeight, 10,
					lw-gs_ds_w, ac_unit_height-frameOrTransomHeight-gs_ds_w, 13,
					lw-gs_ds_w, 0, 15
			vert 0, 0, 0
			vert 0, 1, 0
			vert 1, 0, 0
			vert 0, 0, 1
			coor 2, -1, -2, -3, -4
			body 1

			base
				Prism_ 4,gs_ds_thk,
					0,ac_unit_height-frameOrTransomHeight, 10,
					gs_ds_w, ac_unit_height-frameOrTransomHeight-gs_ds_w, 15,
					lw-gs_ds_w, ac_unit_height-frameOrTransomHeight-gs_ds_w, 10,
					lw,ac_unit_height-frameOrTransomHeight, 15
			vert 0, 0, 0
			vert 1, 0, 0
			vert 0, 1, 0
			vert 0, 0, 1
			coor 2, -1, -2, -3, -4
			body 1
		else  ! Butt Joint
			base
			Prism_ 4,gs_ds_thk,
				0,0,15,
				0, ac_unit_height-frameOrTransomHeight-gs_ds_w, 10,
				gs_ds_w, ac_unit_height-frameOrTransomHeight-gs_ds_w, 13,
				gs_ds_w, 0, 15
			vert 0, 0, 0
			vert 0, 1, 0
			vert 1, 0, 0
			vert 0, 0, 1
			coor 2, -1, -2, -3, -4
			body 1

			base
				Prism_ 4,gs_ds_thk,
					lw, 0, 15,
					lw, ac_unit_height-frameOrTransomHeight-gs_ds_w, 10,
					lw-gs_ds_w, ac_unit_height-frameOrTransomHeight-gs_ds_w, 13,
					lw-gs_ds_w, 0, 15
			vert 0, 0, 0
			vert 0, 1, 0
			vert 1, 0, 0
			vert 0, 0, 1
			coor 2, -1, -2, -3, -4
			body 1

			base
				Prism_ 6,gs_ds_thk,
					0,ac_unit_height-frameOrTransomHeight,15,
					0, ac_unit_height-frameOrTransomHeight-gs_ds_w, 8,
					gs_ds_w,ac_unit_height-frameOrTransomHeight-gs_ds_w,15,
					lw-gs_ds_w, ac_unit_height-frameOrTransomHeight-gs_ds_w, 10,
					lw, ac_unit_height-frameOrTransomHeight-gs_ds_w, 13,
					lw, ac_unit_height-frameOrTransomHeight, 15
			vert 0, 0, 0
			vert 1, 0, 0
			vert 0, 1, 0
			vert 0, 0, 1
			coor 2, -1, -2, -3, -4
			body 1
		endif
	endif
	if gs_mf then
		prism_ 5+4, gs_ds_thk,
			0,0,15,
			0,ac_unit_height-frameOrTransomHeight,15,
			lal,ac_unit_height-frameOrTransomHeight,15,
			lal,0,15,
			lal-gs_ds_w,0,15,
			lal-gs_ds_w,ac_unit_height-frameOrTransomHeight-gs_ds_W,15,
			gs_ds_w,ac_unit_height-frameOrTransomHeight-gs_ds_w,15,
			gs_ds_w,0,15,
			0,0,-1
		prism_ 5+4, gs_ds_thk,
			lw-lar,0,15,
			lw-lar,ac_unit_height-frameOrTransomHeight,15,
			lw,ac_unit_height-frameOrTransomHeight,15,
			lw,0,15,
			lw-gs_ds_w,0,15,
			lw-gs_ds_w,ac_unit_height-frameOrTransomHeight-gs_ds_W,15,
			lw-lar+gs_ds_w,ac_unit_height-frameOrTransomHeight-gs_ds_w,15,
			lw-lar+gs_ds_w,0,15,
			lw-lar,0,-1
	endif
endif

del 1


! =============================================================================
! Door Panel
! =============================================================================
if iDoorPanelType <> PANEL_EMPTY then
	unIDOpening = 2
	_bMiddleLine = 0
	mulx -1

	if iDoorType = 1 then
		openSizeA = ac_unit_width-frameOrSLightWidthRight-frameOrSLightWidthLeft
	else
		openSizeA = lar
	endif

	if gs_full_edit & GLOB_CONTEXT <> 4 & GLOB_CONTEXT <> 24 & GLOB_CONTEXT <> 6 then
		addx -(ac_unit_width)/2 + frameOrSLightWidthRight

		hotspot openSizeA,gs_han_height,0,unIDOpening,gs_open_3D,4+128
		unIDOpening=unIDOpening+1

		hotspot openSizeA*cos(gs_open_3D), gs_han_height,-openSizeA*sin(gs_open_3D),unIDOpening,gs_open_3D,5
		unIDOpening=unIDOpening+1

		hotspot 0, gs_han_height,0,unIDOpening,gs_open_3D, 6
		unIDOpening=unIDOpening+1

		hotspot 0,0,0,unIDOpening,gs_open_3D,7

		del 1
	endif

	if iDoorType = 1 then
		nLeafs = 1
	else
		nLeafs = 2
	endif

	_sizeLeafB = ac_unit_height-frameOrTransomHeight

	for i=1 to nLeafs

		if iDoorType = 1 then
			_sizeLeafA = ac_unit_width-frameOrSLightWidthRight-frameOrSLightWidthLeft
		else
			if i = 1 then
				_sizeLeafA = lar
			else
				_sizeLeafA = lal
			endif
		endif

		if i = 1 then
			_iHandleTypeIn		= gs_handle_type_m
			_iHandleTypeOut		= gs_handle_type_out_m
			_gs_cust_handle		= gs_cust_handle
			_gs_cust_handle_out	= gs_cust_handle_out
			_gs_han_height		= gs_han_height
			_gs_han_pos			= gs_han_pos
			_bMiddleLine		= 1
			_opLineType3dIn		= opLineType3dIn
			_opLineType3dOut	= opLineType3dOut
		else
			_iHandleTypeIn		= gs_handle_type2_m
			_iHandleTypeOut		= gs_handle_type2_out_m
			_gs_cust_handle		= gs_cust_handle2
			_gs_cust_handle_out	= gs_cust_handle2_out
			_gs_han_height		= gs_han_height2
			_gs_han_pos			= gs_han_pos2
			_bMiddleLine		= 0

			if bEnableSecondaryOpLineTypes & not(gs_bSameLineTypeForLeaves) then
				_opLineType3dIn		= opLineTypeSecondary
				_opLineType3dOut	= opLineTypeSecondary
			else
				_opLineType3dIn		= opLineType3dIn
				_opLineType3dOut	= opLineType3dOut
			endif
		endif

		if i = 1 then
			addx -(ac_unit_width)/2 + frameOrSLightWidthRight
			roty gs_open_3D
			addx _sizeLeafA/2
		else
			addx -(ac_unit_width)/2 + frameOrSLightWidthLeft
			roty gs_open_3D
			addx _sizeLeafA/2
		endif

		if i > 1 then
			bSecondPanel = 1
		else
			bSecondPanel = 0
		endif
		gosub "doorLeafCall"

		del 3
		mulx -1
	next i
	del 1

	del 1
endif


! =============================================================================
! Middle frame
! =============================================================================

sect_fill fr_sect_fill_type, fr_sect_fill_bg, fr_sect_fill_fg, gs_pen_2D

if gs_mf then
	rotx -90
	prism_ 8, ac_unit_height-frameOrTransomHeight,
		-ac_unit_width/2+frameOrSLightWidthRight+lar, 0, 15,
		-ac_unit_width/2+frameOrSLightWidthRight+lar, -min(gs_leaf_thk, gs_fthk), 15,
		-ac_unit_width/2+frameOrSLightWidthRight+lar, -min(gs_leaf_thk, gs_fthk) - bEnableDoorStop * gs_ds_thk, 15,
		-ac_unit_width/2+frameOrSLightWidthRight+lar, -gs_fthk, 15,
		ac_unit_width/2-frameOrSLightWidthLeft-lal, -gs_fthk, 15,
		ac_unit_width/2-frameOrSLightWidthLeft-lal, -min(gs_leaf_thk, gs_fthk) - bEnableDoorStop * gs_ds_thk, 15,
		ac_unit_width/2-frameOrSLightWidthLeft-lal, -min(gs_leaf_thk, gs_fthk), 15,
		ac_unit_width/2-frameOrSLightWidthLeft-lal, 0, 15
	del 1
endif


if gs_wthk=1 then DEL 1


! =============================================================================
end
! =============================================================================


! =============================================================================
"textures1":
! =============================================================================
	vert 0, 0, 0
	vert 0, 1, 0
	vert 1, 0, 0
	vert 0, 0, 1
	coor 2, -1, -2, -3, -4

return

! =============================================================================
"textures2":
! =============================================================================
	vert 0, 0, 0
	vert 1, 0, 0
	vert 0, 1, 0
	vert 0, 0, 1
	coor 2, -1, -2, -3, -4

return


"rightMidRail":
	PRISM_ 4, gs_fthk,
			ac_unit_width/2-gs_fw_side_right+(xpr-gs_fw_side_right)*(xpr>gs_fw_side_right)*(iFrameStyleRight = FRAME_STYLE_BUTT_GLAZED),  midRailElevation-midRailWidth/2, 15,
			ac_unit_width/2-rightPanelWidth, midRailElevation-midRailWidth/2, 15,
			ac_unit_width/2-rightPanelWidth, midRailElevation+midRailWidth/2, 15,
			ac_unit_width/2-gs_fw_side_right+(xpr-gs_fw_side_right)*(xpr>gs_fw_side_right)*(iFrameStyleRight = FRAME_STYLE_BUTT_GLAZED),  midRailElevation+midRailWidth/2, 15
return


"leftMidRail":
	PRISM_ 4, gs_fthk,
			-ac_unit_width/2+gs_fw_side_left+(xpl-gs_fw_side_left)*(xpl>gs_fw_side_left)*(iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED),  midRailElevation-midRailWidth/2, 15,
			-ac_unit_width/2+leftPanelWidth, midRailElevation-midRailWidth/2, 15,
			-ac_unit_width/2+leftPanelWidth, midRailElevation+midRailWidth/2, 15,
			-ac_unit_width/2+gs_fw_side_left+(xpl-gs_fw_side_left)*(xpl>gs_fw_side_left)*(iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED),  midRailElevation+midRailWidth/2, 15
return


"leftSidelightBottomFrame":
	Prism_ 6, gs_fthk,
		-ac_unit_width/2+gs_fw_side_left,	gs_fw_lower,	10+maskLeftButFr,
		leftFrame,							gs_fw_lower,	mask4,
		leftFrame,							0,				15,
		-ac_unit_width/2+frameOrSLightWidthLeft,	0,			15,
		-ac_unit_width/2+frameOrSLightWidthLeft,	gs_fw_lower, 8,
		-ac_unit_width/2+leftPanelWidth,			gs_fw_lower, 15

return


"rightSidelightBottomFrame":

	Prism_ 6, gs_fthk,
		ac_unit_width/2-gs_fw_side_right, 	gs_fw_lower, 10+maskRightButFr,
		rightFrame, 						gs_fw_lower, mask4,
		rightFrame, 						0, 			 15,
		ac_unit_width/2-frameOrSLightWidthRight, 0, 15,
		ac_unit_width/2-frameOrSLightWidthRight, gs_fw_lower, 8,
		ac_unit_width/2-rightPanelWidth,		 gs_fw_lower, 15

return


"doorLeafCall":
	call "DoorLeafPanels" parameters all A		= _sizeLeafA,
										 B		= _sizeLeafB,
						bEnableKickBoard	= 1,
						bStorefrontClassic	= 1,
						bStorefrontDoor		= 1,
						bSecondPanel		= bSecondPanel,
						iDoorPanelType		= iDoorPanelType,
						gs_cust_panel		= gs_cust_panel,
						bMiddleRail			= bMiddleRail,
						midRailElevation	= midRailElevation,
						gs_leaf_thk			= gs_leaf_thk,
						gs_fw_side			= leafFrameWidth,
						gs_fw_side_right	= leafFrameWidth,
						gs_fw_side_left		= leafFrameWidth,
						gs_fw_lower			= bottomRailWidth,
						gs_fw_upper			= leafFrameWidth,
						gs_int_fw			= midRailWidth,
						gs_glass_thk		= gs_glass_thk,
						gs_handle_type_m	= _iHandleTypeIn,
						gs_handle_type_out_m= _iHandleTypeOut,
						gs_cust_handle		= _gs_cust_handle,
						gs_cust_handle_out	= _gs_cust_handle_out,
						gs_han_height		= _gs_han_height,
						gs_han_pos			= _gs_han_pos,
						lod3D				= lod3D,
						res					= res,
						gs_SashText_typ_num	= gs_SashText_typ_num,

						gs_leaf_pen			= gs_leaf_pen,
						gs_glass_pen		= gs_glass_pen,
						gs_leaf_pen_cont	= gs_leaf_pen_2D,
						gs_glass_pen_cont	= gs_pen_glass,
						gs_fillLeaf			= sh_sect_fill_type,
						gs_penLeaf_fg		= sh_sect_fill_fg,
						gs_penLeaf_bg		= sh_sect_fill_bg,
						gs_FillSdl			= gs_FillSdl,
						gs_penSdl_fg		= gs_penSdl_fg,
						gs_penSdl_bg 		= gs_penSdl_bg,
						gs_gsect			= gl_sect_fill_type,
						gs_penGlass_fg		= gl_sect_fill_fg,
						gs_penGlass_bg		= gl_sect_fill_bg,

						bMiddleLine			= _bMiddleLine,
						gs_leaf_mat			= gs_leaf_mat,
						gs_leaf_matin		= gs_leaf_mat,
						gs_lock_mat			= gs_lock_mat,
						gs_glass_mat		= gs_glass_mat,
						gs_handle_mat		= gs_handle_mat,
						gs_handle_ac_mat	= gs_handle_ac_mat,
						gs_frame_thk		= gs_frame_thk,
						gs_pivotdoor		= 0,
						bOplines3d			= bOplines3d,
						opLineType3dIn		= _opLineType3dIn,
						opLineType3dOut		= _opLineType3dOut,
						gs_opline_style_m	= gs_opline_style_m,
						gs_opLinePen		= gs_opLinePen
return


