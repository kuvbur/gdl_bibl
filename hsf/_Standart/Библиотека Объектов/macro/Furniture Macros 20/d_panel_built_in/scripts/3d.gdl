
if gs_ap_m =0 then end
resol gs_resol


!********** panel depth
p_d = 0.02
aps = p_d

!********** handle height
h_h=b/2


if optyp_m=1 or optyp_m=2 then

	unID=1

!!!	!*** moving hotspot
	dx=0.02

	addx a/2
	addz d_z
	roty -gs_open_3D
	addz -d_z
	addx -a/2

endif

material mat_p



!********** door panels

if gs_ap_m =1 then gosub 10
if gs_ap_m =2 then gosub 20
if gs_ap_m =3 then gosub 100
if gs_ap_m =4 then gosub 30
if gs_ap_m =5 then gosub 40
if gs_ap_m =6 then gosub 90
if gs_ap_m =7 then gosub 110
if gs_ap_m =8 then gosub 120
if gs_ap_m =9 then gosub 200
if gs_ap_m =10 then gosub 210


!********* coordinates for textures

gosub 1000


!********* handle subroutine
reqBKnobs = 0
success = LIBRARYGLOBAL ("LibraryGlobals13", "hideBKnobs", reqBKnobs)
if success > 0 and reqBKnobs then
		end
endif


if gs_hando_m > 0 then

	add -a/2+0.05, h_h, p_d
	material mat2

	if gs_hando_m=1 gosub 2001
	if gs_hando_m=2 gosub 3002
	if gs_hando_m=3 gosub 4003
	if gs_hando_m=4 gosub 5004
	del 1

endif


END


!******** door panel subroutins **********


10:

!********************* panel type 1

prism_   4, p_d,
	-a/2, 0, 15,
	 a/2, 0, 15,
	 a/2, b, 15,
	-a/2, b, 15

return



20:

!********************* panel type 2

prism_   10, p_d,
	-a/2, 0, 15,
	 a/2, 0, 15,
	 a/2, b, 15,
	-a/2, b, 15,
	-a/2, 0, -1,

	-a/2+0.1, 0.2, 15,
	 a/2-0.1, 0.2, 15,
	 a/2-0.1, b-0.1, 15,
	-a/2+0.1, b-0.1, 15,
	-a/2+0.1, 0.2, -1

addz 0.0125

prism_  4, p_d-2*0.0125,
	-a/2+0.1, 0.2, 15,
	 a/2-0.1, 0.2, 15,
	 a/2-0.1, b-0.1, 15,
	-a/2+0.1, b-0.1, 15

del 1

return



30:

!********************* panel type 3

prism_   15, p_d,
	-a/2, 0, 15,
	 a/2, 0, 15,
	 a/2, b, 15,
	-a/2, b, 15,
	-a/2, 0, -1,

	-a/2+0.1, 0.2, 15,
	-0.06, 0.2, 15,
	-0.06, b-0.1, 15,
	-a/2+0.1, b-0.1, 15,
	-a/2+0.1, 0.2, -1,

	 0.06, 0.2, 15,
	 a/2-0.1, 0.2, 15,
	 a/2-0.1, b-0.1, 15,
	 0.06, b-0.1, 15,
	 0.06, 0.2, -1


addz 0.0125

prism_  5, p_d-2*0.0125,
	-a/2+0.1, 0.2, 15,
	-0.06, 0.2, 15,
	-0.06, b-0.1, 15,
	-a/2+0.1, b-0.1, 15,
	-a/2+0.1, 0.2, -1

prism_  5, p_d-2*0.0125,
	 0.06, 0.2, 15,
	 a/2-0.1, 0.2, 15,
	 a/2-0.1, b-0.1, 15,
	 0.06, b-0.1, 15,
	 0.06, 0.2, -1

del 1

return



40:

!********************* panel type 4

prism_   25, p_d,
	-a/2, 0, 15,
	 a/2, 0, 15,
	 a/2, b, 15,
	-a/2, b, 15,
	-a/2, 0, -1,

	-a/2+0.1, 0.2, 15,
	-0.06, 0.2, 15,
	-0.06, 0.665, 15,
	-a/2+0.1, 0.665, 15,
	-a/2+0.1, 0.2, -1,

	 0.06, 0.2, 15,
	 a/2-0.1, 0.2, 15,
	 a/2-0.1, 0.665, 15,
	 0.06, 0.665, 15,
	 0.06, 0.2, -1,


	-a/2+0.1, 0.785, 15,
	-0.06, 0.785, 15,
	-0.06, b-0.1, 15,
	-a/2+0.1, b-0.1, 15,
	-a/2+0.1, 0.785, -1,

	 0.06, 0.785, 15,
	 a/2-0.1, 0.785, 15,
	 a/2-0.1, b-0.1, 15,
	 0.06, b-0.1, 15,
	 0.06, 0.785, -1

addz 0.0125

prism_  5, p_d-2*0.0125,
	-a/2+0.1, 0.2, 15,
	-0.06, 0.2, 15,
	-0.06, 0.665, 15,
	-a/2+0.1, 0.665, 15,
	-a/2+0.1, 0.2, -1

prism_  5, p_d-2*0.0125,
	 0.06, 0.2, 15,
	 a/2-0.1, 0.2, 15,
	 a/2-0.1, 0.665, 15,
	 0.06, 0.665, 15,
	 0.06, 0.2, -1

prism_  5, p_d-2*0.0125,
	-a/2+0.1, 0.785, 15,
	-0.06, 0.785, 15,
	-0.06, b-0.1, 15,
	-a/2+0.1, b-0.1, 15,
	-a/2+0.1, 0.785, -1


prism_  5, p_d-2*0.0125,
	 0.06, 0.785, 15,
	 a/2-0.1, 0.785, 15,
	 a/2-0.1, b-0.1, 15,
	 0.06, b-0.1, 15,
	 0.06, 0.785, -1

del 1

return



90:

!********************* panel type 9

prism_  35, p_d,
	-a/2, 0, 15,
	 a/2, 0, 15,
	 a/2, b, 15,
	-a/2, b, 15,
	-a/2, 0, -1,

	-a/2+0.1, 0.2, 15,
	-0.06, 0.2, 15,
	-0.06, 0.665, 15,
	-a/2+0.1, 0.665, 15,
	-a/2+0.1, 0.2, -1,

	 0.06, 0.2, 15,
	 a/2-0.1, 0.2, 15,
	 a/2-0.1, 0.665, 15,
	 0.06, 0.665, 15,
	 0.06, 0.2, -1,

	-a/2+0.1, 0.785, 15,
	-0.06, 0.785, 15,
	-0.06, b-a/2-0.06, 15,
	-a/2+0.1, b-a/2-0.06, 15,
	-a/2+0.1, 0.785, -1,

	 0.06, 0.785, 15,
	 a/2-0.1, 0.785, 15,
	 a/2-0.1, b-a/2-0.06, 15,
	 0.06, b-a/2-0.06, 15,
	 0.06, 0.785, -1,

	-a/2+0.1, b-a/2+0.06, 15,
	-0.06, b-a/2+0.06, 15,
	-0.06, b-0.1, 15,
	-a/2+0.1, b-0.1, 15,
	-a/2+0.1, b-a/2+0.06, -1,

	 0.06, b-a/2+0.06, 15,
	 a/2-0.1, b-a/2+0.06, 15,
	 a/2-0.1, b-0.1, 15,
	 0.06, b-0.1, 15,
	 0.06, b-a/2+0.06, -1

prism_ 5, p_d,
	-a/2+0.135, 0.235, 15,
	-0.095, 0.235, 15,
	-0.095, 0.630, 15,
	-a/2+0.135, 0.630, 15,
	-a/2+0.135, 0.235, -1

prism_ 5, p_d,
	 0.095, 0.235, 15,
	 a/2-0.135, 0.235, 15,
	 a/2-0.135, 0.630, 15,
	 0.095, 0.630, 15,
	 0.095, 0.235, -1

prism_ 5, p_d,
	-a/2+0.135, 0.820, 15,
	-0.095, 0.820, 15,
	-0.095,b-a/2-0.095, 15,
	-a/2+0.135,b-a/2-0.095, 15,
	-a/2+0.135, 0.820, -1


prism_ 5, p_d,
	 0.095, 0.820, 15,
	 a/2-0.135, 0.820, 15,
	 a/2-0.135,b-a/2-0.095, 15,
	 0.095,b-a/2-0.095, 15,
	 0.095, 0.820, -1

prism_ 5, p_d,
	-a/2+0.135,b-a/2+0.095, 15,
	-0.095,b-a/2+0.095, 15,
	-0.095, b-0.135, 15,
	-a/2+0.135, b-0.135, 15,
	-a/2+0.135,b-a/2+0.095, -1

prism_ 5, p_d,
	 0.095,b-a/2+0.095, 15,
	 a/2-0.135,b-a/2+0.095, 15,
	 a/2-0.135, b-0.135, 15,
	 0.095, b-0.135, 15,
	 0.095,b-a/2+0.095, -1

addz 0.0125

prism_  10, p_d-2*0.0125,
	-a/2+0.1, 0.2, 15,
	-0.06, 0.2, 15,
	-0.06, 0.665, 15,
	-a/2+0.1, 0.665, 15,
	-a/2+0.1, 0.2, -1,

	-a/2+0.135, 0.235, 15,
	-0.095, 0.235, 15,
	-0.095, 0.630, 15,
	-a/2+0.135, 0.630, 15,
	-a/2+0.135, 0.235, -1

prism_  10, p_d-2*0.0125,
	 0.06, 0.2, 15,
	 a/2-0.1, 0.2, 15,
	 a/2-0.1, 0.665, 15,
	 0.06, 0.665, 15,
	 0.06, 0.2, -1,

	 0.095, 0.235, 15,
	 a/2-0.135, 0.235, 15,
	 a/2-0.135, 0.630, 15,
	 0.095, 0.630, 15,
	 0.095, 0.235, -1

prism_  10, p_d-2*0.0125,
	-a/2+0.1, 0.785, 15,
	-0.06, 0.785, 15,
	-0.06,b-a/2-0.06, 15,
	-a/2+0.1,b-a/2-0.06, 15,
	-a/2+0.1, 0.785, -1,

	-a/2+0.135, 0.820, 15,
	-0.095, 0.820, 15,
	-0.095,b-a/2-0.095, 15,
	-a/2+0.135,b-a/2-0.095, 15,
	-a/2+0.135, 0.820, -1

prism_  10, p_d-2*0.0125,
	 0.06, 0.785, 15,
	 a/2-0.1, 0.785, 15,
	 a/2-0.1,b-a/2-0.06, 15,
	 0.06,b-a/2-0.06, 15,
	 0.06, 0.785, -1,

	 0.095, 0.820, 15,
	 a/2-0.135, 0.820, 15,
	 a/2-0.135,b-a/2-0.095, 15,
	 0.095,b-a/2-0.095, 15,
	 0.095, 0.820, -1

prism_ 10, p_d-2*0.0125,
	-a/2+0.1, b-a/2+0.06, 15,
	-0.06, b-a/2+0.06, 15,
	-0.06, b-0.1, 15,
	-a/2+0.1, b-0.1, 15,
	-a/2+0.1, b-a/2+0.06, -1,

	-a/2+0.135,b-a/2+0.095, 15,
	-0.095,b-a/2+0.095, 15,
	-0.095, b-0.135, 15,
	-a/2+0.135, b-0.135, 15,
	-a/2+0.135,b-a/2+0.095, -1

prism_ 10, p_d-2*0.0125,
	 0.06, b-a/2+0.06, 15,
	 a/2-0.1, b-a/2+0.06, 15,
	 a/2-0.1, b-0.1, 15,
	 0.06, b-0.1, 15,
	 0.06, b-a/2+0.06, -1,

	 0.095,b-a/2+0.095, 15,
	 a/2-0.135,b-a/2+0.095, 15,
	 a/2-0.135, b-0.135, 15,
	 0.095, b-0.135, 15,
	 0.095,b-a/2+0.095, -1

del 1

return



100:

!********************* panel type 10

prism_   10, p_d,
	-a/2, 0, 15,
	 a/2, 0, 15,
	 a/2, b, 15,
	-a/2, b, 15,
	-a/2, 0, -1,

	-a/2+0.1, 0.2, 15,
	 a/2-0.1, 0.2, 15,
	 a/2-0.1, b-0.1, 15,
	-a/2+0.1, b-0.1, 15,
	-a/2+0.1, 0.2, -1

prism_  4, p_d,
	-a/2+0.135, 0.235, 15,
	 a/2-0.135, 0.235, 15,
	 a/2-0.135, b-0.135, 15,
	-a/2+0.135, b-0.135, 15

addz 0.0125

prism_  10, p_d-2*0.0125,
	-a/2+0.1, 0.2, 15,
	 a/2-0.1, 0.2, 15,
	 a/2-0.1, b-0.1, 15,
	-a/2+0.1, b-0.1, 15,
	-a/2+0.1, 0.2, -1,

	-a/2+0.135, 0.235, 15,
	 a/2-0.135, 0.235, 15,
	 a/2-0.135, b-0.135, 15,
	-a/2+0.135, b-0.135, 15,
	-a/2+0.135, 0.235, -1

del 1

return



110:

!********************* panel type 11

prism_   15, p_d,
	-a/2, 0, 15,
	 a/2, 0, 15,
	 a/2, b, 15,
	-a/2, b, 15,
	-a/2, 0, -1,

	-a/2+0.1, 0.16, 15,
	 a/2-0.1, 0.16, 15,
	 a/2-0.1, 0.665, 15,
	-a/2+0.1, 0.665, 15,
	-a/2+0.1, 0.16, -1,

	-a/2+0.1, 0.785, 15,
	 a/2-0.1, 0.785, 15,
	 a/2-0.1, b-0.1, 15,
	-a/2+0.1, b-0.1, 15,
	-a/2+0.1, 0.785, -1

prism_  5, p_d,
	-a/2+0.135,0.195, 15,
	 a/2-0.135,0.195, 15,
	 a/2-0.135, 0.63, 15,
	-a/2+0.135, 0.63, 15,
	-a/2+0.135,0.195, -1

prism_  5, p_d,
	-a/2+0.135, 0.82, 15,
	 a/2-0.135, 0.82, 15,
	 a/2-0.135, b-0.135, 15,
	-a/2+0.135, b-0.135, 15,
	-a/2+0.135, 0.82, -1

addz 0.0125

prism_ 10, p_d-2*0.0125,
	-a/2+0.1, 0.16, 15,
	 a/2-0.1, 0.16, 15,
	 a/2-0.1, 0.665, 15,
	-a/2+0.1, 0.665, 15,
	-a/2+0.1, 0.16, -1,

	-a/2+0.135,0.195, 15,
	 a/2-0.135,0.195, 15,
	 a/2-0.135, 0.63, 15,
	-a/2+0.135, 0.63, 15,
	-a/2+0.135,0.195, -1

prism_ 10, p_d-2*0.0125,
	-a/2+0.1, 0.785, 15,
	 a/2-0.1, 0.785, 15,
	 a/2-0.1, b-0.1, 15,
	-a/2+0.1, b-0.1, 15,
	-a/2+0.1, 0.785, -1,

	-a/2+0.135, 0.82, 15,
	 a/2-0.135, 0.82, 15,
	 a/2-0.135, b-0.135, 15,
	-a/2+0.135, b-0.135, 15,
	-a/2+0.135, 0.82, -1

del 1

return



120:

!********************* panel type 12

prism_   10, p_d,
	-a/2, 0, 15,
	 a/2, 0, 15,
	 a/2, b, 15,
	-a/2, b, 15,
	-a/2, 0, -1,

	-a/2+0.1, 0.2, 15,
	 a/2-0.1, 0.2, 15,
	 a/2-0.1, b-0.1, 15,
	-a/2+0.1, b-0.1, 15,
	-a/2+0.1, 0.2, -1

addz -0.005

prism_  10, p_d+0.01,
	-a/2+0.1, 0.2, 15,
	 a/2-0.1, 0.2, 15,
	 a/2-0.1, b-0.1, 15,
	-a/2+0.1, b-0.1, 15,
	-a/2+0.1, 0.2, -1,

	-a/2+0.135, 0.235, 15,
	 a/2-0.135, 0.235, 15,
	 a/2-0.135, b-0.135, 15,
	-a/2+0.135, b-0.135, 15,
	-a/2+0.135, 0.235, -1

!********** coordinates for textures

gosub 1000

del 1

addz p_d/2-0.007/2

body 1

material mat1

prism_ 4, 0.007,
	-a/2+0.135, 0.235, 15,
	 a/2-0.135, 0.235, 15,
	 a/2-0.135, b-0.135, 15,
	-a/2+0.135, b-0.135, 15

body 1

del 1

return



200:

!********************* panel type 20

prism_   10, p_d,
	-a/2, 0, 15,
	 a/2, 0, 15,
	 a/2, b, 15,
	-a/2, b, 15,
	-a/2, 0, -1,

	-a/2+0.1, 0.2, 15,
	 a/2-0.1, 0.2, 15,
	 a/2-0.1, b-0.1, 15,
	-a/2+0.1, b-0.1, 15,
	-a/2+0.1, 0.2, -1

addz -0.005

kx = -a/2+0.135
ky = 0.235

dy = (b-0.135-0.235-0.015*2) / 3
dx = a-0.135*2

for iy = 1 to 3 step 1

	put kx, ky, 15,
		kx+dx, ky, 15,
		kx+dx, ky+dy, 15,
		kx, ky+dy, 15,
		kx, ky, -1

	ky = ky+dy+0.015

next iy

prism_ 5+nsp/3, p_d+2*0.005,
	-a/2+0.1, 0.2, 15,
	 a/2-0.1, 0.2, 15,
	 a/2-0.1, b-0.1, 15,
	-a/2+0.1, b-0.1, 15,
	-a/2+0.1, 0.2, -1,

	use (nsp)

del 1

!********** coordinates for textures

gosub 1000

body 1
material mat1
addz p_d/2-2*0.007

for ii = 1 to 3 step 1

	prism_ 5, 0.007,
		get (15)

next ii

body 1

del 1

return


210:
!********************* Custom panel
	doorOffset=0.003										!--- offset to be visible edges between custom panels

	if bTurnPanel then
		add -A/2, B, 0
		rotx 90
		add doorOffset/2, doorOffset/2+p_d, doorOffset/2
		rotx 90
	else
		addx A/2-doorOffset/2
		mulx -1
	endif

	CALL "Object_Panel_Collection" PARAMETERS a=a-doorOffset, b=b-doorOffset, zzyzx=p_d-doorOffset, gs_ptype=gs_cust_p

	if bTurnPanel then
		del 4
	else
		del 2
	endif

return

1000:

!***************** coordinates for texture ***************
!*********************************************************


rotz 90
vert 0, 0, 0
vert 0.1, 0, 0
vert 0, 0.1, 0
vert 0, 0, 0.1
del 1

coor 2, -1, -2, -3, -4

base

body -1

return



! === Handle types =============================================================


2001:

!**** handle 1

cylind 0.02,0.0075
addz 0.02
ELLIPS 0.01,0.02
del 1

return

3002:

!**** handle 2

add 0,-0.03,0.005
revolve 2,90,4+8+16,
	0,0.03,901,
	0.007,360,4001
del 1

add 0,-0.08,0.005
rotz 180
revolve 2,90,4+8+16,
	0,0.03,901,
	0.007,360,4001
del 2

add 0,-0.08,0.035
rotx -90
extrude 2,0,0,0.05,4,
	0,0,901,
	0.007,360,4001
del 2

cylind 0.005,0.02

addy -0.11
cylind 0.005,0.02
del 1

return

4003:

!**** handle 3

addy -0.03
revolve 2,90,4+8+16,
	0,0.03,901,
	0.007,360,4001
del 1

addy -0.08
rotz 180
revolve 2,90,4+8+16,
	0,0.03,901,
	0.007,360,4001
del 2

add 0,-0.08,0.03
rotx -90
extrude 2,0,0,0.05,4,
	0,0,901,
	0.007,360,4001
del 2

return

5004:

!**** handle 4

c=0.03

rotz 90
addy 0.03

addy -0.03
revolve 2,90,4+8+16,
	0,0.03,901,
	0.007,360,4001
del 1

addy -c
rotz 180
revolve 2,90,4+8+16,
	0,0.03,901,
	0.007,360,4001
del 2

add 0,-c,0.03
rotx -90
extrude 2,0,0,c-0.03,4,
	0,0,901,
	0.007,360,4001
del 2

del 2

return









