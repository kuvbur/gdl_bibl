
IF gs_detlevel_3D_m=0 THEN END

MATERIAL hbmat

IF gs_detlevel_3D_m=1 THEN

	IF hboard_type_m=2 OR hboard_type_m=4 THEN BLOCK a, hbt, hbh
	IF hboard_type_m=1 OR hboard_type_m=3 THEN
	et=0
	eh=0
	hboard_type_m=1

!	vv=0
!	hboard_type_m=1
!		RESOL gs_resol
!		rh=0.10: m=SQR((a/2)^2+rh^2)
!		alpha=ATN((a/2)/rh): r=m/2/COS(alpha): vv=0
!		ROTX 90
!		PRISM_ 7, -hbt,
!			0, 0, 15,
!			a, 0, 15,
!			a, hbh-rh-vv-0.0001, 15,
!			a, hbh-rh-vv, 79,
!			a/2, hbh-r-vv, 913,
!			0, hbh-rh-vv, 3015,
!			0, 0, -1
!		DEL 1
	ENDIF

ENDIF


IF hboard_type_m=2 AND gs_detlevel_3D_m=2 THEN
	IF et>0 AND eh>0 AND et>=hbt THEN
		ADDY (et-hbt)/2: BLOCK a, hbt, hbh-eh
		DEL 1
	ELSE
		BLOCK a, hbt, hbh
	ENDIF

	IF et>0 AND eh>0 AND et>=hbt THEN
		ADDZ hbh-eh
		BLOCK a, et, eh: DEL 1
ENDIF: ENDIF


	IF hboard_type_m=1 THEN
	RESOL gs_resol
	rh=0.10: m=SQR((a/2)^2+rh^2)
	alpha=ATN((a/2)/rh): r=m/2/COS(alpha): vv=0

	IF et>0 AND eh>0 AND et>=hbt THEN
		ADDY (et-hbt)/2: vv=eh: ENDIF

	ROTX 90
	PRISM_ 7, -hbt,
		0, 0, 15,
		a, 0, 15,
		a, hbh-rh-vv-0.0001, 15,
		a, hbh-rh-vv, 79,
		a/2, hbh-r-vv, 913,
		0, hbh-rh-vv, 3015,
		0, 0, -1
	DEL 1

	IF et>0 AND eh>0 AND et>=hbt THEN
		DEL 1
		ROTX 90
			IF gs_detlevel_3D_m=2 THEN
		PRISM_ 8, -et,
			a, hbh-rh-eh, 79,
			a/2, hbh-r-eh, 913,
			0, hbh-rh-eh, 3015,
			0, hbh-rh-0.0001, 15,
			0, hbh-rh, 79,
			a/2, hbh-r, 913,
			a, hbh-rh, 3015,
			a, hbh-rh-eh, -1
			ENDIF
		DEL 1
ENDIF: ENDIF


IF hboard_type_m=4 AND gs_detlevel_3D_m=2 THEN
	rh=0.10: fw=0.05: vv=0

	IF et>0 AND eh>0 AND et>=hbt THEN
		ADDY (et-hbt)/2: vv=eh
	ENDIF

	if hbh-rh > frh then
		ROTX 90
		PRISM_ 10, -hbt,
			0, 0, 15,
			a, 0, 15,
			a, hbh-vv, 15,
			0, hbh-vv, 15,
			0, 0, -1,
			fw, frh, 15,
			a-fw, frh, 15,
			a-fw, hbh-rh, 15,
			fw, hbh-rh, 15,
			fw, frh, -1
		DEL 1
		gosub 2000

		ii=INT((a-2*fw)/0.08)
		ADD fw, hbt/2-0.0075, frh
		FOR i=1 TO ii-1
			ADDX ((a-2*fw)/ii)*i
			ADDX -0.0075
			BLOCK 0.015, 0.015, hbh-rh-frh
			gosub 1000
			DEl 2
		NEXT i
		DEl 1
	endif

	IF et>0 AND eh>0 AND et>=hbt THEN
		DEL 1
		ADDZ hbh-eh
		BLOCK a, et, eh: DEL 1
		gosub 2000
	ENDIF
ENDIF



IF hboard_type_m=3 AND gs_detlevel_3D_m=2  THEN
	RESOL gs_resol
	rh=0.10: fw=0.05: m=SQR((a/2)^2+rh^2)
	alpha=ATN((a/2)/rh): r=m/2/COS(alpha)
	rh2=SQR(rh^2-fw^2): vv=0

	IF et>0 AND eh>0 AND et>=hbt THEN
		ADDY (et-hbt)/2: vv=eh
	ENDIF

	if hbh-rh-rh2 > frh then
		ROTX 90
		PRISM_ 14, -hbt,
			0, 0, 15,
			a, 0, 15,
			a, hbh-rh-0.0001-vv, 15,
			a, hbh-rh-vv, 77,
			a/2, hbh-r-vv, 913,
			0, hbh-rh-vv, 3013,
			0, hbh-rh-0.0001-vv, 15,
			0, 0, -1,
			fw, frh, 15,
			a-fw, frh, 15,
			a-fw, hbh-rh-rh2, 13,
			a/2, hbh-r, 913,
			fw, hbh-rh-rh2, 3015,
			fw, frh, -1
		DEL 1
		gosub 2000

		ii=INT((a-2*fw)/0.08)
		ADD fw, hbt/2-0.0075, frh
		FOR i=1 TO ii-1
			ADDX ((a-2*fw)/ii)*i
			ADDX -0.0075
			BLOCK 0.015, 0.015, hbh-rh-frh
			gosub 1000
			DEl 2
		NEXT i
		DEl 1
	endif

	IF et>0 AND eh>0 AND et>=hbt THEN
		DEL 1
		ROTX 90

		PRISM_ 9, -et,
			a, hbh-rh-eh, 79,
			a/2, hbh-r-eh, 913,
			0, hbh-rh-eh, 3015,
			0, hbh-rh-0.0001, 15,
			0, hbh-rh, 79,
			a/2, hbh-r, 913,
			a, hbh-rh, 3015,
			a, hbh-rh-eh+0.0001, 15,
			a, hbh-rh-eh, -1
		gosub 2000
		DEL 1
	ENDIF
ENDIF



END

!---------------->!!! RETURN !!!<----------------
100:
	ROTX 90
	PRISM_ 7, -hbt,
		0, 0, 15,
		a, 0, 15,
		a, hbh-rh-vv-0.0001, 15,
		a, hbh-rh-vv, 79,
		a/2, hbh-r-vv, 913,
		0, hbh-rh-vv, 3015,
		0, 0, -1
	DEL 1
RETURN


END


1000:

roty 90
vert 0, 0, 0
vert 1, 0, 0
vert 0, 1, 0
vert 0, 0, 1
del 1

coor 2, -1, -2, -3, -4

base

body -1

return



2000:

vert 0, 0, 0
vert 1, 0, 0
vert 0, 1, 0
vert 0, 0, 1

coor 2, -1, -2, -3, -4

base

body -1

return






