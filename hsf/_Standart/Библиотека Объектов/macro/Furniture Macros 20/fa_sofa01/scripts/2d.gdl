
PEN gs_cont_pen

! ======================================================================
! SCALE
! ======================================================================
call "2dDetailLevel" parameters gs_detlevel_2D_m = gs_detlevel_2D_m,
				returned_parameters det2D

!!! ******************************** 2D SYMBOL


if det2D = 1 then			!! 1/200
	CALL "fa_SofaSymbol" PARAMETERS ALL iSofaSymbolType = 1, gs_hotspotUnIdBegin = gs_hotspotUnIdBegin, MSType = 0, calledAsMacro = 1
else
	if det2D = 2 then		!! 1/100
		CALL "fa_SofaSymbol" PARAMETERS ALL iSofaSymbolType=4, gs_hotspotUnIdBegin = gs_hotspotUnIdBegin, MSType = 0, calledAsMacro = 1
	else
		if det2D = 4 then 	!! Custom
			  CALL "fa_SofaSymbol" PARAMETERS ALL gs_hotspotUnIdBegin = gs_hotspotUnIdBegin, MSType = 0, calledAsMacro = 1
		endif
	endif
endif


!!!! ******************************** 1/50
IF det2D = 3 THEN

!!!! *** Minimal Space and Hotspots

CALL "fa_SofaSymbol" PARAMETERS ALL iSofaSymbolType=0, MSType = 0, calledAsMacro = 1

!!!! *** Symbol

IF gs_SeatNum_m=3 THEN i=3
IF gs_SeatNum_m=2 THEN i=2
IF gs_SeatNum_m=1 OR gs_2DSeat=0 THEN i=1

IF a<0.50 THEN PARAMETERS a=0.50
yyy=zzyzx-0.0342-gs_seat_height+0.0875
IF b<yyy/TAN(75)+0.2672 THEN PARAMETERS b=yyy/TAN(75)+0.2672

!! *** Symbol Lines

ADD2 0.15, 0
	FOR ii=1 TO i
		ADD2 (a-0.30)/i*(ii-1), 0
		POLY2_ 9, 1,
			(a-0.30)/i-0.03, 0, 1,
			0.03, 0, 1,
			0, 0.03, 1001,
			0, b-yyy/TAN(75)-0.1972, 1,
			0.03, b-yyy/TAN(75)-0.1672, 1001,
			(a-0.30)/i-0.03, b-yyy/TAN(75)-0.1672, 1,
			(a-0.30)/i, b-yyy/TAN(75)-0.1972, 1001,
			(a-0.30)/i, 0.03, 1,
			(a-0.30)/i-0.03, 0, 1001
		POLY2_ 9, 1,
			(a-0.30)/i-0.03, b-0.04, 1,
			0.03, b-0.04, 1,
			0, b-0.07, 1001,
			0, b-yyy/TAN(75)-0.1372, 1,
			0.03, b-yyy/TAN(75)-0.1672, 1001,
			(a-0.30)/i-0.03, b-yyy/TAN(75)-0.1672, 1,
			(a-0.30)/i, b-yyy/TAN(75)-0.1372, 1001,
			(a-0.30)/i, b-0.07, 1,
			(a-0.30)/i-0.03, b-0.04, 1001
		POLY2_ 5, 1,
			0, b-0.15, 1,
			0.03, b-0.15, 901,
			0.03, b-0.18, 3001,
			(a-0.30)/i-0.03, b-0.18, 1,
			(a-0.30)/i, b-0.15, 1001
		DEL 1
	NEXT ii
DEL 1

	FOR i=1 TO 2
		ADD2 (a-0.15)*(i-1), 0
		POLY2_ 9, 1,
			0.13, 0, 1,
			0.02, 0, 1,
			0, 0.02, 1001,
			0, b-0.02, 1,
			0.02, b, 1001,
			0.13, b, 1,
			0.15, b-0.02, 1001,
			0.15, 0.02, 1,
			0.13, 0, 1001
		DEL 1
	NEXT i


LINE2 0.15, b-0.02, a-0.15, b-0.02

IF gs_SeatNum_m=3 THEN i=3
IF gs_SeatNum_m=2 THEN i=2
IF gs_SeatNum_m=1 OR gs_2DSeat=0 THEN i=1

!!! *** Background Fill
	FILL gs_fill_type

	ADD2 0.15, 0
		FOR ii=1 TO i
		ADD2 (a-0.30)/i*(ii-1), 0

			POLY2_B 7, 2+64, gs_fill_pen, gs_back_pen,
				(a-0.30)/i-0.03, 0, 1,
				0.03, 0, 1,
				0, 0.03, 1001,
				0, b-yyy/TAN(75)-0.1672, 1,
				(a-0.30)/i, b-yyy/TAN(75)-0.1672, 1,
				(a-0.30)/i, 0.03, 1,
				(a-0.30)/i-0.03, 0, 1001

			POLY2_B 5, 2+64, gs_fill_pen, gs_back_pen,
				(a-0.30)/i, b-0.02, 1,
				0, b-0.02, 1,
				0, b-yyy/TAN(75)-0.1672, 1,
				(a-0.30)/i, b-yyy/TAN(75)-0.1672, 1,
				(a-0.30)/i, b-0.02, 1

		DEL 1
		NEXT ii
	DEL 1


		FOR i=1 TO 2
		ADD2 (a-0.15)*(i-1), 0
			POLY2_B 9, 2+64, gs_fill_pen, gs_back_pen,
				0.13, 0, 1,
				0.02, 0, 1,
				0, 0.02, 1001,
				0, b-0.02, 1,
				0.02, b, 1001,
				0.13, b, 1,
				0.15, b-0.02, 1001,
				0.15, 0.02, 1,
				0.13, 0, 1001
		DEL 1
		NEXT i

ENDIF




