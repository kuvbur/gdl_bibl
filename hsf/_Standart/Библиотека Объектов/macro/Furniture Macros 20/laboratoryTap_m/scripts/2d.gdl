
unID = start_unID

if TapSymbol_m = DET2D_NONE then end
pen gs_cont_pen
line_type 1
fill gs_fill_type

drawindex 30

if tapID = 1 then
	hotspot2 0,				0,	unID, tapOffset1, 1 + 128:		unID = unID + 1
	hotspot2 -1,			0,	unID, tapOffset1, 3:			unID = unID + 1
	hotspot2 tapOffset1,	0,	unID, tapOffset1, 2:			unID = unID + 1

	add2 tapOffset1, 0
else
	hotspot2 0,				0,	unID, tapOffset2, 1 + 128:		unID = unID + 1
	hotspot2 -1,			0,	unID, tapOffset2, 3:			unID = unID + 1
	hotspot2 tapOffset2,	0,	unID, tapOffset2, 2:			unID = unID + 1

	add2 tapOffset2, 0
endif

	gosub "tap"
del 1

!================================================================================
end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! end
!================================================================================

! ======================================================================
"tap":
! ======================================================================

	if TapSymbol_m = DET2D_DETAILED then
		if gs_tap_type_m = 1 then
			poly2_b 5, 1+2+4+64, gs_fill_pen, gs_back_pen,
				tapDia / 2, tapDia / 2, 1,
				tapDia / 2, -neckDepth, 1,
				0, -1, 800,
				-tapDia / 2, -neckDepth, 1001,
				-tapDia / 2, tapDia / 2, 1
		endif

		for i = 1 to 2
			poly2_b 11, 1+2+4+64, gs_fill_pen, gs_back_pen,
				tapDia / 2 * (gs_tap_type_m = 1), tapDia / 2, 1,
				tapWidth / 2 - 0.05, tapDia / 2, 1,
				1, 0, 800,
				tapWidth / 2 + tapDia / 2, -0.05, 1001,
				tapWidth / 2 + tapDia / 2, -tapDepth, 1,
				0, -1, 800,
				tapWidth / 2 - tapDia / 2, -tapDepth, 1001,
				tapWidth / 2 - tapDia / 2, -0.05, 1,
				0, 1, 800,
				tapWidth / 2 - 0.05, -tapDia / 2, 1001,
				tapDia / 2 * (gs_tap_type_m = 1), -tapDia / 2, (gs_tap_type_m = 1)
	
			mul2 -1, 1
		next i
		del 2
	else
		if gs_tap_type_m = 1 then
			poly2_b 4, 1+2+4+64, gs_fill_pen, gs_back_pen,
				tapDia / 2, tapDia / 2, 1,
				tapDia / 2, -neckDepth - tapDia / 2, 1,
				-tapDia / 2, -neckDepth - tapDia / 2, 1,
				-tapDia / 2, tapDia / 2, 1
		endif

		for i = 1 to 2
			poly2_b 6, 1+2+4+64, gs_fill_pen, gs_back_pen,
				tapDia / 2 * (gs_tap_type_m = 1), tapDia / 2, 1,
				tapWidth / 2 + tapDia / 2, tapDia / 2, 1,
				tapWidth / 2 + tapDia / 2, -tapDepth - tapDia / 2, 1,
				tapWidth / 2 - tapDia / 2, -tapDepth - tapDia / 2, 1,
				tapWidth / 2 - tapDia / 2, -tapDia / 2, 1,
				tapDia / 2 * (gs_tap_type_m = 1), -tapDia / 2, (gs_tap_type_m = 1)
	
			mul2 -1, 1
		next i
		del 2
	endif

return
