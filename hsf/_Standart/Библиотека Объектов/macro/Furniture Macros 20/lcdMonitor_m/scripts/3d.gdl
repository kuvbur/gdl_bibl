
if gs_detlevel_3D_m = 0 then end

if NOT(gs_shadow) then shadow off

if GLOB_CONTEXT > 20 and GLOB_CONTEXT < 40 or gs_detlevel_3D_m = 1 then 		!! for Simple Model and in 3D Windoow
	if GLOB_CONTEXT > 20 and GLOB_CONTEXT < 40 then
		iResol = 3
	else
		iResol = 8
	endif
else
	iResol = gs_resol
endif

resol iResol

if iMonitorType = 1 then

	frameThickness = 0.015
	bottomFrameThickness = 0.015
	tp = zzyzx/7
	unID = 1

	if NOT(bPartOfLayout) then

		HOTSPOT A, 0, 0, unID :unID=unID+1
		HOTSPOT A, B, 0, unID :unID=unID+1
		HOTSPOT 0, B, 0, unID :unID=unID+1
		HOTSPOT 0, 0, 0, unID :unID=unID+1

		HOTSPOT A, 0, zzyzx, unID :unID=unID+1
		HOTSPOT A, B, zzyzx, unID :unID=unID+1
		HOTSPOT 0, B, zzyzx, unID :unID=unID+1
		HOTSPOT 0, 0, zzyzx, unID :unID=unID+1

        if iScreenRatio <> SCREEN_CUST & iScreenSize = 8 then           ! Custom Screen Diagonal Preset
            add 0, b/2-frameThickness, zzyzx/5
            rotx -5
            
            HOTSPOT frameThickness, 	0, bottomFrameThickness, 	unID, screenSize, 1+128 	:unID=unID+1
            HOTSPOT 0, 					0, bottomFrameThickness,	unID, screenSize, 3+128 	:unID=unID+1
            HOTSPOT A-frameThickness, 	0, zzyzx-tp, 				unID, screenSize, 2 		:unID=unID+1

            del 2
        endif
	endif

	DEFINE MATERIAL "pictmat" 2,
		1,1,1

	MATERIAL "pictmat"

	if gs_detlevel_3D_m = 0 then end
	IF gs_detlevel_3D_m = 1 then gs_resol=3

	IF gs_shadow=0 THEN SHADOW OFF

	DEFINE MATERIAL "ooo" 20,
				 1,          1,          1,
		 0.86,  0.81,  0.09,     0,    2.2,     0,
		  0.990005,   0.990005,          1,
				 0,          0,          0,
				 0,     0,    -1,
		0

	pen gs_cont_pen

	material box_mat
	add 0,b/2-.015,zzyzx/7

	rotx 85
	cutform 5, 1, 1,
		0, 0, 1, -0.005,
		0.015, 0.015, 1 + 2 + 4 + 8 + 16,
		a-0.015, 0.015, 1 + 2 + 4 + 8 + 16,
		a-0.015, zzyzx*6/7-0.015, 1 + 2 + 4 + 8 + 16,
		0.015, zzyzx*6/7-0.015, 1 + 2 + 4 + 8 + 16,
		0.015, 0.015, -1
	del 1

	rotx -5
	prism_ 5,zzyzx*6/7,
			0,0,15,
			a,0,15,
			a,.03,15,
			0,.03,15,
			0,0,-1

	cutend

	rotx 90
	if pic=1 then
		material "ooo"
		add 0.015, 0.015,0

		if gs_picture_custom=0 then
			picture "pc_desktop", a-.03,zzyzx*6/7-2*0.015,0
		else
			If gs_picture_name <> "" Then
				picture gs_picture_name, a-.03,zzyzx*6/7-2*0.015, 0
			Else
				picture "pc_desktop", a-.03,zzyzx*6/7-2*0.015,0
			Endif
		endif

		del 1
	else
		!!MATERIAL  "gls"
		MATERIAL dispmat
		prism_ 	5,     0,
				0.015, 0.015, 15,
				a-0.015, 0.015, 15,
				a-0.015, zzyzx*6/7-0.015, 15,
				0.015, zzyzx*6/7-0.015, 15,
				0.015, 0.015, -1
	endif

	del 1

	material feetmat
	add a-.15,-.002,.003

	for i=1 to 4
		prism_	5,     0.004,
				0,0,15,
				0.025,0,15,
				0.025,0.02,15,
				0,0.02,15,
				0,0,-1

		addx 0.035
	next i

	del 5

	del 2

	material feetmat

	add a/4,0,0

	prism_	5,.01,
			0,0,15,
			a/2,0,15,
			a/2,b,15,
			0,b,15,
			0,0,-1

	del 1

	add 0,b/2+.015,zzyzx*2/7-0.015

	rotx -95
	rotz -90

	HPRISM_ feetmat,feetmat,feetmat,0,4,.0315,0,.0315,1,
			0,.025,79,
			zzyzx*5/7,.025,79,
			zzyzx*5/7,a-.025,79,
			0,a-.025,79
	del 3

	add a/2-(a/12),b/2+.028,zzyzx*2/7-.008-0.015
	roty 90

	cylind a/6,.015
	del 2

	add a/2-(a/12),b-.02,0
	rotx  atn((b/2-2*0.015)/(zzyzx*2/7))     !20
	prism_ 5,SQR((b/2-2*0.015)^2+(zzyzx*2/7-2*.015)^2),
			0,0,15,
			a/6,0,15,
			a/6,.02,15,
			0,.02,15,
			0,0,-1
	del 2
endif

if iMonitorType = 2 then

	resol gs_resol * (gs_detlevel_3D_m = 2) + 8 * (gs_detlevel_3D_m = 1)
	PEN gs_cont_pen

	!! DEFINE MATERIALS !!
	define empty_fill "emptyFill"

	if gs_picture_custom and gs_picture_name <> "" then
		define texture "custDesktop" gs_picture_name, screenSizeX, screenSizeY, 0, 0
		define material "custDesktop" 20,
			0.8, 0.8, 0.8,
			0.58, 0.85, 0.2, 0,
			50,
			0,
			0.878401, 0.513481, 0.412253,
			0, 0, 0,
			0,
			ind(fill, "emptyFill"), 1,
			ind(texture, "custDesktop")
	else
		define texture "pcDesktop" "pc_desktop", screenSizeX, screenSizeY, 0, 0
		file_dependence "pc_desktop"
		define material "pcDesktop" 20,
			0.8, 0.8, 0.8,
			0.58, 0.85, 0.2, 0,
			50,
			0,
			0.878401, 0.513481, 0.412253,
			0, 0, 0,
			0,
			ind(fill, "emptyFill"), 1,
			ind(texture, "pcDesktop")
	endif

	define material "buttons" 20,
		0.1, 0.1, 0.1,
		0.6, 0.95, 1, 0, 5, 0,
		1, 1, 1,
		0, 0, 0,
		0, 0, 1,
		0

	!! END OF DEFINE MATERIALS !!

	add a/2, b/2, 0

	add 0, 0, standHeight
	rotx 90-displayAng
	add 0, -standCutRad+backPanelThk+0.01, displayThk+middlePanelThk+backPanelThk/2

	group "display"
		!!! Display
		add 0, 0, -displayThk
		material frameMat
		prism_ 10, displayThk,
			-displayWidth/2, 0, 15,
			displayWidth/2, 0, 15,
			displayWidth/2, displayHeight, 15,
			-displayWidth/2, displayHeight, 15,
			-displayWidth/2, 0, -1,

			-screenSizeX/2, screenFrameWidthBottom, 15,
			screenSizeX/2, screenFrameWidthBottom, 15,
			screenSizeX/2, screenSizeY+screenFrameWidthBottom, 15,
			-screenSizeX/2, screenSizeY+screenFrameWidthBottom, 15,
			-screenSizeX/2, screenFrameWidthBottom, -1
		del 1
	endgroup

	group "screen"
		!!! Screen
		add 0, screenFrameWidthBottom, -displayThk
		if pic then
			if gs_picture_custom and gs_picture_name <> "" then
				material "custDesktop"
			else
				material "pcdesktop"
			endif
		else
			material screenMat
		endif
		prism_ 4, screenThk+(GLOB_CONTEXT=5)*0.01,
			-screenSizeX/2, 0, 15,
			screenSizeX/2, 0, 15,
			screenSizeX/2, screenSizeY, 15,
			-screenSizeX/2, screenSizeY, 15
		del 1
		base
		muly 1
		add -screenSizeX/2, screenFrameWidthBottom, 0
		vert 0, 0, 0
		vert 1, 0, 0
		vert 0, 1, 0
		vert 0, 0, 1
		coor 2+256, -1, -2, -3, -4
		body 1
		del 2
	endgroup

	group "middlepanel"
		!!! Middle Panel
		add 0, 0, -displayThk-middlePanelThk
		material frameMat
		prism_ 5, middlePanelThk,
			-displayWidth/2, 0, 15,
			displayWidth/2, 0, 15,
			displayWidth/2, displayHeight, 15,
			-displayWidth/2, displayHeight, 15,
			-displayWidth/2, 0, -1
		del 1
	endgroup

	group "backpanel"
		!!! Back Panel
		add 0, 0, -displayThk-middlePanelThk-backPanelThk
		material frameMat
		prism_ 5, backPanelThk,
			-displayWidth/2, 0, 15,
			displayWidth/2, 0, 15,
			displayWidth/2, displayHeight, 15,
			-displayWidth/2, displayHeight, 15,
			-displayWidth/2, 0, -1
		del 1
	endgroup

	group "backTopArchCut"
		ress = (512 * (gs_detlevel_3D_m = 2) + 8 * (gs_detlevel_3D_m = 1)) / 360 * gamma
		ress = min(1, int(ress + 0.5))		!round and guard against div0
		beta = gamma / ress

		alpha=delta
		for ii=1 to ress
			put -cos(delta)*backTopArchCutRad+backTopArchCutRad*cos(alpha), -sin(delta)*backTopArchCutRad+backTopArchCutRad*sin(alpha), 0, 0
			alpha=alpha-beta
		next ii

		add -displayWidth/2, backTopArchCutYpos, -displayThk-middlePanelThk-backPanelThk
		rotz 90
		material frameMat
		tube 5, ress+3, 1+2+16+32,
			1, backTopArchCuThk, 0,
			backTopArchCutWidth, backTopArchCuThk, 0,
			-1, 0, 800,
			0, 0, 1000,
			1, 0, 0,

			-cos(delta)*backTopArchCutRad+backTopArchCutRad*cos(delta), -sin(delta+beta)*backTopArchCutRad+backTopArchCutRad*sin(delta+beta), 0, 0,
			get ((ress)*4),
			-cos(delta)*backTopArchCutRad+backTopArchCutRad*cos(alpha), -sin(delta)*backTopArchCutRad+backTopArchCutRad*sin(alpha), 0, 0,
			-cos(delta)*backTopArchCutRad+backTopArchCutRad*cos(alpha-beta), -sin(delta)*backTopArchCutRad+backTopArchCutRad*sin(alpha-beta), 0, 0
		del 2
	endgroup

	group "standcut"
		add 0, 0, -displayThk-middlePanelThk-backPanelThk
		material frameMat
		prism_ 6, backPanelThk,
			-standCutWidth/2, 0, 79,
			0, 1, 800,
			-standCutWidth/2+standCutRad, standCutRad, 1079,
			standCutWidth/2-standCutRad, standCutRad, 79,
			1, 0, 800,
			standCutWidth/2, 0, 1079
		del 1
	endgroup

	group "standbox"
		add -standBoxWidth/2, standCutRad-backPanelThk-0.01, -displayThk-middlePanelThk
		roty 90
		material frameMat
		prism_ 4, standBoxWidth,
			0, 0, 15,
			0, backPanelThk, 79,
			1, 0, 800,
			backPanelThk, 0, 1079
		del 2
	endgroup

	group "buttons"
		material "buttons"
		!!! Buttons
		resol 128 * (gs_detlevel_3D_m = 2) + 32 * (gs_detlevel_3D_m = 1)
		add 0, -bottomDisplayArchCutHeight2/2, -displayThk/2
		cutpolya 8, 1, 0,
			-displayWidth/2, -10, 15,
			-displayWidth/2, bottomDisplayArchCutHeight1, 15,
			1, 0, 800,
			-displayWidth*0.25, (bottomDisplayArchCutHeight1-bottomDisplayArchCutHeight2)/2+bottomDisplayArchCutHeight2, 1015,
			0, bottomDisplayArchCutHeight2, 1015,
			displayWidth*0.25, (bottomDisplayArchCutHeight1-bottomDisplayArchCutHeight2)/2+bottomDisplayArchCutHeight2, 1015,
			displayWidth/2, bottomDisplayArchCutHeight1, 1015,
			displayWidth/2, -10, 15
		del 1

		add 0, 0, -displayThk/2
		cutpolya 8, 1, 0,
			-displayWidth/2, 10, 15,
			-displayWidth/2, bottomDisplayArchCutHeight1, 15,
			1, 0, 800,
			-displayWidth*0.25, (bottomDisplayArchCutHeight1-bottomDisplayArchCutHeight2)/2+bottomDisplayArchCutHeight2, 1015,
			0, bottomDisplayArchCutHeight2, 1015,
			displayWidth*0.25, (bottomDisplayArchCutHeight1-bottomDisplayArchCutHeight2)/2+bottomDisplayArchCutHeight2, 1015,
			displayWidth/2, bottomDisplayArchCutHeight1, 1015,
			displayWidth/2, 10, 15
		del 1

		add 0, 0, -displayThk / 2
		for bt = 1 to 5
			prism_ 4, displayThk,
				displayWidth / 4, (bottomDisplayArchCutHeight1 + bottomDisplayArchCutHeight2) / 2, 15,
				displayWidth / 2, bottomDisplayArchCutHeight1 - bottomDisplayArchCutRad, 900,
				0, -buttonAngle, 4015,
				displayWidth / 2, bottomDisplayArchCutHeight1  - bottomDisplayArchCutRad, 15

			add displayWidth  / 2, bottomDisplayArchCutHeight1 - bottomDisplayArchCutRad, 0
			rotz -buttonAngle - buttonSpaceAngle
			add -displayWidth / 2, -bottomDisplayArchCutHeight1  + bottomDisplayArchCutRad, 0
		next bt
		del 5*3
		del 1

		cutend
		cutend
	endgroup



	!!! Bottom Arch Cut Display
	resol 128 * (gs_detlevel_3D_m = 2) + 32 * (gs_detlevel_3D_m = 1)
	add 0, 0, -displayThk/2
	cutform 8, 1, 1+16,
		0, 0, -1, 0,
		-displayWidth/2, -10, 1+2+4+8+16+64,
		-displayWidth/2, bottomDisplayArchCutHeight1, 1+2+4+8+16+64,
		1, 0, 800,
		-displayWidth*0.25, (bottomDisplayArchCutHeight1-bottomDisplayArchCutHeight2)/2+bottomDisplayArchCutHeight2, 1001+2+4+8+16+64,
		0, bottomDisplayArchCutHeight2, 1001+2+4+8+16+64,
		displayWidth*0.25, (bottomDisplayArchCutHeight1-bottomDisplayArchCutHeight2)/2+bottomDisplayArchCutHeight2, 1001+2+4+8+16+64,
		displayWidth/2, bottomDisplayArchCutHeight1, 1001+2+4+8+16+64,
		displayWidth/2, -10, 15
	del 1

	!!! Bottom Arch Cut
	resol 128 * (gs_detlevel_3D_m = 2) + 32 * (gs_detlevel_3D_m = 1)
	add 0, 0, -displayThk-middlePanelThk-backPanelThk
	cutpolya 6, 1, 0,
		0, bottomArchCutRad, 979,
		-displayWidth/2, bottomArchCutHeight, 79,
		0, 0, 3079,
		displayWidth/2, bottomArchCutHeight, 3079,
		displayWidth/2, -10, 15,
		-displayWidth/2, -10, 15
	del 1

	!!! Side Arch Cut
	resol 128 * (gs_detlevel_3D_m = 2) + 32 * (gs_detlevel_3D_m = 1)
	add -displayWidth/2, 0, -displayThk
	for ix=1 to 2
		roty 90
		rotx 90
		cutpolya 6, 1, 0,
			0, 0, 79,
			1, 0, 800,
			sideArchCutWidth, sideArchCutHeight, 1015,
			sideArchCutWidth, -0.1, 15,
			0, -0.1, 15,
			0, 0, 15
		del 2
	addx displayWidth
	mulx -1
	next ix
	del 4
	del 1

	resol 128 * (gs_detlevel_3D_m = 2) + 32 * (gs_detlevel_3D_m = 1)
	add -displayWidth/2, bottomArchCutHeight, -displayThk
	for iy=1 to 2
		roty 90
		cutpolya 6, 1, 0,
			0, 0, 79,
			1, 0, 800,
			sideArchCutWidth, sideArchCutHeight, 1015,
			sideArchCutWidth, -0.1, 15,
			0, -0.1, 15,
			0, 0, 15
		del 1
	addy displayHeight-bottomArchCutHeight
	muly -1
	next iy
	del 4
	del 1

	!!! Back Arch Cut
	resol 128 * (gs_detlevel_3D_m = 2) + 8 * (gs_detlevel_3D_m = 1)
	add 0, 0, -displayThk-middlePanelThk-backPanelThk
	rotx 90
	cutpolya 6, 1, 0,
		0, backArchCutRad, 979,
		-displayWidth/2, backArchCutHeight, 79,
		0, 0, 3079,
		displayWidth/2, backArchCutHeight, 3079,
		displayWidth/2, -10, 15,
		-displayWidth/2, -10, 15
	del 2



	placegroup "screen"
	placegroup "display"
	placegroup "middlepanel"
	placegroup subgroup(subgroup("backpanel", "standcut"), "backTopArchCut")

	cutend
	cutend
	cutend
	cutend
	cutend
	cutend
	cutend

	placegroup "standbox"
	placegroup "buttons"

	del 3



	group "stand"
		material standMat
		resol gs_resol * (gs_detlevel_3D_m = 2) + 8 * (gs_detlevel_3D_m = 1)

		add 0, 0, 0
		mulx 1.5
		roty -90
		revolve 6, 360, 1+2,
			0, standRadBottom, 0,
			0.005, standRadBottom, 1,
			0.005, standRadTop+standRadBottom*0.4, 1,
			0, -1, 801,
			0.005+standRadBottom*0.4, standRadTop, 1001,
			standHeight+0.01, standRadTop, 1
	endgroup

	placegroup "stand"

	del 1

	end

endif




