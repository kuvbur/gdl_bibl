
EPS = 0.0001

CABINET				= 0
SIMPLE_DESK			= 1
LAYOUT_ISLAND		= 2
LAYOUT_LINEAR		= 3
WS_SOLO				= 4

dim stDetlevel3D[3]
	stDetlevel3D[1] = `Простой`
	stDetlevel3D[2] = `Детальный`
	stDetlevel3D[3] = `Откл.`

dim stDetlevel3D[3]
	stDetlevel3D[1] = `Простой`
	stDetlevel3D[2] = `Детальный`
	stDetlevel3D[3] = `Откл.`

dim	stInnerEdge[2]
	stInnerEdge[1] = `Прямой`
	stInnerEdge[2] = `Скругленный`

dim stTableTopTypes[11]
	stTableTopTypes[1]	= `L-образная`
	stTableTopTypes[2]	= `Прямой`
	stTableTopTypes[3]	= `360`
	stTableTopTypes[4]	= `180`
	stTableTopTypes[5]	= `135`
	stTableTopTypes[6]	= `90`
	stTableTopTypes[7]	= `60`
	stTableTopTypes[8]	= `45`
	stTableTopTypes[9]	= `С-образная`
	stTableTopTypes[10]	= `Р-образная`
	stTableTopTypes[11]	= `Прямоугольный`

TTOP_L_SHAPED		= 1
TTOP_STRAIGHT		= 2
TTOP_ARCHED_360		= 3
TTOP_ARCHED_180		= 4
TTOP_ARCHED_135		= 5
TTOP_ARCHED_90		= 6
TTOP_ARCHED_60		= 7
TTOP_ARCHED_45		= 8
TTOP_ARCHED_C_TOP	= 9
TTOP_ARCHED_P_TOP	= 10
TTOP_RECT			= 11

STRAIGHT			= 1
ROUNDED				= 2

archedTableTop		= (iTableTopType > TTOP_STRAIGHT and iTableTopType < TTOP_RECT)

! ======================================================================
! L-Shaped Tabletop
! ======================================================================

if iTableTopType = TTOP_L_SHAPED and NOT(bCalledAsExtension) then
	xPosSideCorner	= tableLength2 * COS(180 - tableTopAngle)
	yPosSideCorner	= tableLength2 * SIN(180 - tableTopAngle)

	xPosTopCorner	= tableDepth2 * COS(tableTopAngle - 90) - tableLength2 * COS(180 - tableTopAngle)
	yPosTopCorner	= tableDepth2 * SIN(tableTopAngle - 90) + tableLength2 * SIN(180 - tableTopAngle)

	xPosAngleEnd	= tableDepth2 * SIN(180 - tableTopAngle) - innerArcEndPos * COS(180 - tableTopAngle)
	yPosAngleEnd	= tableDepth2 * COS(180 - tableTopAngle) + innerArcEndPos * SIN(180 - tableTopAngle)

	alpha			= ATN(COS(tableTopAngle - 90) / (tableDepth1 / tableDepth2 - SIN(tableTopAngle - 90)))
	beta			= tableTopAngle - 90 - alpha

	topCornerDist	= SQR(xPosTopCorner ** 2 + yPosTopCorner ** 2)
	teta			= ASN(yPosTopCorner / topCornerDist)
	if xPosTopCorner > EPS then
		gamma		= tableTopAngle - teta
	else
		gamma		= teta - (180 - tableTopAngle)
	endif
endif
if iTableTopType = TTOP_STRAIGHT and bCalledAsExtension then
	tableLength1	= extraDeskWidth
	tableDepth1		= extraDeskDepth
endif

! ======================================================================
! Arched Tabletop
! ======================================================================

if archedTableTop then
	if iTableTopType = TTOP_ARCHED_360 then tableTopAngle = 300
	if iTableTopType = TTOP_ARCHED_180 then tableTopAngle = 180
	if iTableTopType = TTOP_ARCHED_135 then tableTopAngle = 135
	if iTableTopType = TTOP_ARCHED_90 then tableTopAngle = 90
	if iTableTopType = TTOP_ARCHED_60 then tableTopAngle = 60
	if iTableTopType = TTOP_ARCHED_45 then tableTopAngle = 45

	if iTableTopType = TTOP_ARCHED_C_TOP then tableTopAngle = 270
	if iTableTopType = TTOP_ARCHED_P_TOP then tableTopAngle = 270

	tt		= SQR((b + MSFront) ** 2 - b ** 2)
	yb		= b * SIN(270 - tableTopAngle)
	xb		= b * COS(270 - tableTopAngle)

	hur 	= b * SIN(60)
	szelo	= SQR((b + MSFront) ** 2 - hur ** 2)
	teta	= ATN(hur / szelo)
	gamma	= 360 - (90 - teta) * 2
endif

