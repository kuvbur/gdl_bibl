
reqBTaps = 0
success = LIBRARYGLOBAL ("LibraryGlobals13", "hideBTaps", reqBTaps)
if success > 0 and reqBTaps and GLOB_CONTEXT <> 5 then
	end xShowerPos,
		GS_HotspotUnIDBegin
endif

unID = GS_HotspotUnIDBegin

if gs_detlevel_3D_m = 0 | gs_tap_type_m = 0 then
	end xShowerPos,
		GS_HotspotUnIDBegin
endif

if not(gs_shadow) then SHADOW OFF

	define material	"builtInMatSemitransBlackPlastic" 0,
	  0.333333,   0.313725,   0.294118,
	  0.3,  0.35,  0.96,   0.3,     32,     0,
	         1,          1,          1,
	         0,          0,          0,     0

PEN gs_cont_pen
MATERIAL gs_tap_mat
matShower = gs_tap_mat

maskSection	= 4 * (GLOB_CONTEXT = 4)

if GLOB_CONTEXT > 20 and GLOB_CONTEXT < 40 or gs_detlevel_3D_m = 1 then
	gs_resol = 8 * bWallMountedTap + 4 * NOT(bWallMountedTap)
else
	gs_resol = gs_resol
endif

if bEnableTapEdit then
	if bWallMountedTap then
		hotspot xTapPos, 0, 0, unID, zTapPos, 1+128 : unID=unID+1
		hotspot xTapPos, 0, zTapPos, unID, zTapPos, 2 : unID=unID+1
		hotspot xTapPos, 0, -1, unID, zTapPos, 3 : unID=unID+1
	else
		hotspot xTapPos, 0, 		0, unID, yTapPos, 1+128 : unID=unID+1
		hotspot xTapPos, yTapPos, 	0, unID, yTapPos, 2 : unID=unID+1
		hotspot xTapPos, -1, 		0, unID, yTapPos, 3 : unID=unID+1
	endif

	hotspot 0,       yTapPos, zTapPos, unID, xTapPos, 1+128 : unID=unID+1
	hotspot xTapPos, yTapPos, zTapPos, unID, xTapPos, 2 : unID=unID+1
	hotspot -1,      yTapPos, zTapPos, unID, xTapPos, 3 : unID=unID+1
endif

add xTapPos, yTapPos * NOT(bWallMountedTap), zTapPos * bWallMountedTap

if ((gs_detlevel_3D_m = 1 and useOldSimpleTaps) or gs_detlevel_3D_m = 2) and gs_tap_type_m <> -1 then
	gosub gs_tap_type_m * 10
else
	gosub "simple tap style"
endif

del 1

GS_HotspotUnIDBegin = unID

! ======================================================================
end xShowerPos,
	GS_HotspotUnIDBegin
! ======================================================================



! ==============================================================================
! Single Level Mixer
! ==============================================================================
10:

alfa=atn(8/42)
rz=(0.08*0.025)/0.004	!!!(top of pyramid)

RESOL gs_resol
ROTZ 90
	CONE 0.08,0.025,0.021,90,90+alfa
DEL 1

RESOL gs_resol
ADD 0,-0.103,0.035
	PRISM_       7,      0.01,
		0.009,     0.0,      79,
	   -0.0,     0.0,    900,
		0.0,     180.0,   4079,
	   -0.009,     0.0,      79,
	   -0.0,     0.0,    900,
		0.0,     180.0,   4079,
		0.009,     0.0,     -1
DEL 1

if GLOB_CONTEXT > 20 and GLOB_CONTEXT < 40 or gs_detlevel_3D_m = 1 then		!!Simple Model
	RESOL gs_resol
	RESOL gs_resol
	CUTFORM 2,2,1+8+16,
	0,0,rz,0.6,
	0,0,900+1+4+16+32,
	0.025,360,4000

	ADDZ 0.045
		PRISM_       9,      0.015,
		   -0.010912,    -0.1043883,      79,
		   -0.0238054,    -0.0030499,      79,
		   -0.0,    -0.0,    900,
			0.0,    -194.6017,   4079,
			0.0238054,    -0.0030499,      79,
			0.010912,    -0.1043883,      79,
		   -0.0,    -0.103,    900,
			0.0,    -165.4984,   4079,
		   -0.010912,    -0.1043883,     -1
		DEl 1
	CUTEND
	ADDZ 0.08
	ROTX -alfa
	PRISM_      9,      0.004,
				0.023893,    -0.001723,      79,
				0.0,    -0.0,    900,
				0.0,     188.2486,   4079,
			   -0.023893,    -0.001723,      79,
			   -0.020946,    -0.042588,      79,
			   -0.0,    -0.041082,    900,
				0.0,     171.7727,   4079,
				0.020946,    -0.042588,      79,
				0.023893,    -0.001723,     -1
	DEL 2
else											!! Detailed Model
	RESOL gs_resol
	CUTFORM 2,2,1+8+16,
	0,0,rz,0.6,
	0,0,900+1+4+16+32,
	0.025,360,4000

	ADDZ 0.045
		PRISM_       9,      0.015,
		   -0.010912,    -0.1043883,      79,
		   -0.0238054,    -0.0030499,      79,
		   -0.0,    -0.0,    900,
			0.0,    -194.6017,   4079,
			0.0238054,    -0.0030499,      79,
			0.010912,    -0.1043883,      79,
		   -0.0,    -0.103,    900,
			0.0,    -165.4984,   4079,
		   -0.010912,    -0.1043883,     -1
		DEl 1
	CUTEND

	ADDZ 0.08
	ROTX -alfa
	PRISM_      16,      0.004,
				0.023893,    -0.001723,      79,
				0.0,    -0.0,    900,
				0.0,     188.2486,   4079,
			   -0.023893,    -0.001723,      79,
			   -0.020946,    -0.042588,      79,
			   -0.0,    -0.041082,    900,
				0.0,     171.7727,   4079,
				0.020946,    -0.042588,      79,
				0.023893,    -0.001723,     -1,
				0.014,    -0.026,      15,
			   -0.014,    -0.026,      15,
			   -0.014,    -0.041082,      79,
			   -0.0,    -0.041082,    900,
				0.0,     180.0,   4079,
				0.014,    -0.041082,      79,
				0.014,    -0.026,     -1
	DEL 2
ENDIF

return


! ==============================================================================
! Two Handle Mixer
! ==============================================================================
20:


resol gs_resol

rotz -90

	cone  0.04, 0.03, 0.017, 90, 90

	addz 0.04

		cylind 0.012, 0.016

	del 1

	addz 0.052

		cone  0.01, 0.016, 0.01, 90, 90

	del 1

	addz 0.062
	rotx 90

		tube        2,    24,     16+32,
					0,  0,  901,
					0.008, 360, 4001,

					0,          -10,     0,    0,
					0.0,          0.0,          0,    0,
					0.0,          0.038953,     0,    0,
					0.002027,     0.054146,     0,    0,
					0.006187,     0.072816,     0,    0,
					0.012151,     0.08992,      0,    0,
					0.021136,     0.108412,     0,    0,
					0.032349,     0.125554,     0,    0,
					0.045556,     0.14105,      0,    0,
					0.058312,     0.152807,     0,    0,
					0.074424,     0.164609,     0,    0,
					0.089756,     0.173283,     0,    0,
					0.104663,     0.179821,     0,    0,
					0.119733,     0.184817,     0,    0,
					0.136878,     0.188566,     0,    0,
					0.155601,     0.190299,     0,    0,
					0.172754,     0.189907,     0,    0,
					0.192819,     0.187274,     0,    0,
					0.201084,     0.184132,     0,    0,
					0.206452,     0.179925,     0,    0,
					0.210523,     0.175151,     0,    0,
					0.213621,     0.169342,     0,    0,
					0.215685,     0.16432,      0,    0,
					0.223621,     -0.169342,    0,    0

	del 2


	add 0.217, 0, 0.215685
	roty -13
		cone  0.018, 0.01, 0.011, 90, 90
	del 2


	add 0, 0.02, 0.02
	rotx -70
			cone  0.04, 0.012, 0.024, 90, 90

		addz 0.04
			cone  0.006, 0.024, 0.020, 90, 90
		del 1

	del 2


	add 0, -0.02, 0.02
	rotx 70
			cone  0.04, 0.012, 0.024, 90, 90

		addz 0.04
			cone  0.006, 0.024, 0.020, 90, 90
		del 1

	del 2

del 1

return


! ==============================================================================
! Single Level Mixer
! ==============================================================================
30:

resol 1.5*gs_resol

cylind 0.01,0.0225
addz 0.010
cylind 0.045,0.0225
addz 0.045
cylind 0.045,0.0225
addz 0.045
rotz -90
addx 0.003

r1=0.026
r2=0.0225
hh=0.0045
dd=-0.003
ruled 17,4,
	cos(67.5)*r2+dd,sin(67.5)*r2,1,
	cos(90)*r2+dd,sin(90)*r2,1,
	cos(112.5)*r2+dd,sin(112.5)*r2,1,
	cos(135)*r2+dd,sin(135)*r2,1,
	cos(157.5)*r2+dd,sin(157.5)*r2,1,
	cos(180)*r2+dd,sin(180)*r2,1,
	cos(202.5)*r2+dd,sin(202.5)*r2,1,
	cos(225)*r2+dd,sin(225)*r2,1,
	cos(247.5)*r2+dd,sin(247.5)*r2,1,
	cos(270)*r2+dd,sin(270)*r2,1,
	cos(292.5)*r2+dd,sin(292.5)*r2,1,
	cos(315)*r2+dd,sin(315)*r2,1,
	cos(337.5)*r2+dd,sin(337.5)*r2,1,
	cos(0)*r2+dd,sin(0)*r2,1,
	cos(22.5)*r2+dd,sin(22.5)*r2,1,
	cos(45)*r2+dd,sin(45)*r2,1,
	cos(67.5)*r2+dd,sin(67.5)*r2,1,

	cos(67.5)*r1,sin(67.5)*r1,hh,
	cos(90)*r1,sin(90)*r1,hh,
	cos(112.5)*r1,sin(112.5)*r1,hh,
	cos(135)*r1,sin(135)*r1,hh,
	cos(157.5)*r1,sin(157.5)*r1,hh,
	cos(180)*r1,sin(180)*r1,hh,
	cos(202.5)*r1,sin(202.5)*r1,hh,
	cos(225)*r1,sin(225)*r1,hh,
	cos(247.5)*r1,sin(247.5)*r1,hh,
	cos(270)*r1,sin(270)*r1,hh,
	cos(292.5)*r1,sin(292.5)*r1,hh,
	cos(292.5)*r1,sin(292.5)*r1,hh,
	0.85*r1,0,hh,
	0.85*r1,0,hh,
	0.85*r1,0,hh,
	cos(67.5)*r1,sin(67.5)*r1,hh,
	cos(67.5)*r1,sin(67.5)*r1,hh

addz 0.003


r1=0.026
sweep 13,4,0,1,4+16+32,
	cos(67.5)*r1,sin(67.5)*r1,1,
	cos(90)*r1,sin(90)*r1,1,
	cos(112.5)*r1,sin(112.5)*r1,1,
	cos(135)*r1,sin(135)*r1,1,
	cos(157.5)*r1,sin(157.5)*r1,1,
	cos(180)*r1,sin(180)*r1,1,
	cos(202.5)*r1,sin(202.5)*r1,1,
	cos(225)*r1,sin(225)*r1,1,
	cos(247.5)*r1,sin(247.5)*r1,1,
	cos(270)*r1,sin(270)*r1,1,
	cos(292.5)*r1,sin(292.5)*r1,1,
	0.85*r1,0,1,
	cos(67.5)*r1,sin(67.5)*r1,1,

	0,0,0,
	0,0,0.005,
	0.001,0,0.010,
	0.005,0,0.017

add     0.005,0,0.017
roty 28.5

ruled 13,2+4+32,
	cos(67.5)*r1,sin(67.5)*r1,15,
	cos(90)*r1,sin(90)*r1,15,
	cos(112.5)*r1,sin(112.5)*r1,1,
	cos(135)*r1,sin(135)*r1,1,
	cos(157.5)*r1,sin(157.5)*r1,1,
	cos(180)*r1,sin(180)*r1,1,
	cos(202.5)*r1,sin(202.5)*r1,1,
	cos(225)*r1,sin(225)*r1,1,
	cos(247.5)*r1,sin(247.5)*r1,1,
	cos(270)*r1,sin(270)*r1,15,
	cos(292.5)*r1,sin(292.5)*r1,15,
	0.85*r1,0,15,
	cos(67.5)*r1,sin(67.5)*r1,1,

	0.05,0.009,0.028,
	0.05,0.01,0.030,
	0.05,0.008,0.032,
	0.05,0.006,0.0335,
	0.05,0.003,0.0345,
	0.05,0,0.035,
	0.05,-0.003,0.0345,
	0.05,-0.006,0.0335,
	0.05,-0.008,0.032,
	0.05,-0.01,0.030,
	0.05,-0.009,0.028,
	0.05,0,0.025,
	0.05,0.009,0.028

del 8

mulx 1.6

tube 2,9,2+32,
	0,0,901,
	0.01,360,4001,

	0,0,0.028,0,
	0,-0.015,0.0358,0,
	0,-0.146,0.112,0,
	0,-0.175,0.12,0,
	0,-0.202,0.12,0,
	0,-0.2027,0.1197,0,
	0,-0.203,0.119,0,
	0,-0.203,0.112,0,
	0,-0.203,0.10,0



del 1
add 0,-0.203,0.112
rotx 180


cylind 0.007,0.01

del 2

return


! ==============================================================================
! Two Handle Mixer
! ==============================================================================
40:

resol gs_resol

addz 0.003
rotz -90

	cone 0.014, 0.024, 0.010, 90, 90

	rotx 90

		addx -0.021
			elbow 0.021, 360,  0.003
		del 1

		addy 0.010 !z!
		addx -0.0124
			elbow 0.0124, 360,  0.003

		del 2

		rotx -90
		cone 0.06, 0.012, 0.01, 90, 90

	del 2


	addx 0.15
		addz 0.207
			cylind 0.027, 0.0108
		del 1
		addz 0.197
			cylind 0.01, 0.0095

	del 2



	!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
	addz 0.06
		rotx 90
		tube        2,    16,     16+32,
					0,  0,  901,
					0.009, 360, 4001,

					0.0,    -0.088502, 0, 0,
					0.0,          0.0,          0, 0,
					0.0,          0.173,        0, 0,
					0.002556,     0.192411,     0, 0,
					0.010048,     0.2105,     0, 0,
					0.021967,     0.226033,     0, 0,
					0.0375,       0.237952,     0, 0,
					0.055589,     0.245444,     0, 0,
					0.075,        0.248,        0, 0,
					0.094411,     0.245444,     0, 0,
					0.1125,       0.237952,     0, 0,
					0.128033,     0.226033,     0, 0,
					0.139952,     0.2105,       0, 0,
					0.147444,     0.192411,     0, 0,
					0.15,         0.173,        0, 0,
					0.15,         0.090159,     0, 0

		del 1
	del 1
	!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!


	for i=1 to 2

		addy 0.10

					cone 0.054, 0.021, 0.008, 90, 90
				addz 0.058
					cylind 0.013, 0.0085
				addz 0.013
					ellips 0.002, 0.0085
				del 2


				rotx 90
				!addz 0.00125
				addx -0.022
					elbow 0.022, 360,  0.003
				del 1

				addy 0.010 !z!
				addx -0.018
					elbow 0.018, 360,  0.003

				del 1

				addy 0.045 !z!
				addx -0.006
					elbow 0.006, 360,  0.0035

				del 1

				addy 0.045 !z!

				del 4
			!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

			for K=1 to 4

				 rotx 90

				addy 0.065
					cone 0.03, 0.0043, 0.0062, 90, 90
				addz 0.024
				addx -0.006
				rotx 90
					elbow 0.006, 360,  0.0025
				del 2
				del 3

			rotz 90

			next k

			del 4


		del 1


	muly -1

	next i

	del 2

del 1
DEL 1

return


! ==============================================================================
! Two Handle Mixer
! ==============================================================================
50:

rotz -90

	resol gs_resol

		roty -90

			revolve     14, 360, 1+32,

						0.0,        0.0272,     1,
						0.0601,     0.1307,     901,
						0.0,        17,         4001,
						0.0389,     0.0146,     1,
						0.0448,     0.0151,     1,
						0.0509,     0.0263,     901,
						0.0,        47,         4001,
						0.0599,     0.0165,     1,
						0.0654,     0.0173,     1,
						0.0709,     0.0163,     1,
						0.0758,     0.0139,     1,
						0.0831,     0.0213,     901,
						0.0,        51,         4001,
						0.1215,     0.011, 1

		del 1


	addz 0.080
	rotx 90

		tube        2,    23,     16+32,
					0,  0,  901,
					0.011, 360, 4001,

					0.0,         -0.039574,     0, 0,
					0.0,          0.040954,     0, 0,
					0.001957,     0.072061,     0, 0,
					0.007752,     0.101105,     0, 0,
					0.015924,     0.125786,     0, 0,
					0.02614,      0.147258,     0, 0,
					0.041391,     0.168577,     0, 0,
					0.058758,     0.185341,     0, 0,
					0.077713,     0.198241,     0, 0,
					0.096314,     0.207004,     0, 0,
					0.12025,      0.213783,     0, 0,
					0.145402,     0.21617,      0, 0,
					0.16135,      0.215198,     0, 0,
					0.178915,     0.210757,     0, 0,
					0.194316,     0.203267,     0, 0,
					0.207305,     0.193455,     0, 0,
					0.218687,     0.180734,     0, 0,
					0.228073,     0.164372,     0, 0,
					0.232408,     0.151681,     0, 0,
					0.233066,     0.14708,      0, 0,
					0.233261,     0.140011,     0, 0,
					0.233261,     0.132343,     0, 0,
					0.233261,     0.092421,     0, 0

	del 2


	addx 0.2333
	addz 0.22
	roty 90

		revolve     13, 360, 1+32,

					0.0,          0.0,          1,
					0.0,          0.011,        1,
					0.000371,     0.01206,      1,
					0.001261,     0.012761,     0,
					0.002365,     0.01291,      1,
					0.005283,     0.013165,     1,
					0.008201,     0.013827,     1,
					0.010792,     0.014787,     1,
					0.013254,     0.016075,     1,
					0.014192,     0.016544,     1,
					0.014951,     0.016136,     1,
					0.015081,     0.01568,      0,
					0.015081,     0.0,          0

	del 3


	for j=1 to 2

		addy 0.095

			roty 270

				revolve     23, 360, 1+32,

							0.0,          0.0,          1,
							0.0,          0.022549,     1,
							0.001852,     0.022648,     0,
							0.0025,       0.02132,      1,
							0.003897,     0.021633,     0,
							0.005002,     0.020155,     1,
							0.006611,     0.020392,     1,
							0.0658,       0.154,        901,
							0.0,          23,           4001,
							0.06478,      0.006814,     1,
							0.066092,     0.008126,     1,
							0.068045,     0.008448,     1,
							0.069904,     0.007166,     1,
							0.070308,     0.006041,     1,
							0.072448,     0.004652,     1,
							0.073665,     0.004297,     1,
							0.075154,     0.004186,     1,
							0.076134,     0.004299,     1,
							0.076916,     0.0045,       1,
							0.077309,     0.004373,     1,
							0.077692,     0.004009,     1,
							0.0778,       0.003776,     1,
							0.0778,       0.0,          1

			del 1

		addz 0.082

			sphere 0.007


			rotz 90


				revolve     23, 360, 1+32,

						0.0,          0.0,          1,
						0.0,          0.004428,     0,
						0.00009,      0.004908,     0,
						0.000531,     0.005356,     1,
						0.001105,     0.005442,     1,
						0.001602,     0.0052,       1,
						0.002002,     0.004574,     1,
						0.002294,     0.003562,     1,
						0.002618,     0.003122,     1,
						0.003161,     0.00303,      1,
						0.004385,     0.003158,     1,
						0.007703,     0.003572,     1,
						0.011998,     0.00463,      0,
						0.018571,     0.007126,     1,
						0.02471,      0.00878,      1,
						0.032564,     0.009693,     1,
						0.040265,     0.009247,     1,
						0.047881,     0.007749,     1,
						0.053834,     0.005563,     1,
						0.055482,     0.004556,     1,
						0.056395,     0.003235,     1,
						0.057203,     0.001215,     1,
						0.057422,    -0.0,     0

			del 1

		addy -0.0095

			sphere 0.003

		addy 0.069

			sphere 0.003

		del 4


		muly -1

	next j

	del 2

del 1

return


! ==============================================================================
! Two Handle Mixer
! ==============================================================================
60:

MUL 0.75,0.75,0.75
rotz -90

	resol 1.5*gs_resol

	roty -90
	addy -0.13

	for ii=1 to 2


		revolve 8,360,1,
			0,0.0316,0,
			0.0015,0.0316,1,
			0.09,0.18,900,
			0,30.6,4000,
			0.0907,0.0066,0,
			0.0917,0.0076,0,
			0.1067,0.0076,1,
			0.0076,-89,2001

		roty 90
		addz 0.1


		for i=1 to 4

		revolve 9,360,1,
			0.006,0.003,1,
			0.006,0.052,900,
			0,22,4000,
			0.0251,0.0055,1,
			0.0255,0.0066,0,
			0.032,0.007,1,
			0.038,0.0053,1,
			0.040,0.003,1,
			0.0428,0,1

		rotz 90
		next i
		del 7

	addy 0.13
	next ii

	del 1

	roty 90

	MUL 0.8,0.8,1
	sweep 2,7,0,0.92,16,
		0,0,901,
		0.03,360,4001,

		0,0,0,
		0.006,0,0.072,
		0.021,0,0.136,
		0.044,0,0.184,
		0.075,0,0.214,
		0.100,0,0.225,
		0.113,0,0.225
	add 0.113,0,0.225
	roty 90

	sweep 2,5,0,1.02,4+32,
		0,0,901,
		0.01819,360,4001,

		0,0,0,
		0.000,0,0.0176,
		0.0109,0,0.0419,
		0.0298,0,0.0617,
		0.0618,0,0.0825


	add 0.0618,0,0.082
	rotz 90
	rotx -30
	addx -0.02

	elbow 0.02,360,0.003

del 9

del 1
DEL 1

return


! ==============================================================================
! Single Level Mixer
! ==============================================================================
70:

resol 1.5*gs_resol
rotz -90
roty 90
addx -0.06
addz -0.037/2

	ARMC 0.02,0.037/2,0.06,0.037/2,0,90
del 3

addx -0.044
addz 0.06
roty 90
	If gs_detlevel_3D_m=1 then	CYLIND 0.1,0.02
	If gs_detlevel_3D_m=2 then	CYLIND 0.065,0.02
addz 0.066

RESOL gs_resol

If gs_detlevel_3D_m=2 then
	addy -0.006
	addz 0.023
	roty -90

	CUTPOLY 5,
	0,0,
	0.02,0,
	0.02,0.0015,
	0,0.0015,
	0,0

	addy 0.0105
	CUTPOLY 5,
	0,0,
	0.02,0,
	0.02,0.0015,
	0,0.0015,
	0,0
	del 4
		CYLIND 0.035,0.02
	CUTEND
	CUTEND

	RESOL gs_resol
	addz 0.026
	rotz 180
		ARMC 0.02,0.0035,0.05,0.0035,0,90
	del 2
ENDIF
	rotz 180
	addz -0.061
		ARMC 0.02,0.008,0.03,0.009,0,90

	addz 0.009
	addx 0.026
	roty 90

	N=6						!! TUBE
	S=90/N
	FOR T=0 to 90 step S
	PUT -0.042+0.042*cos(T),0,0.098+0.042*sin(T),1
	NEXT T

	FOR T=0 to 90 step S
	PUT -0.042-0.114-0.042*sin(T),0,0.098+0.042*cos(T),1
	NEXT T

	TUBE 2,8+NSP/4, 16+32,
	0,0,901,
	0.009,360,4001,
	0,0,-1,0,
	0,0,0,0,
	0,0,0.098,0,
	GET (NSP-N*4),
	-0.042,0,0.098+0.042,1,
	-0.042-0.114,0,0.098+0.042,1,
	GET (NSP),
	-0.042-0.114-0.042,0,0.098,1,
	-0.042-0.114-0.042,0,0.098-0.03,1,
	-0.042-0.114-0.042,0,0,1
DEL 10

return


! ==============================================================================
! Traditional Basin Pillar Tap
! ==============================================================================
80:

resol gs_resol

addx -e/2
!material c
mulx 1.5
sweep 2,8,0,0.95,1+2+4+16+32,
	0,0,901,
	0.01,360,4001,

	0,0,0,
	0,-0.01,0.03,
	0,-0.012,0.032,
	0,-0.013,0.032,
	0,-0.08,0.032,
	0,-0.082,0.03,
	0,-0.082,0.029,
	0,-0.082,0.02
del 1
!material d
add 0,-0.015,0.04
cylind 0.015,0.007
addz 0.015
mulz 0.8
sphere 0.01
addx -0.025
roty 90
cylind 0.05,0.005
del 2
addy -0.025
rotx -90
cylind 0.05,0.005

del 5

addx e
!material c
mulx 1.5
sweep 2,8,0,0.95,1+2+4+16+32,
	0,0,901,
	0.01,360,4001,

	0,0,0,
	0,-0.01,0.03,
	0,-0.012,0.032,
	0,-0.013,0.032,
	0,-0.08,0.032,
	0,-0.082,0.03,
	0,-0.082,0.029,
	0,-0.082,0.02
del 1
!material d
add 0,-0.015,0.04
cylind 0.015,0.007
addz 0.015
mulz 0.8
sphere 0.01
addx -0.025
roty 90
cylind 0.05,0.005
del 2
addy -0.025
rotx -90
cylind 0.05,0.005

del 7

return


! ==============================================================================
! Two Handle Mixer
! ==============================================================================
90:

resol gs_resol

rotz -90

	cylind 0.017, 0.026

	addz 0.19
	rotx 90

		tube        2,    17,     16+32,
					0,  0,  901,
					0.013, 360, 4001,

					0.0,         -1,           0, 0,
					0.0,         -0.173,     0, 0,
					0.0,          0.0,          0, 0,
					0.001034,     0.010574,     0, 0,
					0.004099,     0.020748,     0, 0,
					0.009077,     0.030135,     0, 0,
					0.015779,     0.038379,     0, 0,
					0.023953,     0.045168,     0, 0,
					0.033287,     0.050244,     0, 0,
					0.043427,     0.053414,     0, 0,
					0.05399,      0.05456,      0, 0,
					0.064575,     0.053636,     0, 0,
					0.07478,      0.050679,     0, 0,
					0.084219,     0.0458,       0, 0,
					0.092533,     0.039184,     0, 0,
					0.170703,    -0.031749,     0, 0,
					0.248874,    -0.102682,     0, 0
	del 2


	for i=1 to 2

		addy 0.11
			cylind 0.007, 0.028
		addz 0.007
			cylind 0.06, 0.015
		addz 0.06
			cylind 0.002, 0.014
		addz 0.002
			cylind 0.012, 0.015
		del 4


		rotz 90
		addz 0.07
		addx -0.125
		addy -0.0025

			prism_ 13, 0.01,

					0.0,     0.002157,     13,
				   -0.014354,     0.003061,     13,
				   -0.027638,     0.002933,     13,
				   -0.037146,     0.002159,     13,
				   -0.04158,     0.001612,     15,
				   -0.042372,     0.00065,     13,
				   -0.042488,     0.0,     15,
				   -0.042372,    -0.00065,     13,
				   -0.04158,    -0.001612,     15,
				   -0.037145,    -0.002106,     13,
				   -0.02818,    -0.002963,     13,
				   -0.014715,    -0.003194,     13,
					0.0,    -0.002157,     13


		del 4

	muly -1

	next i

	del 1

del 1

return


! ==============================================================================
! Two Handle Mixer
! ==============================================================================
100:

resol gs_resol

addy 0.02
rotz -90

sweep 9,6,0,0.88,4+16,
	0.003,-0.025,1,
	0.037,-0.025,1,
	0.04,-0.022,1001,
	0.04,0.022,1,
	0.037,0.025,1001,
	0.003,0.025,1,
	0,0.022,1001,
	0,-0.022,1,
	0.003,-0.025,1001,

	0.02,0,0,
	0.030,0,0.029,
	0.045,0,0.054,
	0.064,0,0.076,
	0.088,0,0.093,
	0.113,0,0.106

add 0.113,0,0.106
roty 62.5

revolve 6,180,0,
	0.010554,0,1,
	0.010554,0.0116104,1,
	0.0089709,0.0131935,1001,
	-0.0089709,0.0131935,1,
	-0.010554,0.0116104,1001,
	-0.010554,0,1

addx 0.010554
roty 90



cylind 0.006,0.01

del 4
addx 0.025
addy -0.02
addz 0.015
rotx 60

for ii=1 to 2
cylind 0.02,0.01
addz 0.01

cone  0.04, 0.012, 0.024, 90, 90

addz 0.04
cone  0.006, 0.024, 0.020, 90, 90

del 6

addx 0.025
addy 0.02
addz 0.015
rotx -60


next ii

del 4

return


! ==============================================================================
! Two Handle Mixer
! ==============================================================================
110:

MUL 0.75,0.75,0.75
ADDZ 0.02

rotz -90

	resol 1.5*gs_resol

	roty -90
	addy -0.13

	for ii=1 to 2

		revolve 8,360,1,
			0,0.0316,0,
			0.0015,0.0316,1,
			0.09,0.18,900,
			0,30.6,4000,
			0.0907,0.0066,0,
			0.0917,0.0076,0,
			0.1067,0.0076,1,
			0.0076,-89,2001

		roty 90
		addz 0.1


		for i=1 to 4

		revolve 9,360,1,
			0.006,0.003,1,
			0.006,0.052,900,
			0,22,4000,
			0.0251,0.0055,1,
			0.0255,0.0066,0,
			0.032,0.007,1,
			0.038,0.0053,1,
			0.040,0.003,1,
			0.0428,0,1

		rotz 90
		next i
		del 7

	addy 0.13
	next ii

	del 1

	roty 90
	MUL 0.8,0.8,1
	sweep 2,7,0,0.92,16,
		0,0,901,
		0.03,360,4001,

		0,0,0,
		0.006,0,0.072,
		0.021,0,0.136,
		0.044,0,0.184,
		0.075,0,0.214,
		0.100,0,0.225,
		0.113,0,0.225

	add 0.113,0,0.225
	roty 90

	sweep 2,5,0,1.02,4+32,
		0,0,901,
		0.01819,360,4001,

		0,0,0,
		0.000,0,0.0176,
		0.0109,0,0.0419,
		0.0298,0,0.0617,
		0.0618,0,0.0825

	add 0.0618,0,0.082
	rotz 90
	rotx -30
	addx -0.02

	elbow 0.02,360,0.003

del 9
del 1

POLY_      39,
		   -0.129563,     0.035,      1,
		   -0.136071,     0.03443,      1,
		   -0.141958,     0.032853,      1,
		   -0.147481,     0.030278,      1,
		   -0.152473,     0.026782,      1,
		   -0.156782,     0.022473,      1,
		   -0.160278,     0.017481,      1,
		   -0.162853,     0.011958,      1,
		   -0.16443,     0.006071,      1,
		   -0.164962,     0.0,      1,
		   -0.16443,    -0.006071,      1,
		   -0.162853,    -0.011958,      1,
		   -0.160278,    -0.017481,      1,
		   -0.156782,    -0.022473,      1,
		   -0.152473,    -0.026782,      1,
		   -0.147481,    -0.030278,      1,
		   -0.141958,    -0.032853,      1,
		   -0.136071,    -0.03443,      1,
		   -0.129563,    -0.035,      1,
			0.129563,    -0.035,      1,
			0.136071,    -0.03443,      1,
			0.141958,    -0.032853,      1,
			0.147481,    -0.030278,      1,
			0.152473,    -0.026782,      1,
			0.156782,    -0.022473,      1,
			0.160278,    -0.017481,      1,
			0.162853,    -0.011958,      1,
			0.16443,    -0.006071,      1,
			0.164962,     0.0,      1,
			0.16443,     0.006071,      1,
			0.162853,     0.011958,      1,
			0.160278,     0.017481,      1,
			0.156782,     0.022473,      1,
			0.152473,     0.026782,      1,
			0.147481,     0.030278,      1,
			0.141958,     0.032853,      1,
			0.136071,     0.03443,      1,
			0.129563,     0.035,      1,
		   -0.129563,     0.035,     -1
DEL 1

TUBE 7,41,0,

		0.01,0.02,1,
		0.01,0.015,1,
		0,-1,801,
		0,0.005,1001,
		0,0,1,
		0.011,0.005,1,
		0.01,0.02,-1,

			1,     0.045,        0,0,
			0.13,     0.045,        0,0,
		   -0.13,     0.045,        0,0,
		   -0.137814,     0.044316,        0,0,
		   -0.145391,     0.042286,        0,0,
		   -0.1525,     0.038971,        0,0,
		   -0.158925,     0.034472,        0,0,
		   -0.164472,     0.028925,        0,0,
		   -0.168971,     0.0225,        0,0,
		   -0.172286,     0.015391,        0,0,
		   -0.174316,     0.007814,        0,0,
		   -0.175,     0.0,        0,0,
		   -0.174316,    -0.007814,        0,0,
		   -0.172286,    -0.015391,        0,0,
		   -0.168971,    -0.0225,        0,0,
		   -0.164472,    -0.028925,        0,0,
		   -0.158925,    -0.034472,        0,0,
		   -0.1525,    -0.038971,        0,0,
		   -0.145391,    -0.042286,        0,0,
		   -0.137814,    -0.044316,        0,0,
		   -0.13,    -0.045,        0,0,
			0.13,    -0.045,        0,0,
			0.137814,    -0.044316,        0,0,
			0.145391,    -0.042286,        0,0,
			0.1525,    -0.038971,        0,0,
			0.158925,    -0.034472,        0,0,
			0.164472,    -0.028925,        0,0,
			0.168971,    -0.0225,        0,0,
			0.172286,    -0.015391,        0,0,
			0.174316,    -0.007814,        0,0,
			0.175,     0.0,        0,0,
			0.174316,     0.007814,        0,0,
			0.172286,     0.015391,        0,0,
			0.168971,     0.0225,        0,0,
			0.164472,     0.028925,        0,0,
			0.158925,     0.034472,        0,0,
			0.1525,     0.038971,        0,0,
			0.145391,     0.042286,        0,0,
			0.137814,     0.044316,        0,0,
			0.13,     0.045,     0,0,
			-1,     0.045,        0,0
DEL 1

return


! ==============================================================================
! Two Handle Mixer
! ==============================================================================
120:

resol gs_resol

ADDZ 0.097
Addz 0.003
rotz -90

	cone 0.014, 0.016, 0.010, 90, 90

	rotx 90

		addx -0.015
			elbow 0.015, 360,  0.003
		del 1

		addy 0.010 !z!
		addx -0.0124
			elbow 0.0124, 360,  0.003

		del 2

		rotx -90
		cone 0.06, 0.012, 0.01, 90, 90

	del 2


	addx 0.15
		addz 0.207
			cylind 0.027, 0.0108
		del 1
		addz 0.197
			cylind 0.01, 0.0095

	del 2


	!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
	addz 0.06
		rotx 90
		tube        2,    16,     16+32,
					0,  0,  901,
					0.009, 360, 4001,

					0.0,    -0.088502, 0, 0,
					0.0,          0.0,          0, 0,
					0.0,          0.173,        0, 0,
					0.002556,     0.192411,     0, 0,
					0.010048,     0.2105,     0, 0,
					0.021967,     0.226033,     0, 0,
					0.0375,       0.237952,     0, 0,
					0.055589,     0.245444,     0, 0,
					0.075,        0.248,        0, 0,
					0.094411,     0.245444,     0, 0,
					0.1125,       0.237952,     0, 0,
					0.128033,     0.226033,     0, 0,
					0.139952,     0.2105,       0, 0,
					0.147444,     0.192411,     0, 0,
					0.15,         0.173,        0, 0,
					0.15,         0.090159,     0, 0

		del 1
	del 1
	!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

	for i=1 to 2

		addy 0.10

ADDZ -0.1
ROTY -90
REVOLVE 9,360,1,
		0,0.0275,1,
		0.005,0.0275,1,
		0,-1,801,
		0.025,0.0075,1001,
		0.055,0.0075,1,
		0.055,0.015,1,
		0.06,0.015,1,
		0.06,0.01,1,
		0.1,0.01,1
DEL 2

				cone 0.054, 0.015, 0.008, 90, 90
			addz 0.058
				cylind 0.013, 0.0085
			addz 0.013
				ellips 0.002, 0.0085
			del 2


			rotx 90
			!addz 0.00125
			addx -0.015
				elbow 0.015, 360,  0.003
			del 1

			addy 0.010 !z!
			addx -0.013
				elbow 0.013, 360,  0.003

			del 1

			addy 0.045 !z!
			addx -0.006
				elbow 0.006, 360,  0.0035

			del 1

			addy 0.045 !z!

			del 4

			!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

			for K=1 to 4

				 rotx 90

				addy 0.065
					cone 0.03, 0.0043, 0.0062, 90, 90
				addz 0.024
				addx -0.006
				rotx 90
					elbow 0.006, 360,  0.0025
				del 2
				del 3

			rotz 90

			next k

			del 4


		del 1


	muly -1

	next i

	del 2

del 1
DEL 1

ROTZ 90
ADD 0,0.1,-0.02
ROTX 90
CYLIND 0.2,0.01
DEL 3

ADDZ -0.02
CYLIND 0.02,0.01
DEL 1

return


! ==============================================================================
! Sensor Faucet
! ==============================================================================
130:

resol gs_resol

mul 2,2,1.8

r=1"
zh=4"
zt=zh/8
fh=3 1/2"/55
lv=1/3"
v=1.5"
t=1/2"
s=a/4
c=b/2-r-v
cc=3
z=a-v-s

material gs_tap_mat
add -0.0081,-0.0220,0
rotx 90
roty 90

prism_ 7, 10*fh,
		13.5*fh, 0, 0,
		(6+170/101)*fh, (18+510/101)*fh, 113,
		1*fh, 38*fh, 15,
		-1*fh, -1*fh, 115,
		5*fh, -100/27*fh, 179,
		7*fh, 18*fh, 1079,
		(1547/232)*fh, (13+1105/232)*fh, 64

rotx -90
addx 13.5*fh

rotx 180
cutplane
del 1

add (6+170/101)*fh, -10*fh, (18+510/101)*fh
rotz 90
cutplane atn(20/27)
del 2

del 2

add (1547/232)*fh, (13+1105/232)*fh, 0
roty -90
cutplane -atn(13/5)
del 2

rotx -90
addx 13.5*fh

roty 90-atn(18/6)
addy -10*fh
addz -10*fh
prism_  6, 40*fh,
		-10*fh, 0, 0,
		-0.01*fh, 0, 13,
		0,0,15+64,
		0,5*fh,979,
		0,180,4000,
		-10*fh,0,100
del 3
del 2

addx 13.5*fh
rotx -90
roty -atn(5/13)
rotz 180
addz -10*fh
prism_  6, 40*fh,
		-10*fh, 0, 0,
		-0.01*fh, 0, 13,
		0,0,15+64,
		0,5*fh,979,
		0,180,4079,
		-fh,9.5*fh,1000
del 5

cutend
cutend
cutend

add (1547/232)*fh, (13+1105/232)*fh, 0
rotz 90+atn(5/13)
roty 90
addx -10*fh
prism_  3, 0,
		0,0,15,
		5*fh,0,915,
		0, -180, 4000
add 5*fh, 2*fh, 0
cone 2*fh, 2*fh, 1*fh, 90,90
del 5

rotx -90
addx 13.5*fh
add (6+170/101)*fh, -10*fh, (18+510/101)*fh
rotz 90
rotx atn(20/27)
rotz -90
mulx 1/cos(atn(18/6)+atn(20/27)-90)
prism_  3, 0,
		0,0,0,
		0, 5*fh,900,
		0, 180, 4000

del 10
DEL 1

return


! ==============================================================================
! Traditional Basin Pillar Tap
! ==============================================================================
140:

resol gs_resol

tapWidth = 0.034
tapHeight = 0.129
axisAngle = 78 + 12*0
axisLength = tapHeight / sin(axisAngle)
tapRadius = 0.0245
hillAngle = 87.5
coneHeight = tapRadius * tan(hillAngle)
noseHeight = 0.03
noseLength = 0.084
filletRadius = 0.003
openerWidth = 0.016
openerHeight = 0.009
openerLength = 0.045

group "type14_part1"
	rotx 90 - axisAngle
	rotz -90
		cone 0.091, tapRadius, tapRadius * (coneHeight-0.091)/coneHeight, axisAngle, 90

		addz 0.091
		cone 0.002, tapRadius * (coneHeight-0.091)/coneHeight, (tapRadius * (coneHeight-0.091)/coneHeight) - 0.002, 90, 90
		del 1

		addz 0.093
		cone axisLength - 0.093, tapRadius * (coneHeight-0.093)/coneHeight, tapRadius * (coneHeight-axisLength)/coneHeight, 90, axisAngle
		del 1
	del 2

	add 0, -0.082, 0.045
	rotx -axisAngle + 50
	addz 0
	cylind 0.01, 0.008
	del 3
endgroup

group "type14_part2"
	rotx 90 - axisAngle
	rotz -90
		rotx 90
		for hi = 1 to 2
		hprism_ gs_tap_mat, gs_tap_mat, gs_tap_mat, gs_tap_mat,
			9, tapWidth/2, 0, filletRadius, 1,
			0, 0.085, 10 + maskSection,
			noseLength - 0.008, 0.085, 10 + 64 + maskSection,
			0.008, -140, 2010 + 64 + maskSection,
			0.022, 0, 310 + 64 + maskSection,
			0.008, -40, 2010 + 64 + maskSection,
			noseLength - 0.0476, 0, 310 + 64 + maskSection,
			0.01, 180 - hillangle, 2010 + maskSection,
			0, 0.085 - noseHeight - 0.008, 10 + maskSection,
			0, 0.085, -1
		mulz -1
		next hi
		del 2
		del 1
	del 2

	addx openerWidth/2
	addy -tapHeight / tan(axisAngle)
	rotz -90
	rotx 90
	prism_ 7, openerWidth,
		0, tapHeight, 15,
		openerLength - openerHeight/2, tapHeight, 15 + 64,
		openerHeight/2, -180, 2013,
		0.019, tapHeight - openerHeight, 13 + 64,
		openerHeight/2, 180 - hillangle, 2013,
		0, tapHeight - openerHeight/2*3, 15,
		0, tapHeight, -1
	del 4
endgroup

for hi = 1 to 2
	addx -0.09
	placegroup addgroup("type14_part1","type14_part2")
	del 1
mulx -1
next hi
del 2

killgroup "type14_part1"
killgroup "type14_part2"


return


! ==============================================================================
! Traditional Basin Pillar Tap
! ==============================================================================
150:

resol gs_resol

roundOff1 = 0.002
roundOff2 = 0.013
tapHeight = 0.114
axisAngle = 88.5
tapRadius = 0.0215
noseRadius = 0.016
openerRadius = 0.0045
openerLength = 0.048

group "type15_part1"
	rotx 90 - axisAngle
	rotz -90
		cone 0.075, tapRadius, tapRadius - 0.0025, axisAngle, 90

		addz 0.075
		cone 0.002, tapRadius - 0.0025, tapRadius - 0.0045, 90, 90
		del 1

		add 0, 0, 0.077
		roty -90
		revolve 4, 360, 1+2+4+8+16+32,
			0, 0.02, 0,
			tapHeight - 0.077 - roundOff1, 0.02, 1,
			tapHeight - 0.077, 0.02-roundOff1, 1001,
			tapHeight - 0.077, 0, 1
		del 2
	del 2

	add 0, -0.084, 0.035
	rotx -21.2
	addz 0
	cylind 0.01, 0.008
	del 3
endgroup

group "type15_part2"
	noseResol = gs_resol
	if noseResol < 6 then noseResol = 6
	nNosePoints = 2*ceil(noseResol/2)
	noseLength = 0.092
	gi = 360/nNosePoints
	for hi = 1 to nNosePoints
		put (noseRadius + 0.001) * cos((hi-1)*gi), (noseRadius + 0.001) * sin((hi-1)*gi), 1
	next hi
	for ii = 1 to nNosePoints
		put noseRadius * cos((ii-1)*gi), noseRadius * sin((ii-1)*gi) + 0.001, noseLength - 0.033
	next ii

	addz 0.047
	rotx 90
			ruled nNosePoints, 1+2+4+16,
				get(nsp)

	del 2

	for ji = 1 to nNosePoints
		put noseRadius * cos((ji-1)*gi), noseRadius * sin((ji-1)*gi) + 0.001, 1
	next ji
	for ki = 1 to nNosePoints/2 + 1
		put noseRadius * cos((ki-1)*gi), noseRadius * sin((ki-1)*gi) + 0.001, 0.033
	next ki
	for li = 1 to nNosePoints/2 - 1
		dy = 0
		if li = 1 then dy = -noseRadius/2 * (1+cos(gi+180))
		if li = nNosePoints/2 - 1 then dy = noseRadius/2 * (1+cos(gi+180))
		put noseRadius * cos((li-1+1)*gi+180) + dy, (noseRadius * sin((li-1+1)*gi+180))*0.2 + 0.001, 0.033
	next li

	add 0, -noseLength + 0.033, 0.047
	rotx 90
	ruled{2} nNosePoints, 1+2+4+32,
		get(nsp)
	del 2

	add 0, 0, tapHeight - 0.014
	rotx 90
	cylind openerLength, openerRadius
	del 2
endgroup

for hi = 1 to 2
	addx -0.09
	placegroup addgroup("type15_part1","type15_part2")
	del 1
mulx -1
next hi
del 2

killgroup "type15_part1"
killgroup "type15_part2"

return


! ==============================================================================
! Single Level Mixer - Bath Filler Mixer with Optional Shower Kit
! ==============================================================================
160:

resol gs_resol

tapHeight = 0.16
axisAngle = 76.5
axisLength = tapHeight / sin(axisAngle)
tapRadius = 0.031
hillAngle = 88.5
coneHeight = tapRadius * tan(hillAngle)
noseWidth = 2*tapRadius - 0.015
noseHeight = 0.035
noseLength = 0.1315
noseZPos = 0.12
filletRadius = 0.003
openerWidth = 0.016
openerHeight = 0.009
openerLength = 0.092

group "type16_part1"
	rotx 90 - axisAngle
	rotz -90
		cone 0.123, tapRadius, tapRadius * (coneHeight-0.091)/coneHeight, axisAngle, 90

		addz 0.123
		cone 0.002, tapRadius * (coneHeight-0.091)/coneHeight, (tapRadius * (coneHeight-0.091)/coneHeight) - 0.002, 90, 90
		del 1

		addz 0.125
		cone axisLength - 0.125, tapRadius * (coneHeight-0.093)/coneHeight, tapRadius * (coneHeight-axisLength)/coneHeight, 90, axisAngle
		del 1
	del 2

	add 0, -0.135, 0.062
	rotx -axisAngle + 50
	addz 0
	cylind 0.01, 0.008
	del 3

	if bShower then
		xShowerPos = 0.16
		zShowerPos = 0.3
		xShowerOpenerPos = 0
		zShowerOpenerPos = 0.126
		yShowerOpenerPos = -noseLength + 0.045
		ShowerOpenerAngle = 90
		gosub "shower kit"
	endif

endgroup

group "type16_part2"
	rotx 90 - axisAngle
	rotz -90
		rotx 90
		for hi = 1 to 2
		hprism_ gs_tap_mat, gs_tap_mat, gs_tap_mat, gs_tap_mat,
			9, noseWidth/2, 0, filletRadius, 1,
			0, noseZPos, 10 + maskSection,
			noseLength - 0.008, noseZPos, 10 + 64 + maskSection,
			0.008, -140, 2010 + 64 + maskSection,
			0.027, 0, 310 + 64 + maskSection,
			0.016, -40, 2010 + 64 + maskSection,
			0.0517, 0, 310 + 64 + maskSection,
			noseLength - 0.1042, 180 - hillangle, 2010 + maskSection,
			0, noseZPos - noseHeight - 0.024, 10 + maskSection,
			0, noseZPos, -1
		mulz -1
		next hi
		del 2
		del 1
	del 2

	addx openerWidth/2
	addy -tapHeight / tan(axisAngle)
	rotz -90
	rotx 90
	prism_ 7, openerWidth,
		0, tapHeight, 15,
		openerLength - openerHeight/2, tapHeight, 15 + 64,
		openerHeight/2, -180, 2013,
		0.019, tapHeight - openerHeight, 13 + 64,
		openerHeight/2, 180 - hillangle, 2013,
		0, tapHeight - openerHeight/2*3, 15,
		0, tapHeight, -1
	del 4

endgroup

placegroup addgroup("type16_part1","type16_part2")

killgroup "type16_part1"
killgroup "type16_part2"

return


! ==============================================================================
! Single Level Mixer - Basin/Bath Filler Mixer
! ==============================================================================
170:

resol gs_resol

roundOff1 = 0.002
roundOff2 = 0.013
tapHeight = 0.1815
axisAngle = 86
tapRadius = 0.032
noseRadius = 0.022
noseLength = 0.14
noseZPos = 0.09
openerRadius = 0.006
openerLength = 0.075


group "type17_part1"
	rotx 90 - axisAngle
	rotz -90
		cone 0.128, tapRadius, tapRadius - 0.007, axisAngle, 90

		addz 0.128
		cone 0.002, tapRadius - 0.007, tapRadius - 0.009, 90, 90
		del 1

		add 0, 0, 0.13
		roty -90
		revolve 4, 360, 1+2+4+8+16+32,
			0, 0.0275, 0,
			tapHeight - 0.13 - roundOff1, 0.0275, 1,
			roundOff1, -70, 2001,
			0.06, -20, 2001
		del 2
	del 2

	add 0, -0.12, 0.06
	rotx -21.2
	addz 0
	cylind 0.025, 0.015
	del 3

endgroup

group "type17_part2"

	noseResol = gs_resol
	if noseResol < 6 then noseResol = 6
	nNosePoints = 2*ceil(noseResol/2)
	gi = 360/nNosePoints
	for hi = 1 to nNosePoints
		put (noseRadius + 0.001) * cos((hi-1)*gi), (noseRadius + 0.001) * sin((hi-1)*gi), 1
	next hi
	for ii = 1 to nNosePoints
		put noseRadius * cos((ii-1)*gi), noseRadius * sin((ii-1)*gi) + 0.001, noseLength - 0.0475
	next ii

	addz noseZPos
	rotx 90
			ruled nNosePoints, 1+2+4+16,
				get(nsp)

	del 2

	for ji = 1 to nNosePoints
		put noseRadius * cos((ji-1)*gi), noseRadius * sin((ji-1)*gi) + 0.001, 1
	next ji
	for ki = 1 to nNosePoints/2 + 1
		put noseRadius * cos((ki-1)*gi), noseRadius * sin((ki-1)*gi) + 0.001, 0.0475
	next ki
	for li = 1 to nNosePoints/2 - 1
		dy = 0
		if li = 1 then dy = -noseRadius/2 * (1+cos(gi+180))
		if li = nNosePoints/2 - 1 then dy = noseRadius/2 * (1+cos(gi+180))
		put noseRadius * cos((li-1+1)*gi+180) + dy, (noseRadius * sin((li-1+1)*gi+180))*0.2 + 0.001, 0.0475
	next li

	add 0, -noseLength + 0.0475, noseZPos
	rotx 90
	ruled{2} nNosePoints, 1+2+4+32,
		get(nsp)
	del 2

	add 0, 0, tapHeight - 0.018
	rotx 90
	cylind openerLength, openerRadius
	del 2

endgroup

placegroup addgroup("type17_part1","type17_part2")

killgroup "type17_part1"
killgroup "type17_part2"

return


! ==============================================================================
! Two Handle Mixer - Bath Filler with Optional Shower Kit
! ==============================================================================
180:

resol gs_resol

tapHeight = 0.088
tapWidth = 0.36
axisAngle = 71
axisLength = tapHeight / sin(axisAngle)
tapRadius = 0.022
hillAngle = 135
coneHeight = tapRadius * tan(hillAngle)
noseWidth = 0.048
noseHeight = 0.035
noseLength = 0.135
filletRadius = 0.003
openerWidth = 0.016
openerHeight = 0.009
openerLength = 0.056
openerRadius = 0.024
noseZPos = (tapHeight - openerRadius) / sin(axisAngle) + openerRadius - 0.002

group "type18_part1"
	rotx 90 - axisAngle
	rotz -90
		for hi = 1 to 2
			addy -0.09
			cone (tapHeight - openerRadius)/sin(axisAngle), tapRadius, tapRadius - 0.002, axisAngle, 90
			del 1
		addy 0.18
		next hi
		del 2
	del 2

	add 0, -0.134, 0.038
	rotx -29
	addz 0
	cylind 0.02, 0.01
	del 3

	rotx 90 - axisAngle - 8
	rotz -90
		rotx 90
		for hi = 1 to 2
		addx 0.005
		hprism_ gs_tap_mat, gs_tap_mat, gs_tap_mat, gs_tap_mat,
			9, noseWidth/2, 0, filletRadius, 1,
			0, noseZPos, 10 + maskSection,
			noseLength - 0.008, noseZPos, 10 + 64 + maskSection,
			0.008, -140, 2010 + 64 + maskSection,
			0.027, 0, 310 + 64 + maskSection,
			0.016, -40, 2010 + 64 + maskSection,
			0.07, 0, 310 + 64 + maskSection,
			noseLength - 0.12, 180 - hillangle, 2010 + maskSection,
			0, noseZPos - noseHeight, 10 + maskSection,
			0, noseZPos, -1
		del 1
		mulz -1
		next hi
		del 2
		del 1
	del 2

endgroup

group "type18_part2"

	add -tapWidth/2 + openerLength + 0.002, -(tapHeight - openerRadius) / tan(axisAngle), tapHeight - openerRadius
	roty 90
	cylind tapWidth - 2*openerLength - 0.004, openerRadius
	del 2

	for ji = 1 to 2
		add tapWidth/2 - openerLength - 0.002, -(tapHeight - openerRadius) / tan(axisAngle), tapHeight - openerRadius
		roty 90
		cylind 0.002, openerRadius - 0.001
		del 2

		add tapWidth/2 - openerLength, -(tapHeight - openerRadius) / tan(axisAngle), tapHeight - openerRadius
		roty 90
		gi = 55
		hprism_ gs_tap_mat, gs_tap_mat, gs_tap_mat, gs_tap_mat,
			6, openerLength, 0, filletRadius, 1,
			openerRadius*cos(gi) - openerRadius*cos(90-gi)*0.6, -openerRadius*sin(gi) - openerRadius*sin(90-gi)*0.6, 11 + maskSection,
			-openerRadius*cos(gi) + openerRadius*cos(90-gi)*0.6, -openerRadius*sin(gi) - openerRadius*sin(90-gi)*0.6, 11 + maskSection,
			-openerRadius*cos(gi), -openerRadius*sin(gi), 11 + 64 + maskSection,
			0, 0, 900,
			openerRadius*cos(gi), -openerRadius*sin(gi), 1011 + 64 + maskSection,
			openerRadius*cos(gi) - openerRadius*cos(90-gi)*0.6, -openerRadius*sin(gi) - openerRadius*sin(90-gi)*0.6, -1
		del 2
	mulx -1
	next ji
	del 2

	add -tapWidth/2 + openerLength + 0.002, -(tapHeight - openerRadius) / tan(axisAngle), tapHeight - openerRadius
	roty 90
	cylind tapWidth - 2*openerLength - 0.004, openerRadius
	del 2

	if bShower then
		xShowerPos = 0.10
		zShowerPos = 0.3
		xShowerOpenerPos = 0
		zShowerOpenerPos = 0.097
		yShowerOpenerPos = -0.08
		ShowerOpenerAngle = 85
		gosub "shower kit"
	endif

endgroup

placegroup addgroup("type18_part1","type18_part2")

killgroup "type18_part1"
killgroup "type18_part2"

return


! ==============================================================================
! Two Handle Mixer - Bath Filler with Optional Shower Kit
! ==============================================================================
190:

resol gs_resol

roundOff1 = 0.002
roundOff2 = 0.013
tapHeight = 0.134
axisAngle = 86
tapRadius = 0.032
noseRadius = 0.016
noseLength = 0.124
noseZPos = 0.066
openerRadius = 0.006
openerLength = 0.075
openerHeight = 0.04


group "type19_part1"

	for hi = 1 to 2
		addx -0.09
		rotx 90 - axisAngle
		rotz -90
			cone tapHeight - openerheight -0.002, tapRadius, tapRadius - 0.007, axisAngle, 90

			addz tapHeight - openerHeight -0.002
			cone 0.002, tapRadius - 0.007, tapRadius - 0.009, 90, 90
			del 1

			add 0, 0, tapHeight - openerHeight
			roty -90
			revolve 4, 360, 1+2+4+8+16+32,
				0, 0.0275, 0,
				openerHeight - roundOff1, 0.0275, 1,
				roundOff1, -70, 2001,
				0.06, -20, 2001
			del 2
		del 2

		del 1
	mulx -1
	next hi
	del 2

	noseResol = gs_resol
	if noseResol < 6 then noseResol = 6
	nNosePoints = 2*ceil(noseResol/2)
	gi = 360/nNosePoints
	for hi = 1 to nNosePoints
		put (noseRadius + 0.001) * cos((hi-1)*gi), (noseRadius + 0.001) * sin((hi-1)*gi), 1
	next hi
	for ii = 1 to nNosePoints
		put noseRadius * cos((ii-1)*gi), noseRadius * sin((ii-1)*gi) + 0.001, noseLength - 0.0475
	next ii

	add 0, -0.004, noseZPos
	rotx 90
			ruled nNosePoints, 1+2+4+16,
				get(nsp)

	del 2

	for ji = 1 to nNosePoints
		put noseRadius * cos((ji-1)*gi), noseRadius * sin((ji-1)*gi) + 0.001, 1
	next ji
	for ki = 1 to nNosePoints/2 + 1
		put noseRadius * cos((ki-1)*gi), noseRadius * sin((ki-1)*gi) + 0.001, 0.0475
	next ki
	for li = 1 to nNosePoints/2 - 1
		dy = 0
		if li = 1 then dy = -noseRadius/2 * (1+cos(gi+180))
		if li = nNosePoints/2 - 1 then dy = noseRadius/2 * (1+cos(gi+180))
		put noseRadius * cos((li-1+1)*gi+180) + dy, (noseRadius * sin((li-1+1)*gi+180))*0.2 + 0.001, 0.0475
	next li

	add 0, -0.004 - noseLength + 0.0475, noseZPos
	rotx 90
	ruled{2} nNosePoints, 1+2+4+32,
		get(nsp)
	del 2

endgroup

group "type19_part2"

	add -0.09, -0.004, 0.066
	roty 90
	cylind 0.18, 0.017
	del 2

	add 0, -0.115, 0.052
	rotx -21.2
	addz 0
	cylind 0.02, 0.014
	del 3

	for hi = 1 to 2
		add -0.09, 0, tapHeight - 0.018
		rotx 90
		cylind openerLength, openerRadius
		del 2
	mulx -1
	next hi
	del 2

	if bShower then
		xShowerPos = 0.26
		zShowerPos = 0.6
		xShowerOpenerPos = 0
		zShowerOpenerPos = 0.097
		yShowerOpenerPos = -0.004
		ShowerOpenerAngle = -90
		gosub "shower kit"
	endif

endgroup

placegroup addgroup("type19_part1","type19_part2")

killgroup "type19_part1"
killgroup "type19_part2"

return


! ==============================================================================
! Sensor Faucet
! ==============================================================================
200:

resol gs_resol

sensorRecess = 0.002
sensorWidth = 0.022
sensorHeight = 0.009
zSensorPos = 0.032

add 0, -0.0308, zSensorPos
rotx 117
material "builtInMatSemitransBlackPlastic"
addz 0.0002
plane 4,
	-sensorWidth/2, 0, 0,
	sensorWidth/2, 0, 0,
	sensorWidth/2, sensorHeight, 0,
	-sensorWidth/2, sensorHeight, 0
del 1

material gs_tap_mat
cutform 4, 1, 1,
	0, 0, 1, sensorRecess*10,
	-sensorWidth/2, zSensorPos*0, 31,
	sensorWidth/2, zSensorPos*0, 31,
	sensorWidth/2, zSensorPos*0 + sensorHeight, 31,
	-sensorWidth/2, zSensorPos*0 + sensorHeight, 31
del 2

addy 0.02
rotz -90

sweep 9,6,0,0.88, 1+2+4+16,
	0.003,-0.025,1,
	0.037,-0.025,1,
	0.04,-0.022,1001,
	0.04,0.022,1,
	0.037,0.025,1001,
	0.003,0.025,1,
	0,0.022,1001,
	0,-0.022,1,
	0.003,-0.025,1001,

	0.02,0,0,
	0.030,0,0.029,
	0.045,0,0.054,
	0.064,0,0.076,
	0.088,0,0.093,
	0.113,0,0.106

add 0.113,0,0.106
roty 62.5

revolve 6,180,0,
	0.010554,0,1,
	0.010554,0.0116104,1,
	0.0089709,0.0131935,1001,
	-0.0089709,0.0131935,1,
	-0.010554,0.0116104,1001,
	-0.010554,0,1

addx 0.010554
roty 90

cylind 0.006,0.01

del 6

cutend

return


! ==============================================================================
! Wall Mounted Tap
! ==============================================================================
210:

hotspot -0.075, 0, 0, unID : unID=unID+1
hotspot  0.075, 0, 0, unID : unID=unID+1

resol gs_resol

if GLOB_CONTEXT>20 and GLOB_CONTEXT<40 or gs_detlevel_3D_m=1 then 			!!Simple Model

	for hi = 1 to 2
		rotx 90
		addx -0.075
		cylind 0.024, 0.034
		addz 0.024
		cylind 0.012, 0.017
		del 3
	mulx -1
	next hi
	del 2

	group "tapPartS1"
		add -0.092, -0.036, 0.019
		roty 90
		rotz -90
		prism_ 5, 0.184,
			0, 0, 15,
			0.018, 0, 15+64,
			0.018, 0.038, 1015+64,
			0, 0.038, 15,
			0, 0, -1
		del 3
	endgroup

	group "tapPartS2"
		add 0, -0.06, 0.045
		roty 90
		revolve 3, 360, 1+2+4+8+16+32,
			-0.035, 0.024, 0,
			0.026, 0.024, 1,
			0.05, 0, 1001
		del 2
	endgroup

	group "tapPartS3"
		dy1 = 0.05		!0.0397
		dz1 = 0.019
		fi = atn(dz1/dy1)

		add 0, -0.05, 0
		rotx 90
		prism_ 5, 0.1287-dy1,
			-0.013, -0.019, 11,
			0.013, -0.019, 11,
			0.017, 0.019, 11,
			-0.017, 0.019, 11,
			-0.013, -0.019, -1

		addz 0.1287-dy1
		ruled 4, 1+2+4+32,
			-0.013, -0.019, 0,
			0.013, -0.019, 0,
			0.017, 0.019, 0,
			-0.017, 0.019, 0,

			-0.012, -0.019+dz1, dy1,
			0.012, -0.019+dz1, dy1,
			0.017, 0.019, dy1,
			-0.017, 0.019, dy1
		del 1

		del 2

		add -0.01, -0.087-0.06, 0.065
		block 0.02, 0.087, 0.005
		del 1

		add 0, -0.1787+dy1/3*cos(fi), dz1-0.019-dy1/3*sin(fi)
		rotx -fi
		addz -0.005
		cylind 0.008, 0.01
		del 3

	endgroup

	if bShower then
		group "shower1S"
			add 0, -0.1254, -0.009
			roty 90
			revolve 2, 360, 1+2+4+8+16+32,
				0, 0.0135, 0,
				0.026, 0.0135, 0
			del 2

			add xShowerPos+0.043, -0.083, zShowerPos
			rotx 20
				addz -0.015
				cylind 0.03, 0.01
				del 1
			del 2

			add 0, -0.1254, 0.019
			roty -90
			revolve 2, 360, 1+2+4+8+16+32,
				0, 0.012, 0,
				0.026, 0.012, 0
			del 2

			add xShowerPos, -0.083, zShowerPos
			rotx 20
				cutpolya 2, 1, 0,
					0.043, 0, 907+64,
					0.01, 360, 4007+64
				cutpolya 5, 1, 0,
					0.043, -0.007, 7,
					0.06, -0.007, 7,
					0.06,  0.007, 7,
					0.043, 0.007, 7,
					0.043, -0.007, -1

				roty 90
				cylind 0.057, 0.015
				del 1
				cutend
				cutend
			del 2

			beta = atn(0.0553/(xShowerPos+0.043))
			for hi = 1 to gs_resol
				alfa = hi * 180/gs_resol
				put (xShowerPos+0.043)/2-(xShowerPos+0.043)/2*cos(alfa), -0.1253+((xShowerPos+0.043)/2-(xShowerPos+0.043)/2*cos(alfa))*tan(beta), -0.135-(xShowerPos+0.043)/2*sin(alfa), 0
			next hi

			tube 4, 8+nsp/4, 1+2+16+32,
				0.0065, 0, 1,
				0, 1, 800,
				-0.0065, 0, 1001,
				0.0065, 0, 1001,

				0, -0.1253, 0, 0,
				0, -0.1253, -0.035, 0,
				0, -0.1253, -0.135, 0,
				get(nsp),
				xShowerPos+0.043, -0.07, -0.135, 90-beta,
				xShowerPos+0.043, -0.07, zShowerPos-0.05, 90-beta,
				xShowerPos+0.043, -0.083+0.03*sin(20), zShowerPos-0.03*cos(20), 90-beta,
				xShowerPos+0.043, -0.083+0.015*sin(20), zShowerPos-0.015*cos(20), 0,
				xShowerPos+0.043, -0.083-0.015*sin(20), zShowerPos+0.015*cos(20), 0

			material matShowerHead
			add xShowerPos+0.043, -0.083, zShowerPos
			rotx 20
				sweepRX = 0.01
				sweepRY = 0.011
				addz 0.015
				sweep 9, 4, 0, 1.05, 1+2+4+16+32,
					sweepRX, 0, 1,
					sweepRX, sweepRY-roundOff2, 1,
					sweepRX-roundOff2, sweepRY, 1001,
				   -sweepRX+roundOff2, sweepRY, 1,
				   -sweepRX, sweepRY-roundOff2, 1001,
				   -sweepRX, -sweepRY+roundOff2, 1,
				   -sweepRX+roundOff2, -sweepRY, 1001,
					sweepRX-roundOff2, -sweepRY, 1,
					sweepRX, -sweepRY+roundOff2, 1001,

					0, 0, 0,
					0, -0.002, 0.096,
					0, -0.005, 0.134,
					0, -0.007, 0.152
				del 1
			del 2
			material gs_tap_mat
		endgroup

		group "shower2S"
			add xShowerPos, 0, zShowerPos
			rotx 90
			cylind 0.11, 0.017
			del 2

			material matShowerHead
			add xShowerPos+0.043, -0.083, zShowerPos
			rotx 20
				add 0, 0.017, 0.19+0.015
				rotz -90
				roty 10
				revolve 4, 360, 1+2+4+8+16+32,
					0.045, 0.05, 0,
					0.032, 0.05, 1,
					0.015, 45, 2001,
					0.05, 45, 2001
				material gs_tap_mat
				revolve 2, 360, 1+2+4+8+16+32,
					0.048, 0.045, 0,
					0.045, 0.045, 0
				del 3
			del 2
		endgroup

		placegroup addgroup("shower2S",subgroup("shower1S","tapPartS3"))
		killgroup "shower1S"
		killgroup "shower2S"

	endif


	placegroup addgroup("tapPartS1",addgroup("tapPartS2","tapPartS3"))

	killgroup "tapPartS1"
	killgroup "tapPartS2"
	killgroup "tapPartS3"

else											!! Detailed Model

	for hi = 1 to 2
		rotx 90
		addx -0.075
		cylind 0.024, 0.034
		addz 0.024
		cylind 0.012, 0.017
		del 3
	mulx -1
	next hi
	del 2

	group "tapPartD1"
		add -0.092, -0.036, 0.019
		roty 90
		rotz -90
		prism_ 5, 0.184,
			0, 0, 15,
			0.018, 0, 15+64,
			0.018, 0.038, 1015+64,
			0, 0.038, 15,
			0, 0, -1
		del 3
	endgroup

	group "tapPartD2"
		add 0, -0.06, 0.045
		roty 90
		revolve 4, 360, 1+2+4+8+16+32,
			0, 0.024-roundOff1, 0,
			roundOff1, 0.024, 0,
			0.026, 0.024, 1,
			0.05, 0, 1001
		del 2

		add 0, -0.06, 0.045
		roty -90
		revolve 4, 360, 1+2+4+8+16+32,
			0, 0.024, 0,
			0.035-roundOff1, 0.024, 1,
			0.035, 0.024-roundOff1, 1001,
			0.035, 0, 1
		del 2
	endgroup

	group "tapPartD3"
		dy1 = 0.05		!0.0397
		dz1 = 0.019
		fi = atn(dz1/dy1)

		add 0, -0.05, 0
		rotx 90
		prism_ 21, 0.1287-dy1,
			-0.01365970594825, -0.01273279349163,      11+64,
			-0.01293483876448, -0.01517866874711,      11+64,
			-0.01138167317219, -0.01720238187955,      11+64,
			-0.009206486621482, -0.01853516155718,      11+64,
			-0.0066981677778,       -0.019,      11+64,
			0.0066981677778,       -0.019,      11+64,
			0.009206486621482, -0.01853516155718,      11+64,
			0.01138167317219, -0.01720238187955,      11+64,
			0.01293483876448, -0.01517866874711,      11+64,
			0.01365970594825, -0.01273279349163,      11+64,
			0.01618602173772, 0.01126720650837,      11+64,
			0.01588213414021, 0.01416233412049,      11+64,
			0.01442686544683, 0.01668350539439,      11+64,
			0.01207189135676, 0.01839470631698,      11+64,
			0.009224483567274,        0.019,      11+64,
			-0.009224483567274,        0.019,      11+64,
			-0.01207189135676, 0.01839470631698,      11+64,
			-0.01442686544683, 0.01668350539439,      11+64,
			-0.01588213414021, 0.01416233412049,      11+64,
			-0.01618602173772, 0.01126720650837,      11+64,
			-0.01365970594825, -0.01273279349163,      -1

		addz 0.1287-dy1
		ruled 21, 1+2+4+32,
			-0.01365970594825, -0.01273279349163,      1,
			-0.01293483876448, -0.01517866874711,      1,
			-0.01138167317219, -0.01720238187955,      1,
			-0.009206486621482, -0.01853516155718,      1,
			-0.0066981677778,       -0.019,      1,
			0.0066981677778,       -0.019,      1,
			0.009206486621482, -0.01853516155718,      1,
			0.01138167317219, -0.01720238187955,      1,
			0.01293483876448, -0.01517866874711,      1,
			0.01365970594825, -0.01273279349163,      1,
			0.01618602173772, 0.01126720650837,      1,
			0.01588213414021, 0.01416233412049,      1,
			0.01442686544683, 0.01668350539439,      1,
			0.01207189135676, 0.01839470631698,      1,
			0.009224483567274,        0.019,      1,
			-0.009224483567274,        0.019,      1,
			-0.01207189135676, 0.01839470631698,      1,
			-0.01442686544683, 0.01668350539439,      1,
			-0.01588213414021, 0.01416233412049,      1,
			-0.01618602173772, 0.01126720650837,      1,
			-0.01365970594825, -0.01273279349163,      1,

			-0.01365970594825-0.001, -0.01273279349163+dz1,      dy1,
			-0.01293483876448, -0.01517866874711+dz1,      dy1,
			-0.01138167317219, -0.01720238187955+dz1,      dy1,
			-0.009206486621482, -0.01853516155718+dz1,      dy1,
			-0.0066981677778,       -0.019+dz1,      dy1,
			0.0066981677778,       -0.019+dz1,      dy1,
			0.009206486621482, -0.01853516155718+dz1,      dy1,
			0.01138167317219, -0.01720238187955+dz1,      dy1,
			0.01293483876448, -0.01517866874711+dz1,      dy1,
			0.01365970594825+0.001, -0.01273279349163+dz1,      dy1,
			0.01618602173772, 0.01126720650837,      dy1,
			0.01588213414021, 0.01416233412049,      dy1,
			0.01442686544683, 0.01668350539439,      dy1,
			0.01207189135676, 0.01839470631698,      dy1,
			0.009224483567274,        0.019,      dy1,
			-0.009224483567274,        0.019,      dy1,
			-0.01207189135676, 0.01839470631698,      dy1,
			-0.01442686544683, 0.01668350539439,      dy1,
			-0.01588213414021, 0.01416233412049,      dy1,
			-0.01618602173772, 0.01126720650837,      dy1,
			-0.01365970594825-0.001, -0.01273279349163+dz1,      dy1
		del 1

		del 2

		add -0.01, -0.087-0.06, 0.065
		block 0.02, 0.087, 0.005
		del 1

		add 0, -0.1787+dy1/3*cos(fi), dz1-0.019-dy1/3*sin(fi)
		rotx -fi
		addz -0.005
		cylind 0.008, 0.01
		del 3

	endgroup



	if bShower then
		group "shower1D"
			add 0, -0.1254, -0.009
			roty 90
			revolve 4, 360, 1+2+4+8+16+32,
				0, 0.0135, 0,
				0.016, 0.0135, 0,
				0.016, 0.01, 0,
				0.026, 0.01, 0
			del 2

			add xShowerPos+0.043, -0.083, zShowerPos
			rotx 20
				addz -0.015
				cylind 0.03, 0.01
				del 1
			del 2

			add 0, -0.1254, 0.019
			roty -90
			revolve 4, 360, 1+2+4+8+16+32,
				0, 0.009, 0,
				0.007, 0.009, 0,
				0.007, 0.012, 0,
				0.026, 0.012, 0
			del 2

			add xShowerPos, -0.083, zShowerPos
			rotx 20
				cutpolya 2, 1, 0,
					0.043, 0, 907+64,
					0.01, 360, 4007+64
				cutpolya 5, 1, 0,
					0.043, -0.007, 7,
					0.06, -0.007, 7,
					0.06,  0.007, 7,
					0.043, 0.007, 7,
					0.043, -0.007, -1

				roty 90
				cylind 0.057, 0.015
				del 1
				cutend
				cutend
			del 2

			beta = atn(0.0553/(xShowerPos+0.043))
			for hi = 1 to gs_resol
				alfa = hi * 180/gs_resol
				put (xShowerPos+0.043)/2-(xShowerPos+0.043)/2*cos(alfa), -0.1253+((xShowerPos+0.043)/2-(xShowerPos+0.043)/2*cos(alfa))*tan(beta), -0.135-(xShowerPos+0.043)/2*sin(alfa), 0
			next hi

			tube 4, 8+nsp/4, 1+2+16+32,
				0.0065, 0, 1,
				0, 1, 800,
				-0.0065, 0, 1001,
				0.0065, 0, 1001,

				0, -0.1253, 0, 0,
				0, -0.1253, -0.035, 0,
				0, -0.1253, -0.135, 0,
				get(nsp),
				xShowerPos+0.043, -0.07, -0.135, 90-beta,
				xShowerPos+0.043, -0.07, zShowerPos-0.05, 90-beta,
				xShowerPos+0.043, -0.083+0.03*sin(20), zShowerPos-0.03*cos(20), 90-beta,
				xShowerPos+0.043, -0.083+0.015*sin(20), zShowerPos-0.015*cos(20), 0,
				xShowerPos+0.043, -0.083-0.015*sin(20), zShowerPos+0.015*cos(20), 0

			material matShowerHead
			add xShowerPos+0.043, -0.083, zShowerPos
			rotx 20
				sweepRX = 0.01
				sweepRY = 0.011
				addz 0.015
				sweep 9, 4, 0, 1.05, 1+2+4+16+32,
					sweepRX, 0, 1,
					sweepRX, sweepRY-roundOff2, 1,
					sweepRX-roundOff2, sweepRY, 1001,
				   -sweepRX+roundOff2, sweepRY, 1,
				   -sweepRX, sweepRY-roundOff2, 1001,
				   -sweepRX, -sweepRY+roundOff2, 1,
				   -sweepRX+roundOff2, -sweepRY, 1001,
					sweepRX-roundOff2, -sweepRY, 1,
					sweepRX, -sweepRY+roundOff2, 1001,

					0, 0, 0,
					0, -0.002, 0.096,
					0, -0.005, 0.134,
					0, -0.007, 0.152


				del 1
			del 2
			material gs_tap_mat
		endgroup

		group "shower2D"
			add xShowerPos, 0, zShowerPos
			rotx 90
			cylind 0.11, 0.017
			del 2

			material matShowerHead
			add xShowerPos+0.043, -0.083, zShowerPos
			rotx 20
				add 0, 0.017, 0.19+0.015
				rotz -90
				roty 10
				revolve 3, 360, 1+2+4+8+16+32,
					0.045, 0.05, 0,
					0.018, 0.05, 2,
					0.012, 0.03, 0
				material gs_tap_mat
				revolve 2, 360, 1+2+4+8+16+32,
					0.048, 0.045, 0,
					0.045, 0.045, 0
				del 3
			del 2
		endgroup

		placegroup addgroup("shower2D",subgroup("shower1D","tapPartD3"))
		killgroup "shower1D"
		killgroup "shower2D"

	endif


	placegroup addgroup("tapPartD1",addgroup("tapPartD2","tapPartD3"))

	killgroup "tapPartD1"
	killgroup "tapPartD2"
	killgroup "tapPartD3"

ENDIF

return


! ==============================================================================
! Wall Mounted Tap
! ==============================================================================
220:

hotspot -0.1015, 0, 0, unID : unID=unID+1
hotspot  0.1015, 0, 0, unID : unID=unID+1

resol gs_resol

if GLOB_CONTEXT > 20 and GLOB_CONTEXT < 40 or gs_detlevel_3D_m = 1 then

	for hi = 1 to 2
		rotx 90
		addx -0.1015
		cylind 0.0035, 0.025
		addz 0.0035
		cylind 0.0465, 0.015
		del 3
	mulx -1
	next hi
	del 2

	group "openerS1"
		for hi = 1 to 2
			add -0.1015, -0.0675, 0
			addz -0.035
			cylind 0.07, 0.0065
			del 2
		mulx -1
		next hi
		del 2
	endgroup

	group "openerS2"
		for hi = 1 to 2
			add -0.1015, -0.0675, 0
			addx -0.035
			roty 90
			cylind 0.07, 0.0065
			del 3
		mulx -1
		next hi
		del 2
	endgroup

	group "openerS3"
		for hi = 1 to 2
			rotx 90
			add -0.1015, 0, 0.05
			cylind 0.0175, 0.0065
			del 2
		mulx -1
		next hi
		del 2
	endgroup

	placegroup addgroup("openerS1",addgroup("openerS2","openerS3"))
	killgroup "openerS1"
	killgroup "openerS2"
	killgroup "openerS3"

	rotx 90
	cylind 0.007, 0.03
	del 1

	for hi = 1 to ceil(gs_resol/2)
		alfa = hi * 50/ceil(gs_resol/2)
		put 0, -0.163-0.048*sin(alfa), -0.048+0.048*cos(alfa), 0
	next hi

	tube 2, 5+nsp/4, 1+2+16+32,
		0, 0, 901,
		0.012, 360, 4001,

		0, 0, 0, 0,
		0, -0.007, 0, 0,
		0, -0.163, 0, 0,
		get(nsp),
		0, -0.163-0.048*sin(50)-0.03*cos(50), -0.048+0.048*cos(50)-0.03*sin(50), 0,
		0, -0.163-0.048*sin(50)-0.04*cos(50), -0.048+0.048*cos(50)-0.04*sin(50), 0

else

	for hi = 1 to 2
		rotx 90
		addx -0.1015
		cylind 0.0035, 0.025
		addz 0.0035
		cylind 0.0035, 0.0175
		addz 0.0035
		cylind 0.043, 0.015
		del 4
	mulx -1
	next hi
	del 2

	group "openerD1"
		for hi = 1 to 2
			add -0.1015, -0.0675, 0
			addz -0.035
			cylind 0.07, 0.0065
			del 2
		mulx -1
		next hi
		del 2
	endgroup

	group "openerD2"
		for hi = 1 to 2
			add -0.1015, -0.0675, 0
			addx -0.035
			roty 90
			cylind 0.07, 0.0065
			del 3
		mulx -1
		next hi
		del 2
	endgroup

	group "openerD3"
		for hi = 1 to 2
			rotx 90
			add -0.1015, 0, 0.05
			cylind 0.0175, 0.0065
			del 2
		mulx -1
		next hi
		del 2
	endgroup

	placegroup addgroup("openerD1",addgroup("openerD2","openerD3"))
	killgroup "openerD1"
	killgroup "openerD2"
	killgroup "openerD3"

	rotx 90
	cylind 0.007, 0.03
	del 1

	addy -0.007
	rotx 90
	cylind 0.007, 0.02
	del 2

	for hi = 1 to ceil(gs_resol/2)
		alfa = hi * 50/ceil(gs_resol/2)
		put 0, -0.163-0.048*sin(alfa), -0.048+0.048*cos(alfa), 0
	next hi

	tube 2, 5+nsp/4, 1+2+16+32,
		0, 0, 901,
		0.012, 360, 4001,

		0, 0, 0, 0,
		0, -0.014, 0, 0,
		0, -0.163, 0, 0,
		get(nsp),
		0, -0.163-0.048*sin(50)-0.012*cos(50), -0.048+0.048*cos(50)-0.012*sin(50), 0,
		0, -0.163-0.048*sin(50)-0.022*cos(50), -0.048+0.048*cos(50)-0.022*sin(50), 0

	add 0, -0.163-0.048*sin(50)-0.012*cos(50), -0.048+0.048*cos(50)-0.012*sin(50)
	rotx 140
	cylind 0.018, 0.0125
	del 2

endif

return


! ==============================================================================
! Wall Mounted Tap
! ==============================================================================
230:

hotspot -0.1015, 0, 0, unID : unID=unID+1
hotspot  0.1015, 0, 0, unID : unID=unID+1

resol gs_resol

if GLOB_CONTEXT > 20 and GLOB_CONTEXT < 40 or gs_detlevel_3D_m = 1 then

	group "tapPartS5"
		for hi = 1 to 2
			rotx 90
			addx -0.1015
			cylind 0.0035, 0.025
			addz 0.0035
			cylind 0.0565, 0.01
			del 5-2
		mulx -1
		next hi
		del 2

		add 0, -0.06, 0.01
		roty 0
		revolve 6, 360, 1+2+4+8+16+32,
			-0.1015, 0.012, 1,
			-0.035, 0.012, 1,
			-0.0125, 0.015, 1,
			0.0125, 0.015, 1,
			0.035, 0.012, 1,
			0.1015, 0.012, 1
		del 2

		for hi = 1 to 2
			add -0.1015, -0.06+0.002, 0.057
			rotx 90
			prism_ 5, 0.004,
				-0.05, -0.008, 15,
				 0.012, -0.008, 15,
				 0.012,  0.008, 15,
				-0.05,  0.008, 15,
				-0.05, -0.008, -1
			del 2
		mulx -1
		next hi
		del 2

		for hi = 1 to gs_resol
			alfa = hi * 90/gs_resol
			put 0, -0.201-0.022*sin(alfa), -0.022+0.022*cos(alfa)+0.055, 0
		next hi

		tube 2, 5+nsp/4, 1+2+16+32,
			0, 0, 901,
			0.012, 360, 4001,

			0, 0, 0.055, 0,
			0, -0.06, 0.055, 0,
			0, -0.201, 0.055, 0,
			get(nsp),
			0, -0.223, -0.036+0.055, 0,
			0, -0.223, -1, 0
	endgroup

	group "tapPartS6"
		for hi = 1 to 2
			add -0.1015, -0.06, -0.015
			roty -90
			revolve 2, 360, 1+2+4+8+16+32,
				0, 0.015, 0,
				0.064, 0.015, 0
			del 2
		mulx -1
		next hi
		del 2

		add 0, -0.06, 0.03
		roty -90
		revolve 6, 360, 1+2+4+8+16+32,
			-0.015, 0.015, 0,
			0, 0.0125, 0,
			0.025, 0.02, 1,
			0.05, 0.02, 0,
			0.05, 0.023, 0,
			0.06, 0.02, 0
		del 2

		for hi = 1 to 2
			add 0.001, -0.175, 0.065
			block 0.002, 0.01, 0.012
			del 1

			add 0.001, -0.012, 0.230
			block 0.002, 0.01, 0.01
			del 1
		mulx -1
		next hi
		del 2

		addx 0.001
		rotz -90
		rotx 90
		prism_ 7, 0.002,
			0.17+0.005*sin(45), 0.072-0.005*sin(45), 15,
			0.17+0.005*sin(45), 0.072+0.005*sin(45), 15,
			0.007+0.005*sin(45), 0.235+0.005*sin(45), 15,
			0.007-0.005*sin(45), 0.235+0.005*sin(45), 15,
			0.007-0.005*sin(45), 0.235-0.005*sin(45), 15,
			0.17-0.005*sin(45), 0.072-0.005*sin(45), 15,
			0.17+0.005*sin(45), 0.072-0.005*sin(45), -1
		del 3

		add 0, 0, 0.235
		rotx 90
		mulx 2
		cylind 0.002, 0.009
		del 3
	endgroup

	placegroup addgroup("tapPartS5","tapPartS6")

else

	group "tapPartD5"
		for hi = 1 to 2
			rotx 90
			addx -0.1015
			cylind 0.0035, 0.025
			addz 0.0035
			cylind 0.0035, 0.0175
			addz 0.0035
			cylind 0.043, 0.01
			del 5-1
		mulx -1
		next hi
		del 2

		add 0, -0.06, 0.01
		roty 0
		revolve 6, 360, 1+2+4+8+16+32,
			-0.1015, 0.012, 1,
			-0.035, 0.012, 1,
			-0.0125, 0.015, 1,
			0.0125, 0.015, 1,
			0.035, 0.012, 1,
			0.1015, 0.012, 1
		del 2

		for hi = 1 to 2
			add -0.1015, -0.06+0.002, 0.057
			rotx 90
			prism_ 11, 0.004,
				-0.05, -0.005, 15,
				-0.012, -0.005, 15,
				-0.005, -0.008, 15,
				 0.005, -0.008, 15,
				 0.012, -0.005, 15,
				 0.012,  0.005, 15,
				 0.005,  0.008, 15,
				-0.005,  0.008, 15,
				-0.012,  0.005, 15,
				-0.05,   0.005, 15,
				-0.05,  -0.005, -1
			del 2
		mulx -1
		next hi
		del 2

		for hi = 1 to gs_resol
			alfa = hi * 90/gs_resol
			put 0, -0.201-0.022*sin(alfa), -0.022+0.022*cos(alfa)+0.055, 0
		next hi

		tube 2, 5+nsp/4, 1+2+16+32,
			0, 0, 901,
			0.012, 360, 4001,

			0, 0, 0.055, 0,
			0, -0.06, 0.055, 0,
			0, -0.201, 0.055, 0,
			get(nsp),
			0, -0.223, -0.024+0.055, 0,
			0, -0.223, -1, 0

		add 0, -0.223, -0.036+0.055
		cylind 0.012, 0.0125
		del 1
	endgroup

	group "tapPartD6"
		for hi = 1 to 2
			add -0.1015, -0.06, -0.015
			roty -90
			revolve 10, 360, 1+2+4+8+16+32,
				0, 0.015, 0,
				0.04, 0.015, 0,
				0.04, 0.012, 0,
				0.048, 0.012, 0,
				0.048, 0.0123, 1,
				0.004, -150, 2001,
				0.062, 0.004, 0,
				0.064, 0.004, 0,
				0.064, 0.005, 0,
				0.08, 0.005, 0
			del 2
		mulx -1
		next hi
		del 2

		add 0, -0.06, 0.03
		roty -90
		revolve 7, 360, 1+2+4+8+16+32,
			-0.015, 0.015, 0,
			0, 0.0125, 0,
			0.025, 0.02, 1,
			0.05, 0.02, 0,
			0.05, 0.023, 0,
			0.058, 0.02, 1,
			0.06, 0.0175, 1001
		del 2

		for hi = 1 to 2
			add 0.001, -0.175, 0.065
			block 0.002, 0.01, 0.012
			del 1

			add 0.001, -0.012, 0.230
			block 0.002, 0.01, 0.01
			del 1
		mulx -1
		next hi
		del 2

		addx 0.001
		rotz -90
		rotx 90
		prism_ 7, 0.002,
			0.17+0.005*sin(45), 0.072-0.005*sin(45), 15,
			0.17+0.005*sin(45), 0.072+0.005*sin(45), 15,
			0.007+0.005*sin(45), 0.235+0.005*sin(45), 15,
			0.007-0.005*sin(45), 0.235+0.005*sin(45), 15,
			0.007-0.005*sin(45), 0.235-0.005*sin(45), 15,
			0.17-0.005*sin(45), 0.072-0.005*sin(45), 15,
			0.17+0.005*sin(45), 0.072-0.005*sin(45), -1
		del 3

		add 0, 0, 0.235
		rotx 90
		mulx 2
		cylind 0.002, 0.009
		del 3
	endgroup

	placegroup addgroup("tapPartD5","tapPartD6")

endif

return


! ==============================================================================
! Wall Mounted Tap - Wall Mounted Thermostatic Shower
! ==============================================================================
240:

resol gs_resol

tapHeight = 0.088
tapWidth = 0.312
axisAngle = 71
axisLength = tapHeight / sin(axisAngle)
tapRadius = 0.022
hillAngle = 135
coneHeight = tapRadius * tan(hillAngle)
noseWidth = 0.048
noseHeight = 0.035
noseLength = 0.135
filletRadius = 0.003
openerWidth = 0.016
openerHeight = 0.009
openerLength = 0.053
openerRadius = 0.024
noseZPos = (tapHeight - openerRadius) / sin(axisAngle) + openerRadius - 0.002

hotspot -0.075, 0, 0, unID : unID=unID+1
hotspot  0.075, 0, 0, unID : unID=unID+1

add -tapWidth/2 + openerLength + 0.002, 0, 0
roty 90
prism_ 5, tapWidth - 2*openerLength - 0.004,
	-openerRadius, -0.044, 15,
	-openerRadius, -0.06 - openerRadius, 15+64,
	openerRadius, -0.06 - openerRadius, 1015+64,
	openerRadius, -0.044, 15,
	-openerRadius, -0.044, -1
del 2

for ji = 1 to 2
	addx -0.075
	rotz -90
	revolve 3, 360, 1+2+4+8+16+32,
		0, 0.035, 0,
		0.007, 0.035, 0,
		0.027, 0.016, 0
	del 2

	add -0.075, -0.027, 0
	rotx 90
	prism_ 7, 0.017,
		0.019, 0, 15,
		0.019*cos(60), 0.019*sin(60), 15,
	   -0.019*cos(60), 0.019*sin(60), 15,
	   -0.019, 0, 15,
	   -0.019*cos(60), -0.019*sin(60), 15,
		0.019*cos(60), -0.019*sin(60), 15,
		0.019, 0, -1
	del 2

	add tapWidth/2 - openerLength - 0.002, -0.084, 0
	roty 90
	cylind 0.002, openerRadius - 0.001
	del 2

	add tapWidth/2 - openerLength, -0.084, 0
	roty 90
	gi = 55
	hprism_ gs_tap_mat, gs_tap_mat, gs_tap_mat, gs_tap_mat,
		6, openerLength, 0, filletRadius, 1,
		openerRadius*cos(gi) - openerRadius*cos(90-gi)*0.6, -openerRadius*sin(gi) - openerRadius*sin(90-gi)*0.6, 11 + maskSection,
		-openerRadius*cos(gi) + openerRadius*cos(90-gi)*0.6, -openerRadius*sin(gi) - openerRadius*sin(90-gi)*0.6, 11 + maskSection,
		-openerRadius*cos(gi), -openerRadius*sin(gi), 11 + 64 + maskSection,
		0, 0, 900,
		openerRadius*cos(gi), -openerRadius*sin(gi), 1011 + 64 + maskSection,
		openerRadius*cos(gi) - openerRadius*cos(90-gi)*0.6, -openerRadius*sin(gi) - openerRadius*sin(90-gi)*0.6, -1
	del 2
mulx -1
next ji
del 2

add 0, -0.07, openerRadius
cylind 0.001, 0.012
del 1

xShowerPos = 0.25
zShowerPos = 0.75
xShowerOpenerPos = 0
zShowerOpenerPos = 0.097
yShowerOpenerPos = -0.07
showerOpenerAngle = 90
showerHeadAngle = 25
xShowerHeadPos = 0
yShowerHeadPos = -0.044
xShowerHolderPos = xShowerPos - 0.034
pipeRadius = 0.011
soapDishRadius = 0.055
soapDishHeight = 0.023
tubeTorsion1 = 90
tubeTorsion2 = tubeTorsion1
tubeTorsion3 = tubeTorsion1

gosub "shower kit for wallmounted taps"

add 0, -0.07, -openerRadius - 0.015
cylind 0.015, 0.008
del 1

for hi = 1 to 2
	add xShowerHolderPos, 0, zShowerPos- 0.708
	prism_ 5, 0.051,
		-pipeRadius, 0, 15,
		-pipeRadius, yShowerHeadPos, 15 + 64,
		pipeRadius, yShowerHeadPos, 1015 + 64,
		pipeRadius, 0, 15,
		-pipeRadius, 0, -1
	del 1
addz 0.906
next hi
del 2

add xShowerHolderPos, yShowerHeadPos, zShowerPos - 0.708 + 0.051
cylind 0.855, pipeRadius
del 1

psi = asn((pipeRadius+0.002)/soapDishRadius)
add xShowerHolderPos, yShowerHeadPos, zShowerPos - 0.588
cutpolya 4, 1, 0,
	-(soapDishRadius-0.002)*sin(psi), -pipeRadius - 0.002 - soapDishRadius*cos(psi) + (soapDishRadius-0.002)*cos(psi), 3 + 64,
	0, -pipeRadius - 0.002 - soapDishRadius*cos(psi), 903,
	0, 360 - 2*psi, 4003 + 64,
	-(soapDishRadius-0.002)*sin(psi), -pipeRadius - 0.002 - soapDishRadius*cos(psi) + (soapDishRadius-0.002)*cos(psi), -1

prism_ 6 + 2, 0.02,
	-piperadius - 0.002, -piperadius - 0.002, 15 + 64,
	0, -pipeRadius - 0.002 - soapDishRadius*cos(psi), 900,
	0, 360 - 2*psi, 4000+15,
	pipeRadius + 0.002, 0, 15 + 64,
	-piperadius - 0.002, 0, 1015 + 64,
	-piperadius - 0.002, -piperadius - 0.002, -1,

	0, 0, 915 + 64,
	pipeRadius, 360, 4015 + 64
cutend

prism_ 4, 0.002,
	-(soapDishRadius-0.002)*sin(psi), -pipeRadius - 0.002 - soapDishRadius*cos(psi) + (soapDishRadius-0.002)*cos(psi), 14 + 64,
	0, -pipeRadius - 0.002 - soapDishRadius*cos(psi), 900,
	0, 360 - 2*psi, 4014 + 64,
	-(soapDishRadius-0.002)*sin(psi), -pipeRadius - 0.002 - soapDishRadius*cos(psi) + (soapDishRadius-0.002)*cos(psi), -1

del 1

return

! ==============================================================================
! Wall Mounted Tap - Shower Pipe
! ==============================================================================
250:

resol gs_resol

tapHeight = 0.088
tapWidth = 0.312
axisAngle = 71
axisLength = tapHeight / sin(axisAngle)
tapRadius = 0.022
hillAngle = 135
coneHeight = tapRadius * tan(hillAngle)
noseWidth = 0.048
noseHeight = 0.035
noseLength = 0.135
filletRadius = 0.003
openerWidth = 0.016
openerHeight = 0.009
openerLength = 0.053
openerRadius = 0.024
noseZPos = (tapHeight - openerRadius) / sin(axisAngle) + openerRadius - 0.002

hotspot -0.075, 0, 0, unID : unID=unID+1
hotspot  0.075, 0, 0, unID : unID=unID+1

for hi = 1 to 2
	addx -0.075
	rotx 90
	cylind 0.026, 0.034
	del 2

	add -0.075, -0.026, 0
	rotx 90
	prism_ 7, 0.014,
		0.018, 0, 15,
		0.018*cos(60), 0.018*sin(60), 15,
	   -0.018*cos(60), 0.018*sin(60), 15,
	   -0.018, 0, 15,
	   -0.018*cos(60), -0.018*sin(60), 15,
		0.018*cos(60), -0.018*sin(60), 15,
		0.018, 0, -1
	del 2

	add -0.075, -0.04, 0
	rotx 90
	cylind 0.008, 0.014
	del 2
mulx -1
next hi
del 2

szi = asn(10/26)
addy -0.048
rotx 90
prism_ 10, 0.04,
	0, 0.018, 13,
	-0.075, 0.018, 15 + 64,
	-0.075, -0.018, 1015 + 64,
	-0.026*cos(szi) - 0.00002, -0.018, 15,
	-0.026*cos(szi), -0.018, 15 + 64,
	0, -0.008, 915 + 64,
	0, 180 - 2*szi, 4015,
	0.075, -0.018, 15 + 64,
	0.075, 0.018, 1015 + 64,
	0, 0.018, -1
del 2

add 0, -0.088, -0.008
rotx 90
cylind 0.015, 0.025
del 2

add 0, -0.105, -0.008
rotz 90
rotx 90
cutpolya 5, 1, 0,
	0, 0, 7,
	-0.007, 0.025, 7,
	-0.02, 0.025, 7,
	-0.02, -0.025, 7,
	0, -0.025, 7
del 3

add 0, -0.103, -0.008
rotx 90
prism_ 2, 0.01,
	0, 0, 915 + 64,
	0.0235, 360, 4015 + 64
del 2

cutend

add 0, -0.105, -0.008
rotz 90
rotx 90
cutpolya 3, 1, 0,
	0, 0, 7,
	-0.007, 0.025, 7,
	0, 0.025, 7
del 3

zzi = asn(4/26)
add 0, -0.105, -0.008
rotx 90
prism_ 4, 0.023,
	0.025*sin(zzi), -0.025*cos(zzi), 11 + 64,
	0, 0, 911,
	0, 360 - 2*zzi, 4015 + 64,
	0.025*sin(zzi), -0.025*cos(zzi), 1000
del 2

cutend

add 0, -0.128, -0.008
rotx 90
prism_ 7, 0.017,
	0.025*sin(zzi), -0.025*cos(zzi), 14 + 64,
	0, 0, 914,
	0, 360 - 2*zzi, 4015,
	-0.025*sin(zzi), -0.078, 15 + 64,
	0.025*sin(zzi), -0.078, 1015 + 64,
	0.025*sin(zzi), -0.025*cos(zzi) - 0.00002, 15,
	0.025*sin(zzi), -0.025*cos(zzi), -1
del 2

xShowerPos = 0.22
zShowerPos = 0.56
xShowerOpenerPos = -0.051
zShowerOpenerPos = 0.097
yShowerOpenerPos = -0.07
showerOpenerAngle = 90
showerHeadAngle = 25
xShowerHeadPos = -0.132
yShowerHeadPos = -0.062
xShowerHolderPos = 0
pipeRadius = 0.011
soapDishRadius = 0.055
soapDishHeight = 0.023
tubeTorsion1 = 0
tubeTorsion2 = 60
tubeTorsion3 = 120

gosub "shower kit for wallmounted taps"

add xShowerOpenerPos - 0.0035, -0.07, 0.018
roty -90
revolve 4, 360, 1+2+4+8+16+32,
	0, 0.007, 0,
	0.006, 0.007, 0,
	0.006, 0.009, 0,
	0.024, 0.009, 0
del 2

add xShowerOpenerPos, -0.07, -0.018 - 0.021
cylind 0.021, 0.008
del 1

addz 1.03
rotz -90
revolve 4, 360, 1+2+4+8+16+32,
	0, 0.04, 0,
	0.008, 0.04, 0,
	0.008, 0.012, 0,
	0.485, 0.012, 0
del 2

rotx 90
cutpolya 2, 1, 0,
	0, 1.03, 907 +64,
	0.012, 360, 4007 + 64
del 1

add 0, -0.062, 0.018
cylind 1.012, 0.011
del 1

add 0, -0.463, 1.03
roty 90
revolve 8, 360, 1+2+4+8+16+32,
	0, 0.011, 0,
	0.013, 0.011, 0,
	0.013, 0.05, 0,
	0.016, 0.05, 0,
	0.016, 0.12, 0,
	0.028, 0.12, 0,
	0.028, 0.11, 0,
	0.03, 0.11, 0
del 2

cutend

return


! ==============================================================================
! Wall Mounted Tap - Shower Panel
! ==============================================================================
260:

resol gs_resol

panelWidth = 0.3
panelDepth = 0.12
panelHeight = 1.4
recessDepth = 0.04
zPanelPos = -0.36
showerHeadRadius = 0.012

hotspot 0, 0, 0, unID : unID=unID+1

addz -0.36
mulx -1

addx -panelWidth/2 + recessDepth
roty -90
cutform 5, 1, 1+16+64+128,
	0, 0, -1, 0,
	0.048, -0.01, 15 + 16,
	0.565, -0.01, 15 + 16,
	0.565, -panelDepth + 0.01, 15 + 16,
	0.048, -panelDepth + 0.01, 15 + 16,
	0.048, -0.01, -1

cutform 5, 1, 1+16+64+128,
	0, 0, -1, 0,
	0.575, -0.01, 15 + 16,
	0.975, -0.01, 15 + 16,
	0.975, -panelDepth + 0.01, 15 + 16,
	0.575, -panelDepth + 0.01, 15 + 16,
	0.575, -0.01, -1

cutform 5, 1, 1+16+64+128,
	0, 0, -1, 0,
	0.985, -0.01, 15 + 16,
	panelHeight - 0.01, -0.01, 15 + 16,
	panelHeight - 0.01, -panelDepth + 0.01, 15 + 16,
	0.985, -panelDepth + 0.01, 15 + 16,
	0.985, -0.01, -1
del 2

cutform 5, 1, 1+64+128,
	0, 0, 1, 0.048,
	-panelWidth/2, -panelDepth/2 - showerHeadRadius + 0.001, 15 + 16,
	-panelWidth/2 + 0.009, -panelDepth/2 - showerHeadRadius + 0.001, 15 + 16 + 64,
	-panelWidth/2 + 0.009, -panelDepth/2 + showerHeadRadius - 0.001, 1013 + 16 + 64,
	-panelWidth/2, -panelDepth/2 + showerHeadRadius - 0.001, 15 + 16 + 64,
	-panelWidth/2, -panelDepth/2 - showerHeadRadius + 0.001, -1

addx panelWidth/2 - recessDepth
roty -90
cutform 5, 1, 1+16+64+128,
	0, 0, 1, 0,
	0.01, -0.01, 15 + 16,
	0.46, -0.01, 15 + 16,
	0.46, -panelDepth + 0.01, 15 + 16,
	0.01, -panelDepth + 0.01, 15 + 16,
	0.01, -0.01, -1

cutform 5, 1, 1+16+64+128,
	0, 0, 1, 0,
	0.47, -0.01, 15 + 16,
	0.92, -0.01, 15 + 16,
	0.92, -panelDepth + 0.01, 15 + 16,
	0.47, -panelDepth + 0.01, 15 + 16,
	0.47, -0.01, -1

cutform 5, 1, 1+16+64+128,
	0, 0, 1, 0,
	0.93, -0.01, 15 + 16,
	panelHeight - 0.01, -0.01, 15 + 16,
	panelHeight - 0.01, -panelDepth + 0.01, 15 + 16,
	0.93, -panelDepth + 0.01, 15 + 16,
	0.93, -0.01, -1
del 2

add -panelWidth/2, -panelDepth, 0
block panelWidth, panelDepth, panelHeight
del 1

for ki = 1 to 7
	cutend
next ki

for mi = 1 to 3
	for li = 1 to 2
		add -0.04, -panelDepth, 0.175
		rotz -90
		revolve 4, 360, 1+2+4+8+16+32,
			0, 0.025, 0,
			0.001, 0.025, 0,
			0.001, 0.011, 0,
			0.007, 0.011, 0
		del 2
	mulx -1
	next li
	del 2
addz 0.22
next mi
del 3

tubeX1 = 0.033
tubeR1 = 0.35
tubeFi = 27
tubeR2 = tubeX1 + tubeR1 - 2*(tubeR1)*cos(tubeFi) + tubeR1
tubeZ1 = (tubeX1+tubeR1) * tan(tubeFi)

nTubePoint1 = 6
for hi = 1 to nTubePoint1
alfa = tubeFi/nTubePoint1
put tubeX1 + tubeR1 - tubeR1*cos(hi*alfa), 0, - tubeR1*sin(hi*alfa), 0
next hi

nTubePoint2 = 6
for ii = 1 to nTubePoint2
beta = tubeFi/nTubePoint2
put tubeX1 + tubeR1 - 2*tubeR1*cos(tubeFi) + tubeR1*cos(tubeFi-ii*beta), 0, - 2*tubeR1*sin(tubeFi) + tubeR1*sin(tubeFi-ii*beta), 0
next ii

nTubePoint3 = 16
for ji = 1 to nTubePoint3
ceta = 180/nTubePoint3
put tubeR2*cos(-ji*ceta), 0, - 2*tubeR1*sin(tubeFi) + tubeR2*sin(-ji*ceta)*1.4, 0
next ji

nTubePoint2 = 6
for ki = 1 to nTubePoint2
deta = tubeFi/nTubePoint2
put -tubeX1 - tubeR1 + 2*tubeR1*cos(tubeFi) - tubeR1*cos(ki*deta), 0, - 2*tubeR1*sin(tubeFi) + tubeR1*sin(ki*deta), 0
next ki

nTubePoint3 = 6
for li = 1 to nTubePoint3
eeta = tubeFi/nTubePoint3
put -tubeX1 - tubeR1 + tubeR1*cos(tubeFi-li*eeta), 0, - tubeR1*sin(tubeFi-li*eeta), 0
next li

add -0.108, -panelDepth/2, -0.04
tube 2, 5 + nsp/4, 1+2+16+32+64*0,
	0, 0, 901,
	0.008, 360, 4001,

	tubeX1, 0, 1, 0,
	tubeX1, 0, 0.01, 0,
	tubeX1, 0, 0, 0,
	get(nsp),
	-tubeX1, 0, 0.04, 0,
	-tubeX1, 0, 1, 0
del 1

add -0.108 + tubeX1, -panelDepth/2, -0.03
cylind 0.03, 0.009
del 1

add -panelWidth/2 + 0.009, -panelDepth/2, 0
roty -90
revolve 4, 360, 1+2+4+8+16+32,
	0, 0.01, 0,
	0.048, 0.01, 0,
	0.048, 0.012, 0,
	0.223, 0.012, 0
del 2

for mi = 1 to 3
	add -panelWidth/2 + 0.04, -panelDepth/2, 0.304
	roty -90
	cylind 0.05, 0.02
	del 2
addz 0.06
next mi
del 3

add -panelWidth/2 + 0.04, -panelDepth/2, 0.504
roty -90
cylind 0.05, 0.025
del 2

cutpolya 2, 1, 0,
	0, -0.517, 907 + 64,
	0.016, 360, 4007 + 64

add 0, -panelDepth, 1.255
rotx 90
cylind 0.517 - panelDepth, 0.012
del 2

cutend

add 0, -0.517, 1.24
roty 90
revolve 10, 360, 1+2+4+8+16+32,
	-0.03, 0.016, 0,
	0, 0.016, 0,
	0, 0.011, 0,
	0.013, 0.011, 0,
	0.013, 0.05, 0,
	0.016, 0.05, 0,
	0.016, 0.12, 0,
	0.028, 0.12, 0,
	0.028, 0.11, 0,
	0.03, 0.11, 0
del 2

del 2

return


! ==============================================================================
! Wall Mounted Tap - Overhead Shower Armature
! ==============================================================================
270:

resol gs_resol

panelWidth = 0.166
panelDepth = 0.015
panelHeight = 0.266
openerRadius = 0.022
openerLength = 0.055

hotspot 0, 0, 0, unID : unID=unID+1

rotx 90
prism_ 6, panelDepth,
	-panelWidth/2, 0, 13,
	-panelWidth/2, -panelHeight/2 + panelWidth/2, 15 + 64,
	 panelWidth/2, -panelHeight/2 + panelWidth/2, 1015 + 64,
	 panelWidth/2,  panelHeight/2 - panelWidth/2, 15 + 64,
	-panelWidth/2,  panelHeight/2 - panelWidth/2, 1015 + 64,
	-panelWidth/2, 0, -1
del 1

for hi = 1 to 2
	add 0, -panelDepth, -0.05
	rotz -90
	revolve 2, 360, 1+2+4+8+16+32,
		0, openerRadius - 0.002, 0,
		0.03, openerRadius - 0.002, 0
	del 2

	add 0, -panelDepth - 0.03, -0.05
	rotx 90
	rotz 180
	gi = 45
	openerResize = 0.8
	prism_ 6, openerLength,
		openerRadius*cos(gi) - openerRadius*cos(90-gi)*openerResize, -openerRadius*sin(gi) - openerRadius*sin(90-gi)*openerResize, 15,
		-openerRadius*cos(gi) + openerRadius*cos(90-gi)*openerResize, -openerRadius*sin(gi) - openerRadius*sin(90-gi)*openerResize, 15,
		-openerRadius*cos(gi), -openerRadius*sin(gi), 15+64,
		0, 0, 900,
		openerRadius*cos(gi), -openerRadius*sin(gi), 1015+64,
		openerRadius*cos(gi) - openerRadius*cos(90-gi)*openerResize, -openerRadius*sin(gi) - openerRadius*sin(90-gi)*openerResize, -1
	del 3
addz 0.1
next hi
del 2

add xShowerHeadPos, yShowerHeadPos, zShowerHeadPos
roty 90
revolve 12, 360, 1+2+4+8+16+32,
	0, 0.012, 0,
	0.013, 0.012, 0,
	0.013, 0.01, 0,
	0.016, 0.01, 0,
	0.016, 0.012, 0,
	0.037, 0.012, 0,
	0.037, 0.05, 0,
	0.04, 0.05, 0,
	0.04, 0.12, 0,
	0.052, 0.12, 0,
	0.052, 0.11, 0,
	0.054, 0.11, 0
del 2

if bEnableShowerEdit then
	hotspot 0, yShowerHeadPos, zShowerHeadPos, unID, xShowerHeadPos, 1+128 : unID=unID+1
	hotspot xShowerHeadPos, yShowerHeadPos, zShowerHeadPos, unID, xShowerHeadPos, 2 : unID=unID+1
	hotspot -1, yShowerHeadPos, zShowerHeadPos, unID, xShowerHeadPos, 3 : unID=unID+1

	hotspot xShowerHeadPos, 0, zShowerHeadPos, unID, yShowerHeadPos, 1+128 : unID=unID+1
	hotspot xShowerHeadPos, yShowerHeadPos, zShowerHeadPos, unID, yShowerHeadPos, 2 : unID=unID+1
	hotspot xShowerHeadPos, -1, unID, zShowerHeadPos, yShowerHeadPos, 3 : unID=unID+1

	hotspot 0, yShowerHeadPos, 0, unID, zShowerHeadPos, 1+128 : unID=unID+1
	hotspot 0, yShowerHeadPos, zShowerHeadPos, unID, zShowerHeadPos, 2 : unID=unID+1
	hotspot 0, yShowerHeadPos, -1, unID, zShowerHeadPos, 3 : unID=unID+1
endif

return


! ==============================================================================
! Optional Shower Kit
! ==============================================================================
"shower kit":

roundOff1 = 0.002
roundOff2 = 0.007
yShowerHeadPos = -0.053

if ShowerOpenerAngle < 0 then

	yTubePos = -0.004
	add 0, -0.004, 0.066 - 0.021
	roty -90
	revolve 10, 360, 1+2+4+8+16+32,
		0, 0.027, 0,
		0.042, 0.027, 0,
		0.042, 0.013, 0,
		0.054, 0.013, 0,
		0.054, 0.015, 0,
		0.064, 0.015, 0,
		0.064, 0.019, 0,
		0.084, 0.019, 0,
		0.084, 0.012, 0,
		0.103, 0.012, 0
	del 2

	beta = atn((yWallPos + yShowerHeadPos - yTubePos - yTapPos)/(xShowerPos))

	for ji = 1 to 2*gs_resol
		alfa = ji * 180/gs_resol/2
		put xShowerOpenerPos + xShowerPos/4 - xShowerPos/4*cos(alfa), yShowerOpenerPos + ((xShowerPos)/4-(xShowerPos)/4*cos(alfa))*tan(beta), 0.15 + (xShowerPos)/4*sin(alfa), 0
	next ji

	for ji = 1 to 2*gs_resol
		alfa = ji * 180/gs_resol/2
		put xShowerOpenerPos + 3*xShowerPos/4 - xShowerPos/4*cos(alfa), yShowerOpenerPos + (3*xShowerPos/4-(xShowerPos)/4*cos(alfa))*tan(beta), 0.15 - xShowerPos/4*sin(alfa), 0
	next ji

	tube 4, 8 + nsp/4 + 2 - 5, 1+2+16+32,
		0.0065, 0, 1,
		0, 1, 800,
		-0.0065, 0, 1001,
		0.0065, 0, 1001,

		xShowerOpenerPos, yShowerOpenerPos, 0, 0,
		xShowerOpenerPos, yShowerOpenerPos, 0.148, 0,
		xShowerOpenerPos, yShowerOpenerPos, 0.15, 0,
		get(nsp),
		xShowerOpenerPos + xShowerPos, yWallPos + yShowerHeadPos - yTapPos, zShowerPos - 0.004, 0,
		xShowerOpenerPos + xShowerPos, yWallPos + yShowerHeadPos - yTapPos, zShowerPos + 1, 0

endif

if ShowerOpenerAngle > 0 then

	yTubePos = - 0.058
	add 0, yShowerOpenerPos, zShowerOpenerPos - 0.094
	rotx 90 - showerOpenerAngle
	roty -90
	revolve 8, 360, 1+2+4+8+16+32,
		0, 0.011, 0,
		0.024, 0.011, 0,
		0.024, 0.018, 0,
		0.049, 0.018, 0,
		0.049, 0.003, 0,
		0.074, 0.003, 0,
		0.074, 0.007, 0,
		0.094, 0.007, 0
	del 3

	add 0, yShowerOpenerPos, zShowerOpenerPos - 0.094
	rotx 90 - showerOpenerAngle
	roty 180
	rotz -90
	resol 2*gs_resol
	elbow 0.045, 50 + 90 - showerOpenerAngle, 0.0115
	resol gs_resol
	del 4

	beta = 0

	for hi = 1 to 2*gs_resol
		alfa = hi * 180/gs_resol/2
		put xShowerOpenerPos + (xShowerPos)/2-(xShowerPos)/2*cos(alfa), yShowerOpenerPos + yTubePos + ((xShowerPos)/2-(xShowerPos)/2*cos(alfa))*tan(beta), -0.135-(xShowerPos)/2*sin(alfa), -30
	next hi

	yTube = abs(yWallPos + yShowerHeadPos - yTapPos - yShowerOpenerPos - yTubePos)
	tube 4, 19 + nsp/4, 1+2+16+32,
		0.0065, 0, 1,
		0, 1, 800,
		-0.0065, 0, 1001,
		0.0065, 0, 1001,

		xShowerOpenerPos, yShowerOpenerPos - 0.045 * cos(90 - showerOpenerAngle) + 0.045 * cos(65) + sin(50), zShowerOpenerPos - 0.094 - 0.045 * sin(90 - showerOpenerAngle)- 0.045 * sin(50) + cos(50), 45,
		xShowerOpenerPos, yShowerOpenerPos - 0.045 * cos(90 - showerOpenerAngle) + 0.045 * cos(50), zShowerOpenerPos - 0.094 - 0.045 * sin(90 - showerOpenerAngle)- 0.045 * sin(50), 45,
		xShowerOpenerPos, yShowerOpenerPos - 0.045 * cos(90 - showerOpenerAngle) + 0.045 * cos(50) - 0.01 * sin(50), zShowerOpenerPos - 0.094 - 0.045 * sin(90 - showerOpenerAngle)- 0.045 * sin(50) - 0.01 * cos(50), 45,
		xShowerOpenerPos, yShowerOpenerPos + yTubePos/2, zShowerOpenerPos - 0.094 - 0.045 * sin(90 - showerOpenerAngle)- 0.045 * sin(50) - 0.01 * cos(50) - 0.005, 45,
		xShowerOpenerPos, yShowerOpenerPos + yTubePos*0.68, zShowerOpenerPos - 0.094 - 0.045 * sin(90 - showerOpenerAngle)- 0.045 * sin(50) - 0.01 * cos(50) -0.02, 45,
		xShowerOpenerPos, yShowerOpenerPos + yTubePos*0.8, zShowerOpenerPos - 0.094 - 0.045 * sin(90 - showerOpenerAngle)- 0.045 * sin(50) - 0.01 * cos(50) -0.035, 45,
		xShowerOpenerPos, yShowerOpenerPos + yTubePos*0.89, zShowerOpenerPos - 0.094 - 0.045 * sin(90 - showerOpenerAngle)- 0.045 * sin(50) - 0.01 * cos(50) -0.055, 45,
		xShowerOpenerPos, yShowerOpenerPos + yTubePos, -0.135, 30,
		get(nsp),
		xShowerOpenerPos + xShowerPos, yShowerOpenerPos + yTubePos, -0.135, 60,
		xShowerOpenerPos + xShowerPos, yShowerOpenerPos + yTubePos, 0, 60,
		xShowerOpenerPos + xShowerPos, yWallPos + yShowerHeadPos - yTapPos - yTube*0.93, (zShowerPos - 0.04)*0.19, 60,
		xShowerOpenerPos + xShowerPos, yWallPos + yShowerHeadPos - yTapPos - yTube*0.785, (zShowerPos - 0.04)*0.35, 60,
		xShowerOpenerPos + xShowerPos, yWallPos + yShowerHeadPos - yTapPos - yTube*0.62, (zShowerPos - 0.04)*0.455, 60,
		xShowerOpenerPos + xShowerPos, yWallPos + yShowerHeadPos - yTapPos - yTube*0.38, (zShowerPos - 0.04)*0.545, 60,
		xShowerOpenerPos + xShowerPos, yWallPos + yShowerHeadPos - yTapPos - yTube*0.215, (zShowerPos - 0.04)*0.65, 60,
		xShowerOpenerPos + xShowerPos, yWallPos + yShowerHeadPos - yTapPos - yTube*0.07, (zShowerPos - 0.04)*0.81, 60,
		xShowerOpenerPos + xShowerPos, yWallPos + yShowerHeadPos - yTapPos, zShowerPos - 0.04, 60,
		xShowerOpenerPos + xShowerPos, yWallPos + yShowerHeadPos - yTapPos, zShowerPos - 0.004, 0,
		xShowerOpenerPos + xShowerPos, yWallPos + yShowerHeadPos - yTapPos, zShowerPos + 1, 0

endif

addy -yTapPos

add xShowerOpenerPos + xShowerPos, yShowerHeadPos + yWallPos, zShowerPos + 0.026 - 0.015
rotx 0
	addz -0.015
	cylind 0.02999, 0.01
	del 1
del 2

material matShower
add xShowerOpenerPos + xShowerPos, yShowerHeadPos + yWallPos, zShowerPos + 0.026 - 0.015
rotx 0
	sweepRX = 0.01
	sweepRY = 0.011
	addz 0.015
	sweep 9, 4, 0, 1.05, 1+2+4+16+32,
		sweepRX, 0, 1,
		sweepRX, sweepRY-roundOff2, 1,
		sweepRX-roundOff2, sweepRY, 1001,
	   -sweepRX+roundOff2, sweepRY, 1,
	   -sweepRX, sweepRY-roundOff2, 1001,
	   -sweepRX, -sweepRY+roundOff2, 1,
	   -sweepRX+roundOff2, -sweepRY, 1001,
		sweepRX-roundOff2, -sweepRY, 1,
		sweepRX, -sweepRY+roundOff2, 1001,

		0, 0, 0,
		0, -0.002, 0.096,
		0, -0.005, 0.134,
		0, -0.007, 0.152
	del 1
del 2

add xShowerOpenerPos + xShowerPos, yShowerHeadPos + yWallPos, zShowerPos + 0.026 - 0.015
	add 0, 0.017, 0.19+0.015
	rotz -90
	roty 10
	revolve 5, 360, 1+2+4+8+16+32,
		0.048, 0.045, 0,
		0.045, 0.045, 0,
		0.045, 0.05, 0,
		0.018, 0.05, 2,
		0.012, 0.03, 0
	del 3
del 1

material gs_tap_mat

add xShowerOpenerPos + xShowerPos, yWallPos, zShowerPos
rotx 90
cylind 0.01, 0.03
del 2

add xShowerOpenerPos + xShowerPos, yWallPos - 0.01, zShowerPos
rotx 90
cylind 0.018, 0.019
del 2

add xShowerOpenerPos + xShowerPos, yShowerHeadPos + yWallPos, zShowerPos
cutpolya 4, 1, 0,
	0.015*cos(45), -0.015*sin(45), 15+64,
	0, 0, 900,
	0, 270, 4015,
	0.015*cos(45), -0.015*sin(45), -1
del 1
add xShowerOpenerPos + xShowerPos, yWallPos - 0.028, zShowerPos
rotx 90
cylind 0.02, 0.012
del 2
cutend

add xShowerOpenerPos + xShowerPos, yShowerHeadPos + yWallPos, zShowerPos - 0.026
prism_ 8, 0.052,
	0.015*cos(45), -0.015*sin(45), 15+64,
	0, 0, 900,
	0, 270, 4015,
	0.00399, 45, 215,
	0.00001, 45, 215+64,
	0, 0, 900,
	0, -270, 4015,
	0.015*cos(45), -0.015*sin(45), -1
del 1

del 1

return


! ==============================================================================
! Shower Kit
! ==============================================================================
"shower kit for wallmounted taps":

roundOff1 = 0.002
roundOff2 = 0.007
yTubePos = - 0.058*0
beta = 0

for hi = 1 to 2*gs_resol
alfa = hi * 180/gs_resol/2
put xShowerOpenerPos + (xShowerPos)/2-(xShowerPos)/2*cos(alfa), yShowerOpenerPos + yTubePos + ((xShowerPos)/2-(xShowerPos)/2*cos(alfa))*tan(beta), -0.135-(xShowerPos)/2*sin(alfa), 0
next hi

yTube = yShowerHeadPos + 0.035 - yShowerOpenerPos

tube 4, 18 + nsp/4, 1+2+16+32+64*0,
	0.0065, 0, 1,
	0, 1, 800,
	-0.0065, 0, 1001,
	0.0065, 0, 1001,

	xShowerOpenerPos, yShowerOpenerPos, 0, 0,
	xShowerOpenerPos, yShowerOpenerPos, -openerRadius - 0.015, 0,
	xShowerOpenerPos, yShowerOpenerPos + yTubePos/2, zShowerOpenerPos - 0.094 - 0.045 * sin(90 - showerOpenerAngle)- 0.045 * sin(50) - 0.01 * cos(50) - 0.005, 0,
	xShowerOpenerPos, yShowerOpenerPos + yTubePos*0.68, zShowerOpenerPos - 0.094 - 0.045 * sin(90 - showerOpenerAngle)- 0.045 * sin(50) - 0.01 * cos(50) -0.02, 0,
	xShowerOpenerPos, yShowerOpenerPos + yTubePos*0.8, zShowerOpenerPos - 0.094 - 0.045 * sin(90 - showerOpenerAngle)- 0.045 * sin(50) - 0.01 * cos(50) -0.035, 0,
	xShowerOpenerPos, yShowerOpenerPos + yTubePos*0.89, zShowerOpenerPos - 0.094 - 0.045 * sin(90 - showerOpenerAngle)- 0.045 * sin(50) - 0.01 * cos(50) -0.055, 0,
	xShowerOpenerPos, yShowerOpenerPos + yTubePos, -0.135, 0,
	get(nsp),
	xShowerOpenerPos + xShowerPos, yShowerOpenerPos, -0.135, tubeTorsion1,
	xShowerOpenerPos + xShowerPos, yShowerOpenerPos, 0, tubeTorsion1,
	xShowerOpenerPos + xShowerPos + xShowerHeadPos*0.1, yShowerOpenerPos + yTube*0.1, (zShowerPos - 0.04)*0.15, tubeTorsion1,
	xShowerOpenerPos + xShowerPos + xShowerHeadPos*0.25, yShowerOpenerPos + yTube*0.3, (zShowerPos - 0.04)*0.3, tubeTorsion1,
	xShowerOpenerPos + xShowerPos + xShowerHeadPos*0.45, yShowerOpenerPos + yTube*0.65, (zShowerPos - 0.04)*0.45, tubeTorsion1,
	xShowerOpenerPos + xShowerPos + xShowerHeadPos*0.68, yShowerOpenerPos + yTube*0.9, (zShowerPos - 0.04)*0.6, tubeTorsion1,
	xShowerOpenerPos + xShowerPos + xShowerHeadPos*0.85, yShowerOpenerPos + yTube, (zShowerPos - 0.04)*0.75, tubeTorsion2,
	xShowerOpenerPos + xShowerPos + xShowerHeadPos*0.95, yShowerOpenerPos + yTube*0.95, (zShowerPos - 0.04)*0.9, tubeTorsion3,
	xShowerOpenerPos + xShowerPos + xShowerHeadPos, yWallPos + yShowerHeadPos - yTapPos + 0.04*sin(showerHeadAngle), zShowerPos + 0.011 - 0.04*cos(showerHeadAngle), tubeTorsion3,
	xShowerOpenerPos + xShowerPos + xShowerHeadPos, yWallPos + yShowerHeadPos - yTapPos + 0.015*sin(showerHeadAngle), zShowerPos + 0.011 - 0.015*cos(showerHeadAngle), tubeTorsion3,
	xShowerOpenerPos + xShowerPos + xShowerHeadPos, yWallPos + yShowerHeadPos - yTapPos - 0.015*sin(showerHeadAngle), zShowerPos + 0.011 + 0.015*cos(showerHeadAngle), tubeTorsion3

add xShowerOpenerPos + xShowerPos + xShowerHeadPos, yShowerHeadPos + yWallPos, zShowerPos + 0.011
rotx showerHeadAngle
	addz -0.015
	cylind 0.035, 0.0085
	del 1
del 2

group "ShowerHead1"
add xShowerOpenerPos + xShowerPos + xShowerHeadPos, yShowerHeadPos + yWallPos, zShowerPos + 0.026 - 0.015
rotx showerHeadAngle
	sweepRX = 0.01
	sweepRY = 0.011
	addz 0.02
	sweep 9, 4, 0, 1.05, 1+2+4+16+32,
		sweepRX, 0, 1,
		sweepRX, sweepRY-roundOff2, 1,
		sweepRX-roundOff2, sweepRY, 1001,
	   -sweepRX+roundOff2, sweepRY, 1,
	   -sweepRX, sweepRY-roundOff2, 1001,
	   -sweepRX, -sweepRY+roundOff2, 1,
	   -sweepRX+roundOff2, -sweepRY, 1001,
		sweepRX-roundOff2, -sweepRY, 1,
		sweepRX, -sweepRY+roundOff2, 1001,

		0, 0, 0,
		0, -0.002, 0.096,
		0, -0.005, 0.134,
		0, -0.007, 0.152
	del 1
del 2
endgroup

group "ShowerHead2"
add xShowerOpenerPos + xShowerPos + xShowerHeadPos, yShowerHeadPos + yWallPos, zShowerPos + 0.026 - 0.015
rotx showerHeadAngle
	add 0, 0.017, 0.19+0.02
	rotz -90
	roty 10
	revolve 5, 360, 1+2+4+8+16+32,
		0.048, 0.045, 0,
		0.045, 0.045, 0,
		0.045, 0.05, 0,
		0.018, 0.05, 2,
		0.012, 0.03, 0
	del 3
del 2
endgroup

placegroup addgroup ("ShowerHead1","ShowerHead2")
killgroup "ShowerHead1"
killgroup "ShowerHead2"

add xShowerOpenerPos + xShowerPos + xShowerHeadPos, yShowerHeadPos + yWallPos, zShowerPos + 0.011
rotx showerHeadAngle

cutpolya 2, 1, 0,
	0, 0, 907 + 64,
	0.01, 360, 4007 + 64
cutpolya 4, 1, 0,
	-0.006, 0, 7,
	-0.006, -0.1, 7,
	 0.006, -0.1, 7,
	 0.006, 0, 7

del 2

cutpolya 2, 1, 0,
	xShowerHolderPos, yShowerHeadPos, 915 + 64,
	pipeRadius, 360, 4015 + 64

add xShowerHolderPos - 0.05, yShowerHeadPos, zShowerPos + 0.011
roty 90
cylind 0.1, 0.018
del 2
cutend
cutend
cutend

return


! ==============================================================================
! Simple Tap Styles
! ==============================================================================
"simple tap style":

if bSinkTap then
	gosub "simple sink faucet"
else
	if iTapGroup = TAPGROUP_SINGLE then			gosub "simple single level mixer"
	if iTapGroup = TAPGROUP_TWOHANDLE then		gosub "simple two handle mixer"
	if iTapGroup = TAPGROUP_TRADITIONAL then	gosub "simple traditional basin pillar tap"
	if iTapGroup = TAPGROUP_SENSOR then			gosub "simple sensor faucet"
	if iTapGroup = TAPGROUP_WALLMOUNTED then	gosub "simple wall mounted"
endif

return


! ==============================================================================
! Simple Single Level Mixer
! ==============================================================================
"simple single level mixer":

gosub "mixer tap"

addz tapHeight

	gosub "handle"

del 1

return


! ==============================================================================
! Simple Two Handle Mixer
! ==============================================================================
"simple two handle mixer":

gosub "mixer tap"

for i = 1 to 2

	addx 0.08

		prism_ 4, 0.04,
			-0.04 / 2, -0.04 / 2, 15,
			0.04 / 2, -0.04 / 2, 15,
			0.04 / 2, 0.04 / 2, 15,
			-0.04 / 2, 0.04 / 2, 15

	del 1

mulx -1

next i

del 2

return


! ==============================================================================
! Simple Traditional Basin Pillar
! ==============================================================================
"simple traditional basin pillar tap":

for i = 1 to 2

	addx 0.09

		gosub "mixer tap"

		addz tapHeight

			gosub "handle"

		del 1

	del 1

mulx -1

next i

del 2

return


! ==============================================================================
! Simple Sensor faucet
! ==============================================================================
"simple sensor faucet":

gosub "mixer tap"

return


! ==============================================================================
! Simple Sink Faucet
! ==============================================================================
"simple sink faucet":

gosub "sink faucet tap"

addz tapHeight

	gosub "handle"

del 1

return


! ==============================================================================
! Simple Wall Mounted
! ==============================================================================
"simple wall mounted":

gosub "wall mounted tap"

add 0, -tapDepth / 2, tapHeight/2

	gosub "handle"

del 1

return


! ==============================================================================
! Mixer Tap for Simple Tap
! ==============================================================================
"mixer tap":

material gs_tap_mat

tapHeight		= 0.12
tapDepth		= 0.04
tapWidth		= 0.04
noseLength		= 0.095
noseElev		= 0.095
noseAngle		= 4

rotz -90
rotx 90
add 0, 0, -tapWidth / 2

	prism_ 7, tapWidth,
		-tapDepth / 2, 0, 15,
		tapDepth / 2, 0, 15,
		tapDepth / 2, noseElev, 15,
		tapDepth / 2 + noseLength, noseElev, 15,
		tapDepth / 2 + noseLength, tapHeight - noseLength * TAN(noseAngle), 15,
		tapDepth / 2, tapHeight, 15,
		-tapDepth / 2, tapHeight, 15

del 3

return


! ==============================================================================
! Wall Mounted Tap for Simple Tap
! ==============================================================================
"wall mounted tap":

material gs_tap_mat

if gs_tap_type_m = 21 then	! Style 1
	tapHeight		= 0.038
	tapWidth		= 0.218
else
	if gs_tap_type_m = -1 then	! Simple
		tapHeight		= 0.03
		tapWidth		= 0.17
	else
		tapHeight		= 0.038
		tapWidth		= 0.254
	endif
endif

tapDepth		= 0.04
noseWidth		= 0.04
noseLength		= 0.095
noseElev		= 0.005
noseAngle		= 4

rotz -90
rotx 90
add tapDepth/2, -tapHeight/2, -tapWidth/2

	prism_ 4, tapWidth,
		-tapDepth / 2, 0, 15,
		tapDepth / 2, 0, 15,
		tapDepth / 2, tapHeight, 15,
		-tapDepth / 2, tapHeight, 15

	addz tapWidth / 2 - noseWidth / 2

		prism_ 4, noseWidth,
			tapDepth / 2, noseElev, 15,
			tapDepth / 2 + noseLength, noseElev, 15,
			tapDepth / 2 + noseLength, tapHeight - noseLength * TAN(noseAngle), 15,
			tapDepth / 2, tapHeight, 15

	del 1

del 3

return


! ==============================================================================
! Sink Faucet Tap for Simple Tap
! ==============================================================================
"sink faucet tap":

material gs_tap_mat

tapHeight		= 0.18
tapDepth		= 0.04
tapWidth		= 0.04
noseLength		= 0.135
noseHeight		= 0.04
noseElev		= 0.165

rotz -90
rotx 90
add 0, 0, -tapWidth / 2

	prism_ 8, tapWidth,
		-tapDepth / 2, 0, 15,
		tapDepth / 2, 0, 15,
		tapDepth / 2, noseElev, 15,
		tapDepth / 2 + noseLength - 0.02, noseElev, 15,
		tapDepth / 2 + noseLength - 0.02, tapHeight - noseHeight, 15,
		tapDepth / 2 + noseLength, tapHeight - noseHeight, 15,
		tapDepth / 2 + noseLength, tapHeight, 15,
		-tapDepth / 2, tapHeight, 15

del 3

return


! ==============================================================================
! Handle for Simple Tap
! ==============================================================================
"handle":

material gs_tap_mat

neckHeight		= 0.04
neckDepth		= 0.04
neckWidth		= 0.04

openerLength	= 0.07
openerHeight	= 0.01
openerWidth		= 0.02


rotz -90
rotx 90
add 0, 0, -neckWidth / 2

	prism_ 4, neckWidth,
		-neckDepth / 2, 0, 15,
		neckDepth / 2, 0, 15,
		neckDepth / 2, neckHeight, 15,
		-neckDepth / 2, neckHeight, 15

	add 0, neckHeight - openerHeight, neckWidth / 2 - openerWidth / 2

		prism_ 4, openerWidth,
			neckDepth / 2, 0, 15,
			neckDepth / 2 + openerLength, 0, 15,
			neckDepth / 2 + openerLength, openerHeight, 15,
			neckDepth / 2, openerHeight, 15

	del 1

del 3

return


