
! ==============================================================================
! Definitions
! ==============================================================================
eps = 0.0001

LAST_PAGE_INDEX		= 16

! iStampType: constant values for Zone Stamp Type
	ZONE_STAMP_2_INT	= 1
	ZONE_STAMP_DIN		= 2
	ZONE_STAMP_ON		= 3
	ZONE_STAMP_NOR		= 4

! DisplayScale
! _iScale, _iUIDisplayScale
	SCALE_INSENSITIVE	= 0
	SCALE_50			= 1
	SCALE_100			= 2
	SCALE_200			= 3

! iApartmenIdFrame
	APARTMENT_ID_FRAME_NONE	= 0
	APARTMENT_ID_FRAME_RECT	= 1
	APARTMENT_ID_FRAME_OVAL	= 2
	APARTMENT_ID_FRAME_CIRC	= 3

! iFontScaleType
	FONT_MODEL	= 1
	FONT_PAPER	= 2

!iOrder
	ORDER_NONE				= 1
	ORDER_ZONE_NAME			= 2
	ORDER_ZONE_NUMBER		= 3
	ORDER_ID				= 4
	ORDER_APARTMENT			= 5
	ORDER_FINISHING			= 6
	ORDER_HEIGHT			= 7
	ORDER_HEIGHT_NUMBER		= 8
	ORDER_ZONE_AREAS		= 9
	ORDER_WINDOW_AREA		= 10
	ORDER_SIZE				= 11
	ORDER_AREA_CODE_GER		= 12
	ORDER_ONORM_AUT			= 13
	ORDER_ADD_TAGS			= 14
	ORDER_CUSTOM			= 15
!NEW:	ORDER_NEW_GROUP	= XX

!Lines
	ROW__NONE						= 1
	ROW__ZONE_NAME__ZONE_NAME		= 2
	ROW__ZONE_NAME__ZONE_NAME2		= 3
	ROW__ZONE_NUMBER__ZONE_NO1		= 4
	ROW__ZONE_NUMBER__ZONE_NO2		= 5
	ROW__ZONE_NUMBER__ZONE_NO3		= 6
	ROW__ID__CAT_ID					= 7
	ROW__ID__ID						= 8
	ROW__ID__SHORT_TITLE			= 9
	ROW__ID__APARTMENT_CODE			= 10
	ROW__ID__STAIRCASE_CODE			= 11
	ROW__APARTMENT__APART_NAME		= 12
	ROW__APARTMENT__APART_POS		= 13
	ROW__APARTMENT__HOUSE_NUM		= 14
	ROW__APARTMENT__FUNCTION		= 15
	ROW__FINISHING__FLOOR			= 16
	ROW__FINISHING__FLOOR__EXIST	= 17
	ROW__FINISHING__WALL			= 18
	ROW__FINISHING__CEILING			= 19
	ROW__HEIGHT__FLOOR				= 20
	ROW__HEIGHT__ZONE				= 21
	ROW__ZONE_AREAS__MES_AREA			= 22
	ROW__ZONE_AREAS__MES_AREA_CUST		= 23
	ROW__ZONE_AREAS__EXIST_AREA			= 24	! only ON
	ROW__ZONE_AREAS__MES_NET_AREA		= 25
	ROW__ZONE_AREAS__MES_NET_AREA_CUST	= 26
	ROW__ZONE_AREAS__VENT_AREA			= 27	! only DIN
	ROW__ZONE_AREAS__REDUC_AREA			= 28
	ROW__ZONE_AREAS__REDUC_AREA_CUST	= 29
	ROW__ZONE_AREAS__CALC_AREA			= 30
	ROW__ZONE_AREAS__CALC_AREA_CUST	= 31
	ROW__WINDOW_AREA__WINDOW_AREA	= 32
	ROW__SIZE__PERIMETER			= 33
	ROW__SIZE__CEILING_H			= 34
	ROW__SIZE__VOLUME				= 35
	ROW__AREA_CODE_GER__AREACODE	= 36
	ROW__ONORM_AUT__ONORM			= 37
!	ROW__ONORM_AUT__ONORM + 15 rows	= 38 to 52
	ROW__CUSTOM__1					= 53
	ROW__CUSTOM__2					= 54
	ROW__CUSTOM__3					= 55
	ROW__APARTMAN__ID				= 56
	ROW__ADD__TAGS					= 57 !ROW__ONORM_AUT__ONORM + 16 onorm Wow

	
!NEW:	ROW__YOUR__NEWGROUP		= 58

! maximum number of selectable content with Additional Tags
! ------------------------------------------------------------------------------
maxNumText		= 57


!plus minus glob_ui_button_id
	BUTTON_ID_INSENSITIVE = 1000
	BUTTON_ID_50 = 2000
	BUTTON_ID_100 = 3000
	BUTTON_ID_200 = 4000

! iPrefixFloorLevel, iPrefixZoneLevel
	PREFIX_MARKER 	= 1
	PREFIX_TEXT 	= 2

! iFrameStyle
	FRAME_NONE 		= 1
	FRAME_STYLE_1 	= 2
	FRAME_STYLE_2 	= 3
	FRAME_STYLE_3 	= 4
	FRAME_STYLE_4 	= 5

! iDataAlign
	ALIGN_MIDDLE	= 0
	ALIGN_LEFT 		= 1
	ALIGN_RIGHT 	= 2

! iArrowHeadType
	TRIANG_2LIN_45		= 1
	TRIANG_2LIN_30		= 2
	TRIANG_2LIN_15		= 3
	TRIANG_3LIN_45		= 4
	TRIANG_3LIN_30		= 5
	TRIANG_3LIN_15		= 6
	TRIANG_FILLED_45	= 7
	TRIANG_FILLED_30	= 8
	TRIANG_FILLED_15	= 9
	CIRCLE_EMPTY		= 10
	CIRCLE_FILLED		= 11

! GLOB_BUTTON_ID
	idButton_addnewRow 	= 0
	idButton_pasteRow 	= 100
	idButton_dropRow 	= 200
	idButton_openGroup 	= 300
	idButton_closeGroup = 400
	idButton_jumptopage = 500
	

! iShowZoneIDAs
IDVALUE_IDNUMBER	= 1
IDVALUE_FULLIDNUM	= 2

! ==============================================================================
! Localization
! ==============================================================================

dim stDisplayScale[3]
	stDisplayScale[1] = `1:50`
	stDisplayScale[2] = `1:100`
	stDisplayScale[3] = `1:200`

dim stStyle[3]
	stStyle[1] = `Тип 1`
	stStyle[2] = `Тип 2`
	stStyle[3] = `Тип 3`

dim stApartmentIdFrame[4]
	stApartmentIdFrame[1] = `Окружность`
	stApartmentIdFrame[2] = `Овал`
	stApartmentIdFrame[3] = `Прямоугольник`
	stApartmentIdFrame[4] = `Нет`

dim stFontScale[2]
	stFontScale[1] = `Размер Модели`
	stFontScale[2] = `Размер Бумаги`

dim stRoomNames[43]
	stRoomNames[ 1] = `Кладовая`
	stRoomNames[ 2] = `Жилая`
	stRoomNames[ 3] = `Лифт`
	stRoomNames[ 4] = `Ванная Комната`
	stRoomNames[ 5] = `Переговорная`
	stRoomNames[ 6] = `Ресторан`
	stRoomNames[ 7] = `Офис`
	stRoomNames[ 8] = `Женщины`
	stRoomNames[ 9] = `Темная Комната`
	stRoomNames[10] = `Душевая`
	stRoomNames[11] = `EDP`
	stRoomNames[12] = `Родительская`
	stRoomNames[13] = `Приемная`
	stRoomNames[14] = `Коридор`
	stRoomNames[15] = `Гостевая`
	stRoomNames[16] = `Мужчины`
	stRoomNames[17] = `Прачечная`
	stRoomNames[18] = `Столовая`
	stRoomNames[19] = `Погреб`
	stRoomNames[20] = `Детская 1`
	stRoomNames[21] = `Детская 2`
	stRoomNames[22] = `Копировальная Комната`
	stRoomNames[23] = `Кухня`
	stRoomNames[24] = `Холодильник`
	stRoomNames[25] = `Лаборатория`
	stRoomNames[26] = `Чулан`
	stRoomNames[27] = `Мусоросборник`
	stRoomNames[28] = `Операционная`
	stRoomNames[29] = `Спальня`
	stRoomNames[30] = `Секретариат`
	stRoomNames[31] = `Мастерская`
	stRoomNames[32] = `Небольшая Кухня`
	stRoomNames[33] = `Лестница`
	stRoomNames[34] = `Раздевалка Женская`
	stRoomNames[35] = `Раздевалка Мужская`
	stRoomNames[36] = `Прихожая`
	stRoomNames[37] = `Туалет`
	stRoomNames[38] = `Туалет для Инвалидов`
	stRoomNames[39] = `Туалет Женский`
	stRoomNames[40] = `Туалет Мужской`
	stRoomNames[41] = `Гостиная`
	stRoomNames[42] = `Для Специального Использования`
	stRoomNames[43] = `Комната`

dim stWallCoveringValues[4]
	stWallCoveringValues[1] = `Штукатурка`
	stWallCoveringValues[2] = `Окраска`
	stWallCoveringValues[3] = `Обои`
	stWallCoveringValues[4] = `Плитка`

dim stCeilingCoveringValues[3]
	stCeilingCoveringValues[1] = `Штукатурка`
	stCeilingCoveringValues[2] = `Бетон`
	stCeilingCoveringValues[3] = `Окраска`

dim stFloorCoveringValues[4]
	stFloorCoveringValues[1] = `Паркет`
	stFloorCoveringValues[2] = `Плитка`
	stFloorCoveringValues[3] = `Стяжка`
	stFloorCoveringValues[4] = `Ковер`

dim stDin277AreaCode[2]
	stDin277AreaCode[1] = "R"
	stDin277AreaCode[2] = "S"

dim stTopHousingValues[8]
	stTopHousingValues[1] = `Жилые Комнаты`
	stTopHousingValues[2] = `Боковые Комнаты`
	stTopHousingValues[3] = `Веранда`
	stTopHousingValues[4] = `Лоджия`
	stTopHousingValues[5] = `Терраса`
	stTopHousingValues[6] = `Балкон`
	stTopHousingValues[7] = `Сад`
	stTopHousingValues[8] = `Погреб`

! sPrefixFloorLevel, sPrefixZoneLevel
dim stPrefixLevel[2]
	stPrefixLevel[1]	= `Маркер`
	stPrefixLevel[2]	= `Текст`

dim stGroupText[15]
	stGroupText[1]	= "** " + `Пустая Строка`
	stGroupText[2]	= `Имя Зоны`
	stGroupText[3]	= `Номер Зоны`
	stGroupText[4]	= `Идентификация`
	stGroupText[5]	= `Детали Квартиры`
	stGroupText[6]	= `Отделка`
	stGroupText[7]	= `Значения Высоты`
	stGroupText[8]	= `Значения Высоты и Номер Зоны`
	stGroupText[9]	= `Площади Зоны`
	stGroupText[10]	= `Площадь Окон`
	stGroupText[11] = `Параметры Размера`
	stGroupText[12] = `Код Площади DIN`
	stGroupText[13]	= `ONORM`
	stGroupText[14]	= `Дополнительные Метки`
	stGroupText[15]	= `Специальный Текст`
!NEW:	stGroupText[XX]	= "Your new group"

dim stFrameStyle[]
	stFrameStyle[1] = `Нет`
	stFrameStyle[2] = `Стиль 1`
	stFrameStyle[3] = `Стиль 2`
	stFrameStyle[4] = `Стиль 3`
	stFrameStyle[5] = `Стиль 4`

dim stDataAlign[]
	stDataAlign[1] = `Слева`
	stDataAlign[2] = `Справа`

dim stIDValue[2]
	stIDValue[1] = `Компактный ID Элемента`
	stIDValue[2] = `Полный ID Элемента`

dim stArrowheadType[11]
	stArrowheadType[1]	= `Стиль 1`
	stArrowheadType[2] 	= `Стиль 2`
	stArrowheadType[3] 	= `Стиль 3`
	stArrowheadType[4] 	= `Стиль 4`
	stArrowheadType[5] 	= `Стиль 5`
	stArrowheadType[6] 	= `Стиль 6`
	stArrowheadType[7] 	= `Стиль 7`
	stArrowheadType[8] 	= `Стиль 8`
	stArrowheadType[9] 	= `Стиль 9`
	stArrowheadType[10]	= `Стиль 10`
	stArrowheadType[11]	= `Стиль 11`

stTOP = "TOP"

! iAreaUnit
dim stAreaUnit[3]
	stAreaUnit[1] = `в Единицах Измерения Площадей`				    ! it means 1 row with project preferences unit forms
	stAreaUnit[2] = `в Единицах Измерения Площадей и в Специальных Единицах`	    ! it means 2 duplicated row with different unit forms
	stAreaUnit[3] = `в Специальных Единицах`							! it means 1 row with custom unit forms

AREA_UNIT_PROJECT 			= 1
AREA_UNIT_CUST_AND_PROJECT 	= 2
AREA_UNIT_CUST       		= 3

! iAreaCustomUnit
dim stAreaCustomUnit[6]
	stAreaCustomUnit[1] = `квадратные метры`			
	stAreaCustomUnit[2] = `квадратные сантиметры`		
	stAreaCustomUnit[3] = `квадратные миллиметры`	
	stAreaCustomUnit[4] = `кв фут`	
	stAreaCustomUnit[5] = `кв дюйм`	
	stAreaCustomUnit[6] = `Тсубо`

CUST_METER	= 1
CUST_CMETER	= 2
CUST_MMETER	= 3
CUST_DECFT	= 4
CUST_DECIN	= 5
CUST_TSUBO	= 6

dim _sMarkerSign[5]
	_sMarkerSign[1] = `Треугольник`
	_sMarkerSign[2] = `Полутоновый Треугольник`
	_sMarkerSign[3] = `Треугольник 2`
	_sMarkerSign[4] = `Окружность`
	_sMarkerSign[5] = `Полутоновая Окружность`

MARKER_TRIANGLE_FILL1		= 1
MARKER_TRIANGLE_FILLBOTH	= 2
MARKER_TRIANGLE_FILL2		= 3
MARKER_CIRCLE_FILL1			= 4
MARKER_CIRCLE_FILLBOTH		= 5

! ------------------------------------------------------------------------------
! Zone Group Calcutation
! ------------------------------------------------------------------------------

nAllGroupDisplay = 12

nMaxGroupDisplay = 11
if	iStampType = ZONE_STAMP_DIN |\
	iStampType = ZONE_STAMP_ON then nMaxGroupDisplay = nMaxGroupDisplay + 1

! ==============================================================================
! Disable Functions by Caller Zone Stamps
! ==============================================================================

if iStampType <> ZONE_STAMP_ON then
	bShowOnormData 		= 0
	bShowTopPrefix 		= 0
	topAreaCorrection 	= 0
	bShowExistArea 		= 0
	bUseSepPensForRenovSettings	= 0
endif

if iStampType <> ZONE_STAMP_NOR then
	bShowZoneNum2 = 0
	bShowZoneNum3 = 0
endif

if iStampType <> ZONE_STAMP_DIN then
	bShowClassification	= 0
	bSubRegul       	= 0
	bShowVentArea		= 0
endif

! ==============================================================================
! Variables
! ==============================================================================

_iUIDisplayScale = SCALE_INSENSITIVE
if bScaleSensitive then
	_iUIDisplayScale = iDisplayScale
endif

if bScaleSensitive then
	_bDisplayInsideBox		= bDisplayInsideBox_200
	if _iUIDisplayScale = SCALE_50 then
		_bDisplayInsideBox		= bDisplayInsideBox_50
	else
		if _iUIDisplayScale = SCALE_100 then
			_bDisplayInsideBox		= bDisplayInsideBox_100
		endif
	endif
else
	_bDisplayInsideBox		= bDisplayInsideBox_0
endif

! ==============================================================================
! Content Names
! ==============================================================================

dim rowDataString[][6]
! ------ these`re used at MS ------
! rowDataString[][1] - Description String
! rowDataString[][2] - Prefix String
! rowDataString[][3] - Other Strings Content
! rowDataString[][4] - Full Strings Content (Prefix + Other)
! rowDataString[][6] - custom quantity format
! ------ the others`re used only at 2D ------
! rowDataString[][5] - font type of text line
! ------ 

iDataName			= 1
iDataPrefix			= 2
iDataStrings		= 3
iDataAllStrings		= 4
iFontType			= 5
iDataQCustomFormat	= 6

dim rowDataNumeric[][14]
! ------ these`re used at 2D except iDataShow ------
! rowDataNumeric[][1] - which parent group belongs to
! rowDataNumeric[][2] - value of showing boolean by row
! rowDataNumeric[][3] - quantities
! rowDataNumeric[][4] - format of quantity
! ------ the others`re used only at 2D ------
! rowDataNumeric[][5] - font size of text
! rowDataNumeric[][6] - font style of text
! rowDataNumeric[][7] - index of pen
! rowDataNumeric[][8] - width of displayed quantity unit text's offset
! rowDataNumeric[][9] - width of displayed prefix text / left
! rowDataNumeric[][10] - width of displayed content text / right
! rowDataNumeric[][11] - width of displayed text line / full
! rowDataNumeric[][12] - using text wrapping function (0/1)
! rowDataNumeric[][13] - height of text line with line spacing
! rowDataNumeric[][14] - height of text line's offset / half of line spacing
! ------ 

iParentGroup		= 1
iDataShow			= 2
iDataQuantity		= 3
iDataQFormat		= 4
iDataFontSize		= 5
iDataFontFaceCode	= 6
iDataPenNumber		= 7
iDataUnitOffset 	= 8
iDataPrefixLength 	= 9
iDataStringLength 	= 10
iDataAllStringsLength = 11
iDataWrapped 		= 12
iFontHeight 		= 13
iTextOffsetY		= 14

! initialization -------------------------
for iDrow = 1 to maxNumText
	for iDcol = 1 to vardim2(rowDataString)
		rowDataString[iDrow][iDcol] = ""
	next iDcol

	for iDcol = 1 to vardim2(rowDataNumeric)
		rowDataNumeric[iDrow][iDcol] = 0
	next iDcol
next iDrow

! Initialization and Parents group for UI --------------------------

rowDataString[ROW__ZONE_NAME__ZONE_NAME][iDataName] = `Имя Зоны`
rowDataNumeric[ROW__ZONE_NAME__ZONE_NAME][iParentGroup] = ORDER_ZONE_NAME

rowDataString[ROW__ZONE_NAME__ZONE_NAME2][iDataName] = `2-я Строка Имени Зоны`
rowDataNumeric[ROW__ZONE_NAME__ZONE_NAME2][iParentGroup] = ORDER_ZONE_NAME

rowDataString[ROW__ZONE_NUMBER__ZONE_NO1][iDataName] = `Номер Зоны`
rowDataNumeric[ROW__ZONE_NUMBER__ZONE_NO1][iParentGroup] = ORDER_ZONE_NUMBER * not(_bDisplayInsideBox) + ORDER_HEIGHT_NUMBER * _bDisplayInsideBox

if iStampType = ZONE_STAMP_NOR then
	rowDataString[ROW__ZONE_NUMBER__ZONE_NO2][iDataName] = `Дополнительный Номер Зоны`
	rowDataNumeric[ROW__ZONE_NUMBER__ZONE_NO2][iParentGroup] = ORDER_ZONE_NUMBER * not(_bDisplayInsideBox) + ORDER_HEIGHT_NUMBER * _bDisplayInsideBox
	rowDataString[ROW__ZONE_NUMBER__ZONE_NO3][iDataName] = `Третичный Номер Зоны`
	rowDataNumeric[ROW__ZONE_NUMBER__ZONE_NO3][iParentGroup] = ORDER_ZONE_NUMBER * not(_bDisplayInsideBox) + ORDER_HEIGHT_NUMBER * _bDisplayInsideBox
endif

rowDataString[ROW__ID__CAT_ID][iDataName] = `Код Категории Зоны`
rowDataNumeric[ROW__ID__CAT_ID][iParentGroup] = ORDER_ID

rowDataString[ROW__ID__ID][iDataName] = `ID`
rowDataNumeric[ROW__ID__ID][iParentGroup] = ORDER_ID

if iStampType = ZONE_STAMP_ON then
	rowDataString[ROW__ID__SHORT_TITLE][iDataName] = `Короткий Заголовок`
	rowDataNumeric[ROW__ID__SHORT_TITLE][iParentGroup] = ORDER_ID
endif

if iStampType = ZONE_STAMP_ON | iStampType = ZONE_STAMP_DIN then
	rowDataString[ROW__ID__APARTMENT_CODE][iDataName] = `Идентификатор Квартиры`
	rowDataNumeric[ROW__ID__APARTMENT_CODE][iParentGroup] = ORDER_ID

	rowDataString[ROW__ID__STAIRCASE_CODE][iDataName] = `Идентификатор Подъезда`
	rowDataNumeric[ROW__ID__STAIRCASE_CODE][iParentGroup] = ORDER_ID
endif

rowDataString[ROW__APARTMENT__APART_NAME][iDataName] = `Имя Квартиры`
rowDataNumeric[ROW__APARTMENT__APART_NAME][iParentGroup] = ORDER_APARTMENT

rowDataString[ROW__APARTMENT__APART_POS][iDataName] = `Расположение`
rowDataNumeric[ROW__APARTMENT__APART_POS][iParentGroup] = ORDER_APARTMENT

rowDataString[ROW__APARTMENT__HOUSE_NUM][iDataName] = `Номер Дома`
rowDataNumeric[ROW__APARTMENT__HOUSE_NUM][iParentGroup] = ORDER_APARTMENT

rowDataString[ROW__APARTMENT__FUNCTION][iDataName] = `Функция`
rowDataNumeric[ROW__APARTMENT__FUNCTION][iParentGroup] = ORDER_APARTMENT

rowDataString[ROW__FINISHING__FLOOR][iDataName] = `Пол`
rowDataNumeric[ROW__FINISHING__FLOOR][iParentGroup] = ORDER_FINISHING

if iStampType = ZONE_STAMP_ON then
	rowDataString[ROW__FINISHING__FLOOR__EXIST][iDataName] = `Существующая Отделка Пола`
	rowDataNumeric[ROW__FINISHING__FLOOR__EXIST][iParentGroup] = ORDER_FINISHING
endif

rowDataString[ROW__FINISHING__CEILING][iDataName] = `Потолок`
rowDataNumeric[ROW__FINISHING__CEILING][iParentGroup] = ORDER_FINISHING

rowDataString[ROW__FINISHING__WALL][iDataName] = `Отделка Стен`
rowDataNumeric[ROW__FINISHING__WALL][iParentGroup] = ORDER_FINISHING

rowDataString[ROW__HEIGHT__FLOOR][iDataName] = `Уровень Чистого Пола`
rowDataNumeric[ROW__HEIGHT__FLOOR][iParentGroup] = ORDER_HEIGHT * not(_bDisplayInsideBox) + ORDER_HEIGHT_NUMBER * _bDisplayInsideBox

rowDataString[ROW__HEIGHT__ZONE][iDataName] = `Отметка Зоны`
rowDataNumeric[ROW__HEIGHT__ZONE][iParentGroup] = ORDER_HEIGHT * not(_bDisplayInsideBox) + ORDER_HEIGHT_NUMBER * _bDisplayInsideBox

if iAreaUnit <> AREA_UNIT_CUST then
	rowDataString[ROW__ZONE_AREAS__MES_AREA][iDataName] = `Измеренная Площадь`
	rowDataNumeric[ROW__ZONE_AREAS__MES_AREA][iParentGroup] = ORDER_ZONE_AREAS

	rowDataString[ROW__ZONE_AREAS__MES_NET_AREA][iDataName] = `Измеренная Чистая Площадь`
	rowDataNumeric[ROW__ZONE_AREAS__MES_NET_AREA][iParentGroup] = ORDER_ZONE_AREAS

	rowDataString[ROW__ZONE_AREAS__REDUC_AREA][iDataName] = `Уменьшенная Площадь`
	rowDataNumeric[ROW__ZONE_AREAS__REDUC_AREA][iParentGroup] = ORDER_ZONE_AREAS

	rowDataString[ROW__ZONE_AREAS__CALC_AREA][iDataName] = `Вычисленная Площадь`
	rowDataNumeric[ROW__ZONE_AREAS__CALC_AREA][iParentGroup] = ORDER_ZONE_AREAS
endif

if iAreaUnit <> AREA_UNIT_PROJECT then
	rowDataString[ROW__ZONE_AREAS__MES_AREA_CUST][iDataName] = `Измеренная Площадь`
	rowDataNumeric[ROW__ZONE_AREAS__MES_AREA_CUST][iParentGroup] = ORDER_ZONE_AREAS

	rowDataString[ROW__ZONE_AREAS__MES_NET_AREA_CUST][iDataName] = `Измеренная Чистая Площадь`
	rowDataNumeric[ROW__ZONE_AREAS__MES_NET_AREA_CUST][iParentGroup] = ORDER_ZONE_AREAS

	rowDataString[ROW__ZONE_AREAS__REDUC_AREA_CUST][iDataName] = `Уменьшенная Площадь`
	rowDataNumeric[ROW__ZONE_AREAS__REDUC_AREA_CUST][iParentGroup] = ORDER_ZONE_AREAS

	rowDataString[ROW__ZONE_AREAS__CALC_AREA_CUST][iDataName] = `Вычисленная Площадь`
	rowDataNumeric[ROW__ZONE_AREAS__CALC_AREA_CUST][iParentGroup] = ORDER_ZONE_AREAS
endif

if iStampType = ZONE_STAMP_ON then
	rowDataString[ROW__ZONE_AREAS__EXIST_AREA][iDataName] = `Существующая Площадь`
	rowDataNumeric[ROW__ZONE_AREAS__EXIST_AREA][iParentGroup] = ORDER_ZONE_AREAS
endif

if iStampType = ZONE_STAMP_DIN then
	rowDataString[ROW__ZONE_AREAS__VENT_AREA][iDataName] = `Вычтенные Площади DIN`
	rowDataNumeric[ROW__ZONE_AREAS__VENT_AREA][iParentGroup] = ORDER_ZONE_AREAS
endif

rowDataString[ROW__WINDOW_AREA__WINDOW_AREA][iDataName] = `Площадь Окон`
rowDataNumeric[ROW__WINDOW_AREA__WINDOW_AREA][iParentGroup] = ORDER_WINDOW_AREA

rowDataString[ROW__SIZE__PERIMETER][iDataName] = `Периметр`
rowDataNumeric[ROW__SIZE__PERIMETER][iParentGroup] = ORDER_SIZE

rowDataString[ROW__SIZE__CEILING_H][iDataName] = `Высота Потолка`
rowDataNumeric[ROW__SIZE__CEILING_H][iParentGroup] = ORDER_SIZE

rowDataString[ROW__SIZE__VOLUME][iDataName] = `Объем Зоны`
rowDataNumeric[ROW__SIZE__VOLUME][iParentGroup] = ORDER_SIZE

if iStampType = ZONE_STAMP_DIN then
	rowDataString[ROW__AREA_CODE_GER__AREACODE][iDataName] = `Классификация`
	rowDataNumeric[ROW__AREA_CODE_GER__AREACODE][iParentGroup] = ORDER_AREA_CODE_GER
endif
if iStampType = ZONE_STAMP_ON then
	for i = 0 to 16
		rowDataNumeric[ROW__ONORM_AUT__ONORM + i][iParentGroup] = ORDER_ONORM_AUT
	next i
	idR = 0
	rowDataString[ROW__ONORM_AUT__ONORM + idR][iDataName] = `Данные ONORM Количество Дверей`
	idR = idR + 1

	rowDataString[ROW__ONORM_AUT__ONORM + idR][iDataName] = `Данные ONORM Свободная Высота`
	idR = idR + 1

	rowDataString[ROW__ONORM_AUT__ONORM + idR][iDataName] = `Данные ONORM Номинальная Высота`
	idR = idR + 1

	rowDataString[ROW__ONORM_AUT__ONORM + idR][iDataName] = `Данные ONORM Подвесной Потолок`
	idR = idR + 1

	rowDataString[ROW__ONORM_AUT__ONORM + idR][iDataName] = `Данные ONORM Код Использования Зоны`
	idR = idR + 1

	rowDataString[ROW__ONORM_AUT__ONORM + idR][iDataName] = `Данные ONORM Учетный Номер Зоны`
	idR = idR + 1

	rowDataString[ROW__ONORM_AUT__ONORM + idR][iDataName] = `Данные ONORM Дополнительная Информация 1`
	idR = idR + 1

	rowDataString[ROW__ONORM_AUT__ONORM + idR][iDataName] = `Данные ONORM Дополнительная Информация 2`
	idR = idR + 1

	rowDataString[ROW__ONORM_AUT__ONORM + idR][iDataName] = `Данные ONORM Дополнительная Информация 3`
	idR = idR + 1

	rowDataString[ROW__ONORM_AUT__ONORM + idR][iDataName] = `Данные ONORM Административная Единица`
	idR = idR + 1

	rowDataString[ROW__ONORM_AUT__ONORM + idR][iDataName] = `Данные ONORM Код Приписки Зоны`
	idR = idR + 1

	rowDataString[ROW__ONORM_AUT__ONORM + idR][iDataName] = `Данные ONORM Чистая Площадь по ONORM`
	idR = idR + 1

	rowDataString[ROW__ONORM_AUT__ONORM + idR][iDataName] = `Данные ONORM Площадь Зоны по ONORM B 1800`
	idR = idR + 1

	rowDataString[ROW__ONORM_AUT__ONORM + idR][iDataName] = `Данные ONORM Площадь Зоны по MRG`
	idR = idR + 1

	rowDataString[ROW__ONORM_AUT__ONORM + idR][iDataName] = `Данные ONORM Количество Людей`
	idR = idR + 1

	rowDataString[ROW__ONORM_AUT__ONORM + idR][iDataName] = `Данные ONORM Дата Создания`
	idR = idR + 1

	rowDataString[ROW__ONORM_AUT__ONORM + idR][iDataName] = `Данные ONORM Дата Редактирования`
	idR = idR + 1
endif

rowDataString[ROW__ADD__TAGS][iDataName] = `Дополнительные Метки`
rowDataNumeric[ROW__ADD__TAGS][iParentGroup] = ORDER_ADD_TAGS

! the values of Apartment ID rowData arrays are only loaded in the 2D script,
! because the Content Order List does not contain the Apartment ID
!rowDataString[ROW__AREA_CODE_GER__AREACODE][iDataName] = `Apartment ID`

rowDataString[ROW__CUSTOM__1][iDataName] = `Специальный Текст 1`
rowDataNumeric[ROW__CUSTOM__1][iParentGroup] = ORDER_CUSTOM

rowDataString[ROW__CUSTOM__2][iDataName] = `Специальный Текст 2`
rowDataNumeric[ROW__CUSTOM__2][iParentGroup] = ORDER_CUSTOM

rowDataString[ROW__CUSTOM__3][iDataName] = `Специальный Текст 3`
rowDataNumeric[ROW__CUSTOM__3][iParentGroup] = ORDER_CUSTOM

! ==============================================================================
! Variables for PL and UI to connect parameters
! ==============================================================================

iScaleFrom = _iUIDisplayScale


dim _bDisplayInsideBox[4]
	_bDisplayInsideBox[1] = bDisplayInsideBox_0
	_bDisplayInsideBox[2] = bDisplayInsideBox_50
	_bDisplayInsideBox[3] = bDisplayInsideBox_100
	_bDisplayInsideBox[4] = bDisplayInsideBox_200

dim _numDisplayedGroup[4]
	_numDisplayedGroup[1] = nOrder_0
	_numDisplayedGroup[2] = nOrder_50
	_numDisplayedGroup[3] = nOrder_100
	_numDisplayedGroup[4] = nOrder_200


_needFrameAttr_0 = (iFrameStyle_0 # FRAME_NONE) |\
 					(bShowApartmentID_0 & iApartmentIdFrame_0 # APARTMENT_ID_FRAME_NONE) |\
					(bDisplayInsideBox_0)
_needFrameAttr_50 = (iFrameStyle_50 # FRAME_NONE) |\
 					(bShowApartmentID_50 & iApartmentIdFrame_50 # APARTMENT_ID_FRAME_NONE) |\
					(bDisplayInsideBox_50)
_needFrameAttr_100 = (iFrameStyle_100 # FRAME_NONE) |\
 					(bShowApartmentID_100 & iApartmentIdFrame_100 # APARTMENT_ID_FRAME_NONE) |\
					(bDisplayInsideBox_100)
_needFrameAttr_200 = (iFrameStyle_200 # FRAME_NONE) |\
 					(bShowApartmentID_200 & iApartmentIdFrame_200 # APARTMENT_ID_FRAME_NONE) |\
					(bDisplayInsideBox_200)

dim _bShowAdditionalTags[4]
	_bShowAdditionalTags[1] = bShowAdditionalTags_0
	_bShowAdditionalTags[2] = bShowAdditionalTags_50
	_bShowAdditionalTags[3] = bShowAdditionalTags_100
	_bShowAdditionalTags[4] = bShowAdditionalTags_200


! ==============================================================================
! DIN Calculation
! ==============================================================================
if iStampType = ZONE_STAMP_DIN then
	_percentReduction = 0
	if bSubRegul then
		_percentReduction = asAddOn_SubRegul / 100	! Subtraction Reduction is an integer (0-100)
	endif
	_calculatedReducedAreaDIN	= ROOM_CALC_AREA * (1 - _percentReduction)
	_subtractionForFinishesDIN	= (1 - ROOM_AREA_FACTOR) * 100
	_subtractedAreaDIN			= ROOM_AREA - ( ROOM_REDUCED_AREA - ROOM_REDUCED_AREA * _percentReduction ) * ROOM_AREA_FACTOR
endif

! ==============================================================================
goto "MasterEnd"
! ==============================================================================

! ==============================================================================
! Subroutines
! ==============================================================================

! ==============================================================================
"getOrderValues":
! ------------------------------------------------------------------------------
!	Input Parameters:
!		idx:					Order Group Index
!		iStampType:				Caller Zone Stamp Type
!		_bDisplayInsideBox[]	contains the 4 scale dependent parameter
!		iScaleFrom :			setting from calling script, can be from UI or PM
!	        SCALE_INSENSITIVE	= 0
!	        SCALE_50			= 1
!	        SCALE_100			= 2
!	        SCALE_200			= 3
!	Output Parameters:			stack
! ==============================================================================
	if idx = 1 then
		if _bDisplayInsideBox[iScaleFrom+1] = 1 then
			put	ORDER_ZONE_NAME, ORDER_ID, ORDER_APARTMENT, ORDER_FINISHING, ORDER_HEIGHT_NUMBER, ORDER_ZONE_AREAS, ORDER_WINDOW_AREA, ORDER_SIZE, ORDER_ADD_TAGS
		else
			put	ORDER_ZONE_NAME, ORDER_ZONE_NUMBER, ORDER_ID, ORDER_APARTMENT, ORDER_FINISHING, ORDER_HEIGHT, ORDER_ZONE_AREAS, ORDER_WINDOW_AREA, ORDER_SIZE, ORDER_ADD_TAGS
		endif
		if iStampType = ZONE_STAMP_DIN 	then put ORDER_AREA_CODE_GER
		if iStampType = ZONE_STAMP_ON 	then put ORDER_ONORM_AUT
		put ORDER_CUSTOM
		put ORDER_NONE
		return
	endif

	if idx = 2 then
		if _bDisplayInsideBox[iScaleFrom+1] = 1 then
			put	ORDER_ZONE_NAME, ORDER_ID, ORDER_APARTMENT, ORDER_FINISHING, ORDER_HEIGHT_NUMBER, ORDER_ZONE_AREAS, ORDER_WINDOW_AREA, ORDER_SIZE, ORDER_ADD_TAGS
		else
			put	ORDER_ZONE_NUMBER, ORDER_ZONE_NAME, ORDER_ID, ORDER_APARTMENT, ORDER_FINISHING, ORDER_HEIGHT, ORDER_ZONE_AREAS, ORDER_WINDOW_AREA, ORDER_SIZE, ORDER_ADD_TAGS
		endif
		if iStampType = ZONE_STAMP_DIN 	then put ORDER_AREA_CODE_GER
		if iStampType = ZONE_STAMP_ON 	then put ORDER_ONORM_AUT
		put ORDER_CUSTOM
		put ORDER_NONE
		return
	endif

	if idx = 3 then
		if _bDisplayInsideBox[iScaleFrom+1] = 1 then
			put	ORDER_ID, ORDER_ZONE_NAME, ORDER_APARTMENT, ORDER_FINISHING, ORDER_HEIGHT_NUMBER, ORDER_ZONE_AREAS, ORDER_WINDOW_AREA, ORDER_SIZE, ORDER_ADD_TAGS
		else
			put	ORDER_ID, ORDER_ZONE_NAME, ORDER_ZONE_NUMBER, ORDER_APARTMENT, ORDER_FINISHING, ORDER_HEIGHT, ORDER_ZONE_AREAS, ORDER_WINDOW_AREA, ORDER_SIZE, ORDER_ADD_TAGS
		endif
		if iStampType = ZONE_STAMP_DIN 	then put ORDER_AREA_CODE_GER
		if iStampType = ZONE_STAMP_ON 	then put ORDER_ONORM_AUT
		put ORDER_CUSTOM
		put ORDER_NONE
		return
	endif

	if idx = 4 then
		if _bDisplayInsideBox[iScaleFrom+1] = 1 then
			put	ORDER_APARTMENT, ORDER_ZONE_NAME, ORDER_ID, ORDER_FINISHING, ORDER_HEIGHT_NUMBER, ORDER_ZONE_AREAS, ORDER_WINDOW_AREA, ORDER_SIZE, ORDER_ADD_TAGS
		else
			put	ORDER_APARTMENT, ORDER_ZONE_NAME, ORDER_ZONE_NUMBER, ORDER_ID, ORDER_FINISHING, ORDER_HEIGHT, ORDER_ZONE_AREAS, ORDER_WINDOW_AREA, ORDER_SIZE, ORDER_ADD_TAGS
		endif
		if iStampType = ZONE_STAMP_DIN 	then put ORDER_AREA_CODE_GER
		if iStampType = ZONE_STAMP_ON 	then put ORDER_ONORM_AUT
		put ORDER_CUSTOM
		put ORDER_NONE
		return
	endif

	if idx = 5 then
		if _bDisplayInsideBox[iScaleFrom+1] = 1 then
			put	ORDER_FINISHING, ORDER_ZONE_NAME, ORDER_ID, ORDER_APARTMENT, ORDER_HEIGHT_NUMBER, ORDER_ZONE_AREAS, ORDER_WINDOW_AREA, ORDER_SIZE, ORDER_ADD_TAGS
		else
			put	ORDER_FINISHING, ORDER_ZONE_NAME, ORDER_ZONE_NUMBER, ORDER_ID, ORDER_APARTMENT, ORDER_HEIGHT, ORDER_ZONE_AREAS, ORDER_WINDOW_AREA, ORDER_SIZE, ORDER_ADD_TAGS
		endif
		if iStampType = ZONE_STAMP_DIN 	then put ORDER_AREA_CODE_GER
		if iStampType = ZONE_STAMP_ON 	then put ORDER_ONORM_AUT
		put ORDER_CUSTOM
		put ORDER_NONE
		return
	endif

	if idx = 6 then
		if _bDisplayInsideBox[iScaleFrom+1] = 1 then
			put	ORDER_HEIGHT_NUMBER, ORDER_ZONE_NAME, ORDER_ID, ORDER_APARTMENT, ORDER_FINISHING, ORDER_ZONE_AREAS, ORDER_WINDOW_AREA, ORDER_SIZE, ORDER_ADD_TAGS
		else
			put	ORDER_HEIGHT, ORDER_ZONE_NAME, ORDER_ZONE_NUMBER, ORDER_ID, ORDER_APARTMENT, ORDER_FINISHING, ORDER_ZONE_AREAS, ORDER_WINDOW_AREA, ORDER_SIZE, ORDER_ADD_TAGS
		endif
		if iStampType = ZONE_STAMP_DIN 	then put ORDER_AREA_CODE_GER
		if iStampType = ZONE_STAMP_ON 	then put ORDER_ONORM_AUT
		put ORDER_CUSTOM
		put ORDER_NONE
		return
	endif

	if idx = 7 then
		if _bDisplayInsideBox[iScaleFrom+1] = 1 then
			put	ORDER_ZONE_AREAS, ORDER_ZONE_NAME, ORDER_ID, ORDER_APARTMENT, ORDER_FINISHING, ORDER_HEIGHT_NUMBER, ORDER_WINDOW_AREA, ORDER_SIZE, ORDER_ADD_TAGS
		else
			put	ORDER_ZONE_AREAS, ORDER_ZONE_NAME, ORDER_ZONE_NUMBER, ORDER_ID, ORDER_APARTMENT, ORDER_FINISHING, ORDER_HEIGHT, ORDER_WINDOW_AREA, ORDER_SIZE, ORDER_ADD_TAGS
		endif
		if iStampType = ZONE_STAMP_DIN 	then put ORDER_AREA_CODE_GER
		if iStampType = ZONE_STAMP_ON 	then put ORDER_ONORM_AUT
		put ORDER_CUSTOM
		put ORDER_NONE
		return
	endif

	if idx = 8 then
		if _bDisplayInsideBox[iScaleFrom+1] = 1 then
			put ORDER_WINDOW_AREA, ORDER_ZONE_NAME, ORDER_ID, ORDER_APARTMENT, ORDER_FINISHING, ORDER_HEIGHT_NUMBER, ORDER_ZONE_AREAS, ORDER_SIZE, ORDER_ADD_TAGS
		else
			put ORDER_WINDOW_AREA, ORDER_ZONE_NAME, ORDER_ZONE_NUMBER, ORDER_ID, ORDER_APARTMENT, ORDER_FINISHING, ORDER_HEIGHT, ORDER_ZONE_AREAS, ORDER_SIZE, ORDER_ADD_TAGS
		endif
		if iStampType = ZONE_STAMP_DIN 	then put ORDER_AREA_CODE_GER
		if iStampType = ZONE_STAMP_ON 	then put ORDER_ONORM_AUT
		put ORDER_CUSTOM
		put ORDER_NONE
		return
	endif

	if idx = 9 then
		if _bDisplayInsideBox[iScaleFrom+1] = 1 then
			put	ORDER_SIZE, ORDER_ZONE_NAME, ORDER_ID, ORDER_APARTMENT, ORDER_FINISHING, ORDER_HEIGHT_NUMBER, ORDER_ZONE_AREAS, ORDER_WINDOW_AREA, ORDER_ADD_TAGS
		else
			put	ORDER_SIZE, ORDER_ZONE_NAME, ORDER_ZONE_NUMBER, ORDER_ID, ORDER_APARTMENT, ORDER_FINISHING, ORDER_HEIGHT, ORDER_ZONE_AREAS, ORDER_WINDOW_AREA, ORDER_ADD_TAGS
		endif
		if iStampType = ZONE_STAMP_DIN 	then put ORDER_AREA_CODE_GER
		if iStampType = ZONE_STAMP_ON 	then put ORDER_ONORM_AUT
		put ORDER_CUSTOM
		put ORDER_NONE
		return
	endif

	if idx = 10 then
		if _bDisplayInsideBox[iScaleFrom+1] = 1 then
			put	ORDER_ADD_TAGS, ORDER_ZONE_NAME, ORDER_ID, ORDER_APARTMENT, ORDER_FINISHING, ORDER_HEIGHT_NUMBER, ORDER_ZONE_AREAS, ORDER_WINDOW_AREA, ORDER_SIZE
		else
			put	ORDER_ADD_TAGS, ORDER_ZONE_NAME, ORDER_ZONE_NUMBER, ORDER_ID, ORDER_APARTMENT, ORDER_FINISHING, ORDER_HEIGHT, ORDER_ZONE_AREAS, ORDER_WINDOW_AREA, ORDER_SIZE
		endif
		if iStampType = ZONE_STAMP_DIN 	then put ORDER_AREA_CODE_GER
		if iStampType = ZONE_STAMP_ON 	then put ORDER_ONORM_AUT
		put ORDER_CUSTOM
		put ORDER_NONE
		return
	endif

	if idx = 11 then
		if iStampType = ZONE_STAMP_DIN 	then put ORDER_AREA_CODE_GER
		if iStampType = ZONE_STAMP_ON 	then put ORDER_ONORM_AUT
		if _bDisplayInsideBox[iScaleFrom+1] = 1 then
			put	ORDER_ZONE_NAME, ORDER_ID, ORDER_APARTMENT, ORDER_FINISHING, ORDER_HEIGHT_NUMBER, ORDER_ZONE_AREAS, ORDER_WINDOW_AREA, ORDER_SIZE, ORDER_ADD_TAGS
		else
			put	ORDER_ZONE_NAME, ORDER_ZONE_NUMBER, ORDER_ID, ORDER_APARTMENT, ORDER_FINISHING, ORDER_HEIGHT, ORDER_ZONE_AREAS, ORDER_WINDOW_AREA, ORDER_SIZE, ORDER_ADD_TAGS
		endif
		put ORDER_CUSTOM
		put ORDER_NONE
		return
	endif

	if idx = 12 then
		put ORDER_CUSTOM
		if _bDisplayInsideBox[iScaleFrom+1] = 1 then
			put	ORDER_ZONE_NAME, ORDER_ID, ORDER_APARTMENT, ORDER_FINISHING, ORDER_HEIGHT_NUMBER, ORDER_ZONE_AREAS, ORDER_WINDOW_AREA, ORDER_SIZE, ORDER_ADD_TAGS
		else
			put	ORDER_ZONE_NAME, ORDER_ZONE_NUMBER, ORDER_ID, ORDER_APARTMENT, ORDER_FINISHING, ORDER_HEIGHT, ORDER_ZONE_AREAS, ORDER_WINDOW_AREA, ORDER_SIZE, ORDER_ADD_TAGS
		endif
		if iStampType = ZONE_STAMP_DIN 	then put ORDER_AREA_CODE_GER
		if iStampType = ZONE_STAMP_ON 	then put ORDER_ONORM_AUT
		put ORDER_NONE
		return
	endif

return

! ==============================================================================
"MasterEnd":
! ==============================================================================
