
w_units_form = ""
rrr = request("Working_length_unit", "", w_units_form)
_bMetricDimension = strstr(w_units_form, "m")		! m, cm, mm


inFieldHeight = 19
outFieldHeight = 15
penBoxHeight = 19
buttonHeight = 20

inFieldWidth1 = 130
inFieldWidth2 = 120
inFieldWidth3 = 100
penBoxWidth = 33
buttonWidth = 20

pageStartX = 1
pageStartY = 40

if bWrapText then
	_BoxWidthTooltipLeft = `Ширина Текста Столбца Названий Параметров`
	_BoxWidthTooltipRight = `Ширина Текста Столбца Значений`
else
	_BoxWidthTooltipLeft = `Ширина Текста Столбца Названий Параметров. Активируется при включении Переноса Текста в панели Стиля Текста.`
	_BoxWidthTooltipRight = `Ширина Текста Столбца Значений. Активируется при включении Переноса Текста в панели Стиля Текста.`
endif


file_dependence "ui_InfoIcon_flat(1)"

if idTab_HeaderStyle > 0 and gs_ui_current_page = idTab_HeaderStyle then
	ui_page idTab_HeaderStyle
		gosub "HeaderStylePage"
endif


if idTab_FrameStyle > 0 and gs_ui_current_page = idTab_FrameStyle then
	ui_page idTab_FrameStyle 
		gosub "AppearancePage"
endif


! ==============================================================================
end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! en
! ==============================================================================


! ==============================================================================
"HeaderStylePage":
! ------------------------------------------------------------------------------

	x1 = pageStartX
	x2 = 180
	x3 = x2 + inFieldWidth1
	x4 = x3 + 13
	x5 = x4 + inFieldWidth2

	yCurr = pageStartY

	dy = 40
		
	ui_style 0,1
	ui_infield{3} "bUseCustomHeaderStyle", x1, yCurr,	440-x1, outFieldHeight,
			7, "", 2, 1, 0, 0, 0, 0,
			1, `Заменить Стиль Текста Первой Строки`, 0,
			2, `Заменить Стиль Текста Первой Строки`, 1
	ui_style 0,0
	yCurr = yCurr + dy

	_hiddenFlag = 4 * bUseCustomHeaderStyle

	ui_infield{3} "iAlignmentHeader", x2/2 - 74/2, yCurr, 74, 50,
		2, 2,		! ui_IDAlign
		3, 1,
		59, 38, 59, 38,
		1, _stAlignment[1], IDALIGN_LEFT,
		2, _stAlignment[2], IDALIGN_CENTER,
		3, _stAlignment[3], IDALIGN_RIGHT


	if bUseCustomHeaderStyle then
		ui_pict "Pen Colour_flat(1)", x2 - 20, yCurr, 13, 19, 1
	else
		ui_pict "Pen ColourLock_flat(1)", x2 - 20, yCurr, 13, 19, 1
	endif

	ui_infield{3} "penTextHeader", x2, yCurr, penBoxWidth, penBoxHeight		
	ui_infield{3} "fontTypeHeader", x2 + penBoxWidth+2, yCurr, x5 - x2 - penBoxWidth-15, inFieldHeight
	
	dy = 35
	yCurr = yCurr + dy
	
	pictx = 27
	picty = 14

	if bUseCustomHeaderStyle then
		ui_pict "ui_FontSize_flat(1)", x2 - 30, yCurr-2, pictx, picty, 1
	else
		ui_pict "ui_FontSize_hide_flat(1)", x2 - 30, yCurr-2, pictx, picty, 1
	endif
	
	if _bMetricDimension then	
		ui_infield{3} "sizeFontHeader_mm", x2, yCurr-4,	penBoxWidth, inFieldHeight
		ui_outfield `мм`, x2 + penBoxWidth + 2, yCurr, 30, outFieldHeight,_hiddenFlag + 2
	else
		ui_infield{3} "sizeFontHeader_pt", x2, yCurr-4,	penBoxWidth, inFieldHeight
		ui_outfield `пт`, x2 + penBoxWidth + 2, yCurr, 30, outFieldHeight,_hiddenFlag + 2
	endif

	xdiff = 3
	ui_infield{3} "bBoldStyleHeader", x4, yCurr-4*2, buttonWidth, buttonHeight,
			6, "",
			2,
			1, 16, 16, 16, 16,
			"ui_bold_flat(1)", "", 0,
			"ui_bold_flat(1)", "", 1\
			ui_tooltip `Жирный`
		
	
	ui_infield{3} "bItalicStyleHeader", x4+(buttonWidth+xdiff), yCurr-4*2, buttonWidth, buttonHeight,
			6, "",
			2,
			1, 16, 16, 16, 16,
			"ui_italic_flat(1)", "", 0,
			"ui_italic_flat(1)", "", 1\
			ui_tooltip `Курсив`
		
	ui_infield{3} "bUnderlineStyleHeader", x4+2*(buttonWidth+xdiff), yCurr-4*2, buttonWidth, buttonHeight,
			6, "",
			2,
			1, 16, 16, 16, 16,
			"ui_underline_flat(1)", "", 0,
			"ui_underline_flat(1)", "", 1\
			ui_tooltip `Подчеркнутый`
		
	ui_infield{3} "bStrikethroughStyleHeader", x4+3*(buttonWidth+xdiff), yCurr-4*2, buttonWidth, buttonHeight,
			6, "",
			2,
			1, 16, 16, 16, 16,
			"ui_text_strikethrough_flat(1)", "", 0,
			"ui_text_strikethrough_flat(1)", "", 1\
			ui_tooltip `Зачеркнутый`

	dy = 45

	yCurr = yCurr + dy

	ui_outfield `Межстрочное Расстояние`, x2/2 - 74/2, yCurr, x2-(x2/2 - 74/2), outFieldHeight
	ui_infield{3} "iLineSpaceHeader",	x2, yCurr-4, x3-x2, inFieldHeight,
			8, "", 3, 1, 0, 0, 0, 0,
			"", sAutoCustom[VALUE_AUTOMATIC], VALUE_AUTOMATIC,
			"", sAutoCustom[VALUE_CUSTOM], VALUE_CUSTOM

	if _bMetricDimension then	
		ui_infield{3} "sizeLineSpaceHeader_mm", x4, yCurr-4,	x5-x4 - 30, inFieldHeight
		ui_outfield `мм`, x5-30, yCurr, 30, outFieldHeight, _hiddenFlag + 2
	else
		ui_infield{3} "sizeLineSpaceHeader_pt", x4, yCurr-4,	x5-x4 - 30, inFieldHeight
		ui_outfield `пт`, x5-30, yCurr, 30, outFieldHeight, _hiddenFlag + 2
	endif

return


! =============================================================================
"AppearancePage":
! ------------------------------------------------------------------------------

	x1 = pageStartX
	x2 = 150
	x3 = x2 + 5
	x4 = 313
	x5 = x4 + inFieldWidth3

	yCurr = pageStartY - 3

	dy = 24

	ySep = yBottomPosGeneral

	ui_separator x2, yCurr, x2, ySep


	ui_style 0,1
	ui_outfield `Стиль Рамки`, x1, yCurr, x2-x1-1, outFieldHeight
	ui_style 0,0
	yCurr = yCurr + dy
	
	ui_infield{3} "iFrameStyle", x1+50, yCurr, 78, 94,
		2, 1,			! ui_frameTypes
		7, 1,
		64, 78, 64, 78,
		2, _stFrameStyles[FRAME_STYLE1], FRAME_STYLE1,
		3, _stFrameStyles[FRAME_STYLE2], FRAME_STYLE2,
		4, _stFrameStyles[FRAME_STYLE3], FRAME_STYLE3,
		5, _stFrameStyles[FRAME_STYLE4], FRAME_STYLE4,
		6, _stFrameStyles[FRAME_STYLE5], FRAME_STYLE5,
		7, _stFrameStyles[FRAME_STYLE6], FRAME_STYLE6

	if not(bShowFrame) then
		_pictPosition	= yCurr + 80	! yCurr + 94 - 14
		_stInfoNote		= `Включить рамку можно в панели Стиля Текста.`

		if yBottomPosGeneral > 200 then
			ui_pict "ui_InfoIcon_flat(1)", x1, yBottomPosGeneral-outFieldHeight*3 - 17, 14, 14, 1
			ui_outfield _stInfoNote	, x1, yBottomPosGeneral-outFieldHeight*3, x2-x1-1, outFieldHeight*3
		else
			ui_pict "ui_InfoIcon_flat(1)", x1, _pictPosition, 14, 14, 1	ui_tooltip _stInfoNote	
		endif
	endif

	_hiddenFlagLeft = 4 * (not(bWrapText) | not(bUsePrefixColumn))

	_hiddenFlagRight = 4 * (not(bWrapText) | not(bUseContentColumn))

	yCurr = pageStartY - 3
	dy = min(28, 32/235 * yBottomPosGeneral)

	ui_outfield `Ширина Текста Названий`, x3, yCurr, x4-x3-1, outFieldHeight, _hiddenFlagLeft
	if _bMetricDimension then 
		ui_infield "widthTextBoxPrefix_mm", x4, yCurr-4, x5-x4-1, inFieldHeight ui_tooltip _BoxWidthTooltipLeft
		ui_outfield `мм`, x5, yCurr, 30, outFieldHeight, 2 + _hiddenFlagLeft
	else
		ui_infield "widthTextBoxPrefix_pt", x4, yCurr-4, x5-x4-1, inFieldHeight ui_tooltip _BoxWidthTooltipLeft
		ui_outfield `пт`, x5, yCurr, 30, outFieldHeight, 2 + _hiddenFlagLeft
	endif
	yCurr = yCurr + dy

	ui_outfield `Ширина Текста Значений`, x3, yCurr, x4-x3-1, outFieldHeight, _hiddenFlagRight
	if _bMetricDimension then 
		ui_infield "widthTextBoxContent_mm", x4, yCurr-4, x5-x4-1, inFieldHeight ui_tooltip _BoxWidthTooltipRight
		ui_outfield `мм`, x5, yCurr, 30, outFieldHeight, 2 + _hiddenFlagRight
	else
		ui_infield "widthTextBoxContent_pt", x4, yCurr-4, x5-x4-1, inFieldHeight ui_tooltip _BoxWidthTooltipRight
		ui_outfield `пт`, x5, yCurr, 30, outFieldHeight, 2 + _hiddenFlagRight
	endif
	yCurr = yCurr + dy
	
	ui_outfield `Ориентация`,x3, yCurr, x4-x3-1, outFieldHeight
	ui_infield{3} "iLabelOrientation",	x4, yCurr-4, x5-x4-1, 40,
		2, "ui_label_orientation_flat(1)", 6, 2,
		35, 35, 32, 32,
		5, _stLabelOrientation[ORIENTATION_PARALLEL],	ORIENTATION_PARALLEL,
		2, _stLabelOrientation[ORIENTATION_VERTICAL],	ORIENTATION_VERTICAL,
		1, _stLabelOrientation[ORIENTATION_HORIZONTAL], ORIENTATION_HORIZONTAL,
		3, _stLabelOrientation[ORIENTATION_CUSTOM],		ORIENTATION_CUSTOM
	yCurr = yCurr + dy + 40 - inFieldHeight
	
	ui_outfield		`Точка Привязки`,	x3, yCurr,		x4-x3-1,	outFieldHeight
	ui_infield{3}	"iReferencePoint",	x4, yCurr-4,	x5-x4,		45,
		3, "ui_anchorpoint_flat(1)", 9, 3, 41, 41, 41, 41,
		_picIdxRefPoint, _stRefPoint, _valuesRefPoint
		
return
