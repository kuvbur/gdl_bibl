
! ==============================================================================
! electricalItems_m
! ==============================================================================


EPS = 0.0001

! ==============================================================================
! Group Type
! ==============================================================================

GROUP_SYMBOL 			= 1
GROUP_SWITCH 			= 2
GROUP_SWITCH_OUTLET		= 3
GROUP_OUTLET 			= 4
GROUP_SIGNAL 			= 5

! ==============================================================================
! Object Type
! ==============================================================================

OBJECT_PUSH_BUTTON			= 1
OBJECT_RECESS_CAN_LIGHT		= 2
OBJECT_VANITY_FIXTURE		= 3
OBJECT_WALL_SCONCE			= 4
OBJECT_SMOKE_DETECTOR		= 5
OBJECT_FAN_SYMBOL			= 6
OBJECT_JUNCTION_BOX			= 7

OBJECT_SWITCH_NORMAL 		= 1
OBJECT_SWITCH_SINGLE_POLE 	= 2

OBJECT_SWITCH_OUTLET		= 1

OBJECT_FLOOR_OUTLET				= 1
OBJECT_WALL_FIXTURE_OUTLET		= 2
OBJECT_SPECIAL_PURPOSE_OUTLET	= 3
OBJECT_OUTLET_1					= 4
OBJECT_OUTLET_2					= 5

OBJECT_PHONE_SIGNAL			= 1
OBJECT_COMMUNICATION_SIGNAL	= 2
OBJECT_AUDIO_SIGNAL			= 3

! ==============================================================================
! Item Type
! ==============================================================================

SMOKE_DETECTOR		= 1
HEAT_DETECTOR		= 2
COMBI_DETECTOR		= 3

FAN						= 1
EXHAUST_FAN				= 2
FAN_WITH_LIGHT			= 3
FAN_LIGHT_COMBO			= 4
CEILING_FAN				= 5

CEILING_JUNCTION_BOX 	= 1
WALL_JUNCTION_BOX 		= 2

SWITCH_COUPLED			= 1
SWITCH_DOUBLE_GANG		= 2
SWITCH_4_GANG			= 3
SWITCH_SING_POLE		= 4
SWITCH_DOUBLE_POLE		= 5
SWITCH_3_WAY			= 6
SWITCH_4_WAY			= 7

SINGLE					= 1
DOUBLE					= 2
TRIPLE					= 3
QUAD					= 4

DUPLEX					= 2
ONEPOLE					= 3
TELEPHONE				= 4

FAN_OUTLET				= 1
CLOCK_OUTLET			= 2
CUSTOM_OUTLET			= 3

PHONE_TELEPHONE			= 1
PHONE_SW_BOARD			= 2

RADIO_OUT				= 1
TV_OUT					= 2
CUSTOM_OUT				= 3

ANNUCIATOR				= 1
BELL					= 2
BUZZER					= 3
BELL_BUZZER				= 4
CHIMES					= 5
MOTION_DETECTOR			= 6
DOOR_OPEN				= 7
CUSTOM_AUDIO			= 8

! ==============================================================================
! Switch Type
! ==============================================================================

TOGGLE	= 1
ROCKER	= 2
BUTTON	= 3

! ==============================================================================
! Outlet Type
! ==============================================================================

RECEPTACLE		= 1
PHONE_OUTLET	= 2
CABLE_OUTLET	= 3

Dot_in_mm = 25.4 / 72

! ==============================================================================
! Strings for Migration - Signal Chimes, Signal MD Sign, Signal Door Open
! ==============================================================================

if GLOB_SCRIPT_TYPE = 7 | GLOB_SCRIPT_TYPE = 8 then
	SMOKE_HEAT_DETECTOR		= 1
	SMOKE_DETECTOR			= 2
	SIGNAL_SMOKE_DETECTOR	= 3

	dim stText2DForMigration[7]
		stText2DForMigration[1] 	= `ДД`
		stText2DForMigration[2] 	= "d"
		stText2DForMigration[3] 	= "A"
		stText2DForMigration[4] 	= "2"
		stText2DForMigration[5] 	= "3"
		stText2DForMigration[6] 	= "4"
		stText2DForMigration[7] 	= "S"

	dim stSwitchTypeForMigration[3]
		stSwitchTypeForMigration[1] = `Переключатель`
		stSwitchTypeForMigration[2] = `Рокер`
		stSwitchTypeForMigration[3] = `Кнопка`

	dim stOutletTypeForMigration[3]
		stOutletTypeForMigration[1] = `Приёмник`
		stOutletTypeForMigration[2] = `Вывод Телефона`
		stOutletTypeForMigration[3] = `Вывод Кабеля`

	dim stPlaceByForMigration[2]
		stPlaceByForMigration[1] = `Центр`
		stPlaceByForMigration[2] = `Основание Плиты`
endif

! ==============================================================================
! Variable settings
! ==============================================================================

if GLOB_SCRIPT_TYPE <> 7 & GLOB_SCRIPT_TYPE <> 8 then
	dim stOrientation[2]
		stOrientation[1] = `Горизонтальный`
		stOrientation[2] = `Вертикальный`

	if (iGroupType = GROUP_OUTLET & iObjectType <> OBJECT_FLOOR_OUTLET) | iGroupType = GROUP_SWITCH\
	 | (iGroupType = GROUP_SIGNAL & (iObjectType = OBJECT_PHONE_SIGNAL | iObjectType = OBJECT_COMMUNICATION_SIGNAL)) then
		values "orientation" stOrientation
		values "iOrientation" 1, 2

		if GLOB_MODPAR_NAME = "orientation" then
			iOrientation = 1
			if orientation = stOrientation[2] then iOrientation = 2
			parameters iOrientation = iOrientation
		else
			orientation = stOrientation[1]
			if iOrientation = 2 then orientation = stOrientation[2]
			parameters orientation = orientation
		endif
	endif

	bLeftCon = gs_bLeftConnection
	bRightCon = gs_bRightConnection
	bBottomCon = gs_bBottomConnection
	bTopCon = gs_bTopConnection
	plateW = gs_plateWidth
	plateH = gs_plateHeight
	boxW = gs_boxWidth
	boxH = gs_boxHeight
	if iOrientation = 2 then
		bLeftCon = gs_bBottomConnection
		bRightCon = gs_bTopConnection
		bBottomCon = gs_bRightConnection
		bTopCon = gs_bLeftConnection
		plateH = gs_plateWidth
		plateW = gs_plateHeight
		boxH = gs_boxWidth
		boxW = gs_boxHeight
	endif

	nModItem = nItem
	if iObjectType = OBJECT_OUTLET_1 then
		if iItemType = QUAD 	then nModItem = 2
	endif

	fullLength = max (plateW, boxW)
	elementLength = min(plateW, boxW) / nModItem
	elementHeight = min(plateH, boxH)

	if abs(plateW - boxW) < EPS then
		leftPanelOverhang = 0
		rightPanelOverhang = 0
		leftBoxOverhang = 0
		rightBoxOverhang = 0
	else
		if plateW > boxW then
			if bLeftCon then
				leftPanelOverhang = 0
				rightPanelOverhang = plateW - boxW
			else
				if bRightCon then
					leftPanelOverhang = plateW - boxW
					rightPanelOverhang = 0
				else !No ganging
					leftPanelOverhang = (plateW - boxW) / 2
					rightPanelOverhang = (plateW - boxW) / 2
				endif
			endif

			leftBoxOverhang = 0
			rightBoxOverhang = 0

		else

			if bLeftCon then
				leftBoxOverhang = 0
				rightBoxOverhang = boxW - plateW
			else
				if bRightCon then
					leftBoxOverhang = boxW - plateW
					rightBoxOverhang = 0
				else
					leftBoxOverhang = (boxW - plateW) / 2
					rightBoxOverhang = (boxW - plateW) / 2
				endif
			endif

			leftPanelOverhang = 0
			rightPanelOvehang = 0
		endif
	endif

	if abs(plateH - boxH) < EPS then
		topPanelOverhang = 0
		bottomPanelOverhang = 0
		topBoxOverhang = 0
		bottomBoxOverhang = 0
	else
		if plateH > boxH then
			if bTopCon then
				topPanelOverhang = 0
				bottomPanelOverhang = plateH - boxH
			else
				if bBottomCon then
					topPanelOverhang = plateH - boxH
					bottomPanelOverhang = 0
				else
					topPanelOverhang = (plateH - boxH) / 2
					bottomPanelOverhang = (plateH - boxH) / 2
				endif
			endif

			topBoxOverhang = 0
			bottomBoxOverhang = 0
		else
			if bTopCon then
				topBoxOverhang = 0
				bottomBoxOverhang = boxH - plateH
			else
				if bBottomCon then
					topBoxOverhang = boxH - plateH
					bottomBoxOverhang = 0
				else
					topBoxOverhang = (boxH - plateH) / 2
					bottomBoxOverhang = (boxH - plateH) / 2
				endif
			endif

			topPanelOverhang = 0
			bottomPanelOverhang = 0
		endif
	endif
endif

