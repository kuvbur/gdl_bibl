
IF gs_detlevel_3D_m=0 THEN END

RESOL gs_resol
PEN gs_cont_pen


IF gs_shadow=0 THEN SHADOW OFF
IF gs_shadow=1 THEN SHADOW ON
IF GLOB_CONTEXT>20 and GLOB_CONTEXT<40 THEN gs_detlevel_3D_m=1

IF hotspot_3D THEN
	unID = 1
	HOTSPOT -a/2, -b/2, 0, unID
	unID=unID+1
	HOTSPOT -a/2,  b/2, 0, unID
	unID=unID+1
	HOTSPOT  a/2, -b/2, 0, unID
	unID=unID+1
	HOTSPOT  a/2,  b/2, 0, unID
	unID=unID+1

	hotspot -a/2, -b/2, 0, unID, zzyzx, 1+128
	unID=unID+1
	hotspot -a/2, -b/2, -1, unID,  zzyzx, 3
	unID=unID+1
	hotspot -a/2, -b/2, zzyzx, unID,  zzyzx, 2

	unID=unID+1
	hotspot -a/2,  b/2, 0, unID, zzyzx, 1+128
	unID=unID+1
	hotspot -a/2,  b/2, -1, unID,  zzyzx, 3
	unID=unID+1
	hotspot -a/2,  b/2, zzyzx, unID,  zzyzx, 2
ENDIF

ADDX -a/2

IF gs_detlevel_3D_m=1 THEN	!! Simple 3D

MATERIAL rack_mat

ADD 0.01, -b/2, zzyzx-0.18
BLOCK a-0.01, b, 0.05
DEL 1

ADD 0, -b/2+0.01, zzyzx-0.13
BLOCK 0.21, b-0.02, 0.13
DEL 1

MATERIAL hose_mat

ADD 0.018, -hth/2, 0
BLOCK a-0.03, hth, zzyzx-0.18
DEL 1


ENDIF


IF gs_detlevel_3D_m=2 THEN


!! Detailed 3D !!

MATERIAL rack_mat


!! Connection !!
ADDZ zzyzx-0.05
RESOL gs_resol*2
REVOLVE 9, 360, 1+2+4+8+16+32,
	0.21, 0.005, 0,
	0.16, 0.005, 0,
	0.16, 0.027, 0,
	0.15, 0.027, 0,
	0.15, 0.025, 0,
	0.1499, 0.025, 1,
   -1, 0, 800,
	0.09, 0.05, 1000,
	0.08, 0.05, 0

RESOL gs_resol
REVOLVE 4, 360, 1+2+4+8+16+32,
	0.21, 0.045, 1,
	0, 1, 800,
	0.2, 0.045, 1001,
	0.21, 0.045, 1001

ROTY 90
CUTPOLYA 2, 1, 0,
	0, 0, 979,
	0.005, 360, 4079

!	 0.005, 0, 15,
!	 0, 1, 800,
!	-0.005, 0, 1015,
!	 0.005, 0, 1015
DEL 1



FOR HI=1 TO gs_resol

IF gs_resol/4-INT(gs_resol/4)=0 THEN rk=1
ROTX 180/gs_resol*rk
ADD 0.205, 0, 0.045*COS(180/gs_resol)
ROTX 90
MULY COS(180/gs_resol)
CUTPOLYA 4, 1, 0,
	 0.005, 0, 79,
	 0, 1, 800,
	-0.005, 0, 1079,
	 0.005, 0, 1079
DEL 4

ROTX 360/gs_resol
NEXT HI
DEL gs_resol

FOR HJ=1 TO 2
	ROTX 45
	ADD 0.205-0.004, -0.0015, -0.045*COS(180/gs_resol)
	BLOCK 0.008, 0.003, 0.09*COS(180/gs_resol)
	DEL 2
ROTX 90
NEXT HJ
DEL 2

FOR HI=1 TO gs_resol
CUTEND
NEXT HI

CUTEND

RESOL 6
REVOLVE 2, 360, 1+2+4+8+16+32+64,
	0.02, 0.05, 0,
	0, 0.05, 0
DEL 1

RESOL gs_resol
ADD 0.02, 0, zzyzx-0.125
ROTX 90
ROTY 90
PRISM_ 5, 0.06,
	-0.04, 0, 15,
	 0.04, 0, 15,
	 0.04, 0.075, 79,
	-0.04, 0.075, 1079,
	-0.04, 0, -1
DEL 3


ADDZ zzyzx-0.13
	PRISM_ 5, 0.005,
		 0.015, -0.045, 15,
		 0.085, -0.045, 15,
		 0.085,  0.045, 15,
		 0.015,  0.045, 15,
		 0.015, -0.045, -1
DEL 1


ADD 0, b/2, zzyzx-0.18
ROTX 90
	PRISM_ 7, b,
		 0.01,   0, 15,
		 0.09,   0, 15,
		 0.1,    0.01, 15,
		 a,  0.01, 15,
		 a,  0.05, 15,
		 0.01,  0.05, 15,
		 0.01,  0,  -1
DEL 2



!! Hose !!

MATERIAL squirt_mat

ADD 0.05, 0, zzyzx-0.21
CYLIND 0.03, 0.032
DEL 1

ADD 0.05, 0, zzyzx-0.25
CYLIND 0.04, 0.04
DEL 1


MATERIAL hose_mat

ADD 0.082, 0, zzyzx-0.25
ROTZ 90
RULED  17,  16,
			0.006243,     0.000615,     1,
			0.017778,     0.005393,     1,
			0.026607,     0.014222,     1,
			0.031385,     0.025757,     1,
			0.031385,     0.038243,     1,
			0.026607,     0.049778,     1,
			0.017778,     0.058607,     1,
			0.006243,     0.063385,     1,
		   -0.006243,     0.063385,     1,
		   -0.017778,     0.058607,     1,
		   -0.026607,     0.049778,     1,
		   -0.031385,     0.038243,     1,
		   -0.031385,     0.025757,     1,
		   -0.026607,     0.014222,     1,
		   -0.017778,     0.005393,     1,
		   -0.006243,     0.000615,     1,
			0.006243,     0.000615,     1,

			0.006243,     0,     -0.3,
			0.017778,     0,     -0.3,
			hth/2,     0,     -0.3,
			hth/2,     0,     -0.3,
			hth/2,     0.0082,     -0.3,
			hth/2,     0.0082,     -0.3,
			0.017778,     0.0082,     -0.3,
			0.006243,     0.0082,     -0.3,
		   -0.006243,     0.0082,     -0.3,
		   -0.017778,     0.0082,     -0.3,
		   -hth/2,     0.0082,     -0.3,
		   -hth/2,     0.0082,     -0.3,
		   -hth/2,     0,     -0.3,
		   -hth/2,     0,     -0.3,
		   -0.017778,     0,     -0.3,
		   -0.006243,     0,     -0.3,
			0.006243,     0,     -0.3
DEL 2


if gs_resol > 5 then resol gs_resol/2 else resol 3

ADDY hth/2
ROTX 90
PRISM_ 9, hth,
	0.158, zzyzx-0.17, 15,
	0.158, 0.02, 79,
	0.02, -168.2777, 2079,
	0.0738, zzyzx-0.55, 8,
	0.082, zzyzx-0.55, 13,
	0.138-0.012*COS(11.7223), 0.02-0.012*SIN(11.7223), 79,
	0.15, 0.02, 1079,
	0.15, zzyzx-0.17, 15,
	0.158, zzyzx-0.17, -1
DEL 2


lhh  = 0
lhm1 = 0
lhm2 = 0
nHk = int((A-0.158-0.04)/0.04)
for hk=1 to nHk

	if hk = nHk then
		lhh=0.28
		lhm1=7
		lhm2=2
	endif

	ADDX (A-0.158-0.04)/nHk

	ADDY hth/2
	ROTX 90
	PRISM_ 9, hth,
		0.128, zzyzx-0.17, 15,
		0.128, 0.015, 79,
		0.158, 0.015, 1079,
		0.158, zzyzx-0.17-lhh, 15-lhm1,
		0.15, zzyzx-0.17-lhh, 15-lhm2,
		0.15, 0.015, 79,
		0.136, 0.015, 1079,
		0.136, zzyzx-0.17, 15,
		0.128, zzyzx-0.17, -1
	DEL 2
next hk
if nHk>EPS then del nHk


RESOL gs_resol

ADD a-0.04+0.008, 0, zzyzx-0.3
ROTZ -90
RULED       17,     16,
			0.003902,    -0.019616,     1,
			0.011111,    -0.016629,     1,
			0.016629,    -0.011111,     1,
			0.019616,    -0.003902,     1,
			0.019616,     0.003902,     1,
			0.016629,     0.011111,     1,
			0.011111,     0.016629,     1,
			0.003902,     0.019616,     1,
		   -0.003902,     0.019616,     1,
		   -0.011111,     0.016629,     1,
		   -0.016629,     0.011111,     1,
		   -0.019616,     0.003902,     1,
		   -0.019616,    -0.003902,     1,
		   -0.016629,    -0.011111,     1,
		   -0.011111,    -0.016629,     1,
		   -0.003902,    -0.019616,     1,
			0.003902,    -0.019616,    -1,

			0.003902,    -0.016,    -0.15,
			0.011111,    -0.016,    -0.15,
			0.02,    -0.016,    -0.15,
			0.02,    -0.016,    -0.15,
			0.02,     -0.008,    -0.15,
			0.02,     -0.008,    -0.15,
			0.011111,     -0.008,    -0.15,
			0.003902,     -0.008,    -0.15,
		   -0.003902,     -0.008,    -0.15,
		   -0.011111,     -0.008,    -0.15,
		   -0.016629,     -0.008,    -0.15,
		   -0.019616,     -0.008,    -0.15,
		   -0.019616,    -0.016,   -0.15,
		   -0.016629,    -0.016,   -0.15,
		   -0.011111,    -0.016,   -0.15,
		   -0.003902,    -0.016,   -0.15,
			0.003902,    -0.016,   -0.15
DEL 2


MATERIAL squirt_mat

ADD a-0.04+0.008, 0, zzyzx-0.45+0.15
CYLIND 0.03, 0.022
DEL 1

ADD a-0.04+0.008, 0, zzyzx-0.45+0.18
CYLIND 0.03, 0.0275
DEL 1

ADD a-0.04+0.008, 0, zzyzx-0.24
CYLIND 0.07, 0.02
DEL 1

ADD a-0.04+0.008, 0, zzyzx-0.13
CONE 0.03, 0.02, 0.03, 90, 90
DEL 1

ENDIF

DEL 1

END
