
! ==============================================================================
! flushometer_m
! ==============================================================================


reqBTaps = 0
success = LIBRARYGLOBAL ("LibraryGlobals13", "hideBTaps", reqBTaps)
if success > 0 and reqBTaps then
	end
endif

unID=GS_HotspotUnIDBegin

if gs_detlevel_3D_m=0 then end

if not(gs_shadow) then SHADOW OFF

PEN gs_cont_pen
material matFlushometer

if GLOB_CONTEXT > 20 and GLOB_CONTEXT < 40 | gs_detlevel_3D_m = 1 then
	gs_resol = 8
else
	if gs_detlevel_3D_m = 3 & iFlushometerType = 3 then
		gs_resol = 4
	else
		gs_resol = gs_resol
	endif
endif

hotspot 0, -yTapPos, 0, unID : unID=unID+1
hotspot xTapPos, 0, zTapPos, unID : unID=unID+1

resol gs_resol


if iFlushometerType < 3 then		! Automatic, Manual

group "part1"

	add xTapPos, 0, zTapPos
	rotz -90

	mul 1, 2, 2
	revolve 3, 360, 1+2+4+8+16+32,
		0, 0.02, 0,
		1"-0.012, 0.02, 1,
		1", 0.008, 1000
	del 1

	revolve 3, 360, 1+2+4+8+16+32,
		1", 0.016, 0,
		yTapPos-0.0385, 0.016, 0,
		yTapPos-0.0385, 0.016, 0

	resol 6
	revolve 2, 360, 1+2+4+8+16+32+64,
		yTapPos-0.0385, 0.0216, 0,
		yTapPos-0.02351, 0.0216, 0
	resol gs_resol

	revolve 5, 360, 1+2+4+8+16+32,
		yTapPos-0.02351, 0.0204, 0,
		yTapPos-0.0235, 0.0204, 1,
		1, tan(30), 801,
		yTapPos+0.0235, 0.0204, 1000,
		yTapPos+0.0369, 0.0204, 0

	mul 1, 2, 2
	revolve 3, 360, 1+2+4+8+16+32,
		yTapPos+0.0369, 0.0102, 1,
		1, -tan(20), 801,
		yTapPos+0.0431, 0, 1001
	del 1

	del 2

	if iFlushometerType = 1 then		! Automatic

		addy -yTapPos
		rotz 90
		rotx 90
		cutpolya 6, 1, 0,
			-0.1, zTapPos+0.2, 7+64,
			-0.1, zTapPos+0.046, 7,
			-0.068, zTapPos+0.046, 7+64,
			0.08, 79.29, 2007,
			0.1, 14, 207,
			-0.1, zTapPos+0.2, -1
		del 3

		addy -yTapPos
		roty -90

		revolve 4, 360, 1+2+4+8+16+32,
			0, 0.0456, 0,
			0.014, 0.0446, 1,
			0.0275, 0.0411, 1,
			0.0318, 0.0351, 1001

		resol 6
		revolve 2, 360, 1+2+4+8+16+32+64,
			0.0318, 0.027, 0,
			0.0421, 0.027, 0
		resol gs_resol

		revolve 2, 360, 1+2+4+8+16+32,
			0.0421, 0.021, 0,
			0.2107+zTapPos-11 1/2", 0.021, 0

		resol 6
		revolve 2, 360, 1+2+4+8+16+32+64,
			0.2107+zTapPos-11 1/2", 0.0302, 0,
			0.2282+zTapPos-11 1/2", 0.0302, 0
		resol gs_resol

		revolve 19, 360, 1+2+4+8+16+32,
			0.2282+zTapPos-11 1/2", 0.0302, 0,
			0.2401+zTapPos-11 1/2", 0.0302, 0,
			0.2435+zTapPos-11 1/2", 0.026, 0,
			0.2435+zTapPos-11 1/2", 0.0238, 0,
			0.2595+zTapPos-11 1/2", 0.0238, 0,

			0.2621+zTapPos-11 1/2", 0.0254, 0,
			0.2621+zTapPos-11 1/2", 0.0279, 0,
			0.2679+zTapPos-11 1/2", 0.0299, 0,
			0.2679+zTapPos-11 1/2", 0.03, 1,
			0.2738+zTapPos-11 1/2", 0.038, 1001,

			0.2943+zTapPos-11 1/2", 0.0412, 1001,
			0.3101+zTapPos-11 1/2", 0.0412, 1,
			0.3164+zTapPos-11 1/2", 0.0476, 1001,
			0.3164+zTapPos-11 1/2", 0.0516, 0,
			0.3379+zTapPos-11 1/2", 0.0516, 0,

			0.3379+zTapPos-11 1/2", 0.0505, 0,
			0.370+zTapPos-11 1/2", 0.0495, 1,
			0.4168+zTapPos-11 1/2", 0.0425, 1,
			0.43+zTapPos-11 1/2", 0.022, 1001

		del 2

		cutend

		material matSensor
		addy -yTapPos
		rotz 90
		rotx 90
		cutpolya 7, 1, 0,
			-0.1, zTapPos, 7+64,
			-0.1, zTapPos+0.046, 7,
			-0.068, zTapPos+0.046, 7+64,
			0.08, 79.29, 2007,
			0.1, 14, 207,
			0.1, zTapPos, 7,
			-0.1, zTapPos, -1
		del 3

		addy -yTapPos
		roty -90

		addx zTapPos+0.1247
		roty 90
		cutplane 14
		del 2

		revolve 4, 360, 1+2+4+8+16+32,
			0.3379+zTapPos-11 1/2", 0.0505, 0,
			0.370+zTapPos-11 1/2", 0.0495, 1,
			0.4168+zTapPos-11 1/2", 0.0425, 1,
			0.43+zTapPos-11 1/2", 0.022, 1001

		cutend

		del 2

		cutend
		material matFlushometer

	endif

	if iFlushometerType = 2 then		! Manual

		addy -yTapPos
		roty -90

		revolve 4, 360, 1+2+4+8+16+32,
			0, 0.029, 0,
			0.0085, 0.0287, 1,
			0.0169, 0.0275, 1,
			0.021, 0.023, 1001

		resol 6
		revolve 2, 360, 1+2+4+8+16+32+64,
			0.021, 0.023, 0,
			0.028, 0.023, 0
		resol gs_resol

		revolve 2, 360, 1+2+4+8+16+32,
			0.028, 0.0183, 0,
			0.1935+zTapPos-11 1/2", 0.0183, 0

		resol 6
		revolve 2, 360, 1+2+4+8+16+32+64,
			0.1935+zTapPos-11 1/2", 0.0302, 0,
			0.2109+zTapPos-11 1/2", 0.0302, 0
		resol gs_resol

		revolve 19, 360, 1+2+4+8+16+32,
			0.2109+zTapPos-11 1/2", 0.0302, 0,
			0.2205+zTapPos-11 1/2", 0.0302, 0,
			0.2228+zTapPos-11 1/2", 0.023, 0,
			0.2644+zTapPos-11 1/2", 0.023, 0,
			0.268+zTapPos-11 1/2", 0.0255, 0,
			0.268+zTapPos-11 1/2", 0.028, 0,
			0.2748+zTapPos-11 1/2", 0.0305, 0,
			0.2748+zTapPos-11 1/2", 0.031, 1,
			0.2835+zTapPos-11 1/2", 0.0415, 1001,
			0.3095+zTapPos-11 1/2", 0.0415, 1,
			0.3158+zTapPos-11 1/2", 0.0435, 1000,
			0.3158+zTapPos-11 1/2", 0.045, 1,
			0.3225+zTapPos-11 1/2", 0.0504, 1001,
			0.3405+zTapPos-11 1/2", 0.0468, 1,
			0.345+zTapPos-11 1/2", 0.0419, 1001,
			0.3458+zTapPos-11 1/2", 0.029, 0,
			0.3528+zTapPos-11 1/2", 0.029, 0,
			0.3528+zTapPos-11 1/2", 0.019, 0,
			0.3558+zTapPos-11 1/2", 0.0172, 0

		del 2

	endif

endgroup

group "part2"

	add 0, -yTapPos, zTapPos
	revolve 4, 360, 1+2+4+8+16+32,
		0, 0.0216, 0,
		xTapPos-0.0635, 0.0216, 0,
		xTapPos-0.0635, 0.0192, 0,
		xTapPos-0.0476, 0.0192, 0

	resol 6
	revolve 2, 360, 1+2+4+8+16+32+64,
		xTapPos-0.0476, 0.0266, 0,
		xTapPos-0.0341, 0.0266, 0
	resol gs_resol

	revolve 4, 360, 1+2+4+8+16+32,
		xTapPos-0.0341, 0.0191, 0,
		xTapPos-0.0302, 0.0191, 0,
		xTapPos-0.0302, 0.0203, 0,
		xTapPos, 0.0203, 0
	del 1

	if iFlushometerType = 1 then		! Automatic

		addy -yTapPos
		rotz 180
		cutplane 90
		del 2
		addx 0.023
		rotz 90
		cutplane 90
		del 2
		addx -0.023
		rotz -90
		cutplane 90
		del 2

		add 0, -yTapPos, zTapPos+0.0458
		cylind 0.073, 0.045
		del 1

		cutend
		cutend
		cutend

	endif

	if iFlushometerType = 2 then		! Manual

		add 0, -yTapPos, zTapPos-0.0485
		revolve 16, 360, 1+2+4+8+16+32,
			-0.1767, 0.0064, 1,
			-0.1741, 0.009, 0,
			-0.0942, 0.009, 0,
			-0.0916, 0.0064, 0,
			-0.0857, 0.0064, 0,
			-0.0787, 0.0105, 0,
			-0.0787, 0.0155, 1,
			-0.0747, 0.0195, 1001,
			-0.0497, 0.0195, 0,
			-0.0497, 0.025, 0,
			-0.0386, 0.025, 0,
			-0.0386, 0.0081, 0,
			-0.0326, 0.0105, 1,
			-0.0228, 0.0179, 1,
			-0.017,  0.0194, 1,
			0,		 0.0194, 0
		del 1

	endif

endgroup

placegroup addgroup("part1","part2")

killgroup "part1"
killgroup "part2"

endif


if iFlushometerType = 3 then		! Simple

	add 0, -yTapPos, zTapPos
	roty 90
	rotx 90
	armc rPipe, rPipe, zTapPos - 0.005 * (gs_detlevel_3D_m < 3), 0, 0, 90
	del 3

	if gs_detlevel_3D_m = 2 | gs_detlevel_3D_m = 1 then
		add 0, -yTapPos, 0
		cylind 0.005, 1.5 *rPipe
		del 1

		add 0, 0, zTapPos
		rotx 90
		cylind 0.005, 1.5 * rPipe
		del 2

		add 0, -0.005, zTapPos
		rotx 90
		cylind yTapPos + 0.02 - 0.005, rPipe
		del 2

		group "pipePart1"
			add 0, -yTapPos - 0.02, zTapPos
			rotx 90
			ellips 2 * rPipe, rPipe
			del 2
		endgroup

		group "pipePart2"
			add 0, -yTapPos - 0.02 - 2 * rPipe, zTapPos - 0.0025
			block 2 * rPipe, 2 * rPipe, 0.005
			del 1
		endgroup

		placegroup addgroup("pipePart1","pipePart2")
		killgroup "pipePart1"
		killgroup "pipePart2"
	else
		add 0, 0, zTapPos
		rotx 90
		cylind yTapPos + 0.03, rPipe
		del 2
	endif

endif
