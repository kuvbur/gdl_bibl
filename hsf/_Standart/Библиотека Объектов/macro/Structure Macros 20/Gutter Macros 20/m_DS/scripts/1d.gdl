
!------------  Hanger Positioning Type -----------------------------------------
HANGER_CUSTOM			= 1
HANGER_UNIFORM			= 2


EPS = 0.0001		! precision of zero
sth = 0.002					! hanger thickness
sthw = 0.03					! hanger width
dswh = 0.04					! downspout-hanger width

! -----------------------------------------------------------------------------
! USA profiles
! -----------------------------------------------------------------------------
if gs_gutter_ds_profile=`Круглый 3"` OR gs_gutter_ds_profile=`Круглый 4"` OR gs_gutter_ds_profile=`Специальный - Круглый` then
	parameters gs_gutter_ds_profile_num=1
endif

if gs_gutter_ds_profile=`Прямоугольный 2"*3"` OR gs_gutter_ds_profile=`Прямоугольный 3"*2"` OR gs_gutter_ds_profile=`Прямоугольный 3"*4"` OR gs_gutter_ds_profile=`Прямоугольный 4"*3"` OR gs_gutter_ds_profile=`Специальный - Прямоугольный` then
	parameters gs_gutter_ds_profile_num=2
endif

if gs_gutter_ds_profile=`Закругленный 2"*3"` OR gs_gutter_ds_profile=`Закругленный 3"*2"` OR gs_gutter_ds_profile=`Закругленный 3"*4"` OR gs_gutter_ds_profile=`Закругленный 4"*3"` OR gs_gutter_ds_profile=`Специальный - Закругленный` then
	parameters gs_gutter_ds_profile_num=3
endif


if gs_gutter_ds_profile=`Круглый 3"` then
	parameters gs_gutter_dd=3*0.5*0.0254
				gs_gutter_dd=3*0.5*0.0254
	parameters gs_gutter_dd2=gs_gutter_dd*2
				gs_gutter_dd2=gs_gutter_dd*2
	lock "gs_gutter_dd2"
endif
if gs_gutter_ds_profile=`Круглый 4"` then
	parameters gs_gutter_dd=4*0.5*0.0254
				gs_gutter_dd=4*0.5*0.0254
	parameters gs_gutter_dd2=gs_gutter_dd*2
				gs_gutter_dd2=gs_gutter_dd*2
	lock "gs_gutter_dd2"
endif

if gs_gutter_ds_profile=`Прямоугольный 2"*3"` OR gs_gutter_ds_profile=`Закругленный 2"*3"` then
	parameters gs_gutter_aa=0.0254
				gs_gutter_aa=0.0254
	parameters gs_gutter_aa2=gs_gutter_aa*2
				gs_gutter_aa2=gs_gutter_aa*2
	parameters gs_gutter_bb=0.0381
				gs_gutter_bb=0.0381
	parameters gs_gutter_bb2=gs_gutter_bb*2
				gs_gutter_bb2=gs_gutter_bb*2
	lock "gs_gutter_aa2"
	lock "gs_gutter_bb2"
endif

if gs_gutter_ds_profile=`Прямоугольный 3"*2"` OR gs_gutter_ds_profile=`Закругленный 3"*2"` then
	parameters gs_gutter_aa=0.0381
				gs_gutter_aa=0.0381
	parameters gs_gutter_aa2=gs_gutter_aa*2
				gs_gutter_aa2=gs_gutter_aa*2
	parameters gs_gutter_bb=0.0254
				gs_gutter_bb=0.0254
	parameters gs_gutter_bb2=gs_gutter_bb*2
				gs_gutter_bb2=gs_gutter_bb*2
	lock "gs_gutter_aa2"
	lock "gs_gutter_bb2"
endif

if gs_gutter_ds_profile=`Прямоугольный 3"*4"` OR gs_gutter_ds_profile=`Закругленный 3"*4"` then
	parameters gs_gutter_aa=0.0381
				gs_gutter_aa=0.0381
	parameters gs_gutter_aa2=gs_gutter_aa*2
				gs_gutter_aa2=gs_gutter_aa*2
	parameters gs_gutter_bb=0.0508
				gs_gutter_bb=0.0508
	parameters gs_gutter_bb2=gs_gutter_bb*2
				gs_gutter_bb2=gs_gutter_bb*2
	lock "gs_gutter_aa2"
	lock "gs_gutter_bb2"
endif

if gs_gutter_ds_profile=`Прямоугольный 4"*3"` OR gs_gutter_ds_profile=`Закругленный 4"*3"` then
	parameters gs_gutter_aa=0.0508
				gs_gutter_aa=0.0508
	parameters gs_gutter_aa2=gs_gutter_aa*2
				gs_gutter_aa2=gs_gutter_aa*2
	parameters gs_gutter_bb=0.0381
				gs_gutter_bb=0.0381
	parameters gs_gutter_bb2=gs_gutter_bb*2
				gs_gutter_bb2=gs_gutter_bb*2
	lock "gs_gutter_aa2"
	lock "gs_gutter_bb2"
endif

!! -----------------------------------------------------------------------------
!! Downspout Hanger parameters
!! -----------------------------------------------------------------------------
!! Change downspout length or change ds hanger offset
!IF gs_gutter_ds_h_positioning = HANGER_UNIFORM THEN
!	if GLOB_MODPAR_NAME = "gs_gutter_ds_lgth" OR GLOB_MODPAR_NAME = "gs_gutter_ds_h_off" OR GLOB_MODPAR_NAME = "gs_gutter_ds_h_positioning" then
!		for i=1 to INT((gs_gutter_ds_lgth - gs_gutter_ds_h_off - sthw)/gs_gutter_ds_h_dist)+1
!			if gs_gutter_ds_h_pos_mod[i] = 0 then
!				PARAMETERS gs_gutter_ds_h_pos[i]=(i-1)*gs_gutter_ds_h_dist+gs_gutter_ds_h_off
!			endif
!		next i
!	endif
!	
!	! Change distance between ds hangers
!	if GLOB_MODPAR_NAME = "gs_gutter_ds_h_dist" then
!		for i=1 to INT((gs_gutter_ds_lgth - gs_gutter_ds_h_off - sthw)/gs_gutter_ds_h_dist)+1
!			if gs_gutter_ds_h_pos_mod[i] = 0 then
!				PARAMETERS gs_gutter_ds_h_pos[i]=(i-1)*gs_gutter_ds_h_dist+gs_gutter_ds_h_off
!			endif
!		next i
!	endif
!	
!	! Set the items of the position_modified_ARRAY 0 if the hanger isn't dragged, or is on the right place; OR it is dragged from its position
!!	for i=1 to INT((gs_gutter_ds_lgth - gs_gutter_ds_h_off - sthw)/gs_gutter_ds_h_dist)+1
!!		if ABS(gs_gutter_ds_h_pos[i] - ((i-1) * gs_gutter_ds_h_dist + gs_gutter_ds_h_off) ) < EPS then
!!			PARAMETERS gs_gutter_ds_h_pos_mod[i] = 0
!!		else
!!			PARAMETERS gs_gutter_ds_h_pos_mod[i] = 1
!!		endif
!!	next i
!
!ELSE
!
!	hangeri = 1
!	j = 0
!	WHILE j <= gs_gutter_ds_lgth AND hangeri < 99 AND gs_gutter_ds_h_pos_helper[hangeri] > EPS DO
!		j = gs_gutter_ds_h_pos_helper[hangeri]
!		hangeri = hangeri + 1
!	ENDWHILE
!
!	hangeri = hangeri-1
!
!	if GLOB_MODPAR_NAME = "gs_gutter_ds_h_pos_helper" THEN
!		lenght = 0
!		FOR i=1 to hangeri
!			lenght = lenght + gs_gutter_ds_h_pos_helper[i]
!			PARAMETERS gs_gutter_ds_h_pos[i] = lenght
!		NEXT i
!		FOR i=hangeri+1 to vardim1(gs_gutter_ds_h_pos)
!			PARAMETERS gs_gutter_ds_h_pos[i] = 0
!		NEXT i
!	ENDIF
!
!	if GLOB_MODPAR_NAME = "gs_gutter_ds_h_pos" THEN
!			PARAMETERS gs_gutter_ds_h_pos_helper[1] = gs_gutter_ds_h_pos[1]
!		FOR i = 2 to hangeri
!			PARAMETERS gs_gutter_ds_h_pos_helper[i] = (gs_gutter_ds_h_pos[i] - gs_gutter_ds_h_pos[i-1])
!		NEXT i
!	ENDIF
!	
!	j = 0
!	FOR i = 1 to vardim1(gs_gutter_ds_h_pos)
!		j = gs_gutter_ds_h_pos[i]
!		IF j >= gs_gutter_ds_lgth OR gs_gutter_ds_h_pos[i] < 0 THEN 
!			PARAMETERS gs_gutter_ds_h_pos[i] = 0
!		ENDIF
!	NEXT i
!ENDIF

hangeri = INT((gs_gutter_ds_lgth - gs_gutter_ds_h_off - sthw)/gs_gutter_ds_h_dist)+1
for i=1 to INT((gs_gutter_ds_lgth - gs_gutter_ds_h_off - sthw)/gs_gutter_ds_h_dist)+1
	PARAMETERS gs_gutter_ds_h_pos[i]=(i-1)*gs_gutter_ds_h_dist+gs_gutter_ds_h_off
next i
