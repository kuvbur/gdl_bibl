
! GUTTER HANGER macro


IF gs_detlevel_3D_m=0 OR gs_detlevel_3D_m=1 THEN END

RESOL gs_resol
PEN gs_cont_pen
MATERIAL gs_gutter_hanger_mat

IF gs_shadow=0 THEN SHADOW OFF
IF gs_shadow=1 THEN SHADOW ON

IF NOT(gs_gutter_h_profile_num = 3) THEN
	CALL "m_GutterHangerProfiles" PARAMETERS gs_gutter_p_num=gs_gutter_p_num,	!!Part around the gutter!!
											gs_gutter_p_w=gs_gutter_p_w,
											gs_gutter_p_h=gs_gutter_p_h,
											gs_gutter_p_r=gs_gutter_p_r

		ROTz 90
		ROTX 90
			EXTRUDE   nsp/3, 0, 0, sthw, 16+32, get(nsp)
		DEL 2


ENDIF

IF gs_gutter_h_profile_num = 2 OR gs_gutter_h_profile_num = 5 OR gs_gutter_h_profile_num = 6 THEN

		!!!>>> Top Part of Hanger
		POLY_ 5,
			0,-gs_gutter_p_w/2-sth,1,
			0,gs_gutter_p_w/2+sth,1,
			sthw,gs_gutter_p_w/2+sth,1,
			sthw,-gs_gutter_p_w/2-sth,1,
			0,-gs_gutter_p_w/2-sth,-1

ENDIF

IF gs_gutter_p_num=1 THEN
	IF gs_gutter_h_profile_num = 1 OR gs_gutter_h_profile_num = 2 THEN	!!!>>>Strap 1/Strap 2
		ADDy gs_gutter_p_w/2+sth
		ROTx -90
			POLY_ 5,
				0,0,1,
				0,gs_gutter_p_w/3,1,
				sthw,gs_gutter_p_w/3,1,
				sthw,0,1,
				0,0,-1
		DEL 2
	ENDIF
ENDIF

spike=0.004
IF gs_gutter_h_profile_num = 3 THEN
	Addz -sth
	TUBE 4,4,1+2+4+8+16+32,													!!Spike!!
		sthw/2 - spike/2,		 -sthw/4 + 0,			0,
		sthw/2 - spike/2,		 -sthw/4 - spike,		0,
		sthw/2 + spike/2,		 -sthw/4 - spike,		0,
		sthw/2 + spike/2,		 -sthw/4 + 0,			0,
		0,	 gs_gutter_p_w/2 + sth + 1-0.0002,				0,		0,
		0,	 gs_gutter_p_w/2 + sth + spike-0.0002,			0,		0,
		0,	-gs_gutter_p_w/2 - sth - spike-0.0002,			0,		0,
		0,	-gs_gutter_p_w/2 - sth - 1-0.0002,				0,		0
	DEL 1
ENDIF

!!IF gs_gutter_h_profile_num = 4 THEN : ENDIF		!!made in Gutter.gsm, because of sloping!!
!!IF gs_gutter_h_profile_num = 5 THEN : ENDIF		!!made in Gutter.gsm, because of sloping!!
