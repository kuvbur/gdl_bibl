
EPS = 0.00001

! ==============================================================================
! Object Types
! ==============================================================================

ROOF_BASE_STRUT				= 1
ROOF_BENT_RAFTER			= 2
ROOF_COLLAR_BEAM			= 3
ROOF_EAVES_PURLIN			= 4
ROOF_JACK_RAFTER			= 5
ROOF_JACK_RAFTER_SPEC		= 6
ROOF_POST					= 7
ROOF_PURLIN					= 8
ROOF_RAFTER					= 9
ROOF_RAFTER_SPEC			= 10
ROOF_RIDGE					= 11
ROOF_RIDGE_SPEC				= 12
ROOF_TIE_BEAM				= 13
ROOF_TOP_STRUT				= 14
ROOF_TRIMMER				= 15
ROOF_VALLEY_JACK_RAFTER		= 16
ROOF_VALLEY_RAFTER			= 17

! ==============================================================================
! Definitions
! ==============================================================================
!gs_iDisplayStandards
	LANGUAGE_INT		= 1
	LANGUAGE_GER		= 2
	LANGUAGE_CHE		= 3
	LANGUAGE_AUT		= 4
	LANGUAGE_USA		= 5

!AC_symb_display_option
	DISPLAY_PROJECTED			= 1
	DISPLAY_OVERHEAD_PROJ		= 2
	DISPLAY_SYMBOLIC			= 3
	DISPLAY_OUTLINES			= 4
	DISPLAY_OVERHEAD_ALL		= 5

!AC_symb_show_projection_to
	PROJECTION_FLOOR_PLAN_RANGE	= 1
	PROJECTION_DISPLAY_LIMIT	= 2
	PROJECTION_ENTIRE_ELEMENT	= 3

!rm_iSymbolType
	SYMBOLTYPE_AXES		= 1
	SYMBOLTYPE_CIRCLE	= 2

!iDisplaySize
	DISPLAY_CUT_SIZE		= 1
	DISPLAY_ROUNDED_SIZE	= 2


! ==============================================================================
! Localization
! ==============================================================================
dim stDisplayOptions[5]
	stDisplayOptions[1]		= `Сечение и Низ`
	stDisplayOptions[2]		= `Сечение и Верх`
	stDisplayOptions[3]		= `Символический Вид`
	stDisplayOptions[4]		= `Только Контуры`
	stDisplayOptions[5]		= `Вся Проекция`

dim stProjectionTypes[3]
	stProjectionTypes[1]	= `Согласно Диапазону Плана Этажа`
	stProjectionTypes[2]	= `Согласно Абсолютному Диапазону`
	stProjectionTypes[3]	= `Весь Элемент`

dim stTextOrientation[3]
	stTextOrientation[1]	= `Читаемый`
	stTextOrientation[2]	= `Всегда Горизонтально`
	stTextOrientation[3]	= `Выровнять по Символу`

dim stSymbolType[2]
	stSymbolType[1]		= `Оси`
	stSymbolType[2]		= `В круге`

dim stDisplaySize[2]
	stDisplaySize[1]	= `Размер Обрезки Пиломатериала`
	stDisplaySize[2]	= `Округленный Размер Пиломатериала`


! ==============================================================================
! Dimension Formats
! ==============================================================================
bIsMetricVolume = 0
bIsMetricLength = 0
volumeForm		= ""                             !*** format as set in the Preferences
lengthForm		= ""
qq=request ("Calc_volume_unit","",volumeForm)
if qq then
	if strstr (volumeForm, "m") > 0 | (strstr (volumeForm, "l") > 0 & strstr (volumeForm, "g") < 1)  then bIsMetricVolume = 1
else
	if gs_iDisplayStandards <> LANGUAGE_USA then bIsMetricVolume = 1
endif
qq=request ("Working_length_unit","",lengthForm)
if qq then
	if strstr (lengthForm, "m") > 0 then bIsMetricLength = 1
else
	if gs_iDisplayStandards <> LANGUAGE_USA then bIsMetricLength = 1
endif


! ==============================================================================
! Rounding Values
! ==============================================================================
dim stRoundValuesMetric[9]
dim roundValuesMetric[9]
	roundValuesMetric[1]	= 0.0			:	stRoundValuesMetric[1]	= `Нет`
	roundValuesMetric[2]	= 0.01			:	stRoundValuesMetric[2]	= str{2}(lengthForm, roundValuesMetric[2])
	roundValuesMetric[3]	= 0.025			:	stRoundValuesMetric[3]	= str{2}(lengthForm, roundValuesMetric[3])
	roundValuesMetric[4]	= 0.05			:	stRoundValuesMetric[4]	= str{2}(lengthForm, roundValuesMetric[4])
	roundValuesMetric[5]	= 0.1			:	stRoundValuesMetric[5]	= str{2}(lengthForm, roundValuesMetric[5])
	roundValuesMetric[6]	= 0.25			:	stRoundValuesMetric[6]	= str{2}(lengthForm, roundValuesMetric[6])
	roundValuesMetric[7]	= 0.5			:	stRoundValuesMetric[7]	= str{2}(lengthForm, roundValuesMetric[7])
	roundValuesMetric[8]	= 1.0			:	stRoundValuesMetric[8]	= str{2}(lengthForm, roundValuesMetric[8])
	roundValuesMetric[9]	= roundValue	:	stRoundValuesMetric[9]	= `Специальный`

dim stRoundValuesUSA[12]
dim roundValuesUSA[12]
	roundValuesUSA[1]		= 0.0			:	stRoundValuesUSA[1]		= `Нет`
	roundValuesUSA[2]		= 1/8"			:	stRoundValuesUSA[2]		= '1/8"'
	roundValuesUSA[3]		= 1/4"			:	stRoundValuesUSA[3]		= '1/4"'
	roundValuesUSA[4]		= 1/2"			:	stRoundValuesUSA[4]		= '1/2"'
	roundValuesUSA[5]		= 1"			:	stRoundValuesUSA[5]		= '1"'
	roundValuesUSA[6]		= 2"			:	stRoundValuesUSA[6]		= '2"'
	roundValuesUSA[7]		= 4"			:	stRoundValuesUSA[7]		= '4"'
	roundValuesUSA[8]		= 6"			:	stRoundValuesUSA[8]		= '6"'
	roundValuesUSA[9]		= 1'			:	stRoundValuesUSA[9]		= "1'"
	roundValuesUSA[10]		= 1.5'			:	stRoundValuesUSA[10]	= "1,5'"
	roundValuesUSA[11]		= 2'			:	stRoundValuesUSA[11]	= "2'"
	roundValuesUSA[12]		= roundValue	:	stRoundValuesUSA[12]	= `Специальный`


! ==============================================================================
! BDFT calculation
! ==============================================================================
lumberPackString_1	= 0
lumberPackString_2	= 0
lumberPackBDFT_1	= 0
lumberPackBDFT_2	= 0

if gs_iDisplayStandards = LANGUAGE_USA then
	!----- Parameters bdft_ProfileWidth x bdft_ProfileHeight x bdft_Length-------------

	squot	= "'"
	dquote	= '"'
	tol		= 0.0625          ! cut length tolerance is 1/16 in. 05/21 fl
	mti		= 1000/25.4       ! meter to inches
	mtf		= mti/12          ! meter to feet
	!
	wi	= bdft_ProfileWidth*mti
	hi	= bdft_ProfileHeight*mti
	if (wi-int(wi))>tol then wi=int(wi)+1   ! width is rounded up to nearest inch
	if (hi-int(hi))>tol then hi=int(hi)+1   ! height is rounded up to nearest inch
	!++++
	linft	= bdft_Length*mtf
	linin	= linft-int(linft)
	linin	= linin*12
	lfrac	= linin-int(linin)

	!print linft,linin,lfrac
	!
	! cut length is rounded up to the nearest quarter in.
	!
	if lfrac>(0.75+tol) then
		if linin > 10.5 then    !05/21 FL
			linin=0
			linft=linft+1
		else
			linin=int(linin)+1
		endif
		lqtr=""
	else
		if lfrac>(0.5+tol) then
			linin=int(linin)
			lqtr=" 3/4"
		else
			if lfrac>(0.25+tol) then
				linin=int(linin)
				lqtr=" 1/2"
			else
				if lfrac>(tol) then
					linin=int(linin)
					lqtr=" 1/4"
				else
					linin=int(linin)
					lqtr=""
				endif
			endif
		endif
	endif

	!++++
	wstr				= str(wi,2,0)
	hstr				= str(hi,2,0)
	lstrf				= str(linft,2,0)
	lstri				= str(linin,2,0)
	lumberPackString_1	= wstr+" x"+hstr+" x "+lstrf+squot+"-"+lstri+lqtr+dquote
	lumberPackBDFT_1	= hi*wi*linft/12*bdft_Quantity

	!---------------------------
	linft	= bdft_Length*mtf
	linin	= linft-int(linft)
	linft	= int(linft)
	if linin>0.001 then linft=linft+1
	if (linft-2*int(linft/2))>0.5 then linft=linft+1

	!++++
	lstrf				= str(linft,2,0)
	lumberPackString_2	= wstr+" x"+hstr+" x "+lstrf+squot
	lumberPackBDFT_2	= hi*wi*linft/12*bdft_Quantity
endif
