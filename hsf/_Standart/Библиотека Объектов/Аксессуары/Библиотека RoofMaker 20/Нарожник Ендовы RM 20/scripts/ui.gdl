
! =============================================================================
! Localization
! =============================================================================
dim stGeometry[5]
	stGeometry[1]	= `Угол Наклона Крыши`
	stGeometry[2]	= `Исходная Длина`
	stGeometry[3]	= `Длина Элемента`
	stGeometry[4]	= `Ширина Профиля`
	stGeometry[5]	= `Высота Профиля`

dim stCutting[5]
	stCutting[1]	= `Углы Соединений`
	stCutting[2]	= `Угол к Стропилу`
	stCutting[3]	= `Смещение Среза`
	stCutting[4]	= `Толщина Стропила Ендовы`
	stCutting[5]	= `Толщина Прогона или Распорки`

! =============================================================================
! Variables
! =============================================================================

pageStartY		= 5
xInfieldSmall	= 70
xInfieldBig		= 90
yInfield		= 19
yOutfield		= 14

! =============================================================================
! Tabpages
! =============================================================================

TABID_ROOT					= -1
TABID_GEOMETRY				= 1
TABID_CUTTING				= 2

call "RoofMaker_macro"	parameters all	iObjectType				= 16,
										bEnableRafter			= bEnableRafter,
										bEnableSymbol			= bEnableSymbol,
										bEnableResolution		= bEnableResolution,
										gs_iDisplayStandards	= gs_iDisplayStandards,
										iUiType					= 1

ui_page TABID_GEOMETRY, TABID_ROOT, `Геометрия`, "uiTab_Dimension_flat(1)"
if gs_ui_current_page = TABID_GEOMETRY then
	gosub "geometryPage"
endif

ui_page TABID_CUTTING, TABID_ROOT, `Подрезка`, "uiTab_RMCut_flat(1)"
if gs_ui_current_page = TABID_CUTTING then
	gosub "cuttingPage"
endif

! ======================================================================
end
! ======================================================================

"geometryPage":
! =============================================================================
! Geometry
! =============================================================================

	picX			= 303
	picY			= pageStartY + 15

	ui_pict 3,	picX-248, picY+62, 200,  118, 1										!jackvalleyrafter_pict3.png
	ui_pict 4,	picX-138, picY, 125, 62, 1											!jackvalleyrafter_pict4.png

	ui_outfield stGeometry[1], picX-14, picY+131, 444-picX+14, yOutfield
	ui_infield "rm_PitchAngle", picX, picY+148, xInfieldBig, yInfield				ui_tooltip stGeometry[1]

	ui_infield "rm_ProjectedLength", picX-175, picY+185, xInfieldBig, yInfield		ui_tooltip stGeometry[2]
	ui_infield "rm_StructuralLength", picX-256, picY+41, xInfieldBig, yInfield		ui_tooltip stGeometry[3]
	ui_infield "rm_ProfileWidth", picX, picY+27, xInfieldBig, yInfield				ui_tooltip stGeometry[4]
	ui_infield "rm_ProfileHeight", picX, picY+2, xInfieldBig, yInfield				ui_tooltip stGeometry[5]

return

"cuttingPage":
! =============================================================================
! Cutting
! =============================================================================

	pageStartY		= 5
	angleForm		= ""
	qq=request ("Working_angle_unit","",angleForm)


	! -------- Joining Angles ----------------------------------------------------------------------------------

	picX1	= 14
	picY1	= pageStartY + 15

	ui_style 0, 1
	ui_outfield stCutting[1], 9, pageStartY, 338-172, yOutfield
	ui_style 0, 0

	ui_pict 1,	picX1, picY1, 95,  212, 1													!jackvalleyrafter_pict1.png

	ui_infield "rm_VerticalTrimmerAngle", picX1+101, picY1+18, xInfieldBig, yInfield		ui_tooltip stCutting[2]
	ui_outfield str{2}(angleForm, 90), picX1+108, picY1+41, xInfieldBig, yOutfield
	ui_outfield str{2}(angleForm, 90), picX1+108, picY1+164, xInfieldBig, yOutfield
	ui_outfield str{2}(angleForm, rm_VerticalTrimmerAngle), picX1+108, picY1+181, xInfieldBig, yOutfield


	ui_separator 213, pageStartY, 213, pageStartY + 230


	! -------- Cut Offset ----------------------------------------------------------------------------------

	ui_style 0, 1
	ui_outfield stCutting[3], 222, pageStartY, 444-348, yOutfield
	ui_style 0, 0

	ui_pict 2,	248, 52, 93, 205, 1													!jackvalleyrafter_pict2.png

	ui_infield "rm_PurlinWidth", 349, pageStartY + 81, xInfieldBig, yInfield					ui_tooltip stCutting[5]
	ui_infield "rm_RafterWidth", 349, pageStartY + 199, xInfieldBig, yInfield					ui_tooltip stCutting[4]

return
