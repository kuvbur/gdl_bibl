
pen pen3D
material rm_mat


! ==============================================================================
! 2D Display Options
! ==============================================================================

!gs_2D_projection_type:
!	0 - Normal 3D
!	1 - View Edges
!	2 - View Polygons
!	3 - Overhead Edges
!	4 - Cut Lines
!	5 - Cut Polygons
!	6 - Bottom Range Cut Lines
!	7 - Top Range Cut Lines

nProjectionCut = 0
if gs_2D_projection then
	if AC_symb_show_projection_to = PROJECTION_FLOOR_PLAN_RANGE | (AC_symb_show_projection_to = PROJECTION_DISPLAY_LIMIT & gs_bottom_range_height < gs_cutplane_height) then
		addz gs_bottom_range_height
		cutplane{2} 180, 2
		nProjectionCut = nProjectionCut + 1
		del 1
	endif
	if gs_2D_projection_type <> 6 then
		addz gs_cutplane_height
		cutplane{2} 180 * (gs_2D_projection_type = 3), 1
		nProjectionCut = nProjectionCut + 1
		del 1
	endif
	if AC_symb_show_projection_to <> 3 then
		addz gs_top_range_height
		cutplane{2} 0, 2
		nProjectionCut = nProjectionCut + 1
		del 1
	endif
endif


! ==============================================================================
! 3D Hotspots
! ==============================================================================
! --- Bottom Cut to Roof ------------------------------------------------------------
	if rm_bIsBottomCut then
		unID = 5000
		hotspot 0,									0, 0,									unID, rm_PitchAngle, 6		: unID=unID+1
		hotspot _angleRotLength,					0, 0,									unID, rm_PitchAngle, 4+128	: unID=unID+1
		hotspot _angleRotLength*cos(rm_PitchAngle), 0, _angleRotLength*sin(rm_PitchAngle),	unID, rm_PitchAngle, 5		: unID=unID+1

		roty 180
		hotspot 0,									0, 0,									unID, rm_PitchAngle, 6		: unID=unID+1
		hotspot _angleRotLength,					0, 0,									unID, rm_PitchAngle, 4+128	: unID=unID+1
		hotspot _angleRotLength*cos(rm_PitchAngle), 0, _angleRotLength*sin(rm_PitchAngle),	unID, rm_PitchAngle, 5		: unID=unID+1
		del 1
	endif

! --- Top Cut to Roof in X Direction ------------------------------------------------------------
	if rm_bIsTopCut then
		unID = 5500
		addz rm_Height
		hotspot 0,									0, 0,									unID, rm_PitchAngle, 6		: unID=unID+1
		hotspot _angleRotLength,					0, 0,									unID, rm_PitchAngle, 4+128	: unID=unID+1
		hotspot _angleRotLength*cos(rm_PitchAngle), 0, _angleRotLength*sin(rm_PitchAngle),	unID, rm_PitchAngle, 5		: unID=unID+1

		roty 180
		hotspot 0,									0, 0,									unID, rm_PitchAngle, 6		: unID=unID+1
		hotspot _angleRotLength,					0, 0,									unID, rm_PitchAngle, 4+128	: unID=unID+1
		hotspot _angleRotLength*cos(rm_PitchAngle), 0, _angleRotLength*sin(rm_PitchAngle),	unID, rm_PitchAngle, 5		: unID=unID+1
		del 2
	endif

! --- Profile ------------------------------------------------------------
	unID = 1000
	hotspot  0,					profileHeightHalf, -_heightPlus*(rm_bIsBottomCut), unID, profileWidthHalf, 1+128,	rm_ProfileWidth : unID=unID+1
	hotspot -profileWidthHalf,	profileHeightHalf, -_heightPlus*(rm_bIsBottomCut), unID, profileWidthHalf, 2,		rm_ProfileWidth : unID=unID+1
	hotspot  1,					profileHeightHalf, -_heightPlus*(rm_bIsBottomCut), unID, profileWidthHalf, 3,		rm_ProfileWidth : unID=unID+1

	hotspot  0,					-profileHeightHalf, -_heightPlus*(rm_bIsBottomCut), unID,profileWidthHalf, 1+128,	rm_ProfileWidth : unID=unID+1
	hotspot -profileWidthHalf,	-profileHeightHalf, -_heightPlus*(rm_bIsBottomCut), unID,profileWidthHalf, 2,		rm_ProfileWidth : unID=unID+1
	hotspot  1,					-profileHeightHalf, -_heightPlus*(rm_bIsBottomCut), unID,profileWidthHalf, 3,		rm_ProfileWidth : unID=unID+1

	hotspot  0,					profileHeightHalf, _heightPlus*(rm_bIsBottomCut), unID, profileWidthHalf, 1+128,	rm_ProfileWidth : unID=unID+1
	hotspot  profileWidthHalf,	profileHeightHalf, _heightPlus*(rm_bIsBottomCut), unID, profileWidthHalf, 2,		rm_ProfileWidth : unID=unID+1
	hotspot -1,					profileHeightHalf, _heightPlus*(rm_bIsBottomCut), unID, profileWidthHalf, 3,		rm_ProfileWidth : unID=unID+1

	hotspot  0,					-profileHeightHalf, _heightPlus*(rm_bIsBottomCut), unID,profileWidthHalf, 1+128,	rm_ProfileWidth : unID=unID+1
	hotspot  profileWidthHalf,	-profileHeightHalf, _heightPlus*(rm_bIsBottomCut), unID,profileWidthHalf, 2,		rm_ProfileWidth : unID=unID+1
	hotspot -1,					-profileHeightHalf, _heightPlus*(rm_bIsBottomCut), unID,profileWidthHalf, 3,		rm_ProfileWidth : unID=unID+1

	unID = 2000
	hotspot -rm_ProfileWidth/2,  0,					-_heightPlus*(rm_bIsBottomCut), unID, profileHeightHalf, 1+128,	rm_ProfileHeight : unID=unID+1
	hotspot -rm_ProfileWidth/2,  profileHeightHalf,	-_heightPlus*(rm_bIsBottomCut), unID, profileHeightHalf, 2,		rm_ProfileHeight : unID=unID+1
	hotspot -rm_ProfileWidth/2, -1,					-_heightPlus*(rm_bIsBottomCut), unID, profileHeightHalf, 3,		rm_ProfileHeight : unID=unID+1

	hotspot -rm_ProfileWidth/2,  0,					-_heightPlus*(rm_bIsBottomCut), unID, profileHeightHalf, 1+128,	rm_ProfileHeight : unID=unID+1
	hotspot -rm_ProfileWidth/2, -profileHeightHalf,	-_heightPlus*(rm_bIsBottomCut), unID, profileHeightHalf, 2,		rm_ProfileHeight : unID=unID+1
	hotspot -rm_ProfileWidth/2,  1,					-_heightPlus*(rm_bIsBottomCut), unID, profileHeightHalf, 3,		rm_ProfileHeight : unID=unID+1

	hotspot rm_ProfileWidth/2,  0,					_heightPlus*(rm_bIsBottomCut), unID, profileHeightHalf, 1+128,	rm_ProfileHeight : unID=unID+1
	hotspot rm_ProfileWidth/2,  profileHeightHalf,	_heightPlus*(rm_bIsBottomCut), unID, profileHeightHalf, 2,		rm_ProfileHeight : unID=unID+1
	hotspot rm_ProfileWidth/2, -1,					_heightPlus*(rm_bIsBottomCut), unID, profileHeightHalf, 3,		rm_ProfileHeight : unID=unID+1

	hotspot rm_ProfileWidth/2,  0,					_heightPlus*(rm_bIsBottomCut), unID, profileHeightHalf, 1+128,	rm_ProfileHeight : unID=unID+1
	hotspot rm_ProfileWidth/2, -profileHeightHalf,	_heightPlus*(rm_bIsBottomCut), unID, profileHeightHalf, 2,		rm_ProfileHeight : unID=unID+1
	hotspot rm_ProfileWidth/2,  1,					_heightPlus*(rm_bIsBottomCut), unID, profileHeightHalf, 3,		rm_ProfileHeight : unID=unID+1

	unID = 1100
	hotspot  0,					profileHeightHalf, rm_Height-_heightPlus*(rm_bIsTopCut), unID, profileWidthHalf, 1+128,	rm_ProfileWidth : unID=unID+1
	hotspot -profileWidthHalf,	profileHeightHalf, rm_Height-_heightPlus*(rm_bIsTopCut), unID, profileWidthHalf, 2,		rm_ProfileWidth : unID=unID+1
	hotspot  1,					profileHeightHalf, rm_Height-_heightPlus*(rm_bIsTopCut), unID, profileWidthHalf, 3,		rm_ProfileWidth : unID=unID+1

	hotspot  0,					-profileHeightHalf,rm_Height-_heightPlus*(rm_bIsTopCut), unID,profileWidthHalf, 1+128,	rm_ProfileWidth : unID=unID+1
	hotspot -profileWidthHalf,	-profileHeightHalf, rm_Height-_heightPlus*(rm_bIsTopCut), unID,profileWidthHalf, 2,		rm_ProfileWidth : unID=unID+1
	hotspot  1,					-profileHeightHalf, rm_Height-_heightPlus*(rm_bIsTopCut), unID,profileWidthHalf, 3,		rm_ProfileWidth : unID=unID+1

	hotspot  0,					profileHeightHalf, rm_Height+_heightPlus*(rm_bIsTopCut), unID, profileWidthHalf, 1+128,	rm_ProfileWidth : unID=unID+1
	hotspot  profileWidthHalf,	profileHeightHalf, rm_Height+_heightPlus*(rm_bIsTopCut), unID, profileWidthHalf, 2,		rm_ProfileWidth : unID=unID+1
	hotspot -1,					profileHeightHalf, rm_Height+_heightPlus*(rm_bIsTopCut), unID, profileWidthHalf, 3,		rm_ProfileWidth : unID=unID+1

	hotspot  0,					-profileHeightHalf, rm_Height+_heightPlus*(rm_bIsTopCut), unID,profileWidthHalf, 1+128,	rm_ProfileWidth : unID=unID+1
	hotspot  profileWidthHalf,	-profileHeightHalf, rm_Height+_heightPlus*(rm_bIsTopCut), unID,profileWidthHalf, 2,		rm_ProfileWidth : unID=unID+1
	hotspot -1,					-profileHeightHalf, rm_Height+_heightPlus*(rm_bIsTopCut), unID,profileWidthHalf, 3,		rm_ProfileWidth : unID=unID+1

	unID = 2100
	hotspot -rm_ProfileWidth/2,  0,					rm_Height-_heightPlus*(rm_bIsTopCut), unID, profileHeightHalf, 1+128,	rm_ProfileHeight : unID=unID+1
	hotspot -rm_ProfileWidth/2,  profileHeightHalf,	rm_Height-_heightPlus*(rm_bIsTopCut), unID, profileHeightHalf, 2,		rm_ProfileHeight : unID=unID+1
	hotspot -rm_ProfileWidth/2, -1,					rm_Height-_heightPlus*(rm_bIsTopCut), unID, profileHeightHalf, 3,		rm_ProfileHeight : unID=unID+1

	hotspot -rm_ProfileWidth/2,  0,					rm_Height-_heightPlus*(rm_bIsTopCut), unID, profileHeightHalf, 1+128,	rm_ProfileHeight : unID=unID+1
	hotspot -rm_ProfileWidth/2, -profileHeightHalf,	rm_Height-_heightPlus*(rm_bIsTopCut), unID, profileHeightHalf, 2,		rm_ProfileHeight : unID=unID+1
	hotspot -rm_ProfileWidth/2,  1,					rm_Height-_heightPlus*(rm_bIsTopCut), unID, profileHeightHalf, 3,		rm_ProfileHeight : unID=unID+1

	hotspot rm_ProfileWidth/2,  0,					rm_Height+_heightPlus*(rm_bIsTopCut), unID, profileHeightHalf, 1+128,	rm_ProfileHeight : unID=unID+1
	hotspot rm_ProfileWidth/2,  profileHeightHalf,	rm_Height+_heightPlus*(rm_bIsTopCut), unID, profileHeightHalf, 2,		rm_ProfileHeight : unID=unID+1
	hotspot rm_ProfileWidth/2, -1,					rm_Height+_heightPlus*(rm_bIsTopCut), unID, profileHeightHalf, 3,		rm_ProfileHeight : unID=unID+1

	hotspot rm_ProfileWidth/2,  0,					rm_Height+_heightPlus*(rm_bIsTopCut), unID, profileHeightHalf, 1+128,	rm_ProfileHeight : unID=unID+1
	hotspot rm_ProfileWidth/2, -profileHeightHalf,	rm_Height+_heightPlus*(rm_bIsTopCut), unID, profileHeightHalf, 2,		rm_ProfileHeight : unID=unID+1
	hotspot rm_ProfileWidth/2,  1,					rm_Height+_heightPlus*(rm_bIsTopCut), unID, profileHeightHalf, 3,		rm_ProfileHeight : unID=unID+1

! --- Height ------------------------------------------------------------
	unID = 4000
	hotspot 0, 0,  0,			unID, rm_Height, 1+256	: unID=unID+1
	hotspot 0, 0, -1,			unID, rm_Height, 3		: unID=unID+1
	hotspot 0, 0,  rm_Height,	unID, rm_Height, 2		: unID=unID+1


! ==============================================================================
! Roofmaker Element
! ==============================================================================
nCut = 0

if rm_bIsBottomCut then
	add -rm_ProfileWidth/2, -rm_ProfileHeight/2,  -_heightPlus
	roty -rm_PitchAngle
	mulz -1
	cutplane
	nCut = nCut + 1
	del 3
endif

if rm_bIsTopCut then
	addz rm_Height
	roty -rm_PitchAngle
	cutplane
	nCut = nCut + 1
	del 2
endif

add -rm_ProfileWidth/2, -rm_ProfileHeight/2,  -_heightPlus*rm_bIsBottomCut

base
	block rm_ProfileWidth, rm_ProfileHeight, rm_Height + _heightPlus*(rm_bIsBottomCut + rm_bIsTopCut)

	vert 0,0,0
	vert 0,0,1
	vert 0,1,0
	vert -1,0,0

	coor 2, -1, -2, -3, -4
body 1

del 1

for i = 1 to nCut
	cutend
next i


! ==============================================================================
for i = 1 to nProjectionCut
	cutend
next i

END
