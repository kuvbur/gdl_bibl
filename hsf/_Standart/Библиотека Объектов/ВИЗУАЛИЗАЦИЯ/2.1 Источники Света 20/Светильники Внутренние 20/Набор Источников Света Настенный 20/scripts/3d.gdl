

	! ======================================================================
	! Lamp Bulb Surface
	! ======================================================================
	
	DIM	tmp_C4D_ChCol_Color[3]
		tmp_C4D_ChCol_Color[1] = 0.7843137254902
		tmp_C4D_ChCol_Color[2] = 0.7843137254902
		tmp_C4D_ChCol_Color[3] = 0.8039215686275
	DIM	tmp_C4D_ShNoise_Color1_1[3]
		tmp_C4D_ShNoise_Color1_1[1] = 0
		tmp_C4D_ShNoise_Color1_1[2] = 0
		tmp_C4D_ShNoise_Color1_1[3] = 0
	DIM	tmp_C4D_ShNoise_Color2_1[3]
		tmp_C4D_ShNoise_Color2_1[1] = 1
		tmp_C4D_ShNoise_Color2_1[2] = 1
		tmp_C4D_ShNoise_Color2_1[3] = 1
	DIM	tmp_C4D_ShNoise_RelativeScale_1[3]
		tmp_C4D_ShNoise_RelativeScale_1[1] = 1
		tmp_C4D_ShNoise_RelativeScale_1[2] = 1
		tmp_C4D_ShNoise_RelativeScale_1[3] = 1
	DIM	tmp_C4D_ChLum_Color[3]
		tmp_C4D_ChLum_Color[1] = 1
		tmp_C4D_ChLum_Color[2] = 1
		tmp_C4D_ChLum_Color[3] = 1
	DIM	tmp_C4D_ChTra_Color[3]
		tmp_C4D_ChTra_Color[1] = 0.9411764705882
		tmp_C4D_ChTra_Color[2] = 0.9411764705882
		tmp_C4D_ChTra_Color[3] = 0.9411764705882
	DIM	tmp_C4D_ChTra_AbsorptionColor[3]
		tmp_C4D_ChTra_AbsorptionColor[1] = 1
		tmp_C4D_ChTra_AbsorptionColor[2] = 1
		tmp_C4D_ChTra_AbsorptionColor[3] = 1
	DIM	tmp_C4D_ChRef_Color[3]
		tmp_C4D_ChRef_Color[1] = 1
		tmp_C4D_ChRef_Color[2] = 1
		tmp_C4D_ChRef_Color[3] = 1
	DIM	tmp_C4D_ChEnv_Color[3]
		tmp_C4D_ChEnv_Color[1] = 1
		tmp_C4D_ChEnv_Color[2] = 1
		tmp_C4D_ChEnv_Color[3] = 1
	DIM	tmp_C4D_ChFog_Color[3]
		tmp_C4D_ChFog_Color[1] = 1
		tmp_C4D_ChFog_Color[2] = 1
		tmp_C4D_ChFog_Color[3] = 1
	DIM	tmp_C4D_ChAlp_Color[3]
		tmp_C4D_ChAlp_Color[1] = 1
		tmp_C4D_ChAlp_Color[2] = 1
		tmp_C4D_ChAlp_Color[3] = 1
	DIM	tmp_C4D_ChAlp_Delta[3]
		tmp_C4D_ChAlp_Delta[1] = 0.1
		tmp_C4D_ChAlp_Delta[2] = 0.1
		tmp_C4D_ChAlp_Delta[3] = 0.1
	DIM	tmp_C4D_ChSpe_Color[3]
		tmp_C4D_ChSpe_Color[1] = 1
		tmp_C4D_ChSpe_Color[2] = 1
		tmp_C4D_ChSpe_Color[3] = 1
	DIM	tmp_C4D_ChGlo_Color[3]
		tmp_C4D_ChGlo_Color[1] = 1
		tmp_C4D_ChGlo_Color[2] = 1
		tmp_C4D_ChGlo_Color[3] = 1
	DIM	tmp_C4D_GKRGB_Color_3[3]
		tmp_C4D_GKRGB_Color_3[1] = 0
		tmp_C4D_GKRGB_Color_3[2] = 0
		tmp_C4D_GKRGB_Color_3[3] = 0
	DIM	tmp_C4D_GKRGB_Color_4[3]
		tmp_C4D_GKRGB_Color_4[1] = 1
		tmp_C4D_GKRGB_Color_4[2] = 1
		tmp_C4D_GKRGB_Color_4[3] = 1
	
	define material	"builtInMatLampBulb" 0,
		0.941176, 0.968627, 0.952941,
		0.8, 0.1, 1, 0.88,
		79.52, 0.04,
		1, 1, 1,
		0, 0, 0, 0,
	ADDITIONAL_DATA		C4D_VER_MAIN= 1,
	C4D_VER_SUB						= 0,
	C4D_ChCol_State					= 1,
	C4D_ChCol_Color					= tmp_C4D_ChCol_Color,
	C4D_ChCol_Brightness			= 1,
	C4D_ChCol_MixMode				= "Normal",
	C4D_ChCol_MixStrength			= 1,
	C4D_ChDif_State					= 0,
	C4D_ChDif_Brightness			= 1,
	C4D_ChDif_Luminance				= 1,
	C4D_ChDif_Specular				= 1,
	C4D_ChDif_Reflection			= 1,
	C4D_ChDif_Texture				= "1",
	C4D_ShNoise_BlendMode_1			= "Normal",
	C4D_ShNoise_BlendStre_1			= 1,
	C4D_ShNoise_BlurOffset_1		= 0,
	C4D_ShNoise_BlurScale_1			= 0,
	C4D_ShNoise_Color1_1			= tmp_C4D_ShNoise_Color1_1,
	C4D_ShNoise_Color2_1			= tmp_C4D_ShNoise_Color2_1,
	C4D_ShNoise_Seed_1				= 665,
	C4D_ShNoise_Noise_1				= "Turbulence",
	C4D_ShNoise_Octaves_1			= 5,
	C4D_ShNoise_Space_1				= "Texture",
	C4D_ShNoise_GlobalScale_1		= 0.01,
	C4D_ShNoise_RelativeScale_1		= tmp_C4D_ShNoise_RelativeScale_1,
	C4D_ShNoise_Absolute_1			= 0,
	C4D_ShNoise_Cycles_1			= 0,
	C4D_ShNoise_LowClip_1			= 0,
	C4D_ShNoise_HighClip_1			= 1,
	C4D_ShNoise_Brightness_1		= 0,
	C4D_ShNoise_Contrast_1			= 0,
	C4D_ChDif_MixMode				= "Normal",
	C4D_ChDif_MixStrength			= 0.1,
	C4D_ChLum_State					= 0,
	C4D_ChLum_Color					= tmp_C4D_ChLum_Color,
	C4D_ChLum_Brightness			= 1,
	C4D_ChLum_MixMode				= "Normal",
	C4D_ChLum_MixStrength			= 1,
	C4D_ChTra_State					= 1,
	C4D_ChTra_Color					= tmp_C4D_ChTra_Color,
	C4D_ChTra_Brightness			= 0.95,
	C4D_ChTra_Refraction			= 1,
	C4D_ChTra_InternalReflections	= 1,
	C4D_ChTra_ExitReflection		= 0,
	C4D_ChTra_FresnelReflectivity	= 0.5,
	C4D_ChTra_Additive				= 0,
	C4D_ChTra_MixMode				= "Normal",
	C4D_ChTra_MixStrength			= 1,
	C4D_ChTra_AbsorptionColor		= tmp_C4D_ChTra_AbsorptionColor,
	C4D_ChTra_AbsorptionDistance	= 100,
	C4D_ChTra_Blurriness			= 0,
	C4D_ChTra_MinSamples			= 10,
	C4D_ChTra_MaxSamples			= 80,
	C4D_ChTra_Accuracy				= 0.5,
	C4D_ChRef_State					= 1,
	C4D_ChRef_Color					= tmp_C4D_ChRef_Color,
	C4D_ChRef_Brightness			= 0.1,
	C4D_ChRef_Additive				= 1,
	C4D_ChRef_MixMode				= "Normal",
	C4D_ChRef_MixStrength			= 1,
	C4D_ChRef_Blurriness			= 0,
	C4D_ChRef_MinSamples			= 5,
	C4D_ChRef_MaxSamples			= 128,
	C4D_ChRef_Accuracy				= 0.5,
	C4D_ChEnv_State					= 0,
	C4D_ChEnv_Color					= tmp_C4D_ChEnv_Color,
	C4D_ChEnv_Brightness			= 1,
	C4D_ChEnv_MixMode				= "Normal",
	C4D_ChEnv_MixStrength			= 1,
	C4D_ChEnv_TilesX				= 1,
	C4D_ChEnv_TilesY				= 1,
	C4D_ChEnv_Exclusive				= 0,
	C4D_ChFog_State					= 0,
	C4D_ChFog_Color					= tmp_C4D_ChFog_Color,
	C4D_ChFog_Brightness			= 1,
	C4D_ChFog_Distance				= 10,
	C4D_ChBum_State					= 0,
	C4D_ChBum_Strength				= 1,
	C4D_ChBum_MipFalloff			= 1,
	C4D_ChNor_State					= 0,
	C4D_ChNor_Strength				= 1,
	C4D_ChNor_Method				= "Tangent",
	C4D_ChNor_FlipX					= 0,
	C4D_ChNor_FlipY					= 0,
	C4D_ChNor_FlipZ					= 0,
	C4D_ChNor_SwapYZ				= 0,
	C4D_ChAlp_State					= 0,
	C4D_ChAlp_Color					= tmp_C4D_ChAlp_Color,
	C4D_ChAlp_Delta					= tmp_C4D_ChAlp_Delta,
	C4D_ChAlp_Invert				= 0,
	C4D_ChAlp_Soft					= 1,
	C4D_ChAlp_ImageAlpha			= 0,
	C4D_ChAlp_PreMultiplied			= 0,
	C4D_ChSpe_State					= 1,
	C4D_ChSpe_Color					= tmp_C4D_ChSpe_Color,
	C4D_ChSpe_Brightness			= 1,
	C4D_ChSpe_MixMode				= "Normal",
	C4D_ChSpe_MixStrength			= 1,
	C4D_ChSpe_Mode					= "Plastic",
	C4D_ChSpe_Width					= 0.45,
	C4D_ChSpe_Height				= 0.5,
	C4D_ChSpe_Falloff				= -0.05,
	C4D_ChSpe_InnerWidth			= 0,
	C4D_ChGlo_State					= 0,
	C4D_ChGlo_Color					= tmp_C4D_ChGlo_Color,
	C4D_ChGlo_Brightness			= 1,
	C4D_ChGlo_InnerStrength			= 1,
	C4D_ChGlo_OuterStrength			= 5,
	C4D_ChGlo_Radius				= 10,
	C4D_ChGlo_Random				= 0,
	C4D_ChGlo_Frequency				= 1,
	C4D_ChGlo_UseMatColor			= 1,
	C4D_ChDis_State					= 0,
	C4D_ChDis_Strength				= 1,
	C4D_ChDis_Height				= 0.5,
	C4D_ChDis_Type					= "IntensityCentered",
	C4D_ChDis_SubDivision			= 0,
	C4D_ChDis_Level					= 4,
	C4D_ChDis_RoundGeometry			= 0,
	C4D_ChDis_RoundContour			= 1,
	C4D_ChDis_MapRounded			= 1,
	C4D_ChDis_MapResult				= 0,
	C4D_ChDis_KeepEdges				= 0,
	C4D_ChDis_BestDistribution		= 1,
	C4D_ChGra_State					= 0,
	C4D_ChGra_Color					= "2",
	C4D_GradientRGB_Interpol_2		= "SmoothKnot",
	C4D_GradientRGB_Knots_2			= "3,4",
	C4D_GKRGB_Color_3				= tmp_C4D_GKRGB_Color_3,
	C4D_GKRGB_Intensity_3			= 1,
	C4D_GKRGB_Position_3			= 0,
	C4D_GKRGB_Bias_3				= 0.5,
	C4D_GKRGB_Color_4				= tmp_C4D_GKRGB_Color_4,
	C4D_GKRGB_Intensity_4			= 1,
	C4D_GKRGB_Position_4			= 1,
	C4D_GKRGB_Bias_4				= 0.5,
	C4D_ChGra_MixStrength			= 0.5,
	C4D_ChGra_Density				= 1,
	C4D_ChGra_Length				= 0.1,
	C4D_ChGra_Width					= 0.005,
	C4D_ChGra_Crinkle				= 0.1,
	C4D_ChGra_Bend					= 0.6,
	C4D_ChGra_Wetness				= 0.05,
	C4D_ChIll_GenerateGI			= 1,
	C4D_ChIll_GenGIStrength			= 1,
	C4D_ChIll_GenGISaturat			= 1,
	C4D_ChIll_ReceiveGI				= 1,
	C4D_ChIll_RecGIStrength			= 1,
	C4D_ChIll_RecGISaturat			= 1,
	C4D_ChIll_GIPortal				= 0,
	C4D_ChIll_GILight				= 0,
	C4D_ChIll_GenerateCaustics		= 1,
	C4D_ChIll_GenCausticsStrength	= 1,
	C4D_ChIll_ReceiveCaustics		= 1,
	C4D_ChIll_RecCausticsStrength	= 1,
	C4D_ChIll_Radius				= 0.1,
	C4D_ChIll_CausticsSamples		= 100,
	C4D_ChIll_Model					= "Blinn",
	C4D_ChIll_DiffuseFalloff		= 0,
	C4D_ChIll_DiffuseLevel			= 1,
	C4D_ChIll_Roughness				= 0.5
	
	
if gs_detlevel_3D_m=0 and not(gs_2D_projection) then end
if gs_detlevel_3D_m=1 and not(gs_2D_projection) then gs_resol=6

if GLOB_CONTEXT > 20 & GLOB_CONTEXT < 40 then gs_resol = 6

if not(gs_shadow) then shadow off


unID=1

hotspot 0,0,0,unID : unID=unID+1


! --- Actual spot's subroutine name ---

actspot = "SPOT_" + STR("%.0m",iSpotStyle)


! --- Rotating Spotlight ---
rotx -90
if iOrientation = 2 then
	rotz -90
endif


bLight = (gs_light_switch)

! ==============================================================================
!	Mount
! ==============================================================================

! --- Spot Position's Array ---
dim xSpotPos[6]
dim ySpotPos[6]
dim zSpotPos[6]
for i = 1 to numSpots
	xSpotPos[i] = 0
	ySpotPos[i] = 0
	zSpotPos[i] = 0
next i

pen gs_cont_pen
resol gs_resol

if iMountType <> 3 and iMountType <> 4 and iMountType <> 5 then
	if iMountCover = 3 then
		mount_cover_h = 0
	else
		mount_cover_h = 0.04
		if iMountCover = 1 then gosub "MOUNTCOVER_1"
		if iMountCover = 2 then gosub "MOUNTCOVER_2"
	endif
endif

if iMountType = 1 then
	gosub "MOUNT_1"
endif
if iMountType = 2 then
	gosub "MOUNT_2"
endif
if iMountType = 3 then
	gosub "MOUNT_3"
endif
if iMountType = 4 then
	gosub "MOUNT_4"
endif
if iMountType = 5 then
	gosub "MOUNT_5"
endif
if iMountType = 6 then
	gosub "MOUNT_6"
endif
if iMountType = 7 then
	gosub "MOUNT_7"
endif
if iMountType = 8 then
	gosub "MOUNT_8"
endif
if iMountType = 9 then
	gosub "MOUNT_9"
endif
if iMountType = 10 then
	gosub "MOUNT_10"
endif
if iMountType = 11 then
	gosub "MOUNT_11"
endif

actrot_x = 90

! ==============================================================================
!	Spots & Light Cone
! ==============================================================================

_sumDistZ = 0

for actsp=1 to numSpots

	actspotangle_h = spotangle_h[actsp]
	actspotangle_v = spotangle_v[actsp]

	add xSpotPos[actsp], ySpotPos[actsp], zSpotPos[actsp]
	if GLOB_CONTEXT = 23 or GLOB_CONTEXT = 24 then
		if (iSpotOrientation = 3) or (iSpotOrientation = 2 and actsp = 1) then
			resol 32
			pen penSpotPosition
			model wire
			circle hotspotdist
			rotz -actspotangle_h
			roty 90
			arc hotspot2dist, 0, 90
			del 2
			model solid
			resol gs_resol
		endif
	endif

	pen gs_cont_pen

	rotx actrot_x
	gosub actspot
	gosub "LIGHTCONE"
	del 2

	hotspot xSpotPos[actsp],	ySpotPos[actsp],	zSpotPos[actsp], unID : unID=unID+1

	if (iSpotOrientation = 3) or (iSpotOrientation = 2 and actsp = 1) then
		hotspot xSpotPos[actsp],	ySpotPos[actsp],	zSpotPos[actsp],	unID,spotangle_h[actsp],	6 : unID=unID+1
		hotspot xSpotPos[actsp],	ySpotPos[actsp]+1,	zSpotPos[actsp],	unID,spotangle_h[actsp],	4+128 : unID=unID+1
		hotspot xSpotPos[actsp],	ySpotPos[actsp],	zSpotPos[actsp]-1,	unID,spotangle_h[actsp],	7 : unID=unID+1
		hotspot xSpotPos[actsp]+hotspotdist*sin(spotangle_h[actsp]),ySpotPos[actsp]+hotspotdist*cos(spotangle_h[actsp]),zSpotPos[actsp],unID,spotangle_h[actsp],5 : unID=unID+1

		if GLOB_CONTEXT <> 4 then
			hotspot xSpotPos[actsp],	ySpotPos[actsp],	zSpotPos[actsp],	unID,	spotangle_v[actsp],	6 	: unID=unID+1
			hotspot xSpotPos[actsp]+2*hotspotdist*sin(spotangle_h[actsp]), ySpotPos[actsp]+2*hotspotdist*cos(spotangle_h[actsp]), zSpotPos[actsp],	unID,spotangle_v[actsp], 4+128	: unID=unID+1
			hotspot xSpotPos[actsp]-2*hotspotdist*cos(spotangle_h[actsp]), ySpotPos[actsp]+2*hotspotdist*sin(spotangle_h[actsp]), zSpotPos[actsp],	unID,spotangle_v[actsp], 7 	: unID=unID+1
			hotspot xSpotPos[actsp]+sin(spotangle_h[actsp])*hotspot2dist*cos(spotangle_v[actsp]),\
					ySpotPos[actsp]+cos(spotangle_h[actsp])*hotspot2dist*cos(spotangle_v[actsp]),\
					zSpotPos[actsp]-hotspot2dist*sin(spotangle_v[actsp]),	unID, spotangle_v[actsp],5 	: unID=unID+1
		else
			unID=unID+4
		endif
	endif

	_sumDistZ = _sumDistZ + zSpotPos[actsp]

next actsp

_avgDistZ = _sumDistZ / numSpots

gosub "FakeIllumination"

! ==============================================================================

del 1
if iOrientation = 2 then
	del 1
endif


! ==============================================================================
end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! en
! ==============================================================================


! ==============================================================================
"MOUNTCOVER_2":
! ==============================================================================

	pen gs_cont_pen
	resol gs_resol
	material matFrame

	mount_cover_a = 0.1

	addz -mount_cover_h/2

	for i = 1 to 2
		cylind mount_cover_h/2, mount_cover_a/2
		addz -mount_cover_h/2
		mul 0.8, 0.8, 1
	next i
	del 5

return



! ==============================================================================
"MOUNTCOVER_1":
! ==============================================================================

	pen gs_cont_pen
	resol gs_resol
	material matFrame

	mount_cover_a = 0.1
	mount_cover_b = 0.1

	addz -mount_cover_h/2

	for i = 1 to 2
		prism_ 5, mount_cover_h/2,
			-mount_cover_a/2, -mount_cover_b/2, 15,
			 mount_cover_a/2, -mount_cover_b/2, 15,
			 mount_cover_a/2,  mount_cover_b/2, 15,
			-mount_cover_a/2,  mount_cover_b/2, 15,
			-mount_cover_a/2, -mount_cover_b/2, -1
		addz -mount_cover_h/2
		mul 0.8, 0.8, 1
	next i
	del 5

return



! ==============================================================================
"MOUNT_1":
! ==============================================================================

	pen gs_cont_pen
	resol gs_resol
	material matFrame

	sumangle = 40
	angle = sumangle / (numSpots-1)
	mulx_factor = a/0.5

	add 0, 0.03, -0.6-0.1
	for i = 0 to numSpots-1
		add mulx_factor*0.65*cos(90-sumangle/2+i*angle), 0, 0.65*sin(90-sumangle/2+i*angle)
		rotx 90
		cylind 0.06, rod_r*0.9
		del 1
		add 0, -0.03, -0.035
		cylind 0.035, rod_r*0.7
		del 2
		! --- Spot Positions ---
		xSpotPos[i+1] = mulx_factor * 0.65 * cos(90-sumangle/2+i*angle)
		ySpotPos[i+1] = 0
		zSpotPos[i+1] = -0.6-0.1-0.035 + 0.65 * sin(90-sumangle/2+i*angle)
	next i
	del 1

	addz -mount_cover_h
	rotx 180
	cylind 0.03, rod_r
	del 2

	add 0, 0.05, -0.05
	rotx 90
	cylind 0.1, 0.018
	del 2

	add 0, 0.03, -0.1
	mulx mulx_factor
	rotx 90
	for i = 1 to 2
		tube 7, 11, 1+2+16+32,
			rod_r,	0,      1,
			0, 0,    900,
			0,    180,   4001,
			-rod_r, 0, 1,
			0, 0,    900,
			0,    180,   4001,
			rod_r,	0,      1,

			0.307905902447, -0.02755440849082,      0,  0,
					0.25,            0,      0,   0,
			0.189660760887, 0.0217144004925,      0,   0,
			0.1274754878398, 0.0373774391991,      0,   0,
			0.06404945167832, 0.04683666233425,      0,   0,
					   0,         0.05,      0,    0,
			-0.06404945167832, 0.04683666233425,      0,   0,
			-0.1274754878398, 0.0373774391991,      0,    0,
			-0.189660760887, 0.0217144004925,      0,   0,
				   -0.25,            0,      0,   0,
			-0.307905902447, -0.02755440849082,      0,  0
		addz 0.06
	next i
	del 5

return



! ==============================================================================
"MOUNT_2":
! ==============================================================================

	pen gs_cont_pen
	resol gs_resol
	material matFrame

	sumangle = 40
	mulx_factor = a/0.5

	if numSpots/2 - int(numSpots/2) > 0 then
		numSpotsHalf = (numSpots-1)/2
		angle = sumangle / (numSpotsHalf)
	else
		numSpotsHalf = numSpots/2
		angle = sumangle / (numSpotsHalf-0.5)
	endif

	! --- Spot on Middle ---
	if numSpots/2 - int(numSpots/2) > 0 then
		add 0, 0, -mount_cover_h-rod_r-0.015
		cylind 0.015, rod_r*0.7
		del 1
		xSpotPos[numSpots] = 0
		ySpotPos[numSpots] = 0
		zSpotPos[numSpots] = -mount_cover_h-rod_r-0.015
	endif

	for i = 1 to 2
		add -0.25*mulx_factor/2, -0.6, -mount_cover_h-rod_r-0.015
		for j = 0 to numSpotsHalf-1
			add mulx_factor/2*(0.65*cos(90+sumangle/2-j*angle)), 0.65*sin(90-sumangle/2+j*angle), 0
			cylind 0.015, rod_r*0.7
			del 1
			! --- Spot Positions ---
			if i = 1 then
				xSpotPos[j+1] = -0.25*mulx_factor/2 + mulx_factor/2 * ( 0.65 * cos(90+sumangle/2-j*angle))
				ySpotPos[j+1] = -0.6 + 0.65 * sin(90-sumangle/2+j*angle)
				zSpotPos[j+1] = -mount_cover_h-rod_r-0.015
			else
				xSpotPos[numSpotsHalf+j+1] = -(-0.25*mulx_factor/2 + mulx_factor/2 * ( 0.65 * cos(90+sumangle/2-j*angle)))
				ySpotPos[numSpotsHalf+j+1] = -(-0.6 + 0.65 * sin(90-sumangle/2+j*angle))
				zSpotPos[numSpotsHalf+j+1] = -mount_cover_h-rod_r-0.015
			endif
		next j
		del 1
		mulx -1
		muly -1
	next i
	del 2*2

	add -0.25*mulx_factor/2, 0, -mount_cover_h-rod_r
	for i = 1 to 2
		tube 7, 11, 1+2+16*(i = 2)+32*(i = 1),
			rod_r,	0,      1,
			0, 0,    900,
			0,    180,   4001,
			-0.008, 0, 1,
			0, 0,    900,
			0,    180,   4001,
			0.008,	0,      1,

			mulx_factor/2*0.307905902447, -0.02755440849082,      0,  0,
			mulx_factor/2*0.25,            0,      0,   0,
			mulx_factor/2*0.189660760887, 0.0217144004925,      0,   0,
			mulx_factor/2*0.1274754878398, 0.0373774391991,      0,   0,
			mulx_factor/2*0.06404945167832, 0.04683666233425,      0,   0,
					   0,         0.05,      0,    0,
			-0.06404945167832*mulx_factor/2, 0.04683666233425,      0,   0,
			-0.1274754878398*mulx_factor/2, 0.0373774391991,      0,    0,
			-0.189660760887*mulx_factor/2, 0.0217144004925,      0,   0,
				   -0.25*mulx_factor/2,            0,      0,   0,
			-0.307905902447*mulx_factor/2, -0.02755440849082,      0,  0
		addx 0.5*mulx_factor/2
		muly -1
	next i
	del 5

return



! ==============================================================================
"MOUNT_3":
! ==============================================================================

	pen gs_cont_pen
	resol gs_resol
	material matFrame

	rotz -90
	roty -90
	revolve 8,360,1+2,
			-2 19/64",0,1,
			 0,1,800,
			-1 7/8",1 1/2",1000,
			-1 7/8",1 3/4",0,
			-1 5/8",2",0,
			-1 3/8",2",0,
			-1 3/8",1 5/8",0,
			 0",1 5/8",0
	del 2

	if (numSpots/2 - int(numSpots/2)) > eps then
		rotz 360/numSpots/2
	endif

	for i = 1 to numSpots
		addz -11/16"
		roty -90
		prism_ 6, 3 47/64",
				 1/4",0,75,
				 0,1,800,
				-1/4",0,1075,
				 0,-1,800,
				 1/4",0,1075,
				 1/4",0,-1
		del 2

		add -3 47/64",0,-1 3/16"
		rotx 90
		roty -90
		resol gs_resol
		revolve 6,45,1+2,
				1/4",1/2",1,
				0,1,800,
				-1/4",1/2",1001,
				0,-1,800,
				1/4",1/2",1001,
				1/4",1/2",-1
		del 3

		add -7 35/64",0,-4 19/64"
		roty 45
		addz 3 29/32"
		prism_ 6,1",
				1/4",0,75,
				0,1,800,
				-1/4",0,1075,
				0,-1,800,
				1/4",0,1075,
				1/4",0,-1
		del 3

		xSpotPos[i] = 0.122 * cos(i*360/numSpots)
		ySpotPos[i] = 0.122 * sin(i*360/numSpots)
		zSpotPos[i] = -0.039

		rotz 360/numSpots

	next i
	del numSpots

	if (numSpots/2 - int(numSpots/2)) > eps then
		del 1
	endif

return



! ==============================================================================
"MOUNT_4":
! ==============================================================================

	pen gs_cont_pen
	resol gs_resol
	material matFrame

	mount_cover_a = a
	mount_cover_b = a
	mount_cover_h = 0.01

	addz -mount_cover_h
	if iMountCover = 2 then
		cylind mount_cover_h, mount_cover_a/2
	else
		prism_ 5, mount_cover_h,
			-mount_cover_a/2, -mount_cover_b/2, 15,
			 mount_cover_a/2, -mount_cover_b/2, 15,
			 mount_cover_a/2,  mount_cover_b/2, 15,
			-mount_cover_a/2,  mount_cover_b/2, 15,
			-mount_cover_a/2, -mount_cover_b/2, -1
	endif
	del 1

	for i = 1 to numSpots
		rotz 180/numSpots
		if numSpots = 1 then
			add 0, 0, -mount_cover_h-0.02
		else
			add mount_cover_a/2-0.03, 0, -mount_cover_h-0.02
		endif
		cylind 0.02, rod_r*0.8
		del 2
		rotz 360/numSpots
		! --- Spot Positions ---
		if numSpots = 1 then
			xSpotPos[i] = 0
			ySpotPos[i] = 0
			zSpotPos[i] = -mount_cover_h-0.02
		else
			xSpotPos[i] = (mount_cover_a/2-0.03) * cos(180/numSpots+(i-1)*360/numSpots)
			ySpotPos[i] = (mount_cover_a/2-0.03) * sin(180/numSpots+(i-1)*360/numSpots)
			zSpotPos[i] = -mount_cover_h-0.02
		endif
	next i
	del numSpots

return



! ==============================================================================
"MOUNT_5":
! ==============================================================================

	pen gs_cont_pen
	resol gs_resol
	material matFrame

	mount_cover_a = a
	mount_cover_b = 0.2
	mount_cover_h = 0.04
	if numSpots > 1 then
		spotdistance = (mount_cover_a - 0.06)/(numSpots-1)
	else
		spotdistance = 0
	endif

	addz -mount_cover_h
	for i = 1 to 2
		prism_ 5, mount_cover_h*1/5,
			-mount_cover_a/2, -mount_cover_b/2, 15,
			 mount_cover_a/2, -mount_cover_b/2, 15,
			 mount_cover_a/2,  mount_cover_b/2, 15,
			-mount_cover_a/2,  mount_cover_b/2, 15,
			-mount_cover_a/2, -mount_cover_b/2, -1
		addz mount_cover_h*1/5
		mul 0.9, 0.9, 4
	next i
	del 5

	for i = 0 to numSpots-1
		add (mount_cover_a/2-0.03)*(numSpots>1)-spotdistance*i, 0, -mount_cover_h-0.02
		cylind 0.02, rod_r*0.8
		del 1
		! --- Spot Positions ---
		xSpotPos[i+1] = (mount_cover_a/2-0.03)*(numSpots>1)-spotdistance*(i)
		ySpotPos[i+1] = 0
		zSpotPos[i+1] = -mount_cover_h-0.02
	next i


return



! ==============================================================================
"MOUNT_6":
! ==============================================================================

	pen gs_cont_pen
	resol gs_resol
	material matFrame

	add a/2, 0, -mount_cover_h-rod_r
	roty -90
	if iMountCover = 3 then
		prism_ 6, a,
				rod_r, 	-rod_r,	15,
				0, 		-rod_r, 79,
				0,		 0,		900,
				rod_r,	-180,	4079,
				0, 		 rod_r, 79,
				rod_r, 	 rod_r,	15
	else
		cylind a, rod_r
	endif
	del 2

	spotdistance = (a - 0.06)/(numSpots-1)
	for i = 0 to numSpots-1
		add a/2-0.03-spotdistance*i, 0, -mount_cover_h-rod_r-0.02
		cylind 0.02, rod_r*0.8
		del 1
		! --- Spot Positions ---
		xSpotPos[i+1] = a/2-0.03-spotdistance*i
		ySpotPos[i+1] = 0
		zSpotPos[i+1] = -mount_cover_h-rod_r-0.02
	next i

return



! ==============================================================================
"MOUNT_7":
! ==============================================================================

	pen gs_cont_pen
	resol gs_resol
	material matFrame

	rotz arm1angle
	add a/2, 0, -mount_cover_h-rod_r
	roty -90
	cylind a/2 + 0.05, rod_r
	del 3

	rotz arm2angle
	add -a/2, 0, -mount_cover_h-rod_r - 0.06
	roty 90
	cylind a/2 + 0.05, rod_r
	del 3

	addz -mount_cover_h - 0.06 - rod_r
	cylind mount_cover_h + 0.06, rod_r
	del 1

	spotdistance = (a - 0.06)/(numSpots-1)
	for i = 0 to numSpots-1
		if (a/2-0.03-spotdistance*i) < 0.05 then
			rotz arm2angle
			addz -0.06
			actangle = arm2angle
		else
			rotz arm1angle
			actangle = arm1angle
		endif
		add a/2-0.03-spotdistance*i, 0, -mount_cover_h-rod_r-0.02
		cylind 0.02, rod_r*0.7
		del 1
		if a/2-0.03-spotdistance*i < 0.05 then
			del 2
		else
			del 1
		endif
		! --- Spot Positions ---
		xSpotPos[i+1] = (a/2-0.03-spotdistance*i)*cos(actangle)
		ySpotPos[i+1] = (a/2-0.03-spotdistance*i)*sin(actangle)
		zSpotPos[i+1] = -mount_cover_h-rod_r-0.02-0.06*((a/2-0.03-spotdistance*i) < 0.05)
	next i

	hotspot 0, 0,-mount_cover_h-rod_r,unID,arm1angle,6 : unID=unID+1
	hotspot 1, 0,-mount_cover_h-rod_r,unID,arm1angle,4+128 : unID=unID+1
	hotspot 0, 0,1,unID,arm1angle,7 : unID=unID+1
	hotspot a/2*cos(arm1angle), a/2*sin(arm1angle),-mount_cover_h-rod_r,unID,arm1angle,5 : unID=unID+1

	addz -0.06
	hotspot 0, 0,-mount_cover_h-rod_r,unID,arm2angle,6 : unID=unID+1
	hotspot -1, 0,-mount_cover_h-rod_r,unID,arm2angle,4+128 : unID=unID+1
	hotspot 0, 0,1,unID,arm2angle,7 : unID=unID+1
	hotspot -a/2*cos(arm2angle),-a/2*sin(arm2angle),-mount_cover_h-rod_r,unID,arm2angle,5 : unID=unID+1
	del 1

return



! ==============================================================================
"MOUNT_8":
! ==============================================================================

	pen gs_cont_pen
	resol gs_resol
	material matFrame

	distfromcenter = 0.03

	addy distfromcenter
	rotz arm1angle
	add a/2, 0, -mount_cover_h-rod_r
	roty -90
	cylind a/2 + distfromcenter, rod_r
	del 3
	del 1

	addy -distfromcenter
	rotz arm2angle
	add -a/2, 0, -mount_cover_h-rod_r
	roty 90
	cylind a/2 + distfromcenter, rod_r
	del 4

	spotdistance = (a - 2*distfromcenter)/(numSpots-1)
	for i = 0 to numSpots-1
		if (a/2-distfromcenter-spotdistance*i) < 0.05 then
			addy -distfromcenter
			rotz arm2angle
			actangle = arm2angle
		else
			addy distfromcenter
			rotz arm1angle
			actangle = arm1angle
		endif
		add a/2-distfromcenter-spotdistance*i, 0, -mount_cover_h-rod_r-0.02
		cylind 0.02, rod_r*0.7
		del 1
		if a/2-distfromcenter-spotdistance*i < 0.05 then
			del 2
		else
			del 2
		endif
		! --- Spot Positions ---
		xSpotPos[i+1] = (a/2-distfromcenter-spotdistance*i)*cos(actangle)
		ySpotPos[i+1] = (a/2-distfromcenter-spotdistance*i)*sin(actangle) \
							-distfromcenter*((a/2-distfromcenter-spotdistance*i) < 0.05) \
							+distfromcenter*((a/2-distfromcenter-spotdistance*i) >= 0.05)
		zSpotPos[i+1] = -mount_cover_h-rod_r-0.02
	next i

	hotspot 0,distfromcenter,-mount_cover_h-rod_r,unID,arm1angle,6 : unID=unID+1
	hotspot 1,distfromcenter,-mount_cover_h-rod_r,unID,arm1angle,4+128 : unID=unID+1
	hotspot 0,distfromcenter,1,unID,arm1angle,7 : unID=unID+1
	hotspot a/2*cos(arm1angle),distfromcenter+a/2*sin(arm1angle),-mount_cover_h-rod_r,unID,arm1angle,5 : unID=unID+1

	hotspot 0,-distfromcenter,-mount_cover_h-rod_r,unID,arm2angle,6 : unID=unID+1
	hotspot -1,-distfromcenter,-mount_cover_h-rod_r,unID,arm2angle,4+128 : unID=unID+1
	hotspot 0,-distfromcenter,1,unID,arm2angle,7 : unID=unID+1
	hotspot -a/2*cos(arm2angle),-distfromcenter-a/2*sin(arm2angle),-mount_cover_h-rod_r,unID,arm2angle,5 : unID=unID+1


return



! ==============================================================================
"MOUNT_9":
! ==============================================================================

	pen gs_cont_pen
	resol gs_resol
	material matFrame

	add a/2, 0, -mount_cover_h-rod_r
	roty -90
	cylind a, rod_r
	del 2

	rotz arm1angle
	add -a/2, 0, -mount_cover_h-rod_r*3
	roty 90
	cylind a, rod_r
	del 3

	if numSpots/2 - int(numSpots/2) > eps then
		numSpots = numSpots + 1
	endif

	spotdistance = (a - 0.06)/(numSpots/2-1)
	for i = 0 to numSpots-1
		if (a-0.05-spotdistance*i) < eps then
			actangle = arm1angle
			rotz arm1angle
			add a-0.06+spotdistance, 0, -rod_r*3
		else
			actangle = 0
		endif
		add a/2-0.03-spotdistance*i, 0, -mount_cover_h-rod_r-0.02
		cylind 0.02, rod_r*0.7
		del 1
		if (a-0.05-spotdistance*i) < eps then
			del 2
		endif
		! --- Spot Positions ---
		xSpotPos[i+1] = (a/2-0.03-spotdistance*i+(a-0.06+spotdistance)*((a-0.05-spotdistance*i) < eps))*cos(actangle)
		ySpotPos[i+1] = (a/2-0.03-spotdistance*i+(a-0.06+spotdistance)*((a-0.05-spotdistance*i) < eps))*sin(actangle)
		zSpotPos[i+1] = -mount_cover_h-rod_r-0.02-(rod_r*2)*((a-0.05-spotdistance*i) < eps)
	next i

	hotspot 0,0,-mount_cover_h-rod_r,unID,arm1angle,6 : unID=unID+1
	hotspot 1,0,-mount_cover_h-rod_r,unID,arm1angle,4+128 : unID=unID+1
	hotspot 0,0,1,unID,arm1angle,7 : unID=unID+1
	hotspot a/2*cos(arm1angle),a/2*sin(arm1angle),-mount_cover_h-rod_r,unID,arm1angle,5 : unID=unID+1

	hotspot 0,0,-mount_cover_h-rod_r,unID,arm1angle,6 : unID=unID+1
	hotspot 1,0,-mount_cover_h-rod_r,unID,arm1angle,4+128 : unID=unID+1
	hotspot 0,0,1,unID,arm1angle,7 : unID=unID+1
	hotspot -a/2*cos(arm1angle),-a/2*sin(arm1angle),-mount_cover_h-rod_r,unID,arm1angle,5 : unID=unID+1

return



! ==============================================================================
"MOUNT_10":
! ==============================================================================

	pen gs_cont_pen
	resol gs_resol
	material matFrame

	sumangle = 40
	distfromcenter = 0.03
	mulx_factor = a/0.5

	if numSpots/3 - int(numSpots/3) > 0 then
		numSpotsHalf = (numSpots-1)/3
		angle = sumangle / (numSpotsHalf)
	else
		numSpotsHalf = numSpots/3
		angle = sumangle / (numSpotsHalf-0.5)
	endif

	if numSpots/3 - int(numSpots/3) > 0 then
		add 0, 0, -mount_cover_h-rod_r-0.055
		cylind 0.055, rod_r*0.9
		del 1
	endif

	for i = 1 to 3
		if i = 1 then
			actangle = arm1angle
			rotangle = arm1angle
		else
			if i = 2 then
				actangle = arm2angle
				rotangle = arm2angle
			else
				actangle = arm3angle
				rotangle = arm3angle
			endif
		endif
		rotz rotangle
		add -0.25*mulx_factor/2 - distfromcenter , -0.6, -mount_cover_h-rod_r-0.025
		for j = 0 to numSpotsHalf-1
			add mulx_factor/2 * ( 0.65 * cos(90+sumangle/2-j*angle)), 0.65 * sin(90-sumangle/2+j*angle), 0
			cylind 0.025, rod_r*0.7
			del 1
			! --- Spot Positions ---!
			if numSpotsHalf > 1 then
				xSpotPos[i*numSpotsHalf-1*(j=0)] = (-0.25*mulx_factor/2 - distfromcenter + mulx_factor/2 * ( 0.65 * cos(90+sumangle/2-j*angle)))*cos(actangle)\
								 - (-0.6 + 0.65 * sin(90-sumangle/2+j*angle))*sin(actangle)
				ySpotPos[i*numSpotsHalf-1*(j=0)] = (-0.25*mulx_factor/2 - distfromcenter + mulx_factor/2 * ( 0.65 * cos(90+sumangle/2-j*angle)))*sin(actangle)\
								 + (-0.6 + 0.65 * sin(90-sumangle/2+j*angle))*cos(actangle)
				zSpotPos[i*numSpotsHalf-1*(j=0)] = -mount_cover_h-rod_r-0.025
			else
				xSpotPos[i] = (-0.25*mulx_factor/2 - distfromcenter + mulx_factor/2 * ( 0.65 * cos(90+sumangle/2-j*angle)))*cos(actangle)\
								 - (-0.6 + 0.65 * sin(90-sumangle/2+j*angle))*sin(actangle)
				ySpotPos[i] = (-0.25*mulx_factor/2 - distfromcenter + mulx_factor/2 * ( 0.65 * cos(90+sumangle/2-j*angle)))*sin(actangle)\
								 + (-0.6 + 0.65 * sin(90-sumangle/2+j*angle))*cos(actangle)
				zSpotPos[i] = -mount_cover_h-rod_r-0.025
			endif
		next j
		del 2
	next i

	for i = 1 to 3
		if i = 1 then
			rotangle = arm1angle
		else
			if i = 2 then
				rotangle = arm2angle
			else
				rotangle = arm3angle
			endif
		endif
		rotz rotangle
		add -0.25*mulx_factor/2 - distfromcenter, 0, -mount_cover_h-rod_r
		tube 7, 11, 1+2+16+32,
			rod_r,	0,      1,
			0, 0,    900,
			0,    180,   4001,
			-0.008, 0, 1,
			0, 0,    900,
			0,    180,   4001,
			0.008,	0,      1,

			mulx_factor/2*0.307905902447, -0.02755440849082,      0,  0,
			mulx_factor/2*0.25,            0,      0,   0,
			mulx_factor/2*0.189660760887, 0.0217144004925,      0,   0,
			mulx_factor/2*0.1274754878398, 0.0373774391991,      0,   0,
			mulx_factor/2*0.06404945167832, 0.04683666233425,      0,   0,
					   0,         0.05,      0,    0,
			-0.06404945167832*mulx_factor/2, 0.04683666233425,      0,   0,
			-0.1274754878398*mulx_factor/2, 0.0373774391991,      0,    0,
			-0.189660760887*mulx_factor/2, 0.0217144004925,      0,   0,
				   -0.25*mulx_factor/2,            0,      0,   0,
			-0.307905902447*mulx_factor/2, -0.02755440849082,      0,  0
		del 2
	next i

	hotspot 0,0,-mount_cover_h-rod_r,unID,arm1angle,6 : unID=unID+1
	hotspot -1,0,-mount_cover_h-rod_r,unID,arm1angle,4+128 : unID=unID+1
	hotspot 0,0,1,unID,arm1angle,7 : unID=unID+1
	hotspot -(a/2+distfromcenter)*cos(arm1angle),-(a/2+distfromcenter)*sin(arm1angle),-mount_cover_h-rod_r,unID,arm1angle,5 : unID=unID+1

	hotspot 0,0,-mount_cover_h-rod_r,unID,arm2angle,6 : unID=unID+1
	hotspot -1,0,-mount_cover_h-rod_r,unID,arm2angle,4+128 : unID=unID+1
	hotspot 0,0,1,unID,arm2angle,7 : unID=unID+1
	hotspot -(a/2+distfromcenter)*cos(arm2angle),-(a/2+distfromcenter)*sin(arm2angle),-mount_cover_h-rod_r,unID,arm2angle,5 : unID=unID+1

	hotspot 0,0,-mount_cover_h-rod_r,unID,arm3angle,6 : unID=unID+1
	hotspot -1,0,-mount_cover_h-rod_r,unID,arm3angle,4+128 : unID=unID+1
	hotspot 0,0,1,unID,arm3angle,7 : unID=unID+1
	hotspot -(a/2+distfromcenter)*cos(arm3angle),-(a/2+distfromcenter)*sin(arm3angle),-mount_cover_h-rod_r,unID,arm3angle,5 : unID=unID+1

return



! ==============================================================================
"MOUNT_11":
! ==============================================================================

	pen gs_cont_pen
	resol gs_resol
	material matFrame

	for j = 1 to 3

		if j = 1 then
			actangle = 0
			rotangle = 0
		else
			if j = 2 then
				actangle = arm1angle
				rotangle = arm1angle
			else
				actangle = arm2angle
				rotangle = arm2angle
			endif
		endif

		add -a/2+(j=3)*a, 0, -mount_cover_h-rod_r
		rotz rotangle

		roty 90
		cylind a, rod_r
		del 1
		addz -2*rod_r
		cylind 4*rod_r, rod_r
		del 1

		if numSpots/3 > 1 then
			spotdistance = 3*a/(numSpots)
		else
			spotdistance = (a - 0.2)
		endif

		for i = 0 to numSpots/3-1
			add a-(a-spotdistance)/2-spotdistance*i, 0, -0.025
			cylind 0.025, rod_r*0.7
			del 1
			! --- Spot Positions ---
			if numSpots/3 > 1 then
				xSpotPos[j*numSpots/3-1*(i=0)] = -a/2+(j=3)*a + (a-(a-spotdistance)/2-spotdistance*i)*cos(actangle)
				ySpotPos[j*numSpots/3-1*(i=0)] = (a-(a-spotdistance)/2-spotdistance*i)*sin(actangle)
				zSpotPos[j*numSpots/3-1*(i=0)] = -mount_cover_h-rod_r-0.025
			else
				xSpotPos[j] = -a/2+(j=3)*a + (a-(a-spotdistance)/2-spotdistance*i)*cos(actangle)
				ySpotPos[j] = (a-(a-spotdistance)/2-spotdistance*i)*sin(actangle)
				zSpotPos[j] = -mount_cover_h-rod_r-0.025
			endif
		next i

		del 2

	next j

	hotspot -a/2,0,-mount_cover_h-rod_r,unID,arm1angle,6 : unID=unID+1
	hotspot 1,0,-mount_cover_h-rod_r,unID,arm1angle,4+128 : unID=unID+1
	hotspot -a/2,0,1,unID,arm1angle,7 : unID=unID+1
	hotspot -a/2+a*cos(arm1angle),a*sin(arm1angle),-mount_cover_h-rod_r,unID,arm1angle,5 : unID=unID+1

	hotspot a/2,0,-mount_cover_h-rod_r,unID,arm2angle,6 : unID=unID+1
	hotspot 1,0,-mount_cover_h-rod_r,unID,arm2angle,4+128 : unID=unID+1
	hotspot a/2,0,1,unID,arm2angle,7 : unID=unID+1
	hotspot a/2+a*cos(arm2angle),a*sin(arm2angle),-mount_cover_h-rod_r,unID,arm2angle,5 : unID=unID+1

return



! ==============================================================================
"SPOT_1":
! ==============================================================================

	material matSpot
	resol gs_resol

	! --- Rotating Spot ---
	roty -actspotangle_h
	rotx -actspotangle_v
	! ---

	add -0.01,0, 0
	roty 90
	cylind 0.02, rod_r
	del 2

	add 0, -(0.027*mulfactor+rod_r), -0.095*mulfactor
	roty -90
	mul mulfactor, mulfactor, mulfactor
	resol max(5, gs_resol)
	revolve 15, 360, 0,
		0.1312789870359, 0,      1,
		0.10127898703587, 0,    900,
				   0,           90,   4001,
		0.09127898703587,         0.03,      1,
		0.0452,         0.03,      0,
		0.04513451470836,         0.03,      1,
		0.02474596955188, 0.009156591433349,    900,
				   0, 78.34004752286,   4002,
		0.008453261275117, 0.03333691631294,      2,
		0.009272372407262, 0.03209183616466,      1,
		0.02474596955188, 0.009219327536486,    900,
				   0, -79.79636620692,   4001,
		0.04451563138243,       0.0285,      1,
		0.09127898703587,       0.0285,      1,
		0.09127898703587, 0,      1

	material "builtInMatLampBulb"
	revolve 17, 360, 0,
		0.083698075885, 0.01513021326181,      1,
		0.05092660914475, 0.01932587119591,      1,
		0.06171925007727, 0.05697169032439,    900,
				   0, -27.45185654293,   4001,
		0.03478703618703, 0.02854028777153,      1,
		0.00983697446619, 0.00415095519525,    900,
				   0, 13.26417719965,   4001,
		0.02852551269998, 0.03361421472427,      1,
		0.02110164720862, 0.01778329811634,    900,
				   0, 36.46971872436,   4001,
		0.0176618424757, 0.03492679375989,      1,

		0.01934690503435, 0.01782457598995,    900,
				   0, 58.27766723927,   4001,
		0.003913640761104, 0.02538365280854,      1,
		0.07263573805798, 0.001794581029086,    900,
				   0, 20.36023654899,   4001,
				   0,            0,      1

	resol gs_resol

	del 5

return



! ==============================================================================
"SPOT_2":
! ==============================================================================

	material matSpot
	resol gs_resol

	! --- Rotating Spot ---
	roty -actspotangle_h
	rotx -actspotangle_v
	! ---

	add -0.004,0, 0
	roty 90
	cylind 0.008, rod_r
	del 2

	add 0, 0, -0.141*mulfactor-rod_r
	roty -90
	mul mulfactor, mulfactor, mulfactor
	revolve 9, 360, 0,
		0.141, 0,      1,
		0.141,        0.025,      1,
		0.136,        0.025,    900,
				   0,           90,   4001,
		0.1162789870359,         0.03,      1,
				0.05,         0.03,      2,
				0.05,        0.022,      2,
		0.09127898703587,        0.022,      1,
		0.09127898703587, 0,      1

	material "builtInMatLampBulb"
	resol max(6, gs_resol)
	revolve 7, 360, 1+2,
		0.083698075885, 0.02022760063446,      1,
		0.03904713785843, 0.02022760063446,      1,
		0.003986732839524, -0.01386719352435,    900,
				   0, 48.0493554332,   4001,
		0.002067257422846,        0.035,      1,
		0.002067257422846, 0.03698348687027,      1,
		0, 0.03698348687027,      1

	resol gs_resol

	del 5

return



! ==============================================================================
"SPOT_3":
! ==============================================================================

	material matSpot
	resol gs_resol

	! --- Rotating Spot ---
	roty -actspotangle_h
	rotx -actspotangle_v
	! ---

	add -0.01,0, 0
	roty 90
	cylind 0.02, rod_r
	del 2

	add 0, -0.027*mulfactor-rod_r, -0.105*mulfactor
	roty -90
	mul mulfactor, mulfactor, mulfactor
	revolve 8, 360, 0,
		0.1412789870359, 0,      1,
		0.11127898703587, 0,    900,
				   0,           90,   4001,
		0.09127898703587,         0.03,      1,
		0.04,         0.03,      2,

		0.04,       0.0285,      2,
		0.09127898703587,       0.0285,      1,
		0.09127898703587, 0,      1

	material "builtInMatLampBulb"
	addx -0.02
	revolve 17, 360, 1+2,
		0.083698075885, 0.01513021326181,      1,
		0.05092660914475, 0.01932587119591,      1,
		0.06171925007727, 0.05697169032439,    900,
				   0, -27.45185654293,   4001,
		0.03478703618703, 0.02854028777153,      1,
		0.00983697446619, 0.00415095519525,    900,
				   0, 13.26417719965,   4001,
		0.02852551269998, 0.03361421472427,      1,
		0.02110164720862, 0.01778329811634,    900,
				   0, 36.46971872436,   4001,
		0.0176618424757, 0.03492679375989,      1,

		0.01934690503435, 0.01782457598995,    900,
				   0, 58.27766723927,   4001,
		0.003913640761104, 0.02538365280854,      1,
		0.07263573805798, 0.001794581029086,    900,
				   0, 20.36023654899,   4001,
				   0,            0,      1
	del 4

	material matGlassOther
	add 0, -0.027*mulfactor-rod_r, -0.11*mulfactor
	prism_ 3,0.002,
		0,0,979,
		0.04,360,4079,
		0.022,360,4079


	material matSpot
	resol max(12, gs_resol)
	addz 0.066
	rotx 90
	for i = 1 to 2
		prism_ 8,0.001,
			0.0365,       -0.064,      79,
			-0.05876240193442, -0.07816430535879,    979,
			0, 28.69469692565,   4079,
			0.018,        -0.02,      79,
			0.018, -0.02791549391489,      79,
			-0.05876240193442, -0.07816430535879,    979,
			0, -24.32768324976,   4079,
			0.03188406438374,       -0.064,      79
		mulx -1
	next i
	del 7

	resol gs_resol

return



! ==============================================================================
"SPOT_4":
! ==============================================================================

	material matSpot
	resol gs_resol

	! --- Rotating Spot ---
	roty -actspotangle_h
	rotx -actspotangle_v
	! ---

	add -0.01,0, 0
	roty 90
	cylind 0.02, rod_r
	del 2

	add 0, -0.027*mulfactor-rod_r, -0.105*mulfactor
	roty -90
	mul mulfactor, mulfactor, mulfactor
	revolve 7, 360, 0,
		0.1412789870359, 0,      1,
		0.09127893575688, -0.02644478847619,    900,
		0.09127898703587,         0.03,   3001,
		0.04,         0.03,      2,

		0.04,       0.0285,      2,
		0.09127898703587,       0.0285,      1,
		0.09127898703587, 0,      1

	material "builtInMatLampBulb"
	addx -0.02
	revolve 17, 360, 1+2,
		0.083698075885, 0.01513021326181,      1,
		0.05092660914475, 0.01932587119591,      1,
		0.06171925007727, 0.05697169032439,    900,
				   0, -27.45185654293,   4001,
		0.03478703618703, 0.02854028777153,      1,
		0.00983697446619, 0.00415095519525,    900,
				   0, 13.26417719965,   4001,
		0.02852551269998, 0.03361421472427,      1,
		0.02110164720862, 0.01778329811634,    900,
				   0, 36.46971872436,   4001,
		0.0176618424757, 0.03492679375989,      1,

		0.01934690503435, 0.01782457598995,    900,
				   0, 58.27766723927,   4001,
		0.003913640761104, 0.02538365280854,      1,
		0.07263573805798, 0.001794581029086,    900,
				   0, 20.36023654899,   4001,
				   0,            0,      1
	del 1

	del 3

	material matGlassOther
	add 0, -0.027*mulfactor-rod_r, -0.11*mulfactor
	prism_ 3,0.002,
		0,0,979,
		0.04,360,4079,
		0.027,360,4079


	material matSpot
	resol max(12, gs_resol)
	addz 0.066
	rotx 90
	for i = 1 to 2
		prism_ 8,0.001,
			0.0365,       -0.064,      79,
			-0.05876240193442, -0.07816430535879,    979,
			0, 28.69469692565,   4079,
			0.018,        -0.02,      79,
			0.018, -0.02791549391489,      79,
			-0.05876240193442, -0.07816430535879,    979,
			0, -24.32768324976,   4079,
			0.03188406438374,       -0.064,      79
		mulx -1
	next i
	del 7

	resol gs_resol

return



! ==============================================================================
"SPOT_5":
! ==============================================================================

	material matSpot
	resol gs_resol

	! --- Rotating Spot ---
	roty -actspotangle_h
	rotx -actspotangle_v
	! ---

	add -0.004,0, 0
	roty 90
	cylind 0.008, rod_r
	del 2

	mul mulfactor, mulfactor, mulfactor
	add 0, 0, -0.071-rod_r
	roty -90
	revolve 9, 360, 0,
		0.071, 0,      1,
		0.071,        0.02,      1,
		0.066,        0.02,    900,
				   0,           90,   4001,
		0.0462789870359,         0.025,      1,
				0,         0.025,      2,
				0,        0.02,      2,
		0.06127898703587,        0.02,      0,
		0.06127898703587, 0,      0

	material matGlassOther
	resol max(6, gs_resol)
	addx 0.099
	revolve 9, 360, 1+2+4,
		-0.1757633178398, 0.01959752703264,      1,
		-0.1364107391566, 0,    901,
				   0, -119.7736458091,   4001,
		-0.09985870669309, 0.02442616297322,      1,
			  -0.099,        0.025,      1,
		-0.1364107391566, 0,    900,
				   0, 119.7736458091,   4000,
		-0.1766878169833, 0.02005792626345,      2,
		-0.1757633178398, 0.01959752703264,      2
	del 1

	material "builtInMatLampBulb"
	addx -0.06
	revolve 17, 360, 1+2,
		0.083698075885, 0.01513021326181,      1,
		0.05092660914475, 0.01932587119591,      1,
		0.06171925007727, 0.05697169032439,    900,
				   0, -27.45185654293,   4001,
		0.03478703618703, 0.02854028777153,      1,
		0.00983697446619, 0.00415095519525,    900,
				   0, 13.26417719965,   4001,
		0.02852551269998, 0.03361421472427,      1,
		0.02110164720862, 0.01778329811634,    900,
				   0, 36.46971872436,   4001,
		0.0176618424757, 0.03492679375989,      1,

		0.01934690503435, 0.01782457598995,    900,
				   0, 58.27766723927,   4001,
		0.003913640761104, 0.02538365280854,      1,
		0.07263573805798, 0.001794581029086,    900,
				   0, 20.36023654899,   4001,
				   0,            0,      1
	del 6

	resol gs_resol

return



! ==============================================================================
"SPOT_6":
! ==============================================================================

	material matSpot
	resol gs_resol

	! --- Rotating Spot ---
	roty -actspotangle_h
	rotx -actspotangle_v
	! ---

	add -0.01,0, 0
	roty 90
	cylind 0.02, rod_r
	del 2

	add 0, -0.027*mulfactor-rod_r, -0.105*mulfactor
	roty -90
	mul mulfactor, mulfactor, mulfactor
	revolve 8, 360, 0,
		0.1412789870359, 0,      1,
		0.11127898703587, 0,    900,
				   0,           90,   4001,
		0.09127898703587,         0.03,      1,
		0.05,         0.03,      2,

		0.05,       0.0285,      2,
		0.09127898703587,       0.0285,      1,
		0.09127898703587, 0,      1

	material "builtInMatLampBulb"
	addx -0.03
	resol max(6, gs_resol)
	revolve 17, 360, 1+2,
		0.083698075885, 0.01513021326181,      1,
		0.05092660914475, 0.01932587119591,      1,
		0.06171925007727, 0.05697169032439,    900,
				   0, -27.45185654293,   4001,
		0.03478703618703, 0.02854028777153,      1,
		0.00983697446619, 0.00415095519525,    900,
				   0, 13.26417719965,   4001,
		0.02852551269998, 0.03361421472427,      1,
		0.02110164720862, 0.01778329811634,    900,
				   0, 36.46971872436,   4001,
		0.0176618424757, 0.03492679375989,      1,

		0.01934690503435, 0.01782457598995,    900,
				   0, 58.27766723927,   4001,
		0.003913640761104, 0.02538365280854,      1,
		0.07263573805798, 0.001794581029086,    900,
				   0, 20.36023654899,   4001,
				   0,            0,      1
	del 4

	material matGlassOther
	resol max(12, gs_resol)
	mulz 1.3
	add  0, -0.027*mulfactor-rod_r, 0.0077
	roty -90
	revolve 9, 360, 1+2,
		-0.07437399984236, 0.03447253801994,     1,
		-0.08205572702309, -0.03916116653087,    901,
				   0, -34.68044773763,   4001,
		-0.03384124956813, 0.01701975142264,      1,
		-0.03299999999982, 0.01800000000087,      1,
		-0.08205572702309, -0.03916116653087,    901,
				   0, 34.78294203629,   4001,
		-0.07437399984236, 0.0357711654799,      2,
		-0.07437399984236, 0.03447253801994,      2
	del 5

	resol gs_resol

return



! ==============================================================================
"SPOT_7":
! ==============================================================================

	material matSpot
	resol gs_resol

	! --- Rotating Spot ---
	roty -actspotangle_h
	rotx -actspotangle_v
	! ---

	add -0.01,0, 0
	roty 90
	cylind 0.02, rod_r
	del 2

	mul mulfactor, mulfactor , mulfactor
	add 0, -0.0245, 0
	roty -90
	revolve 6, 360, 0,
		0.02176739222122, 0,      1,
		0.02176739222122,        0.012,      1,
		-0.033,         0.02,      2,
		-0.033, 0.018,      2,
		 0, 0.01198725841643,      1,
		 0,            0,      1
	del 2

	material "builtInMatLampBulb"
	resol max(6, gs_resol)
	add 0, -0.0245, -0.1164
	roty -90
	mul 1, 0.8, 0.8
	revolve 17, 360, 1+2,
		0.083698075885, 0.01513021326181,      1,
		0.05092660914475, 0.01932587119591,      1,
		0.06171925007727, 0.05697169032439,    900,
				   0, -27.45185654293,   4001,
		0.03478703618703, 0.02854028777153,      1,
		0.00983697446619, 0.00415095519525,    900,
				   0, 13.26417719965,   4001,
		0.02852551269998, 0.03361421472427,      1,
		0.02110164720862, 0.01778329811634,    900,
				   0, 36.46971872436,   4001,
		0.0176618424757, 0.03492679375989,      1,

		0.01934690503435, 0.01782457598995,    900,
				   0, 58.27766723927,   4001,
		0.003913640761104, 0.02538365280854,      1,
		0.07263573805798, 0.001794581029086,    900,
				   0, 20.36023654899,   4001,
				   0,            0,      1
	del 3

	material matGlassOther
	resol max(12, gs_resol)
	add 0, -0.0245, 0
	roty -90
	revolve 9, 360, 1+2,
		-0.1274164615516, 0.03335664204351,      1,
		-0.0986322316228, -0.09138675536673,    900,
				   0, -43.50123273111,   4001,
		-0.03364151280668, 0.0189112661831,      1,
		-0.03300000000014,         0.02,      1,
		-0.0986322316228, -0.09138675536673,    900,
				   0, 43.50123273111,   4001,
		-0.1277005859999, 0.03458796381417,      2,
		-0.1274164615516, 0.03335664204351,      2
	del 5

	resol gs_resol

return



! ==============================================================================
"SPOT_8":
! ==============================================================================

	material matSpot
	resol gs_resol

	! --- Rotating Spot ---
	roty -actspotangle_h
	rotx -actspotangle_v
	! ---

	add -0.01,0, 0
	roty 90
	cylind 0.02, rod_r
	del 2

	add 0, -0.0245, 0
	roty -90
	revolve 8, 360, 0,
		0.0185, 0,      1,
		0.0185,        0.017,      1,
		-0.03,         0.017,      2,
		-0.03,         0.025,      2,
		-0.032,         0.025,      2,
		-0.032,         0.015,      2,
		 0, 0.015,      1,
		 0,            0,      1
	del 2

	material "builtInMatLampBulb"
	resol max(6, gs_resol)
	add 0, -0.0245, -0.098
	roty -90
	mul mulfactor, mulfactor, mulfactor
	revolve 17, 360, 1+2,
		0.083698075885, 0.01513021326181,      1,
		0.05092660914475, 0.01932587119591,      1,
		0.06171925007727, 0.05697169032439,    900,
				   0, -27.45185654293,   4001,
		0.03478703618703, 0.02854028777153,      1,
		0.00983697446619, 0.00415095519525,    900,
				   0, 13.26417719965,   4001,
		0.02852551269998, 0.03361421472427,      1,
		0.02110164720862, 0.01778329811634,    900,
				   0, 36.46971872436,   4001,
		0.0176618424757, 0.03492679375989,      1,

		0.01934690503435, 0.01782457598995,    900,
				   0, 58.27766723927,   4001,
		0.003913640761104, 0.02538365280854,      1,
		0.07263573805798, 0.001794581029086,    900,
				   0, 20.36023654899,   4001,
				   0,            0,      1
	del 3

	material matGlassOther
	resol gs_resol
	add 0, -0.0245, -0.052
	roty -90
	revolve 5, 360, 1+2,
		0.02176739222122,        0.027,      2,
		-0.053,         0.038,      2,
		-0.053, 0.036,      2,
		0.02176739222122,        0.025,      2,
		0.02176739222122,        0.027,      2
	del 4

	resol gs_resol

return



! ==============================================================================
"SPOT_9":
! ==============================================================================

	material matSpot
	resol gs_resol

	! --- Rotating Spot ---
	roty -actspotangle_h
	rotx -actspotangle_v
	! ---

	add -0.01,0, 0
	roty 90
	cylind 0.02, rod_r
	del 2

	add 0, -0.0245, 0
	roty -90
	revolve 8, 360, 0,
		0.02176739222122, 0,      1,
		0.02176739222122,        0.017,      1,
		-0.03,         0.017,      2,
		-0.03,         0.03,      2,
		-0.032,         0.03,      2,
		-0.032,         0.015,      2,
		 0, 0.015,      1,
		 0,            0,      1
	del 2

	material "builtInMatLampBulb"
	resol max(6, gs_resol)
	add 0, -0.0245, -0.098
	roty -90
	mul mulfactor, mulfactor, mulfactor
	revolve 17, 360, 1+2,
		0.083698075885, 0.01513021326181,      1,
		0.05092660914475, 0.01932587119591,      1,
		0.06171925007727, 0.05697169032439,    900,
				   0, -27.45185654293,   4001,
		0.03478703618703, 0.02854028777153,      1,
		0.00983697446619, 0.00415095519525,    900,
				   0, 13.26417719965,   4001,
		0.02852551269998, 0.03361421472427,      1,
		0.02110164720862, 0.01778329811634,    900,
				   0, 36.46971872436,   4001,
		0.0176618424757, 0.03492679375989,      1,

		0.01934690503435, 0.01782457598995,    900,
				   0, 58.27766723927,   4001,
		0.003913640761104, 0.02538365280854,      1,
		0.07263573805798, 0.001794581029086,    900,
				   0, 20.36023654899,   4001,
				   0,            0,      1
	del 3

	material matGlassOther
	resol gs_resol
	add 0, -0.0245, -0.052
	roty -90
	revolve 5, 360, 1+2,
		0.03,        0.032,      2,
		-0.053,         0.032,      2,
		-0.053, 0.03,      2,
		0.03,        0.03,      2,
		0.03,        0.032,      2
	del 4

	resol gs_resol

return



! ==============================================================================
"LIGHTCONE":
! ==============================================================================

	! --- Rotating Spot ---
	roty -actspotangle_h
	rotx -actspotangle_v
	! ---

	add 0, -axisdist, -ligthdist
	roty 90

	if gs_light_switch=1 then

		DIM colorRGB[3]
		colorRGB[1] = gs_color_red
		colorRGB[2] = gs_color_green
		colorRGB[3] = gs_color_blue


		lightUnID = actsp * 1000

		! ======================================================================
		! Non Visible Omni Light
		! ======================================================================

		call	"lightMacro_m" parameters		gs_light_switch						= gs_light_switch,
												gs_color_red						= gs_color_red,
												gs_color_green						= gs_color_green,
												gs_color_blue						= gs_color_blue,
												gs_light_intensity						= gs_light_intensity,
												iColorPreset			= iColorPreset,
												iLightGroupType			= LIGHTGROUP_BUILTIN_OMNI,
												iC4dDetAreaShape		= AREASHAPE_SPHERE,
												c4dDetAreaX				= 0.03,
												c4dDetAreaY				= 0.03,
												c4dDetAreaZ				= 0.03,
												bGenShadow				= bGenShadow,
												iShadowQuality			= iShadowQuality,
												iShadowQualityGroupType	= 3,
												iC4dGenVisibility		= 1,
												bDetShowFalloff 		= 1,
												iFalloffType			= FALLOFFTYPE_OMNI,
												c4dDetRadius			= c4dDetRadius,
												c4dPhoPhotometric		= c4dPhoPhotometric,
												iC4dPhoUnit				= iC4dPhoUnit,
												photoIntensityLumen		= photoIntensityLumen,
												photoIntensityCandela	= photoIntensityCandela,
												bShowIllumination3D		= 0,
												gs_resol				= gs_resol,
												gs_cont_pen				= gs_cont_pen,
												penIllumination			= penIllumination,
												lightUnID				= lightUnID

	endif

	del 4

return


"FakeIllumination":
	addz _avgDistZ - 0.05

	call "lightMacro_m" parameters		iLightGroupType		= LIGHTGROUP_BUILTIN_FALLOFF,
										iFalloffType		= FALLOFFTYPE_OMNI,
										c4dDetAreaX			= 0.1,
										c4dDetAreaY			= 0.1,
										c4dDetRadius		= c4dDetRadius,
										c4dDetFalloffAngle	= 90,
										c4dPhoPhotometric	= c4dPhoPhotometric,
										bShowIllumination3D	= bShowIllumination3D,
										penIllumination		= penIllumination,
										iModelType			= 1,
										gs_resol			= gs_resol,
										lightUnID			= unID + 1000

	del 1

return

