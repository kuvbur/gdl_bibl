

	! ======================================================================
	! Lamp Bulb Surface
	! ======================================================================
	
	DIM	tmp_C4D_ChCol_Color[3]
		tmp_C4D_ChCol_Color[1] = 0.7843137254902
		tmp_C4D_ChCol_Color[2] = 0.7843137254902
		tmp_C4D_ChCol_Color[3] = 0.8039215686275
	DIM	tmp_C4D_ShNoise_Color1_1[3]
		tmp_C4D_ShNoise_Color1_1[1] = 0
		tmp_C4D_ShNoise_Color1_1[2] = 0
		tmp_C4D_ShNoise_Color1_1[3] = 0
	DIM	tmp_C4D_ShNoise_Color2_1[3]
		tmp_C4D_ShNoise_Color2_1[1] = 1
		tmp_C4D_ShNoise_Color2_1[2] = 1
		tmp_C4D_ShNoise_Color2_1[3] = 1
	DIM	tmp_C4D_ShNoise_RelativeScale_1[3]
		tmp_C4D_ShNoise_RelativeScale_1[1] = 1
		tmp_C4D_ShNoise_RelativeScale_1[2] = 1
		tmp_C4D_ShNoise_RelativeScale_1[3] = 1
	DIM	tmp_C4D_ChLum_Color[3]
		tmp_C4D_ChLum_Color[1] = 1
		tmp_C4D_ChLum_Color[2] = 1
		tmp_C4D_ChLum_Color[3] = 1
	DIM	tmp_C4D_ChTra_Color[3]
		tmp_C4D_ChTra_Color[1] = 0.9411764705882
		tmp_C4D_ChTra_Color[2] = 0.9411764705882
		tmp_C4D_ChTra_Color[3] = 0.9411764705882
	DIM	tmp_C4D_ChTra_AbsorptionColor[3]
		tmp_C4D_ChTra_AbsorptionColor[1] = 1
		tmp_C4D_ChTra_AbsorptionColor[2] = 1
		tmp_C4D_ChTra_AbsorptionColor[3] = 1
	DIM	tmp_C4D_ChRef_Color[3]
		tmp_C4D_ChRef_Color[1] = 1
		tmp_C4D_ChRef_Color[2] = 1
		tmp_C4D_ChRef_Color[3] = 1
	DIM	tmp_C4D_ChEnv_Color[3]
		tmp_C4D_ChEnv_Color[1] = 1
		tmp_C4D_ChEnv_Color[2] = 1
		tmp_C4D_ChEnv_Color[3] = 1
	DIM	tmp_C4D_ChFog_Color[3]
		tmp_C4D_ChFog_Color[1] = 1
		tmp_C4D_ChFog_Color[2] = 1
		tmp_C4D_ChFog_Color[3] = 1
	DIM	tmp_C4D_ChAlp_Color[3]
		tmp_C4D_ChAlp_Color[1] = 1
		tmp_C4D_ChAlp_Color[2] = 1
		tmp_C4D_ChAlp_Color[3] = 1
	DIM	tmp_C4D_ChAlp_Delta[3]
		tmp_C4D_ChAlp_Delta[1] = 0.1
		tmp_C4D_ChAlp_Delta[2] = 0.1
		tmp_C4D_ChAlp_Delta[3] = 0.1
	DIM	tmp_C4D_ChSpe_Color[3]
		tmp_C4D_ChSpe_Color[1] = 1
		tmp_C4D_ChSpe_Color[2] = 1
		tmp_C4D_ChSpe_Color[3] = 1
	DIM	tmp_C4D_ChGlo_Color[3]
		tmp_C4D_ChGlo_Color[1] = 1
		tmp_C4D_ChGlo_Color[2] = 1
		tmp_C4D_ChGlo_Color[3] = 1
	DIM	tmp_C4D_GKRGB_Color_3[3]
		tmp_C4D_GKRGB_Color_3[1] = 0
		tmp_C4D_GKRGB_Color_3[2] = 0
		tmp_C4D_GKRGB_Color_3[3] = 0
	DIM	tmp_C4D_GKRGB_Color_4[3]
		tmp_C4D_GKRGB_Color_4[1] = 1
		tmp_C4D_GKRGB_Color_4[2] = 1
		tmp_C4D_GKRGB_Color_4[3] = 1
	
	define material	"builtInMatLampBulb" 0,
		0.941176, 0.968627, 0.952941,
		0.8, 0.1, 1, 0.88,
		79.52, 0.04,
		1, 1, 1,
		0, 0, 0, 0,
	ADDITIONAL_DATA		C4D_VER_MAIN= 1,
	C4D_VER_SUB						= 0,
	C4D_ChCol_State					= 1,
	C4D_ChCol_Color					= tmp_C4D_ChCol_Color,
	C4D_ChCol_Brightness			= 1,
	C4D_ChCol_MixMode				= "Normal",
	C4D_ChCol_MixStrength			= 1,
	C4D_ChDif_State					= 0,
	C4D_ChDif_Brightness			= 1,
	C4D_ChDif_Luminance				= 1,
	C4D_ChDif_Specular				= 1,
	C4D_ChDif_Reflection			= 1,
	C4D_ChDif_Texture				= "1",
	C4D_ShNoise_BlendMode_1			= "Normal",
	C4D_ShNoise_BlendStre_1			= 1,
	C4D_ShNoise_BlurOffset_1		= 0,
	C4D_ShNoise_BlurScale_1			= 0,
	C4D_ShNoise_Color1_1			= tmp_C4D_ShNoise_Color1_1,
	C4D_ShNoise_Color2_1			= tmp_C4D_ShNoise_Color2_1,
	C4D_ShNoise_Seed_1				= 665,
	C4D_ShNoise_Noise_1				= "Turbulence",
	C4D_ShNoise_Octaves_1			= 5,
	C4D_ShNoise_Space_1				= "Texture",
	C4D_ShNoise_GlobalScale_1		= 0.01,
	C4D_ShNoise_RelativeScale_1		= tmp_C4D_ShNoise_RelativeScale_1,
	C4D_ShNoise_Absolute_1			= 0,
	C4D_ShNoise_Cycles_1			= 0,
	C4D_ShNoise_LowClip_1			= 0,
	C4D_ShNoise_HighClip_1			= 1,
	C4D_ShNoise_Brightness_1		= 0,
	C4D_ShNoise_Contrast_1			= 0,
	C4D_ChDif_MixMode				= "Normal",
	C4D_ChDif_MixStrength			= 0.1,
	C4D_ChLum_State					= 0,
	C4D_ChLum_Color					= tmp_C4D_ChLum_Color,
	C4D_ChLum_Brightness			= 1,
	C4D_ChLum_MixMode				= "Normal",
	C4D_ChLum_MixStrength			= 1,
	C4D_ChTra_State					= 1,
	C4D_ChTra_Color					= tmp_C4D_ChTra_Color,
	C4D_ChTra_Brightness			= 0.95,
	C4D_ChTra_Refraction			= 1,
	C4D_ChTra_InternalReflections	= 1,
	C4D_ChTra_ExitReflection		= 0,
	C4D_ChTra_FresnelReflectivity	= 0.5,
	C4D_ChTra_Additive				= 0,
	C4D_ChTra_MixMode				= "Normal",
	C4D_ChTra_MixStrength			= 1,
	C4D_ChTra_AbsorptionColor		= tmp_C4D_ChTra_AbsorptionColor,
	C4D_ChTra_AbsorptionDistance	= 100,
	C4D_ChTra_Blurriness			= 0,
	C4D_ChTra_MinSamples			= 10,
	C4D_ChTra_MaxSamples			= 80,
	C4D_ChTra_Accuracy				= 0.5,
	C4D_ChRef_State					= 1,
	C4D_ChRef_Color					= tmp_C4D_ChRef_Color,
	C4D_ChRef_Brightness			= 0.1,
	C4D_ChRef_Additive				= 1,
	C4D_ChRef_MixMode				= "Normal",
	C4D_ChRef_MixStrength			= 1,
	C4D_ChRef_Blurriness			= 0,
	C4D_ChRef_MinSamples			= 5,
	C4D_ChRef_MaxSamples			= 128,
	C4D_ChRef_Accuracy				= 0.5,
	C4D_ChEnv_State					= 0,
	C4D_ChEnv_Color					= tmp_C4D_ChEnv_Color,
	C4D_ChEnv_Brightness			= 1,
	C4D_ChEnv_MixMode				= "Normal",
	C4D_ChEnv_MixStrength			= 1,
	C4D_ChEnv_TilesX				= 1,
	C4D_ChEnv_TilesY				= 1,
	C4D_ChEnv_Exclusive				= 0,
	C4D_ChFog_State					= 0,
	C4D_ChFog_Color					= tmp_C4D_ChFog_Color,
	C4D_ChFog_Brightness			= 1,
	C4D_ChFog_Distance				= 10,
	C4D_ChBum_State					= 0,
	C4D_ChBum_Strength				= 1,
	C4D_ChBum_MipFalloff			= 1,
	C4D_ChNor_State					= 0,
	C4D_ChNor_Strength				= 1,
	C4D_ChNor_Method				= "Tangent",
	C4D_ChNor_FlipX					= 0,
	C4D_ChNor_FlipY					= 0,
	C4D_ChNor_FlipZ					= 0,
	C4D_ChNor_SwapYZ				= 0,
	C4D_ChAlp_State					= 0,
	C4D_ChAlp_Color					= tmp_C4D_ChAlp_Color,
	C4D_ChAlp_Delta					= tmp_C4D_ChAlp_Delta,
	C4D_ChAlp_Invert				= 0,
	C4D_ChAlp_Soft					= 1,
	C4D_ChAlp_ImageAlpha			= 0,
	C4D_ChAlp_PreMultiplied			= 0,
	C4D_ChSpe_State					= 1,
	C4D_ChSpe_Color					= tmp_C4D_ChSpe_Color,
	C4D_ChSpe_Brightness			= 1,
	C4D_ChSpe_MixMode				= "Normal",
	C4D_ChSpe_MixStrength			= 1,
	C4D_ChSpe_Mode					= "Plastic",
	C4D_ChSpe_Width					= 0.45,
	C4D_ChSpe_Height				= 0.5,
	C4D_ChSpe_Falloff				= -0.05,
	C4D_ChSpe_InnerWidth			= 0,
	C4D_ChGlo_State					= 0,
	C4D_ChGlo_Color					= tmp_C4D_ChGlo_Color,
	C4D_ChGlo_Brightness			= 1,
	C4D_ChGlo_InnerStrength			= 1,
	C4D_ChGlo_OuterStrength			= 5,
	C4D_ChGlo_Radius				= 10,
	C4D_ChGlo_Random				= 0,
	C4D_ChGlo_Frequency				= 1,
	C4D_ChGlo_UseMatColor			= 1,
	C4D_ChDis_State					= 0,
	C4D_ChDis_Strength				= 1,
	C4D_ChDis_Height				= 0.5,
	C4D_ChDis_Type					= "IntensityCentered",
	C4D_ChDis_SubDivision			= 0,
	C4D_ChDis_Level					= 4,
	C4D_ChDis_RoundGeometry			= 0,
	C4D_ChDis_RoundContour			= 1,
	C4D_ChDis_MapRounded			= 1,
	C4D_ChDis_MapResult				= 0,
	C4D_ChDis_KeepEdges				= 0,
	C4D_ChDis_BestDistribution		= 1,
	C4D_ChGra_State					= 0,
	C4D_ChGra_Color					= "2",
	C4D_GradientRGB_Interpol_2		= "SmoothKnot",
	C4D_GradientRGB_Knots_2			= "3,4",
	C4D_GKRGB_Color_3				= tmp_C4D_GKRGB_Color_3,
	C4D_GKRGB_Intensity_3			= 1,
	C4D_GKRGB_Position_3			= 0,
	C4D_GKRGB_Bias_3				= 0.5,
	C4D_GKRGB_Color_4				= tmp_C4D_GKRGB_Color_4,
	C4D_GKRGB_Intensity_4			= 1,
	C4D_GKRGB_Position_4			= 1,
	C4D_GKRGB_Bias_4				= 0.5,
	C4D_ChGra_MixStrength			= 0.5,
	C4D_ChGra_Density				= 1,
	C4D_ChGra_Length				= 0.1,
	C4D_ChGra_Width					= 0.005,
	C4D_ChGra_Crinkle				= 0.1,
	C4D_ChGra_Bend					= 0.6,
	C4D_ChGra_Wetness				= 0.05,
	C4D_ChIll_GenerateGI			= 1,
	C4D_ChIll_GenGIStrength			= 1,
	C4D_ChIll_GenGISaturat			= 1,
	C4D_ChIll_ReceiveGI				= 1,
	C4D_ChIll_RecGIStrength			= 1,
	C4D_ChIll_RecGISaturat			= 1,
	C4D_ChIll_GIPortal				= 0,
	C4D_ChIll_GILight				= 0,
	C4D_ChIll_GenerateCaustics		= 1,
	C4D_ChIll_GenCausticsStrength	= 1,
	C4D_ChIll_ReceiveCaustics		= 1,
	C4D_ChIll_RecCausticsStrength	= 1,
	C4D_ChIll_Radius				= 0.1,
	C4D_ChIll_CausticsSamples		= 100,
	C4D_ChIll_Model					= "Blinn",
	C4D_ChIll_DiffuseFalloff		= 0,
	C4D_ChIll_DiffuseLevel			= 1,
	C4D_ChIll_Roughness				= 0.5
	
	
if gs_detlevel_3D_m=0 then end
if gs_detlevel_3D_m=1 then gs_resol=6

if GLOB_CONTEXT > 20 & GLOB_CONTEXT < 40 then gs_resol = 12

if not(gs_shadow) then shadow off

if iShadeType = 1 or iShadeType = 11 then
	rotz -90
	if bMigrationRotZ then
		if (GLOB_CONTEXT <> 2 & GLOB_CONTEXT <> 5) then
			rotz 90
		endif
	endif
endif

! ==============================================================================
!	Hotspot Editing
! ==============================================================================

unID=1

hotspot	0,0,0,unID : unID=unID+1

rotangle_x = 0
rotangle_y = 0
walldistance = 0

if iShadeType = 1 then
	walldistance = -(a-a2)
	rotangle_x = 0
	rotangle_y = -90
endif
if iShadeType = 2 then
	walldistance = -b/3-0.0236
	rotangle_x = -90
endif
if iShadeType = 3 or iShadeType = 5  or iShadeType = 6 or iShadeType = 7 or iShadeType = 8 or \
	iShadeType = 9 or iShadeType = 10 or iShadeType = 12 then
	walldistance = 0
	rotangle_x = -90
endif
if iShadeType = 4 then
	shader_r = a*1.8
	walldistance = -(shader_r - sqr(shader_r*shader_r - a/2*a/2))
	rotangle_x = -90
endif

if iShadeType = 10 then
	hotspot	0,0,0,unID,ZZYZX,1+256 : unID=unID+1
	hotspot	0,0,-1,unID,ZZYZX,3 : unID=unID+1
	hotspot	0,0,ZZYZX,unID,ZZYZX,2 : unID=unID+1

	hotspot	0,0,ZZYZX,unID,a2,1+256 : unID=unID+1
	hotspot	-1,0,ZZYZX,unID,a2,3 : unID=unID+1
	hotspot	a2,0,ZZYZX,unID,a2,2 : unID=unID+1

	hotspot	0,0,ZZYZX,unID,a2,1+256 : unID=unID+1
	hotspot	1,0,ZZYZX,unID,a2,3 : unID=unID+1
	hotspot	-a2,0,ZZYZX,unID,a2,2 : unID=unID+1

	hotspot	0,0,ZZYZX,unID,b,1+256 : unID=unID+1
	hotspot	0,1,ZZYZX,unID,b,3 : unID=unID+1
	hotspot	0,-b,ZZYZX,unID,b,2 : unID=unID+1
endif

if iShadeType = 12 or iShadeType = 9 then
	numhotsp = 2
	rotangle_z = 180
else
	numhotsp = 4
	rotangle_z = 90
endif

if iShadeType <> 1 and iShadeType <> 10 and iShadeType <> 11 and iShadeType <> 13 and iShadeType <> 14 then
	rotx rotangle_x
	roty rotangle_y
	for i=1 to numhotsp
		hotspot	0, 0, walldistance,unID,A2,1+128 : unID=unID+1
		hotspot	-1, 0, walldistance,unID,A2,3 : unID=unID+1
		hotspot	A2, 0, walldistance,unID,A2,2 : unID=unID+1
		rotz rotangle_z
	next i
	del numhotsp
	del 2
endif

if iShadeType > 1 and iShadeType < 9 then
	hotspot 0, 0, 0,	unID,B,1+128: unID=unID+1
	hotspot 0, 1, 0,	unID,B,3	: unID=unID+1
	hotspot 0, -B, 0,	unID,B,2 	: unID=unID+1
endif

if iShadeType = 9 then
	for i=1 to 2
		hotspot 0,	0,	0,	unID,	B2,	1+128 	: unID=unID+1
		hotspot 0,	0,	-1,	unID,	B2,	3 		: unID=unID+1
		hotspot 0,	0,	B2,	unID,	B2,	2 		: unID=unID+1
		rotz 180
	next i
	del 2
endif

if iShadeType = 13 then
	rotz -90 * not(bMigrationRotZ)

	hotspot 0,	0,	0,	unID			: unID = unID + 1
	hotspot 0,	A,	A,	unID			: unID = unID + 1
	hotspot 0,	-A,	A,	unID			: unID = unID + 1

	hotspot 0,	0,	A,	unID, A, 1+128	: unID = unID + 1
	hotspot A,	0,	A,	unID, A, 2		: unID = unID + 1
	hotspot -1,	0,	A,	unID, A, 3		: unID = unID + 1

	del not(bMigrationRotZ)
endif

if iShadeType = 14 then
	rotz -90 * not(bMigrationRotZ)

	hotspot 0,		0,		0,		unID						: unID = unID = unID + 1

	hotspot 0,		0,		0,		unID, ZZYZX,	1+128		: unID = unID = unID + 1
	hotspot 0,		0,		ZZYZX,	unID, ZZYZX,	2			: unID = unID = unID + 1
	hotspot 0,		0,		-1,		unID, ZZYZX,	3			: unID = unID = unID + 1

	hotspot 0,		0,		ZZYZX,	unID, B2,		1+256,	B	: unID = unID = unID + 1
	hotspot 0,		B2,		ZZYZX,	unID, B2,		2,		B	: unID = unID = unID + 1
	hotspot 0,		-1,		ZZYZX,	unID, B2,		3,		B	: unID = unID = unID + 1

	hotspot 0,		0,		ZZYZX,	unID, B2,		1+256,	B	: unID = unID = unID + 1
	hotspot 0,		-B2,	ZZYZX,	unID, B2,		2,		B	: unID = unID = unID + 1
	hotspot 0,		1,		ZZYZX,	unID, B2,		3,		B	: unID = unID = unID + 1

	hotspot 0,		0,		ZZYZX,	unID, A,		1+128		: unID = unID = unID + 1
	hotspot A,		0,		ZZYZX,	unID, A,		2			: unID = unID = unID + 1
	hotspot -1,		0,		ZZYZX,	unID, A,		3			: unID = unID = unID + 1

	del not(bMigrationRotZ)
endif


! ==============================================================================
!	Shadow Qualtity Groups
! ==============================================================================

if iShadeType = 11 | iShadeType = 12 then
	_iShadowQualityGroupType	= 3
else
	_iShadowQualityGroupType	= 2
endif


! ==============================================================================
!	Shade 3D
! ==============================================================================

if iShadeType = 1 then
	gosub "SHADE_1"
endif
if iShadeType = 2 then
	gosub "SHADE_2"
endif
if iShadeType = 3 then
	gosub "SHADE_3"
endif
if iShadeType = 4 then
	gosub "SHADE_4"
endif
if iShadeType = 5 then
	gosub "SHADE_5"
endif
if iShadeType = 6 then
	gosub "SHADE_6"
endif
if iShadeType = 7 then
	gosub "SHADE_7"
endif
if iShadeType = 8 then
	gosub "SHADE_8"
endif
if iShadeType = 9 then
	gosub "SHADE_9"
endif
if iShadeType = 10 then
	gosub "SHADE_10"
endif
if iShadeType = 11 then
	gosub "SHADE_11"
endif
if iShadeType = 12 then
	gosub "SHADE_12"
endif
if iShadeType = 13 then
	gosub "SHADE_13"
endif
if iShadeType = 14 then
	gosub "SHADE_14"
endif


! ==============================================================================
if iShadeType = 1 or iShadeType = 11 then
	del 1
	if bMigrationRotZ then
		if (GLOB_CONTEXT <> 2 & GLOB_CONTEXT <> 5) then
			del 1
		endif
	endif
endif

end

! ==============================================================================
!	Shade Type 1
! ==============================================================================

"SHADE_1":

	pen gs_cont_pen
	material matFrame
	resol gs_resol

	roty 90

	cylind 0.04, 0.085

	material matLamp

	addz A-A2
	sphere A/2
	del 1

	if bLight then 
		addz 0.07
		gosub "C4D_lightOMNI"
		del 1	
	endif
	del 1

return


! ==============================================================================
!	Shade Type 2
! ==============================================================================

"SHADE_2":

	pen gs_cont_pen
	resol gs_resol
	material matFrame

	hb=b/3      !Base height
	bd=(hb-1/4")/2

	rotx -90

	rotz -90
	roty -90
	revolve 10,360,1+2,
		 0,a/2-1/2",0,
		-3/16",a/2-1/2",0,
		-1/4",a/2-9/16",0,
		-1/4",a/2-11/16",0,
		-5/16",a/2-3/4",0,
		-1/4"-bd+1/16",a/2-3/4",0,
		-1/4"-bd,a/2-13/16",0,
		-1/4"-bd,a/2-15/16",0,
		-1/4"-bd-1/16",a/2-1",0,
		-hb,a/2-1",0
	del 2

	material matLamp

	addz -hb
	rotz -90
	roty -90
	mulx (b-hb)/0.08

	revolve 15, 360, 2,
		-0.0000,  a/2-0.0290, 1,
		-0.0004,  a/2-0.0290+0.0097, 1,
		-0.0036,  a/2-0.0290+0.0188, 1,
		-0.0100,  a/2-0.0290+0.0260, 1,
		-0.0162,  a/2-0.0290+0.0288, 1,
		-0.0190,  a/2, 1,
		-0.0283,  a/2-0.0290+0.0262, 1,
		-0.0368,  a/2-0.0290+0.0215, 1,
		-0.0444,  a/2-0.0290+0.0155, 1,
		-0.0509,  a/2-0.0290+0.0083, 1,
		-0.0563,  a/2-0.0290, 1,
		-0.0606,  a/2-0.0290-0.0084, 1,
		-0.0640,  a/2-0.0290-0.0175, 1,
		-0.0665,  a/2-0.0290-0.0267, 1,
		-0.0800,  0.001, 1
	del 4

	if bLight then 
		addz -hb - 0.03
		gosub "C4D_lightOMNI"
		del 1	
	endif

	del 1

return


! ==============================================================================
!	Shade Type 3
! ==============================================================================

"SHADE_3":

	pen gs_cont_pen
	resol gs_resol
	material matFrame

	hb=0.035		!Base height
	shadeheight = b - hb

	rotx -90

	if gs_detlevel_3D_m=2 then
		for i = 1 to 4
			add a/2 - 0.0165, 0, -hb-0.005
			cylind 0.005, 0.005
			del 1
			rotz 90
		next i
		del 4
	endif

	roty -90
	revolve 4,360,1+2,
		 0,	a/2,0,
		-hb/2,	a/2,	0,
		-hb/2,	a/2-0.01,	0,
		-hb,	a/2-0.01,	0
	del 1

	material matLamp

	addz -hb
	roty -90

	mul shadeheight/(0.05833333333333+0.01138026878427), a/0.33, a/0.33
	addx -0.01138026878427
	revolve 16, 360, 0,
	   0.01138026878427, 0.1373099392565,      1,
	   0, 0.11458292629,    900,
	   0, 26.59884798931,   4001,
		0,         0.14,      1,
		0, 0.11458292629,    900,
				   0, 26.59884798931,   4001,
		-0.01138026878427, 0.1373099392565,      1,
		0.006560974361986, 0.1011676379033,    900,
				   0, 19.31151154783,   4001,
		-0.0223232002213, 0.1293431345516,      1,
		0.04432862837405, 0.06670532744836,    900,
				   0, 22.54929555119,   4001,
		-0.04124789556922, 0.09899494936612,      1,
		0.2370033247881, 0,    900,
				   0, 19.58430938155,   4001,
		-0.05833333333333, 0,      1
	del 2
	del 2

	if bLight then 
		addz -hb - 0.03
		gosub "C4D_lightOMNI"
		del 1	
	endif

	del 1

return



! ==============================================================================
!	Shade Type 4
! ==============================================================================

"SHADE_4":

	innersize_factor = 0.95
	pen gs_cont_pen
	resol max(3,gs_resol/4)
	material matFrame

	rotx -90

	for i = 1 to 4
		add -a/0.28*0.1373099392565, 0.007/2, -0.01138026878427*b/0.05833333333333
		rotx 90
		mul 1.3, 1.3, 1
		prism_ 12, 0.007,
			0.004836692691626, -0.008752508429403,      15,
					   0,            0,      15,
			0.005623745785298,            0,      15,
			0.005623745785298,        0.005,      15,
			0,        0.005,      79,
			0, 0,    900,
					   0, 118.9253232818,   4000,
			-0.004376254214702, -0.002418346345813,      79,
			-0.001957907868889, -0.006794600560514,      79,
			0.002418346345813, -0.004376254214702,    900,
					   0,           90,   4000,
			0.004836692691626, -0.008752508429403,      15
		del 3
		rotz 90
	next i
	del 4

	material matLamp
	resol gs_resol

	roty -90
	mul b/0.05833333333333, a/0.28, a/0.28

	revolve 11, 360, 0,
		-0.01138026878427, innersize_factor*0.1373099392565,      1,
		-0.01138026878427, 0.1373099392565,      1,
		0.006560974361986, 0.1011676379033,    900,
				   0, 19.31151154783,   4001,
		-0.0223232002213, 0.1293431345516,      1,
		0.04432862837405, 0.06670532744836,    900,
				   0, 22.54929555119,   4001,
		-0.04124789556922, 0.09899494936612,      1,
		0.2370033247881, 0,    900,
				   0, 19.58430938155,   4001,
		-0.05833333333333, 0,      1

	mul innersize_factor, innersize_factor, innersize_factor
	revolve 10, 360, 0,
		-0.01138026878427, 0.1373099392565,      1,
		0.006560974361986, 0.1011676379033,    900,
				   0, 19.31151154783,   4001,
		-0.0223232002213, 0.1293431345516,      1,
		0.04432862837405, 0.06670532744836,    900,
				   0, 22.54929555119,   4001,
		-0.04124789556922, 0.09899494936612,      1,
		0.2370033247881, 0,    900,
				   0, 19.58430938155,   4001,
		-0.05833333333333, 0,      1
	del 1

	del 2

	if bLight then 
		addz -0.03
		gosub "C4D_lightAREA"
		del 1	
	endif

	del 1

return



! ==============================================================================
!	Shade Type 5
! ==============================================================================

"SHADE_5":

	shader_r = a*1.8
	shader_thk = 0.01
	diffh = shader_r - sqr(shader_r*shader_r - a/2*a/2)
	diffR = shader_r - shader_r*(cos(360/gs_resol/2))

	pen gs_cont_pen

	rotx -90

	resol max(3,gs_resol/4)
	material matFrame

	for i = 1 to 4
		add -a/2, 0.007/2, -b+diffh+shader_thk+diffR
		rotx 90
		mul 1.3, 1.3, 1
		prism_ 13, 0.007,
			0.004836692691626, -0.008752508429403,      15,
				0, -0.007, 15,
					   0,            0,      15,
			0.005623745785298,            0,      15,
			0.005623745785298,        0.005,      15,
			0,        0.005,      79,
			0, 0,    900,
					   0, 118.9253232818,   4000,
			-0.004376254214702, -0.002418346345813,      79,
			-0.001957907868889, -0.006794600560514,      79,
			0.002418346345813, -0.004376254214702,    900,
					   0,           90,   4000,
			0.004836692691626, -0.008752508429403,      15
		del 3
		rotz 90
	next i
	del 4


	material matLamp
	resol gs_resol

	addz -b+shader_r
	group "brick"
		add -a/2, -a/2, -3*a
		brick a, a, 3*a
		del 1
	endgroup

	group "outside"
		sphere shader_r
	endgroup

	group "inside"
		sphere shader_r-shader_thk
	endgroup

	result_1 = subgroup ("outside", "inside")
	result_2 = isectgroup (result_1, "brick")

	placegroup result_2

	del 1

	_cornerHeight = shader_r - shader_thk - sqr((shader_r - shader_thk)^2 - (A^2 / 4))

	if bLight then 
		addz -B + _cornerHeight + 0.02
		gosub "C4D_lightAREA"
		del 1	
	endif

	del 1

return


! ==============================================================================
!	Shade Type 6
! ==============================================================================

"SHADE_6":

	toruswidth = (b - 0.02)*2

	pen gs_cont_pen
	resol gs_resol

	material matLamp

	rotx -90

	roty 90

	revolve 6, 360, 0,
		0, a/2, 1,
		0.02, a/2, 1,
		toruswidth/2, -180, 2000,
		0.02, a/2 - toruswidth, 1,
		0, a/2 - toruswidth, 1,
		0, a/2, 1

	del 1

	if bLight then 
		addz -B * 2/3
		for i = 1 to 4
			rotz (i-1) * 90
			addx A/2 - toruswidth * A / 0.6
			gosub "C4D_lightOMNI"
			del 2
		next i
		gosub "C4D_FakeFalloff"
		del 1	
	endif

	del 1

return


! ==============================================================================
!	Shade Type 7
! ==============================================================================

"SHADE_7":

	basethk = 0.003
	hb = b

	pen gs_cont_pen
	resol gs_resol
	material matFrame

	rotx -90

	addz -b
	prism_ 10, hb,
		-a/2, -a/2, 15,
		 a/2, -a/2, 15,
		 a/2,  a/2, 15,
		-a/2,  a/2, 15,
		-a/2, -a/2, -1,

		-a/2 + basethk, -a/2 + basethk, 15,
		 a/2 - basethk, -a/2 + basethk, 15,
		 a/2 - basethk,  a/2 - basethk, 15,
		-a/2 + basethk,  a/2 - basethk, 15,
		-a/2 + basethk, -a/2 + basethk, -1
	del 1

	if not(bLight) then
		material matGlass

		addz -b-0.003
		prism_ 5, 0.005,
			-a/2 + basethk, -a/2 + basethk, 15,
			 a/2 - basethk, -a/2 + basethk, 15,
			 a/2 - basethk,  a/2 - basethk, 15,
			-a/2 + basethk,  a/2 - basethk, 15,
			-a/2 + basethk, -a/2 + basethk, -1
		del 1
	else
		addz -B
		gosub "C4D_lightAREA"
		del 1	
	endif

	del 1

return


! ==============================================================================
!	Shade Type 8
! ==============================================================================

"SHADE_8":

	basethk = 0.01
	shadeheight = b - 0.02
	innersize_factor = 0.6

	pen gs_cont_pen

	rotx -90

	if gs_detlevel_3D_m=2 then
		resol max(3,gs_resol/4)
		material matFrame
		for i = 1 to 4
			add a/2*innersize_factor + 0.01, a/2*innersize_factor + 0.01, -1.1*b
			cylind 1.1*b, 0.005
			del 1
			rotz 90
		next i
		del 4
	endif


	resol gs_resol
	material matGlassOther

	addz -b
	for i = 1 to 2
		prism_ 5, basethk,
			-a/2, -a/2, 15,
			 a/2, -a/2, 15,
			 a/2,  a/2, 15,
			-a/2,  a/2, 15,
			-a/2, -a/2, -1
		addz shadeheight - basethk
	next i
	del 2
	del 1

	if not(bLight) then
		material matGlass

		addz -b	+ basethk
		prism_ 5, shadeheight - 2*basethk,
			-a/2*innersize_factor, -a/2*innersize_factor, 15,
			 a/2*innersize_factor, -a/2*innersize_factor, 15,
			 a/2*innersize_factor,  a/2*innersize_factor, 15,
			-a/2*innersize_factor,  a/2*innersize_factor, 15,
			-a/2*innersize_factor, -a/2*innersize_factor, -1
		del 1
	else
		addz -B + shadeheight/2
		gosub "C4D_lightAREA"
		del 1	
	endif

	del 1


return



! ==============================================================================
!	Shade Type 9
! ==============================================================================

"SHADE_9":

	pen gs_cont_pen
	material matGlassOther
	resol gs_resol

	rotx -90
	rotx 90

	mulx a/0.2
	for i = 1 to 2
		addy -0.02
		prism_ 11,zzyzx,
			0.1,-0.01,79,
			0.09,-0.01,79,
			0.09,-0.03,979,
			0.02,45,4079,
			0,0.02,979,
			0,-0.08,3072,
			0,-0.06,77,
			0.085,-0.025,3079,
			0.09,-0.03,979,
			0.02,-60,4079,
			0.1,-0.007,79
		del 1
		mulx -1
	next i
	del 1

	material matFrame
	rotx 90
	prism_ 9,0.001,
		-0.08,0,79,
		0.08,0,79,
		0.1,0.02,1079,
		0.1,zzyzx-0.02,79,
		0.08,zzyzx,1079,
		-0.08,zzyzx,79,
		-0.1,zzyzx-0.02,1079,
		-0.1,0.02,79,
		-0.08,0,1079
	del 1

	del 1


	rotx 90
	addz 0.001
	resol 6
	if gs_detlevel_3D_m=2 then
		prism_ 2,0.03,
			a/2-0.01,0.01,979,
			0.003,360,4079

		prism_ 2,0.03,
			-a/2+0.01,0.01,979,
			0.003,360,4079

		prism_ 2,0.03,
			a/2-0.01,zzyzx-0.01,979,
			0.003,360,4079

		prism_ 2,0.03,
			-a/2+0.01,zzyzx-0.01,979,
			0.003,360,4079
	endif
	del 2

	addy -0.001
	resol gs_resol

	material matFrame

	prism_ 4, 0.025,
		0.02,0,79,
		0,-0.015,979,
		0,-0.025,3079,
		-0.02,0,3079

	addz ZZYZX - 0.025
	prism_ 4, 0.025,
		0.02,0,79,
		0,-0.015,979,
		0,-0.025,3079,
		-0.02,0,3079
	del 1

	material "builtInMatLampBulb"

	addz 0.025
	resol gs_resol
	prism_ 4,zzyzx-0.05,
		0.02,0,79,
		0,-0.015,979,
		0,-0.025,3079,
		-0.02,0,3079
	del 2

	del 2

	if bLight then
		rotz 90
		add -ZZYZX/2, 0, -0.02
		gosub "C4D_lightAREA"
		del 2
	endif

	del 1

return


! ==============================================================================
!	Shade Type 10
! ==============================================================================

"SHADE_10":

	pen gs_cont_pen
	resol gs_resol

	material matGlassOther
	muly 2*b/a
	roty -90
	rotx 90
	revolve 3,180,16+32,
		zzyzx/2,a/4,1,
		zzyzx,a/2,1,
		zzyzx,a/2-0.01,1

	material matFrame
	resol max(3,gs_resol/2)
	revolve 3,180,1+2+4+8+16+32,
		zzyzx/2,0,1,
		zzyzx/2,a/4,1,
		0,0,1
	del 2

	del 1


	add 0,-b/8, zzyzx/2
	material "builtInMatLampBulb"
	ellips zzyzx/4, b/10

	if bLight then
		addz ZZYZX/12
		rotx -90
		gosub "C4D_lightOMNI"
		del 2	
	endif

	del 1

return


! ==============================================================================
!	Shade Type 11
! ==============================================================================

"SHADE_11":

	!--- Lamp Holder ---

	pen gs_cont_pen
	material matFrame
	resol gs_resol

	roty 90
	cylind 0.015,b/10
	del 1

	addx a
	rotz 180
	armc b/15,b/30,a-0.015,0,0,90
	del 1

	addz -0.1
	cylind zzyzx+0.1-2*b/5,b/15
	del 1

	!--- Lamp Head / Sheader

	material matFrame
	resol gs_resol

	addz zzyzx-b
	rotx 90

	for i=1 to 4
		addz -b/100
		prism_ 7, b/50,
			b/15,b/5,15,
			b/2,b,15,
			b/2-b/16,b,15,
			3*b/8-b/16,4*b/5,15,
			b/5,4*b/5,79,
			0,4*b/5,979,
			b/15,1.22*b/2,3015
		del 1
		roty 90
	next i
	del 4

	rotx -90
	addz 4*b/5-0.02
	prism_ 3,0.02,
		0,0,979,
		1.1*b/5,360,4079,
		b/5,360,4079
	del 2

	add 0,b+0.001,0
	rotz -90
	revolve 4,360,2,
		0,b/2,1,
		0,b/2-b/16,1,
		b,0,901,
		-b/10,0.001,3001

	del 2


	material "builtInMatLampBulb"
	shadow off

	addy 4*b/5
	revolve 3,360,0,
		b/5-0.01,0,1,
		0,0,901,
		b/5-0.01,179.999,4001

	if bLight then
		rotx -90
		gosub "C4D_lightOMNI"
		del 1	
	endif

	del 1

	del 3

return


! ==============================================================================
!	Shade Type 12
! ==============================================================================

"SHADE_12":

	shadeheight = zzyzx
	diameter2 = a
	diameter1 = 0.8*a
	shadethk = 0.005

	pen gs_cont_pen
	resol gs_resol

	rotz 90
	roty -90


	!--- Lampshade outside ---
	material matGlassOther
	shaderad = ((shadeheight/2*shadeheight/2)+(diameter2/2-diameter1/2)*(diameter2/2-diameter1/2))\
				/ (2*abs(diameter2/2-diameter1/2))

	revolve 7, 180, 16+32,
		0,				diameter1/2 - shadethk,	1,
		0,				diameter1/2,			1,
		shadeheight/2,	diameter2/2 - shaderad, 900,
		shadeheight,	diameter1/2,			3001,
		shadeheight,	diameter1/2,			1,
		shadeheight,	diameter1/2,			1,
		shadeheight,	diameter1/2- shadethk,	1


	del 2

	addy -0.001
	resol gs_resol

	material matFrame

	prism_ 4, 0.025,
		0.02,0,79,
		0,-0.015,979,
		0,-0.025,3079,
		-0.02,0,3079

	addz ZZYZX - 0.025
	prism_ 4, 0.025,
		0.02,0,79,
		0,-0.015,979,
		0,-0.025,3079,
		-0.02,0,3079
	del 1

	material "builtInMatLampBulb"

	addz 0.025
	resol gs_resol
	prism_ 4,zzyzx-0.05,
		0.02,0,79,
		0,-0.015,979,
		0,-0.025,3079,
		-0.02,0,3079
	del 2

	if bLight then
		roty 90
		rotx -90
		add -ZZYZX/2, 0, -0.02
		gosub "C4D_lightAREA"
		del 3
	endif

return



! ==============================================================================
!	Shade Type 13
! ==============================================================================

"SHADE_13":

	pen gs_cont_pen

	resol gs_resol

	rotz -90 * not(bMigrationRotZ)
	roty -90
	rotx 180

	material matShadeOut

	revolve 5, 180, 1+2+4+8+16+32+64,
		0,		0,			601,
		A,		0,			901,
		0,		-88,		4001,
		A,		0.95 * A,	1,
		0,		90,			4001

	rotz -90
	rotx 180
	addy -A
	addx -0.95 * A

	material matFrame
	extrude 4, 0, 0, -A/100, 1+2+4+16+32,
		0,	0,		600,
		0.95 * A,	0,		900,
		0,	-180,	4000,
		0,	0,		700

	del 6

	add 0.0225 + 0.01 * A, 0, 0.3 * ZZYZX

	material "builtInMatLampBulb"

	sphere 0.0225

	if bLight then
		rotx -90
		gosub "C4D_lightOMNI"
		del 1	
	endif

	del 1

return



! ==============================================================================
!	Shade Type 14
! ==============================================================================

"SHADE_14":

	pen gs_cont_pen

	rotz  -90 * not(bMigrationRotZ)

	_halfAngle = 180 - 2 * atn(B/(2*A))
	_topRadius = B / (2 * sin(_halfAngle))

	material matFrame

	rotz -_halfAngle
	add (A - _topRadius) * cos(_halfAngle), (A - _topRadius) * sin(_halfAngle), ZZYZX
	mulz -1

	! --- Resolution ---
	_AngleByResol = (2 * _halfAngle) / gs_resol

	for i = 0 to 2 * _halfAngle + 1 step _AngleByResol
	   put _topRadius * cos(i), _topRadius * sin(i), 1
	next i

	for i = 0 to 2 * _halfAngle + 1 step _AngleByResol
	   put (_topRadius - 0.005) * cos(i), (_topRadius - 0.005) * sin(i), 1
	next i

	for i = 0 to 2 * _halfAngle + 1 step _AngleByResol
	   put (_topRadius - A) * cos(_halfAngle), (_topRadius - A) * sin(_halfAngle), ZZYZX
	   put (_topRadius - A) * cos(_halfAngle), (_topRadius - A) * sin(_halfAngle), ZZYZX
	next i

	ruled NSP/6, 0+4+16+32,
				use(NSP)

	del 3

	add 0.0225, 0, ZZYZX/2

	material "builtInMatLampBulb"

	sphere 0.0225

	if bLight then
		rotx -180
		gosub "C4D_lightOMNI"
		del 1	
	endif

	del 2

return


! ==============================================================================
"C4D_lightOMNI":
! ==============================================================================

	if iShadeType = 6 then
		unIDfactor = i
		_bIllumination = 0
	else
		unIDfactor = 0
		_bIllumination = bShowIllumination3D
	endif

	lightUnID = 1000 + unIDfactor * 500

	! ======================================================================
	! Non Visible Omni Light
	! ======================================================================

	call	"lightMacro_m" parameters		gs_light_switch						= gs_light_switch,
												gs_color_red						= gs_color_red,
												gs_color_green						= gs_color_green,
												gs_color_blue						= gs_color_blue,
												gs_light_intensity						= gs_light_intensity,
												iColorPreset			= iColorPreset,
												iLightGroupType			= LIGHTGROUP_BUILTIN_OMNI,
												iC4dDetAreaShape		= AREASHAPE_SPHERE,
												c4dDetAreaX				= 0.03,
												c4dDetAreaY				= 0.03,
												c4dDetAreaZ				= 0.03,
												bGenShadow				= bGenShadow,
												iShadowQuality			= iShadowQuality,
												iShadowQualityGroupType	= _iShadowQualityGroupType,
												iC4dGenVisibility		= 1,
												bDetShowFalloff 		= 1,
												iFalloffType			= FALLOFFTYPE_OMNI,
												c4dDetRadius			= c4dDetRadius,
												c4dPhoPhotometric		= c4dPhoPhotometric,
												iC4dPhoUnit				= iC4dPhoUnit,
												photoIntensityLumen		= photoIntensityLumen,
												photoIntensityCandela	= photoIntensityCandela,
												bShowIllumination3D		= _bIllumination,
												gs_resol				= gs_resol,
												gs_cont_pen				= gs_cont_pen,
												penIllumination			= penIllumination,
												lightUnID				= lightUnID

return


! ==============================================================================
"C4D_lightAREA":
! ==============================================================================

	if iShadeType = 4 then
		_areaShapeType = AREASHAPE_DISC
		_areaX = A * (2/3)
		_areaY = ZZYZX * (2/3)
		_areaZ = 0.03
	endif

	if iShadeType = 5 then
		_areaShapeType = AREASHAPE_RECT
		_areaX = A * (2/3)
		_areaY = ZZYZX * (2/3)
		_areaZ = 0.03
	endif

	if iShadeType = 7 then
		_areaShapeType = AREASHAPE_RECT
		_areaX = A - 2 * basethk
		_areaY = A - 2 * basethk
		_areaZ = 0.03
	endif

	if iShadeType = 8 then
		_areaShapeType = AREASHAPE_CUBE
		_areaX = A * innersize_factor
		_areaY = A * innersize_factor
		_areaZ = shadeheight - 2 * basethk
	endif

	if iShadeType = 9 then
		_areaShapeType = AREASHAPE_PCYLIND
		_areaX = ZZYZX - 0.05
		_areaY = 0.03
		_areaZ = 0.03
	endif

	if iShadeType = 12 then
		_areaShapeType = AREASHAPE_PCYLIND
		_areaX = ZZYZX - 0.05
		_areaY = 0.03
		_areaZ = 0.03
	endif

	lightUnID = 1000

	! ======================================================================
	! Non Visible Area Light
	! ======================================================================

	call	"lightMacro_m" parameters		gs_light_switch						= gs_light_switch,
											gs_color_red						= gs_color_red,
											gs_color_green						= gs_color_green,
											gs_color_blue						= gs_color_blue,
											gs_light_intensity						= gs_light_intensity,
											iColorPreset			= iColorPreset,
											iLightGroupType			= LIGHTGROUP_BUILTIN_NONVIS_AREA,
											iC4dDetAreaShape		= _areaShapeType,
											c4dDetAreaX				= _areaX,
											c4dDetAreaY				= _areaY,
											c4dDetAreaZ				= _areaZ,
											bGenShadow				= bGenShadow,
											iShadowQuality			= iShadowQuality,
											iShadowQualityGroupType	= _iShadowQualityGroupType,
											iC4dGenVisibility		= 1,
											bDetShowFalloff 		= 1,
											iFalloffType			= FALLOFFTYPE_OMNI,
											c4dDetRadius			= c4dDetRadius,
											c4dDetFalloffAngle		= 0,
											falloffAngleTemp		= falloffAngleTemp,
											c4dPhoPhotometric		= c4dPhoPhotometric,
											iC4dPhoUnit				= iC4dPhoUnit,
											photoIntensityLumen		= photoIntensityLumen,
											photoIntensityCandela	= photoIntensityCandela,
											bShowIllumination3D		= bShowIllumination3D,
											gs_resol				= gs_resol,
											gs_cont_pen				= gs_cont_pen,
											penIllumination			= penIllumination,
											lightUnID				= lightUnID

	if iShadeType = 7 | iShadeType = 8 then
		! ======================================================================
		! Visible Area Light
		! ======================================================================

		call	"lightMacro_m" parameters		gs_light_switch		= gs_light_switch,
												gs_color_red		= gs_color_red,
												gs_color_green		= gs_color_green,
												gs_color_blue		= gs_color_blue,
												gs_light_intensity	= 400,
												iLightGroupType		= LIGHTGROUP_BUILTIN_VIS_AREA,
												iC4dDetAreaShape	= _areaShapeType,
												c4dDetAreaX			= _areaX,
												c4dDetAreaY			= _areaY,
												c4dDetAreaZ			= _areaZ,
												bGenShadow			= 1,
												iShadowQuality		= iShadowQuality,
												iShadowQualityGroupType	= _iShadowQualityGroupType,
												iC4dGenVisibility	= 1,
												bDetShowFalloff 	= 1,
												c4dDetRadius		= 0,
												c4dDetFalloffAngle	= 0,
												gs_resol			= gs_resol,
												gs_cont_pen			= gs_cont_pen,
												bShowIllumination3D	= 0
	endif

return


! ==============================================================================
"C4D_FakeFalloff":
! ==============================================================================

	call "lightMacro_m" parameters		iLightGroupType		= LIGHTGROUP_BUILTIN_FALLOFF,
										iFalloffType		= FALLOFFTYPE_OMNI,
										c4dDetAreaX			= 0.1,
										c4dDetAreaY			= 0.1,
										c4dDetRadius		= c4dDetRadius,
										c4dDetFalloffAngle	= 0,
										c4dPhoPhotometric	= c4dPhoPhotometric,
										bShowIllumination3D	= bShowIllumination3D,
										penIllumination		= penIllumination,
										iModelType			= 1,
										gs_resol			= gs_resol,
										lightUnID			= unID + 1000
return



