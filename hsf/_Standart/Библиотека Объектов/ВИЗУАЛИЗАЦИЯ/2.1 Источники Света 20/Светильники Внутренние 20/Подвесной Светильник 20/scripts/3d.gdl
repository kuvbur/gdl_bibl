

	! ======================================================================
	! Lamp Bulb Surface
	! ======================================================================
	
	DIM	tmp_C4D_ChCol_Color[3]
		tmp_C4D_ChCol_Color[1] = 0.7843137254902
		tmp_C4D_ChCol_Color[2] = 0.7843137254902
		tmp_C4D_ChCol_Color[3] = 0.8039215686275
	DIM	tmp_C4D_ShNoise_Color1_1[3]
		tmp_C4D_ShNoise_Color1_1[1] = 0
		tmp_C4D_ShNoise_Color1_1[2] = 0
		tmp_C4D_ShNoise_Color1_1[3] = 0
	DIM	tmp_C4D_ShNoise_Color2_1[3]
		tmp_C4D_ShNoise_Color2_1[1] = 1
		tmp_C4D_ShNoise_Color2_1[2] = 1
		tmp_C4D_ShNoise_Color2_1[3] = 1
	DIM	tmp_C4D_ShNoise_RelativeScale_1[3]
		tmp_C4D_ShNoise_RelativeScale_1[1] = 1
		tmp_C4D_ShNoise_RelativeScale_1[2] = 1
		tmp_C4D_ShNoise_RelativeScale_1[3] = 1
	DIM	tmp_C4D_ChLum_Color[3]
		tmp_C4D_ChLum_Color[1] = 1
		tmp_C4D_ChLum_Color[2] = 1
		tmp_C4D_ChLum_Color[3] = 1
	DIM	tmp_C4D_ChTra_Color[3]
		tmp_C4D_ChTra_Color[1] = 0.9411764705882
		tmp_C4D_ChTra_Color[2] = 0.9411764705882
		tmp_C4D_ChTra_Color[3] = 0.9411764705882
	DIM	tmp_C4D_ChTra_AbsorptionColor[3]
		tmp_C4D_ChTra_AbsorptionColor[1] = 1
		tmp_C4D_ChTra_AbsorptionColor[2] = 1
		tmp_C4D_ChTra_AbsorptionColor[3] = 1
	DIM	tmp_C4D_ChRef_Color[3]
		tmp_C4D_ChRef_Color[1] = 1
		tmp_C4D_ChRef_Color[2] = 1
		tmp_C4D_ChRef_Color[3] = 1
	DIM	tmp_C4D_ChEnv_Color[3]
		tmp_C4D_ChEnv_Color[1] = 1
		tmp_C4D_ChEnv_Color[2] = 1
		tmp_C4D_ChEnv_Color[3] = 1
	DIM	tmp_C4D_ChFog_Color[3]
		tmp_C4D_ChFog_Color[1] = 1
		tmp_C4D_ChFog_Color[2] = 1
		tmp_C4D_ChFog_Color[3] = 1
	DIM	tmp_C4D_ChAlp_Color[3]
		tmp_C4D_ChAlp_Color[1] = 1
		tmp_C4D_ChAlp_Color[2] = 1
		tmp_C4D_ChAlp_Color[3] = 1
	DIM	tmp_C4D_ChAlp_Delta[3]
		tmp_C4D_ChAlp_Delta[1] = 0.1
		tmp_C4D_ChAlp_Delta[2] = 0.1
		tmp_C4D_ChAlp_Delta[3] = 0.1
	DIM	tmp_C4D_ChSpe_Color[3]
		tmp_C4D_ChSpe_Color[1] = 1
		tmp_C4D_ChSpe_Color[2] = 1
		tmp_C4D_ChSpe_Color[3] = 1
	DIM	tmp_C4D_ChGlo_Color[3]
		tmp_C4D_ChGlo_Color[1] = 1
		tmp_C4D_ChGlo_Color[2] = 1
		tmp_C4D_ChGlo_Color[3] = 1
	DIM	tmp_C4D_GKRGB_Color_3[3]
		tmp_C4D_GKRGB_Color_3[1] = 0
		tmp_C4D_GKRGB_Color_3[2] = 0
		tmp_C4D_GKRGB_Color_3[3] = 0
	DIM	tmp_C4D_GKRGB_Color_4[3]
		tmp_C4D_GKRGB_Color_4[1] = 1
		tmp_C4D_GKRGB_Color_4[2] = 1
		tmp_C4D_GKRGB_Color_4[3] = 1
	
	define material	"builtInMatLampBulb" 0,
		0.941176, 0.968627, 0.952941,
		0.8, 0.1, 1, 0.88,
		79.52, 0.04,
		1, 1, 1,
		0, 0, 0, 0,
	ADDITIONAL_DATA		C4D_VER_MAIN= 1,
	C4D_VER_SUB						= 0,
	C4D_ChCol_State					= 1,
	C4D_ChCol_Color					= tmp_C4D_ChCol_Color,
	C4D_ChCol_Brightness			= 1,
	C4D_ChCol_MixMode				= "Normal",
	C4D_ChCol_MixStrength			= 1,
	C4D_ChDif_State					= 0,
	C4D_ChDif_Brightness			= 1,
	C4D_ChDif_Luminance				= 1,
	C4D_ChDif_Specular				= 1,
	C4D_ChDif_Reflection			= 1,
	C4D_ChDif_Texture				= "1",
	C4D_ShNoise_BlendMode_1			= "Normal",
	C4D_ShNoise_BlendStre_1			= 1,
	C4D_ShNoise_BlurOffset_1		= 0,
	C4D_ShNoise_BlurScale_1			= 0,
	C4D_ShNoise_Color1_1			= tmp_C4D_ShNoise_Color1_1,
	C4D_ShNoise_Color2_1			= tmp_C4D_ShNoise_Color2_1,
	C4D_ShNoise_Seed_1				= 665,
	C4D_ShNoise_Noise_1				= "Turbulence",
	C4D_ShNoise_Octaves_1			= 5,
	C4D_ShNoise_Space_1				= "Texture",
	C4D_ShNoise_GlobalScale_1		= 0.01,
	C4D_ShNoise_RelativeScale_1		= tmp_C4D_ShNoise_RelativeScale_1,
	C4D_ShNoise_Absolute_1			= 0,
	C4D_ShNoise_Cycles_1			= 0,
	C4D_ShNoise_LowClip_1			= 0,
	C4D_ShNoise_HighClip_1			= 1,
	C4D_ShNoise_Brightness_1		= 0,
	C4D_ShNoise_Contrast_1			= 0,
	C4D_ChDif_MixMode				= "Normal",
	C4D_ChDif_MixStrength			= 0.1,
	C4D_ChLum_State					= 0,
	C4D_ChLum_Color					= tmp_C4D_ChLum_Color,
	C4D_ChLum_Brightness			= 1,
	C4D_ChLum_MixMode				= "Normal",
	C4D_ChLum_MixStrength			= 1,
	C4D_ChTra_State					= 1,
	C4D_ChTra_Color					= tmp_C4D_ChTra_Color,
	C4D_ChTra_Brightness			= 0.95,
	C4D_ChTra_Refraction			= 1,
	C4D_ChTra_InternalReflections	= 1,
	C4D_ChTra_ExitReflection		= 0,
	C4D_ChTra_FresnelReflectivity	= 0.5,
	C4D_ChTra_Additive				= 0,
	C4D_ChTra_MixMode				= "Normal",
	C4D_ChTra_MixStrength			= 1,
	C4D_ChTra_AbsorptionColor		= tmp_C4D_ChTra_AbsorptionColor,
	C4D_ChTra_AbsorptionDistance	= 100,
	C4D_ChTra_Blurriness			= 0,
	C4D_ChTra_MinSamples			= 10,
	C4D_ChTra_MaxSamples			= 80,
	C4D_ChTra_Accuracy				= 0.5,
	C4D_ChRef_State					= 1,
	C4D_ChRef_Color					= tmp_C4D_ChRef_Color,
	C4D_ChRef_Brightness			= 0.1,
	C4D_ChRef_Additive				= 1,
	C4D_ChRef_MixMode				= "Normal",
	C4D_ChRef_MixStrength			= 1,
	C4D_ChRef_Blurriness			= 0,
	C4D_ChRef_MinSamples			= 5,
	C4D_ChRef_MaxSamples			= 128,
	C4D_ChRef_Accuracy				= 0.5,
	C4D_ChEnv_State					= 0,
	C4D_ChEnv_Color					= tmp_C4D_ChEnv_Color,
	C4D_ChEnv_Brightness			= 1,
	C4D_ChEnv_MixMode				= "Normal",
	C4D_ChEnv_MixStrength			= 1,
	C4D_ChEnv_TilesX				= 1,
	C4D_ChEnv_TilesY				= 1,
	C4D_ChEnv_Exclusive				= 0,
	C4D_ChFog_State					= 0,
	C4D_ChFog_Color					= tmp_C4D_ChFog_Color,
	C4D_ChFog_Brightness			= 1,
	C4D_ChFog_Distance				= 10,
	C4D_ChBum_State					= 0,
	C4D_ChBum_Strength				= 1,
	C4D_ChBum_MipFalloff			= 1,
	C4D_ChNor_State					= 0,
	C4D_ChNor_Strength				= 1,
	C4D_ChNor_Method				= "Tangent",
	C4D_ChNor_FlipX					= 0,
	C4D_ChNor_FlipY					= 0,
	C4D_ChNor_FlipZ					= 0,
	C4D_ChNor_SwapYZ				= 0,
	C4D_ChAlp_State					= 0,
	C4D_ChAlp_Color					= tmp_C4D_ChAlp_Color,
	C4D_ChAlp_Delta					= tmp_C4D_ChAlp_Delta,
	C4D_ChAlp_Invert				= 0,
	C4D_ChAlp_Soft					= 1,
	C4D_ChAlp_ImageAlpha			= 0,
	C4D_ChAlp_PreMultiplied			= 0,
	C4D_ChSpe_State					= 1,
	C4D_ChSpe_Color					= tmp_C4D_ChSpe_Color,
	C4D_ChSpe_Brightness			= 1,
	C4D_ChSpe_MixMode				= "Normal",
	C4D_ChSpe_MixStrength			= 1,
	C4D_ChSpe_Mode					= "Plastic",
	C4D_ChSpe_Width					= 0.45,
	C4D_ChSpe_Height				= 0.5,
	C4D_ChSpe_Falloff				= -0.05,
	C4D_ChSpe_InnerWidth			= 0,
	C4D_ChGlo_State					= 0,
	C4D_ChGlo_Color					= tmp_C4D_ChGlo_Color,
	C4D_ChGlo_Brightness			= 1,
	C4D_ChGlo_InnerStrength			= 1,
	C4D_ChGlo_OuterStrength			= 5,
	C4D_ChGlo_Radius				= 10,
	C4D_ChGlo_Random				= 0,
	C4D_ChGlo_Frequency				= 1,
	C4D_ChGlo_UseMatColor			= 1,
	C4D_ChDis_State					= 0,
	C4D_ChDis_Strength				= 1,
	C4D_ChDis_Height				= 0.5,
	C4D_ChDis_Type					= "IntensityCentered",
	C4D_ChDis_SubDivision			= 0,
	C4D_ChDis_Level					= 4,
	C4D_ChDis_RoundGeometry			= 0,
	C4D_ChDis_RoundContour			= 1,
	C4D_ChDis_MapRounded			= 1,
	C4D_ChDis_MapResult				= 0,
	C4D_ChDis_KeepEdges				= 0,
	C4D_ChDis_BestDistribution		= 1,
	C4D_ChGra_State					= 0,
	C4D_ChGra_Color					= "2",
	C4D_GradientRGB_Interpol_2		= "SmoothKnot",
	C4D_GradientRGB_Knots_2			= "3,4",
	C4D_GKRGB_Color_3				= tmp_C4D_GKRGB_Color_3,
	C4D_GKRGB_Intensity_3			= 1,
	C4D_GKRGB_Position_3			= 0,
	C4D_GKRGB_Bias_3				= 0.5,
	C4D_GKRGB_Color_4				= tmp_C4D_GKRGB_Color_4,
	C4D_GKRGB_Intensity_4			= 1,
	C4D_GKRGB_Position_4			= 1,
	C4D_GKRGB_Bias_4				= 0.5,
	C4D_ChGra_MixStrength			= 0.5,
	C4D_ChGra_Density				= 1,
	C4D_ChGra_Length				= 0.1,
	C4D_ChGra_Width					= 0.005,
	C4D_ChGra_Crinkle				= 0.1,
	C4D_ChGra_Bend					= 0.6,
	C4D_ChGra_Wetness				= 0.05,
	C4D_ChIll_GenerateGI			= 1,
	C4D_ChIll_GenGIStrength			= 1,
	C4D_ChIll_GenGISaturat			= 1,
	C4D_ChIll_ReceiveGI				= 1,
	C4D_ChIll_RecGIStrength			= 1,
	C4D_ChIll_RecGISaturat			= 1,
	C4D_ChIll_GIPortal				= 0,
	C4D_ChIll_GILight				= 0,
	C4D_ChIll_GenerateCaustics		= 1,
	C4D_ChIll_GenCausticsStrength	= 1,
	C4D_ChIll_ReceiveCaustics		= 1,
	C4D_ChIll_RecCausticsStrength	= 1,
	C4D_ChIll_Radius				= 0.1,
	C4D_ChIll_CausticsSamples		= 100,
	C4D_ChIll_Model					= "Blinn",
	C4D_ChIll_DiffuseFalloff		= 0,
	C4D_ChIll_DiffuseLevel			= 1,
	C4D_ChIll_Roughness				= 0.5
	
	
if gs_detlevel_3D_m = DET3D_OFF then end

if gs_detlevel_3D_m = DET3D_SIMPLE then 
	gs_resol = 8
else
	gs_resol = gs_resol
endif

if GLOB_CONTEXT > 20 & GLOB_CONTEXT < 40 then gs_resol = 12

RESOL gs_resol

if not(gs_shadow) then shadow off

! ==============================================================================
!	Non-editable parameters
! ==============================================================================

mountheight = 0.08
coverheight = 0.109537
coverminrad = 0.02
covermaxrad = 0.0475
framethk = 0.003
suspenderheight = zzyzx - shadeheight


! ==============================================================================
!	Hotspot Editing
! ==============================================================================
unID=1

hotspot	0,0,0,unID,ZZYZX,1+256 : unID=unID+1
hotspot	0,0,1,unID,ZZYZX,3 : unID=unID+1
hotspot	0,0,-ZZYZX,unID,ZZYZX,2 : unID=unID+1

if iShadeType = 1 or iShadeType = 3 then
	for i=1 to 4
		hotspot		0,		0,	-zzyzx,		unID,	D12,	1+128,	width	: unID=unID+1
		hotspot		-1,		0,	-zzyzx,		unID,	D12,	3,		width	: unID=unID+1
		hotspot diameter1/2,0,	-zzyzx,		unID,	D12,	2,		width	: unID=unID+1
		rotz 90
	next i
	del 4
endif

if iShadeType = 2 then
	for i=1 to 4
		hotspot		0,		0,	-zzyzx,		unID,	D12,	1+128,	bottomwidth	: unID=unID+1
		hotspot		-1,		0,	-zzyzx,		unID,	D12,	3,		bottomwidth	: unID=unID+1
		hotspot diameter1/2,0,	-zzyzx,		unID,	D12,	2,		bottomwidth	: unID=unID+1
		rotz 90
	next i
	del 4
endif

if iShadeType = 4 then
	for i=1 to 4
		hotspot		0,		0,	-zzyzx,		unID,	D12,	1+128,	diameter	: unID=unID+1
		hotspot		-1,		0,	-zzyzx,		unID,	D12,	3,		diameter	: unID=unID+1
		hotspot diameter1/2,0,	-zzyzx,		unID,	D12,	2,		diameter	: unID=unID+1
		rotz 90
	next i
	del 4
endif

if iShadeType = 5 or iShadeType = 6 or iShadeType = 8 or iShadeType = 9 or iShadeType = 11 or \
	iShadeType = 12 or iShadeType = 14 then

	for i=1 to 4
		hotspot		0,		0,	-zzyzx,		unID,	D12,	1+128,	diameter1	: unID=unID+1
		hotspot		-1,		0,	-zzyzx,		unID,	D12,	3,		diameter1	: unID=unID+1
		hotspot diameter1/2,0,	-zzyzx,		unID,	D12,	2,		diameter1	: unID=unID+1
		rotz 90
	next i
	del 4
endif

if iShadeType = 7 or iShadeType = 9 or iShadeType = 10 or iShadeType = 11 or iShadeType = 12 or \
	iShadeType = 13 or iShadeType = 14 then

	if iShadeType = 7 or iShadeType = 10 then
		hotspotHeight = -zzyzx
	else
		if iShadeType = 11 or iShadeType = 12 or iShadeType = 14then
			hotspotHeight = -zzyzx + shadeheight/2
		else
			if iShadeType = 9 then
				a_ellips = shadeheight / (1+cos(asn(diameter1/diameter)))
				cutheight = (shadeheight - a_ellips)
				mulfactor = a_ellips / (diameter/2)
				hotspotHeight = -zzyzx + shadeheight - a_ellips
			else
				hotspotHeight = -zzyzx + (shadeheight/0.265)*0.086
			endif
		endif
	endif

	for i=1 to 4
		hotspot 0,			0,	hotspotHeight ,	unID,	D2,	1+128,	diameter : unID=unID+1
		hotspot -1,			0,	hotspotHeight ,	unID,	D2,	3,		diameter : unID=unID+1
		hotspot diameter/2,	0,	hotspotHeight ,	unID,	D2,	2,		diameter : unID=unID+1
		rotz 90
	next i
	del 4
endif

gosub "LIGHT_CONE"

if iShadeType <> 15 then
	hotspot	0, 0, -ZZYZX,				unID,	shadeheight,1 : unID=unID+1
	hotspot	0, 0, -2*ZZYZX,				unID,	shadeheight,3 : unID=unID+1
	hotspot	0, 0, -ZZYZX+shadeheight,	unID,	shadeheight,2 : unID=unID+1
endif

if iShadeType = 2 then
	for i=1 to 4
		hotspot 0,	0,			-zzyzx+shadeheight,	unID,	D22,	1+128,	topwidth	: unID=unID+1
		hotspot -1,	0,			-zzyzx+shadeheight,	unID,	D22,	3,		topwidth	: unID=unID+1
		hotspot diameter2/2, 0,	-zzyzx+shadeheight,	unID,	D22,	2,		topwidth	: unID=unID+1
		rotz 90
	next i
	del 4
endif
if iShadeType = 5 then
	for i=1 to 4
		hotspot 0,	0,			-zzyzx+shadeheight,	unID,	D22,	1+128,	diameter2	: unID=unID+1
		hotspot -1,	0,			-zzyzx+shadeheight,	unID,	D22,	3,		diameter2	: unID=unID+1
		hotspot diameter2/2, 0,	-zzyzx+shadeheight,	unID,	D22,	2,		diameter2	: unID=unID+1
		rotz 90
	next i
	del 4
endif

! ==============================================================================

bLight = (gs_light_switch)

! ==============================================================================

pen gs_cont_pen
resol gs_resol
addz -zzyzx

! ==============================================================================
!	Shade 3D
! ==============================================================================

if iShadeType = 1 or iShadeType = 2 or iShadeType = 3 then
	gosub "SHADE_RECTANGLE"
endif
if iShadeType = 4 or iShadeType = 5 or iShadeType = 6 then
	gosub "SHADE_CONE"
endif
if iShadeType = 7 or iShadeType = 8  or iShadeType = 9 then
	gosub "SHADE_SPHERE"
endif
if iShadeType = 10 then
	gosub "SHADE_10"
endif
if iShadeType = 11 or iShadeType = 12 then
	gosub "SHADE_CUTSPHERE"
endif
if iShadeType = 13 then
	gosub "SHADE_13"
endif
if iShadeType = 14 then
	gosub "SHADE_14"
endif
if iShadeType = 15 then
	resol gs_resol

	roty -90

	!--- Cover ---
	material matFrame
	addx shadeheight  - 0.005
	revolve 4,360,1+2,
		0, rodthk/2,0,
		0, rodthk/2 + 0.002,0,
		0.04, rodthk/2 + 0.002,0,
		0.04, rodthk/2, 0

	del 1

	del 1
endif


! ==============================================================================
!	Frame 3D
! ==============================================================================

if iShadeType = 1 or iShadeType = 2 then
	framelength = sqr(2) * diameter2/2 - framethk/2 - shadethk
else
	if iShadeType = 11 then
		shthkang = acs((shadeheight/2)/(diameter/2))
		diffR = diameter/2 - (diameter/2)*(cos(360/gs_resol/2))
		framelength = diameter1/2 - diffR/ sin(shthkang) - shadethk / sin(shthkang)
	else
		if iShadeType = 12 then
			framelength = diameter1/2 - shadethk
		else
			framelength = diameter2/2 - shadethk
		endif
	endif
endif

if iShadeType = 1 or iShadeType = 2 or iShadeType = 4  or iShadeType = 5 or \
	iShadeType = 11 or iShadeType = 12 then
	gosub "SHADE_FRAME"
endif


! ==============================================================================
!	Mount 3D
! ==============================================================================

if gs_detlevel_3D_m = 2 then
	if iMountType = 1 then gosub "MOUNT_1"
	if iMountType = 2 then gosub "MOUNT_2"
	if iMountType = 3 then gosub "MOUNT_3"
	if iMountType = 4 then gosub "MOUNT_4"
endif


! ==============================================================================
!	Suspender 3D
! ==============================================================================

if iSuspenderType = 1 then
	rodthk = 0.0025
	resol max(gs_resol/4, 3)
else
	resol max(gs_resol/2, 3)
endif

if iSuspenderType = 1 then gosub "CABLE"
if iSuspenderType = 2 then gosub "CABLE"
if iSuspenderType = 3 then gosub "CHAIN"

! ==============================================================================
!	Bulb 3D
! ==============================================================================

if gs_detlevel_3D_m = 2 then gosub "BULB"

del 1

! ==============================================================================
end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! en
! ==============================================================================


! ==============================================================================
!	Light Cone
! ==============================================================================
"LIGHT_CONE":

	addz -zzyzx+shadeheight-0.03

	if iShadeType = 1 or iShadeType = 2 or iShadeType = 4  or iShadeType = 5 then
		addz -framethk
	else
		if iShadeType = 7 or iShadeType = 8 or iShadeType = 9 or iShadeType = 10 or iShadeType = 14 then
			addz  -0.005
		else
			if iShadeType = 11 or iShadeType = 12 then
				addz -shadeheight/2
			else
				if iShadeType = 13 then
					addz -shadeheight/0.265*(0.1778)
				else
					addz	0
				endif
			endif
		endif
	endif

	resol 36

	if gs_light_switch then

		lightUnID = 1000

		! ======================================================================
		! Non Visible Omni Light
		! ======================================================================

		call	"lightMacro_m" parameters		gs_light_switch						= gs_light_switch,
													gs_color_red						= gs_color_red,
													gs_color_green						= gs_color_green,
													gs_color_blue						= gs_color_blue,
													gs_light_intensity						= gs_light_intensity,
													iColorPreset			= iColorPreset,
													iLightGroupType			= LIGHTGROUP_BUILTIN_OMNI,
													iC4dDetAreaShape		= AREASHAPE_SPHERE,
													c4dDetAreaX				= 0.03,
													c4dDetAreaY				= 0.03,
													c4dDetAreaZ				= 0.03,
													bGenShadow				= bGenShadow,
													iShadowQuality			= iShadowQuality,
													iShadowQualityGroupType	= 2,
													iC4dGenVisibility		= 1,
													bDetShowFalloff 		= 1,
													iFalloffType			= FALLOFFTYPE_OMNI,
													c4dDetRadius			= c4dDetRadius,
													c4dPhoPhotometric		= c4dPhoPhotometric,
													iC4dPhoUnit				= iC4dPhoUnit,
													photoIntensityLumen		= photoIntensityLumen,
													photoIntensityCandela	= photoIntensityCandela,
													bShowIllumination3D		= bShowIllumination3D,
													gs_resol				= gs_resol,
													gs_cont_pen				= gs_cont_pen,
													penIllumination			= penIllumination,
													lightUnID				= lightUnID

	endif

	del 1		!--- addz
	del 1		!--- addz

return


! ==============================================================================
!	Shade Type 1-2-3
! ==============================================================================

"SHADE_RECTANGLE":

	resol 4

	if iShadeType = 1 then diameter2 = diameter1
	if iShadeType = 3 then diameter2 = sqr(2) * covermaxrad

	rotz 45
	roty -90
	addx shadeheight + coverheight

	!--- Cover ---
	material matFrame
	revolve 4,360,1+2+4+16+32+128,
		-2 7/8", 	coverminrad,			0,
		-3 33/64", 	covermaxrad - 0.007,	0,
		-4 5/32", 	covermaxrad - 0.007,	0,
		-4 5/16", 	covermaxrad, 			0

	del 3

	material matShadeOut

	sweep 10, 2, 0, diameter2/diameter1, 1+2+4+16+32,
		 diameter1/2,  diameter1/2, 15,
		-diameter1/2,  diameter1/2, 15,
		-diameter1/2, -diameter1/2, 15,
		 diameter1/2, -diameter1/2, 15,
		 diameter1/2,  diameter1/2, -1,

		 diameter1/2-shadethk/2,  diameter1/2-shadethk/2, 15,
		-diameter1/2+shadethk/2,  diameter1/2-shadethk/2, 15,
		-diameter1/2+shadethk/2, -diameter1/2+shadethk/2, 15,
		 diameter1/2-shadethk/2, -diameter1/2+shadethk/2, 15,
		 diameter1/2-shadethk/2,  diameter1/2-shadethk/2, -1,

		 0,	0, 0,
		 0,	0, shadeheight


	material matShadeIn

	sweep 10, 2, 0, diameter2/diameter1, 1+2+4+16+32,
		 diameter1/2-shadethk/2,  diameter1/2-shadethk/2, 15,
		-diameter1/2+shadethk/2,  diameter1/2-shadethk/2, 15,
		-diameter1/2+shadethk/2, -diameter1/2+shadethk/2, 15,
		 diameter1/2-shadethk/2, -diameter1/2+shadethk/2, 15,
		 diameter1/2-shadethk/2,  diameter1/2-shadethk/2, -1,

		 diameter1/2-shadethk,  diameter1/2-shadethk, 15,
		-diameter1/2+shadethk,  diameter1/2-shadethk, 15,
		-diameter1/2+shadethk, -diameter1/2+shadethk, 15,
		 diameter1/2-shadethk, -diameter1/2+shadethk, 15,
		 diameter1/2-shadethk,  diameter1/2-shadethk, -1,

		 0,	0, 0,
		 0,	0, shadeheight

return


! ==============================================================================
!	Shade Type 4-5-6  (6 = Hanging Lamp 01)
! ==============================================================================

"SHADE_CONE":

	resol gs_resol

	rotz -90
	roty -90
	addx shadeheight

	if iShadeType = 4 then diameter2 = diameter1
	if iShadeType = 6 then diameter2 = 2 * covermaxrad

	!--- Cover ---
	material matFrame
	addx coverheight
	revolve 4,360,1+2,
		-2 7/8", coverminrad,0,
		-3 33/64", covermaxrad - 0.007,0,
		-coverheight + 0.00396875, covermaxrad - 0.007,0,
		-coverheight, covermaxrad, 0
	del 1

	material matShadeOut
	revolve 4,360,0,
		  0,	diameter2/2-shadethk/2,	0,
		  0,	diameter2/2, 0,
		 -shadeheight, 			diameter1/2,			0,
		 -shadeheight, 			diameter1/2-shadethk/2,	0


	material matShadeIn
	revolve 4,360,0,
		  0,	diameter2/2-shadethk/2,	0,
		  0,	diameter2/2-shadethk, 0,
		 -shadeheight, 			diameter1/2-shadethk,	0,
		 -shadeheight, 			diameter1/2-shadethk/2,	0


	del 3

return


! ==============================================================================
!	Shade Type 7-8-9
! ==============================================================================

"SHADE_SPHERE":

	resol gs_resol

	roty -90

	!--- Cover ---
	material matFrame
	addx shadeheight  - 0.005
	revolve 4,360,1+2,
		0, rodthk/2,0,
		0, rodthk/2 + 0.002,0,
		0.04, rodthk/2 + 0.002,0,
		0.04, rodthk/2, 0

	del 1

	del 1

	!--- Lampshade ---

	cutheight = shadeheight-diameter
	mulfactor = 1

	if iShadeType = 7 then
		cutheight = 0
		mulfactor = shadeheight / (diameter/2)
	endif

	if iShadeType = 8 then
		cutheight = shadeheight-diameter/2
	endif

	if iShadeType = 9 then
		phi = asn(diameter1/diameter)
		a_ellips = shadeheight / (1+cos(phi))
		cutheight = (shadeheight - a_ellips)
		mulfactor = a_ellips / (diameter/2)
	endif

	addz cutheight

	rotx 180
	addz cutheight
	cutplane
	del 2

	mul 1, 1, mulfactor

	group "out"
		material matShadeOut
		sphere diameter/2
	endgroup

	group "in"
		material matShadeIn
		sphere diameter/2-shadethk
	endgroup

	placegroup subgroup("out","in")

	killgroup "out"
	killgroup "in"

	del 1

	cutend

	del 1

return


! ==============================================================================
!	Shade Type 10
! ==============================================================================

"SHADE_10":

	resol gs_resol

	roty -90

	!--- Cover ---
	material matFrame
	addx shadeheight  - 0.005
	revolve 4,360,1+2,
		0, 		rodthk/2,			0,
		0, 		rodthk/2 + 0.002,	0,
		0.04, 	rodthk/2 + 0.002,	0,
		0.04, 	rodthk/2, 			0

	del 1

	!--- Lampshade ---

	material matShadeOut
	revolve 6, 360, 0,
		0,							diameter/2 - shadethk/2,		1,
		0,							diameter/2,			1,
		shadeheight - diameter/2,	diameter/2, 		1,
		shadeheight - diameter/2,	0,    				900,
		0,							-90,   				4001,
		shadeheight, 				0,					1

	material matShadeIn
	revolve 6, 360, 0,
		0,							diameter/2 - shadethk/2,		1,
		0,							diameter/2 - shadethk,			1,
		shadeheight - diameter/2,	diameter/2 - shadethk, 			1,
		shadeheight - diameter/2,	0,    							900,
		0,							-90,   							4001,
		shadeheight, 	 			0,								1

	del 1

return


! ==============================================================================
!	Shade Type 11 - 12
! ==============================================================================

"SHADE_CUTSPHERE":

	resol gs_resol

	roty -90

	!--- Cover ---
	material matFrame
	addx shadeheight
	revolve 4,360,1+2,
		0, 		rodthk/2,			0,
		0, 		rodthk/2 + 0.002,	0,
		0.04, 	rodthk/2 + 0.002,	0,
		0.04, 	rodthk/2, 			0

	revolve 2,360,1+2,
		 0, 			0.0025/2, 0,
		-shadeheight/2, 0.0025/2, 0

	del 1

	del 1

	!--- Lampshade outside ---

	if iShadeType = 11 then

		cutheight = shadeheight/2

		addz cutheight

		rotx 180
		addz cutheight
		cutplane
		del 2

		addz cutheight
		cutplane
		del 1

		group "out11"
			material matShadeOut
			sphere diameter/2
		endgroup

		group "in11"
			material matShadeIn
			sphere diameter/2-shadethk
		endgroup

		placegroup subgroup("out11","in11")

		killgroup "out11"
		killgroup "in11"

		cutend
		cutend

		del 1

	endif

	if iShadeType = 12 then

		roty -90

		if abs(diameter-diameter1) > eps then

			shaderad = ((shadeheight/2)**2+(diameter/2-diameter1/2)**2)\
					/ (2*(diameter/2-diameter1/2))


			material matShadeIn
			revolve 4, 360, 0,
				0,				diameter1/2 - shadethk,   1,
				shadeheight/2,	diameter/2 - shaderad - shadethk,    900,
				shadeheight,	diameter1/2 - shadethk,   3001,
				shadeheight,	diameter1/2 - shadethk,   1

			material matShadeOut
			revolve 5, 360, 0,
				0,				diameter1/2 - shadethk,   1,
				0,				diameter1/2,   1,
				shadeheight/2,	diameter/2 - shaderad,    900,
				shadeheight,	diameter1/2,   3001,
				shadeheight,	diameter1/2 - shadethk,   1

		else

			material matShadeIn
			revolve 2, 360, 0,
				0,				diameter1/2 - shadethk,   1,
				shadeheight,	diameter1/2 - shadethk,   1

			material matShadeOut
			revolve 4, 360, 0,
				0,				diameter1/2 - shadethk,   1,
				0,				diameter1/2,   1,
				shadeheight,	diameter1/2,   1,
				shadeheight,	diameter1/2 - shadethk,   1

		endif

		del 1

	endif

return


! ==============================================================================
!	Shade Type 14
! ==============================================================================

"SHADE_14":

	resol gs_resol

	roty -90

	!--- Cover ---
	material matFrame
	addx shadeheight  - 0.005
	revolve 4,360,1+2,
		0, rodthk/2,0,
		0, rodthk/2 + 0.002,0,
		0.04, rodthk/2 + 0.002,0,
		0.04, rodthk/2, 0

	del 1

	!--- Lampshade ---
	material matShadeOut
	revolve 4, 360, 0,
		shadeheight,	0, 				1,
		shadeheight,	0.00001, 		1,
		shadeheight/2,	diameter/2, 	1001,
		0,				diameter1/2, 	1001


	material matShadeIn
	revolve 4, 360, 0,
		shadeheight - shadethk,		0,     						1,
		shadeheight - shadethk,		0.00001,     				1,
		shadeheight/2,	diameter/2 - shadethk, 	1001,
		0,					diameter1/2 - shadethk, 	1001

	del 1

return


! ==============================================================================
!	Shade Type 13  (Hanging Lamp 03)
! ==============================================================================

"SHADE_13":

	resol gs_resol
	material matShadeOut

	roty 90
	addx -(shadeheight)
	mul shadeheight/0.265, diameter/0.50, diameter/0.50

	material matShadeOut

	revolve 4, 360, 1+16+32,
			0.000, 0.000, 1,
			0.000, 0.031, 1,
			0.003, 0.033, 1,
			0.124, 0.043, 1

	revolve	6, 360, 2+16+32,
			0.0695, 0.1474, 1,
			0.0723, 0.1250, 1,
			0.0869, 0.0859, 1,
			0.1045, 0.0654, 1,
			0.1260, 0.0488, 1,
			0.1456, 0.0439, 1

	revolve	5, 360, 16+32,
			0.1260, 0.0488, 1,
			0.1237, 0.0986, 1,
			0.1325, 0.1497, 1,
			0.1516, 0.1993, 1,
			0.1787, 0.2500, 1

	revolve 5, 360, 1+16+32,
			0.1570, 0.0426, 1,
			0.1550, 0.0562, 1,
			0.1563, 0.0701, 1,
			0.1634, 0.0870, 1,
			0.1701, 0.0964, 1

	revolve 6, 360, 1+16+32,
			0.1701, 0.0511, 1,
			0.1769, 0.0674, 1,
			0.1886, 0.0821, 1,
			0.1993, 0.0908, 1,
			0.2150, 0.0987, 1,
			0.2364, 0.1035, 1

	revolve 6, 360, 1+16+32,
			0.1778, 0.0430, 1,
			0.1935, 0.0498, 1,
			0.2267, 0.0586, 1,
			0.2394, 0.0596, 1,
			0.2531, 0.0576, 1,
			0.2650, 0.0529, 1


	material matShadeIn

	revolve	5, 360, 16+32,
			0.1260+shadethk, 	0.0488-shadethk, 1,
			0.1237+shadethk, 	0.0986-shadethk, 1,
			0.1325+shadethk, 	0.1497-shadethk, 1,
			0.1516, 			0.1993-shadethk, 1,
			0.1787, 			0.2500-shadethk, 1

	revolve 5, 360, 1+16+32,
			0.1570+shadethk, 	0.0426-shadethk, 1,
			0.1550+shadethk, 	0.0562-shadethk, 1,
			0.1563+shadethk, 	0.0701-shadethk, 1,
			0.1634, 			0.0870-shadethk, 1,
			0.1701, 			0.0964-shadethk, 1

	revolve 6, 360, 1+16+32,
			0.1701+shadethk, 	0.0511-shadethk, 1,
			0.1769, 			0.0674-shadethk, 1,
			0.1886, 			0.0821-shadethk, 1,
			0.1993, 			0.0908-shadethk, 1,
			0.2150, 			0.0987-shadethk, 1,
			0.2364, 			0.1035-shadethk, 1

	revolve 6, 360, 1+16+32,
			0.1778+shadethk, 	0.0430-shadethk, 1,
			0.1935, 			0.0498-shadethk, 1,
			0.2267, 			0.0586-shadethk, 1,
			0.2394, 			0.0596-shadethk, 1,
			0.2531, 			0.0576-shadethk, 1,
			0.2650, 			0.0529-shadethk, 1


	material matShadeOut

	for i=1 To 3
		tube	2, 7, 16+32,
				0.000, 0.000, 901,
				0.002, 360.0, 4001,

				0.046, 0.105, 0, 1,
				0.075, 0.105, 0, 1,
				0.105, 0.104, 0, 1,
				0.134, 0.098, 0, 1,
				0.161, 0.087, 0, 1,
				0.185, 0.070, 0, 1,
				0.210, 0.053, 0, 1
		rotx 120
	next i
	del 6

return


! ==============================================================================
!	Suspender Type 1 - 2
! ==============================================================================

"CABLE":

	pen gs_cont_pen
	material matFrame

	roty -90
	addx zzyzx - suspenderheight

	revolve 2,360,1+2,
		0, rodthk/2 , 0,
		suspenderheight, rodthk/2 ,0

	del 2

return


! ==============================================================================
!	Suspender Type 3
! ==============================================================================

"CHAIN":

	material matFrame

	resol max(gs_resol/4, 3)
	gamma0 = 360/gs_resol
	r = 0.02
	alphac = -gamma0
	k = 0.65

	if gs_detlevel_3D_m = 2 then
		hMount = mountheight		! iMountType = 1 and iMountType = 2
		if iMountType = 3 then hMount = 0.02
		if iMountType = 4 then hMount = 0.025
		if iMountType = 5 then hMount = 0

		addz zzyzx-hMount
	else
		addz zzyzx
	endif

	cutplane

	del 1

	addz zzyzx-suspenderheight+0.036*(iShadeType <> 13)
	mulz -1
	cutplane
	del 2

	for i=1 to gs_resol+3 step 1
		put k*r*cos(alphac),r*sin(alphac),0,0
		alphac=alphac+gamma0
	next i

	addz zzyzx - suspenderheight

	nChain = int((suspenderheight)/1 11/32")+2
	rotz 90
	addz 17/32"

	for i=1 to nChain step 1
		rotx 90
		tube 6,(nsp/4),0,
			 5/64",0,1,
			 0,1,800,
			-5/64",0,1001,
			 0,-1,800,
			 5/64",0,1001,
			 5/64",0,-1,
			 use (nsp)

		del 1
		addz 1 11/32"
		rotz 90
	next i

	cutend
	cutend

	del 2*nChain
	del 2

	del 1

return


! ==============================================================================
!	Shade Frame
! ==============================================================================

"SHADE_FRAME":

	pen gs_cont_pen
	resol max(gs_resol/2, 3)

	rotz 45
	addz shadeheight-framethk/2
	roty 90

	material matFrame

	for i = 1 to 4
		cylind framelength, framethk/2
		rotx 90
	next i
	del 7

return


! ==============================================================================
!	Mount Type 1
! ==============================================================================

"MOUNT_1":

	pen gs_cont_pen
	material matFrame
	resol gs_resol

	addz zzyzx-mountheight
	cone mountheight,0.035,0.04,90,90

	del 1

return


! ==============================================================================
!	Mount Type 2
! ==============================================================================

"MOUNT_2":

	mountd = 0.08
	pen gs_cont_pen
	material matFrame
	resol gs_resol

	addz zzyzx
	roty 90

	revolve 11, 360, 0,
		0,	mountd/2,	1,
		0,	mountd/2 - shadethk,	1,
		mountheight - mountd/2,	mountd/2 - shadethk + 0.00001,      1,
		mountheight - mountd/2,	0,    900,
		0,	-90,   4001,
		mountheight- shadethk, 0.00001,	1,
		mountheight, 0,	1,
		mountheight - mountd/2, 0,    900,
		0,	90,   4001,
		mountheight - mountd/2,	mountd/2,	1,
		0,	mountd/2,	1

	del 2

return


! ==============================================================================
!	Mount Type 3
! ==============================================================================

"MOUNT_3":

	mountd = 0.08
	mounth = mountheight/4
	pen gs_cont_pen
	material matFrame
	resol gs_resol

	addz zzyzx - mounth
	cylind mounth, mountd /2
	del 1
return


! ==============================================================================
!	Mount Type 4
! ==============================================================================

"MOUNT_4":

	mountd = 0.08
	mounth = mountheight/4
	material matFrame
	resol gs_resol

	addz zzyzx - 1.25 * mounth
	cylind 0.25 * mounth, 1.1*mountd/2
	addz 0.25 * mounth
	cylind mounth, mountd /2
	del 2

return


! ==============================================================================
!	Bulb
! ==============================================================================

"BULB":

	if iShadeType = 1 or iShadeType = 2 or iShadeType = 4  or iShadeType = 5 then
		addz -framethk
	else
		if iShadeType = 7 or iShadeType = 8 or iShadeType = 9 or iShadeType = 10 then
			addz  -0.005
		else
			if iShadeType = 11 or iShadeType = 12 then
				addz -shadeheight/2
			else
				if iShadeType = 13 then
					addz -shadeheight/0.265*(0.1778)
				else
					addz	0
				endif
			endif
		endif
	endif

	pen gs_cont_pen
	resol gs_resol

	material "builtInMatLampBulb"

	rotz -90
	roty -90
	addx shadeheight

	revolve 5,360,0,
		-0.072232, 0, 1,
		 0, 1, 800,
		-0.023416, 0.018653125, 1001,
		-0.00635, 0.0111125, 1001,
		 0, 0.0111125, 0

	roty 90
	circle 0.0111125
	del 1

	del 3

	del 1

return
