

	! ======================================================================
	! Lamp Bulb Surface
	! ======================================================================
	
	DIM	tmp_C4D_ChCol_Color[3]
		tmp_C4D_ChCol_Color[1] = 0.7843137254902
		tmp_C4D_ChCol_Color[2] = 0.7843137254902
		tmp_C4D_ChCol_Color[3] = 0.8039215686275
	DIM	tmp_C4D_ShNoise_Color1_1[3]
		tmp_C4D_ShNoise_Color1_1[1] = 0
		tmp_C4D_ShNoise_Color1_1[2] = 0
		tmp_C4D_ShNoise_Color1_1[3] = 0
	DIM	tmp_C4D_ShNoise_Color2_1[3]
		tmp_C4D_ShNoise_Color2_1[1] = 1
		tmp_C4D_ShNoise_Color2_1[2] = 1
		tmp_C4D_ShNoise_Color2_1[3] = 1
	DIM	tmp_C4D_ShNoise_RelativeScale_1[3]
		tmp_C4D_ShNoise_RelativeScale_1[1] = 1
		tmp_C4D_ShNoise_RelativeScale_1[2] = 1
		tmp_C4D_ShNoise_RelativeScale_1[3] = 1
	DIM	tmp_C4D_ChLum_Color[3]
		tmp_C4D_ChLum_Color[1] = 1
		tmp_C4D_ChLum_Color[2] = 1
		tmp_C4D_ChLum_Color[3] = 1
	DIM	tmp_C4D_ChTra_Color[3]
		tmp_C4D_ChTra_Color[1] = 0.9411764705882
		tmp_C4D_ChTra_Color[2] = 0.9411764705882
		tmp_C4D_ChTra_Color[3] = 0.9411764705882
	DIM	tmp_C4D_ChTra_AbsorptionColor[3]
		tmp_C4D_ChTra_AbsorptionColor[1] = 1
		tmp_C4D_ChTra_AbsorptionColor[2] = 1
		tmp_C4D_ChTra_AbsorptionColor[3] = 1
	DIM	tmp_C4D_ChRef_Color[3]
		tmp_C4D_ChRef_Color[1] = 1
		tmp_C4D_ChRef_Color[2] = 1
		tmp_C4D_ChRef_Color[3] = 1
	DIM	tmp_C4D_ChEnv_Color[3]
		tmp_C4D_ChEnv_Color[1] = 1
		tmp_C4D_ChEnv_Color[2] = 1
		tmp_C4D_ChEnv_Color[3] = 1
	DIM	tmp_C4D_ChFog_Color[3]
		tmp_C4D_ChFog_Color[1] = 1
		tmp_C4D_ChFog_Color[2] = 1
		tmp_C4D_ChFog_Color[3] = 1
	DIM	tmp_C4D_ChAlp_Color[3]
		tmp_C4D_ChAlp_Color[1] = 1
		tmp_C4D_ChAlp_Color[2] = 1
		tmp_C4D_ChAlp_Color[3] = 1
	DIM	tmp_C4D_ChAlp_Delta[3]
		tmp_C4D_ChAlp_Delta[1] = 0.1
		tmp_C4D_ChAlp_Delta[2] = 0.1
		tmp_C4D_ChAlp_Delta[3] = 0.1
	DIM	tmp_C4D_ChSpe_Color[3]
		tmp_C4D_ChSpe_Color[1] = 1
		tmp_C4D_ChSpe_Color[2] = 1
		tmp_C4D_ChSpe_Color[3] = 1
	DIM	tmp_C4D_ChGlo_Color[3]
		tmp_C4D_ChGlo_Color[1] = 1
		tmp_C4D_ChGlo_Color[2] = 1
		tmp_C4D_ChGlo_Color[3] = 1
	DIM	tmp_C4D_GKRGB_Color_3[3]
		tmp_C4D_GKRGB_Color_3[1] = 0
		tmp_C4D_GKRGB_Color_3[2] = 0
		tmp_C4D_GKRGB_Color_3[3] = 0
	DIM	tmp_C4D_GKRGB_Color_4[3]
		tmp_C4D_GKRGB_Color_4[1] = 1
		tmp_C4D_GKRGB_Color_4[2] = 1
		tmp_C4D_GKRGB_Color_4[3] = 1
	
	define material	"builtInMatLampBulb" 0,
		0.941176, 0.968627, 0.952941,
		0.8, 0.1, 1, 0.88,
		79.52, 0.04,
		1, 1, 1,
		0, 0, 0, 0,
	ADDITIONAL_DATA		C4D_VER_MAIN= 1,
	C4D_VER_SUB						= 0,
	C4D_ChCol_State					= 1,
	C4D_ChCol_Color					= tmp_C4D_ChCol_Color,
	C4D_ChCol_Brightness			= 1,
	C4D_ChCol_MixMode				= "Normal",
	C4D_ChCol_MixStrength			= 1,
	C4D_ChDif_State					= 0,
	C4D_ChDif_Brightness			= 1,
	C4D_ChDif_Luminance				= 1,
	C4D_ChDif_Specular				= 1,
	C4D_ChDif_Reflection			= 1,
	C4D_ChDif_Texture				= "1",
	C4D_ShNoise_BlendMode_1			= "Normal",
	C4D_ShNoise_BlendStre_1			= 1,
	C4D_ShNoise_BlurOffset_1		= 0,
	C4D_ShNoise_BlurScale_1			= 0,
	C4D_ShNoise_Color1_1			= tmp_C4D_ShNoise_Color1_1,
	C4D_ShNoise_Color2_1			= tmp_C4D_ShNoise_Color2_1,
	C4D_ShNoise_Seed_1				= 665,
	C4D_ShNoise_Noise_1				= "Turbulence",
	C4D_ShNoise_Octaves_1			= 5,
	C4D_ShNoise_Space_1				= "Texture",
	C4D_ShNoise_GlobalScale_1		= 0.01,
	C4D_ShNoise_RelativeScale_1		= tmp_C4D_ShNoise_RelativeScale_1,
	C4D_ShNoise_Absolute_1			= 0,
	C4D_ShNoise_Cycles_1			= 0,
	C4D_ShNoise_LowClip_1			= 0,
	C4D_ShNoise_HighClip_1			= 1,
	C4D_ShNoise_Brightness_1		= 0,
	C4D_ShNoise_Contrast_1			= 0,
	C4D_ChDif_MixMode				= "Normal",
	C4D_ChDif_MixStrength			= 0.1,
	C4D_ChLum_State					= 0,
	C4D_ChLum_Color					= tmp_C4D_ChLum_Color,
	C4D_ChLum_Brightness			= 1,
	C4D_ChLum_MixMode				= "Normal",
	C4D_ChLum_MixStrength			= 1,
	C4D_ChTra_State					= 1,
	C4D_ChTra_Color					= tmp_C4D_ChTra_Color,
	C4D_ChTra_Brightness			= 0.95,
	C4D_ChTra_Refraction			= 1,
	C4D_ChTra_InternalReflections	= 1,
	C4D_ChTra_ExitReflection		= 0,
	C4D_ChTra_FresnelReflectivity	= 0.5,
	C4D_ChTra_Additive				= 0,
	C4D_ChTra_MixMode				= "Normal",
	C4D_ChTra_MixStrength			= 1,
	C4D_ChTra_AbsorptionColor		= tmp_C4D_ChTra_AbsorptionColor,
	C4D_ChTra_AbsorptionDistance	= 100,
	C4D_ChTra_Blurriness			= 0,
	C4D_ChTra_MinSamples			= 10,
	C4D_ChTra_MaxSamples			= 80,
	C4D_ChTra_Accuracy				= 0.5,
	C4D_ChRef_State					= 1,
	C4D_ChRef_Color					= tmp_C4D_ChRef_Color,
	C4D_ChRef_Brightness			= 0.1,
	C4D_ChRef_Additive				= 1,
	C4D_ChRef_MixMode				= "Normal",
	C4D_ChRef_MixStrength			= 1,
	C4D_ChRef_Blurriness			= 0,
	C4D_ChRef_MinSamples			= 5,
	C4D_ChRef_MaxSamples			= 128,
	C4D_ChRef_Accuracy				= 0.5,
	C4D_ChEnv_State					= 0,
	C4D_ChEnv_Color					= tmp_C4D_ChEnv_Color,
	C4D_ChEnv_Brightness			= 1,
	C4D_ChEnv_MixMode				= "Normal",
	C4D_ChEnv_MixStrength			= 1,
	C4D_ChEnv_TilesX				= 1,
	C4D_ChEnv_TilesY				= 1,
	C4D_ChEnv_Exclusive				= 0,
	C4D_ChFog_State					= 0,
	C4D_ChFog_Color					= tmp_C4D_ChFog_Color,
	C4D_ChFog_Brightness			= 1,
	C4D_ChFog_Distance				= 10,
	C4D_ChBum_State					= 0,
	C4D_ChBum_Strength				= 1,
	C4D_ChBum_MipFalloff			= 1,
	C4D_ChNor_State					= 0,
	C4D_ChNor_Strength				= 1,
	C4D_ChNor_Method				= "Tangent",
	C4D_ChNor_FlipX					= 0,
	C4D_ChNor_FlipY					= 0,
	C4D_ChNor_FlipZ					= 0,
	C4D_ChNor_SwapYZ				= 0,
	C4D_ChAlp_State					= 0,
	C4D_ChAlp_Color					= tmp_C4D_ChAlp_Color,
	C4D_ChAlp_Delta					= tmp_C4D_ChAlp_Delta,
	C4D_ChAlp_Invert				= 0,
	C4D_ChAlp_Soft					= 1,
	C4D_ChAlp_ImageAlpha			= 0,
	C4D_ChAlp_PreMultiplied			= 0,
	C4D_ChSpe_State					= 1,
	C4D_ChSpe_Color					= tmp_C4D_ChSpe_Color,
	C4D_ChSpe_Brightness			= 1,
	C4D_ChSpe_MixMode				= "Normal",
	C4D_ChSpe_MixStrength			= 1,
	C4D_ChSpe_Mode					= "Plastic",
	C4D_ChSpe_Width					= 0.45,
	C4D_ChSpe_Height				= 0.5,
	C4D_ChSpe_Falloff				= -0.05,
	C4D_ChSpe_InnerWidth			= 0,
	C4D_ChGlo_State					= 0,
	C4D_ChGlo_Color					= tmp_C4D_ChGlo_Color,
	C4D_ChGlo_Brightness			= 1,
	C4D_ChGlo_InnerStrength			= 1,
	C4D_ChGlo_OuterStrength			= 5,
	C4D_ChGlo_Radius				= 10,
	C4D_ChGlo_Random				= 0,
	C4D_ChGlo_Frequency				= 1,
	C4D_ChGlo_UseMatColor			= 1,
	C4D_ChDis_State					= 0,
	C4D_ChDis_Strength				= 1,
	C4D_ChDis_Height				= 0.5,
	C4D_ChDis_Type					= "IntensityCentered",
	C4D_ChDis_SubDivision			= 0,
	C4D_ChDis_Level					= 4,
	C4D_ChDis_RoundGeometry			= 0,
	C4D_ChDis_RoundContour			= 1,
	C4D_ChDis_MapRounded			= 1,
	C4D_ChDis_MapResult				= 0,
	C4D_ChDis_KeepEdges				= 0,
	C4D_ChDis_BestDistribution		= 1,
	C4D_ChGra_State					= 0,
	C4D_ChGra_Color					= "2",
	C4D_GradientRGB_Interpol_2		= "SmoothKnot",
	C4D_GradientRGB_Knots_2			= "3,4",
	C4D_GKRGB_Color_3				= tmp_C4D_GKRGB_Color_3,
	C4D_GKRGB_Intensity_3			= 1,
	C4D_GKRGB_Position_3			= 0,
	C4D_GKRGB_Bias_3				= 0.5,
	C4D_GKRGB_Color_4				= tmp_C4D_GKRGB_Color_4,
	C4D_GKRGB_Intensity_4			= 1,
	C4D_GKRGB_Position_4			= 1,
	C4D_GKRGB_Bias_4				= 0.5,
	C4D_ChGra_MixStrength			= 0.5,
	C4D_ChGra_Density				= 1,
	C4D_ChGra_Length				= 0.1,
	C4D_ChGra_Width					= 0.005,
	C4D_ChGra_Crinkle				= 0.1,
	C4D_ChGra_Bend					= 0.6,
	C4D_ChGra_Wetness				= 0.05,
	C4D_ChIll_GenerateGI			= 1,
	C4D_ChIll_GenGIStrength			= 1,
	C4D_ChIll_GenGISaturat			= 1,
	C4D_ChIll_ReceiveGI				= 1,
	C4D_ChIll_RecGIStrength			= 1,
	C4D_ChIll_RecGISaturat			= 1,
	C4D_ChIll_GIPortal				= 0,
	C4D_ChIll_GILight				= 0,
	C4D_ChIll_GenerateCaustics		= 1,
	C4D_ChIll_GenCausticsStrength	= 1,
	C4D_ChIll_ReceiveCaustics		= 1,
	C4D_ChIll_RecCausticsStrength	= 1,
	C4D_ChIll_Radius				= 0.1,
	C4D_ChIll_CausticsSamples		= 100,
	C4D_ChIll_Model					= "Blinn",
	C4D_ChIll_DiffuseFalloff		= 0,
	C4D_ChIll_DiffuseLevel			= 1,
	C4D_ChIll_Roughness				= 0.5
	
	
if gs_detlevel_3D_m = 0 then end
if gs_detlevel_3D_m = 1 then gs_resol=6

if GLOB_CONTEXT > 20 & GLOB_CONTEXT < 40 then gs_resol = 12

if not(gs_shadow) then shadow off

if bMigrationDrag then add -0.03, -0.03, 0

rotx rotAngleX

if bProject2D & ABS(rotAngleX) > EPS then
	addz -ZZYZX
	mulz -1
endif

! ==============================================================================
!	Hotspot Editing
! ==============================================================================
unID=1

if iMountType = 1 then

	hotspot	0,0,-ZZYZX+lh,unID,a,1+256 : unID=unID+1
	hotspot	-1,0,-ZZYZX+lh,unID,a,3 : unID=unID+1
	hotspot	a,0,-ZZYZX+lh,unID,a,2 : unID=unID+1

	hotspot	a,0,-ZZYZX+lh,unID,b,1+256 : unID=unID+1
	hotspot	a,-1,-ZZYZX+lh,unID,b,3 : unID=unID+1
	hotspot	a,b,-ZZYZX+lh,unID,b,2 : unID=unID+1

	hotspot	0,b,-ZZYZX+lh,unID,a,1+256 : unID=unID+1
	hotspot	-1,b,-ZZYZX+lh,unID,a,3 : unID=unID+1
	hotspot	a,b,-ZZYZX+lh,unID,a,2 : unID=unID+1

	hotspot	0,0,-ZZYZX+lh,unID,b,1+256 : unID=unID+1
	hotspot	-1,0,-ZZYZX+lh,unID,b,3 : unID=unID+1
	hotspot	0,b,-ZZYZX+lh,unID,b,2 : unID=unID+1

	hotspot a/2, b/2,  0, unID, ZZYZX, 1+256 : unID=unID+1
	hotspot a/2, b/2,  1, unID, ZZYZX, 3 : unID=unID+1
	hotspot a/2, b/2,  -ZZYZX, unID, ZZYZX, 2 : unID=unID+1

	if iLampType = 5 then
		hotspot b/1.75, b/2, 0
		hotspot a-b/1.75, b/2, 0
	else
		hotspot a/20, b/2, 0 : unID=unID+1
		hotspot a-a/20, b/2, 0 : unID=unID+1
	endif

endif

if iMountType = 2 or iMountType = 3 then

	hotspot	0,0,0,unID,a,1+256 : unID=unID+1
	hotspot	-1,0,0,unID,a,3 : unID=unID+1
	hotspot	a,0,0,unID,a,2 : unID=unID+1

	hotspot	a,0,0,unID,b,1+256 : unID=unID+1
	hotspot	a,-1,0,unID,b,3 : unID=unID+1
	hotspot	a,b,0,unID,b,2 : unID=unID+1

	hotspot	0,b,0,unID,a,1+256 : unID=unID+1
	hotspot	-1,b,0,unID,a,3 : unID=unID+1
	hotspot	a,b,0,unID,a,2 : unID=unID+1

	hotspot	0,0,0,unID,b,1+256 : unID=unID+1
	hotspot	-1,0,0,unID,b,3 : unID=unID+1
	hotspot	0,b,0,unID,b,2 : unID=unID+1

	if iMountType = 2 then
		hotspot	a/2,b/2,0,      unID, ZZYZX, 1+256 : unID=unID+1
		hotspot	a/2,b/2,1,      unID, ZZYZX, 3 : unID=unID+1
		hotspot	a/2,b/2,-ZZYZX, unID, ZZYZX, 2 : unID=unID+1
	else		! iMountType = 3
		addz -0.01
		hotspot	a/2,b/2, 0,      unID, ZZYZX, 1+256 : unID=unID+1
		hotspot	a/2,b/2,-1,      unID, ZZYZX, 3 : unID=unID+1
		hotspot	a/2,b/2, ZZYZX, unID, ZZYZX, 2 : unID=unID+1
		del 1
	endif

endif


! ==============================================================================
!	Lamp 3D
! ==============================================================================

pen gs_cont_pen
resol gs_resol
material matFrame

if iMountType = 1 then

	for i = 1 to 2
		if iLampType = 5 then
			add b/1.75, b/2, -ZZYZX+lh-0.02
		else
			add a/20, b/2, -ZZYZX+lh-0.01*(iLampType = 6)
		endif
		cylind fh+0.02*(iLampType = 5)+0.01*(iLampType = 6), 0.0025
		if gs_detlevel_3D_m=2 then
			addz fh+0.02*(iLampType = 5)+0.01*(iLampType = 6)
			mulz -1
			ellips 0.03, 0.03
			del 2
		endif
		del 1
		mulx -1
		addx -a
	next i
	del 4

	if iLampType = 1 then
		gosub "LAMP_1"
	endif
	if iLampType = 2 then
		gosub "LAMP_2"
	endif
	if iLampType = 3 then
		gosub "LAMP_3"
	endif
	if iLampType = 4 then
		gosub "LAMP_4"
	endif
	if iLampType = 5 then
		gosub "LAMP_5"
	endif
	if iLampType = 6 then
		gosub "LAMP_6"
	endif

endif

if iMountType = 2 then

	if iLampType = 1 then
		gosub "LAMP_7"
	endif
	if iLampType = 2 then
		gosub "LAMP_8"
	endif

endif

if iMountType = 3 then

	gosub "LAMP_9"

endif


! ==============================================================================
!	Fixture
! ==============================================================================

if iMountType = 3 then
	add (a-grating_a)/2, (b-grating_b)/2, -0.01+(scrtype_m = 0)*0.02
else
	add (a-grating_a)/2, (b-grating_b)/2, -ZZYZX+0.02*(iLampType = 5)+(scrtype_m = 0)*0.02
endif
call "Fluorescent_01" parameters a = grating_a, b = grating_b,
								lamp_combi_n=sm_n+1,
								lamp_combi_m=sm_m+1,
								combi_mat=matScreen,
								glass_mat=matGlass,
								combi_type=scrtype_m,
								lamp_combi_h=grating_h	!0.6*ZZYZX-0.02
del 1

material matFrame


! ==============================================================================
!	Tubes
! ==============================================================================

define material	"myLamp"  	0, 						!for lampshade inside surface
							gs_color_red, gs_color_green, gs_color_blue, 				!RGB
							0.15,  0.95,  0.9, 0, 	!ambient,diffuse,specular,transparent coeff.-s
							80, 1, 					!shining, transparency att.
							1, 1, 1, 				!Specular RGB
							gs_color_red, gs_color_green, gs_color_blue, 				!Emission RGB
							0.4 					!Emission att.

bLight = (gs_light_switch)

if bLight then gosub "FakeFalloff"

material "builtInMatLampBulb"

for i = 1 to nTubes
	if iMountType = 3 then
		add frameWidth, frameWidth+i*(b-2*frameWidth)/(nTubes+1), ZZYZX*2/3-0.01
	else
		add frameWidth, frameWidth+i*(b-2*frameWidth)/(nTubes+1), -ZZYZX+(lh*2/3)-0.025*(iLampType = 6)-(lh*0.15)*(iLampType = 5)
	endif

	roty 90

	if gs_detlevel_3D_m = 2 then
		prism_ 4, A - 2 * frameWidth,
			0,		0,		979,
			0.015,	360,	4079,
			0,		0,		979,
			0.013,	360,	4079
	endif

	if bLight then gosub "C4D_light"

	del 2
next i


if bMigrationDrag then del 1

! ==============================================================================
end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! en
! ==============================================================================



! ==============================================================================
!	Lamp Type 1
! ==============================================================================

"LAMP_1":

	addz -ZZYZX
	prism_	10, 5/6*lh,
			0, 0, 11,
			a, 0, 11,
			a, b, 11,
			0, b, 11,
			0, 0, -1,

			b/15, b/15, 15,
			a-b/15, b/15, 15,
			a-b/15, b-b/15, 15,
			b/15, b-b/15, 15,
			b/15, b/15, -1

	addz 5/6*lh
	prism_	5, 1/6*lh,
			0, 0, 14,
			a, 0, 14,
			a, b, 14,
			0, b, 14,
			0, 0, -1
	del 2


return


! ==============================================================================
!	Lamp Type 2
! ==============================================================================

"LAMP_2":

	addz -ZZYZX+lh
	rotz 90
	rotx 90
	addz b/15

	if scrtype_m=3 then
		prism_ 9,  a-2*b/15,
				0,				0,				600+79,
				0.5*b,			0,				900,
				0,				180,			4000+15,
				b,				0,				15,
				b-b*0.2,		0,				15,
				b-b*0.2,		-0.2*b,			15,
				b*0.2,			-0.2*b,			15,
				b*0.2,			0,				15,
				0,				0,				79
		lin_  0, 0, 0, 0, 0, a-2*b/15
	else
		prism_ 7,  a-2*frameWidth,
				0.65*b,	-0.5*COS(ASN(0.3))*b,	79,
				0.5*b,			0,				900,
				0,				(90-ASN(0.3)),	4000+15,
				b,				0,				15,
				0,				0,				15,
				0.5*b,			0,				900,
				0,				(90-ASN(0.3)),	4000+7
	endif

	del 1

	addZ a-frameWidth
	prism_ 	5,	frameWidth,
			0,				0,				600+79,
			0.5*b,			0,				900,
			0,				180,			4000+79,
			b,				0,				79,
			0,				0,				79
	del 1

	addz frameWidth
	addx b
	roty 180
	prism_ 	5,	frameWidth,
			0,				0,				600+79,
			0.5*b,			0,				900,
			0,				180,			4000+79,
			b,				0,				79,
			0,				0,				79

	del 6
return


! ==============================================================================
!	Lamp Type 3
! ==============================================================================

"LAMP_3":

	addZ -fh
	rotZ 90
	rotX 90

	addZ frameWidth
	mulx b
	muly lh/0.5803
	prism_ 13,  a-2*frameWidth,
			0.2687,	-0.2776,	15,
			0.2541,	-0.5803,	15,
			0.2950,	-0.5803,	15,
			0.2950,	-0.2776,	2,
			0.7050,	-0.2776,	15,
			0.7050,	-0.5803,	15,
			0.74,	-0.5803,	15,
			0.7313,	-0.2776,	79,
			0.5,	 0.2152,	900,
			1,	0,	3000+15,
			0,		 0,			79,
			0.5,	 0.2152,	900,
			0.2687,	-0.2776,	3000+15
	del 3


	for i = 1 to 2
		mulx b
		muly lh/0.5803
		prism_ 9,  frameWidth,
				0.2687,	-0.2776,	15,
				0.2541,	-0.5803,	15,
				0.74,	-0.5803,	15,
				0.7313,	-0.2776,	79,
				0.5,	 0.2152,	900,
				1,	0,	3000+15,
				0,		 0,			79,
				0.5,	 0.2152,	900,
				0.2687,	-0.2776,	3000+15
		del 2
		addZ a-frameWidth
	next i
	del 5

return


! ==============================================================================
!	Lamp Type 4
! ==============================================================================

"LAMP_4":

	addZ -fh
	rotZ 90
	rotX 90

	addZ b/15
	prism_ 15, a-2*frameWidth,
		frameWidth, 	-frameWidth, 		15,
		b-frameWidth, 	-frameWidth,		15,
		b-frameWidth, 	-lh,		79,
		b-frameWidth, frameWidth-lh,		900,
		b, 		frameWidth-lh,		3000+79,
		b,		-frameWidth,		79,
		b-frameWidth,  -frameWidth,		900,
		b-frameWidth,  0,			3000+79,
		frameWidth, 	0,			79,
		frameWidth, 	-frameWidth, 		900,
		0,		-frameWidth,		3000+79,
		0,		frameWidth-lh,		79,
		frameWidth,	frameWidth-lh,		900,
		frameWidth, 	-lh,		3000+79,
		frameWidth, 	-frameWidth,		15

	addx b/15
	prism_ 14, a-2*frameWidth,
		0,					-lh/3,		15,
		(b-2*b/15)/4-0.02,	-lh/3,		79,
		(b-2*b/15)/4,		-lh/3,		900,
		0,					-180,		4000+79,
		(b-2*b/15)/2-0.02,	-lh/3,		79,
		(b-2*b/15)/2,		-lh/3,		900,
		0,					-180,		4000+79,
		3*(b-2*b/15)/4-0.02, -lh/3,		79,
		3*(b-2*b/15)/4,		-lh/3,		900,
		0,					-180,		4000+79,
		b-2*b/15,			-lh/3,		15,
		b-2*b/15,			0,			15,
		0,					0,			15,
		0,					-lh/3,		15

	del 2

	addZ a-frameWidth
	for i = 1 to 2
		fprism_  matFrame, matFrame, matFrame, matFrame,
			 13, frameWidth, 45, b/15,
			b-frameWidth, 	-lh,		79,
			b-frameWidth, frameWidth-lh,		900,
			b, 		frameWidth-lh,		3000+79,
			b,		-frameWidth,		79,
			b-frameWidth,  -frameWidth,		900,
			b-frameWidth,  0,			3000+79,
			frameWidth, 	0,			79,
			frameWidth, 	-frameWidth, 		900,
			0,		-frameWidth,		3000+79,
			0,		frameWidth-lh,		79,
			frameWidth,	frameWidth-lh,		900,
			frameWidth, 	-lh,		3000+79,
			b-frameWidth, 	-lh,		79
		addz -a+2*frameWidth
		addx b
		roty 180
	next i
	del 10

return


! ==============================================================================
!	Lamp Type 5
! ==============================================================================

"LAMP_5":

	resol  max(15, gs_resol)

	add a/2, b/2, -(ZZYZX-lh)
	rotz 90

	addz -lh

	GROUP "g1"
		rotX 90
		add 0, -lh/2, -b/1.5/2
		mulx b/4
		muly lh/1.1622
		prism_ 9, b/1.5,
				-1.7966, 0.2840, 600+79,
				-1.7, 0, 900,
				-1.7966, -0.2840, 3000+79,
				0, 5, 900,
				1.7966, -0.2840, 3000+79,
				1.7, 0, 900,
				1.7966, 0.2840, 3000+79,
				0, -5, 900,
				-1.7966, 0.2840, 3000+79
		del 4
	ENDGROUP

	GROUP "g4"
		add 0, a/2-b/1.5, -lh/2-lh+0.03
		rotx 90
		prism_ 8, a-2*b/1.5,
				-kx/2, 0, 15,
				-kx/2, lh-0.075, 15,
				-b/2+0.03, lh-0.04, 15,
				-b/2+0.03, lh, 15,
				 b/2-0.03, lh, 15,
				 b/2-0.03, lh-0.04, 15,
				 kx/2, lh-0.075, 15,
				 kx/2, 0, 15
		del 2
	ENDGROUP

	GROUP "g2"
		rotX 90
		add 0, -lh/2, -(a-2*b/1.5)/2
		mulx b/4
		muly lh/1.1622
		prism_ 9, a-2*b/1.5,
				-1.7966, 0.2840, 600+79,
				-1.7, 0, 900,
				-1.7966, -0.2840, 3000+79,
				0, 5, 900,
				1.7966, -0.2840, 3000+79,
				1.7, 0, 900,
				1.7966, 0.2840, 3000+79,
				0, -5, 900,
				-1.7966, 0.2840, 3000+79
		del 4
	ENDGROUP

	GROUP "g6"
		add kx/2-0.004, -(a-2*b/1.5)/2, -lh
		BLOCK b/2, a-2*b/1.5, lh
		addX -(kx/2-0.004)*2-b/2
		BLOCK b/2, a-2*b/1.5, lh
		del 2
	ENDGROUP

	GROUP "g3"
		rotz 90
		rotX 90
		add -b/1.5/2+b/2, -lh/2, -a/2
		mulx b/4
		muly lh/1.1622
		prism_ 8, a,
				0, 1.1622/2, 615,
				-1.7966, 0.2840, 79,
				-1.7, 0, 900,
				-1.7966, -0.2840, 3079,
				0, -1.1622/2, 79,
				-2.5, -1.1622/2, 15,
				-2.5, 1.1622/2, 15,
				0, 1.1622/2, 15
		del 5
	ENDGROUP

	material matGlass
	GROUP "g5"
		rotX 90
		add 0, -lh/2, -(a-2*b/1.5)/2
		mul b/4, lh/1.1622, 1
		resol  max(15, gs_resol)
		prism_ 4, a-2*b/1.5,
				-1.7966, -0.2840, 600+79,
				0, 5, 900,
				1.7966, -0.2840, 3000+79,
				-1.7966, -0.2840, -1
		resol gs_resol
		del 3
	ENDGROUP

	del 1

	addY -(a-2*b/1.5)/2-b/1.5/2
	PLACEGROUP subgroup ("g1", "g3")
	del 1
	addY (a-2*b/1.5)/2+b/1.5/2
	rotZ -180
	PLACEGROUP subgroup ("g1", "g3")
	del 2
	PLACEGROUP subgroup ("g2", "g4")

	KILLGROUP "g1"
	KILLGROUP "g2"
	KILLGROUP "g3"
	KILLGROUP "g4"
	KILLGROUP "g5"
	KILLGROUP "g6"

	del 2

	resol gs_resol

return


! ==============================================================================
!	Lamp Type 6
! ==============================================================================

"LAMP_6":

	resol gs_resol

	addZ -fh
	rotZ 90
	rotX 90

	addZ b/15
	prism_ 23,  a-2*b/15,
			b/15,	-lh+b/15,	79,
			b/15,	-lh,		79,
			b/15,	-lh+b/15,	900,
			0,		-lh+b/15,	3000+79,
			b/2,	-lh+b/15,	900,
			b,		-lh+b/15,	3000+79,
			b-b/15,	-lh+b/15,	900,
			b-b/15,	-lh,		3000+79,
			b-b/15,	-lh+b/15,	79,
			b/2,	-lh+b/15,	900,
			b/2+(lh-b/15*2)*cos(30),	-lh/2,	3000+79,
			b/15+3*(b-2*b/15)/4+0.02,	-lh/2,	79,
			b/15+3*(b-2*b/15)/4,		-lh/2,	900,
			0,						 180,	4000+79,
			b/15+(b-2*b/15)/2+0.02,	-lh/2,	79,
			b/15+(b-2*b/15)/2,		-lh/2,	900,
			0,						 180,	4000+79,
			b/15+(b-2*b/15)/4+0.02,	-lh/2,	79,
			b/15+(b-2*b/15)/4,		-lh/2,	900,
			0,						 180,	4000+79,
			b/2-(lh-b/15*2)*cos(30),	-lh/2,	79,
			b/2,	-lh+b/15,	900,
			b/15,	-lh+b/15,	3000+79
	del 1

	addZ a-b/15
	fprism_  matFrame, matFrame, matFrame, matFrame,
			 8, b/15, 45, b/15,
			b/15,	-lh,		600+79,
			b/15,	-lh+b/15,	900,
			0,		-lh+b/15,	3000+79,
			b/2,	-lh+b/15,	900,
			b,		-lh+b/15,	3000+79,
			b-b/15,	-lh+b/15,	900,
			b-b/15,	-lh,		3000+79,
			b/15,	-lh,		79
	del 1

	addz b/15
	addx b
	roty 180
	fprism_  matFrame, matFrame, matFrame, matFrame,
			 8, b/15, 45, b/15,
			b/15,	-lh,		600+79,
			b/15,	-lh+b/15,	900,
			0,		-lh+b/15,	3000+79,
			b/2,	-lh+b/15,	900,
			b,		-lh+b/15,	3000+79,
			b-b/15,	-lh+b/15,	900,
			b-b/15,	-lh,		3000+79,
			b/15,	-lh,		79
	del 6

return


! ==============================================================================
!	Lamp Type 7 - Ceiling 01
! ==============================================================================

"LAMP_7":

	pen gs_cont_pen
	resol gs_resol
	material matFrame

	prism_	10, -ZZYZX,
			0, 0, 15,
			a, 0, 15,
			a, b, 15,
			0, b, 15,
			0, 0, -1,

			frameWidth, frameWidth, 11,
			a - frameWidth, frameWidth, 11,
			a - frameWidth, b - frameWidth, 11,
			frameWidth, b - frameWidth, 11,
			frameWidth, frameWidth, -1

	prism_	5, -ZZYZX/3+0.017,
			frameWidth, frameWidth, 11,
			a - frameWidth, frameWidth, 11,
			a - frameWidth, b - frameWidth, 11,
			frameWidth, b - frameWidth, 11,
			frameWidth, frameWidth, -1


return


! ==============================================================================
!	Lamp Type 8 - Ceiling 02
! ==============================================================================

"LAMP_8":

	rotz 90
	rotx 90

	rr = frameWidth!ZZYZX/3
	hh = frameWidth
	side_angle = ATN(hh/rr)

	addz hh
	prism_ 15, a-2*hh,
			rr, 	-ZZYZX/6, 	15,
			b-rr, 	-ZZYZX/6, 	15,
			b-rr, 	-ZZYZX, 	79,
			b-rr, 	 rr-ZZYZX, 	900,
			b, 		 rr-ZZYZX, 	3000+79,
			b, 		-rr, 		79,
			b-rr, 	-rr, 		900,
			b-rr, 	 0, 		3000+79,
			rr, 	 0, 		79,
			rr, 	-rr, 		900,
			0, 		-rr, 		3000+79,
			0, 		 rr-ZZYZX, 	79,
			rr, 	 rr-ZZYZX, 	900,
			rr, 	-ZZYZX, 	3000+79,
			rr, 	-rr, 		15
	del 1

	addz a-hh
	fprism_ matFrame, matFrame, matFrame, matFrame,
			13, hh+0.001, side_angle, hh,
			b-rr,  	-ZZYZX,		79,
			b-rr,    rr-ZZYZX,	900,
			b, 		 rr-ZZYZX,	3000+79,
			b,		-rr,		79,
			b-rr,  	-rr,		900,
			b-rr,    0,			3000+79,
			rr, 	 0,			79,
			rr, 	-rr, 		900,
			0,		-rr,		3000+79,
			0,		 rr-ZZYZX,	79,
			rr,	 	 rr-ZZYZX,	900,
			rr, 	-ZZYZX,		3000+79,
			b-rr, 	-ZZYZX,		79
	del 1

	addz hh
	addx b
	roty 180

	fprism_  matFrame, matFrame, matFrame, matFrame,
			13, hh+0.001, side_angle, hh,
			b-rr, 	-ZZYZX,		79,
			b-rr,  	 rr-ZZYZX,	900,
			b, 		 rr-ZZYZX,	3000+79,
			b,		-rr,		79,
			b-rr,  	-rr,		900,
			b-rr,  	 0,			3000+79,
			rr, 	 0,			79,
			rr, 	-rr, 		900,
			0,		-rr,		3000+79,
			0,		 rr-ZZYZX,	79,
			rr,	 	 rr-ZZYZX,	900,
			rr, 	-ZZYZX,		3000+79,
			b-rr, 	-ZZYZX,		79

	del 5

return


! ==============================================================================
!	Lamp Type 9 - Recessed 01/02
! ==============================================================================

"LAMP_9":

	add 0.03, 0.03, 0

	bb=b-0.04
	aa=a-0.04

	addz ZZYZX-0.01

	add -0.01, -0.01, 0
	extrude	5, 0, 0, -(ZZYZX-0.03), 2+16+32,
			0.01, 0.01, 0,
			aa-0.01, 0.01, 0,
			aa-0.01, bb-0.01, 0,
			0.01, bb-0.01, 0,
			0.01, 0.01, 0

	addZ -(ZZYZX-0.03)
	plane_	10,
			0,	0,	0, 1,
			aa,	0,	0, 1,
			aa, bb,	0, 1,
			0,	bb,	0, 1,
			0,	0,	0, -1,
			0.01, 0.01,	0, 1,
			aa-0.01, 0.01,	0, 1,
			aa-0.01, bb-0.01,	0, 1,
			0.01, bb-0.01,	0, 1,
			0.01, 0.01,	0, -1

	addZ -0.02
	extrude	5, 0, 0, 0.020, 16+32,
			0,	0,	0,
			aa,	0,	0,
			aa, bb,	0,
			0,	bb,	0,
			0,	0,	0

	bb=b
	aa=a
	add -0.02, -0.02, -0.01
	PRISM_ 10, 0.01,
			0,	0,	15,
			aa,	0,	15,
			aa, bb,	15,
			0,	bb,	15,
			0,	0,	-1,
			0.021,		0.021,	15,
			aa-0.021,	0.021,	15,
			aa-0.021,	bb-0.021,	15,
			0.021,		bb-0.021,	15,
			0.021,		0.021,	-1

	del 4

	material matScreen
	add -0.009, -0.009, -ZZYZX
	PRISM_ 10, 0.001,
			0,		0,		15,
			a-0.042,	0,		15,
			a-0.042,	b-0.042,	15,
			0,		b-0.042,	15,
			0,		0,		-1,
			0.01,	0.01,	15,
			a-0.052,	0.01,	15,
			a-0.052,	b-0.052,	15,
			0.01,	b-0.052,	15,
			0.01,	0.01,	-1
	del 3
return


! ==============================================================================
"C4D_light":
! ==============================================================================

	addz A/2 - frameWidth
	roty -90

	lightUnID = 1 + i * 1000

	! ======================================================================
	! Non Visible Area Light
	! ======================================================================

	call "lightMacro_m" parameters		gs_light_switch						= gs_light_switch,
										gs_color_red						= gs_color_red,
										gs_color_green						= gs_color_green,
										gs_color_blue						= gs_color_blue,
										gs_light_intensity						= gs_light_intensity,
										iColorPreset			= iColorPreset,
										iLightGroupType			= LIGHTGROUP_BUILTIN_NONVIS_AREA,
										iC4dDetAreaShape		= AREASHAPE_PCYLIND,
										c4dDetAreaX				= A - 2 * frameWidth,
										c4dDetAreaY				= 0.02,
										c4dDetAreaZ				= 0.02,
										bGenShadow				= bGenShadow,
										iShadowQuality			= iShadowQuality,
										iShadowQualityGroupType	= 3,
										iC4dGenVisibility		= 1,
										bDetShowFalloff 		= 1,
										iFalloffType			= FALLOFFTYPE_PYRAMID,
										c4dDetRadius			= c4dDetRadius,
										c4dDetFalloffAngle		= 130,
										bFixFalloffAngle		= 1,
										c4dPhoPhotometric		= c4dPhoPhotometric,
										iC4dPhoUnit				= iC4dPhoUnit,
										photoIntensityLumen		= photoIntensityLumen,
										photoIntensityCandela	= photoIntensityCandela,
										bShowIllumination3D		= 0,
										gs_resol				= gs_resol,
										gs_cont_pen				= gs_cont_pen,
										penIllumination			= penIllumination,
										iModelType				= iModelType,
										lightUnID				= lightUnID

	del 2

return


"FakeFalloff":

	if iMountType = 3 then
		add A/2, B/2, -0.01
	else
		add A/2, B/2, -ZZYZX
	endif

	call "lightMacro_m" parameters		iLightGroupType		= LIGHTGROUP_BUILTIN_FALLOFF,
										iFalloffType		= FALLOFFTYPE_PYRAMID,
										c4dDetAreaX			= A - 2 * frameWidth,
										c4dDetAreaY			= B - 2 * frameWidth,
										c4dDetRadius		= c4dDetRadius,
										c4dDetFalloffAngle	= 130,
										bFixFalloffAngle	= 1,
										c4dPhoPhotometric	= c4dPhoPhotometric,
										bShowIllumination3D	= bShowIllumination3D,
										penIllumination		= penIllumination,
										iModelType			= iModelType,
										gs_resol			= gs_resol,
										lightUnID			= unID + 1000

	del 1

return

