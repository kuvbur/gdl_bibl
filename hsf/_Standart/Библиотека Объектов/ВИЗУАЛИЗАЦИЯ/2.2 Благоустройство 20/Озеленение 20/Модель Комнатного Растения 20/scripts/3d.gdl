
if iRoomPlantType = PLANT_TYPE1 then
	MULx A/0.382
	MULy B/0.389
else
	if iRoomPlantType = PLANT_TYPE2 then
		MULx A/0.64
		MULy B/0.64
	else
		if iRoomPlantType = PLANT_TYPE3 then
			MULx A/0.381
			MULy B/0.528
		endif
	endif
endif


If iDetlevel3D = DETLEVEL3D_OFF then end
If iDetlevel3D = DETLEVEL3D_SIMPLE then gs_resol=12

IF gs_shadow=0 THEN SHADOW OFF


!!!!!!!*************************************
!!!!!!!*************************************  Materials
!!!!!!!*************************************

DEFINE TEXTURE "Texture1" "bark1(13)",        0.5,     1.0307,   64,          0

DEFINE MATERIAL "bark01" 20,
	  0.433326,   0.166827,  0.0618448,
	  0.6,  0.85,  0.15,     0,      5,     0,
	  0.657053,   0.519249,    0.45153,
			 0,          0,          0,
			 0,    -1,    -1,
	IND(TEXTURE, "Texture1")

DEFINE TEXTURE "Texture2" "leaf1(13)",          3,          3,    0,          0

DEFINE MATERIAL "leafs1" 20,
	 0.0527962,   0.348867,   0.122103,
	  0.6,  0.95,     0,     0,      0,     0,
			 1,          1,          1,
			 0,          0,          0,
			 0,    -1,    -1,
	IND(TEXTURE, "Texture2")

DEFINE TEXTURE "Texture3" "bark2(13)",        0.3,   0.694161,   64,          0

DEFINE MATERIAL "bark02" 20,
	  0.433326,   0.166827,  0.0618448,
	  0.6,  0.85,  0.15,     0,      5,     0,
	  0.657053,   0.519249,    0.45153,
			 0,          0,          0,
			 0,    -1,    -1,
	IND(TEXTURE, "Texture3")

DEFINE TEXTURE "Texture4" "leaf2(13)",          2,          2,    0,          0

DEFINE MATERIAL "leafs2" 20,
	 0.0527962,   0.348867,   0.122103,
	  0.6,  0.95,     0,     0,      0,     0,
			 1,          1,          1,
			 0,          0,          0,
			 0,    -1,    -1,
	IND(TEXTURE, "Texture4")

DEFINE TEXTURE "Texture5" "bark3(13)",        0.3,   0.429114,  448,          0

DEFINE MATERIAL "bark03" 20,
	  0.433326,   0.166827,  0.0618448,
	  0.6,  0.85,  0.15,     0,      5,     0,
	  0.657053,   0.519249,    0.45153,
			 0,          0,          0,
			 0,    -1,    -1,
	IND(TEXTURE, "Texture5")

DEFINE TEXTURE "Texture6" "leaf3(13)",          3,          3,    0,          0

DEFINE MATERIAL "leafs3" 20,
	 0.0527962,   0.348867,   0.122103,
	  0.6,  0.95,     0,     0,      0,     0,
			 1,          1,          1,
			 0,          0,          0,
			 0,    -1,    -1,
	IND(TEXTURE, "Texture6")

DEFINE TEXTURE "Texture7" "bark4(13)",        0.8,    1.12903,   64,          0

DEFINE MATERIAL "bark04" 20,
	  0.433326,   0.166827,  0.0618448,
	  0.6,  0.85,  0.15,     0,      5,     0,
	  0.657053,   0.519249,    0.45153,
			 0,          0,          0,
			 0,    -1,    -1,
	IND(TEXTURE, "Texture7")

DEFINE TEXTURE "Texture8" "leaf4(13)",          2,          2,    0,          0

DEFINE MATERIAL "leafs4" 20,
	 0.0527962,   0.348867,   0.122103,
	  0.6,  0.95,     0,     0,      0,     0,
			 1,          1,          1,
			 0,          0,          0,
			 0,    -1,    -1,
	IND(TEXTURE, "Texture8")



!!!!!!!*************************************
!!!!!!!*************************************  Object
!!!!!!!*************************************

pen gs_cont_pen
resol gs_resol

!!!!!!!*************************************
!!!!!!!*************************************  Pot
!!!!!!!*************************************
material pmat


if iRoomPlantType = PLANT_TYPE3 then
	roty -90
	revolve 7,360,1+2,
		0,0.13,1,
		0.01,0.14,1,
		0.2,0.14,1,
		0.21,0.15,1,
		0.22,0.14,1001,
		0.21,0.13,1,
		0.02,0.13,1

	del 1

	addz 0.02
	rotz 90

	material emat
	prism_ 2,0.18,
	0,0,979,
	0.13,360,4079
	del 1
else
	if	iRoomPlantType = PLANT_TYPE1 |\
		iRoomPlantType = PLANT_TYPE2 then

		roty -90
		revolve 15,360,1+2,
			0.0,	0.0,	 1,
			0.0,	0.05,	 1,
			0.02,	0.05,	 1,
			0.12,	0.05,	 900,
			0.0,	-90.0,	4001,
			0.12,	0.15,	 1,
			0.12,	0.1,	 900,
			0.0,	-90.0,	4001,
			0.17,	0.1,	 1,
			0.191923,	0.115394,	 1,
			0.194471,	0.110487,	 900,
			0.0,	 -177.4443,	4001,
			0.197236,	0.105699,	 1,
			0.174673,	0.089857,	 1,
			0.16,	0.089857,	 1
		del 1
		
		addz 0.16
		rotz 90
	
		material emat
		prism_ 2,0.01,
		0,0,979,
		0.089857,360,4079
		del 2
	else
		if iRoomPlantType = PLANT_TYPE4 then
			MULX	 A/0.691402
			MULY	 B/0.691402
		else
			MULX	 A/0.5494
			MULY	 B/0.5137
		endif
		roty -90
		revolve 6, 360, 1+2,
			0,			0.3/2-0.016, 	2,
			0.02,		0.3/2-0.016,	2,
			0.02,		0.3/2,			2,
			0.31,		0.3/2,			2,
			0.31,		0.3/2-0.01,		2,
			0.02,	0.3/2-0.01,		2
		del 1

		rotz 90
		addz 0.02
		material emat

		prism_ 2, 0.31-0.02-0.02,
			0, 0, 979,
			0.3/2-0.01, 360, 4079

		del 2
		if iRoomPlantType = PLANT_TYPE4 then del 2
	endif
endif



!!!!!!!*************************************
!!!!!!!*************************************  BARK
!!!!!!!*************************************
material mat1

if iRoomPlantType = PLANT_TYPE1 then
	addz 0.17
	mulz (zzyzx-0.17)/0.5
	add 0.01,0.01,0
	
	sweep 4,8,10,0.8,1+2+16+32,
		0.01,	0,		1,
		0.01,	-0.01,	1,
		0,		-0.01,	1,
		0,		0,		1,
	
		0,0,0,
		0,0.01,0.03,
		0.01,0.01,0.1,
		0,0,0.15,
		-0.01,-0.01,0.22,
		-0.01,0,0.3,
		0,0,0.4,
		0,0,0.5
	del 2
else
	if iRoomPlantType = PLANT_TYPE2 then
		addz 0.17
		mulz (zzyzx-0.18)/0.17

		for t=1 to 5
			add rnd(0.03),-0.015+rnd(0.03),0
			mulx 1+rnd(0.3)
			sweep 4,6,10,0.8,1+2+16+32,
				0.01,	0,		1,
				0.01,	-0.01,	1,
				0,		-0.01,	1,
				0,		0,		1,
		
				0.0,  0,	0.0,
				0.018768,	0,	 0.036054,
				0.030775,	0,	 0.079078,
				0.042781,	0,	 0.117099,
				0.060791,	0,	 0.139112,
				0.0768,	0,	 0.168128
		
			rotz -20+rnd(40)
			sweep 4,6,10,0.6,1+2+16+32,
				0.01,	0,		1,
				0.01,	-0.01,	1,
				0,		-0.01,	1,
				0,		0,		1,
		
				0.0,	0.0,	0,
				0.030775,	0,	0.026048,
				0.042787,	0,	0.035053,
				0.070797,	0,	0.054064,
				0.09381,	 0,	0.06507,
				0.105,	0,	0.07
		
			del 3
			rotz 55+rnd(17)
		next t
		del 5+2
	else
		if iRoomPlantType = PLANT_TYPE3 then
			addz 0.18
			mulz (zzyzx-0.18)/0.6
			add 0.01,0.05,0
			roty -90
			tube 5,7,1+2+16+32,
				0.01*cos(1*72),	0.01*sin(1*72),	1,
				0.01*cos(2*72),	0.01*sin(2*72),	1,
				0.01*cos(3*72),	0.01*sin(3*72),	1,
				0.01*cos(4*72),	0.01*sin(4*72),	1,
				0.01*cos(5*72),	0.01*sin(5*72),	1,
			
				-0.075223,0,0,0,
				0,0,0,0,
				0.075223,0,0,0,
				0.156452,0.010154,0,0,
				0.278295,0.023692,0,0,
				0.33,0.023692,0,0,
				0.447522,0.03,0,0
			del 2
	
			add -0.01,-0.03, 0
			roty -90
	
			tube 5,8,1+2+16+32,
				0.01*cos(1*72),	0.01*sin(1*72),	1,
				0.01*cos(2*72),	0.01*sin(2*72),	1,
				0.01*cos(3*72),	0.01*sin(3*72),	1,
				0.01*cos(4*72),	0.01*sin(4*72),	1,
				0.01*cos(5*72),	0.01*sin(5*72),	1,
			
				-0.037993,-0.006769,0,0,
				0,0,0,0,
				0.037993,-0.006769,0,0,
				0.13276,-0.033845,0,0,
				0.230912,-0.047384,0,0,
				0.420446,-0.047384,0,0,
				0.57275,-0.054153,0,0,
				0.687824,-0.03723,0,0
			del 2
		else
			if iRoomPlantType = PLANT_TYPE5 then
				_Trunk1Height = (zzyzx - 0.29) * 0.5
				_Trunk1Rad	= 0.026
				add 0, 0, 0.29

				add 0, -0.01, 0
				_Trunk1Segm = 10
				_Trunk1SegmAng = 360/_Trunk1Segm
				for jj = 1 to _Trunk1Segm
					put	_Trunk1Rad * sin(jj * _Trunk1SegmAng), _Trunk1Rad * cos(jj * _Trunk1SegmAng), 79
				next jj

				prism_ nsp/3, _Trunk1Height,
					use(nsp)

				cutpolya nsp/3, 2, 0,
					get(nsp)

				! Branch 1
				rotz -10
				add 0, 0, _Trunk1Height
				roty 90

				_Br1Rad1 = 0.04
				_Br1Rad2 = 0.011
				_Br1Lgth = 0.25
				_Br1Ang  = 81
				_Br1SegmAng = _Br1Ang/3

				_BrSegmCS	= 6
				_BrSegmCSAng	= 360/_BrSegmCS
				for jj = 1 to _BrSegmCS
					put	_Br1Rad2 * sin(jj * _BrSegmCSAng), _Br1Rad2 * cos(jj * _BrSegmCSAng), 1
				next jj

				tube nsp/3, 7, 1 + 16,
					use(nsp),

					-(_Br1Lgth+0.1) * sin(_Br1Ang), 	0, _Br1Rad1 + (_Br1Lgth+0.1) * cos(_Br1Ang), 0,
					-_Br1Lgth * sin(_Br1Ang), 			0, _Br1Rad1 + _Br1Lgth * cos(_Br1Ang), 0,
					_Br1Rad1 * sin(0), 					0, _Br1Rad1 * cos(0), 0,
					_Br1Rad1 * sin(_Br1SegmAng), 		0, _Br1Rad1 * cos(_Br1SegmAng), 0,
					_Br1Rad1 * sin(2*_Br1SegmAng),		0, _Br1Rad1 * cos(2*_Br1SegmAng), 0,
					_Br1Rad1 * sin(3*_Br1SegmAng),		0, _Br1Rad1 * cos(3*_Br1SegmAng), 0,
					_Br1Rad1 * sin(4*_Br1SegmAng),		0, _Br1Rad1 * cos(4*_Br1SegmAng), 0
				del 3

				! Branch 2
				rotz -140
				add 0, 0, _Trunk1Height-0.1
				roty 90

				_Br2Rad1 = 0.055
				_Br2Rad2 = 0.01
				_Br2Lgth = 0.2
				_Br2Ang  = 87
				_Br2SegmAng = _Br2Ang/3

				tube nsp/3, 7, 1 + 16,
					get(nsp),

					-(_Br2Lgth+0.1) * sin(_Br2Ang), 	0, _Br2Rad1 + (_Br2Lgth+0.1) * cos(_Br2Ang), 0,
					-_Br2Lgth * sin(_Br2Ang), 			0, _Br2Rad1 + _Br2Lgth * cos(_Br2Ang),	0,
					_Br2Rad1 * sin(0), 					0, _Br2Rad1 * cos(0), 0,
					_Br2Rad1 * sin(_Br2SegmAng), 		0, _Br2Rad1 * cos(_Br2SegmAng), 0,
					_Br2Rad1 * sin(2*_Br2SegmAng),		0, _Br2Rad1 * cos(2*_Br2SegmAng), 0,
					_Br2Rad1 * sin(3*_Br2SegmAng),		0, _Br2Rad1 * cos(3*_Br2SegmAng), 0,
					_Br2Rad1 * sin(4*_Br2SegmAng),		0, _Br2Rad1 * cos(4*_Br2SegmAng), 0
				cutend
				del 3

				! Trunk 2
				cutplane 1, 1, 0, 1

				_Trunk2Height = 0.2
				_Trunk2Rad	= 0.011
				_TrunkAng	= 81

				add -0.02, 0.06, -0.005
				rotx _TrunkAng - 90
				roty _TrunkAng - 90
				_Trunk2Segm = 8
				_Trunk2SegmAng = 360/_Trunk2Segm
				for jj = 1 to _Trunk1Segm
					put	_Trunk2Rad * sin(jj * _Trunk2SegmAng), _Trunk2Rad * cos(jj * _Trunk2SegmAng), 79
				next jj

				prism_ nsp/3, _Trunk2Height,
					get(nsp)
				del 3
				del 1

				cutend
			endif
		endif
	endif
endif


!!!!****************************************
!!!!**************************************** LEAFS
!!!!****************************************
material mat2

if iRoomPlantType = PLANT_TYPE1 then
	addz 0.05
	
	for i=1 to n
		add 0.01,0, rnd(zzyzx-0.27)
	
		gosub "WideLeaf"
	
		del 1
		rotz (360/n)*i+rnd(180/n)
	next i
	del n+1
else
	if iRoomPlantType = PLANT_TYPE2 then
		addz 0.2

		nz=(zzyzx-0.2)/0.1
		nz=max(5,nz)

		dz=zzyzx-0.2
		db=90/nz

		for u=1 to nz
		 rotz 27
		 addz sin(db*(u))*dz
			for i=1 to n/nz
				rotz (360/nz)-20+rnd(44)
				add cos(db*(u-1))*dr,0, 0
				roty (atn((zzyzx-0.2)/0.25)-45)

				gosub "WideLeaf"

				del 2
			next i
		del n/nz+1
		next u
	else
		if iRoomPlantType = PLANT_TYPE3 then
			add -0.01,-0.08,0.57
			
			for i=1 to n
			 add 0.01,0, -rnd(0.06)
			 BPrism_ mat2,mat2,mat2,6,0.002,0.12+rnd(0.1),
				0.226848,	 -0.0,	 79,
				0.113424,	 -0.5,	 979,
				0.0,	 17.8018,	4079,
				0.0,	0.0,	 79,
				0.113424,	0.5,	 979,
				0.0,	 17.8018,	4079
			 del 1
			 rotz (360/n)*i+rnd(180/n)
			next i
			del n+1

			add 0.01,0.074,0.325
			for i=1 to n
			 add 0.01,0, -rnd(0.06)
			 BPrism_ mat2,mat2,mat2,6,0.002,0.12+rnd(0.1),
				0.226848,	 -0.0,	 79,
				0.113424,	 -0.5,	 979,
				0.0,	 17.8018,	4079,
				0.0,	0.0,	 79,
				0.113424,	0.5,	 979,
				0.0,	 17.8018,	4079
			 del 1
			 rotz (360/n)*i+rnd(180/n)
			next i
			del n+1
		else
			if iRoomPlantType = PLANT_TYPE4 then
				gosub "Plant4Leafs"
			else

				addy -0.01
				rotz -10
				add 0, 0, _Trunk1Height
				roty 90 - _Br1Ang
				addx _Br1Rad1
				addz _Br1Lgth+0.01

				_TussLength = (zzyzx-0.29)/4.8
				_LeafAngle	= -30
				__LeafDens	= 5

				gosub "Plant5Leafs"

				del 5


				rotz -140
				add 0, 0, _Trunk1Height-0.1
				roty 90 - _Br2Ang
				addx _Br2Rad1
				addz _Br2Lgth+0.01

				_TussLength = 0.22
				_LeafAngle	= -30
				__LeafDens	= 5

				gosub "Plant5Leafs"

				del 6

				add -0.02, 0.06-_Trunk1Rad/2, 0
				rotx _TrunkAng - 90
				roty _TrunkAng - 90
				addz _Trunk2Height+0.01

				_TussLength = 0.17
				_LeafAngle	= -30
				__LeafDens	= 5

				gosub "Plant5Leafs"

				del 4
			endif
		endif
	endif
endif

!================================================================================
end ! end ! end !end ! end ! end ! end ! end ! end end ! end ! end ! end ! end !
!================================================================================

!================================================================================
"WideLeaf":
!================================================================================

BPRISM_ mat2,mat2,mat2,42,0.002,0.2+rnd(0.1),
			0.2,	0.0,	79,
			0.652051,	 -0.844237,	 979,
			0.0,	3.020318,	 4079,
			0.156145,	 -0.024991,	79,
			0.024976,	0.175469,	 979,
			0.0,	-13.0578,	 4079,
			0.107463,	 -0.049443,	79,
			0.081533,	0.021171,	 979,
			0.0,	-32.8711,	 4079,
			0.064985,	 -0.052211,	79,
			0.075344,	 -0.011124,	 979,
			0.0,	-33.7381,	 4079,
			0.04391,	 -0.039538,	79,
			0.102628,	0.008916,	 979,
			0.0,	-16.5545,	 4079,
			0.032538,	 -0.020799,	79,
			-0.01942,	 -0.042012,	 979,
			0.0,	 20.4508,	 4079,
			0.021851,	 -0.003982,	79,
			-0.029252,	 -0.222459,	 979,
			0.0,	5.674142,	 4079,
			0.0,	0.0,	79,
			-0.029252,	0.222459,	 979,
			0.0,	5.674142,	 4079,
			0.021851,	0.003982,	79,
			-0.01942,	0.042012,	 979,
			0.0,	 20.4508,	 4079,
			0.032538,	0.020799,	79,
			0.102628,	 -0.008916,	 979,
			0.0,	-16.5545,	 4079,
			0.04391,	0.039538,	79,
			0.075344,	0.011124,	 979,
			0.0,	-33.7381,	 4079,
			0.064985,	0.052211,	79,
			0.081533,	 -0.021171,	 979,
			0.0,	-32.8711,	 4079,
			0.107463,	0.049443,	79,
			0.024976,	 -0.175469,	 979,
			0.0,	-13.0578,	 4079,
			0.156145,	0.024991,	79,
			0.652051,	0.844237,	 979,
			0.0,	3.020318,	 4079
return

!================================================================================
"Plant4Leafs":
!================================================================================

rotz	 -14.697512
mulx	 A/0.87
muly	 B/0.691402

addz 0.29
	cutplane 1, 1, 0, 1
del 1

add		-1.0,	0.600836,	0
mulz zzyzx/1.45

cSLAB_  mat2, mat2, mat2,
			 5,	0.001,
			0.942059,	-0.607433,	1.450000,	15,
			0.914017,	-0.615681,	1.369762,	15,
			0.892578,	-0.610732,	1.315917,	15,
			0.935459,	-0.581044,	1.450000,	15,
			0.942059,	-0.607433,	1.450000,	-1
!!Pdach-29
cSLAB_  mat2, mat2, mat2,
			 8,	0.001,
			1.041019,	-0.544759,	1.400000,	15,
			1.074005,	-0.536511,	1.310298,	15,
			1.115837,	-0.534517,	1.208264,	15,
			1.141628,	-0.543109,	1.158953,	15,
			1.097095,	-0.569499,	1.301171,	15,
			1.078953,	-0.581044,	1.360203,	15,
			1.070709,	-0.592589,	1.395754,	15,
			1.041019,	-0.544759,	1.400000,	-1
!!Pdach-45
cSLAB_  mat2, mat2, mat2,
			 5,	0.001,
			1.064110,	-0.689901,	1.350000,	15,
			1.034420,	-0.640421,	0.764088,	15,
			1.003040,	-0.600467,	0.218966,	15,
			1.098743,	-0.633823,	1.350000,	15,
			1.064110,	-0.689901,	1.350000,	-1
!!Pdach-52
cSLAB_  mat2, mat2, mat2,
			 5,	0.001,
			0.811760,	-0.650317,	1.170000,	15,
			0.763927,	-0.719589,	1.064680,	15,
			0.729290,	-0.747628,	0.998648,	15,
			0.838146,	-0.737732,	1.170000,	15,
			0.811760,	-0.650317,	1.170000,	-1
!!Pdach-32
cSLAB_  mat2, mat2, mat2,
			 7,	0.001,
			1.098743,	-0.633823,	1.348071,	15,
			1.143276,	-0.675057,	1.245252,	15,
			1.156471,	-0.721239,	1.184685,	15,
			1.125134,	-0.717940,	1.234237,	15,
			1.090500,	-0.709693,	1.293081,	15,
			1.064110,	-0.689901,	1.349899,	15,
			1.098743,	-0.633823,	1.348071,	-1
!!Pdach-46
cSLAB_  mat2, mat2, mat2,
			 5,	0.001,
			0.955254,	-0.500226,	1.330000,	15,
			1.003040,	-0.600467,	0.300242,	15,
			0.958549,	-0.566200,	0.818701,	15,
			0.907421,	-0.538161,	1.330000,	15,
			0.955254,	-0.500226,	1.330000,	-1
!!01


cSLAB_  mat2, mat2, mat2,
			 6,	0.001,
			1.014629,	-0.353434,	0.745437,	15,
			1.021225,	-0.493629,	0.459273,	15,
			0.999546,	-0.605849,	0.250688,	15,
			0.963543,	-0.455908,	0.578738,	15,
			0.920616,	-0.388070,	0.747393,	15,
			1.014629,	-0.353434,	0.745437,	-1
!!Pdach-44


cSLAB_  mat2, mat2, mat2,
			 5,	0.001,
			1.041019,	-0.544759,	1.400000,	15,
			0.999866,	-0.600836,	0.168551,	15,
			1.034420,	-0.590940,	0.828308,	15,
			1.070709,	-0.592589,	1.400000,	15,
			1.041019,	-0.544759,	1.400000,	-1
!!Pdach-48
cSLAB_  mat2, mat2, mat2,
			 6,	0.001,
			1.057510,	-0.732784,	1.250000,	15,
			1.054214,	-0.769070,	1.206672,	15,
			1.036072,	-0.815251,	1.151111,	15,
			1.012978,	-0.793810,	1.175970,	15,
			0.991539,	-0.731135,	1.250000,	15,
			1.057510,	-0.732784,	1.250000,	-1
!!Pdach-49
cSLAB_  mat2, mat2, mat2,
			 5,	0.001,
			1.057510,	-0.732784,	1.250000,	15,
			1.019577,	-0.660213,	0.843929,	15,
			0.999866,	-0.600836,	0.510084,	15,
			0.991539,	-0.731135,	1.250000,	15,
			1.057510,	-0.732784,	1.250000,	-1
!!07


cSLAB_  mat2, mat2, mat2,
			 7,	0.001,
			0.693005,	-0.612382,	0.603338,	15,
			0.801861,	-0.590940,	0.473826,	15,
			0.912369,	-0.581044,	0.347829,	15,
			1.001919,	-0.596927,	0.256749,	15,
			0.836498,	-0.673408,	0.473801,	15,
			0.747433,	-0.737732,	0.601342,	15,
			0.693005,	-0.612382,	0.603338,	-1
!!97


cSLAB_  mat2, mat2, mat2,
			 8,	0.001,
			1.191109,	-0.452394,	0.900000,	15,
			1.120186,	-0.482083,	0.718822,	15,
			1.062458,	-0.523317,	0.567751,	15,
			0.996346,	-0.601238,	0.388250,	15,
			1.085552,	-0.557953,	0.617378,	15,
			1.161419,	-0.548058,	0.806564,	15,
			1.201004,	-0.556304,	0.902445,	15,
			1.191109,	-0.452394,	0.900000,	-1
!!Pdach-51


cSLAB_  mat2, mat2, mat2,
			 6,	0.001,
			0.811760,	-0.650317,	1.172269,	15,
			0.918964,	-0.635472,	0.669472,	15,
			0.991539,	-0.605784,	0.302143,	15,
			0.882679,	-0.714642,	0.941445,	15,
			0.838146,	-0.737732,	1.173527,	15,
			0.811760,	-0.650317,	1.172269,	-1
!!Pdach-53
cSLAB_  mat2, mat2, mat2,
			 6,	0.001,
			1.041019,	-0.391369,	1.103081,	15,
			1.003082,	-0.510122,	0.648443,	15,
			0.999866,	-0.600836,	0.349198,	15,
			1.050915,	-0.503525,	0.758976,	15,
			1.111938,	-0.435902,	1.091387,	15,
			1.041019,	-0.391369,	1.103081,	-1
!!Pdach-54
cSLAB_  mat2, mat2, mat2,
			 9,	0.001,
			1.043385,	-0.392853,	1.099998,	15,
			1.067410,	-0.376525,	1.053918,	15,
			1.088848,	-0.369927,	1.024495,	15,
			1.116890,	-0.364980,	0.991409,	15,
			1.136681,	-0.350135,	0.951404,	15,
			1.136681,	-0.383122,	0.999793,	15,
			1.128433,	-0.414460,	1.053357,	15,
			1.111938,	-0.435902,	1.100000,	15,
			1.043385,	-0.392853,	1.099998,	-1
!!00


cSLAB_  mat2, mat2, mat2,
			 8,	0.001,
			0.874435,	-0.797109,	0.800000,	15,
			0.866188,	-0.841641,	0.763097,	15,
			0.876083,	-0.886174,	0.732458,	15,
			0.877731,	-0.922460,	0.705279,	15,
			0.910721,	-0.881226,	0.748206,	15,
			0.943707,	-0.863083,	0.773472,	15,
			0.976692,	-0.843290,	0.800000,	15,
			0.874435,	-0.797109,	0.800000,	-1
!!98
cSLAB_  mat2, mat2, mat2,
			 9,	0.001,
			1.201004,	-0.556304,	0.900000,	15,
			1.225746,	-0.548058,	0.874586,	15,
			1.250484,	-0.533213,	0.848552,	15,
			1.266979,	-0.506824,	0.829630,	15,
			1.285122,	-0.490330,	0.810006,	15,
			1.314812,	-0.488681,	0.780293,	15,
			1.271927,	-0.458992,	0.820173,	15,
			1.191109,	-0.452394,	0.900000,	15,
			1.201004,	-0.556304,	0.900000,	-1
!!90


cSLAB_  mat2, mat2, mat2,
			 4,	0.001,
			0.935459,	-0.581044,	1.450000,	15,
			0.999866,	-0.600836,	0.340225,	15,
			0.942059,	-0.607433,	1.442819,	15,
			0.935459,	-0.581044,	1.450000,	-1
!!05


cSLAB_  mat2, mat2, mat2,
			 8,	0.001,
			0.892578,	-0.350135,	0.647716,	15,
			0.933811,	-0.440849,	0.506574,	15,
			0.970097,	-0.549706,	0.347130,	15,
			1.003040,	-0.600467,	0.260728,	15,
			0.862888,	-0.516720,	0.467830,	15,
			0.811760,	-0.455693,	0.580375,	15,
			0.790318,	-0.411161,	0.650565,	15,
			0.892578,	-0.350135,	0.647716,	-1
!!93


cSLAB_  mat2, mat2, mat2,
			 6,	0.001,
			0.836498,	-0.495278,	0.950000,	15,
			0.932159,	-0.536511,	0.663828,	15,
			1.003040,	-0.600467,	0.414202,	15,
			0.844746,	-0.574447,	0.840237,	15,
			0.800213,	-0.576097,	0.950000,	15,
			0.836498,	-0.495278,	0.950000,	-1
!!06


cSLAB_  mat2, mat2, mat2,
			 9,	0.001,
			0.892578,	-0.350135,	0.650000,	15,
			0.862888,	-0.323746,	0.628133,	15,
			0.813408,	-0.302304,	0.602863,	15,
			0.749084,	-0.303953,	0.584649,	15,
			0.696304,	-0.313849,	0.573939,	15,
			0.744137,	-0.328693,	0.595450,	15,
			0.775475,	-0.356732,	0.618623,	15,
			0.790318,	-0.411161,	0.650000,	15,
			0.892578,	-0.350135,	0.650000,	-1
!!94


cSLAB_  mat2, mat2, mat2,
			 8,	0.001,
			0.836498,	-0.495278,	0.950000,	15,
			0.805161,	-0.488681,	0.918709,	15,
			0.775475,	-0.498577,	0.895682,	15,
			0.745785,	-0.505174,	0.871299,	15,
			0.722694,	-0.491980,	0.844830,	15,
			0.758980,	-0.551356,	0.902251,	15,
			0.800213,	-0.576097,	0.950000,	15,
			0.836498,	-0.495278,	0.950000,	-1
!!99
cSLAB_  mat2, mat2, mat2,
			 6,	0.001,
			0.874435,	-0.797109,	0.790822,	15,
			0.953602,	-0.696499,	0.527825,	15,
			1.000156,	-0.592661,	0.284042,	15,
			0.991539,	-0.778966,	0.662499,	15,
			0.976692,	-0.843290,	0.802503,	15,
			0.874435,	-0.797109,	0.790822,	-1
!!02
cSLAB_  mat2, mat2, mat2,
			10,	0.001,
			0.920616,	-0.384771,	0.747832,	15,
			0.912369,	-0.346836,	0.720911,	15,
			0.922264,	-0.315499,	0.702717,	15,
			0.945354,	-0.294057,	0.694218,	15,
			0.958549,	-0.259421,	0.674656,	15,
			0.958549,	-0.236330,	0.659484,	15,
			1.006382,	-0.308902,	0.718745,	15,
			1.016277,	-0.340240,	0.741730,	15,
			1.014629,	-0.353434,	0.750000,	15,
			0.920616,	-0.384771,	0.747832,	-1
!!03


cSLAB_  mat2, mat2, mat2,
			 7,	0.001,
			1.240589,	-0.668460,	0.694803,	15,
			1.108643,	-0.605784,	0.441819,	15,
			0.999985,	-0.597545,	0.264782,	15,
			1.087200,	-0.658564,	0.446144,	15,
			1.133381,	-0.714642,	0.559325,	15,
			1.189461,	-0.785563,	0.698808,	15,
			1.240589,	-0.668460,	0.694803,	-1
!!04
cSLAB_  mat2, mat2, mat2,
			11,	0.001,
			1.240589,	-0.668460,	0.700000,	15,
			1.265331,	-0.686603,	0.682716,	15,
			1.295017,	-0.726187,	0.657865,	15,
			1.303265,	-0.785563,	0.639783,	15,
			1.321407,	-0.831745,	0.619515,	15,
			1.344498,	-0.849888,	0.603108,	15,
			1.262032,	-0.833395,	0.650552,	15,
			1.235641,	-0.808655,	0.670230,	15,
			1.217499,	-0.787212,	0.684783,	15,
			1.189461,	-0.785563,	0.700000,	15,
			1.240589,	-0.668460,	0.700000,	-1
!!23


cSLAB_  mat2, mat2, mat2,
			 5,	0.001,
			0.881031,	-0.706395,	0.420000,	15,
			0.999985,	-0.597545,	0.258822,	15,
			0.958549,	-0.706395,	0.364264,	15,
			0.927212,	-0.754226,	0.420042,	15,
			0.881031,	-0.706395,	0.420000,	-1
!!08


cSLAB_  mat2, mat2, mat2,
			10,	0.001,
			0.693005,	-0.612382,	0.600000,	15,
			0.623734,	-0.663511,	0.524453,	15,
			0.598991,	-0.726187,	0.481540,	15,
			0.585796,	-0.788862,	0.448168,	15,
			0.635277,	-0.732784,	0.509145,	15,
			0.658367,	-0.724538,	0.531171,	15,
			0.684757,	-0.726187,	0.552376,	15,
			0.712799,	-0.737732,	0.571395,	15,
			0.747433,	-0.737732,	0.600000,	15,
			0.693005,	-0.612382,	0.600000,	-1
!!10
cSLAB_  mat2, mat2, mat2,
			 9,	0.001,
			1.250484,	-0.467239,	0.550737,	15,
			1.146576,	-0.495278,	0.445257,	15,
			1.064110,	-0.534863,	0.353795,	15,
			0.999985,	-0.597545,	0.268410,	15,
			1.057510,	-0.475486,	0.374446,	15,
			1.121838,	-0.401265,	0.465175,	15,
			1.182861,	-0.363330,	0.536723,	15,
			1.196056,	-0.358382,	0.550738,	15,
			1.250484,	-0.467239,	0.550737,	-1
!!12
cSLAB_  mat2, mat2, mat2,
			 6,	0.001,
			1.116890,	-0.744329,	0.499817,	15,
			1.055862,	-0.651966,	0.367943,	15,
			0.999985,	-0.597545,	0.276568,	15,
			1.013912,	-0.734430,	0.419467,	15,
			1.032772,	-0.805356,	0.501501,	15,
			1.116890,	-0.744329,	0.499817,	-1
!!11
cSLAB_  mat2, mat2, mat2,
			 7,	0.001,
			1.196056,	-0.358382,	0.550000,	15,
			1.265331,	-0.361681,	0.463618,	15,
			1.311512,	-0.364980,	0.406734,	15,
			1.347797,	-0.358382,	0.356167,	15,
			1.301617,	-0.414460,	0.450973,	15,
			1.250484,	-0.467239,	0.550000,	15,
			1.196056,	-0.358382,	0.550000,	-1
!!13
cSLAB_  mat2, mat2, mat2,
			 8,	0.001,
			1.116890,	-0.744329,	0.500000,	15,
			1.125134,	-0.793810,	0.446502,	15,
			1.115238,	-0.848239,	0.400921,	15,
			1.078953,	-0.912563,	0.364265,	15,
			1.080601,	-0.863083,	0.410844,	15,
			1.064110,	-0.825148,	0.458977,	15,
			1.032772,	-0.805356,	0.500000,	15,
			1.116890,	-0.744329,	0.500000,	-1
!!17


cSLAB_  mat2, mat2, mat2,
			 6,	0.001,
			1.159771,	-0.534863,	0.450422,	15,
			1.067410,	-0.551356,	0.338734,	15,
			0.999985,	-0.597545,	0.251933,	15,
			1.080601,	-0.609083,	0.345423,	15,
			1.172966,	-0.627226,	0.451779,	15,
			1.159771,	-0.534863,	0.450422,	-1
!!19
cSLAB_  mat2, mat2, mat2,
			 5,	0.001,
			0.823303,	-0.610732,	0.451561,	15,
			0.895874,	-0.599187,	0.368353,	15,
			1.004665,	-0.591689,	0.241761,	15,
			0.834850,	-0.529914,	0.453255,	15,
			0.823303,	-0.610732,	0.451561,	-1
!!18
cSLAB_  mat2, mat2, mat2,
			 8,	0.001,
			1.159771,	-0.534863,	0.450000,	15,
			1.215851,	-0.531564,	0.383283,	15,
			1.250484,	-0.548058,	0.345203,	15,
			1.273575,	-0.581044,	0.323522,	15,
			1.224094,	-0.589291,	0.383287,	15,
			1.191109,	-0.605784,	0.424981,	15,
			1.172966,	-0.627226,	0.450000,	15,
			1.159771,	-0.534863,	0.450000,	-1
!!20
cSLAB_  mat2, mat2, mat2,
			 9,	0.001,
			0.834850,	-0.529914,	0.450000,	15,
			0.803513,	-0.533213,	0.397072,	15,
			0.763927,	-0.544759,	0.332031,	15,
			0.725994,	-0.569499,	0.273050,	15,
			0.696304,	-0.581044,	0.224968,	15,
			0.749084,	-0.582693,	0.315872,	15,
			0.790436,	-0.593191,	0.389350,	15,
			0.823303,	-0.610732,	0.450000,	15,
			0.834850,	-0.529914,	0.450000,	-1
!!21
cSLAB_  mat2, mat2, mat2,
			 6,	0.001,
			1.008030,	-0.437551,	0.450900,	15,
			1.009682,	-0.523317,	0.351855,	15,
			0.999985,	-0.597545,	0.263098,	15,
			1.034420,	-0.508472,	0.375829,	15,
			1.055862,	-0.449096,	0.450564,	15,
			1.008030,	-0.437551,	0.450900,	-1
!!22
cSLAB_  mat2, mat2, mat2,
			 7,	0.001,
			1.008030,	-0.437551,	0.450000,	15,
			1.026173,	-0.388070,	0.406068,	15,
			1.052563,	-0.336941,	0.359167,	15,
			1.072357,	-0.313849,	0.336435,	15,
			1.064110,	-0.401265,	0.409362,	15,
			1.055862,	-0.449096,	0.450000,	15,
			1.008030,	-0.437551,	0.450000,	-1
!!24
cSLAB_  mat2, mat2, mat2,
			 7,	0.001,
			0.881031,	-0.706395,	0.420000,	15,
			0.848045,	-0.752577,	0.380923,	15,
			0.841446,	-0.782265,	0.363160,	15,
			0.843098,	-0.805356,	0.352762,	15,
			0.905773,	-0.769070,	0.401981,	15,
			0.927212,	-0.754226,	0.420000,	15,
			0.881031,	-0.706395,	0.420000,	-1
!!25
cSLAB_  mat2, mat2, mat2,
			 6,	0.001,
			1.090500,	-0.744329,	0.400000,	15,
			1.039368,	-0.671759,	0.321240,	15,
			1.009682,	-0.607433,	0.261385,	15,
			1.097095,	-0.643720,	0.340142,	15,
			1.154823,	-0.681655,	0.401049,	15,
			1.090500,	-0.744329,	0.400000,	-1
!!26
cSLAB_  mat2, mat2, mat2,
			 9,	0.001,
			1.092995,	-0.741899,	0.400000,	15,
			1.120144,	-0.763855,	0.383832,	15,
			1.153175,	-0.774018,	0.369688,	15,
			1.169666,	-0.800407,	0.355509,	15,
			1.174614,	-0.825148,	0.345636,	15,
			1.181213,	-0.767421,	0.362768,	15,
			1.168018,	-0.734434,	0.378079,	15,
			1.154823,	-0.681655,	0.400000,	15,
			1.092995,	-0.741899,	0.400000,	-1
del 5

cutend

return


!================================================================================
"Plant5Leafs":
!================================================================================

__TussLength2	=_TussLength/2
__TussLength4	=__TussLength2/2
__TussWidth		=_TussLength/20

rr=360/__LeafDens
__vertAngle = (90-_LeafAngle)/24*3
szaml = 0
for i = _LeafAngle to 90 step __vertAngle
szaml = szaml+1
	for j = 1 to __LeafDens
		rotz rr + (rnd(1)*rr-rr/2)
		roty -i
		gosub "TussockLeaf"
		del 1
	next j
next i
del __LeafDens * (int((90-_LeafAngle) / __vertAngle)+1)

return


!================================================================================
!Random Tussock leaf
!================================================================================
"TussockLeaf":
	rrr=rnd(1)*30               !Random rot of Leaf
	rotx  rrr

	x3=rnd(1)/10*__TussWidth+__TussWidth        	!width
	x2=rnd(1)*__TussLength2+__TussLength4         !lenght 1
	x1=rnd(1)*__TussLength2+ x2+__TussLength4     !Leaf lenght

	poly 5, 0,0,    x2,-x3, x1,0,   x2,x3,  0,0

	del 1
return
