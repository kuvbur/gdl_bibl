
unID = 1
hotspot 0, 0, 0, unID			: unID = unID + 1
hotspot 0, 0, ZZYZX, unID		: unID = unID + 1

pen gs_cont_pen
material matTussock

if gs_shadow then
	shadow on
else
	shadow off
endif

halfLeafLength = leafLength / 2
partLeafLength = leafLength / 20

densityRate = 360 / density
slope = (90 - leafAngle) / 8			

for i = leafAngle to 90 step slope
	for j = 1 to density
		rotz densityRate + (rnd(1) * densityRate - densityRate / 2)
		roty -i
		gosub "leaf"
		del 1
	next j
	density = density - int (density/(85-i) * slope)
	if density = 0 then end
	densityRate = 360 / density
next i


end
!************************
!subroutine a random leaf
!************************

"leaf":
	randRotLeaf = rnd(1)*30               !Random rot of Leaf
	rotx  randRotLeaf 

	x3 = rnd(1) / 10 * partLeafLength + partLeafLength          !width
	x2 = rnd(1) * halfLeafLength + halfLeafLength / 2			!lenght 1
	x1 = rnd(1) * halfLeafLength + halfLeafLength / 2 + x2      !Leaf lenght

	poly 5, 0,0,    x2,-x3, x1,0,   x2,x3,  0,0

	del 1
return
