
IF gs_detlevel_3D_m = DLEV3D_OFF THEN END

IF gs_shadow=0 THEN SHADOW OFF

material mat

resol gs_resol

b=rad+rad_abst

a=a-2*(3*v+0.02)-4*v
b=b-2*(3*v+0.02)


bot1=roll-0.22
bot2=b-0.1
r=0.08		!radius at corner

mulz-1
addz -roll_h

!!********** bottom surface

resol 6
fprism_	mat, mat, mat, mat,
		17, roll_h/3, 45, roll_h/6,
		-bot1/2+r, -bot2/2,      79,
		-bot1/2+r, -bot2/2+r,    901,
		0,          -90,   4001,
		-bot1/2, -bot2/2+r,      79,
		-bot1/2, bot2/2-r,      79,
		-bot1/2+r, bot2/2-r,    901,
		0,          -90,   4001,
		-bot1/2+r, bot2/2,      79,
		bot1/2-r, bot2/2,      79,
		bot1/2-r, bot2/2-r,    901,
		0,          -90,   4001,
		bot1/2, bot2/2-r,      79,
		bot1/2, -bot2/2+r,      79,
		bot1/2-r, -bot2/2+r,    901,
		0,          -90,   4001,
		bot1/2-r, -bot2/2,      79,
	   -bot1/2+r, -bot2/2,     -1

del 2


!!*********** body


resol gs_resol

r=0.02
v=0.007

al=18
detres=90/al

for tp1=0 to detres
	put a/2-r+r*sin(al*tp1),   b/2-r+r*cos(al*tp1), 0, 0
next tp1

for tp2=0 to detres
	 put a/2-r+r*sin(90-al*tp2),  -b/2+r-r*cos(90-al*tp2), 0, 0
next tp2

for tp3=0 to detres
	put -a/2+r-r*sin(al*tp3), -b/2+r-r*cos(al*tp3),  0,  0
next tp3

for tp4=0 to detres
	put -a/2+r-r*sin(90-al*tp4), b/2-r+r*cos(90-al*tp4), 0, 0
next tp4

tube 11, 4+nsp/4, 1+2+16+32,

	0,	roll_h,	1,
	v,	roll_h,	1,
	2*v,	h2-3*v,	0,
	2*v+0.02,	h2-4*v,	0,
	2*v+0.02,	h2-3*v-0.035,	1,
	3*v+0.02,	h2-3*v-0.035,	1,
	3*v+0.02,	h2-3*v,	0,
	2*v+0.02,	h2-3*v,	0,
	2*v+0.02,	h2,	0,
	v,	h2,	0,
	0,	roll_h,	1,

	-a/2+r-r*sin(al), b/2-r+r*cos(al), 0, 0,
	-a/4, b/2-r+r*cos(0), 0, 0,

	get (nsp),

	 a/4,   b/2-r+r*cos(0), 0, 0,
	 a/2-r+r*sin(0),   b/2-r+r*cos(0), 0, 0


resol 6
addz roll_h
prism_ 17, v,
		-a/2+r, -b/2,      79,
		-a/2+r, -b/2+r,    901,
		0,          -90,   4001,
		-a/2, -b/2+r,      79,
		-a/2, b/2-r,      79,
		-a/2+r, b/2-r,    901,
		0,          -90,   4001,
		-a/2+r, b/2,      79,
		a/2-r, b/2,      79,
		a/2-r, b/2-r,    901,
		0,          -90,   4001,
		a/2, b/2-r,      79,
		a/2, -b/2+r,      79,
		a/2-r, -b/2+r,    901,
		0,          -90,   4001,
		a/2-r, -b/2,      79,
	   -a/2+r, -b/2,     -1

del 1



group "top"
!!************************ top
a=a+2*(3*v+0.02)+0.058
b=b+2*(3*v+0.02)
dhh=dh-0.05

rrc=dhh/2+b*b/8/dhh
rr=rrc-0.05

alf=2*atn(b/2/(rrc-dhh))
resol 360/alf*36

dx=(rrc-rr)*sin(alf/2)
dy=(rrc-rr)*cos(alf/2)
ksz=0.07*b/0.832

for i=1 to 2

	resol gs_resol

	add -a/2+3*v, 0, h2-rrc+dh
	rotx 90
	roty -90

	addz -4*v



	MATERIAL matfed
	prism_	5, v,
			-b/2+dx,	rrc-dh,	79,
			 0,	0,	901,
			 0,	-alf,	4079,
			 b/2-dx, rrc-dh,	79,
			-b/2+dx, rrc-dh,	-1

	del 1

	addz -v

		prism_	17, 2*v,
			-b/2,	rrc-dh+dy,	79,
			 0,	0,	901,
			 0,	-alf,	4079,
			 b/2, rrc-dh+dy,	79,

			 b/2,	rrc-dh+dy/2,	79,
			 b/2-2*dx,	rrc-dh+dy/2,	79,
			 b/2-2*dx-dy/2-(3*v+0.035),	rrc-dh-(3*v+0.035),	79,
			 0,	rrc-dh-(3*v+0.035),	79,
			-0.04,	rrc-dh-(3*v+0.035)-0.04,	79,
			-0.04,	rrc-dh-(3*v+0.035)-0.19,	79,
			 ksz*cos(45),	rrc-dh-(3*v+0.035)-0.19-0.04-ksz*sin(45),	79,
			 ksz,	-180,	2001,
			-ksz*cos(45),	rrc-dh-(3*v+0.035)-0.19-0.04-ksz*sin(45)-2*ksz*sin(45),	79,
			-0.04-2*(2*ksz*sin(45)),	rrc-dh-(3*v+0.035)-0.19,	79,
			-0.04-2*(2*ksz*sin(45)),	rrc-dh-(3*v+0.035),	79,
			-b/2,	rrc-dh-(3*v+0.035),	79,

			-b/2, rrc-dh+dy,	-1


	del 1

	del 3

	material mat_met

	resol 10

	add -a/2+0.058, 0, h2-(3*v+0.035)-0.19-0.04-2*ksz*sin(45)
	roty -90
	hotspot 0,0,0
	cylind 0.058-4*v, 0.02
	addz 0.058-2*v
	hotspot 0,0,0
	cylind 0.02, 0.02
	del 3

	material mat

	mulx-1

next i

del 2

s1=a*(1-3/7-2/8)/2
hor=0.005
dalf=alf/15

addz zzyzx-rrc
rotz 90
rotx 0

MATERIAL matfed

tube  23, 19, 1+2+16+32,
	-a/2,	-0.015,	0,
	-a/2,	0,	0,

	-a/2+s1,	0,	0,
	-a/2+s1,	-hor,	0,
	-a/2+s1+hor,	-hor,	0,

	-a/2+s1+a/7-hor,	-hor,	0,
	-a/2+s1+a/7,	-hor,	0,
	-a/2+s1+a/7,	0,	0,

	-a/2+s1+a/7+a/8,	0,	0,
	-a/2+s1+a/7+a/8,	-hor,	0,
	-a/2+s1+a/7+a/8+hor,	-hor,	0,


	 a/2-s1-a/7-a/8-hor,	-hor,	0,
	 a/2-s1-a/7-a/8,	-hor,	0,
	 a/2-s1-a/7-a/8,	0,	0,

	 a/2-s1-a/7,	0,	0,
	 a/2-s1-a/7,	-hor,	0,
	 a/2-s1-a/7+hor,	-hor,	0,

	 a/2-s1-hor,	-hor,	0,
	 a/2-s1,	-hor,	0,
	 a/2-s1,	0,	0,

	 a/2,	0,	0,
	 a/2,	-0.015,	0,
	-a/2,	-0.015,	0,

	 rrc*cos(0),	 0,	rrc*sin(0), 0,
	 rrc*cos(90-alf/2-1),	 0,	rrc*sin(90-alf/2-1), 0,
	 rrc*cos(90-alf/2-1+dalf),	 0,	rrc*sin(90-alf/2-1+dalf), 0,
	 rrc*cos(90-alf/2-1+2*dalf),	 0,	rrc*sin(90-alf/2-1+2*dalf), 0,
	 rrc*cos(90-alf/2-1+3*dalf),	 0,	rrc*sin(90-alf/2-1+3*dalf), 0,
	 rrc*cos(90-alf/2-1+4*dalf),	 0,	rrc*sin(90-alf/2-1+4*dalf), 0,
	 rrc*cos(90-alf/2-1+5*dalf),	 0,	rrc*sin(90-alf/2-1+5*dalf), 0,
	 rrc*cos(90-alf/2-1+6*dalf),	 0,	rrc*sin(90-alf/2-1+6*dalf), 0,
	 rrc*cos(90-alf/2-1+7*dalf),	 0,	rrc*sin(90-alf/2-1+7*dalf), 0,
	 rrc*cos(90-alf/2-1+8*dalf),	 0,	rrc*sin(90-alf/2-1+8*dalf), 0,
	 rrc*cos(90-alf/2-1+9*dalf),	 0,	rrc*sin(90-alf/2-1+9*dalf), 0,
	 rrc*cos(90-alf/2-1+10*dalf),	 0,	rrc*sin(90-alf/2-1+10*dalf), 0,
	 rrc*cos(90-alf/2-1+11*dalf),	 0,	rrc*sin(90-alf/2-1+11*dalf), 0,
	 rrc*cos(90-alf/2-1+12*dalf),	 0,	rrc*sin(90-alf/2-1+12*dalf), 0,
	 rrc*cos(90-alf/2-1+13*dalf),	 0,	rrc*sin(90-alf/2-1+13*dalf), 0,
	 rrc*cos(90-alf/2-1+14*dalf),	 0,	rrc*sin(90-alf/2-1+14*dalf), 0,
	 rrc*cos(90-alf/2-1+15*dalf),	 0,	rrc*sin(90-alf/2-1+15*dalf), 0,

	 rrc*cos(90-alf/2-1+16*dalf),	 0,	rrc*sin(90-alf/2-1+16*dalf), 0,
	 rrc*cos(180),	 0,	rrc*sin(180), 0

del 3
endgroup
!!*************** wheels 1

resol gs_resol

material mat_wh

roll=roll-0.095
roll_h=roll_h

rotx 90

for j=1 to 2

	for m=1 to 2

		add -roll/2, 0.09, b/2-rad_abst
		if m=1 then addx -0.095

		prism_ 14, 0.02,
			0.09, 0, 79,
			0,	0,	901,
			0,	180,	4079,
			-0.09,	0,	79,
			0,	0,	901,
			0,	180,	4079,
			0.09,	0,	-1,

			0.06, 0, 79,
			0,	0,	901,
			0,	180,	4079,
			-0.06,	0,	79,
			0,	0,	901,
			0,	180,	4079,
			0.06,	0,	-1

		material mat_met
		cylind 0.015, 0.06

		if m=1 then del 1


		material mat_wh

		del 1
		mulx -1

	next m

	del 2

	mulz -1

next j

del 2

!***************  wheels 2

material mat_met

add -roll/2, 0.09, b/2-rad_abst+0.023

for gr=1 to 2

	for wh=1 to 2

		if wh=1 then addx -0.095

		for k=1 to 2


			PRISM_  39,   0.01,
					 0,          roll_h-0.09,     15,
					0, 0.06071067811865,     79,
					0.0001909918771674, 0.06071067811865,     79,
					-0.0005715220679928, 0.05199510384389,     79,
					-0.0028358953031, 0.04354434788317,     79,
					-0.006533325993235, 0.03561518218007,     79,
					-0.01155146957787, 0.02844853042213,     79,
					-0.01464466094067, 0.02535533905933,     79,
					-0.02020101012678, 0.01979898987322,     79,
					-0.02193319728995, 0.01806680271005,     79,
					-0.02474335769734, 0.01405347772561,     79,
					-0.02681391888382, 0.009613144931872,     79,
					-0.02808196789548, 0.004880721593869,     79,
					-0.02850897570477, 0,     79,
					-0.02808196789548, -0.004880721593869,     79,
					-0.02681391888382, -0.009613144931872,     79,
					-0.02474335769734, -0.01405347772561,     79,
					-0.02193319728995, -0.01806680271005,     79,
					-0.02020101012678, -0.01979898987322,     79,
					-0.01979898987322, -0.02020101012678,     15,
					-0.01806680271005, -0.02193319728995,     79,
					-0.01405347772561, -0.02474335769734,     79,
					-0.009613144931872, -0.02681391888382,     79,
					-0.004880721593869, -0.02808196789548,     79,
					0, -0.02850897570477,     79,
					0.004880721593869, -0.02808196789548,     79,
					0.009613144931872, -0.02681391888382,     79,
					0.01405347772561, -0.02474335769734,     79,
					0.01806680271005, -0.02193319728995,     79,
					0.01979898987322, -0.02020101012678,     79,
							0.04, 0,     79,
							0.04, 0.02627442475314,     79,
					0.04005721349363, 0.03125977745816,     79,
					0.04168165405375, 0.03985651261299,     79,
					0.04477422310518, 0.04804056290105,     79,
					0.0470075888037, 0.05180191149838,     79,
					0.095002763641, roll_h-0.11,     15,
					0.095002763641,          roll_h-0.09,     15,
							   0,          roll_h-0.09,     -1




			addz -0.026-0.01

		next k

		del 2

		if wh=1 then del 1

		addx roll

	next wh

	del 2

	addz -rad+rad_abst

next gr

del 2


del 1
del 1


!!!*******************

resol 8

for fg=1 to 2

	add -a/2+0.2, -b/2+2*v+0.02, h2-0.13
	roty 90
	rotx 90

	elbow 0.04, 90, 0.005
	addx 0.1
	rotz 180
	elbow 0.04, 90, 0.005
	del 2
	add 0.04, 0, 0.04
	roty 90
	cylind 0.02, 0.005
	del 2

	del 3

	mulx -1

next fg

del 2

del top

if ang_open=1 then PLACEGROUP "top"