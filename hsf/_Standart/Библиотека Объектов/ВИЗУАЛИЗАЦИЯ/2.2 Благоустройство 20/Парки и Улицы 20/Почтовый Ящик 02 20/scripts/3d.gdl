
IF gs_detlevel_3D_m = DLEV3D_OFF THEN END

IF gs_shadow=0 THEN SHADOW OFF

if sor=0 then
	aa=a
	h=zzyzx
endif

for ver=1 to num_y

	for hor=1 to num_x

		if sor=1 then add aa/2-a/2, b/2, 0
		if sor=0 then add 0, b/2, 0
		rotx 90

		if iBoxType = BOXTYPE_1 then gosub 10
		if iBoxType = BOXTYPE_2 then gosub 20
		if iBoxType = BOXTYPE_3 then gosub 30


		del 1		!!*** rotx 90
		del 1		!!*** addy b/2

		add aa, 0, 0

	next hor

	del num_x

	add 0, 0, h

next ver

del num_y


END


10:		!!******** Type 1

material mat_1

prism_ 10, b,
	-aa/2,	h, 15,
	-aa/2,	0,	15,
	 aa/2,	0,	15,
	 aa/2,	h,	15,
	-aa/2,	h, -1,

	-aa/2+vtg,	h-vtg, 15,
	-aa/2+vtg,	vtg,	15,
	 aa/2-vtg,	vtg,	15,
	 aa/2-vtg,	h-vtg,	15,
	-aa/2+vtg,	h-vtg, -1

material mat_2

addz vtg/2

prism_ 5, vtg,
	-aa/2+vtg,	h-vtg, 15,
	-aa/2+vtg,	vtg,	15,
	 aa/2-vtg,	vtg,	15,
	 aa/2-vtg,	h-vtg,	15,
	-aa/2+vtg,	h-vtg, -1

del 1

addz b-2.5*vtg

prism_ 5, vtg,
	-aa/2+vtg,	h*0.85, 15,
	-aa/2+vtg,	vtg,	15,
	 aa/2-vtg,	vtg,	15,
	 aa/2-vtg,	h*0.85,	15,
	-aa/2+vtg,	h*0.85, -1



addz vtg

material mat_1


prism_ 4, 0.001,
	 0, h*0.6, 15,
	 0, h*0.6+0.024, 15,
	 aa*0.4, h*0.6+0.024, 15,
	 aa*0.4, h*0.6, 15


del 2

add -aa*0.4, h*0.6+0.015, b-1.5*vtg

cylind 0.015, 0.012

del 1

return



20:		!!******** Type 2

material mat_1

prism_ 10, b,
	-aa/2,	h, 15,
	-aa/2,	0,	15,
	 aa/2,	0,	15,
	 aa/2,	h,	15,
	-aa/2,	h, -1,

	-aa/2+vtg,	h-vtg, 15,
	-aa/2+vtg,	vtg,	15,
	 aa/2-vtg,	vtg,	15,
	 aa/2-vtg,	h-vtg,	15,
	-aa/2+vtg,	h-vtg, -1

material mat_2

addz vtg/2

prism_ 5, vtg,
	-aa/2+vtg,	h-vtg, 15,
	-aa/2+vtg,	vtg,	15,
	 aa/2-vtg,	vtg,	15,
	 aa/2-vtg,	h-vtg,	15,
	-aa/2+vtg,	h-vtg, -1

del 1

addz b-2.5*vtg

prism_ 5, vtg,
	-aa/2+vtg,	h*0.85, 15,
	-aa/2+vtg,	vtg,	15,
	 aa/2-vtg,	vtg,	15,
	 aa/2-vtg,	h*0.85,	15,
	-aa/2+vtg,	h*0.85, -1



addz vtg

material mat_1


prism_ 4, 0.001,
	-aa*0.25, h*0.6, 15,
	-aa*0.25, h*0.6+0.024, 15,
	 aa*0.25, h*0.6+0.024, 15,
	 aa*0.25, h*0.6, 15


del 2

add 0, h*0.15, b-1.5*vtg

cylind 0.01, 0.012

del 1

return



30:		!!******** Type 3

material mat_1

prism_ 10, b,
	-aa/2,	h, 15,
	-aa/2,	0,	15,
	 aa/2,	0,	15,
	 aa/2,	h,	15,
	-aa/2,	h, -1,

	-aa/2+vtg,	h-vtg, 15,
	-aa/2+vtg,	vtg,	15,
	 aa/2-vtg,	vtg,	15,
	 aa/2-vtg,	h-vtg,	15,
	-aa/2+vtg,	h-vtg, -1

material mat_2

addz vtg/2

prism_ 5, vtg,
	-aa/2+vtg,	h-vtg, 15,
	-aa/2+vtg,	vtg,	15,
	 aa/2-vtg,	vtg,	15,
	 aa/2-vtg,	h-vtg,	15,
	-aa/2+vtg,	h-vtg, -1

del 1

addz b-2.5*vtg

prism_ 5, vtg,
	-aa/2+vtg,	h*0.85, 15,
	-aa/2+vtg,	vtg,	15,
	 aa/2-vtg,	vtg,	15,
	 aa/2-vtg,	h*0.85,	15,
	-aa/2+vtg,	h*0.85, -1

material mat_1

prism_ 5, vtg,
	-aa/2+vtg,	h*0.85+vtg, 15,
	-aa/2+vtg,	h*0.85,	15,
	 aa/2-vtg,	h*0.85,	15,
	 aa/2-vtg,	h*0.85+vtg,	15,
	-aa/2+vtg,	h*0.85+vtg, -1

addz vtg

prism_ 4, 0.001,
	-aa*0.25, h*0.5, 15,
	-aa*0.25, h*0.5+0.024, 15,
	 aa*0.25, h*0.5+0.024, 15,
	 aa*0.25, h*0.5, 15


del 2

add 0, h*0.7, b-1.5*vtg

cylind 0.01, 0.012

del 1

return






