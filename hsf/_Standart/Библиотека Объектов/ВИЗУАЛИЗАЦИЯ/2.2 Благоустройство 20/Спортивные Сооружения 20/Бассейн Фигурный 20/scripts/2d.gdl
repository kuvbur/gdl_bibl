
!!Free Form Pool.gsm

drawindex 10

pen gs_cont_pen
fill gs_fill_type

	if deck_fill_pen<>0 then     !! Pool Deck Fill
		x1=1+2+4+64
	else
		x1=1
	endif

	if gs_fill_pen<>0 then     !! Pool Deck Fill
		x2=1+2+4+64
	else
		x2=1
	endif


mul2 a/4, b/6
ADD2 -2,-3		!! Drag to origo

hotspot2 2, 3
hotspot2 0, 0
hotspot2 4, 0
hotspot2 4, 6
hotspot2 0, 6
hotspot2 2, 0
hotspot2 2, 6
hotspot2 0, 3
hotspot2 4, 3


!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!! *** "8-Shaped" *** !!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

if iPoolShape = POOLTYPE_8SHAPED then

		poly2_b 24, x1, deck_fill_pen, gs_back_pen,
			2, -vb-pdn, 1,
			2, 2, 901,
			0, 90+asn(1/2.5), 4001,
			2+sqr(2.5^2-1^2), 3, 901,
			0, -2*asn(1/2.5), 4001,
			2, 4, 901,
			0, 2*(90+asn(1/2.5)), 4001,
			2-sqr(2.5^2-1^2), 3, 901,
			0, -2*asn(1/2.5), 4001,
			2, 2, 901,
			0, 90+asn(1/2.5), 4001,
			2, 0, -1,

			2, 0, 1,
			2, 2, 901,
			0, 90+asn(1/2.5), 4001,
			2+sqr(2.5^2-1^2), 3, 901,
			0, -2*asn(1/2.5), 4001,
			2, 4, 901,
			0, 2*(90+asn(1/2.5)), 4001,
			2-sqr(2.5^2-1^2), 3, 901,
			0, -2*asn(1/2.5), 4001,
			2, 2, 901,
			0, 90+asn(1/2.5), 4001,
			2, 0, -1


		poly2_b 11, x2, gs_fill_pen, gs_back_pen,
				2,					0,					1,
				2,					2,					901,
				0,					90+asn(1/2.5),		4001,
				2+sqr(2.5^2-1^2),	3,					901,
				0,					-2*asn(1/2.5),		4001,
				2,					4,					901,
				0,					2*(90+asn(1/2.5)),	4001,
				2-sqr(2.5^2-1^2),	3,					901,
				0,					-2*asn(1/2.5),		4001,
				2,					2,					901,
				0,					90+asn(1/2.5),		4001



endif

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!! *** "Kidney-Shaped" *** !!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!


if iPoolShape = POOLTYPE_KIDNEY then

		poly2_b 58, x1, deck_fill_pen, gs_back_pen,
		   1.44803+(1.411989+vb+pdn)*cos(147.7336), 4.464452+(1.411989+vb+pdn)*sin(147.7336), 1,
		   1.44803, 4.464452, 901,
		   0, 193.0779-147.7336-q, 4001,
		   1.709162+(1.721206+vb+pdn)*cos(198.05), 4.678263+(1.721206+vb+pdn)*sin(198.05), 1,
		   1.709162, 4.678263, 901,
		   0, 228.3262-198.05-q, 4001,
		   -0.45837+(1.612888-vb-pdn)*cos(50.6289), 2.145773+(1.612888-vb-pdn)*sin(50.6289), 1,
		   -0.45837, 2.145773, 901,
		   0, -(360-344.7371+50.6289-q), 4001,
		   2.397889+(1.386298+vb+pdn)*cos(159.708), 1.240407+(1.386298+vb+pdn)*sin(159.708), 1,
		   2.397889, 1.240407, 901,
		   0, 189.6115-159.708-q, 4001,
		   2.163612+(1.1397+vb+pdn)*cos(186.4165), 1.136308+(1.1397+vb+pdn)*sin(186.4165), 1,
		   2.163612, 1.136308, 901,
		   0, 308.304-186.4165-q, 4001,
		   1.214941+(2.620194+vb+pdn)*cos(309.1734), 2.273223+(2.620194+vb+pdn)*sin(309.1734), 1,
		   1.214941, 2.273223, 901,
		   0, 332.4714-309.1734-q, 4001,
		   -0.77398+(4.781021+vb+pdn)*cos(334.4216), 3.126379+(4.781021+vb+pdn)*sin(334.4216), 1,
		   -0.77398, 3.126379, 901,
		   0, 344.4264-334.4216-q, 4001,
		   -0.001784+(4.00811+vb+pdn)*cos(343.0158), 3.013597+(4.00811+vb+pdn)*sin(343.0158), 1,
		   -0.001784, 3.013597, 901,
		   0, 27.7109+360-343.0158-q, 4001,
		   1.095943+(2.88866+vb+pdn)*cos(31.9644), 3.348178+(2.88866+vb+pdn)*sin(31.9644), 1,
		   1.095943, 3.348178, 901,
		   0, 55.7336-31.9644-q, 4001,
		   1.766278+(1.851516+vb+pdn)*cos(58.9097), 4.149894+(1.851516+vb+pdn)*sin(58.9097), 1,
		   1.766278, 4.149894, 901,
		   0, 144.7589-58.9097-q, 4001,
		   1.44803+(1.411989+vb+pdn)*cos(147.7336), 4.464452+(1.411989+vb+pdn)*sin(147.7336), -1,

		   1.44803+1.411989*cos(147.7336), 4.464452+1.411989*sin(147.7336), 1,
		   1.44803, 4.464452, 901,
		   0, 193.0779-147.7336, 4001,
		   1.709162, 4.678263, 901,
		   0, 228.3262-198.05, 4001,
		   -0.45837, 2.145773, 901,
		   0, -(360-344.7371+50.6289), 4001,
		   2.397889, 1.240407, 901,
		   0, 189.6115-159.708, 4001,
		   2.163612+1.1397*cos(186.4165), 1.136308+1.1397*sin(186.4165), 1,
		   2.163612, 1.136308, 901,
		   0, 308.304-186.4165, 4001,
		   1.214941+2.620194*cos(309.1734), 2.273223+2.620194*sin(309.1734), 1,
		   1.214941, 2.273223, 901,
		   0, 332.4714-309.1734, 4001,
		   -0.77398+4.781021*cos(334.4216), 3.126379+4.781021*sin(334.4216), 1,
		   -0.77398, 3.126379, 901,
		   0, 344.4264-334.4216, 4001,
		   -0.001784+4.00811*cos(343.0158), 3.013597+4.00811*sin(343.0158), 1,
		   -0.001784, 3.013597, 901,
		   0, 27.7109+360-343.0158, 4001,
		   1.095943+2.88866*cos(31.9644), 3.348178+2.88866*sin(31.9644), 1,
		   1.095943, 3.348178, 901,
		   0, 55.7336-31.9644, 4001,
		   1.766278, 4.149894, 901,
		   0, 144.7589-58.9097, 4001,
		   1.44803+1.411989*cos(147.7336), 4.464452+1.411989*sin(147.7336), -1


	poly2_b 27, x2, gs_fill_pen, gs_back_pen,
		   1.44803+1.411989*cos(147.7336), 4.464452+1.411989*sin(147.7336), 1,
		   1.44803, 4.464452, 901,
		   0, 193.0779-147.7336, 4001,
		   1.709162, 4.678263, 901,
		   0, 228.3262-198.05, 4001,
		   -0.45837, 2.145773, 901,
		   0, -(360-344.7371+50.6289), 4001,
		   2.397889, 1.240407, 901,
		   0, 189.6115-159.708, 4001,
		   2.163612+1.1397*cos(186.4165), 1.136308+1.1397*sin(186.4165), 1,
		   2.163612, 1.136308, 901,
		   0, 308.304-186.4165, 4001,
		   1.214941+2.620194*cos(309.1734), 2.273223+2.620194*sin(309.1734), 1,
		   1.214941, 2.273223, 901,
		   0, 332.4714-309.1734, 4001,
		   -0.77398+4.781021*cos(334.4216), 3.126379+4.781021*sin(334.4216), 1,
		   -0.77398, 3.126379, 901,
		   0, 344.4264-334.4216, 4001,
		   -0.001784+4.00811*cos(343.0158), 3.013597+4.00811*sin(343.0158), 1,
		   -0.001784, 3.013597, 901,
		   0, 27.7109+360-343.0158, 4001,
		   1.095943+2.88866*cos(31.9644), 3.348178+2.88866*sin(31.9644), 1,
		   1.095943, 3.348178, 901,
		   0, 55.7336-31.9644, 4001,
		   1.766278, 4.149894, 901,
		   0, 144.7589-58.9097, 4001,
		   1.44803+1.411989*cos(147.7336), 4.464452+1.411989*sin(147.7336), -1


endif

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!! *** "L-Shaped" *** !!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!


if iPoolShape = POOLTYPE_LSHAPED then


		poly2_b 18, x1, deck_fill_pen, gs_back_pen,
			   -vb-pdn, 1.5, 1,
			   1.5, 1.5, 901,
			   0, 180, 4001,
			   3+vb+pdn, 4-sqr(3^2-2^2), 1,
			   4, 4-sqr(3^2-2^2), 901,
			   0, -acs(2/3), 4001,
			   2, 4, 901,
				0, 180+acs(2/3), 4001,
			   0, 1.5, -1,

			   0, 1.5, 1,
			   1.5, 1.5, 901,
			   0, 180, 4001,
			   3, 4-sqr(3^2-2^2), 1,
			   4, 4-sqr(3^2-2^2), 901,
			   0, -acs(2/3), 4001,
			   2, 4, 901,
				0, 180+acs(2/3), 4001,
			   0, 1.5, -1


		poly2_b 9, x2, gs_fill_pen, gs_back_pen,
			   0, 1.5, 1,
			   1.5, 1.5, 901,
			   0, 180, 4001,
			   3, 4-sqr(3^2-2^2), 1,
			   4, 4-sqr(3^2-2^2), 901,
			   0, -acs(2/3), 4001,
			   2, 4, 901,
				0, 180+acs(2/3), 4001,
			   0, 1.5, -1


endif


!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!end!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

					!!!!ladder=1!!!!

if ladder=1 then
drawindex 20

	if iPoolShape = POOLTYPE_8SHAPED then   add2 2-0.25, -vb/2
	if iPoolShape = POOLTYPE_KIDNEY then add2 2-0.1, -vb/2
	if iPoolShape = POOLTYPE_LSHAPED then   add2 1.5-0.25, -vb/2

	if ladder_fill_pen<>0 then      !! Water Fill
		xx=1+2+4+64
	else
		xx=1
	endif

		add2 0.02, 0.3757
		poly2_b 4, xx, ladder_fill_pen, gs_back_pen,
				0, -0.015/2, 1,
				0, 0.015/2, 1,
				0.46, 0.015/2, 1,
				0.46, -0.015/2, 1
		del 1
		for x=1 to 2
			poly2_b 2, xx, ladder_fill_pen, gs_back_pen,
					0, 0, 901,
					0.04, 360, 4001
			poly2_b 7, xx, ladder_fill_pen, gs_back_pen,
					0.02, 0, 1,
					0.02, 0.3757, 1,
					0, 0.3757, 901,
					0, 180, 4001,
					-0.02, 0, 1,
					0, 0, 901,
					0, 180, 4001
			add2 0.5, 0
		next x
		del 2
	del 1
endif





