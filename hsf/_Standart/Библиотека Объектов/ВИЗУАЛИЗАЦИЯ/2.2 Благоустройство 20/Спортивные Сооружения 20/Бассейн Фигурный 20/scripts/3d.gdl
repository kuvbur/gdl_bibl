
!!Free Form Pool.gsm

pen gs_cont_pen

if gs_detlevel_3D_m = DLEV3D_OFF then end
if gs_detlevel_3D_m = DLEV3D_SIMPLE then gs_resol = 8

IF gs_shadow=0 THEN SHADOW OFF


addz zzyzx

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!pool!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

mul a/4, b/6, 1

ADD -2,-3,0		!! Drag to Origo

if iPoolShape = POOLTYPE_8SHAPED then
   addz -pldp-vb
   material smat
	RESOL 3*gs_resol
	prism_  12, vb,              !! Bottom
		   2, -vb, 75,
		   2, 2, 975,
		   0, 90+asn(1/2.5), 4075,
		   2+sqr(2.5^2-1^2), 3, 975,
		   0, -2*asn(1/2.5), 4075,
		   2, 4, 975,
		   0, 2*(90+asn(1/2.5)), 4075,
		   2-sqr(2.5^2-1^2), 3, 975,
		   0, -2*asn(1/2.5), 4075,
			2, 2, 975,
		   0, 90+asn(1/2.5), 4075,
		   2, 0, -1
   addz vb
   prism_  24, pldp-pdt,
		   2, -vb, 78,
		   2, 2, 978,
		   0, 90+asn(1/2.5), 4078,
		   2+sqr(2.5^2-1^2), 3, 978,
		   0, -2*asn(1/2.5), 4078,
		   2, 4, 978,
		   0, 2*(90+asn(1/2.5)), 4078,
		   2-sqr(2.5^2-1^2), 3, 978,
		   0, -2*asn(1/2.5), 4078,
			2, 2, 978,
		   0, 90+asn(1/2.5), 4078,
		   2, 0, -1,

		   2, 0, 79,
		   2, 2, 979,
		   0, 90+asn(1/2.5), 4079,
		   2+sqr(2.5^2-1^2), 3, 979,
		   0, -2*asn(1/2.5), 4079,
		   2, 4, 979,
		   0, 2*(90+asn(1/2.5)), 4079,
		   2-sqr(2.5^2-1^2), 3, 979,
		   0, -2*asn(1/2.5), 4079,
			2, 2, 979,
		   0, 90+asn(1/2.5), 4079,
		   2, 0, -1
   if wh>0 then
	   material wmat
	   prism_  12, wh,
		   2, 0, 79,
		   2, 2, 979,
		   0, 90+asn(1/2.5), 4079,
		   2+sqr(2.5^2-1^2), 3, 979,
		   0, -2*asn(1/2.5), 4079,
		   2, 4, 979,
		   0, 2*(90+asn(1/2.5)), 4079,
		   2-sqr(2.5^2-1^2), 3, 979,
		   0, -2*asn(1/2.5), 4079,
			2, 2, 979,
		   0, 90+asn(1/2.5), 4079,
		   2, 0, -1
   endif
   del 2                       !!!!addz vb, addz -zzyzx-vb!!!!

   addz -pdt
   material pdmat
   prism_  24, pdt,
		   2, -vb-pdn, 79,
		   2, 2, 979,
		   0, 90+asn(1/2.5), 4079,
		   2+sqr(2.5^2-1^2), 3, 979,
		   0, -2*asn(1/2.5), 4079,
		   2, 4, 979,
		   0, 2*(90+asn(1/2.5)), 4079,
		   2-sqr(2.5^2-1^2), 3, 979,
		   0, -2*asn(1/2.5), 4079,
			2, 2, 979,
		   0, 90+asn(1/2.5), 4079,
		   2, 0, -1,

		   2, 0, 79,
		   2, 2, 979,
		   0, 90+asn(1/2.5), 4079,
		   2+sqr(2.5^2-1^2), 3, 979,
		   0, -2*asn(1/2.5), 4079,
		   2, 4, 979,
		   0, 2*(90+asn(1/2.5)), 4079,
		   2-sqr(2.5^2-1^2), 3, 979,
		   0, -2*asn(1/2.5), 4079,
			2, 2, 979,
		   0, 90+asn(1/2.5), 4079,
		   2, 0, -1
   del 1                       !!!!addz -pdt!!!!

   if ladder=1 then
	   add 2-0.25, -vb/2, 0
	   gosub 10
	   del 1
   endif                       !!!!ladder=1!!!!

DEL 2
endif

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

if iPoolShape = POOLTYPE_KIDNEY then
	addz -pldp-vb
	material smat
	RESOL 3*gs_resol
	prism_  30, vb,
			1.44803+(1.411989+vb)*cos(147.7336), 4.464452+(1.411989+vb)*sin(147.7336), 75,
			1.44803, 4.464452, 975,
			0, 193.0779-147.7336-q, 4075,

			1.709162+(1.721206+vb)*cos(198.05), 4.678263+(1.721206+vb)*sin(198.05), 75,
			1.709162, 4.678263, 975,
			0, 228.3262-198.05-q, 4075,

			-0.45837+(1.612888-vb)*cos(50.6289), 2.145773+(1.612888-vb)*sin(50.6289), 75,
			-0.45837, 2.145773, 975,
			0, -(360-344.7371+50.6289-q), 4075,

			2.397889+(1.386298+vb)*cos(159.708), 1.240407+(1.386298+vb)*sin(159.708), 75,
			2.397889, 1.240407, 975,
			0, 189.6115-159.708-q, 4075,

			2.163612+(1.1397+vb)*cos(186.4165), 1.136308+(1.1397+vb)*sin(186.4165), 75,
			2.163612, 1.136308, 975,
			0, 308.304-186.4165-q, 4075,

			1.214941+(2.620194+vb)*cos(309.1734), 2.273223+(2.620194+vb)*sin(309.1734), 75,
			1.214941, 2.273223, 975,
			0, 332.4714-309.1734-q, 4075,

			-0.77398+(4.781021+vb)*cos(334.4216), 3.126379+(4.781021+vb)*sin(334.4216), 75,
			-0.77398, 3.126379, 975,
			0, 344.4264-334.4216-q, 4075,

			-0.001784+(4.00811+vb)*cos(343.0158), 3.013597+(4.00811+vb)*sin(343.0158), 75,
			-0.001784, 3.013597, 975,
			0, 27.7109+360-343.0158-q, 4075,

			1.095943+(2.88866+vb)*cos(31.9644), 3.348178+(2.88866+vb)*sin(31.9644), 75,
			1.095943, 3.348178, 975,
			0, 55.7336-31.9644-q, 4075,

			1.766278+(1.851516+vb)*cos(58.9097), 4.149894+(1.851516+vb)*sin(58.9097), 75,
			1.766278, 4.149894, 975,
			0, 144.7589-58.9097-q, 4075

	addz vb

	prism_  62, pldp-pdt,
			1.44803+(1.411989+vb)*cos(147.7336), 4.464452+(1.411989+vb)*sin(147.7336), 78,
			1.44803, 4.464452, 978,
			0, 193.0779-147.7336-q, 4078,

			1.709162+(1.721206+vb)*cos(198.05), 4.678263+(1.721206+vb)*sin(198.05), 78,
			1.709162, 4.678263, 978,
			0, 228.3262-198.05-q, 4078,

			-0.45837+(1.612888-vb)*cos(50.6289), 2.145773+(1.612888-vb)*sin(50.6289), 78,
			-0.45837, 2.145773, 978,
			0, -(360-344.7371+50.6289-q), 4078,

			2.397889+(1.386298+vb)*cos(159.708), 1.240407+(1.386298+vb)*sin(159.708), 78,
			2.397889, 1.240407, 978,
			0, 189.6115-159.708-q, 4078,

			2.163612+(1.1397+vb)*cos(186.4165), 1.136308+(1.1397+vb)*sin(186.4165), 78,
			2.163612, 1.136308, 978,
			0, 308.304-186.4165-q, 4078,

			1.214941+(2.620194+vb)*cos(309.1734), 2.273223+(2.620194+vb)*sin(309.1734), 78,
			1.214941, 2.273223, 978,
			0, 332.4714-309.1734-q, 4078,

			-0.77398+(4.781021+vb)*cos(334.4216), 3.126379+(4.781021+vb)*sin(334.4216), 78,
			-0.77398, 3.126379, 978,
			0, 344.4264-334.4216-q, 4078,

			-0.001784+(4.00811+vb)*cos(343.0158), 3.013597+(4.00811+vb)*sin(343.0158), 78,
			-0.001784, 3.013597, 978,
			0, 27.7109+360-343.0158-q, 4078,

			1.095943+(2.88866+vb)*cos(31.9644), 3.348178+(2.88866+vb)*sin(31.9644), 78,
			1.095943, 3.348178, 978,
			0, 55.7336-31.9644-q, 4078,

			1.766278+(1.851516+vb)*cos(58.9097), 4.149894+(1.851516+vb)*sin(58.9097), 78,
			1.766278, 4.149894, 978,
			0, 144.7589-58.9097-q, 4078,

			1.44803+(1.411989+vb)*cos(147.7336), 4.464452+(1.411989+vb)*sin(147.7336), -1,

			1.44803+1.411989*cos(147.7336), 4.464452+1.411989*sin(147.7336), 79,
			1.44803, 4.464452, 979,
			0, 193.0779-147.7336, 4079,

			1.709162+1.721206*cos(198.05), 4.678263+1.721206*sin(198.05), 79,
			1.709162, 4.678263, 979,
			0, 228.3262-198.05, 4079,

			-0.45837+1.612888*cos(50.6289), 2.145773+1.612888*sin(50.6289), 79,
			-0.45837, 2.145773, 979,
			0, -(360-344.7371+50.6289), 4079,

			2.397889+1.386298*cos(159.708), 1.240407+1.386298*sin(159.708), 79,
			2.397889, 1.240407, 979,
			0, 189.6115-159.708, 4079,

			2.163612+1.1397*cos(186.4165), 1.136308+1.1397*sin(186.4165), 79,
			2.163612, 1.136308, 979,
			0, 308.304-186.4165, 4079,

			1.214941+2.620194*cos(309.1734), 2.273223+2.620194*sin(309.1734), 79,
			1.214941, 2.273223, 979,
			0, 332.4714-309.1734, 4079,

			-0.77398+4.781021*cos(334.4216), 3.126379+4.781021*sin(334.4216), 79,
			-0.77398, 3.126379, 979,
			0, 344.4264-334.4216, 4079,

			-0.001784+4.00811*cos(343.0158), 3.013597+4.00811*sin(343.0158), 79,
			-0.001784, 3.013597, 979,
			0, 27.7109+360-343.0158, 4079,

			1.095943+2.88866*cos(31.9644), 3.348178+2.88866*sin(31.9644), 79,
			1.095943, 3.348178, 979,
			0, 55.7336-31.9644, 4079,

			1.766278+1.851516*cos(58.9097), 4.149894+1.851516*sin(58.9097), 79,
			1.766278, 4.149894, 979,
			0, 144.7589-58.9097, 4079,

			1.44803+1.411989*cos(147.7336), 4.464452+1.411989*sin(147.7336), -1

	if wh>0 then
		material wmat
		prism_  30, wh,
				1.44803+1.411989*cos(147.7336), 4.464452+1.411989*sin(147.7336), 79,
				1.44803, 4.464452, 979,
				0, 193.0779-147.7336, 4079,

				1.709162+1.721206*cos(198.05), 4.678263+1.721206*sin(198.05), 79,
				1.709162, 4.678263, 979,
				0, 228.3262-198.05, 4079,

				-0.45837+1.612888*cos(50.6289), 2.145773+1.612888*sin(50.6289), 79,
				-0.45837, 2.145773, 979,
				0, -(360-344.7371+50.6289), 4079,

				2.397889+1.386298*cos(159.708), 1.240407+1.386298*sin(159.708), 79,
				2.397889, 1.240407, 979,
				0, 189.6115-159.708, 4079,

				2.163612+1.1397*cos(186.4165), 1.136308+1.1397*sin(186.4165), 79,
				2.163612, 1.136308, 979,
				0, 308.304-186.4165, 4079,

				1.214941+2.620194*cos(309.1734), 2.273223+2.620194*sin(309.1734), 79,
				1.214941, 2.273223, 979,
				0, 332.4714-309.1734, 4079,

				-0.77398+4.781021*cos(334.4216), 3.126379+4.781021*sin(334.4216), 79,
				-0.77398, 3.126379, 979,
				0, 344.4264-334.4216, 4079,

				-0.001784+4.00811*cos(343.0158), 3.013597+4.00811*sin(343.0158), 79,
				-0.001784, 3.013597, 979,
				0, 27.7109+360-343.0158, 4079,

				1.095943+2.88866*cos(31.9644), 3.348178+2.88866*sin(31.9644), 79,
				1.095943, 3.348178, 979,
				0, 55.7336-31.9644, 4079,

				1.766278+1.851516*cos(58.9097), 4.149894+1.851516*sin(58.9097), 79,
				1.766278, 4.149894, 979,
				0, 144.7589-58.9097, 4079
	endif

	del 2                       !!!!addz vb, addz -zzyzx-vb!!!!

	addz -pdt
	material pdmat
	prism_  62, pdt,
			1.44803+(1.411989+vb+pdn)*cos(147.7336), 4.464452+(1.411989+vb+pdn)*sin(147.7336), 79,
			1.44803, 4.464452, 979,
			0, 193.0779-147.7336-q, 4079,

			1.709162+(1.721206+vb+pdn)*cos(198.05), 4.678263+(1.721206+vb+pdn)*sin(198.05), 79,
			1.709162, 4.678263, 979,
			0, 228.3262-198.05-q, 4079,

			-0.45837+(1.612888-vb-pdn)*cos(50.6289), 2.145773+(1.612888-vb-pdn)*sin(50.6289), 79,
			-0.45837, 2.145773, 979,
			0, -(360-344.7371+50.6289-q), 4079,

			2.397889+(1.386298+vb+pdn)*cos(159.708), 1.240407+(1.386298+vb+pdn)*sin(159.708), 79,
			2.397889, 1.240407, 979,
			0, 189.6115-159.708-q, 4079,

			2.163612+(1.1397+vb+pdn)*cos(186.4165), 1.136308+(1.1397+vb+pdn)*sin(186.4165), 79,
			2.163612, 1.136308, 979,
			0, 308.304-186.4165-q, 4079,

			1.214941+(2.620194+vb+pdn)*cos(309.1734), 2.273223+(2.620194+vb+pdn)*sin(309.1734), 79,
			1.214941, 2.273223, 979,
			0, 332.4714-309.1734-q, 4079,

			-0.77398+(4.781021+vb+pdn)*cos(334.4216), 3.126379+(4.781021+vb+pdn)*sin(334.4216), 79,
			-0.77398, 3.126379, 979,
			0, 344.4264-334.4216-q, 4079,

			-0.001784+(4.00811+vb+pdn)*cos(343.0158), 3.013597+(4.00811+vb+pdn)*sin(343.0158), 79,
			-0.001784, 3.013597, 979,
			0, 27.7109+360-343.0158-q, 4079,

			1.095943+(2.88866+vb+pdn)*cos(31.9644), 3.348178+(2.88866+vb+pdn)*sin(31.9644), 79,
			1.095943, 3.348178, 979,
			0, 55.7336-31.9644-q, 4079,

			1.766278+(1.851516+vb+pdn)*cos(58.9097), 4.149894+(1.851516+vb+pdn)*sin(58.9097), 79,
			1.766278, 4.149894, 979,
			0, 144.7589-58.9097-q, 4079,

			1.44803+(1.411989+vb+pdn)*cos(147.7336), 4.464452+(1.411989+vb+pdn)*sin(147.7336), -1,

			1.44803+1.411989*cos(147.7336), 4.464452+1.411989*sin(147.7336), 79,
			1.44803, 4.464452, 979,
			0, 193.0779-147.7336, 4079,

			1.709162+1.721206*cos(198.05), 4.678263+1.721206*sin(198.05), 79,
			1.709162, 4.678263, 979,
			0, 228.3262-198.05, 4079,

			-0.45837+1.612888*cos(50.6289), 2.145773+1.612888*sin(50.6289), 79,
			-0.45837, 2.145773, 979,
			0, -(360-344.7371+50.6289), 4079,

			2.397889+1.386298*cos(159.708), 1.240407+1.386298*sin(159.708), 79,
			2.397889, 1.240407, 979,
			0, 189.6115-159.708, 4079,

			2.163612+1.1397*cos(186.4165), 1.136308+1.1397*sin(186.4165), 79,
			2.163612, 1.136308, 979,
			0, 308.304-186.4165, 4079,

			1.214941+2.620194*cos(309.1734), 2.273223+2.620194*sin(309.1734), 79,
			1.214941, 2.273223, 979,
			0, 332.4714-309.1734, 4079,

			-0.77398+4.781021*cos(334.4216), 3.126379+4.781021*sin(334.4216), 79,
			-0.77398, 3.126379, 979,
			0, 344.4264-334.4216, 4079,

			-0.001784+4.00811*cos(343.0158), 3.013597+4.00811*sin(343.0158), 79,
			-0.001784, 3.013597, 979,
			0, 27.7109+360-343.0158, 4079,

			1.095943+2.88866*cos(31.9644), 3.348178+2.88866*sin(31.9644), 79,
			1.095943, 3.348178, 979,
			0, 55.7336-31.9644, 4079,

			1.766278+1.851516*cos(58.9097), 4.149894+1.851516*sin(58.9097), 79,
			1.766278, 4.149894, 979,
			0, 144.7589-58.9097, 4079,

			1.44803+1.411989*cos(147.7336), 4.464452+1.411989*sin(147.7336), -1

	del 1                       !!!!addz -pdt!!!!

	if ladder=1 then
		add 2-0.1, -vb/2, 0
		gosub 10
		del 1
	endif                       !!!!ladder=1!!!!

endif                       !!!!

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

if iPoolShape = POOLTYPE_LSHAPED then
	   addz -pldp-vb
	   material smat
		RESOL 3*gs_resol
	   prism_  9, vb,
			   -vb, 1.5, 75,
			   1.5, 1.5, 975,
			   0, 180, 4075,
			   3+vb, 4-sqr(3^2-2^2), 75,
			   4, 4-sqr(3^2-2^2), 975,
			   0, -acs(2/3), 4075,
			   2, 4, 975,
				0, 180+acs(2/3), 4075,
			   0, 1.5, -1
	   addz vb
	   prism_  18, pldp-pdt,
			   -vb, 1.5, 78,
			   1.5, 1.5, 978,
			   0, 180, 4078,
			   3+vb, 4-sqr(3^2-2^2), 78,
			   4, 4-sqr(3^2-2^2), 978,
			   0, -acs(2/3), 4078,
			   2, 4, 978,
				0, 180+acs(2/3), 4078,
			   0, 1.5, -1,

			   0, 1.5, 79,
			   1.5, 1.5, 979,
			   0, 180, 4079,
			   3, 4-sqr(3^2-2^2), 79,
			   4, 4-sqr(3^2-2^2), 979,
			   0, -acs(2/3), 4079,
			   2, 4, 979,
				0, 180+acs(2/3), 4079,
			   0, 1.5, -1
	   if wh>0 then
		   material wmat
		   prism_  9, wh,
			   0, 1.5, 79,
			   1.5, 1.5, 979,
			   0, 180, 4079,
			   3, 4-sqr(3^2-2^2), 79,
			   4, 4-sqr(3^2-2^2), 979,
			   0, -acs(2/3), 4079,
			   2, 4, 979,
				0, 180+acs(2/3), 4079,
			   0, 1.5, -1
	   endif
	   del 2                       !!!!addz vb, addz -zzyzx-vb!!!!

	   addz -pdt
	   material pdmat
	   prism_  18, pdt,
			   -vb-pdn, 1.5, 78,
			   1.5, 1.5, 978,
			   0, 180, 4078,
			   3+vb+pdn, 4-sqr(3^2-2^2), 78,
			   4, 4-sqr(3^2-2^2), 978,
			   0, -acs(2/3), 4078,
			   2, 4, 978,
				0, 180+acs(2/3), 4078,
			   0, 1.5, -1,

			   0, 1.5, 79,
			   1.5, 1.5, 979,
			   0, 180, 4079,
			   3, 4-sqr(3^2-2^2), 79,
			   4, 4-sqr(3^2-2^2), 979,
			   0, -acs(2/3), 4079,
			   2, 4, 979,
				0, 180+acs(2/3), 4079,
			   0, 1.5, -1

	   del 1                       !!!!addz -pdt!!!!

	   if ladder=1 then
		   add 1.5-0.25, -vb/2, 0
		   gosub 10
		   del 1
	   endif                       !!!!ladder=1!!!!


endif                       !!!!ps!!!!

del 1                       !!!!zzyzx, mul!!!!
end

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!end!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

10:
RESOL gs_resol
material lmat
roty 90
addy 0.3757
addx 0.15
addz 0.02
cylind 0.46, 0.015
del 1
addx 0.25
addz 0.02
cylind 0.46, 0.015
del 1
del 4
for n=1 to 2
   cylind 0.02, 0.04
   addz 0.02
   sweep   2, 14, 0, 1, 1+2+4+16+32,
		   0, 0, 901,
		   0.02, 360, 4001,

		   0, 0, 0,
		   0, 0, 0.490624,
		   0, 0.013559, 0.546034,
		   0, 0.051171, 0.588922,
		   0, 0.104337, 0.609597,
		   0, 0.161042, 0.603387,
		   0, 0.208473, 0.571695,
		   0, 0.235911, 0.521682,
		   0, 0.375695, 0.0,
		   0, 0.375695, -0.62,
		   0, 0.364977, -0.66,
		   0, 0.335695, -0.689282,
		   0, 0.295695, -0.7,
		   0, 0.133262, -0.7
   del 1
   addx 0.5
next n
del 2

return
