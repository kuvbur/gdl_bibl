
if gs_detlevel_3D_m = DLEV3D_OFF then end

if gs_shadow=0 then SHADOW OFF

resol gs_resol

pen gs_cont_pen


! --- Field --------------------------------------------------------------------

addz -fv

for x=1 to 2
	material line_mat
	prism_  57, fv,
			-a/2, -b/2, 79,
			0, -b/2, 72,
			0, b/2, 77,
			-a/2, b/2, 79,
			-a/2, -b/2, -1,

			-a/2+vv+1, -b/2+vv, 79,
			-vv/2, -b/2+vv, 79,
			-vv/2, -9.15, 79,
			-vv/2, 0, 979,
			0, -180, 4079,
			-vv/2, b/2-vv, 79,
			-a/2+vv+1, b/2-vv, 79,
			-a/2+vv, b/2-vv, 979,
			0, -90, 4079,
			-a/2+vv, 20.1, 79,
			-a/2+vv+16.4, 20.1, 79,
			-a/2+vv+16.4, sqr(9.15^2-5.4^2), 79,
			-a/2+vv+11, 0, 979,
			0, -2*acs(5.4/9.15), 4079,
			-a/2+vv+16.4, -20.1, 79,
			-a/2+vv, -20.1, 79,
			-a/2+vv, -b/2+vv+1, 79,
			-a/2+vv, -b/2+vv, 979,
			0, -90, 4079,
			-a/2+vv+1, -b/2+vv, -1,

			-vv/2, -9.15+vv, 79,
			-vv/2, 0, 979,
			0, -180, 4079,
			-vv/2, -9.15+vv, -1,

			-a/2+vv, -20.1+vv, 79,
			-a/2+16.4, -20.1+vv, 79,
			-a/2+16.4, 20.1-vv, 79,
			-a/2+vv, 20.1-vv, 79,
			-a/2+vv, 9.15, 79,
			-a/2+vv+5.4, 9.15, 79,
			-a/2+vv+5.4, -9.15, 79,
			-a/2+vv, -9.15, 79,
			-a/2+vv, -20.1+vv, -1,

			-a/2+vv, -9.15+vv, 79,
			-a/2+5.4, -9.15+vv, 79,
			-a/2+5.4, 9.15-vv, 79,
			-a/2+vv, 9.15-vv, 79,
			-a/2+vv, -9.15+vv, -1,

			-a/2+vv+16.4, sqr((9.15-vv)^2-5.4^2), 79,
			-a/2+vv+11, 0, 979,
			0, -2*acs(5.4/(9.15-vv)), 4079,
			-a/2+vv+16.4, sqr((9.15-vv)^2-5.4^2), -1,

			-a/2+1, -b/2+vv, 79,
			-a/2+vv, -b/2+vv, 979,
			0, 90, 4079,
			-a/2+vv, -b/2+vv, 79,
			-a/2+1, -b/2+vv, -1,

			-a/2+1, b/2-vv, 79,
			-a/2+vv, b/2-vv, 979,
			0, -90, 4079,
			-a/2+vv, b/2-vv, 79,
			-a/2+1, b/2-vv, -1

	material court_mat
	prism_  19, fv,
			-a/2+vv+1, -b/2+vv, 79,
			-vv/2, -b/2+vv, 79,
			-vv/2, -9.15, 79,
			-vv/2, 0, 979,
			0, -180, 4079,
			-vv/2, b/2-vv, 79,
			-a/2+vv+1, b/2-vv, 79,
			-a/2+vv, b/2-vv, 979,
			0, -90, 4079,
			-a/2+vv, 20.1, 79,
			-a/2+vv+16.4, 20.1, 79,
			-a/2+vv+16.4, sqr(9.15^2-5.4^2), 79,
			-a/2+vv+11, 0, 979,
			0, -2*acs(5.4/9.15), 4079,
			-a/2+vv+16.4, -20.1, 79,
			-a/2+vv, -20.1, 79,
			-a/2+vv, -b/2+vv+1, 79,
			-a/2+vv, -b/2+vv, 979,
			0, -90, 4079
	prism_  3, fv,
			-vv/2, -9.15+vv, 79,
			-vv/2, 0, 979,
			0, -180, 4079
	prism_  8, fv,
			-a/2+vv, -20.1+vv, 79,
			-a/2+16.4, -20.1+vv, 79,
			-a/2+16.4, 20.1-vv, 79,
			-a/2+vv, 20.1-vv, 79,
			-a/2+vv, 9.15, 79,
			-a/2+vv+5.4, 9.15, 79,
			-a/2+vv+5.4, -9.15, 79,
			-a/2+vv, -9.15, 79
	prism_  4, fv,
			-a/2+vv, -9.15+vv, 79,
			-a/2+5.4, -9.15+vv, 79,
			-a/2+5.4, 9.15-vv, 79,
			-a/2+vv, 9.15-vv, 79
	prism_  3, fv,
			-a/2+vv+16.4, sqr((9.15-vv)^2-5.4^2), 79,
			-a/2+vv+11, 0, 979,
			0, -2*acs(5.4/(9.15-vv)), 4079
	prism_  4, fv,
			-a/2+1, -b/2+vv, 79,
			-a/2+vv, -b/2+vv, 979,
			0, 90, 4079,
			-a/2+vv, -b/2+vv, 79
	prism_  4, fv,
			-a/2+1, b/2-vv, 79,
			-a/2+vv, b/2-vv, 979,
			0, -90, 4079,
			-a/2+vv, b/2-vv, 79


	! --- Goal -----------------------------------------------------------------

	if goal=1 then
		addx -a/2+vv
		material court_mat
		if track=0 then
			mask=79
			else mask=0
		prism_  4, fv,
				-vv, -3.65-vv, mask,
				-vv, 3.65+vv, mask,
				-2.4, 3.65+vv, mask,
				-2.4, -3.65-vv, mask
		add 0, -3.65, fv
		roty -90
		rotx 90
		material goal_mat
		prism_  7, vv,
				0, 0, 15,
				0, vv, 15,
				2.4, vv, 12,
				2.4+vv, vv, 14,
				2.4+vv, 0, 14,
				2.4, 0, 13,
				0, 0, -1

		material net_mat
		gosub 5

		addz -7.3-vv

		material goal_mat
		prism_  7, vv,
				0, 0, 15,
				0, vv, 15,
				2.4, vv, 9,
				2.4+vv, vv, 11,
				2.4+vv, 0, 11,
				2.4, 0, 13,
				0, 0, -1

		material net_mat
		gosub 5
		gosub 10

		del 4

		material goal_mat
		addz 2.4+fv
		prism_  4, vv,
				0, -3.65, 13,
				0, 3.65, 9,
				-vv, 3.65, 13,
				-vv, -3.65, 9
		del 2


		! --- Flag -------------------------------------------------------------

		if flag=1 then
			material goal_mat
			add -a/2+vv/2, -b/2+vv/2, fv
			cylind 1.5, 0.025
				material flag_mat
				addz 1
				rotz 45
				addx 0.025
				prism_  4, 0.5,
						0, -0.001, 15,
						0.5, -0.001, 15,
						0.5, 0.001, 15,
						0, 0.001, 15
				del 3
			del 1
		endif


		if flag=1 then
			material goal_mat
			add -a/2+vv/2, b/2-vv/2, fv
			cylind 1.5, 0.025       !!Post
				material flag_mat
				addz 1
				rotz -45
				addx 0.025
				prism_  4, 0.5,
							0, -0.001, 15,
						0.5, -0.001, 15,
						0.5, 0.001, 15,
						0, 0.001, 15
				del 3
			del 1
		endif

	endif
	rotz 180
next x
del 2


if goal=1 then
	material line_mat
	add 0, -b/2+vv/2, fv
	cylind 1.5, 0.025
	if flag=1 then
		material flag_mat
		addz 1
		rotz 90
		addx 0.025
		prism_  4, 0.5,
				0, -0.001, 15,
				0.5, -0.001, 15,
				0.5, 0.001, 15,
				0, 0.001, 15
		del 3
	endif
	del 1

	material line_mat
	add 0, b/2-vv/2, fv
	cylind 1.5, 0.025
	if flag=1 then
		material flag_mat
		addz 1
		rotz -90
		addx 0.025
		prism_  4, 0.5,
				0, -0.001, 15,
				0.5, -0.001, 15,
				0.5, 0.001, 15,
				0, 0.001, 15
		del 3
	endif
	del 1

endif


! --- Track --------------------------------------------------------------------

if track=1 then
	material slag_mat
	prism_  16, fv,
			-70.02, -35.98-tkw, 79,
			42.98, -35.98-tkw, 79,
			42.98, 0, 979,
			0, 180, 4079,
			-42.98, 35.98+tkw, 79,
			-42.98, 0, 979,
			0, 125, 4079,
			-42.98, -35.98-tkw, -1,

			-42.98, -35.98, 79,
			42.98, -35.98, 79,
			42.98, 0, 979,
			0, 180, 4079,
			-42.98, 35.98, 79,
			-42.98, 0, 979,
			0, 180, 4079,
			-42.98, -35.98, -1


	if goal=0 then
		material court_mat
		prism_  4, fv,
				-a/2, -3.65-vv, 0,
				-a/2, 3.65+vv, 0,
				-a/2-2.4, 3.65+vv, 0,
				-a/2-2.4, -3.65-vv, 0
		prism_  4, fv,
				a/2, -3.65-vv, 0,
				a/2, 3.65+vv, 0,
				a/2+2.4, 3.65+vv, 0,
				a/2+2.4, -3.65-vv, 0
	endif               !!!!goal=0!!!!

	material court_mat
	prism_   21, fv,
			-42.98, -35.98, 79,
			42.98, -35.98, 79,
			42.98, 0, 979,
			0, 180, 4079,
			-42.98, 35.98, 79,
			-42.98, 0, 979,
			0, 180, 4079,
			-42.98, -35.98, -1,

			-a/2, -b/2, 64,
			a/2, -b/2, 64,
			a/2, -3.65-vv, 64,
			a/2+2.4-vv, -3.65-vv, 64,
			a/2+2.4-vv, 3.65+vv, 64,
			a/2, 3.65+vv, 64,
			a/2, b/2, 64,
			-a/2, b/2, 64,
			-a/2, 3.65+vv, 64,
			-a/2-2.4+vv, 3.65+vv, 64,
			-a/2-2.4+vv, -3.65-vv, 64,
			-a/2, -3.65-vv, 64,
			-a/2, -b/2, -1
endif

del 1

if track = 1 and gs_detlevel_3D_m = DLEV3D_DETAILED then
	material line_mat
	for x=0 to lanes
		prism_  18, 0.001,
				-42.98, -35.98-vv-x*1.22, 79,
				42.98, -35.98-vv-x*1.22, 79,
				42.98, 0, 979,
				0, 180, 4079,
				-42.98, 35.98+vv+x*1.22, 79,
				-42.98, 0, 979,
				0, 125, 4079,
				0, 55, 4079,
				-42.98, -35.98-vv-x*1.22, -1,

				-42.98, -35.98-x*1.22, 79,
				42.98, -35.98-x*1.22, 79,
				42.98, 0, 979,
				0, 180, 4079,
				-42.98, 35.98+x*1.22, 79,
				-42.98, 0, 979,
				0, 125, 4079,
				0, 55, 4079,
				-42.98, -35.98-x*1.22, -1

	next x
endif


end



5:
addz vv/2-0.001
prism_  5, 0.002,
		0, vv, 15,
		0, 2.4-vv, 15,
		2.4+vv/2, 1.2-vv/2, 15,
		2.4+vv/2, vv, 15,
		0, vv, -1
del 1
return

10:
addz vv/2+0.001
prism_  7, 7.3+vv-0.002,
		0, 2.4-vv-0.002, 15,
		0, 2.4-vv, 15,
		2.4+vv/2, 1.2-vv/2, 15,
		2.4+vv/2, vv, 15,
		2.4+vv/2-0.002, vv, 15,
		2.4+vv/2-0.002, 1.2-vv/2-0.001, 15,
		0, 2.4-vv-0.002, -1
del 1                       !!!!addz vv!!!!
return

