
!! Mobile Crane LTM 1100-52
!! created by Zsolt Feke/CSD


IF gs_detlevel_3D_m = DLEV3D_OFF THEN END

IF gs_shadow=0 THEN SHADOW OFF

PEN gs_cont_pen
RESOL res

ROTy gs_rot
ROTx gs_rot_hor

HOTSPOT 9.858, widthVehicle/2, 0
HOTSPOT 9.858, -widthVehicle/2, 0
HOTSPOT 0.10, widthVehicle/2, 0
HOTSPOT 0.10, -widthVehicle/2, 0
HOTSPOT 6.763, 0, 0

IF cArc THEN
	xx = -(craneLength+0.27)*COS(craneAng)-1.06*SIN(craneAng)+2.00
	yy = craneLength*SIN(craneAng)
	ADD 7.985, 0, yy+3.20+freeHeight
	MODEL WIRE
	CIRCLE ABS(xx)
	MODEL SURFACE
	DEL 1
ENDIF

MATERIAL fmat
ROTx 90
ADD 1.80, freeHeight, -widthVehicle/2
PRISM_ 19, widthVehicle,
	9.643, 0.35, 15,
	8.74, 0.35, 15,
	8.74, 0.62, 15,
	8.46, 1.14, 15,
	8.31, 1.26, 15,
	2.58, 1.26, 15,
	2.43, 1.14, 15,
	2.15, 0.62, 15,
	2.15, 0.26, 15,
	1.37, 0.26, 15,
	1.37, 0.62, 15,
	1.09, 1.14, 15,
	0.94, 1.26, 15,
	0.29, 1.26, 15,
	0.04, 1, 15,
	0, 1, 15,
	0, 1.44, 15,
	9.643, 1.44, 15,
	9.643, 0.35, -1

PRISM_ 6, widthVehicle,
	-0.5, 0.43, 15,
	-0.47, 0.43, 15,
	-0.075, 1.1, 15,
	-0.075, 1.342202880008, 15,
	-0.5, 0.6213168040583, 15,
	-0.5, 0.43, -1
DEL 1

ADD 1.80, freeHeight, -0.50
PRISM_ 17, 1.00,
	0.66, 0, 15,
	0.948, 0.48, 15,
	1.37, 0.48, 15,
	1.37, 0.62, 15,
	1.09, 1.14, 15,
	0.94, 1.26, 15,
	0.29, 1.26, 15,
	0.04, 1, 15,
	0, 1, 15,
	0, 1.44, 15,
	-0.01734348895973, 1.44, 15,
	-0.075, 1.342202880008, 15,
	-0.075, 1.1, 15,
	-0.4275415575052, 0.5, 15,
	0, 0.5, 15,
	0.3, 0, 15,
	0.66, 0, -1

PRISM_ 12, 1.00,
	8.05, 0, 15,
	8.44, 0.5, 15,
	8.74, 0.5, 15,
	8.74, 0.62, 15,
	8.46, 1.14, 15,
	8.31, 1.26, 15,
	2.58, 1.26, 15,
	2.43, 1.14, 15,
	2.15, 0.62, 15,
	2.15, 0.33, 15,
	2.848221402244, 0, 15,
	8.05, 0, -1
DEL 1

ADD 1.80, freeHeight, -widthVehicle/2+0.20
PRISM_ 9, widthVehicle-0.40,
	-0.01734348895973, 1.44, 15,
	-0.1173434889597, 1.44, 15,
	-0.5241345337359, 0.75, 15,
	-1.65, 0.75, 15,
	-1.65, 0.55, 15,
	-1.33, 0.43, 15,
	-0.5, 0.43, 15,
	-0.5, 0.6213168040583, 15,
	-0.01734348895973, 1.44, -1
DEL 1

ADD 1.80, freeHeight, -widthVehicle/2
PRISM_ 7, 0.20,
	-1.65, 0.5873800163858, 15,
	-1.323653289638, 0.465, 15,
	-0.5, 0.465, 15,
	-0.5, 0.43, 15,
	-1.33, 0.43, 15,
	-1.65, 0.55, 15,
	-1.65, 0.5873800163858, -1

PRISM_ 9, 0.15,
	-1.04, 0.43, 15,
	-1.04, 0.12, 15,
	-0.6, 0.12, 15,
	-0.6, 0.43, 15,
	-0.625, 0.43, 15,
	-0.625, 0.165, 15,
	-1.015, 0.165, 15,
	-1.015, 0.43, 15,
	-1.04, 0.43, -1
DEL 1

ADD 1.80, freeHeight, widthVehicle/2-0.20
PRISM_ 7, 0.20,
	-1.65, 0.5873800163858, 15,
	-1.323653289638, 0.465, 15,
	-0.5, 0.465, 15,
	-0.5, 0.43, 15,
	-1.33, 0.43, 15,
	-1.65, 0.55, 15,
	-1.65, 0.5873800163858, -1

PRISM_ 9, 0.15,
	-1.04, 0.43, 15,
	-1.04, 0.12, 15,
	-0.6, 0.12, 15,
	-0.6, 0.43, 15,
	-0.625, 0.43, 15,
	-0.625, 0.165, 15,
	-1.015, 0.165, 15,
	-1.015, 0.43, 15,
	-1.04, 0.43, -1
DEL 2

ADD 0.15, 0, 0.55+freeHeight
ROTz 90
CUTPLANE 180+20.5560
DEL 2

ADD 0.10, 0, 0.55+freeHeight
rr = 0.05
PRISM_ 4, 0.15,
	0, 0, 13,
	0, widthVehicle/2-rr, 79,
	rr, widthVehicle/2, 1015,
	rr, 0, 8
PRISM_ 4, 0.15,
	0, 0, 13,
	0, -widthVehicle/2+rr, 79,
	rr, -widthVehicle/2, 1015,
	rr, 0, 8
DEL 1
CUTEND

FOR i = 1 TO 2
	IF i = 1 THEN ADD 2.275, -widthVehicle/2+widthWheel, 0
	IF i = 1 THEN angWheel = 90
	IF i = 2 THEN ADD 2.275, widthVehicle/2-widthWheel, 0
	IF i = 2 THEN angWheel = -90
	GOSUB 101
	ADDx 2.50
	GOSUB 101
	ADDx 1.63
	GOSUB 101
	ADDx 1.615
	GOSUB 101
	ADDx 1.65
	GOSUB 101
	DEL 5
NEXT i

ADD 7.985, 0, 1.44+freeHeight
CYLIND 0.10, 0.85
DEL 1


				! ----------------- !
				! ----- CRANE ----- !
				! ----------------- !

MATERIAL bmat

uX = 9.985-5.20*COS(craneAng)-1.00*SIN(craneAng)
uZ = (3.20+freeHeight)+5.20*SIN(craneAng)-1.00*COS(craneAng)

!LIN_ uX, 0, uZ, 7.35, 0, 1.95+freeHeight

length = SQR((uZ-(2.00+freeHeight))^2+(uX-8.385)^2)
ADD 8.385-0.40, 0, 2.00+freeHeight
ROTz craneAxisAng
ADDx 0.40
ROTy -90+ASN((ABS(uZ-(2.00+freeHeight)))/length)
CYLIND 3.2, 0.18
MATERIAL fmat
ADDz 3.2
CYLIND length-3.2, 0.12
DEL 5


MATERIAL bmat
ww = 1.00
dd = 0.90

hID = 1
ADD 9.985-2.00, 0, 3.20+freeHeight
ROTz craneAxisAng
ADDx 2.00
	HOTSPOT 0, 0, 0, hID, craneAng, 6: hID = hID+1
	HOTSPOT -craneLength/2, 0, 0, hID, craneAng, 4+128: hID = hID+1
	HOTSPOT -(craneLength/2)*COS(craneAng), 0, (craneLength/2)*SIN(craneAng), hID, craneAng, 5: hID = hID+1
	HOTSPOT 0, 1, 0, hID, craneAng, 7: hID = hID+1
DEL 3

ADD 9.985-2.00, 0, 3.20+freeHeight
ROTz craneAxisAng
ADDx 2.00
ROTy -90+craneAng

HOTSPOT 0, 0, 0.30, hID, craneLength, 1+128: hID = hID+1
HOTSPOT 0, 0, 0, hID, craneLength, 3: hID = hID+1
HOTSPOT 0, 0, 0.30+craneLength, hID, craneLength, 2: hID = hID+1

ADD -ww/2+0.18, 0, -0.30
EXTRUDE 5, 0, 0, 10.8, 1+16+32,
	-ww/2, dd/2, 0,
	-ww/2, -dd/2, 0,
	ww/2, -dd/2, 0,
	ww/2, dd/2, 0,
	-ww/2, dd/2, -1

ADD -ww/2, 0, 5.50
ROTy 90
ROTx 90
ADDz -0.20
PRISM_ 5, 0.40,
	-0.6256824723549, 0, 15,
	-0.05730057541236, -0.2931653994756, 79,
	0.1242631555648, -0.1956248701424, 1015,
	0.1558195359586, 0, 15,
	-0.6256824723549, 0, -1
DEL 4

ADDz 10.7
EXTRUDE 10, 0, 0, 0.1, 1+2+16+32,
	-ww/2-0.10, dd/2+0.10, 0,
	-ww/2-0.10, -dd/2-0.10, 0,
	ww/2+0.10, -dd/2-0.10, 0,
	ww/2+0.10, dd/2+0.10, 0,
	-ww/2-0.10, dd/2+0.10, -1,
	-ww/2, dd/2, 0,
	-ww/2, -dd/2, 0,
	ww/2, -dd/2, 0,
	ww/2, dd/2, 0,
	-ww/2, dd/2, -1
DEL 1

FOR i = 1 TO 5
	IF i = 1 AND craneLength <= 19.6 THEN ADDz craneLength-11.5
	IF i = 1 AND craneLength > 19.6 THEN ADDz 8.1
	IF i = 2 AND 19.6 < craneLength AND craneLength <= 27.7 THEN ADDz craneLength-19.6
	IF i = 2 AND craneLength > 27.7 THEN ADDz 8.1
	IF i = 3 AND 27.7 < craneLength AND craneLength <= 35.8 THEN ADDz craneLength-27.7
	IF i = 3 AND craneLength > 35.8 THEN ADDz 8.1
	IF i = 4 AND 35.8 < craneLength AND craneLength <= 43.9 THEN ADDz craneLength-35.8
	IF i = 4 AND craneLength > 43.9 THEN ADDz 8.1
	IF i = 5 AND 43.9 < craneLength AND craneLength <= 52.0 THEN ADDz craneLength-43.9
	IF i = 5 AND craneLength > 52.0 THEN ADDz 8.1

	ww = ww-0.04
	dd = dd-0.06
	ADDz 1.6+0.136*i
	EXTRUDE 5, 0, 0, 9.2, 1+16+32,
		-ww/2, dd/2, 0,
		-ww/2, -dd/2, 0,
		ww/2, -dd/2, 0,
		ww/2, dd/2, 0,
		-ww/2, dd/2, -1
	IF i < 5 THEN
		ADDz 9.1
		EXTRUDE 10, 0, 0, 0.1, 1+2+16+32,
			-ww/2-0.10, dd/2+0.10, 0,
			-ww/2-0.10, -dd/2-0.10, 0,
			ww/2+0.10, -dd/2-0.10, 0,
			ww/2+0.10, dd/2+0.10, 0,
			-ww/2-0.10, dd/2+0.10, -1,
			-ww/2, dd/2, 0,
			-ww/2, -dd/2, 0,
			ww/2, -dd/2, 0,
			ww/2, dd/2, 0,
			-ww/2, dd/2, -1
		DEL 1
	ENDIF
	DEL 1
NEXT i

DEL TOP

ROTy gs_rot
ROTx gs_rot_hor

RESOL res/2

ADD 9.985-2.00, 0, 3.20+freeHeight
ROTz craneAxisAng
ADDx 2.00

ROTy -90+craneAng
ADD -ww/2+0.18, 0, craneLength-0.32
ROTx 90
ADDz -0.325
GROUP "main"
	PRISM_ 12, 0.65,
		-0.95, 0.40, 15,
		0.435, 0.39341527, 15,
		0.435, 0.3223254, 15,
		0.30, 0, 15,
		-0.50, 0, 15,
		-0.50, 0.035, 15,
		-0.95, 0.30, 15,
		-0.95, 0.40, -1,
		-0.84, 0.32, 979,
		0.05, 360, 4079,
		0.35, 0.32, 979,
		0.05, 360, 4079
ENDGROUP

GROUP "2block"
	ADDz 0.05
	PRISM_ 5, 0.55,
		-0.50, 0.035, 15,
		-0.9275, 0.035, 15,
		-0.9275, 0.43, 15,
		-0.50, 0.43, 15,
		-0.50, 0.035, -1

	PRISM_ 5, 0.55,
		0.05, 0.035, 15,
		0.5575, 0.035, 15,
		0.5575, 0.415, 15,
		0.05, 0.415, 15,
		0.05, 0.035, -1
	DEL 1
ENDGROUP

PLACEGROUP SUBGROUP("main", "2block")
KILLGROUP "main"
KILLGROUP "2block"

ADDz -0.05
PRISM_ 2, 0.75,
	-0.84, 0.32, 979,
	0.05, 360, 4079
PRISM_ 2, 0.75,
	0.35, 0.32, 979,
	0.05, 360, 4079
DEL 1

ADDz 0.175
PRISM_ 2, 0.30,
	-0.84, 0.32, 979,
	0.27, 360, 4079
DEL 1
ADDz 0.275
PRISM_ 2, 0.10,
	0.35, 0.32, 979,
	0.27, 360, 4079
DEL 5

MATERIAL fmat
length2 = 1.27
IF ABS(craneAng) < EPS AND (craneLength-11.50) < EPS AND ABS(craneAxisAng) < EPS THEN alpha = 43.75
xx = -craneLength*COS(craneAng)-1.0594*SIN(craneAng)
yy = craneLength*SIN(craneAng)-1.0594*COS(craneAng)
PLANE 4,
	xx+0.265*COS(alpha), -0.025, yy+0.265*SIN(alpha),
	xx+0.265*COS(alpha)+length2*SIN(alpha), -0.025, yy+0.265*SIN(alpha)-length2*COS(alpha),
	xx+0.265*COS(alpha)+length2*SIN(alpha), 0.025, yy+0.265*SIN(alpha)-length2*COS(alpha),
	xx+0.265*COS(alpha), 0.025, yy+0.265*SIN(alpha)

PLANE 4,
	xx-0.265*COS(alpha), -0.025, yy-0.265*SIN(alpha),
	xx-0.265*COS(alpha)+length2*SIN(alpha), -0.025, yy-0.265*SIN(alpha)-length2*COS(alpha),
	xx-0.265*COS(alpha)+length2*SIN(alpha), 0.025, yy-0.265*SIN(alpha)-length2*COS(alpha),
	xx-0.265*COS(alpha), 0.025, yy-0.265*SIN(alpha)

ADD xx+length2*SIN(alpha), -0.025, yy-length2*COS(alpha)
ROTy -alpha
ROTx 90
IF gs_detlevel_3D_m = DLEV3D_DETAILED THEN
	ADDz -0.075
	PRISM_ 9, 0.05,
		-0.15, 0.3248331346675, 15,
		0.15, 0.3248331346675, 15,
		0.29, 0.1318895717211, 15,
		0.29, -0.1503827977497, 15,
		0.12, -0.5751668653325, 15,
		-0.12, -0.5751668653325, 15,
		-0.29, -0.1503827977497, 15,
		-0.29, 0.1318895717211, 15,
		-0.15, 0.3248331346675, -1
	ADDz 0.05
	CYLIND 0.05, 0.27
	PRISM_ 32, 0.05,
	   -0.04, -0.5051668653325, 15,
	   -0.04, -0.6175411361773, 79,
		-0.05155732629584, -0.639381257153, 79,
		-0.08165859504567, -0.6681483678838, 79,
		-0.1294381145982, -0.7011875895328, 79,
		-0.1722319451539, -0.7429698310167, 79,
		-0.195227532447, -0.806772198903, 79,
		-0.1912353684315, -0.8798053170697, 79,
		-0.1592980563071, -0.9383510346007, 79,
		-0.1155765334775, -0.9765282234199, 79,
		-0.05292765899719, -0.9978993091583, 79,
		0.005437417628176, -0.9935819915125, 79,
		0.05961162524176, -0.9641375238866, 79,
		0.1008429119633, -0.9246945821313, 79,
		0.1183650798143, -0.8741512567219, 79,
		0.1181259676826, -0.8112989249488, 79,
		0.1067498695791, -0.7750516558656, 79,
		0.08240850753863, -0.7730013815861, 79,
		0.06553664694808, -0.794208623913, 79,
		0.06379346220826, -0.8241679181201, 79,
		0.05361434717316, -0.8647308334906, 79,
		0.02405042381465, -0.8947222666529, 79,
		-0.02834243173408, -0.9013286809815, 79,
		-0.06565732927812, -0.8768189232803, 79,
		-0.08148698618527, -0.8259111028599, 79,
		-0.06428093991921, -0.7798928321378, 79,
		-0.02668684079181, -0.7493901019327, 79,
		0.006006436481071, -0.7050533049144, 79,
		0.02660290430319, -0.6729280750897, 79,
		0.04, -0.6368279102805, 79,
		0.04, -0.5051668653325, 15,
	   -0.04, -0.5051668653325, -1
	ADDz 0.05
	PRISM_ 9, 0.05,
		-0.15, 0.3248331346675, 15,
		0.15, 0.3248331346675, 15,
		0.29, 0.1318895717211, 15,
		0.29, -0.1503827977497, 15,
		0.12, -0.5751668653325, 15,
		-0.12, -0.5751668653325, 15,
		-0.29, -0.1503827977497, 15,
		-0.29, 0.1318895717211, 15,
		-0.15, 0.3248331346675, -1
	DEL 3
ELSE
	ADDz -0.075
	PRISM_ 9, 0.15,
		-0.15, 0.3248331346675, 15,
		0.15, 0.3248331346675, 15,
		0.2615534528482, 0.1318895717211, 15,
		0.2615534528482, -0.1503827977497, 15,
		0.12, -0.5751668653325, 15,
		-0.12, -0.5751668653325, 15,
		-0.2615534528482, -0.1503827977497, 15,
		-0.2615534528482, 0.1318895717211, 15,
		-0.15, 0.3248331346675, -1
	DEL 1
ENDIF
DEL 6

				! ---------------- !
				! ----- BODY ----- !
				! ---------------- !

MATERIAL bmat

ADD 1.80, widthVehicle/2, 1.44+freeHeight
ROTx 90
PRISM_ 10, widthVehicle,
	0, 0, 15,
	3.75, 0, 15,
	3.72, 0.2, 15,
	2.324019749129, 0.2, 15,
	2.313161740418, 0.2889995099558, 79,
	2.229084583369, 0.5954743082332, 79,
	2.116523170377, 0.8388163847166, 15,
	-0.0540278506862, 0.8388163847166, 15,
	-0.01069482588543, 0.4088666042135, 15,
	0, 0, -1
DEL 2

ADD 7.985, 0, 1.54+freeHeight
ROTz craneAxisAng

ROTx 90
ADDz -0.55
PRISM_ 15, 1.10,
	3.84, 1.09, 15,
	3.84, 1.29, 15,
	3.341541350637, 1.29, 15,
	3.190938940999, 1.79, 15,
	2.118914325508, 1.79, 15,
	0.5161317168123, 1.31, 15,
	0.20, 1.31, 15,
	-0.4263729892258, 0.8398186050999, 15,
	-0.8, 0.25, 15,
	-0.8, 0, 15,
	0.20, 0, 15,
	0.20, 1.21, 15,
	2.31, 1.21, 15,
	2.31, 1.09, 15,
	3.84, 1.09, -1
DEL 2

ADD -0.80, 0, 0.80
ROTz -90
CUTPLANE 45
DEL 2
PRISM_ 9, 1.21,
	0.20, -widthVehicle/2, 15,
	2.0, -widthVehicle/2, 15,
	2.31, -0.6, 79,
	2.31, 0.6, 79,
	2.0, widthVehicle/2, 15,
	-0.80, widthVehicle/2, 15,
	-0.80, 0.55, 15,
	0.20, 0.55, 15,
	0.20, -widthVehicle/2, -1
CUTEND

ADDz 0.935
PRISM_ 7, 0.155,
	2.31, -widthVehicle/2, 15,
	3.54, -widthVehicle/2, 15,
	3.84, -0.6, 79,
	3.84, 0.6, 79,
	3.54, widthVehicle/2, 15,
	2.31, widthVehicle/2, 15,
	2.31, -widthVehicle/2, -1
DEL 1

ADD 2.70, 0, 1.54
ROTx 90
ADDz -0.30
CYLIND 0.60, 0.36
DEL 3

MATERIAL fmat
xx = 2.00-craneLength*COS(craneAng)+0.39*SIN(craneAng)
yy = 1.66+craneLength*SIN(craneAng)+0.39*COS(craneAng)
PLANE 4,
	xx, -0.025, yy,
	2.70+0.35*SIN(craneAng), -0.025, 1.54+0.35*COS(craneAng),
	2.70+0.35*SIN(craneAng), 0.025, 1.54+0.35*COS(craneAng),
	xx, 0.025, yy
DEL 2

ADD 0.10, 0, 0.6+freeHeight
PRISM_ 9, 0.05,
	0, 0.1918248659488, 15,
	-0.16, 0.07649185219641, 15,
	-0.16, -0.07546122958516, 15,
	0, -0.1918248659488, 15,
	0, -0.13, 15,
	-0.11, -0.05, 15,
	-0.11, 0.05, 15,
	0, 0.13, 15,
	0, 0.1918248659488, -1
DEL 1


				! ------------------------ !
				! ----- CAB ON CRANE ----- !
				! ------------------------ !

ADD 9.985-2.00, 0, 1.64+freeHeight
ROTz craneAxisAng
ADD 0.175, -0.50, 0

cabWidth = widthVehicle/2-0.45-0.05
IF gs_detlevel_3D_m = DLEV3D_DETAILED THEN

	GROUP "cab"
		ROTx 90
		MATERIAL inmat
		CUTPOLYA 12, 2, 0,
			0, 0.065,  15,
			-1.819412718253,        0.065, 15,
			-1.879996171788, 0.3244189537832, 79,
			-1.905003197341, 0.6123895074382, 79,
			-1.889049575437, 0.8861811934357, 79,
			-1.834773759029, 1.155013001685, 79,
			-1.755132924075, 1.385679916738, 79,
			-1.647256642899, 1.604569378001, 15,
			-0.1706174717044, 1.604569378001, 15,
			-0.08923319523001, 1.210771812152, 15,
			0, 1.210771812152, 15,
			0, 0.065, -1

		MATERIAL bmat
		PRISM_ 12, cabWidth,
			0, 0, 15,
			0, 1.210771812152, 15,
			-0.09481751839761, 1.669569378001, 15,
			-1.684500118888, 1.669569378001, 15,
			-1.703642836612, 1.636900679133, 79,
			-1.815121334395, 1.410702036982, 79,
			-1.897421544841, 1.172332667012, 79,
			-1.951883715844, 0.90679088429, 79,
			-1.970148335889, 0.6363376164297, 79,
			-1.944154029365, 0.3140033316039, 79,
			-1.86684295068, 0, 15,
			0, 0, -1
		CUTEND
		DEL 1
	ENDGROUP

	GROUP "cutbox"
		ADDz 1.00
		PRISM_ 5, 1,
			-1.619500118888, -0.075, 15,
			-0.50, -0.075, 15,
			-0.50, -cabWidth+0.075, 15,
			-1.619500118888, -cabWidth+0.075, 15,
			-1.619500118888, -0.075, -1
		DEL 1
		ROTx 90
		ADDz 0.05
		PRISM_ 5, cabWidth-0.10,
			-2, 0.6123895074382, 15,
			-1.6, 0.6123895074382, 15,
			-1.6, 1.604569378001, 15,
			-2, 1.604569378001, 15,
			-2, 0.6123895074382, -1
		DEL 2
	ENDGROUP

	PLACEGROUP SUBGROUP("cab", "cutbox")

	frW = 0.05
	MATERIAL bmat2
	ADDz 1.669569378001-frW
	PRISM_ 10, frW,
		-1.619500118888, -0.075, 15,
		-0.50, -0.075, 15,
		-0.50, -cabWidth+0.075, 15,
		-1.619500118888, -cabWidth+0.075, 15,
		-1.619500118888, -0.075, -1,
		-1.619500118888+frW, -0.075-frW, 15,
		-0.50-frw, -0.075-frW, 15,
		-0.50-frW, -cabWidth+0.075+frW, 15,
		-1.619500118888+frW, -cabWidth+0.075+frW, 15,
		-1.619500118888+frW, -0.075-frW, -1
	MATERIAL gmat
	ADDz frW/2
	POLY_ 5,
		-1.619500118888+frW, -0.075-frW, 1,
		-0.50-frw, -0.075-frW, 1,
		-0.50-frW, -cabWidth+0.075+frW, 1,
		-1.619500118888+frW, -cabWidth+0.075+frW, 1,
		-1.619500118888+frW, -0.075-frW, -1
	DEL 2


	MATERIAL bmat2
	ROTy -90
	CUTPOLYA 5, 2, 0,
		0.6123895074382+frW, -0.05-frW, 15,
		1.604569378001-frW, -0.05-frW, 15,
		1.604569378001-frW, -cabWidth+0.05+frW, 15,
		0.6123895074382+frW, -cabWidth+0.05+frW, 15,
		0.6123895074382+frW, -0.05-frW, 1-1
	DEL 1

	ROTx 90
	ADDz 0.05
	PRISM_ 12, cabWidth-0.10,
		-1.719576817679, 1.604569378001, 15,
		-1.647256642899, 1.604569378001, 15,
		-1.755132924075, 1.385679916738, 79,
		-1.834773759029, 1.155013001685, 79,
		-1.889049575437, 0.8861811934357, 79,
		-1.905003197341, 0.6123895074382, 15,
		-1.968217066039, 0.6123895074382, 15,
		-1.970148335889, 0.6363376164297, 79,
		-1.951883715844, 0.90679088429, 79,
		-1.897421544841, 1.172332667012, 79,
		-1.815121334395, 1.410702036982, 79,
		-1.719576817679, 1.604569378001, -1
	CUTEND

	MATERIAL gmat
	ADDz frW
	RULED 5, 16+32,
		-1.937504484953, 0.6363376164297, 1,
		-1.928716538583, 0.8913151188385, 1,
		-1.873325432376, 1.165671033274, 1,
		-1.792048093052, 1.401077820967, 1,
		-1.691760430517, 1.604569378001, 1,

		-1.937504484953, 0.6363376164297, cabWidth-0.10-frW*2,
		-1.928716538583, 0.8913151188385, cabWidth-0.10-frW*2,
		-1.873325432376, 1.165671033274, cabWidth-0.10-frW*2,
		-1.792048093052, 1.401077820967, cabWidth-0.10-frW*2,
		-1.691760430517, 1.604569378001, cabWidth-0.10-frW*2
	DEL 3

	ROTx 90
	ADDz cabWidth-0.05
	MATERIAL bmat2
	PRISM_ 41, 0.05,
		-1.647256642899, 1.604569378001, 15,
		-0.1706174717044, 1.604569378001, 15,
		-0.08923319523001, 1.210771812152, 15,
		0, 1.210771812152, 15,
		0, 1.185771812152, 15,
		-0.2538018877911, 1.185771812152, 15,
		-0.8854659014391, 0.6799412643678, 15,
		-0.8854659014391, 0.09, 15,
		0, 0.09, 15,
		0, 0.065, 15,
		-1.819412718253, 0.065, 15,
		-1.879996171788, 0.3244189537832, 15,
		-1.905003197341, 0.6123895074382, 15,
		-1.889049575437, 0.8861811934357, 15,
		-1.834773759029, 1.155013001685, 15,
		-1.755132924075, 1.385679916738, 15,
		-1.647256642899, 1.604569378001, -1,
		-0.1147614948434, 1.210771812152, 15,
		-0.2625781788571, 1.210771812152, 15,
		-0.8604659014391, 0.7319889977242, 15,
		-0.8604659014391, 1.579569378001, 15,
		-0.1909791398088, 1.579569378001, 15,
		-0.1147614948434, 1.210771812152, -1,
		-0.9104659014391, 0.6919494722127, 15,
		-0.9773182020927, 0.6536558311457, 79,
		-1.065425434402, 0.6373895074382, 79,
		-1.880148047969, 0.6373895074382, 15,
		-1.862630138238, 0.8952112271444, 79,
		-1.810675539966, 1.148350785555, 79,
		-1.734826732194, 1.369380967465, 79,
		-1.632708100044, 1.579569378001, 15,
		-0.9104659014391, 1.579569378001, 15,
		-0.9104659014391, 0.6919494722127, -1,
		-0.9104659014391, 0.09, 15,
		-1.800841989899, 0.09, 15,
		-1.855317085585, 0.328425447256, 79,
		-1.87999909462, 0.6123895074382, 15,
		-1.063137025535, 0.6123895074382, 79,
		-0.9685893891508, 0.6298448560955, 79,
		-0.9104659014391, 0.6631385491208, 15,
		-0.9104659014391, 0.09,     -1

	cPRISM_ bmat, inmat, bmat,
			8, 0.05,
			-0.9104659014391, 0.09, 15,
			-1.800841989899, 0.09, 15,
			-1.855317085585, 0.328425447256, 79,
			-1.87999909462, 0.6123895074382, 15,
			-1.063137025535, 0.6123895074382, 79,
			-0.9685893891508, 0.6298448560955, 79,
			-0.9104659014391, 0.6631385491208, 15,
			-0.9104659014391, 0.09,     -1

	cPRISM_ bmat, inmat, bmat,
			6, 0.05,
			-0.2538018877911, 1.185771812152, 15,
			0, 1.185771812152, 15,
			0, 0.09, 15,
			-0.8854659014391, 0.09, 15,
			-0.8854659014391, 0.6799412643678, 15,
			-0.2538018877911, 1.185771812152, -1

	MATERIAL gmat
	ADDz 0.025
	POLY_ 6,
		-0.1147614948434, 1.210771812152, 1,
		-0.2625781788571, 1.210771812152, 1,
		-0.8604659014391, 0.7319889977242, 1,
		-0.8604659014391, 1.579569378001, 1,
		-0.1909791398088, 1.579569378001, 1,
		-0.1147614948434, 1.210771812152, -1
	POLY_ 10,
		-0.9104659014391, 0.6919494722127, 1,
		-0.9773182020927, 0.6536558311457, 1,
		-1.065425434402, 0.6373895074382, 1,
		-1.880148047969, 0.6373895074382, 1,
		-1.862630138238, 0.8952112271444, 1,
		-1.810675539966, 1.148350785555, 1,
		-1.734826732194, 1.369380967465, 1,
		-1.632708100044, 1.579569378001, 1,
		-0.9104659014391, 1.579569378001, 1,
		-0.9104659014391, 0.6919494722127, -1
	DEL 3

	MATERIAL bmat2
	ROTx 90
	PRISM_ 30, 0.05,
		0, 0.065, 15,
		-1.819412718253, 0.065, 15,
		-1.879996171788, 0.3244189537832, 15,
		-1.905003197341, 0.6123895074382, 15,
		-1.889049575437, 0.8861811934357, 15,
		-1.834773759029, 1.155013001685, 15,
		-1.755132924075, 1.385679916738, 15,
		-1.647256642899, 1.604569378001, 15,
		-0.3184341557181, 1.604569378001, 15,
		-0.2349956044848, 1.200831705356, 15,
		-0.8854659014391, 0.6799412643678, 79,
		-0.9104659014391, 0.6631385491208, 79,
		-0.9685893891508, 0.6298448560955, 79,
		-1.063137025535, 0.6123895074382, 79,
		-1.87999909462, 0.6123895074382, 15,
		-1.855317085585, 0.328425447256, 79,
		-1.800841989899, 0.09, 15,
		0, 0.09, 15,
		0, 0.065, -1,
		-1.632708100044, 1.579569378001, 15,
		-0.3387958238225, 1.579569378001, 15,
		-0.2625781788571, 1.210771812152, 15,
		-0.9104659014391, 0.6919494722127, 79,
		-0.9773182020927, 0.6536558311457, 79,
		-1.065425434402, 0.6373895074382, 79,
		-1.880148047969, 0.6373895074382, 15,
		-1.862630138238, 0.8952112271444, 79,
		-1.810675539966, 1.148350785555, 79,
		-1.734826732194, 1.369380967465, 79,
		-1.632708100044, 1.579569378001, -1

	cPRISM_ inmat, bmat, bmat,
			14, 0.05,
			-1.87999909462, 0.6123895074382, 15,
			-1.855317085585, 0.328425447256, 15,
			-1.800841989899, 0.09, 15,
			0, 0.09, 15,
			0, 1.210771812152, 15,
			-0.08923319523001, 1.210771812152, 15,
			-0.1706174717044, 1.604569378001, 15,
			-0.3184341557181, 1.604569378001, 15,
			-0.2349956044848, 1.200831705356, 15,
			-0.8854659014391, 0.6799412643678, 15,
			-0.9104659014391, 0.6631385491208, 15,
			-0.9685893891508, 0.6298448560955, 15,
			-1.063137025535, 0.6123895074382, 15,
			-1.87999909462, 0.6123895074382, -1

	MATERIAL gmat
	ADDz 0.025
	POLY_ 11,
		-1.632708100044, 1.579569378001, 1,
		-0.3387958238225, 1.579569378001, 1,
		-0.2625781788571, 1.210771812152, 1,
		-0.9104659014391, 0.6919494722127, 1,
		-0.9773182020927, 0.6536558311457, 1,
		-1.065425434402, 0.6373895074382, 1,
		-1.880148047969, 0.6373895074382, 1,
		-1.862630138238, 0.8952112271444, 1,
		-1.810675539966, 1.148350785555, 1,
		-1.734826732194, 1.369380967465, 1,
		-1.632708100044, 1.579569378001, -1
	DEL 2

	ROTy -90
	cPRISM_ inmat, bmat, bmat,
			5, 0.05,
			0.065, -0.05, 15,
			1.210771812152, -0.05, 15,
			1.210771812152, -cabWidth+0.05, 15,
			0.065, -cabWidth+0.05, 15,
			0.065, -0.05, -1
	DEL 1
ELSE
	MATERIAL bmat
	ROTx 90
	PRISM_ 12, cabWidth,
		0, 0, 15,
		0, 1.210771812152, 15,
		-0.09481751839761, 1.669569378001, 15,
		-1.684500118888, 1.669569378001, 15,
		-1.703642836612, 1.636900679133, 79,
		-1.815121334395, 1.410702036982, 79,
		-1.897421544841, 1.172332667012, 79,
		-1.951883715844, 0.90679088429, 79,
		-1.970148335889, 0.6363376164297, 79,
		-1.944154029365, 0.3140033316039, 79,
		-1.86684295068, 0, 15,
		0, 0, -1
	DEL 1
ENDIF
DEL 3

				! ---------------------- !
				! ----- DRIVER CAB ----- !
				! ---------------------- !

200:
IF gs_detlevel_3D_m = DLEV3D_DETAILED THEN
	MATERIAL bmat
	ADD 0.1, 0, 0.70+freeHeight
	num = 8
	alpha_i = 90/num

	alpha = 0
	FOR i = 1 TO num+1
		PUT -rr*SIN(alpha), -widthVehicle/2+rr-rr*COS(alpha), 1*(i > 1)
		alpha = alpha+alpha_i
	NEXT i
	alpha = 0
	FOR i = 1 TO num+1
		PUT -rr*COS(alpha), widthVehicle/2-rr+rr*SIN(alpha), 1*(i < num+1)
		alpha = alpha+alpha_i
	NEXT i

	TUBE NSP/3, 4, 1+2+16+32,
		GET(NSP),

		0.05, 0, -0.10, 0,
		0.05, 0, 0, 0,
		0.05, 0, 0.5406908192282, 0,
		0.05, 0, 0.60, 0

	MATERIAL bmat2
	ADDz 1.598843134009
	CUTPLANE 0
	DEL 1

	ROTy 90
	CUTPOLYA 5, 2, 0,
		-1.548843134009, -widthVehicle/2+0.05, 15,
		-0.6406908192282, -widthVehicle/2+0.05, 15,
		-0.6406908192282, widthVehicle/2-0.05, 15,
		-1.548843134009, widthVehicle/2-0.05, 15,
		-1.548843134009, -widthVehicle/2+0.05, -1
	DEL 1

	alpha = 0
	FOR i = 1 TO num+1
		PUT -widthVehicle/2+rr-rr*COS(alpha), rr*SIN(alpha), 1*(i > 1)
		alpha = alpha+alpha_i
	NEXT i
	alpha = 0
	FOR i = 1 TO num+1
		PUT widthVehicle/2-rr+rr*SIN(alpha), rr*COS(alpha), 1*(i < num+1)
		alpha = alpha+alpha_i
	NEXT i

	TUBE NSP/3, 7, 1+2+16+32,
		GET(NSP),

		0.0643863057745, 0, 0.5406908192282*2-0.7660942606361, 0,
		0.05, 0, 0.5406908192282, 0,
		0.0643863057745, 0, 0.7660942606361, 0,
		0.1073117583992, 0, 0.9878397965762, 0,
		0.2243845621127, 0, 1.307473516552, 0,
		0.4003831482931, 0, 1.598843134009, 0,
		1.626320344408, 0, 1.598843134009, 0

	CUTEND
	CUTEND


	MATERIAL bmat
	ADDz 1.598843134009
	CUTPLANE 180
	DEL 1

	alpha = 0
	FOR i = 1 TO num+1
		PUT -widthVehicle/2+rr-rr*COS(alpha), rr*SIN(alpha), 1*(i > 1)
		alpha = alpha+alpha_i
	NEXT i
	alpha = 0
	FOR i = 1 TO num+1
		PUT widthVehicle/2-rr+rr*SIN(alpha), rr*COS(alpha), 1*(i < num+1)
		alpha = alpha+alpha_i
	NEXT i

	TUBE NSP/3, 5, 1+2+16+32,
		GET(NSP),

		0.1073117583992, 0, 0.9878397965762, 0,
		0.2243845621127, 0, 1.307473516552, 0,
		0.4003831482931, 0, 1.598843134009, 0,
		1.626320344408, 0, 1.598843134009, 0,
		1.65, 0, 1.592792482593, 0

	CUTEND


	ROTx 90
	ADDz -widthVehicle/2+0.05
	MATERIAL bmat
	RULED 3, 16+32,
		1.68265651104, 0.74, 1,
		1.672063292537, 1.144982121574, 1,
		1.626320344408, 1.598843134009, 1,

		1.68265651104, 0.74, widthVehicle-0.10,
		1.672063292537, 1.144982121574, widthVehicle-0.10,
		1.626320344408, 1.598843134009, widthVehicle-0.10

	MATERIAL inmat
	RULED 2, 16+32,
		1.58265651104, 0.74, 1,
		1.58265651104, 1.598843134009, 1,

		1.58265651104, 0.74, widthVehicle-0.10,
		1.58265651104, 1.598843134009, widthVehicle-0.10

	MATERIAL gmat
	RULED 5, 16+32,
		0.02499433197086, 0.5406908192282, 1,
		0.03958353697627, 0.7692732688974, 1,
		0.08311439459241, 0.9941462233287, 1,
		0.2018383506035, 1.318287941186, 1,
		0.380319156913, 1.613766929889, 1,

		0.02499433197086, 0.5406908192282, widthVehicle-0.10,
		0.03958353697627, 0.7692732688974, widthVehicle-0.10,
		0.08311439459241, 0.9941462233287, widthVehicle-0.10,
		0.2018383506035, 1.318287941186, widthVehicle-0.10,
		0.380319156913, 1.613766929889, widthVehicle-0.10
	DEL 2

	FOR i = 1 TO 2
		MULy 1-2*(i-1)
		ADDy -widthVehicle/2+0.05
		ROTx 90
		cPRISM_ bmat, inmat, bmat,
				20, 0.05,
				0.4038644429171, 1.549822130202, 15,
				1.427912392442, 1.549822130202, 15,
				1.427912392442, 0.3079023811122, 15,
				1.246387854324, 0, 15,
				0.1600813754144, 0, 15,
				0.1600813754144, 0.9843631435456, 15,
				0.2720026028272, 1.295074499995, 15,
				0.4038644429171, 1.549822130202, -1,
				0.9668307501748, 0.7521504469802, 15,
				0.2975813754144, 0.7521504469802, 79,
				0.2669667008251, 0.7582400843793, 79,
				0.2410128329194, 0.7755819044852, 79,
				0.2236710128135, 0.801535772391, 79,
				0.2175813754144, 0.8321504469802, 79,
				0.2175813754144, 1.00763339436, 79,
				0.3061656026125, 1.281933549142, 79,
				0.4204198577236, 1.505668711154, 15,
				1.212005312791, 1.505668711154, 15,
				1.212005312791, 0.9452106098135, 15,
				0.9668307501748, 0.7521504469802, -1

		cPRISM_ bmat, inmat, bmat,
				16, 0.05,
				1.440412392442, 0.3291049127577, 15,
				1.68265651104, 0.74, 15,
				1.672063292537, 1.144982121574, 15,
				1.626320344408, 1.598843134009, 15,
				0.4003831482931, 1.598843134009, 15,
				0.2243845621127, 1.307473516552, 15,
				0.1073117583992, 0.9878397965762, 15,
				0.0643863057745, 0.7660942606361, 15,
				0.05, 0.5406908192282, 15,
				0.05, 0, 15,
				0.1475813754144, 0, 15,
				0.1475813754144, 0.986545811697, 15,
				0.2605220796627, 1.300087400068, 15,
				0.3962593739526, 1.562322130202, 15,
				1.440412392442, 1.562322130202, 15,
				1.440412392442, 0.3291049127577, -1

		MATERIAL bmat2
		PRISM_ 13, 0.05,
			0.1475813754144, 0, 15,
			0.1600813754144, 0, 15,
			0.1600813754144, 0.9843631435456, 15,
			0.2720026028272, 1.295074499995, 15,
			0.4038644429171, 1.549822130202, 15,
			1.427912392442, 1.549822130202, 15,
			1.427912392442, 0.3079023811122, 15,
			1.440412392442, 0.3291049127577, 15,
			1.440412392442, 1.562322130202, 15,
			0.3962593739526, 1.562322130202, 15,
			0.2605220796627, 1.300087400068, 15,
			0.1475813754144, 0.986545811697, 15,
			0.1475813754144, 0,      1

		PRISM_ 24, 0.05,
			0.4204198577236, 1.505668711154, 15,
			1.212005312791, 1.505668711154, 15,
			1.212005312791, 0.9452106098135, 15,
			0.9668307501748, 0.7521504469802, 15,
			0.2975813754144, 0.7521504469802, 15,
			0.2669667008251, 0.7582400843793, 15,
			0.2410128329194, 0.7755819044852, 15,
			0.2236710128135, 0.801535772391, 15,
			0.2175813754144, 0.8321504469802, 15,
			0.2175813754144, 1.00763339436, 15,
			0.3061656026125, 1.281933549142, 15,
			0.4204198577236, 1.505668711154, -1,
			0.4357243009569, 1.480668711154, 15,
			1.187005312791, 1.480668711154, 15,
			1.187005312791, 0.9573450251232, 15,
			0.9581692534318, 0.7771504469802, 15,
			0.2975813754144, 0.7771504469802, 15,
			0.2765337866343, 0.7813370726921, 15,
			0.2586905024491, 0.7932595740149, 15,
			0.2467680011262, 0.8111028582001, 15,
			0.2425813754144, 0.8321504469802, 15,
			0.2425813754144, 1.003696664698, 15,
			0.3293407068037, 1.272346048246, 15,
			0.4357243009569, 1.480668711154,  -1

		MATERIAL gmat
		ADDz 0.025
		POLY_ 12,
			0.4357243009569, 1.480668711154, 1,
			1.187005312791, 1.480668711154, 1,
			1.187005312791, 0.9573450251232, 1,
			0.9581692534318, 0.7771504469802, 1,
			0.2975813754144, 0.7771504469802, 1,
			0.2765337866343, 0.7813370726921, 1,
			0.2586905024491, 0.7932595740149, 1,
			0.2467680011262, 0.8111028582001, 1,
			0.2425813754144, 0.8321504469802, 1,
			0.2425813754144, 1.003696664698, 1,
			0.3293407068037, 1.272346048246, 1,
			0.4357243009569, 1.480668711154, -1
	DEL 4
	NEXT i
	DEL 1
ELSE
	MATERIAL bmat
	ADD 0.1, 0, 0.70+freeHeight
	ROTx 90
	ADDz -widthVehicle/2
	MATERIAL bmat
	PRISM_ 11, widthVehicle,
		0, 0, 15,
		1.246387854324, 0, 15,
		1.68265651104, 0.74,      15,
		1.672063292537, 1.144982121574, 15,
		1.621281032055, 1.648843134009, 15,
		0.3754768772768, 1.648843134009, 15,
		0.2145374467828, 1.39869710294, 79,
		0.09641904404767, 1.125708861284, 79,
		0.02426626775398, 0.837146018873, 79,
		0, 0.5406908192282, 79,
		0, 0, -1

	DEL 3
ENDIF
END


101:
	ROTz angWheel
	ADD -widthWheel, 0, radWheel
	IF gs_detlevel_3D_m = DLEV3D_DETAILED THEN
		MATERIAL rmat
		REVOLVE 8, 360, 16+32,
			0.035, radRim, 0,
			0, radRim+0.05, 1,
			0, radWheel-0.075, 0,
			0.05, radWheel, 0,
			widthWheel-0.05, radWheel, 0,
			widthWheel, radWheel-0.075, 0,
			widthWheel, radRim+0.05, 1,
			widthWheel-0.035, radRim, 0

		MATERIAL rmmat
		REVOLVE 6, 360, 1+2+16+32,
			0, 0.15, 2,
			0.115, radRim-0.12, 2,
			0.115, radRim-0.06, 2,
			0.035, radRim-0.05, 2,
			0.035, radRim, 2,
			widthWheel-0.035, radRim, 2
	ELSE
		MATERIAL rmat
		REVOLVE 4, 360, 16+32,
			0, radRim, 0,
			0, radWheel, 0,
			widthWheel, radWheel, 0,
			widthWheel, radRim, 0

		MATERIAL rmmat
		REVOLVE 2, 360, 1+2+16+32,
			0, radRim, 2,
			widthWheel, radRim, 2
	ENDIF
	DEL 2
RETURN
