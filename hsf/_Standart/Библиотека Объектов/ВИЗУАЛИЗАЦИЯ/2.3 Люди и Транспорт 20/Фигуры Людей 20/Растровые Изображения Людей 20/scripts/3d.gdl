
DEFINE MATERIAL "pictmat" 0,
		1,1,1,
		0.5, 0.8, 0, 0,
		0,
		0,
		0,0,0,
		0,0,0,
		0

MATERIAL "pictmat"

SHADOW ON

if gs_detlevel_3D_m = DETLEVEL3D_OFF then end

IF gs_shadow=0 THEN SHADOW OFF

pen gs_cont_pen

dx= GLOB_EYEPOS_X - GLOB_TARGPOS_X
dy= GLOB_EYEPOS_Y - GLOB_TARGPOS_Y

rotx 90

if SYMB_MIRRORED then
	roty SYMB_ROTANGLE
else
	roty -SYMB_ROTANGLE
endif

if abs(GLOB_EYEPOS_X-GLOB_TARGPOS_X)<EPS then
	if GLOB_EYEPOS_Y>GLOB_TARGPOS_Y then roty 180
else
	alf=atn(abs(dy/dx))

	if SYMB_MIRRORED then
		if dx<0 and dy>0 then roty -(180-alf)
		if dx<0 and dy<0 then roty -(180+alf)
		if dx>0 and dy<0 then roty -(-alf)
		if dx>0 and dy>0 then roty -(alf)
	else
		if dx<0 and dy>0 then roty (180-alf)
		if dx<0 and dy<0 then roty (180+alf)
		if dx>0 and dy<0 then roty (-alf)
		if dx>0 and dy>0 then roty (alf)
	endif
	roty 90
endif

unID = 1
if iPictureName = CUSTOM_PIC and gs_picture_name <> "" then
	hotspot 0, 0, 0, unID :unID=unID+1

	hotspot 0, 0, 0, unID,		Aper2, 1+128, a :unID=unID+1
	hotspot Aper2, 0, 0, unID,	Aper2, 2, a :unID=unID+1
	hotspot -1, 0, 0, unID,		Aper2, 3+128, a :unID=unID+1

	hotspot 0, 0, 0, unID,		Aper2, 1+128, a :unID=unID+1
	hotspot -Aper2, 0, 0, unID,	Aper2, 2, a :unID=unID+1
	hotspot 1, 0, 0, unID,		Aper2, 3+128, a :unID=unID+1

	hotspot 0, ZZYZX, 0, unID,		Aper2, 1+128, a :unID=unID+1
	hotspot Aper2, ZZYZX, 0, unID,	Aper2, 2, a :unID=unID+1
	hotspot -1, ZZYZX, 0, unID,		Aper2, 3+128, a :unID=unID+1

	hotspot 0, ZZYZX, 0, unID,		Aper2, 1+128, a :unID=unID+1
	hotspot -Aper2, ZZYZX, 0, unID,	Aper2, 2, a :unID=unID+1
	hotspot 1, ZZYZX, 0, unID,		Aper2, 3+128, a :unID=unID+1
else
	hotspot 0, 0, 0, unID :unID=unID+1
	hotspot -ZZYZX/2*pictWidth/pictHeight, 0, 0, unID :unID=unID+1
	hotspot ZZYZX/2*pictWidth/pictHeight, 0, 0, unID :unID=unID+1
	hotspot -ZZYZX/2*pictWidth/pictHeight, zzyzx, 0, unID :unID=unID+1
	hotspot ZZYZX/2*pictWidth/pictHeight, zzyzx, 0, unID :unID=unID+1
endif

addx -ZZYZX/2*pictWidth/pictHeight
picture pictNum, ZZYZX*pictWidth/pictHeight, ZZYZX, 1
del top

end
