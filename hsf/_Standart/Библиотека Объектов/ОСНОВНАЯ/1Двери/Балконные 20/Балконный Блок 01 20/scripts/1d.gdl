
! const values for parameter: iDWDet2D
DETLEVEL_DW2D_MVO     = 1
DETLEVEL_DW2D_SCSENS  = 2
DETLEVEL_DW2D_50      = 3
DETLEVEL_DW2D_100     = 4
DETLEVEL_DW2D_200     = 7
DETLEVEL_DW2D_OFF     = 8
DETLEVEL_DW2D_CHISMPL = 10
DETLEVEL_DW2D_CHIDET  = 11


! const values for parameter: iTypeDemolitionFill
RENOVATION_FILL_EXIST		= 1
RENOVATION_FILL_DEMOLISHED	= 2
RENOVATION_FILL_NEW			= 3
RENOVATION_FILL_NEW_FULL	= 4


! const values for parameter: iDWDet3D
DETLEVEL_DW3D_SCALESENS    = 1
DETLEVEL_DW3D_DETAILED     = 2
DETLEVEL_DW3D_SIMPLE       = 3
DETLEVEL_DW3D_OFF          = 4
DETLEVEL_DW3D_CHI_SIMPLE   = 5
DETLEVEL_DW3D_CHI_DETAILED = 6


! const values for parameter: iTransomOpeningType
SASH_FIXED       = 1
SASH_SIDE_HUNG   = 3
SASH_SIDE_HUNG_M = 4
SASH_TILT_TURN   = 5
SASH_TILT_TURN_M = 6
SASH_BOTTOM_HUNG = 7
SASH_TOP_HUNG    = 8
SASH_VER_PIVOT   = 10


! const values for parameter: iDWDetSE
DETLEV_SE_SCALESENSITIVE	= 1
DETLEV_SE_DETAILED			= 2
DETLEV_SE_MIDDLE			= 3
DETLEV_SE_SIMPLE			= 4
DETLEV_SE_OFF				= 0

DETLEV_SE_OFF_MIG			= 4


! const values for parameter: iDoorOpeningType
SASH_FIXED       = 1
SASH_SIDE_HUNG   = 3
SASH_SIDE_HUNG_M = 4
SASH_TILT_TURN   = 5
SASH_TILT_TURN_M = 6
SASH_BOTTOM_HUNG = 7
SASH_TOP_HUNG    = 8
SASH_VER_PIVOT   = 10


! const values for parameter: iDoorTransomOpeningType
SASH_FIXED       = 1
SASH_SIDE_HUNG   = 3
SASH_SIDE_HUNG_M = 4
SASH_TILT_TURN   = 5
SASH_TILT_TURN_M = 6
SASH_BOTTOM_HUNG = 7
SASH_TOP_HUNG    = 8
SASH_VER_PIVOT   = 10


! const values for parameter: iWindowOpeningType
SASH_FIXED       = 1
SASH_SIDE_HUNG   = 3
SASH_SIDE_HUNG_M = 4
SASH_TILT_TURN   = 5
SASH_TILT_TURN_M = 6
SASH_BOTTOM_HUNG = 7
SASH_TOP_HUNG    = 8
SASH_VER_PIVOT   = 10




dim st_optype[]
	st_optype[1] = `Фиксированное Остекление`
	st_optype[2] = `Распашная`
	st_optype[3] = `Распашная Зеркальная`
	st_optype[4] = `Нижнеподвесная`
	st_optype[5] = `Верхнеподвесная`
	st_optype[6] = `Наклонно-Поворотная `
	st_optype[7] = `Наклонно-Поворотная Зеркальная`
	st_optype[8] = `Среднеповоротная Вертикальная`

! gs_optype_m
SASH_FIXED					= 1		! Fixed Glass
SASH_FIXED_SCREW			= 2		! Fixed Sash
SASH_SIDE_HUNG				= 3		! Side Hung
SASH_SIDE_HUNG_M			= 4		! Side Hung Mirrored
SASH_TILT_TURN				= 5		! Tilt and Turn
SASH_TILT_TURN_M			= 6		! Tilt and Turn Mirrored
SASH_BOTTOM_HUNG			= 7		! Bottom Hung
SASH_TOP_HUNG				= 8		! Top Hung
SASH_HOR_PIVOT				= 9		! Horizontal Pivot Hung
SASH_VER_PIVOT				= 10	! Vertical Pivotted
SASH_TILT_SLIDE				= 11	! Tilt and Slide
SASH_LEFT_SLIDING			= 12	! Left Sliding
SASH_RIGHT_SLIDING			= 13	! Right Sliding
SASH_UP_SLIDING				= 14	! Sliding Up
SASH_DOWN_SLIDING			= 15	! Sliding Down
SASH_VER_PIVOT_M			= 16	! Vertical Pivotted Mirrored
SASH_FIXED_SLIDE			= 17	! Fixed Sliding Sash
SASH_DOUBLE_SIDE_HUNG		= 18	! Double Sash
SASH_DOUBLE_TILT_TURN		= 19	! Double Tilt and Turn
SASH_DOUBLE_TILT_TURN_M		= 20	! Double Tilt and Turn Mirrored
SASH_SLIDING_HOR			= 21	! Sliding
SASH_SLIDING_HOR_M			= 22	! Sliding Mirrored
SASH_DOUBLE_SLIDING_HOR		= 23	! Double Sliding
SASH_DOUBLE_SLIDING_HOR_M	= 24	! Double Sliding Mirrored
SASH_SLIDING_VER			= 25	! Single Hung
SASH_DOUBLE_SLIDING_VER		= 26	! Double Hung

dim stSillTypes[2]
	stSillTypes[1] = `Сплошной`
	stSillTypes[2] = `Металл`

SILL_SOLID = 1
SILL_METAL = 2

dim stShutterStyles[5]
	stShutterStyles[1] = `Жалюзи`
	stShutterStyles[2] = `Закр. жалюзи`
	stShutterStyles[3] = `Сплошное в Раме`
	stShutterStyles[4] = `Отверстия`
	stShutterStyles[5] = `Сплошной`

SHUTTER_LOUVER	= 1
SHUTTER_FIX		= 2
SHUTTER_FRAMED	= 3
SHUTTER_HOLES	= 4
SHUTTER_SOLID	= 5


! Wall Contour Line
WALL_CONTOUR_OFF		= 1
WALL_CONTOUR_INSIDE		= 2
WALL_CONTOUR_OUTSIDE	= 3
WALL_CONTOUR_BOTHSIDES	= 4

dim stWallContourLine[4]	! gs_wcont_line_w
	stWallContourLine[1] = `Откл.`
	stWallContourLine[2] = `Внутри`
	stWallContourLine[3] = `Снаружи`
	stWallContourLine[4] = `Обе стороны`

if GLOB_SCRIPT_TYPE = 7 | GLOB_SCRIPT_TYPE = 8 then goto "MasterEnd"	! forward migration, backward migration

EPS=0.00001

! lod2d
DET2D_FS_OFF				= 0
DET2D_FS_SCALESENS			= -1
DET2D_FS_SIMPLE_ONE			= 11
DET2D_FS_SIMPLE_TWO			= 12
DET2D_FS_MIDDLE				= 21
DET2D_FS_MIDDLE_USA			= 22
DET2D_FS_DETAILED			= 30
DET2D_FS_DETAILED_FIX_GRID	= 31
DET2D_FS_DETAILED_USA		= 32
DET2D_FS_SIMPLE_CHI			= 51
DET2D_FS_DETAILED_CHI		= 52

! iLoD2D
SYMBW_OFF					= 0
SYMBW_SCALESENS				= 1
SYMBW_S_1LINE				= 11
SYMBW_S_2LINE				= 12
SYMBW_S_CENTERLINE			= 13
SYMBW_S_2LINE_ACC			= 14
SYMBW_S_5					= 15
SYMBW_S_6					= 16
SYMBW_S_7					= 17
SYMBW_S_8					= 18
SYMBW_S_9					= 19
SYMBW_M_2LINE_NOGLASS		= 21
SYMBW_M_2LINE_GLASS			= 22
SYMBW_M_FRAMESASH			= 23
SYMBW_M_2LINE_FRAME			= 24
SYMBW_M_5					= 25
SYMBW_M_6					= 26
SYMBW_M_7					= 27
SYMBW_M_8					= 28
SYMBW_M_9					= 29
SYMBW_D_SGLASS				= 31
SYMBW_D_2GLASS				= 32
SYMBW_D_2LINE_HS			= 33
SYMBW_D_NOGLASS				= 34
SYMBW_D_REBATEONGLASS		= 35
SYMBW_D_2GLASS_OVERLAP		= 36
SYMBW_D_7					= 37
SYMBW_D_8					= 38
SYMBW_D_9					= 39

!***************** for tolerance ************

if gs_stockb=0 then      ! equal profiles

	gs_frame_width = gs_frame_width + gs_tolerance

else

	gs_stb_r = gs_stb_r + gs_tolerance
	gs_stb_l = gs_stb_l + gs_tolerance
	gs_stb_ob = gs_stb_ob + gs_tolerance
	gs_stb_u = gs_stb_u + gs_tolerance

endif

!***************** tolerance END ************



!************* Cavity Closure String Values

dim gs_stCavityClosure[]
	gs_stCavityClosure[ 8] = ""
	gs_stCavityClosure[ 1] = `Нет`
	gs_stCavityClosure[ 2] = `Традиционное`
	gs_stCavityClosure[ 3] = `Заводское`
	gs_stCavityClosure[ 4] = `Снаружи`
	gs_stCavityClosure[ 5] = `Внутри`
	gs_stCavityClosure[ 6] = `Обе`
	gs_stCavityClosure[ 7] = `Слева`
	gs_stCavityClosure[ 8] = `Справа`


!**************** Parapet Height Definition *************

!** Til OK Fensterbank
gs_parh = 0
parh = 0

!**************** Parapet Height Definition END *********


!*** NO Middle Column
setz = 0


!********** Grid number modification

gs_sh = gs_sh - 1
sh2 = sh2 - 1
gs_sv = gs_sv - 1
sv2 = sv2 - 1
gs_sho = gs_sho - 1
gs_svo = gs_svo - 1
svo2 = svo2 - 1


!************************* Localization *****************************
!********************************************************************

dim stDetail[6]
	stDetail[1] = `Зависит от Масштаба`
	stDetail[2] = `Детальный`
	stDetail[3] = `Простой`
	stDetail[4] = `Откл.`
	stDetail[5] = `Китайский Простой`
	stDetail[6] = `Китайский Детальный`


dim gs_stWindowSillTrim[]
	gs_stWindowSillTrim[15] = ""
	gs_stWindowSillTrim[ 1] = `Откл.`
	gs_stWindowSillTrim[ 2] = `Внутри`
	gs_stWindowSillTrim[ 3] = `Снаружи`
	gs_stWindowSillTrim[ 4] = `Обе стороны`
	gs_stWindowSillTrim[ 5] = `Откл.`
	gs_stWindowSillTrim[ 6] = `Внутри`
	gs_stWindowSillTrim[ 7] = `Снаружи`
	gs_stWindowSillTrim[ 8] = `Обе стороны`
	gs_stWindowSillTrim[ 9] = ""
	gs_stWindowSillTrim[10] = ""
	gs_stWindowSillTrim[11] = ""
	gs_stWindowSillTrim[12] = `Откл.`
	gs_stWindowSillTrim[13] = `Внутри`
	gs_stWindowSillTrim[14] = `Снаружи`
	gs_stWindowSillTrim[15] = `Обе стороны`


if iWindowOpeningType = SASH_FIXED then mainfix = 1 else mainfix = 0
if iTransomOpeningType = SASH_FIXED then top1fix = 1 else top1fix = 0
if iDoorTransomOpeningType = SASH_FIXED then top2fix = 1 else top2fix = 0

if iShutterStyle = SHUTTER_FIX		then loc_type = 1
if iShutterStyle = SHUTTER_LOUVER	then loc_type = 2
if iShutterStyle = SHUTTER_FRAMED	then loc_type = 3
if iShutterStyle = SHUTTER_HOLES	then loc_type = 4
if iShutterStyle = SHUTTER_SOLID	then loc_type = 5

if iWindowOpeningType = SASH_FIXED then loc_op = 1
if iWindowOpeningType = SASH_SIDE_HUNG then loc_op = 2
if iWindowOpeningType = SASH_SIDE_HUNG_M then loc_op = 3
if iWindowOpeningType = SASH_TILT_TURN then loc_op = 4
if iWindowOpeningType = SASH_TILT_TURN_M then loc_op = 5
if iWindowOpeningType = SASH_BOTTOM_HUNG then loc_op = 6
if iWindowOpeningType = SASH_TOP_HUNG then loc_op = 7

if iDoorOpeningType = SASH_SIDE_HUNG then loc_op2 = 2
if iDoorOpeningType = SASH_SIDE_HUNG_M then loc_op2 = 3
if iDoorOpeningType = SASH_TILT_TURN then loc_op2 = 4
if iDoorOpeningType = SASH_TILT_TURN_M then loc_op2 = 5

if iTransomOpeningType = SASH_FIXED then loc_op_o1 = 1
if iTransomOpeningType = SASH_SIDE_HUNG then loc_op_o1 = 2
if iTransomOpeningType = SASH_SIDE_HUNG_M then loc_op_o1 = 3
if iTransomOpeningType = SASH_TILT_TURN then loc_op_o1 = 4
if iTransomOpeningType = SASH_TILT_TURN_M then loc_op_o1 = 5
if iTransomOpeningType = SASH_BOTTOM_HUNG then loc_op_o1 = 6
if iTransomOpeningType = SASH_TOP_HUNG then loc_op_o1 = 7

if iDoorTransomOpeningType = SASH_FIXED then loc_op_o2 = 1
if iDoorTransomOpeningType = SASH_SIDE_HUNG then loc_op_o2 = 2
if iDoorTransomOpeningType = SASH_SIDE_HUNG_M then loc_op_o2 = 3
if iDoorTransomOpeningType = SASH_TILT_TURN then loc_op_o2 = 4
if iDoorTransomOpeningType = SASH_TILT_TURN_M then loc_op_o2 = 5
if iDoorTransomOpeningType = SASH_BOTTOM_HUNG then loc_op_o2 = 6
if iDoorTransomOpeningType = SASH_TOP_HUNG then loc_op_o2 = 7

! --- parameters from subtype template ---

! Sprossen
sh = gs_sh
sv = gs_sv
sho = gs_sho
svo = gs_svo
spb = gs_spb
sps = gs_sps

! Stock / Rahmen
stb_r = gs_stb_r
stb_m = gs_stb_m
stb_l = gs_stb_l
stb_ob = gs_stb_ob
stb_u = gs_stb_u
matframe = gs_frame_mat
ver_r = gs_ver_r
rab = gs_sash_width
rab_ob = gs_rab_ob
rab_u = gs_rab_u
vb = gs_vb
vt = gs_vt
ras = gs_sash_thk
matsash = gs_sash_mat


! Fensterbank
suba_l = gs_suba_l
suba_r = gs_suba_r
fbh = gs_fbh
nd = gs_nd

! Simsbrett
feba_i = gs_fi
dars_2D = gs_dars_2D
subi_l = gs_subi_l
subi_r = gs_subi_r

! Hohlsturz
hhs = gs_hhs
dsturz = gs_dsturz

! --- parameters end ---

!*** GER "Sturz" + thickness

gs_sturz=0
gs_dsturz=WIDO_SILL
dsturz=WIDO_SILL


!*********** Frame Width / Library


if gs_stockb=0 then      ! equal profiles
	stb_ob=gs_frame_width
	stb_w=gs_frame_width
	stb_r=gs_frame_width
	stb_l=gs_frame_width
	stb_m=gs_frame_width - gs_tolerance
	vb_ob=vb
	vb_l=vb
	vb_r=vb
	vb_u=vb
endif

if ver_r=0 then
	rab_u=rab
	rab_ob=rab
endif

if parapeth<0.0001 then parapeth=0.0001


!*** main field fix

if loc_op=1 then bMainFieldFix=1 else bMainFieldFix=0

bMainWindowFixIn2D = 0
if loc_op = 1 | loc_op = 6 | loc_op = 7 then bMainWindowFixIn2D	= 1

bMainDoorFixIn2D = 0
if loc_op2 = 1 | loc_op2 = 6 | loc_op2 = 7 then	bMainDoorFixIn2D = 1

!*** transom fix

if loc_op_o1=1 then bTop1FieldFix=1 else bTop1FieldFix=0
if loc_op_o2=1 then bTop2FieldFix=1 else bTop2FieldFix=0



!********** profiles if reduced

br_a=gs_frame_width
br_a1=stb_l
br_a2=stb_r
br_m=stb_m
br_c=stb_ob
br_d=stb_u


!*********** Fensterbank

feba  = (gs_feba_a or feba_i)
feba2 = (feba_a2 or feba_i2)

if iSillType = SILL_METAL then
	 suba_r=0
	 suba_l=0
	 nd=0
endif


!** background fill pen of Fensterbank in section

pen_bkgd=19



!******************** Sonnenschutz / Sturz ***************

if gs_hsturz=0 then hhs=0

hsa=hhs+WIDO_HEAD_DEPTH   !** Sturzblende height

if sonn+sonn2>0 then
	gs_sturz=1
endif

"MasterEnd":

