
! Contact person: <BD, BO, NJ>

EPS = 0.0001


! =============================================================================
! Migration
! =============================================================================

if GLOB_SCRIPT_TYPE = 7 | GLOB_SCRIPT_TYPE = 8 then goto "MasterEnd"	! forward migration, backward migration


! gs_optype_m
SASH_FIXED					= 1		! Fixed Glass
SASH_FIXED_SCREW			= 2		! Fixed Sash
SASH_SIDE_HUNG				= 3		! Side Hung
SASH_SIDE_HUNG_M			= 4		! Side Hung Mirrored
SASH_TILT_TURN				= 5		! Tilt and Turn
SASH_TILT_TURN_M			= 6		! Tilt and Turn Mirrored
SASH_BOTTOM_HUNG			= 7		! Bottom Hung
SASH_TOP_HUNG				= 8		! Top Hung
SASH_HOR_PIVOT				= 9		! Horizontal Pivot Hung
SASH_VER_PIVOT				= 10	! Vertical Pivotted
SASH_TILT_SLIDE				= 11	! Tilt and Slide
SASH_LEFT_SLIDING			= 12	! Left Sliding
SASH_RIGHT_SLIDING			= 13	! Right Sliding
SASH_UP_SLIDING				= 14	! Sliding Up
SASH_DOWN_SLIDING			= 15	! Sliding Down
SASH_VER_PIVOT_M			= 16	! Vertical Pivotted Mirrored
SASH_FIXED_SLIDE			= 17	! Fixed Sliding Sash
SASH_DOUBLE_SIDE_HUNG		= 18	! Double Sash
SASH_DOUBLE_TILT_TURN		= 19	! Double Tilt and Turn
SASH_DOUBLE_TILT_TURN_M		= 20	! Double Tilt and Turn Mirrored
SASH_SLIDING_HOR			= 21	! Sliding
SASH_SLIDING_HOR_M			= 22	! Sliding Mirrored
SASH_DOUBLE_SLIDING_HOR		= 23	! Double Sliding
SASH_DOUBLE_SLIDING_HOR_M	= 24	! Double Sliding Mirrored
SASH_SLIDING_VER			= 25	! Single Hung
SASH_DOUBLE_SLIDING_VER		= 26	! Double Hung

! gs_iPanesConfig
PANESCONFIG_UNIFORM		= 1
PANESCONFIG_SYMM		= 2
PANESCONFIG_ASYMM		= 3
PANESCONFIG_UNIF_DOUBSASHES		= 4

! iMullionStyle
MULLION_NONE			= 1
MULLION_HVGRID			= 2
MULLION_EDITABLEGRID	= 3
MULLION_CUSTOM			= 4
MULLION_PRAIRIE			= 5
MULLION_DIVIDED			= 6
MULLION_SOLID_PANEL		= 15

! iMullionStyle
MULLION_NONE			= 1
MULLION_HVGRID			= 2
MULLION_EDITABLEGRID	= 3
MULLION_CUSTOM			= 4
MULLION_PRAIRIE			= 5
MULLION_DIVIDED			= 6
!MULLION_SUNBURST_1		= 7
!MULLION_SUNBURST_2		= 8
!MULLION_SUNBURST_3		= 9
!MULLION_SUNBURST_4		= 10
!MULLION_SUNBURST_5		= 11
!MULLION_SUNBURST_6		= 12
!MULLION_SOLID_GLAZED	= 13
!MULLION_DIVIDED_FRAME	= 14
MULLION_SOLID_PANEL		= 15
MULLION_VENT_PANEL		= 16

! iMullionPosition
MULLION_OUTSIDE		= 1
MULLION_INSIDE		= 2
MULLION_THROUGHOUT	= 3

! iVentilationProfileType
VENTPROFILE_OVER_FRAME		= 2
VENTPROFILE_OVER_GLAZING	= 3

! iLoD2D
SYMBW_OFF					= 0
SYMBW_SCALESENS				= 1
SYMBW_S_1LINE				= 11
SYMBW_S_2LINE				= 12
SYMBW_S_CENTERLINE			= 13
SYMBW_S_2LINE_ACC			= 14
SYMBW_S_5					= 15
SYMBW_S_6					= 16
SYMBW_S_7					= 17
SYMBW_S_8					= 18
SYMBW_S_9					= 19
SYMBW_M_2LINE_NOGLASS		= 21
SYMBW_M_2LINE_GLASS			= 22
SYMBW_M_FRAMESASH			= 23
SYMBW_M_2LINE_FRAME			= 24
SYMBW_M_5					= 25
SYMBW_M_6					= 26
SYMBW_M_7					= 27
SYMBW_M_8					= 28
SYMBW_M_9					= 29
SYMBW_D_SGLASS				= 31
SYMBW_D_2GLASS				= 32
SYMBW_D_2LINE_HS			= 33
SYMBW_D_NOGLASS				= 34
SYMBW_D_REBATEONGLASS		= 35
SYMBW_D_2GLASS_OVERLAP		= 36
SYMBW_D_7					= 37
SYMBW_D_8					= 38
SYMBW_D_9					= 39

SYMBGLASS_NOGLASS			= 0
SYMBGLASS_SIMPLEGLASS		= 1
SYMBGLASS_DOUBLEGLASS		= 2

! iDWDet3D
DETLEVEL_DW3D_SCALESENS    = 1
DETLEVEL_DW3D_DETAILED     = 2
DETLEVEL_DW3D_SIMPLE       = 3
DETLEVEL_DW3D_OFF          = 4
DETLEVEL_DW3D_CHI_SIMPLE   = 5
DETLEVEL_DW3D_CHI_DETAILED = 6


! iTypeDemolitionFill
RENOVATION_FILL_EXIST		= 1
RENOVATION_FILL_DEMOLISHED	= 2
RENOVATION_FILL_NEW			= 3
RENOVATION_FILL_NEW_FULL	= 4

! gs_SashText_typ_num
MITERED_JOINT = 1
BUTT_JOINT    = 2


! =============================================================================
! Uniform Frame Width
! =============================================================================

if gs_uniform_framewidth then
	gs_frame_width_lower	= gs_frame_width
	gs_frame2_width_lower	= gs_frame2_width
endif


! =============================================================================
! Uniform Sashes
! =============================================================================

iMullionStyleOriginal_01 = iMullionStyle_01
iMullionStyleOriginal_02 = iMullionStyle_02
iMullionStyleOriginal_05 = iMullionStyle_05
iMullionStyleOriginal_06 = iMullionStyle_06
iMullionStyleOriginal_09 = iMullionStyle_09
iMullionStyleOriginal_10 = iMullionStyle_10

if gs_sash_uniform then
	iMullionStyle_01 = iMullionStyle_00
	iMullionStyle_02 = iMullionStyle_00
	iMullionStyle_05 = iMullionStyle_00
	iMullionStyle_06 = iMullionStyle_00
	iMullionStyle_09 = iMullionStyle_00
	iMullionStyle_10 = iMullionStyle_00

	gs_cust_panel_01 = gs_cust_panel_00
	gs_cust_panel_02 = gs_cust_panel_00
	gs_cust_panel_05 = gs_cust_panel_00
	gs_cust_panel_06 = gs_cust_panel_00
	gs_cust_panel_09 = gs_cust_panel_00
	gs_cust_panel_10 = gs_cust_panel_00

	vgn_05 = vgn_01
	hgn_05 = hgn_01
	vgn_09 = vgn_01
	hgn_09 = hgn_01
	vgn_06 = vgn_02
	hgn_06 = hgn_02
	vgn_10 = vgn_02
	hgn_10 = hgn_02
endif


! =============================================================================
! Main Definitions
! =============================================================================

gs_IsCurved				= 0
bDisabeMirroring		= 0
bParalellInCurvedWalls	= 0
iWindowShape			= 0		! SHAPE_RECTANGULAR

bCornerWindow = (ac_cw_function & ac_corner_window)

! =============================================================================
! Corner Window Functions Enable
! =============================================================================
bEnableCustomCornerLeft = 1
bEnableCustomCornerRight = 1

! =============================================================================
! Casement IDs
! =============================================================================

dim CasementIDArray[3][3]
CasementIDArray[1][1]	= 10
CasementIDArray[1][2]	= 2
CasementIDArray[1][3]	= 6
CasementIDArray[2][1]	= 9
CasementIDArray[2][2]	= 1
CasementIDArray[2][3]	= 5
CasementIDArray[3][1]	= 0
CasementIDArray[3][2]	= 0
CasementIDArray[3][3]	= 0

dim CasementTypeArray[3][3]
CasementTypeArray[1][1]	= 1
CasementTypeArray[1][2]	= 1
CasementTypeArray[1][3]	= 1
CasementTypeArray[2][1]	= 1
CasementTypeArray[2][2]	= 1
CasementTypeArray[2][3]	= 1
CasementTypeArray[3][1]	= 1
CasementTypeArray[3][2]	= 1
CasementTypeArray[3][3]	= 1


! =============================================================================
! Localization
! =============================================================================

dim stDetail[6]
	stDetail[1] = `Зависит от Масштаба`
	stDetail[2] = `Детальный`
	stDetail[3] = `Простой`
	stDetail[4] = `Откл.`
	stDetail[5] = `Китайский Простой`
	stDetail[6] = `Китайский Детальный`

dim stFrameElemJoin[2]
	stFrameElemJoin[1] = `Угловое Соединение`
	stFrameElemJoin[2] = `Соединение Встык`

dim stSashType[17]
	stSashType[1] = `Без Раскладки`
	stSashType[2] = `Г/В-Раскладка`
	stSashType[3] = `Редактируемая Раскладка`
	stSashType[4] = `Специальная Створка`
	stSashType[5] = `Стиль Прерия`
	stSashType[6] = `Разделенный`
	stSashType[7] = `Солнечные Лучи 1`
	stSashType[8] = `Солнечные Лучи 2`
	stSashType[9] = `Солнечные Лучи 3`
	stSashType[10] = `Солнечные Лучи 4`
	stSashType[11] = `Солнечные Лучи 5`
	stSashType[12] = `Солнечные Лучи 6`
	stSashType[13] = `Сплошное Остекление`
	stSashType[14] = `Разделенная Рама`
	stSashType[15] = `Сплошная Панель`
	stSashType[16] = `Вентиляционная Створка`
	stSashType[17] = `Французская Панель`

dim stMullionPosition[3]
	stMullionPosition[1] = `Снаружи`
	stMullionPosition[2] = `Внутри`
	stMullionPosition[3] = `Посередине`

dim stOpeningType[26]
	stOpeningType[1] = `Фиксированное Остекление`
	stOpeningType[2] = ``
	stOpeningType[3] = `Распашная`
	stOpeningType[4] = `Распашная Зеркальная`
	stOpeningType[5] = `Наклонно-Поворотная `
	stOpeningType[6] = `Наклонно-Поворотная Зеркальная`
	stOpeningType[7] = `Нижнеподвесная`
	stOpeningType[8] = `Верхнеподвесная`
	stOpeningType[9] = `Среднеповоротная Горизонтальная`
	stOpeningType[10] = `Среднеповоротная Вертикальная`
	stOpeningType[11] = ``
	stOpeningType[12] = ``
	stOpeningType[13] = ``
	stOpeningType[14] = ``
	stOpeningType[15] = ``
	stOpeningType[16] = `Среднеповоротная Вертикальная Зеркальная`
	stOpeningType[17] = ``
	stOpeningType[18] = `Двойная Створка`
	stOpeningType[19] = `Двойная Наклонно-Поворотная`
	stOpeningType[20] = `Двойная Наклонно-Поворотная Зеркальная`
	stOpeningType[21] = `Раздвижная`
	stOpeningType[22] = `Раздвижная Зеркальная`
	stOpeningType[23] = `Двойная Раздвижная`
	stOpeningType[24] = `Двойная Раздвижная Зеркальная`
	stOpeningType[25] = `Подъемная`
	stOpeningType[26] = `Подъемно-Опускная`

dim stVentilationProfileType[3]
	stVentilationProfileType[1] = `Нет`
	stVentilationProfileType[2] = `В Раме`
	stVentilationProfileType[3] = `В Остеклении`

dim stPanesConfiguration[4]
	stPanesConfiguration[1] = `Одинаковое Остекление`
	stPanesConfiguration[2] = `Симметрично`
	stPanesConfiguration[3] = `Асимметрично`
	stPanesConfiguration[4] = `Одинаковые Створки`


! =============================================================================
! Ventilation Profile Type Enable
! =============================================================================

bEnableVentilationProfile = 1
gs_VentilationProfileTypeEnable = 2


! =============================================================================
! Panes Configuration
! =============================================================================

if gs_iPanesConfig = PANESCONFIG_UNIFORM then
	unifPane_w = (ac_unit_width - gs_frame2_width*4 - \
	 (((gs_optype_m_01 <> SASH_FIXED) + (gs_optype_m_09 <> SASH_FIXED) + (gs_optype_m_05 <> SASH_FIXED)) * 2 * (gs_sash_width - gs_rebate_width)) ) / 3

	gs_LeftSLight_w	= unifPane_w + gs_frame2_width + gs_frame2_width/2 + (gs_optype_m_09 <> SASH_FIXED) * 2 * (gs_sash_width - gs_rebate_width )
	gs_SLight_w		= unifPane_w + gs_frame2_width + gs_frame2_width/2 + (gs_optype_m_05 <> SASH_FIXED) * 2 * (gs_sash_width - gs_rebate_width )
	gs_MidPane_w	= ac_unit_width - gs_LeftSLight_w - gs_SLight_w

	parameters gs_SLight_w	= gs_SLight_w

	lock "gs_SLight_w"
	hideparameter "gs_SLight_w"
endif

if gs_iPanesConfig = PANESCONFIG_SYMM then
	gs_LeftSLight_w	= gs_SLight_w
	gs_MidPane_w	= ac_unit_width - gs_LeftSLight_w - gs_SLight_w
endif


! =============================================================================
! Sash Sizes - Inside Sashes
! =============================================================================

dim sashWidthArray[3][3]
dim sashHeightArray[3][3]
dim sashPosXArray[3][3]
dim sashPosYArray[3][3]
for i=1 to 3
	for j=1 to 3
		sashWidthArray[i][j]	= 0
		sashHeightArray[i][j]	= 0
		sashPosXArray[i][j]		= 0
		sashPosYArray[i][j]		= 0
	next j
next i

! Transom Sashes ==============================================================

cavityHeight = ac_unit_height - gs_UTrans_h - gs_UTrans_w/2 - gs_frame_width + 3 * gs_rebate_width
cavityBottom = gs_UTrans_h + gs_UTrans_w/2 - 2 * gs_rebate_width

! Upper Left Sash -------------------------------------------------------------

if gs_UTrans & gs_UTrans_Div then
	cavityLeft	= -ac_unit_width/2 + gs_frame_width - gs_rebate_width
	cavityRight	= -ac_unit_width/2 + gs_LeftSLight_w - gs_frame_width/2 + gs_rebate_width

	sashWidthArray[1][1]	= cavityRight - cavityLeft
	sashHeightArray[1][1]	= cavityHeight
	sashPosXArray[1][1]		= cavityLeft + (cavityRight - cavityLeft)/2
	sashPosYArray[1][1]		= cavityBottom
endif

! Upper Middle Sash -----------------------------------------------------------

if gs_UTrans then
	if gs_UTrans_Div then
		cavityLeft	= -ac_unit_width/2 + gs_LeftSLight_w + gs_frame_width/2 - gs_rebate_width
		cavityRight	=  ac_unit_width/2 - gs_SLight_w - gs_frame_width/2 + gs_rebate_width
	else
		cavityLeft	= -ac_unit_width/2 + gs_frame_width - gs_rebate_width
		cavityRight	=  ac_unit_width/2 - gs_frame_width + gs_rebate_width
	endif

	sashWidthArray[1][2]	= cavityRight - cavityLeft
	sashHeightArray[1][2]	= cavityHeight
	sashPosXArray[1][2]		= cavityLeft + (cavityRight - cavityLeft)/2
	sashPosYArray[1][2]		= cavityBottom
endif

! Upper Right Sash ------------------------------------------------------------

if gs_UTrans & gs_UTrans_Div then
	cavityLeft	= ac_unit_width/2 - gs_SLight_w + gs_frame_width/2 - gs_rebate_width
	cavityRight	= ac_unit_width/2 - gs_frame_width + gs_rebate_width

	sashWidthArray[1][3]	= cavityRight - cavityLeft
	sashHeightArray[1][3]	= cavityHeight
	sashPosXArray[1][3]		= cavityRight - (cavityRight - cavityLeft)/2
	sashPosYArray[1][3]		= cavityBottom
endif


! Main Sashes =================================================================

if gs_UTrans then
	cavityTop = gs_UTrans_h - gs_UTrans_w/2 + 2 * gs_rebate_width
else
	cavityTop = ac_unit_height - gs_frame_width + gs_rebate_width
endif
cavityBottom = gs_frame_width_lower - gs_rebate_width

! Middle Left Sash ------------------------------------------------------------

cavityLeft	= -ac_unit_width/2 + gs_frame_width - gs_rebate_width
cavityRight	= -ac_unit_width/2 + gs_LeftSLight_w - gs_frame_width/2 + gs_rebate_width
sashWidthArray[2][1]	= cavityRight - cavityLeft
sashHeightArray[2][1]	= cavityTop - cavityBottom
sashPosXArray[2][1]		= cavityLeft + (cavityRight - cavityLeft)/2
sashPosYArray[2][1]		= cavityBottom

! Middle Middle Sash ----------------------------------------------------------

cavityLeft	= -ac_unit_width/2 + gs_LeftSLight_w + gs_frame_width/2 - gs_rebate_width
cavityRight	=  ac_unit_width/2 - gs_SLight_w - gs_frame_width/2 + gs_rebate_width
sashWidthArray[2][2]	= cavityRight - cavityLeft
sashHeightArray[2][2]	= cavityTop - cavityBottom
sashPosXArray[2][2]		= (cavityLeft + cavityRight)/2
sashPosYArray[2][2]		= cavityBottom

! Middle Right Sash -----------------------------------------------------------

cavityLeft	= ac_unit_width/2 - gs_SLight_w + gs_frame_width/2 - gs_rebate_width
cavityRight	= ac_unit_width/2 - gs_frame_width + gs_rebate_width
sashWidthArray[2][3]	= cavityRight - cavityLeft
sashHeightArray[2][3]	= cavityTop - cavityBottom
sashPosXArray[2][3]		= cavityRight - (cavityRight - cavityLeft)/2
sashPosYArray[2][3]		= cavityBottom


! =============================================================================
! Sash Sizes - Outside Sashes
! =============================================================================

dim sashWidthArray2[3][3]
dim sashHeightArray2[3][3]
dim sashPosXArray2[3][3]
dim sashPosYArray2[3][3]
for i=1 to 3
	for j=1 to 3
		sashWidthArray2[i][j]	= 0
		sashHeightArray2[i][j]	= 0
		sashPosXArray2[i][j]	= 0
		sashPosYArray2[i][j]	= 0
	next j
next i

! Transom Sashes ==============================================================

cavityHeight = ac_unit_height - gs_UTrans_h - gs_UTrans_w/2 - gs_frame2_width + 2 * gs_rebate_width
cavityBottom = gs_UTrans_h + gs_UTrans_w/2 - gs_rebate_width

! Upper Left Sash -------------------------------------------------------------

if gs_UTrans & gs_UTrans_Div then
	cavityLeft	= -ac_unit_width/2 + gs_frame2_width - gs_rebate_width
	cavityRight	= -ac_unit_width/2 + gs_LeftSLight_w - gs_frame2_width/2 + gs_rebate_width

	sashWidthArray2[1][1]	= cavityRight - cavityLeft
	sashHeightArray2[1][1]	= cavityHeight
	sashPosXArray2[1][1]	= cavityLeft + (cavityRight - cavityLeft)/2
	sashPosYArray2[1][1]	= cavityBottom
endif

! Upper Middle Sash -----------------------------------------------------------

if gs_UTrans then
	if gs_UTrans_Div then
		cavityLeft	= -ac_unit_width/2 + gs_LeftSLight_w + gs_frame2_width/2 - gs_rebate_width
		cavityRight	=  ac_unit_width/2 - gs_SLight_w - gs_frame2_width/2 + gs_rebate_width
	else
		cavityLeft	= -ac_unit_width/2 + gs_frame2_width - gs_rebate_width
		cavityRight	=  ac_unit_width/2 - gs_frame2_width + gs_rebate_width
	endif

	sashWidthArray2[1][2]	= cavityRight - cavityLeft
	sashHeightArray2[1][2]	= cavityHeight
	sashPosXArray2[1][2]	= cavityLeft + (cavityRight - cavityLeft)/2
	sashPosYArray2[1][2]	= cavityBottom
endif

! Upper Right Sash ------------------------------------------------------------

if gs_UTrans & gs_UTrans_Div then
	cavityLeft	= ac_unit_width/2 - gs_SLight_w + gs_frame2_width/2 - gs_rebate_width
	cavityRight	= ac_unit_width/2 - gs_frame2_width + gs_rebate_width

	sashWidthArray2[1][3]	= cavityRight - cavityLeft
	sashHeightArray2[1][3]	= cavityHeight
	sashPosXArray2[1][3]	= cavityRight - (cavityRight - cavityLeft)/2
	sashPosYArray2[1][3]	= cavityBottom
endif


! Main Sashes =================================================================

if gs_UTrans then
	cavityTop = gs_UTrans_h - gs_UTrans_w/2 + gs_rebate_width
else
	cavityTop = ac_unit_height - gs_frame2_width + gs_rebate_width
endif
cavityBottom = gs_frame2_width_lower - gs_rebate_width

! Middle Left Sash ------------------------------------------------------------

cavityLeft	= -ac_unit_width/2 + gs_frame2_width - gs_rebate_width
cavityRight	= -ac_unit_width/2 + gs_LeftSLight_w - gs_frame2_width/2 + gs_rebate_width
sashWidthArray2[2][1]	= cavityRight - cavityLeft
sashHeightArray2[2][1]	= cavityTop - cavityBottom
sashPosXArray2[2][1]	= cavityLeft + (cavityRight - cavityLeft)/2
sashPosYArray2[2][1]	= cavityBottom

! Middle Middle Sash ----------------------------------------------------------

cavityLeft	= -ac_unit_width/2 + gs_LeftSLight_w + gs_frame2_width/2 - gs_rebate_width
cavityRight	=  ac_unit_width/2 - gs_SLight_w - gs_frame2_width/2 + gs_rebate_width
sashWidthArray2[2][2]	= cavityRight - cavityLeft
sashHeightArray2[2][2]	= cavityTop - cavityBottom
sashPosXArray2[2][2]	= (cavityLeft + cavityRight)/2
sashPosYArray2[2][2]	= cavityBottom

! Middle Right Sash -----------------------------------------------------------

cavityLeft	= ac_unit_width/2 - gs_SLight_w + gs_frame2_width/2 - gs_rebate_width
cavityRight	= ac_unit_width/2 - gs_frame2_width + gs_rebate_width
sashWidthArray2[2][3]	= cavityRight - cavityLeft
sashHeightArray2[2][3]	= cavityTop - cavityBottom
sashPosXArray2[2][3]	= cavityRight - (cavityRight - cavityLeft)/2
sashPosYArray2[2][3]	= cavityBottom


! =============================================================================
! Ventilation Profile
! =============================================================================

if not(bEnableVentilationProfile & bVentilationProfile & (iVentilationProfileType = VENTPROFILE_OVER_GLAZING)) then
	isVentilationProfileInSash_01	= 0
	isVentilationProfileInSash_02	= 0
	isVentilationProfileInSash_05	= 0
	isVentilationProfileInSash_06	= 0
	isVentilationProfileInSash_09	= 0
	isVentilationProfileInSash_10	= 0
endif


! =============================================================================
"MasterEnd":
