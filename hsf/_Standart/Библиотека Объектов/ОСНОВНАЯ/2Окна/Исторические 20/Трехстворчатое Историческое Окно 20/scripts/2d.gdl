
! Contact person: <BD, BO, NJ>

! =============================================================================

gs_fillFr		= gs_bFills * gs_fillFr
gs_fillSh		= gs_bFills * gs_fillSash
gs_penSh_fg		= gs_bFills * gs_penSash_fg
gs_penSh_bg		= gs_bFills * gs_penSash_bg
gs_fillShCover	= gs_bFills * gs_fillShCover


if iTypeDemolitionFill = RENOVATION_FILL_DEMOLISHED then		! Demolition
	line_type gs_Demolition_linetype
else
	line_type 1
endif

! =============================================================================
! GS Corner Window Functions
! =============================================================================

call "GS Corner Window Functions",
	parameters all	iWindowShape			= iWindowShape,
					gs_IsCurved				= gs_IsCurved,
					bParalellInCurvedWalls	= bParalellInCurvedWalls,
					bDisabeMirroring		= bDisabeMirroring,

					bLeftCornerFunction		= bLeftCornerFunction,
					leftCornerAngle			= leftCornerAngle,
					bLeftDiffConnWall		= bLeftDiffConnWall,
					leftConnWallThk			= leftConnWallThk,
					bRightCornerFunction	= bRightCornerFunction,
					rightCornerAngle		= rightCornerAngle,
					bRightDiffConnWall		= bRightDiffConnWall,
					rightConnWallThk		= rightConnWallThk,
					bOneLineSymbolinMVO		= 1,
	returned_parameters	ac_unit_width,
						gs_frame_ovhg_left_out,
						gs_frame_ovhg_right_out,
						gs_frame_ovhg_left_in,
						gs_frame_ovhg_right_in,
						bMirrored,
						addPrmX, addPrmY,
						mulPrmX, mulPrmY,
						iLoD2D,

						gs_opLinePen,
						gs_iSwingType,
						gs_swingLineType,
						bShowAddHotspots, bShowUnitHotspots,
						bOneLineSymbolin2D

if iLoD2D = 0 then end

bOpeningSashIn2D	= 0
iSymbolGlassType	= SYMBGLASS_SIMPLEGLASS

if iLoD2D = SYMBW_D_2GLASS then 				! Detailed --> NOR 50
	bFullSashOpeningIn2D	= 1
	iSymbolGlassType		= SYMBGLASS_DOUBLEGLASS
endif

add2 addPrmX, addPrmY
mul2 mulPrmX, mulPrmY

mul2 1,-1
add2 0,WIDO_FRAME_THICKNESS

temp = gs_frame_ovhg_left_out
gs_frame_ovhg_left_out = gs_frame_ovhg_left_in
gs_frame_ovhg_left_in = temp

temp = gs_frame_ovhg_right_out
gs_frame_ovhg_right_out = gs_frame_ovhg_right_in
gs_frame_ovhg_right_in = temp

if iTypeDemolitionFill = RENOVATION_FILL_DEMOLISHED then gs_swingLineType = gs_Demolition_linetype	! Demolition


! ==============================================================================
! Draw window frame
! ==============================================================================

if iTypeDemolitionFill = RENOVATION_FILL_NEW & gs_bShowNewOnCC then end		! New


! =============================================================================
! Window
! =============================================================================

_gs_rebate_width	= gs_rebate_width
if not(iLoD2D = SYMBW_D_REBATEONGLASS) then _gs_rebate_width = 0

!-----Left Sash

if	(gs_optype_m_09 = SASH_FIXED and iLoD2D > SYMBW_M_9) |\
	iLoD2D = SYMBW_S_CENTERLINE | (iLoD2D = SYMBW_S_1LINE and bOneLineSymbolin2D) then			!FIXED
	cicleStart =  2		!draw only outer sash
else
	cicleStart =  1
endif

for i = cicleStart to 2
	if i = 1 then
		frameWidth = gs_frame_width
		frameWidthLeft = gs_frame_width
		frameThickness = gs_frame_thk-gs_frame2_thk
		sashWidth = gs_LeftSLight_w-gs_frame_width/2 + gs_rebate_width
		leftOuterOversize = gs_frame_ovhg_left_out + (gs_frame_ovhg_left_in - gs_frame_ovhg_left_out)*(gs_frame2_thk/gs_frame_thk)
		leftInnerOversize = gs_frame_ovhg_left_in
		rightOuterOversize = 0
		rightInnerOversize = 0
		sh_UnID = 1000
		unit_UnID = 100
		bInnerSash = 1
		gs_bFrameRight = 0

		add2 -ac_unit_width/2 + (sashWidth)/2, -gs_frame2_thk
	endif
	if i = 2 then
		frameWidth = gs_frame2_width/2
		frameWidthLeft = gs_frame2_width
		frameThickness = gs_frame2_thk
		sashWidth = gs_LeftSLight_w
		leftOuterOversize = gs_frame_ovhg_left_out
		leftInnerOversize = gs_frame_ovhg_left_out + (gs_frame_ovhg_left_in - gs_frame_ovhg_left_out)*(gs_frame2_thk/gs_frame_thk)
		rightOuterOversize = 0
		rightInnerOversize = 0
		sh_UnID = 1010
		unit_UnID = 110
		bInnerSash = 0
		gs_bFrameRight = 1

		add2 -ac_unit_width/2 + (gs_LeftSLight_w-2*gs_frame2_width)/2 + gs_frame2_width, 0
	endif
	call "BasicWindowPanelStraight",
					parameters	A				= sashWidth,
					iTypeDemolitionFill			= iTypeDemolitionFill,
					gs_Demolition_linetype		= gs_Demolition_linetype,
					gs_optype_m					= gs_optype_m_09,
					bLeftCornerFunction			= bLeftCornerFunction,
					bRightCornerFunction		= 0,
					gs_frame_thk				= frameThickness,
					gs_frame_width				= frameWidth,
					gs_frame_width_left			= frameWidthLeft,
					gs_frame_right_endline		= 0,
					gs_frame_left_endline		= not ((gs_tolerance_left > EPS) & gs_stack_left),
					gs_frame_right_endline_comp	= 0,
					gs_frame_left_endline_comp	= 1 + (gs_left_oversize < EPS),
					gs_frame_right_unitline		= 0,
					gs_frame_left_unitline		= 1,
					gs_frame_cut_width			= gs_rebate_width,
					gs_frame_cut_depth			= gs_rebate_depth,
					gs_bFrameLeft				= 1,
					gs_bFrameRight				= gs_bFrameRight,
					gs_frame_ovhg_left_out		= leftOuterOversize,
					gs_frame_ovhg_right_out		= rightOuterOversize,
					gs_frame_ovhg_left_in		= leftInnerOversize,
					gs_frame_ovhg_right_in		= rightInnerOversize,
					gs_sash_thk					= gs_sash_thk,
					gs_sash_width				= gs_sash_width,
					iMullionStyle				= iMullionStyle_09,
					gs_open_2D					= gs_open_2D,
					gs_opLinePen				= gs_opLinePen,
					gs_iSwingType				= gs_iSwingType,
					gs_swingLineType			= gs_swingLineType,
					iLoD2D						= iLoD2D,
					gs_pen_2D					= gs_pen_2D,
					gs_frame_pen_cont			= gs_frame_pen_cont,
					gs_fillFr					= gs_fillFr,
					gs_penFr_fg					= gs_penFr_fg,
					gs_penFr_bg					= gs_penFr_bg,
					gs_fillSh					= gs_fillSash,
					gs_penSh_fg					= gs_penSash_fg,
					gs_penSh_bg					= gs_penSash_bg,
					gs_fillShCover				= gs_fillShCover,
					gs_penShCov_fg       		= gs_penShCov_fg,
					gs_penShCov_bg      		= gs_penShCov_bg,
					gs_glass_thk				= gs_glass_thk,
					sh_UnID						= sh_UnID,
					unit_UnID					= unit_UnID,
					bShowUnitHotspots			= bShowUnitHotspots,
					bInnerSash					= bInnerSash
	if i = 1 then del 1
	if i = 2 then del 1
next i

!-----Right Sash

if	(gs_optype_m_05 = SASH_FIXED and iLoD2D > SYMBW_M_9) |\
	iLoD2D = SYMBW_S_CENTERLINE | (iLoD2D = SYMBW_S_1LINE and bOneLineSymbolin2D) then			!FIXED
	cicleStart =  2		!draw only outer sash
else
	cicleStart =  1
endif

for j = cicleStart to 2
	if j = 1 then
		frameWidth = gs_frame_width
		frameWidthLeft = gs_frame_width
		frameThickness = gs_frame_thk-gs_frame2_thk
		sashWidth = gs_SLight_w-gs_frame_width/2 + gs_rebate_width
		rightOuterOversize = gs_frame_ovhg_right_out + (gs_frame_ovhg_right_in - gs_frame_ovhg_right_out)*(gs_frame2_thk/gs_frame_thk)
		rightInnerOversize = gs_frame_ovhg_right_in
		leftOuterOversize = 0
		leftInnerOutersize = 0
		sh_UnID = 1020
		unit_UnID = 120
		bInnerSash = 1
		gs_bFrameLeft = 0

		add2 ac_unit_width/2 - (sashWidth)/2, -gs_frame2_thk
	endif
	if j = 2 then
		frameWidth = gs_frame2_width
		frameWidthLeft = gs_frame2_width/2
		frameThickness = gs_frame2_thk
		sashWidth = gs_SLight_w
		rightOuterOversize = gs_frame_ovhg_right_out
		rightInnerOversize = gs_frame_ovhg_right_out + (gs_frame_ovhg_right_in - gs_frame_ovhg_right_out)*(gs_frame2_thk/gs_frame_thk)
		leftOuterOversize = 0
		leftInnerOversize = 0
		sh_UnID = 1030
		unit_UnID = 130
		bInnerSash = 0
		gs_bFrameLeft = 1

		add2 ac_unit_width/2 - (gs_SLight_w-2*gs_frame2_width)/2 - gs_frame2_width, 0
	endif

	call "BasicWindowPanelStraight",
				parameters	A				= sashWidth,
				iTypeDemolitionFill			= iTypeDemolitionFill,
				gs_Demolition_linetype		= gs_Demolition_linetype,
				gs_optype_m					= gs_optype_m_05,
				bLeftCornerFunction			= 0,
				bRightCornerFunction		= bRightCornerFunction | bCornerWindow,
				gs_frame_thk				= frameThickness,
				gs_frame_width				= frameWidth,
				gs_frame_width_left			= frameWidthLeft,
				gs_frame_right_endline		= not(bCornerWindow) & not ((gs_tolerance_right > EPS) & gs_stack_right),
				gs_frame_left_endline		= 0,
				gs_frame_right_endline_comp	= 1 + (gs_right_oversize < EPS),
				gs_frame_left_endline_comp	= 0,
				gs_frame_right_unitline		= not(bCornerWindow),
				gs_frame_left_unitline		= 0,
				gs_frame_cut_width			= gs_rebate_width,
				gs_frame_cut_depth			= gs_rebate_depth,
				gs_bFrameLeft				= gs_bFrameLeft,
				gs_bFrameRight				= 1,
				gs_frame_ovhg_left_out		= leftOuterOversize,
				gs_frame_ovhg_right_out		= rightOuterOversize,
				gs_frame_ovhg_left_in		= leftInnerOversize,
				gs_frame_ovhg_right_in		= rightInnerOversize,
				gs_sash_thk					= gs_sash_thk,
				gs_sash_width				= gs_sash_width,
				iMullionStyle				= iMullionStyle_05,
				gs_open_2D					= gs_open_2D,
				gs_opLinePen				= gs_opLinePen,
				gs_iSwingType				= gs_iSwingType,
				gs_swingLineType			= gs_swingLineType,
				iLoD2D						= iLoD2D,
				gs_pen_2D					= gs_pen_2D,
				gs_frame_pen_cont			= gs_frame_pen_cont,
				gs_fillFr					= gs_fillFr,
				gs_penFr_fg					= gs_penFr_fg,
				gs_penFr_bg					= gs_penFr_bg,
				gs_fillSh					= gs_fillSash,
				gs_penSh_fg					= gs_penSash_fg,
				gs_penSh_bg					= gs_penSash_bg,
				gs_fillShCover				= gs_fillShCover,
				gs_penShCov_fg       		= gs_penShCov_fg,
				gs_penShCov_bg      		= gs_penShCov_bg,
				gs_glass_thk				= gs_glass_thk,
				sh_UnID						= sh_UnID,
				unit_UnID					= unit_UnID,
				bShowUnitHotspots			= bShowUnitHotspots,
				bInnerSash					= bInnerSash

	if j = 1 then del 1
	if j = 2 then del 1
next j

!----Middle Sash

if	(gs_optype_m_01 = SASH_FIXED and iLoD2D > SYMBW_M_9) |\
	iLoD2D = SYMBW_S_CENTERLINE | (iLoD2D = SYMBW_S_1LINE and bOneLineSymbolin2D) then			!FIXED
	cicleStart =  2		!draw only outer sash
else
	cicleStart =  1
endif

for k = cicleStart to 2
	if k = 1 then
		frameWidth = gs_frame_width
		frameThickness = gs_frame_thk-gs_frame2_thk
		sashWidth = gs_MidPane_w - gs_frame_width + 2*gs_rebate_width
		rightOuterOversize = -gs_frame_width/2
		rightInnerOversize = -gs_frame_width/2
		leftOuterOversize = -gs_frame_width/2
		leftInnerOutersize = -gs_frame_width/2
		sh_UnID = 1040
		unit_UnID = 140
		bInnerSash = 1
		gs_bFrameLeft = 0
		gs_bFrameRight = 0
		add2 -(gs_SLight_w - gs_leftSLight_w)/2, -gs_frame2_thk
	endif
	if k = 2 then
		frameWidth = gs_frame2_width/2
		frameThickness = gs_frame2_thk
		sashWidth = gs_MidPane_w
		rightOuterOversize = 0
		rightInnerOversize = 0
		leftOuterOversize = 0
		leftInnerOversize = 0
		sh_UnID = 1050
		unit_UnID = 150
		bInnerSash = 0
		gs_bFrameLeft = 1
		gs_bFrameRight = 1
		add2 -(gs_SLight_w - gs_leftSLight_w)/2, 0
	endif

	call "BasicWindowPanelStraight",
				parameters	A				= sashWidth,
				iTypeDemolitionFill			= iTypeDemolitionFill,
				gs_Demolition_linetype		= gs_Demolition_linetype,
				gs_optype_m					= gs_optype_m_01,
				bLeftCornerFunction			= 0,
				bRightCornerFunction		= bRightCornerFunction | bCornerWindow,
				gs_frame_thk				= frameThickness,
				gs_frame_width				= frameWidth,
				gs_frame_right_endline		= not(bCornerWindow) & not ((gs_tolerance_right > EPS) & gs_stack_right),
				gs_frame_left_endline		= 0,
				gs_frame_right_endline_comp	= 1 + (gs_right_oversize < EPS),
				gs_frame_left_endline_comp	= 0,
				gs_frame_right_unitline		= not(bCornerWindow),
				gs_frame_left_unitline		= 0,
				gs_frame_cut_width			= gs_rebate_width,
				gs_frame_cut_depth			= gs_rebate_depth,
				gs_bFrameLeft				= gs_bFrameLeft,
				gs_bFrameRight				= gs_bFrameRight,
				gs_frame_ovhg_left_out		= leftOuterOversize,
				gs_frame_ovhg_right_out		= rightOuterOversize,
				gs_frame_ovhg_left_in		= leftInnerOversize,
				gs_frame_ovhg_right_in		= rightInnerOversize,
				gs_sash_thk					= gs_sash_thk,
				gs_sash_width				= gs_sash_width,
				iMullionStyle				= iMullionStyle_01,
				gs_open_2D					= gs_open_2D,
				gs_opLinePen				= gs_opLinePen,
				gs_iSwingType				= gs_iSwingType,
				gs_swingLineType			= gs_swingLineType,
				iLoD2D						= iLoD2D,
				gs_pen_2D					= gs_pen_2D,
				gs_frame_pen_cont			= gs_frame_pen_cont,
				gs_fillFr					= gs_fillFr,
				gs_penFr_fg					= gs_penFr_fg,
				gs_penFr_bg					= gs_penFr_bg,
				gs_fillSh					= gs_fillSash,
				gs_penSh_fg					= gs_penSash_fg,
				gs_penSh_bg					= gs_penSash_bg,
				gs_fillShCover				= gs_fillShCover,
				gs_penShCov_fg       		= gs_penShCov_fg,
				gs_penShCov_bg      		= gs_penShCov_bg,
				gs_glass_thk				= gs_glass_thk,
				sh_UnID						= sh_UnID,
				unit_UnID					= unit_UnID,
				bShowUnitHotspots			= bShowUnitHotspots,
				bInnerSash					= bInnerSash

	del 1
next k

!----Inner Frames and inner fixed sashes
pen gs_frame_pen_cont
line_property 2
fill gs_fillFr

if iLoD2D > SYMBW_M_9 then

	_gs_rebate_depth	= gs_frame2_thk/2 * not(iLoD2D = SYMBW_D_REBATEONGLASS) + gs_rebate_depth * (iLoD2D = SYMBW_D_REBATEONGLASS)

	add2 0, -gs_frame2_thk
	if gs_optype_m_09 = SASH_FIXED then			!fix left sash
		put		-ac_unit_width/2,										0,													32 + 1,
				-ac_unit_width/2 + gs_frame_width,						0,													32 + 1
		if iLoD2D = SYMBW_D_REBATEONGLASS then
			put	-ac_unit_width/2 + gs_frame_width,						-gs_frame_thk + gs_frame2_thk + _gs_rebate_depth,	32 + 1,
				-ac_unit_width/2 + gs_frame_width - gs_rebate_width,	-gs_frame_thk + gs_frame2_thk + _gs_rebate_depth,	32 + 1,
				-ac_unit_width/2 + gs_frame_width - gs_rebate_width,	-gs_frame_thk + gs_frame2_thk,						32 + 1
		else
			put -ac_unit_width/2 + gs_frame_width,						-gs_frame_thk + gs_frame2_thk,	32 + 1
		endif
		put		-ac_unit_width/2,										-gs_frame_thk + gs_frame2_thk,	32 + 1

		fill gs_fillFr

		poly2_b nsp/3, 1+2+4+16+32, gs_penFr_fg, gs_penFr_bg,
				get(nsp)


		line_property 0

		if iSymbolGlassType = SYMBGLASS_DOUBLEGLASS then
			poly2_b 4, 1+2+4+16+32, gs_penFr_fg, gs_penFr_bg,
				-gs_MidPane_w/2 - gs_frame_width/2 - (gs_SLight_w - gs_leftSLight_w)/2, -gs_frame_thk + 1.5 * gs_frame2_thk - gs_glass_thk / 2, 32 + 1,
				-ac_unit_width/2 + gs_frame_width,	-gs_frame_thk + 1.5 * gs_frame2_thk - gs_glass_thk / 2, 0,
				-ac_unit_width/2 + gs_frame_width,	-gs_frame_thk + 1.5 * gs_frame2_thk + gs_glass_thk / 2, 32 + 1,
				-gs_MidPane_w/2 - gs_frame_width/2 - (gs_SLight_w - gs_leftSLight_w)/2, -gs_frame_thk + 1.5 * gs_frame2_thk + gs_glass_thk / 2, 0
		else
			line2	-gs_MidPane_w/2 - gs_frame_width/2 + (gs_SLight_w - gs_leftSLight_w)/2,						-gs_frame_thk + gs_frame2_thk + _gs_rebate_depth,
					-ac_unit_width/2 + gs_frame_width,															-gs_frame_thk + gs_frame2_thk + _gs_rebate_depth
		endif

		fill gs_fillShCover

		put		-ac_unit_width/2 + gs_frame_width,															-gs_frame_thk + 2 * gs_frame2_thk,			0,
				-gs_MidPane_w/2 - gs_frame_width/2 + (gs_SLight_w - gs_leftSLight_w)/2,						-gs_frame_thk + 2 * gs_frame2_thk,			0
		if iLoD2D = SYMBW_D_REBATEONGLASS then
			put	-gs_MidPane_w/2 - gs_frame_width/2 + (gs_SLight_w - gs_leftSLight_w)/2,						-gs_frame_thk + gs_frame2_thk + _gs_rebate_depth,	0,
				-gs_MidPane_w/2 - gs_frame_width/2 + (gs_SLight_w - gs_leftSLight_w)/2 + gs_rebate_width,	-gs_frame_thk + gs_frame2_thk + _gs_rebate_depth,	0,
				-gs_MidPane_w/2 - gs_frame_width/2 + (gs_SLight_w - gs_leftSLight_w)/2 + gs_rebate_width,	-gs_frame_thk + gs_frame2_thk,			0
		else
			put	-gs_MidPane_w/2 - gs_frame_width/2 + (gs_SLight_w - gs_leftSLight_w)/2,						-gs_frame_thk + gs_frame2_thk,			0
		endif
		if iLoD2D = SYMBW_D_REBATEONGLASS then
			put	-ac_unit_width/2 + gs_frame_width - gs_rebate_width,		-gs_frame_thk + gs_frame2_thk,						0,
				-ac_unit_width/2 + gs_frame_width - gs_rebate_width,		-gs_frame_thk + gs_frame2_thk + _gs_rebate_depth,	0,
				-ac_unit_width/2 + gs_frame_width,							-gs_frame_thk + gs_frame2_thk + _gs_rebate_depth,	0
		else
			put	-ac_unit_width/2 + gs_frame_width,							-gs_frame_thk + gs_frame2_thk,						0
		endif

		poly2_b nsp/3, 1+2+4+16+32, gs_penShCov_fg, gs_penShCov_bg,
				get(nsp)


		poly2_b 4, 1+2+4+16+32, gs_penShCov_fg, gs_penShCov_bg,
				-gs_MidPane_w/2 - gs_frame_width/2 + gs_rebate_width + (gs_SLight_w - gs_leftSLight_w)/2,	0,								0,
				-gs_MidPane_w/2 - gs_frame_width/2 + gs_rebate_width + (gs_SLight_w - gs_leftSLight_w)/2,	-gs_frame_thk + 2 * gs_frame2_thk,	0,
				-ac_unit_width/2 + gs_frame_width, 															-gs_frame_thk + 2 * gs_frame2_thk,	0,
				-ac_unit_width/2 + gs_frame_width,															0,								0

		line2	-gs_MidPane_w/2 - gs_frame_width/2 + (gs_SLight_w - gs_leftSLight_w)/2 + _gs_rebate_width,	-gs_frame_thk + gs_frame2_thk,
				-ac_unit_width/2 + gs_frame_width - _gs_rebate_width,										-gs_frame_thk + gs_frame2_thk

		if not(iLoD2D = SYMBW_D_REBATEONGLASS) then
			line2	-gs_MidPane_w/2 - gs_frame_width/2 + (gs_SLight_w - gs_leftSLight_w)/2,					-gs_frame_thk + 2 * gs_frame2_thk,
					-ac_unit_width/2 + gs_frame_width,														-gs_frame_thk + 2 * gs_frame2_thk
		endif
	endif

	if gs_optype_m_05 = SASH_FIXED then			!fix right sash
		put		ac_unit_width/2,									0,													32 + 1,
				ac_unit_width/2 - gs_frame_width,					0,													32 + 1
		if iLoD2D = SYMBW_D_REBATEONGLASS then
			put	ac_unit_width/2 - gs_frame_width,					-gs_frame_thk + gs_frame2_thk + _gs_rebate_depth,	32 + 1,
				ac_unit_width/2 - gs_frame_width + gs_rebate_width,	-gs_frame_thk + gs_frame2_thk + _gs_rebate_depth,	32 + 1,
				ac_unit_width/2 - gs_frame_width + gs_rebate_width,	-gs_frame_thk + gs_frame2_thk,						32 + 1
		else
			put ac_unit_width/2 - gs_frame_width,					-gs_frame_thk + gs_frame2_thk,						32 + 1
		endif
		put		ac_unit_width/2,									-gs_frame_thk + gs_frame2_thk,						32 + 1

		fill gs_fillFr

		poly2_b nsp/3, 1+2+4+16+32, gs_penFr_fg, gs_penFr_bg,
				get(nsp)


		line_property 0

		if iSymbolGlassType = SYMBGLASS_DOUBLEGLASS then
			poly2_b 4, 1+2+4+16+32, gs_penFr_fg, gs_penFr_bg,
				gs_MidPane_w/2 + gs_frame_width/2 - (gs_SLight_w - gs_leftSLight_w)/2, -gs_frame_thk + 1.5 * gs_frame2_thk - gs_glass_thk / 2, 32 + 1,
				ac_unit_width/2 - gs_frame_width,	-gs_frame_thk + 1.5 * gs_frame2_thk - gs_glass_thk / 2, 0,
				ac_unit_width/2 - gs_frame_width,	-gs_frame_thk + 1.5 * gs_frame2_thk + gs_glass_thk / 2, 32 + 1,
				gs_MidPane_w/2 + gs_frame_width/2 - (gs_SLight_w - gs_leftSLight_w)/2, -gs_frame_thk + 1.5 * gs_frame2_thk + gs_glass_thk / 2, 0
		else
			line2	gs_MidPane_w/2 + gs_frame_width/2 - (gs_SLight_w - gs_leftSLight_w)/2,						-gs_frame_thk + gs_frame2_thk + _gs_rebate_depth,
					ac_unit_width/2 - gs_frame_width,															-gs_frame_thk + gs_frame2_thk + _gs_rebate_depth
		endif

		fill gs_fillShCover

		put		ac_unit_width/2 - gs_frame_width,															-gs_frame_thk + 2 * gs_frame2_thk,			0,
				gs_MidPane_w/2 + gs_frame_width/2 - (gs_SLight_w - gs_leftSLight_w)/2,						-gs_frame_thk + 2 * gs_frame2_thk,			0
		if iLoD2D = SYMBW_D_REBATEONGLASS then
			put	gs_MidPane_w/2 + gs_frame_width/2 - (gs_SLight_w - gs_leftSLight_w)/2,						-gs_frame_thk + gs_frame2_thk + _gs_rebate_depth,	0,
				gs_MidPane_w/2 + gs_frame_width/2 - (gs_SLight_w - gs_leftSLight_w)/2 - gs_rebate_width,	-gs_frame_thk + gs_frame2_thk + _gs_rebate_depth,	0,
				gs_MidPane_w/2 + gs_frame_width/2 - (gs_SLight_w - gs_leftSLight_w)/2 - gs_rebate_width,	-gs_frame_thk + gs_frame2_thk,			0
		else
			put	gs_MidPane_w/2 + gs_frame_width/2 - (gs_SLight_w - gs_leftSLight_w)/2,						-gs_frame_thk + gs_frame2_thk,			0
		endif
		if iLoD2D = SYMBW_D_REBATEONGLASS then
			put	ac_unit_width/2 - gs_frame_width + gs_rebate_width,						-gs_frame_thk + gs_frame2_thk,					0,
				ac_unit_width/2 - gs_frame_width + gs_rebate_width,						-gs_frame_thk + gs_frame2_thk + _gs_rebate_depth,	0,
				ac_unit_width/2 - gs_frame_width,										-gs_frame_thk + gs_frame2_thk + _gs_rebate_depth,	0
		else
			put	ac_unit_width/2 - gs_frame_width,										-gs_frame_thk + gs_frame2_thk,					0
		endif

		poly2_b nsp/3, 1+2+4+16+32, gs_penShCov_fg, gs_penShCov_bg,
				get(nsp)


		poly2_b 4, 1+2+4+16+32, gs_penShCov_fg, gs_penShCov_bg,
				gs_MidPane_w/2 + gs_frame_width/2 - gs_rebate_width - (gs_SLight_w - gs_leftSLight_w)/2,	0,								0,
				gs_MidPane_w/2 + gs_frame_width/2 - gs_rebate_width - (gs_SLight_w - gs_leftSLight_w)/2,	-gs_frame_thk + 2 * gs_frame2_thk,	0,
				ac_unit_width/2 - gs_frame_width, 															-gs_frame_thk + 2 * gs_frame2_thk,	0,
				ac_unit_width/2 - gs_frame_width,															0,								0

		line2	gs_MidPane_w/2 + gs_frame_width/2 - (gs_SLight_w - gs_leftSLight_w)/2 - _gs_rebate_width,	-gs_frame_thk + gs_frame2_thk,
				ac_unit_width/2 - gs_frame_width + _gs_rebate_width,										-gs_frame_thk + gs_frame2_thk

		if not(iLoD2D = SYMBW_D_REBATEONGLASS) then
			line2	gs_MidPane_w/2 + gs_frame_width/2 - (gs_SLight_w - gs_leftSLight_w)/2,					-gs_frame_thk + 2 * gs_frame2_thk,
					ac_unit_width/2 - gs_frame_width,														-gs_frame_thk + 2 * gs_frame2_thk
		endif
	endif
	del 1

	add2 -(gs_SLight_w - gs_leftSLight_w)/2, -gs_frame_thk + gs_frame2_thk
	if gs_optype_m_01 = SASH_FIXED & not(iLoD2D = SYMBW_D_REBATEONGLASS) then			!fix middle sash
		add2 -gs_MidPane_w/2, 0
		fill gs_fillFr

		if gs_optype_m_09 = SASH_FIXED then
			poly2_b 5, 1+2+4+16+32, gs_penFr_fg, gs_penFr_bg,
				-gs_frame_width/2, 0, 32 + 1,
				gs_frame_width/2, 0, 32 + 1,
				gs_frame_width/2, -gs_frame2_thk, 32 + 1,
				-gs_frame_width/2, -gs_frame2_thk, 32 + 1,
				-gs_frame_width/2, 0, -1
		else
			poly2_b 7, 1+2+4+16+32, gs_penFr_fg, gs_penFr_bg,
				-gs_frame_width/2, 0, 32 + 1,
				gs_frame_width/2, 0, 32 + 1,
				gs_frame_width/2, -gs_frame2_thk, 32 + 1,
				-gs_frame_width/2 + gs_rebate_width, -gs_frame2_thk, 32 + 1,
				-gs_frame_width/2 + gs_rebate_width, -gs_frame2_thk + gs_rebate_depth, 32 + 1,
				-gs_frame_width/2, -gs_frame2_thk + gs_rebate_depth, 32 + 1,
				-gs_frame_width/2, 0, -1
		endif
		del 1

		add2 gs_MidPane_w/2, 0
		if gs_optype_m_05 = SASH_FIXED then
			poly2_b 5, 1+2+4+16+32, gs_penFr_fg, gs_penFr_bg,
				gs_frame_width/2, 0, 32 + 1,
				-gs_frame_width/2, 0, 32 + 1,
				-gs_frame_width/2, -gs_frame2_thk, 32 + 1,
				gs_frame_width/2, -gs_frame2_thk, 32 + 1,
				gs_frame_width/2, 0, -1
		else
			poly2_b 7, 1+2+4+16+32, gs_penFr_fg, gs_penFr_bg,
				gs_frame_width/2, 0, 32 + 1,
				-gs_frame_width/2, 0, 32 + 1,
				-gs_frame_width/2, -gs_frame2_thk, 32 + 1,
				gs_frame_width/2 - gs_rebate_width, -gs_frame2_thk, 32 + 1,
				gs_frame_width/2 - gs_rebate_width, -gs_frame2_thk + gs_rebate_depth, 32 + 1,
				gs_frame_width/2, -gs_frame2_thk + gs_rebate_depth, 32 + 1,
				gs_frame_width/2, 0, -1
		endif
		del 1

		!glass line
		if iMullionStyle_01 <> MULLION_SOLID_PANEL then
			pen gs_pen_2D
			line_property 0
			line2 gs_MidPane_w/2-gs_frame_width/2, 0, -gs_MidPane_w/2+gs_frame_width/2, 0
			line2 gs_MidPane_w/2-gs_frame_width/2, -gs_frame2_thk, -gs_MidPane_w/2+gs_frame_width/2, -gs_frame2_thk

			if iSymbolGlassType = SYMBGLASS_DOUBLEGLASS then
				poly2_b 4, 1+2+4+16+32, gs_penFr_fg, gs_penFr_bg,
					gs_MidPane_w/2-gs_frame_width/2, -gs_frame2_thk/2 - gs_glass_thk / 2, 32 + 1,
					-gs_MidPane_w/2+gs_frame_width/2, -gs_frame2_thk/2 - gs_glass_thk / 2, 0,
					-gs_MidPane_w/2+gs_frame_width/2, -gs_frame2_thk/2 + gs_glass_thk / 2, 32 + 1,
					gs_MidPane_w/2-gs_frame_width/2, -gs_frame2_thk/2 + gs_glass_thk / 2, 0
			else
				line2 gs_MidPane_w/2-gs_frame_width/2, -gs_frame2_thk/2, -gs_MidPane_w/2+gs_frame_width/2, -gs_frame2_thk/2
			endif
		endif

		! cover fill patch

		fill gs_fillShCover
		poly2_b 4, 1+2+4+16+32, gs_penShCov_fg, gs_penShCov_bg,
				gs_MidPane_w/2-gs_frame_width/2, 	0,	0,
				gs_MidPane_w/2-gs_frame_width/2, 	-gs_frame2_thk, 0,
				-gs_MidPane_w/2+gs_frame_width/2, 	-gs_frame2_thk, 0,
				-gs_MidPane_w/2+gs_frame_width/2,	0,	0

		del 1

		add2 -(gs_SLight_w - gs_leftSLight_w)/2, 0
		poly2_b 4, 1+2+4+16+32, gs_penShCov_fg, gs_penShCov_bg,
				gs_MidPane_w/2+gs_frame_width/2-gs_rebate_width, 	-gs_frame2_thk,	0,
				gs_MidPane_w/2+gs_frame_width/2-gs_rebate_width, 	-gs_frame_thk+gs_frame2_thk, 0,
				-gs_MidPane_w/2-gs_frame_width/2+gs_rebate_width, 	-gs_frame_thk+gs_frame2_thk, 0,
				-gs_MidPane_w/2-gs_frame_width/2+gs_rebate_width,	-gs_frame2_thk,	0
		del 1

		if iMullionStyle_01 = MULLION_SOLID_PANEL then
			fill gs_fillSh
			line_property 2
			poly2_b 4, 1 + 2 * (gs_fillSh > 0) + 4 + 16 + 32, gs_penSh_fg, gs_penSh_bg,
				gs_MidPane_w/2-gs_frame_width/2, -gs_frame_thk, 1,
				gs_MidPane_w/2-gs_frame_width/2, -gs_frame_thk + gs_sash_thk, 1,
				-gs_MidPane_w/2+gs_frame_width/2, -gs_frame_thk + gs_sash_thk, 1,
				-gs_MidPane_w/2+gs_frame_width/2, -gs_frame_thk, 1
		endif
	else
		add2 -gs_MidPane_w/2, 0
		fill gs_fillFr

		if gs_optype_m_09 = SASH_FIXED & not(iLoD2D = SYMBW_D_REBATEONGLASS) then
			poly2_b 7, 1+2+4+16+32, gs_penFr_fg, gs_penFr_bg,
				-gs_frame_width/2, 0, 32 + 1,
				gs_frame_width/2, 0, 32 + 1,
				gs_frame_width/2, -gs_frame2_thk + gs_rebate_depth, 32 + 1,
				gs_frame_width/2 - gs_rebate_width, -gs_frame2_thk + gs_rebate_depth, 32 + 1,
				gs_frame_width/2 - gs_rebate_width, -gs_frame2_thk, 32 + 1,
				-gs_frame_width/2, -gs_frame2_thk, 32 + 1,
				-gs_frame_width/2, 0, -1
		else
			poly2_b 9, 1+2+4+16+32, gs_penFr_fg, gs_penFr_bg,
				-gs_frame_width/2, 0, 32 + 1,
				gs_frame_width/2, 0, 32 + 1,
				gs_frame_width/2, -gs_frame2_thk + gs_rebate_depth, 32 + 1,
				gs_frame_width/2 - gs_rebate_width, -gs_frame2_thk + gs_rebate_depth, 32 + 1,
				gs_frame_width/2 - gs_rebate_width, -gs_frame2_thk, 32 + 1,
				-gs_frame_width/2 + gs_rebate_width, -gs_frame2_thk, 32 + 1,
				-gs_frame_width/2 + gs_rebate_width, -gs_frame2_thk + gs_rebate_depth, 32 + 1,
				-gs_frame_width/2, -gs_frame2_thk + gs_rebate_depth, 32 + 1,
				-gs_frame_width/2, 0, -1
		endif
		del 1

		add2 gs_MidPane_w/2, 0
		if gs_optype_m_05 = SASH_FIXED & not(iLoD2D = SYMBW_D_REBATEONGLASS) then
			poly2_b 7, 1+2+4+16+32, gs_penFr_fg, gs_penFr_bg,
				-gs_frame_width/2, 0, 32 + 1,
				gs_frame_width/2, 0, 32 + 1,
				gs_frame_width/2, -gs_frame2_thk, 32 + 1,
				-gs_frame_width/2 + gs_rebate_width, -gs_frame2_thk, 32 + 1,
				-gs_frame_width/2 + gs_rebate_width, -gs_frame2_thk + gs_rebate_depth, 32 + 1,
				-gs_frame_width/2, -gs_frame2_thk + gs_rebate_depth, 32 + 1,
				-gs_frame_width/2, 0, -1
		else
			poly2_b 9, 1+2+4+16+32, gs_penFr_fg, gs_penFr_bg,
				-gs_frame_width/2, 0, 32 + 1,
				gs_frame_width/2, 0, 32 + 1,
				gs_frame_width/2, -gs_frame2_thk + gs_rebate_depth, 32 + 1,
				gs_frame_width/2 - gs_rebate_width, -gs_frame2_thk + gs_rebate_depth, 32 + 1,
				gs_frame_width/2 - gs_rebate_width, -gs_frame2_thk, 32 + 1,
				-gs_frame_width/2 + gs_rebate_width, -gs_frame2_thk, 32 + 1,
				-gs_frame_width/2 + gs_rebate_width, -gs_frame2_thk + gs_rebate_depth, 32 + 1,
				-gs_frame_width/2, -gs_frame2_thk + gs_rebate_depth, 32 + 1,
				-gs_frame_width/2, 0, -1
		endif
		del 1

		! cover fill patch
		add2 0, gs_frame_thk-gs_frame2_thk
		fill gs_fillShCover
		if iLoD2D = SYMBW_D_REBATEONGLASS & gs_optype_m_01 = SASH_FIXED then
			poly2_b 12, 1+2+4+16+32, gs_penShCov_fg, gs_penShCov_bg,
					-gs_MidPane_w/2-gs_frame_width/2+gs_rebate_width,	-gs_frame2_thk, 0,
					-gs_MidPane_w/2-gs_frame_width/2+gs_rebate_width,	-gs_frame_thk+gs_frame2_thk, 0,
					-gs_MidPane_w/2+gs_frame_width/2,					-gs_frame_thk+gs_frame2_thk, 0,
					-gs_MidPane_w/2+gs_frame_width/2,					-gs_frame_thk+gs_rebate_depth, 0,
					-gs_MidPane_w/2+gs_frame_width/2-gs_rebate_width,	-gs_frame_thk+gs_rebate_depth, 0,
					-gs_MidPane_w/2+gs_frame_width/2-gs_rebate_width,	-gs_frame_thk, 0,

					gs_MidPane_w/2-gs_frame_width/2+gs_rebate_width,	-gs_frame_thk, 0,
					gs_MidPane_w/2-gs_frame_width/2+gs_rebate_width,	-gs_frame_thk+gs_rebate_depth, 0,
					gs_MidPane_w/2-gs_frame_width/2,					-gs_frame_thk+gs_rebate_depth, 0,
					gs_MidPane_w/2-gs_frame_width/2,					-gs_frame_thk+gs_frame2_thk, 0,
					gs_MidPane_w/2+gs_frame_width/2-gs_rebate_width,	-gs_frame_thk+gs_frame2_thk, 0,
					gs_MidPane_w/2+gs_frame_width/2-gs_rebate_width,	-gs_frame2_thk, 0

			line2	-gs_MidPane_w/2+gs_frame_width/2-gs_rebate_width,	-gs_frame_thk,
					gs_MidPane_w/2-gs_frame_width/2+gs_rebate_width,	-gs_frame_thk
			line2	-gs_MidPane_w/2+gs_frame_width/2,					-gs_frame_thk+gs_rebate_depth,
					gs_MidPane_w/2-gs_frame_width/2,					-gs_frame_thk+gs_rebate_depth
		else
			poly2_b 4, 1+2+4+16+32, gs_penShCov_fg, gs_penShCov_bg,
					gs_MidPane_w/2+gs_frame_width/2-gs_rebate_width, 	-gs_frame2_thk,	0,
					gs_MidPane_w/2-gs_frame_width/2+gs_rebate_width, 	-gs_frame2_thk,	0,
					gs_MidPane_w/2-gs_frame_width/2+gs_rebate_width, 	-gs_frame_thk+gs_frame2_thk, 0,
					gs_MidPane_w/2+gs_frame_width/2-gs_rebate_width, 	-gs_frame_thk+gs_frame2_thk, 0
	
			poly2_b 4, 1+2+4+16+32, gs_penShCov_fg, gs_penShCov_bg,
					-gs_MidPane_w/2-gs_frame_width/2+gs_rebate_width, 	-gs_frame2_thk,	0,
					-gs_MidPane_w/2+gs_frame_width/2-gs_rebate_width, 	-gs_frame2_thk,	0,
					-gs_MidPane_w/2+gs_frame_width/2-gs_rebate_width, 	-gs_frame_thk+gs_frame2_thk, 0,
					-gs_MidPane_w/2-gs_frame_width/2+gs_rebate_width, 	-gs_frame_thk+gs_frame2_thk, 0
		endif
		del 1
	endif
	del 1
endif

if iLoD2D < SYMBW_D_SGLASS then
	if iLoD2D > SYMBW_S_9 then
		_contStatus = (iLoD2D = SYMBW_M_FRAMESASH)

		_bLeftSashOpening	= (gs_optype_m_05 <> SASH_FIXED)
		_bRightSashOpening	= (gs_optype_m_09 <> SASH_FIXED)

		_bSymmetric = ((gs_iPanesConfig = PANESCONFIG_SYMM) | ((gs_iPanesConfig = PANESCONFIG_UNIFORM) & (_bLeftSashOpening = _bRightSashOpening)))

		_leftFrameDistCenter	=  gs_MidPane_w/2 - (not(_bSymmetric)) * (2 * (gs_optype_m_05 <> SASH_FIXED) - 1) * (gs_frame_width - 2 * gs_rebate_width)
		_rightFrameDistCenter	= -gs_MidPane_w/2 + (not(_bSymmetric)) * (2 * (gs_optype_m_09 <> SASH_FIXED) - 1) * (gs_frame_width - 2 * gs_rebate_width)

		add2 _rightFrameDistCenter, -gs_frame_thk

		poly2_b 5, 1+2+4+16+32, gs_penFr_fg, gs_penFr_bg,
			gs_frame_width/2 - gs_rebate_width,		0,							_contStatus,
			gs_frame_width/2 - gs_rebate_width,		gs_frame_thk-gs_frame2_thk,	32+1,
			-gs_frame_width/2 + gs_rebate_width,	gs_frame_thk-gs_frame2_thk,	_contStatus,
			-gs_frame_width/2 + gs_rebate_width,	0,							32+1,
			gs_frame_width/2 - gs_rebate_width,		0,							-1

		del 1

		add2 _leftFrameDistCenter, -gs_frame_thk

		poly2_b 5, 1+2+4+16+32, gs_penFr_fg, gs_penFr_bg,
			gs_frame_width/2 - gs_rebate_width,		0,							_contStatus,
			gs_frame_width/2 - gs_rebate_width,		gs_frame_thk-gs_frame2_thk,	32+1,
			-gs_frame_width/2 + gs_rebate_width,	gs_frame_thk-gs_frame2_thk,	_contStatus,
			-gs_frame_width/2 + gs_rebate_width,	0,							32+1,
			gs_frame_width/2 - gs_rebate_width,		0,							-1

		del 1
	else
		if iLoD2D <> SYMBW_S_CENTERLINE and (iLoD2D <> SYMBW_S_1LINE | (iLoD2D = SYMBW_S_1LINE and not(bOneLineSymbolin2D))) then
			pen gs_pen_2D
			line_property 0
			add2 0, -gs_frame2_thk
			line2 -gs_MidPane_w/2 - gs_rebate_width, 0, -gs_MidPane_w/2 + gs_frame_width - gs_rebate_width, 0
			line2 gs_MidPane_w/2 + gs_rebate_width, 0, gs_MidPane_w/2 - gs_frame_width + gs_rebate_width, 0
			del 1
		endif
	endif
endif


