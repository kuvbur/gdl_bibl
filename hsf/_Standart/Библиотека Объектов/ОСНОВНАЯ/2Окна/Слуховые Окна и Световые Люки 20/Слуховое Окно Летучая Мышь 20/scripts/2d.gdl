

! =============================================================================
! GS Skylight Functions
! =============================================================================

call "GS Skylight Functions",
	parameters all	bEnableLining			= bEnableLining,
					bEnableEdgeTypesUpper	= bEnableEdgeTypesUpper,
					bEnableEdgeTypesLower	= bEnableEdgeTypesLower,
	returned_parameters	iLoD2D,
		gs_opLinePen, gs_openedSashPen, gs_iSwingType, gs_swingLineType, gs_opline_style_m

if iLoD2D = SYMBS_OFF | iLoD2D = SYMBS_S_1 then end


! Horizontal and low Roof
if abs(ac_roofang) < EPS | ac_roofang > 90+EPS then
	rect2 -A/2, 0, A/2, B*COS(ac_roofang)

	end
endif


! ==============================================================================
! Symbolic 2D
! ==============================================================================

pen gs_cont_pen
fill gs_fill_type

hotspot2 0, 0
hotspot2 -a/2, -0.08
hotspot2 a/2, -0.08
hotspot2 -a/2, ttt*cos(ac_roofang)
hotspot2 a/2, ttt*cos(ac_roofang)

hotspot2 -a/4-0.01, 0
hotspot2 a/4+0.01, 0
hotspot2 -a/4-0.01, ttt*cos(ac_roofang)
hotspot2 a/4+0.01, ttt*cos(ac_roofang)

rect2 -a/2, -0.08,a/2, ttt*cos(ac_roofang)

if gs_back_pen<>0 then
	mask=1+2+4+64
else
	mask=1+4
endif

poly2_b	5, mask, gs_fill_pen, gs_back_pen,
	   -a/2, -0.08, 1,
		a/2, -0.08, 1,
		a/2, ttt*cos(ac_roofang), 1,
	   -a/2, ttt*cos(ac_roofang), 1,
	   -a/2, -0.08, -1

line_type 4

if iLoD2D = SYMBS_D_1 | iLoD2D = SYMBS_D_2 then
	line2 -a/4-0.01, 0, a/4+0.01, 0
	line2 -a/4-0.01, 0,
		-a/4-0.01, ttt*cos(ac_roofang)
	line2 a/4+0.01, 0,
		a/4+0.01, ttt*cos(ac_roofang)
endif


!**** Parameter Kontrolle - Neigungen und Konstr.starke

if ac_roofang >= 90 or ac_roofang <= 0 then ac_roofang = 45
if ng >= ac_roofang then ng = ac_roofang-20

if ac_roofthk < 0.025+0.05*sin(ng) then ac_roofthk = 0.025+0.05*sin(ng)



km1 = 0.08*tan(ac_roofang)

dr1 = (0.08-0.025*sin(ng)) * tan(ng) - 0.025 * cos(ng)

dr2 = (ac_roofthk-0.025 - 0.05*sin(ng)) / cos(ng) - dr1 + 0.01

dr3 = 0.025 * cos(ng)


!**** Hauptradius und Winkel


rr = ( ((hh+km1)/2)^2 + (a/4)^2 ) / 2 / ((hh+km1)/2)

ww = 90 - acs(a/4/rr)


ra=ac_roofang

yy=hh*(tan(ra)/tan(ng))/((tan(ra)/tan(ng))-1)+0.08*tan(ra)
xx=(yy/tan(ra)+0.08)*(-1)

end
if  a > 4*(rr-dr2) then
	text2 0, 0, `Неправильные параметры!`
end
endif

if hh-rr + (rr-dr2-0.07) * sin(acs((a/4-0.07)/(rr-dr2-0.07))) <= 0.12 then
	text2 0, 0, `Неправильные параметры!`
end
endif
