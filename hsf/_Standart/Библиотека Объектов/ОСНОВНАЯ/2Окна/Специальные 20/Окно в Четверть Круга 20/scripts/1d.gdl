
! Contact person: <SzL, NJ>

EPS = 0.0001

! gs_optype_m
SASH_FIXED					= 1		! Fixed Glass
SASH_FIXED_SCREW			= 2		! Fixed Sash
SASH_SIDE_HUNG				= 3		! Side Hung
SASH_SIDE_HUNG_M			= 4		! Side Hung Mirrored
SASH_TILT_TURN				= 5		! Tilt and Turn
SASH_TILT_TURN_M			= 6		! Tilt and Turn Mirrored
SASH_BOTTOM_HUNG			= 7		! Bottom Hung
SASH_TOP_HUNG				= 8		! Top Hung
SASH_HOR_PIVOT				= 9		! Horizontal Pivot Hung
SASH_VER_PIVOT				= 10	! Vertical Pivotted
SASH_TILT_SLIDE				= 11	! Tilt and Slide
SASH_LEFT_SLIDING			= 12	! Left Sliding
SASH_RIGHT_SLIDING			= 13	! Right Sliding
SASH_UP_SLIDING				= 14	! Sliding Up
SASH_DOWN_SLIDING			= 15	! Sliding Down
SASH_VER_PIVOT_M			= 16	! Vertical Pivotted Mirrored
SASH_FIXED_SLIDE			= 17	! Fixed Sliding Sash
SASH_DOUBLE_SIDE_HUNG		= 18	! Double Sash
SASH_DOUBLE_TILT_TURN		= 19	! Double Tilt and Turn
SASH_DOUBLE_TILT_TURN_M		= 20	! Double Tilt and Turn Mirrored
SASH_SLIDING_HOR			= 21	! Sliding
SASH_SLIDING_HOR_M			= 22	! Sliding Mirrored
SASH_DOUBLE_SLIDING_HOR		= 23	! Double Sliding
SASH_DOUBLE_SLIDING_HOR_M	= 24	! Double Sliding Mirrored
SASH_SLIDING_VER			= 25	! Single Hung
SASH_DOUBLE_SLIDING_VER		= 26	! Double Hung

! iMullionStyle
MULLION_NONE			= 1
MULLION_HVGRID			= 2
MULLION_EDITABLEGRID	= 3
MULLION_CUSTOM			= 4
MULLION_PRAIRIE			= 5
MULLION_DIVIDED			= 6
MULLION_SUNBURST_1		= 7
MULLION_SUNBURST_2		= 8
MULLION_SUNBURST_3		= 9
MULLION_SUNBURST_4		= 10
MULLION_SUNBURST_5		= 11
MULLION_SUNBURST_6		= 12
!MULLION_SOLID_GLAZED	= 13
!MULLION_DIVIDED_FRAME	= 14
MULLION_SOLID_PANEL		= 15

! iMullionPosition
MULLION_OUTSIDE		= 1
MULLION_INSIDE		= 2
MULLION_THROUGHOUT	= 3

! iDWDet3D
DETLEVEL_DW3D_SCALESENS    = 1
DETLEVEL_DW3D_DETAILED     = 2
DETLEVEL_DW3D_SIMPLE       = 3
DETLEVEL_DW3D_OFF          = 4
DETLEVEL_DW3D_CHI_SIMPLE   = 5
DETLEVEL_DW3D_CHI_DETAILED = 6

! iTypeDemolitionFill
RENOVATION_FILL_EXIST		= 1
RENOVATION_FILL_DEMOLISHED	= 2
RENOVATION_FILL_NEW			= 3
RENOVATION_FILL_NEW_FULL	= 4

! gs_SashText_typ_num
MITERED_JOINT = 1
BUTT_JOINT    = 2


! =============================================================================
! Migration
! =============================================================================

if GLOB_SCRIPT_TYPE = 7 | GLOB_SCRIPT_TYPE = 8 then goto "MasterEnd"	! forward migration, backward migration

! =============================================================================
! Main Definitions
! =============================================================================

gs_IsCurved			= 0
bParalellInCurvedWalls = 0
bDisabeMirroring	= 0
iWindowShape		= 9		! SHAPE_QUARTERROUND

gs_fillFr	= gs_fillFr * gs_bFills
gs_fillSash	= gs_fillSash * gs_bFills


! =============================================================================
! Casement IDs
! =============================================================================

dim CasementIDArray[3][3]
CasementIDArray[1][1]	= 0
CasementIDArray[1][2]	= 0
CasementIDArray[1][3]	= 0
CasementIDArray[2][1]	= 0
CasementIDArray[2][2]	= 1
CasementIDArray[2][3]	= 0
CasementIDArray[3][1]	= 0
CasementIDArray[3][2]	= 0
CasementIDArray[3][3]	= 0

dim CasementTypeArray[3][3]
CasementTypeArray[1][1]	= 1
CasementTypeArray[1][2]	= 1
CasementTypeArray[1][3]	= 1
CasementTypeArray[2][1]	= 1
CasementTypeArray[2][2]	= 1
CasementTypeArray[2][3]	= 1
CasementTypeArray[3][1]	= 1
CasementTypeArray[3][2]	= 1
CasementTypeArray[3][3]	= 1

dim CasementShapeArray[3][3]
CasementShapeArray[1][1]	= 1
CasementShapeArray[1][2]	= 1
CasementShapeArray[1][3]	= 1
CasementShapeArray[2][1]	= 1
CasementShapeArray[2][2]	= 11	! SASH_SHAPE_QUARTERROUND
CasementShapeArray[2][3]	= 1
CasementShapeArray[3][1]	= 1
CasementShapeArray[3][2]	= 1
CasementShapeArray[3][3]	= 1


! =============================================================================
! Localization
! =============================================================================

dim stDetail[6]
	stDetail[1] = `Зависит от Масштаба`
	stDetail[2] = `Детальный`
	stDetail[3] = `Простой`
	stDetail[4] = `Откл.`
	stDetail[5] = `Китайский Простой`
	stDetail[6] = `Китайский Детальный`

dim stSashType[17]
	stSashType[1] = `Без Раскладки`
	stSashType[2] = `Г/В-Раскладка`
	stSashType[3] = `Редактируемая Раскладка`
	stSashType[4] = `Специальная Створка`
	stSashType[5] = `Стиль Прерия`
	stSashType[6] = `Разделенный`
	stSashType[7] = `Солнечные Лучи 1`
	stSashType[8] = `Солнечные Лучи 2`
	stSashType[9] = `Солнечные Лучи 3`
	stSashType[10] = `Солнечные Лучи 4`
	stSashType[11] = `Солнечные Лучи 5`
	stSashType[12] = `Солнечные Лучи 6`
	stSashType[13] = `Сплошное Остекление`
	stSashType[14] = `Разделенная Рама`
	stSashType[15] = `Сплошная Панель`
	stSashType[16] = `Вентиляционная Створка`
	stSashType[17] = `Французская Панель`

dim stMullionPosition[3]
	stMullionPosition[1] = `Снаружи`
	stMullionPosition[2] = `Внутри`
	stMullionPosition[3] = `Посередине`

dim stOpeningType[26]
	stOpeningType[1] = `Фиксированное Остекление`
	stOpeningType[2] = ``
	stOpeningType[3] = `Распашная`
	stOpeningType[4] = `Распашная Зеркальная`
	stOpeningType[5] = `Наклонно-Поворотная `
	stOpeningType[6] = `Наклонно-Поворотная Зеркальная`
	stOpeningType[7] = `Нижнеподвесная`
	stOpeningType[8] = `Верхнеподвесная`
	stOpeningType[9] = `Среднеповоротная Горизонтальная`
	stOpeningType[10] = `Среднеповоротная Вертикальная`
	stOpeningType[11] = ``
	stOpeningType[12] = ``
	stOpeningType[13] = ``
	stOpeningType[14] = ``
	stOpeningType[15] = ``
	stOpeningType[16] = `Среднеповоротная Вертикальная Зеркальная`
	stOpeningType[17] = ``
	stOpeningType[18] = `Двойная Створка`
	stOpeningType[19] = `Двойная Поворотно-Откидная`
	stOpeningType[20] = `Двойная Поворотно-Откидная Зеркальная`
	stOpeningType[21] = `Раздвижная`
	stOpeningType[22] = `Раздвижная Зеркальная`
	stOpeningType[23] = `Двойная Раздвижная`
	stOpeningType[24] = `Двойная Раздвижная Зеркальная`
	stOpeningType[25] = `Подъемная`
	stOpeningType[26] = `Подъемно-Опускная`


! =============================================================================


h=gs_frame_width            !"Shoulder" height



!Straight or Inclined Wall

if abs(WIDO_SILL-(WALL_THICKNESS-WIDO_FRAME_THICKNESS))<EPS then tim=1
if abs(WIDO_SILL)<EPS then     tom=4

!Curved Wall

if WIDO_ORIG_DIST<0  then
	btim1=14
	btim2=11
	btim3=11
	btim4=14
	btim1c=78
	btim2c=75
	btim3c=75
	btim4c=78

	if WIDO_REVEAL_SIDE>0 then
		btim1=11
		btim2=14
		btim3=14
		btim4=11
		btim1c=75
		btim2c=78
		btim3c=78
		btim4c=75
	endif
endif

if WIDO_ORIG_DIST>0  then
	btim1=11
	btim2=14
	btim3=14
	btim4=11
	btim1c=75
	btim2c=78
	btim3c=78
	btim4c=75

	if WIDO_REVEAL_SIDE>0 then
		btim1=14
		btim2=11
		btim3=11
		btim4=14
		btim1c=78
		btim2c=75
		btim3c=75
		btim4c=78
	endif
endif

gs_trim_inside_uniform = 0
gs_trim_outside_uniform = 0


gs_rebate_width = 0

! =============================================================================
! Sash Sizes
! =============================================================================

dim sashWidthArray[3][3]
dim sashHeightArray[3][3]
dim sashPosXArray[3][3]
dim sashPosYArray[3][3]
for i=1 to 3
	for j=1 to 3
		sashWidthArray[i][j]	= 0
		sashHeightArray[i][j]	= 0
		sashPosXArray[i][j]		= 0
		sashPosYArray[i][j]		= 0
	next j
next i

sashWidthArray[2][2] = ac_unit_width - 2 * (gs_frame_width + gs_rebate_width)
sashHeightArray[2][2] = ac_unit_height - 2 * (gs_frame_width + gs_rebate_width)

"MasterEnd":
