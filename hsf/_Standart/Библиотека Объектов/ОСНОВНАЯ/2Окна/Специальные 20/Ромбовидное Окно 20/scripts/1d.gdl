
! iWindowShape:
SHAPE_RECTANGULAR			= 0
SHAPE_ARCHED				= 1
SHAPE_ROUND					= 2
SHAPE_EYEBROWS				= 3
SHAPE_HALFCIRCLE			= 4 	! straight side is horizontal
SHAPE_MULTISIDE				= 5
SHAPE_OCTAGONAL				= 6
SHAPE_HALFARCH				= 7
SHAPE_PENTAGON				= 8
SHAPE_QUARTERROUND			= 9
SHAPE_HALFROUND				= 10 	! straight side is vertical
SHAPE_TRAPEZOID				= 11
SHAPE_TRIANGLE				= 12
SHAPE_GOTHICARCH			= 13
SHAPE_ELLIPSEARCH			= 14
SHAPE_ROMBUS				= 15
SHAPE_HORSESHOE				= 16
SHAPE_OGEECENTERED			= 17
SHAPE_SARACENIC				= 18
SHAPE_T						= 19
SHAPE_HALF_T_LEFT			= 20
SHAPE_ARCHED_T				= 21
SHAPE_ARCHED_HALF_T_LEFT	= 22
SHAPE_PARALLELOGRAM			= 23
SHAPE_ELLIPSE				= 24
SHAPE_CORNER_TRIANGLE		= 25
SHAPE_QUARTERROUND_NOFRAME	= 26
SHAPE_HALF_T_RIGHT			= 27
SHAPE_ARCHED_HALF_T_RIGHT	= 28

! iWindowType:
WIN_HistoricWindowSingle2		= 10
WIN_HistoricWindowSingle		= 11
WIN_HistoricWindowDouble		= 12
WIN_HistoricWindowTriple		= 13
WIN_HistoricWindowSegmented		= 14
WIN_HistoricWindowTripleArched	= 15
WIN_W2HorizontalSlide			= 16
WIN_W4HorizontalSlide			= 17
WIN_Curved						= 18
WIN_Bow							= 19
WIN_SplayBay					= 20
WIN_SquareBay					= 21
WIN_Ribbon						= 22
WIN_WSingleHung1				= 23
WIN_WSingleHung2				= 24
WIN_WSingleHung3				= 25
WIN_WDoubleHung1				= 26
WIN_WDoubleHung2				= 27
WIN_WDoubleHung3				= 28
WIN_WRound						= 29
WIN_WOval						= 30
WIN_WMultiside					= 31
WIN_WHalfRound					= 32
WIN_WQuarterRound 				= 33
WIN_WPentagon					= 34
WIN_WTriangle					= 35
WIN_WEyebrows					= 36
WIN_WArched						= 37
WIN_WTrapezoid					= 38
WIN_WTrapezoidDoubleSash		= 39
WIN_VentWindow					= 40
WIN_2SashSliding				= 41
WIN_MultisashHorizontal			= 42
WIN_MultisashVertical			= 43
WIN_GlassBlock					= 44
WIN_TerraceDoorSWE				= 45
WIN_W3HorizontalSlide			= 46
WIN_W6HorizontalSlide			= 47
WIN_VentilationBrick			= 48
WIN_Rhomb						= 49
WIN_Skewed						= 50

! iWindowClass:
WINCLASS_NORMAL				= 1
WINCLASS_HISTORIC			= 2
WINCLASS_SINGLE_HUNG		= 3
WINCLASS_DOUBLE_HUNG		= 4
WINCLASS_HORIZONTAL_SLIDING	= 5
WINCLASS_SPECIAL			= 6
WINCLASS_DOORSASH			= 7
WINCLASS_MULTISASH			= 8
WINCLASS_SHELL				= 10

! gs_optype_m
SASH_FIXED					= 1		! Fixed Glass
SASH_FIXED_SCREW			= 2		! Fixed Sash
SASH_SIDE_HUNG				= 3		! Side Hung
SASH_SIDE_HUNG_M			= 4		! Side Hung Mirrored
SASH_TILT_TURN				= 5		! Tilt and Turn
SASH_TILT_TURN_M			= 6		! Tilt and Turn Mirrored
SASH_BOTTOM_HUNG			= 7		! Bottom Hung
SASH_TOP_HUNG				= 8		! Top Hung
SASH_HOR_PIVOT				= 9		! Horizontal Pivot Hung
SASH_VER_PIVOT				= 10	! Vertical Pivotted
SASH_TILT_SLIDE				= 11	! Tilt and Slide
SASH_LEFT_SLIDING			= 12	! Left Sliding
SASH_RIGHT_SLIDING			= 13	! Right Sliding
SASH_UP_SLIDING				= 14	! Sliding Up
SASH_DOWN_SLIDING			= 15	! Sliding Down
SASH_VER_PIVOT_M			= 16	! Vertical Pivotted Mirrored
SASH_FIXED_SLIDE			= 17	! Fixed Sliding Sash
SASH_DOUBLE_SIDE_HUNG		= 18	! Double Sash
SASH_DOUBLE_TILT_TURN		= 19	! Double Tilt and Turn
SASH_DOUBLE_TILT_TURN_M		= 20	! Double Tilt and Turn Mirrored
SASH_SLIDING_HOR			= 21	! Sliding
SASH_SLIDING_HOR_M			= 22	! Sliding Mirrored
SASH_DOUBLE_SLIDING_HOR		= 23	! Double Sliding
SASH_DOUBLE_SLIDING_HOR_M	= 24	! Double Sliding Mirrored
SASH_SLIDING_VER			= 25	! Single Hung
SASH_DOUBLE_SLIDING_VER		= 26	! Double Hung

! const values for parameter: iDWDet3D
DETLEVEL_DW3D_SCALESENS    = 1
DETLEVEL_DW3D_DETAILED     = 2
DETLEVEL_DW3D_SIMPLE       = 3
DETLEVEL_DW3D_OFF          = 4
DETLEVEL_DW3D_CHI_SIMPLE   = 5
DETLEVEL_DW3D_CHI_DETAILED = 6

! iSashShape:
SASH_SHAPE_RECTANGULAR	= 1
SASH_SHAPE_ARCHED		= 2
SASH_SHAPE_HALFROUND	= 3
SASH_SHAPE_ROUND		= 4
SASH_SHAPE_OVAL			= 5
SASH_SHAPE_MULTISIDE	= 6
SASH_SHAPE_TRAPEZOID	= 7
SASH_SHAPE_PENTAGON		= 8
SASH_SHAPE_TRIANGLE		= 9
SASH_SHAPE_EYEBROWS		= 10
SASH_SHAPE_QUARTERROUND	= 11
SASH_SHAPE_RHOMBUS		= 12

! const values for parameter: iTypeDemolitionFill
RENOVATION_FILL_EXIST		= 1
RENOVATION_FILL_DEMOLISHED	= 2
RENOVATION_FILL_NEW			= 3
RENOVATION_FILL_NEW_FULL	= 4

! =============================================================================
! Localization
! =============================================================================

dim stDetail[6]
	stDetail[1] = `Зависит от Масштаба`
	stDetail[2] = `Детальный`
	stDetail[3] = `Простой`
	stDetail[4] = `Откл.`
	stDetail[5] = `Китайский Простой`
	stDetail[6] = `Китайский Детальный`


dim stSashType[16]
	stSashType[1] = `Без Раскладки`
	stSashType[2] = `Г/В-Раскладка`
	stSashType[3] = `Редактируемая Раскладка`
	stSashType[4] = `Специальная Створка`
	stSashType[5] = `Стиль Прерия`
	stSashType[6] = `Разделенный`
	stSashType[7] = `Солнечные Лучи 1`
	stSashType[8] = `Солнечные Лучи 2`
	stSashType[9] = `Солнечные Лучи 3`
	stSashType[10] = `Солнечные Лучи 4`
	stSashType[11] = `Солнечные Лучи 5`
	stSashType[12] = `Солнечные Лучи 6`
	stSashType[13] = `Сплошное Остекление`
	stSashType[14] = `Разделенная Рама`
	stSashType[15] = `Сплошная Панель`
	stSashType[16] = `Вентиляционная Створка`

dim stMullionPosition[3]
	stMullionPosition[1] = `Снаружи`
	stMullionPosition[2] = `Внутри`
	stMullionPosition[3] = `Посередине`

dim stOpeningType[26]
	stOpeningType[1] = `Фиксированное Остекление`
	stOpeningType[2] = `Фиксированная Створка`
	stOpeningType[3] = `Распашная`
	stOpeningType[4] = `Распашная Зеркальная`
	stOpeningType[5] = `Наклонно-Поворотная `
	stOpeningType[6] = `Наклонно-Поворотная Зеркальная`
	stOpeningType[7] = `Нижнеподвесная`
	stOpeningType[8] = `Верхнеподвесная`
	stOpeningType[9] = `Среднеповоротная Горизонтальная`
	stOpeningType[10] = `Среднеповоротная Вертикальная`
	stOpeningType[11] = ``
	stOpeningType[12] = ``
	stOpeningType[13] = ``
	stOpeningType[14] = ``
	stOpeningType[15] = ``
	stOpeningType[16] = `Среднеповоротная Вертикальная Зеркальная`
	stOpeningType[17] = ``
	stOpeningType[18] = `Двойная Створка`
	stOpeningType[19] = `Двойная Поворотно-Откидная`
	stOpeningType[20] = `Двойная Поворотно-Откидная Зеркальная`
	stOpeningType[21] = `Раздвижная`
	stOpeningType[22] = `Раздвижная Зеркальная`
	stOpeningType[23] = `Двойная Раздвижная`
	stOpeningType[24] = `Двойная Раздвижная Зеркальная`
	stOpeningType[25] = `Подъемная`
	stOpeningType[26] = `Подъемно-Опускная`


! =============================================================================
! Main Definitions
! =============================================================================
EPS = 0.0001

gs_IsCurved					= 0
bParalellInCurvedWalls 		= 0
bDisabeMirroring			= 0
iWindowShape				= SHAPE_ROMBUS
iWindowType					= WIN_Rhomb
iWindowClass				= WINCLASS_SPECIAL
_numSides					= 4
gs_rebate_width 			= 0

_fillFr			= gs_bFills * gs_fillFr
_penFr_fg		= gs_bFills * gs_penFr_fg
_penFr_bg		= gs_bFills * gs_penFr_bg

_fillSash		= gs_bFills * gs_fillSash
_penSash_fg		= gs_bFills * gs_penSash_fg
_penSash_bg		= gs_bFills * gs_penSash_bg

_fillShCover	= gs_bFills * gs_fillShCover
_penShCov_fg	= gs_bFills * gs_penShCov_fg
_penShCov_bg 	= gs_bFills * gs_penShCov_bg


! =============================================================================
! Calculations
! =============================================================================

ratio_x = (sqr(ac_wallhole_width^2 + ac_wallhole_height^2)) / ac_wallhole_height 
ratio_y = (sqr(ac_wallhole_width^2 + ac_wallhole_height^2)) / ac_wallhole_width

toler_offsetX = ratio_x * gs_tolerance_left
toler_offsetY = ratio_y * gs_tolerance_left

frame_offsetX = ratio_x * gs_frame_width
frame_offsetY = ratio_y * gs_frame_width

rebate_offsetX = ratio_x * gs_rebate_width
rebate_offsetY = ratio_y * gs_rebate_width

real_ac_unit_width	= ac_wallhole_width - 2*toler_offsetX
real_ac_unit_height	= ac_wallhole_height - 2*toler_offsety


! =============================================================================
! Sash Sizes
! =============================================================================

dim sashWidthArray[3][3]
dim sashHeightArray[3][3]
dim sashPosXArray[3][3]
dim sashPosYArray[3][3]
for i=1 to 3
	for j=1 to 3
		sashWidthArray[i][j]	= 0
		sashHeightArray[i][j]	= 0
		sashPosXArray[i][j]		= 0
		sashPosYArray[i][j]		= 0
	next j
next i

! Main Sash ===================================================================

cavityTop	 = real_ac_unit_height - frame_offsetY + rebate_offsetY
cavityBottom = frame_offsetY - rebate_offsetY
cavityLeft	= -real_ac_unit_width/2 + frame_offsetX - rebate_offsetX
cavityRight	=  real_ac_unit_width/2 - frame_offsetX + rebate_offsetX
sashWidthArray[2][2]	= cavityRight - cavityLeft
sashHeightArray[2][2]	= cavityTop - cavityBottom
sashPosXArray[2][2]		= (cavityLeft + cavityRight)/2
sashPosYArray[2][2]		= cavityBottom

! =============================================================================
! Casement IDs
! =============================================================================

dim CasementIDArray[3][3]
CasementIDArray[1][1]	= 0
CasementIDArray[1][2]	= 0
CasementIDArray[1][3]	= 0
CasementIDArray[2][1]	= 0
CasementIDArray[2][2]	= 1
CasementIDArray[2][3]	= 0
CasementIDArray[3][1]	= 0
CasementIDArray[3][2]	= 0
CasementIDArray[3][3]	= 0

dim CasementTypeArray[3][3]
CasementTypeArray[1][1]	= 1
CasementTypeArray[1][2]	= 1
CasementTypeArray[1][3]	= 1
CasementTypeArray[2][1]	= 1
CasementTypeArray[2][2]	= 1
CasementTypeArray[2][3]	= 1
CasementTypeArray[3][1]	= 1
CasementTypeArray[3][2]	= 1
CasementTypeArray[3][3]	= 1

dim CasementShapeArray[3][3]
CasementShapeArray[1][1]	= 1
CasementShapeArray[1][2]	= 1
CasementShapeArray[1][3]	= 1
CasementShapeArray[2][1]	= 1
CasementShapeArray[2][2]	= SASH_SHAPE_RHOMBUS
CasementShapeArray[2][3]	= 1
CasementShapeArray[3][1]	= 1
CasementShapeArray[3][2]	= 1
CasementShapeArray[3][3]	= 1

