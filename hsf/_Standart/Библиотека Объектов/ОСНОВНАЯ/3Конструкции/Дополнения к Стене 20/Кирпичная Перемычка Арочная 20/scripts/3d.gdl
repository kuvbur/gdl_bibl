
IF gs_detlevel_3D_m = DLEV3D_OFF THEN END

IF gs_shadow=0 THEN SHADOW OFF
IF gs_shadow=1 THEN SHADOW ON

!!---- Hotspot Editing
unID=1

hotspot 0,0,0,unID,A2,1+128,A : unID=unID+1
hotspot -1,0,0,unID,A2,3,A : unID=unID+1
hotspot A2,0,0,unID,A2,2,A : unID=unID+1

hotspot 0,0,0,unID,A2,1+128,A : unID=unID+1
hotspot 1,0,0,unID,A2,3,A : unID=unID+1
hotspot -A2,0,0,unID,A2,2,A : unID=unID+1

hotspot 0,-B,0,unID,A2,1+128,A : unID=unID+1
hotspot -1,-B,0,unID,A2,3,A : unID=unID+1
hotspot A2,-B,0,unID,A2,2,A : unID=unID+1

hotspot 0,-B,0,unID,A2,1+128,A : unID=unID+1
hotspot 1,-B,0,unID,A2,3,A : unID=unID+1
hotspot -A2,-B,0,unID,A2,2,A : unID=unID+1

hotspot A2,0,0,unID,B,1+128 : unID=unID+1
hotspot A2,1,0,unID,B,3 : unID=unID+1
hotspot A2,-B,0,unID,B,2 : unID=unID+1

hotspot -A2,0,0,unID,B,1+128 : unID=unID+1
hotspot -A2,1,0,unID,B,3 : unID=unID+1
hotspot -A2,-B,0,unID,B,2 : unID=unID+1

hotspot 0,0,0,unID,ha,1+128 : unID=unID+1
hotspot 0,0,-1,unID,ha,3 : unID=unID+1
hotspot 0,0,ha,unID,ha,2 : unID=unID+1

hotspot 0,-B,0,unID,ha,1+128 : unID=unID+1
hotspot 0,-B,-1,unID,ha,3 : unID=unID+1
hotspot 0,-B,ha,unID,ha,2 : unID=unID+1
!!---- Hotspot Editing

alfa=asn(a/2/r)
addz ha-r
roty alfa

for i=1 to 3
	hotspot 0,0,r,unID,lb,1+256 : unID=unID+1
	hotspot 0,0,r-1,unID,lb,3 : unID=unID+1
	hotspot 0,0,r+lb,unID,lb,2 : unID=unID+1

	hotspot 0,-B,r,unID,lb,1+256 : unID=unID+1
	hotspot 0,-B,r-1,unID,lb,3 : unID=unID+1
	hotspot 0,-B,r+lb,unID,lb,2 : unID=unID+1

	roty -alfa
next i
del 3+2


PEN gs_cont_pen
material gs_brick_mat


aa1=asn(tb/2/r1)

nb = INT(2*pi*r1*aa/360/(tb+gs_mor_th))

daa=(aa-2*aa1)/(nb-1)

!!!if r*sin(daa/2)<=(tb-2*lb*sin(aa1))/2+0.005 then nb=int(2*pi*r*aa/360/(tb-2*lb*sin(aa1)))

addz -r+ha
rotx 90

for i=0 to nb-1 step 1

	dx1=tb*sin(90-aa/2+aa1+i*daa)
	dy1=tb*cos(90-aa/2+aa1+i*daa)
	dx2=(tb-2*lb*sin(aa1))*sin(90-aa/2+aa1+i*daa)
	dy2=(tb-2*lb*sin(aa1))*cos(90-aa/2+aa1+i*daa)

	 prism_ 5, b,
		-r1*cos(90-aa/2+i*daa), r1*sin(90-aa/2+i*daa), 15,
		-r*cos(90-aa/2+i*daa), r*sin(90-aa/2+i*daa), 15,
		-r*cos(90-aa/2+i*daa)+dx2, r*sin(90-aa/2+i*daa)+dy2, 15,
		-r1*cos(90-aa/2+i*daa)+dx1, r1*sin(90-aa/2+i*daa)+dy1, 15,
		-r1*cos(90-aa/2+i*daa), r1*sin(90-aa/2+i*daa), -1


next i

material gs_mortar_mat

for i=1 to nb-1 step 1
	dx1=tb*sin(90-aa/2+aa1+(i-1)*daa)
	dy1=tb*cos(90-aa/2+aa1+(i-1)*daa)
	dx2=(tb-2*lb*sin(aa1))*sin(90-aa/2+aa1+(i-1)*daa)
	dy2=(tb-2*lb*sin(aa1))*cos(90-aa/2+aa1+(i-1)*daa)

	 prism_ 5, b-mfd,
		-r*cos(90-aa/2+(i-1)*daa)+dx2, r*sin(90-aa/2+(i-1)*daa)+dy2, 15,
		-r1*cos(90-aa/2+(i-1)*daa)+dx1, r1*sin(90-aa/2+(i-1)*daa)+dy1, 15,
		-r1*cos(90-aa/2+i*daa), r1*sin(90-aa/2+i*daa), 15,
		-r*cos(90-aa/2+i*daa), r*sin(90-aa/2+i*daa), 15,
		-r*cos(90-aa/2+(i-1)*daa)+dx2, r*sin(90-aa/2+(i-1)*daa)+dy2, -1

next i

DEL TOP

