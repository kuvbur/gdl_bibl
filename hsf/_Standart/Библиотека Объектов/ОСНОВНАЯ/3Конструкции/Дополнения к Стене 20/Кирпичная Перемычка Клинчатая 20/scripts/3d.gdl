
!!Masonry Arch Jack.gsm

IF gs_detlevel_3D_m = DLEV3D_OFF THEN END

IF gs_shadow=0 THEN SHADOW OFF
IF gs_shadow=1 THEN SHADOW ON

PEN gs_cont_pen
if abs(te)<eps then end

!!---- Hotspot Editing
unID=1
hotspot 0,0,0,unID,A2,1+128,A : unID=unID+1
hotspot -1,0,0,unID,A2,3,A : unID=unID+1
hotspot A2,0,0,unID,A2,2,A : unID=unID+1

hotspot 0,0,0,unID,A2,1+128,A : unID=unID+1
hotspot 1,0,0,unID,A2,3,A : unID=unID+1
hotspot -A2,0,0,unID,A2,2,A : unID=unID+1

hotspot 0,-B,0,unID,A2,1+128,A : unID=unID+1
hotspot -1,-B,0,unID,A2,3,A : unID=unID+1
hotspot A2,-B,0,unID,A2,2,A : unID=unID+1

hotspot 0,-B,0,unID,A2,1+128,A : unID=unID+1
hotspot 1,-B,0,unID,A2,3,A : unID=unID+1
hotspot -A2,-B,0,unID,A2,2,A : unID=unID+1

hotspot A2,0,0,unID,B,1+128 : unID=unID+1
hotspot A2,1,0,unID,B,3 : unID=unID+1
hotspot A2,-B,0,unID,B,2 : unID=unID+1

hotspot -A2,0,0,unID,B,1+128 : unID=unID+1
hotspot -A2,1,0,unID,B,3 : unID=unID+1
hotspot -A2,-B,0,unID,B,2 : unID=unID+1

hotspot 0,0,0,unID,zzyzx,1+256 : unID=unID+1
hotspot 0,0,-1,unID,zzyzx,3 : unID=unID+1
hotspot 0,0,zzyzx,unID,zzyzx,2 : unID=unID+1

hotspot 0,-B,0,unID,zzyzx,1+256 : unID=unID+1
hotspot 0,-B,-1,unID,zzyzx,3 : unID=unID+1
hotspot 0,-B,zzyzx,unID,zzyzx,2 : unID=unID+1

hotspot -A2,0,zzyzx,unID,te,1+128 : unID=unID+1
hotspot -A2+1,0,zzyzx,unID,te,3 : unID=unID+1
hotspot -A2-te,0,zzyzx,unID,te,2 : unID=unID+1

hotspot -A2,-B,zzyzx,unID,te,1+128 : unID=unID+1
hotspot -A2+1,-B,zzyzx,unID,te,3 : unID=unID+1
hotspot -A2-te,-B,zzyzx,unID,te,2 : unID=unID+1

hotspot A2,0,zzyzx,unID,te,1+128 : unID=unID+1
hotspot A2-1,0,zzyzx,unID,te,3 : unID=unID+1
hotspot A2+te,0,zzyzx,unID,te,2 : unID=unID+1

hotspot A2,-B,zzyzx,unID,te,1+128 : unID=unID+1
hotspot A2-1,-B,zzyzx,unID,te,3 : unID=unID+1
hotspot A2+te,-B,zzyzx,unID,te,2 : unID=unID+1
!!---- Hotspot Editing

ADDX te

!!!if nb*tb>=a+2*te then nb=int((a+2*te+0.002)/(tb+0.002))
m=(zzyzx*a+2*te*zzyzx)/2/te

nb=INT( (a+2*te) / (tb+gs_mor_th) )
gs_mor_th2=(a+2*te-tb*nb)/(nb-1)
dx=tb+gs_mor_th2		!!(a+2*te-tb*nb)/(nb-1)

rotx 90
material gs_brick_mat

for i=0 to nb-1 step 1
	aa1=atn((a/2+te-i*dx)/m)
	aa2=atn((a/2+te-tb-i*dx)/m)
	dx1=zzyzx*tan(aa1)
	dx2=zzyzx*tan(aa2)

	prism_ 5, b,
		a/2-i*dx, zzyzx, 15,
		a/2-tb-i*dx, zzyzx, 15,
		a/2-tb-i*dx-dx2, 0, 15,
		a/2-i*dx-dx1, 0, 15,
		a/2-i*dx, zzyzx, -1
next i

material gs_mortar_mat

for i=1 to nb-1 step 1
	aa1=atn((a/2+te-i*dx)/m)
	aa2=atn((a/2+te-tb-(i-1)*dx)/m)
	dx1=zzyzx*tan(aa1)
	dx2=zzyzx*tan(aa2)

	prism_ 5, b-mfd,
		a/2-tb-(i-1)*dx, zzyzx, 15,
		a/2-tb-(i-1)*dx-dx2, 0, 15,
		a/2-i*dx-dx1, 0, 15,
		a/2-i*dx, zzyzx, 15,
		a/2-tb-(i-1)*dx, zzyzx, -1
next i
DEL TOP
