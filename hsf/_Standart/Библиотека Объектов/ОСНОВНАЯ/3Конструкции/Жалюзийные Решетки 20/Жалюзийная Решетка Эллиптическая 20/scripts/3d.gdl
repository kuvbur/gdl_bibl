
!! Elliptical Header.gsm

if gs_detlevel_3D_m = DLEV3D_OFF then end

pen gs_cont_pen
material fmat
resol gs_resol
ADDx a/2
if gs_detlevel_3D_m = DLEV3D_SIMPLE then
rotx 90
muly zzyzx/(a/2+1")
prism_ 5, fth,
	a/2,    0,    15,
	a/2,   1",    79,
   -a/2,   1",  1079,
   -a/2,    0,    15,
	a/2,    0,    -1
del 2
end
endif



rotx 90
addy 1"

!!Frame!!

material fmat

r=(a^2/4+(zzyzx-1")^2)/(2*(zzyzx-1"))

rotx 90
cutplane
del 1

addy -(r-(zzyzx-1"))
beta=omega/ns

!For additional 2 points coordinate in base polyline
!to solve smooth surface problems
gamma=atn((5/16")/(fth*2/8))
delta=atn((fth*1/16)/(1 9/16"))


beta=-beta+90-omega/2
for i=1 to ns+3 step 1
put r*cos(beta),r*sin(beta),0
beta=beta+omega/ns
next i

ee=0.00001       !"small" value

!! Model Solid
tubea 11,nsp/3,1+2+16+32,
0,0,0,
2 1/2",0,0,

2 1/2",fth*11/16-ee,1,
2 1/2",fth*11/16,0,
2 1/2"-ee*cos(delta),fth*11/16+ee*sin(delta),1,

15/16"+ee*cos(delta),fth*12/16-ee*sin(delta),1,
15/16",fth*12/16,0,
15/16"-ee*sin(gamma),fth*12/16+ee*cos(gamma),1,

5/8",fth,0,
0,fth,0,
0,0,0,

get (nsp)

body -1
del 1
cutend


prism_ 7, fth,
	kr+3/4", 0, 79,
	0,  1", 800,
   -kr-3/4", 0, 1015,
	-kr, 0, 79,
	0, 1", 800,
	kr, 0, 1015,
	kr+3/4", 0, -1

prism_ 4, fth-1/2",
	kr, 0, 79,
	0,  1", 800,
   -kr, 0, 1015,
	kr, 0, -1


prism_ 5, bth,
	-a/2, -1",  15,
	 a/2, -1",  15,
	 a/2,   0,  15,
	-a/2,   0,  15,
	-a/2, -1",  -1


!! Louvers !!
material lmat

cutpolya 4, 2, 0,
	kr+3/4", 0, 79,
	0,  1", 800,
   -kr-3/4", 0, 1015,
	kr+3/4", 0, -1


addz 1/4"

! Cut Plane angle calculation for louvers

beta=omega/ns
dev=r*(1-cos(beta/2))

addy -(r-(zzyzx-1"))

rotz beta/2+90-omega/2
for i=1 to ns step 1
addx r-dev
cutplane 0,1,1,0
del 1
rotz beta
next i
del ns+1
del 1


for h=1 to 2
for i=1 to nol/2

alfa=180/nol
szi=13
fi=alfa*(sin(szi))^2
plane_ 4,
	0,      0,    0,  15,
	r,      0,    0,  15,
	r*cos(fi),r*sin(fi), pi/180*r*alfa*sin(szi)*cos(szi), 15,
	0,      0,    0,  -1
plane_ 4,
	0, 0, 0, 15,
	r*cos(fi),r*sin(fi), pi/180*r*alfa*sin(szi)*cos(szi), 15,
	r*cos(alfa),r*sin(alfa), 0, 15,
	0, 0, 0, -1
base
vert 0,0,0
vert 0,0,-1
vert 0,1,0
vert 1,0,0
coor 2,-1,-2,-3,-4
body 1

rotz alfa

next i
del nol/2
mulx -1
next h
del 2


poly_  7,
	a/2, 0, 79,
	0,  1", 800,
   -a/2, 0, 1015,
   -kr-3/4", 0, 79,
	0,  1", 800,
	kr+3/4", 0, 1015,
	a/2, 0, -1

for j=1 to ns
cutend
next j

del 1

cutend

del 3

end
