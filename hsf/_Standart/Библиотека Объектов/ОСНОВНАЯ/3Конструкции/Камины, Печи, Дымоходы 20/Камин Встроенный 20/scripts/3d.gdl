
if not(gs_shadow) then shadow off
if gs_detlevel_3D_m = 2 then	! Detailed
	resol gs_resol
else
	if gs_detlevel_3D_m = 1 then ! Simple
		resol 3
		gs_resol = 6
	else
		END	! Off
	endif
endif

pen gs_cont_pen

unID = 1
call "Resize_A_B_ZZYZX" Parameters ALL


!-----Definitions-----
thicknes = 0.015			! Firebox thicknes
doorFrame = 0.05
doorOffset = 0.04
if gs_detlevel_3D_m = 2 then
	doorReduced = 0.02
else
	doorReduced = 0.0
endif

define material "pictmat" 2, 1, 1, 1
pictureMat = ind(MATERIAL,"pictmat")

! ======================================================================
! BODY
! ======================================================================
minWallY = minWall
if fbGlassBack+thicknes > minWall then minWallY = fbGlassBack+thicknes

material mat_fp
group "fpCutter"
	gosub "FireBox Cutter"
endgroup

group "baseGroup"
	if fpStyle_m = STYLE_5 then
		prism_ 5, ZZYZX,
			0, 0, 15,
			A-cornerX, 0, 15,
			A, cornerX, 15,
			A, B, 15,
			0, B, 15
	else
		prism_ 4, ZZYZX,
			0, 0, 15,
			A, 0, 15,
			A, B, 15,
			0, B, 15
	endif
endgroup

placegroup subgroup ("baseGroup", "fpCutter")
body -1
killgroup "baseGroup"
killgroup "fpCutter"


! ======================================================================
! DETAILS
! ======================================================================
if bCornice then
	overHang = corniceOverh
	height	 = corniceHeight
	offset	 = corniceOffset
	detMat	 = mat_corn
	addz fbH+fbOpenH
	gosub "Details"
	if fpStyle_m = STYLE_2 then
		muly -1
		addy -B
		gosub "Details"
		del 2
	endif
	del 1
endif

if bFlush then
	overHang = flushOverh
	height	 = flushHeight
	offset	 = flushOffset
	detMat	 = mat_flush
	addz fbOpenH-flushHeight
	gosub "Details"
	if fpStyle_m = STYLE_2 then
		muly -1
		addy -B
		gosub "Details"
		del 2
	endif
	del 1
endif

if bSocle and socleHeight > EPS then
	overHang = socleOverh
	height	 = socleHeight
	offset	 = socleOffset
	detMat	 = mat_socle
	gosub "Details"
	if fpStyle_m = STYLE_2 then
		muly -1
		addy -B
		gosub "Details"
		del 2
	endif
endif


! ======================================================================
! FIREBOX
! ======================================================================
material mat_fb
addz fbOpenH
if gs_detlevel_3D_m = 2 and not(GLOB_CONTEXT>20 and GLOB_CONTEXT<40) then gosub "FireBox_Top"		!Bottom
gosub "FireBox_Side"	!Door and side
if gs_detlevel_3D_m = 2 and not(GLOB_CONTEXT>20 and GLOB_CONTEXT<40) then 	!Top
	addz fbH-thicknes
	material mat_fb
	gosub "FireBox_Top"
	del 1
endif
del 1

! ======================================================================
! FIRE
! ======================================================================
if bFire and not(bFirePicture) then
	woodScale = 1
	flameScale = woodScale*1.2
	woodLength = 0.6
	woodX = 1
	woodY = 0.6
	addz fbOpenH
	if fpStyle_m = STYLE_1 or fpStyle_m = STYLE_2 then
		add fpWidthSide+fbWidth/2, fbDepth/2, 0
		if (A-woodX)<EPS or (B-woodY)<EPS then
			woodScale = min((A-0.1)/woodX, (fbDepth-0.1)/woodY, fbH/0.55)
		else
			woodScale = min(A/1.5, fbDepth/0.75, fbH/0.55)
		endif
		flameScale = woodScale*1.2
		gosub "Fire"
		del 1
	endif

	if fpStyle_m = STYLE_3 then
		add A/2, B/2, 0
		if (A-woodX)<EPS or (B-woodY)<EPS then
			woodScale = min((A-0.1)/woodX, (B-0.1)/woodY, fbH/0.55)
		else
			woodScale = min(A/1.5, B/0.75, fbH/0.55)
		endif
		flameScale = woodScale*1.2
		gosub "Fire"
		del 1
	endif

	if fpStyle_m = STYLE_4 then
		add A-minWallY-fbWidth/2, B/2, 0
		if (fbWidth-woodX)<EPS or (B-woodY)<EPS then
			woodScale = min((fbWidth-0.1)/woodX, (B-0.1)/woodY, fbH/0.55)
		else
			woodScale = min(A/1.5, B/0.75, fbH/0.55)
		endif
		flameScale = woodScale*1.2
		gosub "Fire"
		del 1
	endif

	if fpStyle_m = STYLE_5 then
		add A-cornerX/2, cornerX/2, 0
		if (A-woodX)<EPS or (B-woodY)<EPS then
			woodScale = min((A-0.1)/woodX, (B-0.1)/woodY, fbH/0.55)
		else
			woodScale = min(A/1.5, B/1.5, fbH/0.55)
		endif
		flameScale = woodScale*1.2
		rotz 45
		addy woodX*woodScale/sqr(2)
		gosub "Fire"
		del 3
	endif

	del 1
endif


! ======================================================================
! HOTSPOT BASE
! ======================================================================
if fpStyle_m = STYLE_1 or fpStyle_m = STYLE_2 then
	hotspot  fpWidthSide+fbWidth/2, 0, 0, unID, fbOpenH, 1+128		: unID=unID+1
	hotspot  fpWidthSide+fbWidth/2, 0, -1, unID, fbOpenH, 3 		: unID=unID+1
	hotspot  fpWidthSide+fbWidth/2, 0, fbOpenH, unID, fbOpenH,2 	: unID=unID+1

	hotspot  fpWidthSide+fbWidth/2, 0, fbOpenH, unID, fbH, 1+128	: unID=unID+1
	hotspot  fpWidthSide+fbWidth/2, 0, fbOpenH-1, unID, fbH, 3 		: unID=unID+1
	hotspot  fpWidthSide+fbWidth/2, 0, fbOpenH+fbH, unID, fbH,2 	: unID=unID+1

	hotspot  0, 0,  fbOpenH, unID, fpWidthSide, 1+128				: unID=unID+1
	hotspot  -1, 0, fbOpenH, unID, fpWidthSide, 3 					: unID=unID+1
	hotspot  fpWidthSide, 0, fbOpenH, unID, fpWidthSide,2 			: unID=unID+1

	hotspot  0, 0,  fbOpenH+fbH, unID, fpWidthSide, 1+128			: unID=unID+1
	hotspot  -1, 0, fbOpenH+fbH, unID, fpWidthSide, 3 				: unID=unID+1
	hotspot  fpWidthSide, 0, fbOpenH+fbH, unID, fpWidthSide,2 		: unID=unID+1

	hotspot  fpWidthSide, 0,  fbOpenH, unID, fbWidth, 1+128			: unID=unID+1
	hotspot  fpWidthSide-1, 0, fbOpenH, unID, fbWidth, 3 			: unID=unID+1
	hotspot  fpWidthSide+fbWidth, 0, fbOpenH, unID, fbWidth,2 		: unID=unID+1

	hotspot  fpWidthSide, 0,  fbOpenH+fbH, unID, fbWidth, 1+128		: unID=unID+1
	hotspot  fpWidthSide-1, 0, fbOpenH+fbH, unID, fbWidth, 3 		: unID=unID+1
	hotspot  fpWidthSide+fbWidth, 0, fbOpenH+fbH, unID, fbWidth,2 	: unID=unID+1
endif

if fpStyle_m = STYLE_2 then
	hotspot  fpWidthSide+fbWidth/2, B, 0, unID, fbOpenH, 1+128		: unID=unID+1
	hotspot  fpWidthSide+fbWidth/2, B, -1, unID, fbOpenH, 3 		: unID=unID+1
	hotspot  fpWidthSide+fbWidth/2, B, fbOpenH, unID, fbOpenH,2 	: unID=unID+1

	hotspot  fpWidthSide+fbWidth/2, B, fbOpenH, unID, fbH, 1+128	: unID=unID+1
	hotspot  fpWidthSide+fbWidth/2, B, fbOpenH-1, unID, fbH, 3 		: unID=unID+1
	hotspot  fpWidthSide+fbWidth/2, B, fbOpenH+fbH, unID, fbH,2 	: unID=unID+1

	hotspot  0, B,  fbOpenH, unID, fpWidthSide, 1+128				: unID=unID+1
	hotspot  -1, B, fbOpenH, unID, fpWidthSide, 3 					: unID=unID+1
	hotspot  fpWidthSide, B, fbOpenH, unID, fpWidthSide,2 			: unID=unID+1

	hotspot  0, B,  fbOpenH+fbH, unID, fpWidthSide, 1+128			: unID=unID+1
	hotspot  -1, B, fbOpenH+fbH, unID, fpWidthSide, 3 				: unID=unID+1
	hotspot  fpWidthSide, B, fbOpenH+fbH, unID, fpWidthSide,2 		: unID=unID+1

	hotspot  fpWidthSide, B,  fbOpenH, unID, fbWidth, 1+128			: unID=unID+1
	hotspot  fpWidthSide-1, B, fbOpenH, unID, fbWidth, 3 			: unID=unID+1
	hotspot  fpWidthSide+fbWidth, B, fbOpenH, unID, fbWidth,2 		: unID=unID+1

	hotspot  fpWidthSide, B,  fbOpenH+fbH, unID, fbWidth, 1+128		: unID=unID+1
	hotspot  fpWidthSide-1, B, fbOpenH+fbH, unID, fbWidth, 3 		: unID=unID+1
	hotspot  fpWidthSide+fbWidth, B, fbOpenH+fbH, unID, fbWidth,2 	: unID=unID+1
endif

if fpStyle_m = STYLE_3 then
	hotspot  A/2, 0, 0, unID, fbOpenH, 1+128		: unID=unID+1
	hotspot  A/2, 0, -1, unID, fbOpenH, 3 			: unID=unID+1
	hotspot  A/2, 0, fbOpenH, unID, fbOpenH,2 		: unID=unID+1

	hotspot  A/2, 0, fbOpenH, unID, fbH, 1+128		: unID=unID+1
	hotspot  A/2, 0, fbOpenH-1, unID, fbH, 3 		: unID=unID+1
	hotspot  A/2, 0, fbOpenH+fbH, unID, fbH,2 		: unID=unID+1

	hotspot  A, 0,  fbOpenH, unID, fbOpenWidthSide, 1+128				: unID=unID+1
	hotspot  A, -1, fbOpenH, unID, fbOpenWidthSide, 3 					: unID=unID+1
	hotspot  A, fbOpenWidthSide, fbOpenH, unID, fbOpenWidthSide,2 		: unID=unID+1

	hotspot  A, 0,  fbOpenH+fbH, unID, fbOpenWidthSide, 1+128			: unID=unID+1
	hotspot  A, -1, fbOpenH+fbH, unID, fbOpenWidthSide, 3 				: unID=unID+1
	hotspot  A, fbOpenWidthSide, fbOpenH+fbH, unID, fbOpenWidthSide,2 	: unID=unID+1

	hotspot  0, 0,  fbOpenH, unID, fbOpenWidthSide, 1+128				: unID=unID+1
	hotspot  0, -1, fbOpenH, unID, fbOpenWidthSide, 3 					: unID=unID+1
	hotspot  0, fbOpenWidthSide, fbOpenH, unID, fbOpenWidthSide,2 		: unID=unID+1

	hotspot  0, 0,  fbOpenH+fbH, unID, fbOpenWidthSide, 1+128			: unID=unID+1
	hotspot  0, -1, fbOpenH+fbH, unID, fbOpenWidthSide, 3 				: unID=unID+1
	hotspot  0, fbOpenWidthSide, fbOpenH+fbH, unID, fbOpenWidthSide,2 	: unID=unID+1
endif

if fpStyle_m = STYLE_4 then
	hotspot  A-minWallY-fbWidth/2, 0, 0, unID, fbOpenH, 1+128			: unID=unID+1
	hotspot  A-minWallY-fbWidth/2, 0, -1, unID, fbOpenH, 3 				: unID=unID+1
	hotspot  A-minWallY-fbWidth/2, 0, fbOpenH, unID, fbOpenH,2 			: unID=unID+1

	hotspot  A-minWallY-fbWidth/2, 0, fbOpenH, unID, fbH, 1+128			: unID=unID+1
	hotspot  A-minWallY-fbWidth/2, 0, fbOpenH-1, unID, fbH, 3 			: unID=unID+1
	hotspot  A-minWallY-fbWidth/2, 0, fbOpenH+fbH, unID, fbH,2 			: unID=unID+1

	hotspot  A-minWallY, 0,  fbOpenH, unID, fbWidth, 1+128				: unID=unID+1
	hotspot  A-minWallY+1, 0, fbOpenH, unID, fbWidth, 3 				: unID=unID+1
	hotspot  A-minWallY-fbWidth, 0, fbOpenH, unID, fbWidth,2 			: unID=unID+1

	hotspot  A-minWallY, 0,  fbOpenH+fbH, unID, fbWidth, 1+128			: unID=unID+1
	hotspot  A-minWallY+1, 0, fbOpenH+fbH, unID, fbWidth, 3 			: unID=unID+1
	hotspot  A-minWallY-fbWidth, 0, fbOpenH+fbH, unID, fbWidth,2 		: unID=unID+1

	hotspot  A, 0,  fbOpenH, unID, fbOpenWidthSide, 1+128				: unID=unID+1
	hotspot  A, -1, fbOpenH, unID, fbOpenWidthSide, 3 					: unID=unID+1
	hotspot  A, fbOpenWidthSide, fbOpenH, unID, fbOpenWidthSide,2 		: unID=unID+1

	hotspot  A, 0,  fbOpenH+fbH, unID, fbOpenWidthSide, 1+128			: unID=unID+1
	hotspot  A, -1, fbOpenH+fbH, unID, fbOpenWidthSide, 3 				: unID=unID+1
	hotspot  A, fbOpenWidthSide, fbOpenH+fbH, unID, fbOpenWidthSide,2 	: unID=unID+1
endif

if fpStyle_m = STYLE_5 then
	hotspot  A-cornerX/2, cornerX/2, 0, unID, fbOpenH, 1+128					: unID=unID+1
	hotspot  A-cornerX/2, cornerX/2, -1, unID, fbOpenH, 3 						: unID=unID+1
	hotspot  A-cornerX/2, cornerX/2, fbOpenH, unID, fbOpenH,2 					: unID=unID+1

	hotspot  A-cornerX/2, cornerX/2, fbOpenH, unID, fbH, 1+128					: unID=unID+1
	hotspot  A-cornerX/2, cornerX/2, fbOpenH-1, unID, fbH, 3 					: unID=unID+1
	hotspot  A-cornerX/2, cornerX/2, fbOpenH+fbH, unID, fbH,2 					: unID=unID+1

	hotspot  A-fbWidth/sqr(2), 0,  fbOpenH, unID, fbWidth, 1+128				: unID=unID+1
	hotspot  A-fbWidth/sqr(2)-sqr(2), -sqr(2), fbOpenH, unID, fbWidth, 3 		: unID=unID+1
	hotspot  A, fbWidth/sqr(2), fbOpenH, unID, fbWidth,2 						: unID=unID+1

	hotspot  A, fbWidth/sqr(2),  fbOpenH, unID, fbWidth, 1+128					: unID=unID+1
	hotspot  A+sqr(2), fbWidth/sqr(2)+sqr(2), fbOpenH, unID, fbWidth, 3 		: unID=unID+1
	hotspot  A-fbWidth/sqr(2), 0, fbOpenH, unID, fbWidth,2 						: unID=unID+1

	hotspot  A-fbWidth/sqr(2), 0,  fbOpenH+fbH, unID, fbWidth, 1+128			: unID=unID+1
	hotspot  A-fbWidth/sqr(2)-sqr(2), -sqr(2), fbOpenH+fbH, unID, fbWidth, 3 	: unID=unID+1
	hotspot  A, fbWidth/sqr(2), fbOpenH+fbH, unID, fbWidth,2 					: unID=unID+1

	hotspot  A, fbWidth/sqr(2),  fbOpenH+fbH, unID, fbWidth, 1+128				: unID=unID+1
	hotspot  A+sqr(2), fbWidth/sqr(2)+sqr(2), fbOpenH+fbH, unID, fbWidth, 3 	: unID=unID+1
	hotspot  A-fbWidth/sqr(2), 0, fbOpenH+fbH, unID, fbWidth,2 					: unID=unID+1

	hotspot  A-cornerX, 0,  fbOpenH, unID, fbOpenWidthSide, 1+128				: unID=unID+1
	hotspot  A-cornerX+1, 0, fbOpenH, unID, fbOpenWidthSide, 3 					: unID=unID+1
	hotspot  A-cornerX-fbOpenWidthSide, 0, fbOpenH, unID, fbOpenWidthSide,2 	: unID=unID+1

	hotspot  A-cornerX, 0,  fbOpenH+fbH, unID, fbOpenWidthSide, 1+128			: unID=unID+1
	hotspot  A-cornerX+1, 0, fbOpenH+fbH, unID, fbOpenWidthSide, 3 				: unID=unID+1
	hotspot  A-cornerX-fbOpenWidthSide, 0, fbOpenH+fbH, unID, fbOpenWidthSide,2 : unID=unID+1

	hotspot  A, cornerX,  fbOpenH, unID, fbOpenWidthSide, 1+128					: unID=unID+1
	hotspot  A, cornerX-1, fbOpenH, unID, fbOpenWidthSide, 3 					: unID=unID+1
	hotspot  A, cornerX+fbOpenWidthSide, fbOpenH, unID, fbOpenWidthSide,2 		: unID=unID+1

	hotspot  A, cornerX,  fbOpenH+fbH, unID, fbOpenWidthSide, 1+128				: unID=unID+1
	hotspot  A, cornerX-1, fbOpenH+fbH, unID, fbOpenWidthSide, 3 				: unID=unID+1
	hotspot  A, cornerX+fbOpenWidthSide, fbOpenH+fbH, unID, fbOpenWidthSide,2 	: unID=unID+1
endif


! ======================================================================
! CORNICE
! ======================================================================
if bCornice then
	addz fbH+fbOpenH
	if fpStyle_m = STYLE_1 or fpStyle_m = STYLE_2 then
		hotspot  fpWidthSide+fbWidth/2, 0, 0, unID, corniceHeight, 1+128			: unID=unID+1
		hotspot  fpWidthSide+fbWidth/2, 0, -1, unID, corniceHeight, 3 				: unID=unID+1
		hotspot  fpWidthSide+fbWidth/2, 0, corniceHeight, unID, corniceHeight, 2 	: unID=unID+1

		hotspot  fpWidthSide+fbWidth/2, 0, 0, unID, corniceOffset, 1+128			: unID=unID+1
		hotspot  fpWidthSide+fbWidth/2, 1, 0, unID, corniceOffset, 3 				: unID=unID+1
		hotspot  fpWidthSide+fbWidth/2, -corniceOffset, 0, unID, corniceOffset, 2 	: unID=unID+1

		hotspot  fpWidthSide, 0,  corniceHeight, unID, corniceOverh, 1+128					: unID=unID+1
		hotspot  fpWidthSide+1, 0, corniceHeight, unID, corniceOverh, 3 					: unID=unID+1
		hotspot  fpWidthSide-corniceOverh, 0, corniceHeight, unID, corniceOverh, 2 			: unID=unID+1

		hotspot  fpWidthSide+fbWidth, 0,  corniceHeight, unID, corniceOverh, 1+128			: unID=unID+1
		hotspot  fpWidthSide+fbWidth-1, 0, corniceHeight, unID, corniceOverh, 3 			: unID=unID+1
		hotspot  fpWidthSide+fbWidth+corniceOverh, 0, corniceHeight, unID, corniceOverh, 2 	: unID=unID+1
	endif

	if fpStyle_m = STYLE_2 then
		muly -1
		addy -B

		hotspot  fpWidthSide+fbWidth/2, 0, 0, unID, corniceHeight, 1+128			: unID=unID+1
		hotspot  fpWidthSide+fbWidth/2, 0, -1, unID, corniceHeight, 3 				: unID=unID+1
		hotspot  fpWidthSide+fbWidth/2, 0, corniceHeight, unID, corniceHeight, 2 	: unID=unID+1

		hotspot  fpWidthSide+fbWidth/2, 0, 0, unID, corniceOffset, 1+128			: unID=unID+1
		hotspot  fpWidthSide+fbWidth/2, 1, 0, unID, corniceOffset, 3 				: unID=unID+1
		hotspot  fpWidthSide+fbWidth/2, -corniceOffset, 0, unID, corniceOffset, 2 	: unID=unID+1

		hotspot  fpWidthSide, 0,  corniceHeight, unID, corniceOverh, 1+128					: unID=unID+1
		hotspot  fpWidthSide+1, 0, corniceHeight, unID, corniceOverh, 3 					: unID=unID+1
		hotspot  fpWidthSide-corniceOverh, 0, corniceHeight, unID, corniceOverh, 2 			: unID=unID+1

		hotspot  fpWidthSide+fbWidth, 0,  corniceHeight, unID, corniceOverh, 1+128			: unID=unID+1
		hotspot  fpWidthSide+fbWidth-1, 0, corniceHeight, unID, corniceOverh, 3 			: unID=unID+1
		hotspot  fpWidthSide+fbWidth+corniceOverh, 0, corniceHeight, unID, corniceOverh, 2 	: unID=unID+1
		del 2
	endif

	if fpStyle_m = STYLE_3 then
		hotspot  A/2, 0, 0, unID, corniceHeight, 1+128				: unID=unID+1
		hotspot  A/2, 0, -1, unID, corniceHeight, 3 				: unID=unID+1
		hotspot  A/2, 0, corniceHeight, unID, corniceHeight, 2 		: unID=unID+1

		hotspot  A/2, 0, 0, unID, corniceOffset, 1+128				: unID=unID+1
		hotspot  A/2, 1, 0, unID, corniceOffset, 3 					: unID=unID+1
		hotspot  A/2, -corniceOffset, 0, unID, corniceOffset, 2 	: unID=unID+1

		hotspot  0, fbOpenWidthSide,  corniceHeight, unID, corniceOverh, 1+128				: unID=unID+1
		hotspot  0, -1, corniceHeight, unID, corniceOverh, 3 								: unID=unID+1
		hotspot  0, fbOpenWidthSide+corniceOverh, corniceHeight, unID, corniceOverh, 2 		: unID=unID+1

		hotspot  A, fbOpenWidthSide,  corniceHeight, unID, corniceOverh, 1+128				: unID=unID+1
		hotspot  A, -1, corniceHeight, unID, corniceOverh, 3 								: unID=unID+1
		hotspot  A, fbOpenWidthSide+corniceOverh, corniceHeight, unID, corniceOverh, 2 		: unID=unID+1
	endif

	if fpStyle_m = STYLE_4 then
		hotspot  A-minWallY-fbWidth/2, 0, 0, unID, corniceHeight, 1+128						: unID=unID+1
		hotspot  A-minWallY-fbWidth/2, 0, -1, unID, corniceHeight, 3 						: unID=unID+1
		hotspot  A-minWallY-fbWidth/2, 0, corniceHeight, unID, corniceHeight, 2 			: unID=unID+1

		hotspot  A-minWallY-fbWidth/2, 0, 0, unID, corniceOffset, 1+128						: unID=unID+1
		hotspot  A-minWallY-fbWidth/2, 1, 0, unID, corniceOffset, 3 						: unID=unID+1
		hotspot  A-minWallY-fbWidth/2, -corniceOffset, 0, unID, corniceOffset, 2 			: unID=unID+1

		hotspot  A-minWallY-fbWidth, 0,  corniceHeight, unID, corniceOverh, 1+128			: unID=unID+1
		hotspot  A-minWallY-fbWidth+1, 0, corniceHeight, unID, corniceOverh, 3 				: unID=unID+1
		hotspot  A-minWallY-fbWidth-corniceOverh, 0, corniceHeight, unID, corniceOverh, 2 	: unID=unID+1

		hotspot  A, fbOpenWidthSide,  corniceHeight, unID, corniceOverh, 1+128				: unID=unID+1
		hotspot  A, -1, corniceHeight, unID, corniceOverh, 3 								: unID=unID+1
		hotspot  A, fbOpenWidthSide+corniceOverh, corniceHeight, unID, corniceOverh, 2 		: unID=unID+1
	endif

	if fpStyle_m = STYLE_5 then
		hotspot  A-cornerX/2, cornerX/2, 0, unID, corniceHeight, 1+128											: unID=unID+1
		hotspot  A-cornerX/2, cornerX/2, -1, unID, corniceHeight, 3 											: unID=unID+1
		hotspot  A-cornerX/2, cornerX/2, corniceHeight, unID, corniceHeight, 2 									: unID=unID+1

		hotspot  A-cornerX/2, cornerX/2, 0, unID, corniceOffset, 1+128											: unID=unID+1
		hotspot  A-cornerX/2-sqr(2), cornerX/2+sqr(2), 0, unID, corniceOffset, 3 								: unID=unID+1
		hotspot  A-cornerX/2+corniceOffset/sqr(2), cornerX/2-corniceOffset/sqr(2), 0, unID, corniceOffset, 2 	: unID=unID+1

		hotspot  A-cornerX-fbOpenWidthSide, 0,  corniceHeight, unID, corniceOverh, 1+128						: unID=unID+1
		hotspot  A-cornerX-fbOpenWidthSide+1, 0, corniceHeight, unID, corniceOverh, 3 							: unID=unID+1
		hotspot  A-cornerX-fbOpenWidthSide-corniceOverh, 0, corniceHeight, unID, corniceOverh, 2 				: unID=unID+1

		hotspot  A, cornerX+fbOpenWidthSide,  corniceHeight, unID, corniceOverh, 1+128							: unID=unID+1
		hotspot  A, cornerX+fbOpenWidthSide-1, corniceHeight, unID, corniceOverh, 3 							: unID=unID+1
		hotspot  A, cornerX+fbOpenWidthSide+corniceOverh, corniceHeight, unID, corniceOverh, 2 					: unID=unID+1
	endif

	del 1
endif

! ======================================================================
! FLUSH
! ======================================================================
if bFlush then
	addz fbOpenH-flushHeight
	if fpStyle_m = STYLE_1 or fpStyle_m = STYLE_2 then
		hotspot  fpWidthSide+fbWidth/2, -flushOffset, flushHeight, unID, flushHeight, 1+128	: unID=unID+1
		hotspot  fpWidthSide+fbWidth/2, -flushOffset, flushHeight+1, unID, flushHeight, 3 	: unID=unID+1
		hotspot  fpWidthSide+fbWidth/2, -flushOffset, 0, unID, flushHeight, 2 				: unID=unID+1

		hotspot  fpWidthSide+fbWidth/2, 0, flushHeight, unID, flushOffset, 1+128			: unID=unID+1
		hotspot  fpWidthSide+fbWidth/2, 1, flushHeight, unID, flushOffset, 3 				: unID=unID+1
		hotspot  fpWidthSide+fbWidth/2, -flushOffset,flushHeight, unID, flushOffset, 2 		: unID=unID+1

		hotspot  fpWidthSide, 0,  0, unID, flushOverh, 1+128								: unID=unID+1
		hotspot  fpWidthSide+1, 0, 0, unID, flushOverh, 3 									: unID=unID+1
		hotspot  fpWidthSide-flushOverh, 0, 0, unID, flushOverh, 2 							: unID=unID+1

		hotspot  fpWidthSide+fbWidth, 0,  0, unID, flushOverh, 1+128						: unID=unID+1
		hotspot  fpWidthSide+fbWidth-1, 0, 0, unID, flushOverh, 3 							: unID=unID+1
		hotspot  fpWidthSide+fbWidth+flushOverh, 0, 0, unID, flushOverh, 2 					: unID=unID+1
	endif

	if fpStyle_m = STYLE_2 then
		muly -1
		addy -B

		hotspot  fpWidthSide+fbWidth/2, -flushOffset, flushHeight, unID, flushHeight, 1+128	: unID=unID+1
		hotspot  fpWidthSide+fbWidth/2, -flushOffset, flushHeight+1, unID, flushHeight, 3 	: unID=unID+1
		hotspot  fpWidthSide+fbWidth/2, -flushOffset, 0, unID, flushHeight, 2 				: unID=unID+1

		hotspot  fpWidthSide+fbWidth/2, 0, flushHeight, unID, flushOffset, 1+128			: unID=unID+1
		hotspot  fpWidthSide+fbWidth/2, 1, flushHeight, unID, flushOffset, 3 				: unID=unID+1
		hotspot  fpWidthSide+fbWidth/2, -flushOffset,flushHeight, unID, flushOffset, 2 		: unID=unID+1

		hotspot  fpWidthSide, 0,  0, unID, flushOverh, 1+128								: unID=unID+1
		hotspot  fpWidthSide+1, 0, 0, unID, flushOverh, 3 									: unID=unID+1
		hotspot  fpWidthSide-flushOverh, 0, 0, unID, flushOverh, 2 							: unID=unID+1

		hotspot  fpWidthSide+fbWidth, 0,  0, unID, flushOverh, 1+128						: unID=unID+1
		hotspot  fpWidthSide+fbWidth-1, 0, 0, unID, flushOverh, 3 							: unID=unID+1
		hotspot  fpWidthSide+fbWidth+flushOverh, 0, 0, unID, flushOverh, 2 					: unID=unID+1
		del 2
	endif

	if fpStyle_m = STYLE_3 then
		hotspot  A/2, -flushOffset, flushHeight, unID, flushHeight, 1+128		: unID=unID+1
		hotspot  A/2, -flushOffset, flushHeight+1, unID, flushHeight, 3 		: unID=unID+1
		hotspot  A/2, -flushOffset, 0, unID, flushHeight, 2 					: unID=unID+1

		hotspot  A/2, 0, flushHeight, unID, flushOffset, 1+128					: unID=unID+1
		hotspot  A/2, 1, flushHeight, unID, flushOffset, 3 						: unID=unID+1
		hotspot  A/2, -flushOffset, flushHeight, unID, flushOffset, 2 			: unID=unID+1

		hotspot  0, fbOpenWidthSide,  0, unID, flushOverh, 1+128				: unID=unID+1
		hotspot  0, -1, 0, unID, flushOverh, 3 									: unID=unID+1
		hotspot  0, fbOpenWidthSide+flushOverh, 0, unID, flushOverh, 2 			: unID=unID+1

		hotspot  A, fbOpenWidthSide,  0, unID, flushOverh, 1+128				: unID=unID+1
		hotspot  A, -1, 0, unID, flushOverh, 3 									: unID=unID+1
		hotspot  A, fbOpenWidthSide+flushOverh, 0, unID, flushOverh, 2 			: unID=unID+1
	endif

	if fpStyle_m = STYLE_4 then
		hotspot  A-minWallY-fbWidth/2, -flushOffset, flushHeight, unID, flushHeight, 1+128		: unID=unID+1
		hotspot  A-minWallY-fbWidth/2, -flushOffset, flushHeight+1, unID, flushHeight, 3 		: unID=unID+1
		hotspot  A-minWallY-fbWidth/2, -flushOffset, 0, unID, flushHeight, 2 					: unID=unID+1

		hotspot  A-minWallY-fbWidth/2, 0, flushHeight, unID, flushOffset, 1+128					: unID=unID+1
		hotspot  A-minWallY-fbWidth/2, 1, flushHeight, unID, flushOffset, 3 					: unID=unID+1
		hotspot  A-minWallY-fbWidth/2, -flushOffset, flushHeight, unID, flushOffset, 2 			: unID=unID+1

		hotspot  A-minWallY-fbWidth, 0,  0, unID, flushOverh, 1+128								: unID=unID+1
		hotspot  A-minWallY-fbWidth+1, 0, 0, unID, flushOverh, 3 								: unID=unID+1
		hotspot  A-minWallY-fbWidth-flushOverh, 0, 0, unID, flushOverh, 2 						: unID=unID+1

		hotspot  A, fbOpenWidthSide,  0, unID, flushOverh, 1+128								: unID=unID+1
		hotspot  A, -1, 0, unID, flushOverh, 3 													: unID=unID+1
		hotspot  A, fbOpenWidthSide+flushOverh, 0, unID, flushOverh, 2 							: unID=unID+1
	endif

	if fpStyle_m = STYLE_5 then
		hotspot  A-cornerX/2+flushOffset/sqr(2), cornerX/2-flushOffset/sqr(2), flushHeight, unID, flushHeight, 1+128		: unID=unID+1
		hotspot  A-cornerX/2+flushOffset/sqr(2), cornerX/2-flushOffset/sqr(2), flushHeight+1, unID, flushHeight, 3 			: unID=unID+1
		hotspot  A-cornerX/2+flushOffset/sqr(2), cornerX/2-flushOffset/sqr(2), 0, unID, flushHeight, 2 						: unID=unID+1

		hotspot  A-cornerX/2, cornerX/2, flushHeight, unID, flushOffset, 1+128												: unID=unID+1
		hotspot  A-cornerX/2-sqr(2), cornerX/2+sqr(2), flushHeight, unID, flushOffset, 3 									: unID=unID+1
		hotspot  A-cornerX/2+flushOffset/sqr(2), cornerX/2-flushOffset/sqr(2), flushHeight, unID, flushOffset, 2 			: unID=unID+1

		hotspot  A-cornerX-fbOpenWidthSide, 0,  0, unID, flushOverh, 1+128						: unID=unID+1
		hotspot  A-cornerX-fbOpenWidthSide+1, 0, 0, unID, flushOverh, 3 						: unID=unID+1
		hotspot  A-cornerX-fbOpenWidthSide-flushOverh, 0, 0, unID, flushOverh, 2 				: unID=unID+1

		hotspot  A, cornerX+fbOpenWidthSide,  0, unID, flushOverh, 1+128						: unID=unID+1
		hotspot  A, cornerX+fbOpenWidthSide-1, 0, unID, flushOverh, 3 							: unID=unID+1
		hotspot  A, cornerX+fbOpenWidthSide+flushOverh, 0, unID, flushOverh, 2 					: unID=unID+1
	endif

	del 1
endif


! ======================================================================
! SOCLE
! ======================================================================
if bSocle and socleHeight > EPS then
	if fpStyle_m = STYLE_1 or fpStyle_m = STYLE_2 then
		hotspot  fpWidthSide+fbWidth/2, 0, 0, unID, socleOffset, 1+128				: unID=unID+1
		hotspot  fpWidthSide+fbWidth/2, 1, 0, unID, socleOffset, 3 					: unID=unID+1
		hotspot  fpWidthSide+fbWidth/2, -socleOffset,0, unID, socleOffset, 2 		: unID=unID+1

		hotspot  fpWidthSide, 0,  0, unID, socleOverh, 1+128						: unID=unID+1
		hotspot  fpWidthSide+1, 0, 0, unID, socleOverh, 3 							: unID=unID+1
		hotspot  fpWidthSide-socleOverh, 0, 0, unID, socleOverh, 2 					: unID=unID+1

		hotspot  fpWidthSide+fbWidth, 0,  0, unID, socleOverh, 1+128				: unID=unID+1
		hotspot  fpWidthSide+fbWidth-1, 0, 0, unID, socleOverh, 3 					: unID=unID+1
		hotspot  fpWidthSide+fbWidth+socleOverh, 0, 0, unID, socleOverh, 2 			: unID=unID+1
	endif

	if fpStyle_m = STYLE_2 then
		muly -1
		addy -B

		hotspot  fpWidthSide+fbWidth/2, 0, 0, unID, socleOffset, 1+128				: unID=unID+1
		hotspot  fpWidthSide+fbWidth/2, 1, 0, unID, socleOffset, 3 					: unID=unID+1
		hotspot  fpWidthSide+fbWidth/2, -socleOffset,0, unID, socleOffset, 2 		: unID=unID+1

		hotspot  fpWidthSide, 0,  0, unID, socleOverh, 1+128						: unID=unID+1
		hotspot  fpWidthSide+1, 0, 0, unID, socleOverh, 3 							: unID=unID+1
		hotspot  fpWidthSide-socleOverh, 0, 0, unID, socleOverh, 2 					: unID=unID+1

		hotspot  fpWidthSide+fbWidth, 0,  0, unID, socleOverh, 1+128				: unID=unID+1
		hotspot  fpWidthSide+fbWidth-1, 0, 0, unID, socleOverh, 3 					: unID=unID+1
		hotspot  fpWidthSide+fbWidth+socleOverh, 0, 0, unID, socleOverh, 2 			: unID=unID+1
		del 2
	endif

	if fpStyle_m = STYLE_3 then
		hotspot  A/2, 0, 0, unID, socleOffset, 1+128								: unID=unID+1
		hotspot  A/2, 1, 0, unID, socleOffset, 3 									: unID=unID+1
		hotspot  A/2, -socleOffset, 0, unID, socleOffset, 2 						: unID=unID+1

		hotspot  0, fbOpenWidthSide,  0, unID, socleOverh, 1+128					: unID=unID+1
		hotspot  0, -1, 0, unID, socleOverh, 3 										: unID=unID+1
		hotspot  0, fbOpenWidthSide+socleOverh, 0, unID, socleOverh, 2 				: unID=unID+1

		hotspot  A, fbOpenWidthSide,  0, unID, socleOverh, 1+128					: unID=unID+1
		hotspot  A, -1, 0, unID, socleOverh, 3 										: unID=unID+1
		hotspot  A, fbOpenWidthSide+socleOverh, 0, unID, socleOverh, 2 				: unID=unID+1
	endif

	if fpStyle_m = STYLE_4 then
		hotspot  A-minWallY-fbWidth/2, 0, 0, unID, socleOffset, 1+128				: unID=unID+1
		hotspot  A-minWallY-fbWidth/2, 1, 0, unID, socleOffset, 3 					: unID=unID+1
		hotspot  A-minWallY-fbWidth/2, -socleOffset, 0, unID, socleOffset, 2 		: unID=unID+1

		hotspot  A-minWallY-fbWidth, 0,  0, unID, socleOverh, 1+128					: unID=unID+1
		hotspot  A-minWallY-fbWidth+1, 0, 0, unID, socleOverh, 3 					: unID=unID+1
		hotspot  A-minWallY-fbWidth-socleOverh, 0, 0, unID, socleOverh, 2 			: unID=unID+1

		hotspot  A, fbOpenWidthSide,  0, unID, socleOverh, 1+128					: unID=unID+1
		hotspot  A, -1, 0, unID, socleOverh, 3 										: unID=unID+1
		hotspot  A, fbOpenWidthSide+socleOverh, 0, unID, socleOverh, 2 				: unID=unID+1
	endif

	if fpStyle_m = STYLE_5 then
		hotspot  A-cornerX/2, cornerX/2, 0, unID, socleOffset, 1+128									: unID=unID+1
		hotspot  A-cornerX/2-sqr(2), cornerX/2+sqr(2), 0, unID, socleOffset, 3 							: unID=unID+1
		hotspot  A-cornerX/2+socleOffset/sqr(2), cornerX/2-socleOffset/sqr(2), 0, unID, socleOffset, 2 	: unID=unID+1

		hotspot  A-cornerX-fbOpenWidthSide, 0,  0, unID, socleOverh, 1+128								: unID=unID+1
		hotspot  A-cornerX-fbOpenWidthSide+1, 0, 0, unID, socleOverh, 3 								: unID=unID+1
		hotspot  A-cornerX-fbOpenWidthSide-socleOverh, 0, 0, unID, socleOverh, 2 						: unID=unID+1

		hotspot  A, cornerX+fbOpenWidthSide,  0, unID, socleOverh, 1+128								: unID=unID+1
		hotspot  A, cornerX+fbOpenWidthSide-1, 0, unID, socleOverh, 3 									: unID=unID+1
		hotspot  A, cornerX+fbOpenWidthSide+socleOverh, 0, unID, socleOverh, 2 							: unID=unID+1
	endif
endif


! ======================================================================
! FLUE
! ======================================================================
material mat_flue
if bFlue then
	add A/2, B/2, ZZYZX

	prism_ 9, flue_height,
		0, flue_diameter/2, 79,
		0, 0, 900,
		flue_diameter/2, 180, 4079,
		0, -flue_diameter/2, 79,
		0, 0, 900,
		flue_diameter/2, 180, 4079,
		0, flue_diameter/2, -1,
		0, 0, 900,
		flue_diameter/2 - flue_wallthk, 360, 4079

	del 1

	hotspot  A/2, B/2, ZZYZX, unID, flue_height, 1				: unID=unID+1
	hotspot  A/2, B/2, ZZYZX-1, unID, flue_height, 3 			: unID=unID+1
	hotspot  A/2, B/2, ZZYZX+flue_height, unID, flue_height,2 	: unID=unID+1
endif



END



! ======================================================================
! SubRoutines
! ======================================================================

"FireBox Cutter":
	addZ fbOpenH
	if fpStyle_m = STYLE_1 then
		put	fpWidthSide, fbGlassBack+thicknes, 15
		put	fpWidthSide, minWallY, 15
		put	minWall, minWallY, 15
		put	minWall, fbDepth, 15
		put	A-minWall, fbDepth, 15
		put	A-minWall, minWallY, 15
		put	fpWidthSide+fbWidth, minWallY, 15
		put	fpWidthSide+fbWidth, fbGlassBack+thicknes, 15
		put	fpWidthSide, fbGlassBack+thicknes, -1

		cprism_ mat_fb, mat_fb, mat_fb,
			NSP/3, fbH, use(NSP)

		if bFlush or bSocle then addz -bFlush*flushHeight-bSocle*socleHeight
		cprism_ mat_fp, mat_fp, mat_fp,
			4, fbH + bCornice*corniceHeight + bFlush*flushHeight + bSocle*socleHeight,
			fpWidthSide, 0, 15,
			fpWidthSide, fbGlassBack+thicknes, 15,
			fpWidthSide+fbWidth, fbGlassBack+thicknes, 15,
			fpWidthSide+fbWidth, 0, 15
		if bFlush or bSocle then del 1
	endif

	if fpStyle_m = STYLE_2 then
		put	fpWidthSide, fbGlassBack+thicknes, 15
		put	fpWidthSide, minWallY, 15
		put	minWall, minWallY, 15
		put	minWall, B-minWallY, 15
		put	fpWidthSide, B-minWallY, 15
		put	fpWidthSide, B-fbGlassBack-thicknes, 15
		put	fpWidthSide+fbWidth, B-fbGlassBack-thicknes, 15
		put	fpWidthSide+fbWidth, B-minWallY, 15
		put	A-minWall, B-minWallY, 15
		put	A-minWall, minWallY, 15
		put	fpWidthSide+fbWidth, minWallY, 15
		put	fpWidthSide+fbWidth, fbGlassBack+thicknes, 15
		put	fpWidthSide, fbGlassBack+thicknes, -1

		cprism_ mat_fb, mat_fb, mat_fb,
			NSP/3, fbH, use(NSP)

		if bFlush or bSocle then addz -bFlush*flushHeight-bSocle*socleHeight
		cprism_ mat_fp, mat_fp, mat_fp,
			4, fbH + bCornice*corniceHeight + bFlush*flushHeight + bSocle*socleHeight,
			fpWidthSide, 0, 15,
			fpWidthSide, fbGlassBack+thicknes, 15,
			fpWidthSide+fbWidth, fbGlassBack+thicknes, 15,
			fpWidthSide+fbWidth, 0, 15

		cprism_ mat_fp, mat_fp, mat_fp,
			4, fbH + bCornice*corniceHeight + bFlush*flushHeight + bSocle*socleHeight,
			fpWidthSide, B, 15,
			fpWidthSide, B-fbGlassBack-thicknes, 15,
			fpWidthSide+fbWidth, B-fbGlassBack-thicknes, 15,
			fpWidthSide+fbWidth, B, 15
		if bFlush or bSocle then del 1
	endif

	if fpStyle_m = STYLE_3 then
		put	fbGlassBack+thicknes, fbGlassBack+thicknes, 15
		put	A-fbGlassBack-thicknes, fbGlassBack+thicknes, 15
		put	A-fbGlassBack-thicknes, fbDepth, 15
		put	A-minWallY, fbDepth, 15
		put	A-minWallY, B-minWall, 15
		put	minWallY, B-minWall, 15
		put	minWallY, fbDepth, 15
		put	fbGlassBack+thicknes, fbDepth, 15
		put	fbGlassBack+thicknes, fbGlassBack+thicknes, -1

		cprism_ mat_fb, mat_fb, mat_fb,
			NSP/3, fbH, use(NSP)

		if bFlush or bSocle then addz -bFlush*flushHeight-bSocle*socleHeight
		cprism_ mat_fp, mat_fp, mat_fp,
			8, fbH + bCornice*corniceHeight + bFlush*flushHeight + bSocle*socleHeight,
			0, 0, 15,
			A, 0, 15,
			A, fbDepth, 15,
			A-fbGlassBack-thicknes, fbDepth, 15,
			A-fbGlassBack-thicknes, fbGlassBack+thicknes, 15,
			fbGlassBack+thicknes, fbGlassBack+thicknes, 15,
			fbGlassBack+thicknes, fbDepth, 15,
			0, fbDepth, 15
		if bFlush or bSocle then del 1
	endif

	if fpStyle_m = STYLE_4 then
		put	minWall, minWallY+thicknes, 15
		put	A-fbWidth-minWallY, minWallY+thicknes, 15
		put	A-fbWidth-minWallY, fbGlassBack+thicknes, 15
		put	A-fbGlassBack-thicknes, fbGlassBack+thicknes, 15
		put	A-fbGlassBack-thicknes, fbOpenWidthSide, 15
		put	A-minWallY-thicknes, fbOpenWidthSide, 15
		put	A-minWallY-thicknes, B-minWall, 15
		put	minWall, B-minWall, 15
		put	minWall, minWallY+thicknes, -1

		cprism_ mat_fb, mat_fb, mat_fb,
			NSP/3, fbH, use(NSP)

		if bFlush or bSocle then addz -bFlush*flushHeight-bSocle*socleHeight
		cprism_ mat_fp, mat_fp, mat_fp,
			6, fbH + bCornice*corniceHeight + bFlush*flushHeight + bSocle*socleHeight,
			A-fbWidth-minWallY, 0, 15,
			A-fbWidth-minWallY, fbGlassBack+thicknes, 15,
			A-fbGlassBack-thicknes, fbGlassBack+thicknes, 15,
			A-fbGlassBack-thicknes, fbOpenWidthSide, 15,
			A, fbOpenWidthSide, 15,
			A, 0, 15
		if bFlush or bSocle then del 1
	endif

	if fpStyle_m = STYLE_5 then
		put	minWall, minWallY, 15
		put	A-cornerX-fbOpenWidthSide, minWallY, 15
		put	A-cornerX-fbOpenWidthSide, fbGlassBack+thicknes, 15
		put	A-cornerX-tan(halfAlfa)*(fbGlassBack+thicknes), fbGlassBack+thicknes, 15
		put	A-fbGlassBack-thicknes, cornerX+tan(halfAlfa)*(fbGlassBack+thicknes), 15
		put	A-fbGlassBack-thicknes, cornerX+fbOpenWidthSide, 15
		put	A-minWallY, cornerX+fbOpenWidthSide, 15
		put	A-minWallY, B-minWall, 15
		put	minWall, B-minWall, 15
		put	minWall, minWallY, -1

		cprism_ mat_fb, mat_fb, mat_fb,
			NSP/3, fbH, use(NSP)

		if bFlush or bSocle then addz -bFlush*flushHeight-bSocle*socleHeight
		cprism_ mat_fp, mat_fp, mat_fp,
			8, fbH + bCornice*corniceHeight + bFlush*flushHeight + bSocle*socleHeight,
			A-cornerX-fbOpenWidthSide, fbGlassBack+thicknes, 15,
			A-cornerX-fbOpenWidthSide, 0, 15,
			A-cornerX, 0, 15,
			A, cornerX, 15,
			A, cornerX+fbOpenWidthSide, 15,
			A-fbGlassBack-thicknes, cornerX+fbOpenWidthSide, 15,
			A-fbGlassBack-thicknes, cornerX+tan(halfAlfa)*(fbGlassBack+thicknes), 15,
			A-cornerX-tan(halfAlfa)*(fbGlassBack+thicknes), fbGlassBack+thicknes, 15
		if bFlush or bSocle then del 1
	endif

	del 1
return


!-----! FireBox Top-----
"FireBox_Top":
	if fpStyle_m = STYLE_1 then
		prism_ 8, thicknes,
			fpWidthSide+thicknes, fbGlassBack+2*thicknes, 15,
			fpWidthSide+thicknes, minWallY+thicknes, 15,
			minWall+thicknes, minWallY+thicknes, 15,
			minWall+thicknes, fbDepth-thicknes, 15,
			A-minWall-thicknes, fbDepth-thicknes, 15,
			A-minWall-thicknes, minWallY+thicknes, 15,
			fpWidthSide+fbWidth-thicknes, minWallY+thicknes, 15,
			fpWidthSide+fbWidth-thicknes, fbGlassBack+2*thicknes, 15
	endif

	if fpStyle_m = STYLE_2 then
		prism_ 12, thicknes,
			fpWidthSide+thicknes, fbGlassBack+2*thicknes, 15,
			fpWidthSide+thicknes, minWallY+thicknes, 15,
			minWall+thicknes, minWallY+thicknes, 15,
			minWall+thicknes, B-minWallY-thicknes, 15,
			fpWidthSide+thicknes, B-minWallY-thicknes, 15,
			fpWidthSide+thicknes, B-fbGlassBack-2*thicknes, 15,
			fpWidthSide+fbWidth-thicknes, B-fbGlassBack-2*thicknes, 15,
			fpWidthSide+fbWidth-thicknes, B-minWallY-thicknes, 15,
			A-minWall-thicknes, B-minWallY-thicknes, 15,
			A-minWall-thicknes, minWallY+thicknes, 15,
			fpWidthSide+fbWidth-thicknes, minWallY+thicknes, 15,
			fpWidthSide+fbWidth-thicknes, fbGlassBack+2*thicknes, 15
	endif

	if fpStyle_m = STYLE_3 then
		prism_ 8, thicknes,
			fbGlassBack+2*thicknes, fbGlassBack+2*thicknes, 15,
			A-fbGlassBack-2*thicknes, fbGlassBack+2*thicknes, 15,
			A-fbGlassBack-2*thicknes, fbDepth-thicknes, 15,
			A-minWallY-thicknes, fbDepth-thicknes, 15,
			A-minWallY-thicknes, B-minWall-thicknes, 15,
			minWallY+thicknes, B-minWall-thicknes, 15,
			minWallY+thicknes, fbDepth-thicknes, 15,
			fbGlassBack+2*thicknes, fbDepth-thicknes, 15
	endif

	if fpStyle_m = STYLE_4 then
		prism_ 8, thicknes,
			minWall+thicknes, minWallY+2*thicknes, 15,
			A-fbWidth-minWallY+thicknes, minWallY+2*thicknes, 15,
			A-fbWidth-minWallY+thicknes, fbGlassBack+2*thicknes, 15,
			A-fbGlassBack-2*thicknes, fbGlassBack+2*thicknes, 15,
			A-fbGlassBack-2*thicknes, fbOpenWidthSide-thicknes, 15,
			A-minWallY-2*thicknes, fbOpenWidthSide-thicknes, 15,
			A-minWallY-2*thicknes, B-minWall-thicknes, 15,
			minWall+thicknes, B-minWall-thicknes, 15
	endif

	if fpStyle_m = STYLE_5 then
		prism_ 9, thicknes,
			minWall+thicknes, minWallY+thicknes, 15,
			A-cornerX-fbOpenWidthSide+thicknes, minWallY+thicknes, 15,
			A-cornerX-fbOpenWidthSide+thicknes, fbGlassBack+2*thicknes, 15,
			A-cornerX-tan(halfAlfa)*(fbGlassBack+2*thicknes), fbGlassBack+2*thicknes, 15,
			A-fbGlassBack-2*thicknes, cornerX+tan(halfAlfa)*(fbGlassBack+2*thicknes), 15,
			A-fbGlassBack-2*thicknes, cornerX+fbOpenWidthSide-thicknes, 15,
			A-minWallY-thicknes, cornerX+fbOpenWidthSide-thicknes, 15,
			A-minWallY-thicknes, B-minWall-thicknes, 15,
			minWall+thicknes, B-minWall-thicknes, 15
	endif
return


!-----! FireBox Side-----
"FireBox_Side":
	holeY1 = doorOffset
	holeY2 = fbH-doorOffset
	if fpStyle_m = STYLE_1 then
		if gs_detlevel_3D_m = 2 and not(GLOB_CONTEXT>20 and GLOB_CONTEXT<40) then
			holeX1 = fpWidthSide+doorOffset
			holeX2 = fpWidthSide+fbWidth-doorOffset
			holeZ1 = -minWallY-thicknes
			holeZ2 = B
			gosub "FireBox_Side_Hole"
			prism_ NSP/3+9, fbH,
				get(NSP),
				fpWidthSide+thicknes, fbGlassBack+2*thicknes, 15,
				fpWidthSide+thicknes, minWallY+thicknes, 15,
				minWall+thicknes, minWallY+thicknes, 15,
				minWall+thicknes, fbDepth-thicknes, 15,
				A-minWall-thicknes, fbDepth-thicknes, 15,
				A-minWall-thicknes, minWallY+thicknes, 15,
				fpWidthSide+fbWidth-thicknes, minWallY+thicknes, 15,
				fpWidthSide+fbWidth-thicknes, fbGlassBack+2*thicknes, 15,
				fpWidthSide+thicknes, fbGlassBack+2*thicknes, -1
			cutend
		endif
		holeX1 = fpWidthSide+doorReduced
		holeX2 = fpWidthSide+fbWidth-doorReduced
		rotx 90
		addz -fbGlassBack-thicknes
		gosub "FireBox_Door_Flat":
		del 2
	endif

	if fpStyle_m = STYLE_2 then
		if gs_detlevel_3D_m = 2 and not(GLOB_CONTEXT>20 and GLOB_CONTEXT<40) then
			holeX1 = fpWidthSide+doorOffset
			holeX2 = fpWidthSide+fbWidth-doorOffset
			holeZ1 = 0
			holeZ2 = B
			gosub "FireBox_Side_Hole"
			prism_ NSP/3+13, fbH,
				use(NSP),
				fpWidthSide+thicknes, fbGlassBack+2*thicknes, 15,
				fpWidthSide+thicknes, minWallY+thicknes, 15,
				minWall+thicknes, minWallY+thicknes, 15,
				minWall+thicknes, B-minWallY-thicknes, 15,
				fpWidthSide+thicknes, B-minWallY-thicknes, 15,
				fpWidthSide+thicknes, B-fbGlassBack-2*thicknes, 15,
				fpWidthSide+fbWidth-thicknes, B-fbGlassBack-2*thicknes, 15,
				fpWidthSide+fbWidth-thicknes, B-minWallY-thicknes, 15,
				A-minWall-thicknes, B-minWallY-thicknes, 15,
				A-minWall-thicknes, minWallY+thicknes, 15,
				fpWidthSide+fbWidth-thicknes, minWallY+thicknes, 15,
				fpWidthSide+fbWidth-thicknes, fbGlassBack+2*thicknes, 15,
				fpWidthSide+thicknes, fbGlassBack+2*thicknes, -1
			cutend
		endif
		holeX1 = fpWidthSide+doorReduced
		holeX2 = fpWidthSide+fbWidth-doorReduced
		rotx 90
		addz -fbGlassBack-thicknes
		gosub "FireBox_Door_Flat":
		del 1
		addz -B+fbGlassBack
		gosub "FireBox_Door_Flat":
		del 2
	endif

	if fpStyle_m = STYLE_3 and not(GLOB_CONTEXT>20 and GLOB_CONTEXT<40) then
		if gs_detlevel_3D_m = 2 then
			holeX1 = 0
			holeX2 = A
			holeZ1 = -fbOpenWidthSide+doorOffset
			holeZ2 = B
			gosub "FireBox_Side_Hole"
			prism_ NSP/3+9, fbH,
				use(NSP),
				fbGlassBack+2*thicknes, fbGlassBack+2*thicknes, 15,
				A-fbGlassBack-2*thicknes, fbGlassBack+2*thicknes, 15,
				A-fbGlassBack-2*thicknes, fbDepth-thicknes, 15,
				A-minWallY-thicknes, fbDepth-thicknes, 15,
				A-minWallY-thicknes, B-minWall-thicknes, 15,
				minWallY+thicknes, B-minWall-thicknes, 15,
				minWallY+thicknes, fbDepth-thicknes, 15,
				fbGlassBack+2*thicknes, fbDepth-thicknes, 15,
				fbGlassBack+2*thicknes, fbGlassBack+2*thicknes, -1
			cutend
		endif
		gosub "FireBox_Door_U"
	endif

	if fpStyle_m = STYLE_4 and not(GLOB_CONTEXT>20 and GLOB_CONTEXT<40) then
		if gs_detlevel_3D_m = 2 then
			holeX1 = A-fbWidth-minWallY+doorOffset
			holeX2 = A
			holeZ1 = -fbOpenWidthSide+doorOffset
			holeZ2 = B
			gosub "FireBox_Side_Hole"
			prism_ NSP/3+9, fbH,
				use(NSP),
				minWall+thicknes, minWallY+2*thicknes, 15,
				A-fbWidth-minWallY+thicknes, minWallY+2*thicknes, 15,
				A-fbWidth-minWallY+thicknes, fbGlassBack+2*thicknes, 15,
				A-fbGlassBack-2*thicknes, fbGlassBack+2*thicknes, 15,
				A-fbGlassBack-2*thicknes, fbOpenWidthSide-thicknes, 15,
				A-minWallY-2*thicknes, fbOpenWidthSide-thicknes, 15,
				A-minWallY-2*thicknes, B-minWall-thicknes, 15,
				minWall+thicknes, B-minWall-thicknes, 15,
				minWall+thicknes, minWallY+2*thicknes, -1
			cutend
		endif
		gosub "FireBox_Door_Corner"
	endif

	if fpStyle_m = STYLE_5 then
		if gs_detlevel_3D_m = 2 and not(GLOB_CONTEXT>20 and GLOB_CONTEXT<40) then
			holeX1 = A-cornerX-fbOpenWidthSide+doorOffset
			holeX2 = A
			holeZ1 = -cornerX-fbOpenWidthSide+doorOffset
			holeZ2 = B
			gosub "FireBox_Side_Hole"
			prism_ NSP/3+10, fbH,
				use(NSP),
				minWall+thicknes, minWallY+thicknes, 15,
				A-cornerX-fbOpenWidthSide+thicknes, minWallY+thicknes, 15,
				A-cornerX-fbOpenWidthSide+thicknes, fbGlassBack+2*thicknes, 15,
				A-cornerX-tan(halfAlfa)*(fbGlassBack+2*thicknes), fbGlassBack+2*thicknes, 15,
				A-fbGlassBack-2*thicknes, cornerX+tan(halfAlfa)*(fbGlassBack+2*thicknes), 15,
				A-fbGlassBack-2*thicknes, cornerX+fbOpenWidthSide-thicknes, 15,
				A-minWallY-thicknes, cornerX+fbOpenWidthSide-thicknes, 15,
				A-minWallY-thicknes, B-minWall-thicknes, 15,
				minWall+thicknes, B-minWall-thicknes, 15,
				minWall+thicknes, minWallY+thicknes, -1
			cutend
		endif
		gosub "FireBox_Door_Prism"
	endif
return


!-----! FireBox Side Hole-----
"FireBox_Side_Hole":
	rotx 90
	cutpolya 4, 0, holeZ1,
		holeX1, holeY1, 23,
		holeX2, holeY1, 23,
		holeX2, holeY2, 23,
		holeX1, holeY2, 23,
		0, 0, holeZ2
	del 1
return


!-----! FireBox Door Flat-----
"FireBox_Door_Flat":
	material mat_fb
	prism_ 10, thicknes,
		holeX1, doorReduced, 15,
		holeX2, doorReduced, 15,
		holeX2, fbH-doorReduced, 15,
		holeX1, fbH-doorReduced, 15,
		holeX1, doorReduced, -1,
		holeX1+fbFrame, doorReduced+fbFrame, 15,
		holeX2-fbFrame, doorReduced+fbFrame, 15,
		holeX2-fbFrame, fbH-doorReduced-fbFrame, 15,
		holeX1+fbFrame, fbH-doorReduced-fbFrame, 15,
		holeX1+fbFrame, doorReduced+fbFrame, -1

	body -1
	material mat_glass
	addz thicknes/4
	prism_ 4, thicknes/2,
		holeX1+fbFrame, doorReduced+fbFrame, 15,
		holeX2-fbFrame, doorReduced+fbFrame, 15,
		holeX2-fbFrame, fbH-doorReduced-fbFrame, 15,
		holeX1+fbFrame, fbH-doorReduced-fbFrame, 15
	del 1

	if bFirePicture and bFire then
		add holeX1+fbFrame, doorReduced+fbFrame, 0
		material pictureMat
		picture "fire_2", holeX2-fbFrame - (holeX1+fbFrame), fbH-doorReduced-fbFrame - (doorReduced+fbFrame), 0  		! fire_2.jpg
		del 1
	endif
return


!-----! FireBox Door U-----
"FireBox_Door_U":
	addz doorReduced
	holeX1 = 0
	holeX2 = A
	holeY1 = fbFrame
	holeY2 = fbH-2*doorReduced-fbFrame
	holeZ1 = -fbOpenWidthSide+doorReduced+fbFrame
	holeZ2 = B
	gosub "FireBox_Side_Hole"
	prism_ 8, fbH-2*doorReduced,
		fbGlassBack, fbOpenWidthSide-doorReduced, 15,
		fbGlassBack, fbGlassBack, 15,
		A-fbGlassBack, fbGlassBack, 15,
		A-fbGlassBack, fbOpenWidthSide-doorReduced, 15,
		A-fbGlassBack-thicknes, fbOpenWidthSide-doorReduced, 15,
		A-fbGlassBack-thicknes, fbGlassBack+thicknes, 15,
		fbGlassBack+thicknes, fbGlassBack+thicknes, 15,
		fbGlassBack+thicknes, fbOpenWidthSide-doorReduced, 15
	del 1
	cutend

	body -1
	material mat_glass
	addz fbFrame+doorReduced
	prism_ 4, fbH-2*doorReduced-2*fbFrame,
		fbGlassBack+thicknes/4, fbOpenWidthSide-doorReduced-fbFrame, 15,
		fbGlassBack+thicknes/4, fbGlassBack+thicknes/4, 15,
		fbGlassBack+thicknes-thicknes/4, fbGlassBack+thicknes-thicknes/4, 15,
		fbGlassBack+thicknes-thicknes/4, fbOpenWidthSide-doorReduced-fbFrame, 15

	prism_ 4, fbH-2*doorReduced-2*fbFrame,
		A-fbGlassBack-thicknes/4, fbGlassBack+thicknes/4, 15,
		A-fbGlassBack-thicknes/4, fbOpenWidthSide-doorReduced-fbFrame, 15,
		A-fbGlassBack-thicknes+thicknes/4, fbOpenWidthSide-doorReduced-fbFrame, 15,
		A-fbGlassBack-thicknes+thicknes/4, fbGlassBack+thicknes-thicknes/4, 15

	prism_ 4, fbH-2*doorReduced-2*fbFrame,
		fbGlassBack+thicknes/4, fbGlassBack+thicknes/4, 15,
		A-fbGlassBack-thicknes/4, fbGlassBack+thicknes/4, 15,
		A-fbGlassBack-thicknes+thicknes/4, fbGlassBack+thicknes-thicknes/4, 15,
		fbGlassBack+thicknes-thicknes/4, fbGlassBack+thicknes-thicknes/4, 15
	del 1

	if bFirePicture and bFire then
		rotx 90
		add minWallY, 0, -fbOpenWidthSide
		material pictureMat
		picture "fire_2", A-2*minWallY, fbH, 0  			! fire_2.jpg
		del 2
	endif
return


!-----! FireBox Door Corner-----
"FireBox_Door_Corner":
	addz doorReduced
	holeX1 = A-fbWidth-minWallY+doorReduced+fbFrame
	holeX2 = A
	holeY1 = fbFrame
	holeY2 = fbH-2*doorReduced-fbFrame
	holeZ1 = -fbOpenWidthSide+doorReduced+fbFrame
	holeZ2 = B
	gosub "FireBox_Side_Hole"
	prism_ 6, fbH-2*doorReduced,
		A-fbGlassBack-thicknes, fbOpenWidthSide-doorReduced, 15,
		A-fbGlassBack, fbOpenWidthSide-doorReduced, 15,
		A-fbGlassBack, fbGlassBack, 15,
		A-fbWidth-minWallY+doorReduced, fbGlassBack, 15,
		A-fbWidth-minWallY+doorReduced, fbGlassBack+thicknes, 15,
		A-fbGlassBack-thicknes, fbGlassBack+thicknes, 15
	del 1
	cutend

	body -1
	material mat_glass
	addz fbFrame+doorReduced
	prism_ 4, fbH-2*doorReduced-2*fbFrame,
		A-fbGlassBack-thicknes+thicknes/4, fbOpenWidthSide-doorReduced-fbFrame, 15,
		A-fbGlassBack-thicknes+thicknes/4, fbGlassBack+thicknes-thicknes/4, 15,
		A-fbGlassBack-thicknes/4, fbGlassBack+thicknes/4, 15,
		A-fbGlassBack-thicknes/4, fbOpenWidthSide-doorReduced-fbFrame, 15

	prism_ 4, fbH-2*doorReduced-2*fbFrame,
		A-fbGlassBack-thicknes+thicknes/4, fbGlassBack+thicknes-thicknes/4, 15,
		A-fbWidth-minWallY+doorReduced+fbFrame, fbGlassBack+thicknes-thicknes/4, 15,
		A-fbWidth-minWallY+doorReduced+fbFrame, fbGlassBack+thicknes/4, 15,
		A-fbGlassBack-thicknes/4, fbGlassBack+thicknes/4, 15
	del 1

	if bFirePicture and bFire then
		rotx 90
		add A-fbWidth-minWallY, 0, -minWallY-2*thicknes
		roty atn(fbOpenWidthSide/fbWidth)
		material pictureMat
		picture "fire_2", sqr((fbOpenWidthSide-thicknes)**2 + (fbWidth-thicknes)**2), fbH, 0  			! fire_2.jpg
		del 3
	endif
return



!-----! FireBox Door Prism-----
"FireBox_Door_Prism":
	addz doorReduced
	holeX1 = A-cornerX-fbOpenWidthSide+doorReduced+fbFrame
	holeX2 = A
	holeY1 = fbFrame
	holeY2 = fbH-2*doorReduced-fbFrame
	holeZ1 = -cornerX-fbOpenWidthSide+doorReduced+fbFrame
	holeZ2 = B
	gosub "FireBox_Side_Hole"
	prism_ 8, fbH-2*doorReduced,
		A-cornerX-fbOpenWidthSide+doorReduced, fbGlassBack, 15,
		A-cornerX-fbOpenWidthSide+doorReduced, fbGlassBack+thicknes, 15,
		A-cornerX-tan(halfAlfa)*(fbGlassBack+thicknes), fbGlassBack+thicknes, 15,
		A-fbGlassBack-thicknes, cornerX+tan(halfAlfa)*(fbGlassBack+thicknes), 15,
		A-fbGlassBack-thicknes, cornerX+fbOpenWidthSide-doorReduced, 15,
		A-fbGlassBack, cornerX+fbOpenWidthSide-doorReduced, 15,
		A-fbGlassBack, cornerX+tan(halfAlfa)*(fbGlassBack), 15,
		A-cornerX-tan(halfAlfa)*(fbGlassBack), fbGlassBack, 15
	del 1
	cutend

	body -1
	material mat_glass
	addz fbFrame+doorReduced
	prism_ 4, fbH-2*doorReduced-2*fbFrame,
		A-cornerX-fbOpenWidthSide+doorReduced+fbFrame, fbGlassBack+thicknes/4, 15,
		A-cornerX-tan(halfAlfa)*(fbGlassBack+thicknes/4), fbGlassBack+thicknes/4, 15,
		A-cornerX-tan(halfAlfa)*(fbGlassBack+thicknes-thicknes/4), fbGlassBack+thicknes-thicknes/4, 15,
		A-cornerX-fbOpenWidthSide+doorReduced+fbFrame, fbGlassBack+thicknes-thicknes/4, 15

	prism_ 4, fbH-2*doorReduced-2*fbFrame,
		A-fbGlassBack-thicknes/4, cornerX+tan(halfAlfa)*(fbGlassBack+thicknes/4), 15,
		A-fbGlassBack-thicknes+thicknes/4, cornerX+tan(halfAlfa)*(fbGlassBack+thicknes-thicknes/4), 15,
		A-fbGlassBack-thicknes+thicknes/4, cornerX+fbOpenWidthSide-doorReduced-fbFrame, 15,
		A-fbGlassBack-thicknes/4, cornerX+fbOpenWidthSide-doorReduced-fbFrame, 15

	prism_ 4, fbH-2*doorReduced-2*fbFrame,
		A-fbGlassBack-thicknes/4, cornerX+tan(halfAlfa)*(fbGlassBack+thicknes/4), 15,
		A-fbGlassBack-thicknes+thicknes/4, cornerX+tan(halfAlfa)*(fbGlassBack+thicknes-thicknes/4), 15,
		A-cornerX-tan(halfAlfa)*(fbGlassBack+thicknes-thicknes/4), fbGlassBack+thicknes-thicknes/4, 15,
		A-cornerX-tan(halfAlfa)*(fbGlassBack+thicknes/4), fbGlassBack+thicknes/4, 15
	del 1

	if bFirePicture and bFire then
		rotx 90
		add A-cornerX-fbOpenWidthSide, 0, -minWallY-thicknes
		roty 45
		material pictureMat
		picture "fire_2", sqr((cornerX+fbOpenWidthSide-minWallY-thicknes)**2 + (cornerX+fbOpenWidthSide-minWallY-thicknes)**2), fbH, 0  			! fire_2.jpg
		del 3
	endif
return


!-----! Details-----
"Details":
	if fpStyle_m = STYLE_1 or fpStyle_m = STYLE_2 then
		cprism_ detMat, detMat, detMat,
			8, height,
			fpWidthSide, fbGlassBack+thicknes, 15,
			fpWidthSide, 0, 15,
			fpWidthSide-overHang, 0, 15,
			fpWidthSide-overHang, -offset, 15,
			fpWidthSide+fbWidth+overHang, -offset, 15,
			fpWidthSide+fbWidth+overHang, 0, 15,
			fpWidthSide+fbWidth, 0, 15,
			fpWidthSide+fbWidth, fbGlassBack+thicknes, 15
		gosub "Texture_01"
	endif

	if fpStyle_m = STYLE_3 then
		cprism_ detMat, detMat, detMat,
			6, height,
			0, fbOpenWidthSide+overHang, 15,
			0, fbOpenWidthSide, 15,
			fbGlassBack+thicknes, fbOpenWidthSide, 15,
			fbGlassBack+thicknes, fbGlassBack+thicknes, 10,
			-offset, -offset, 15,
			-offset, fbOpenWidthSide+overHang, 15
		gosub "Texture_02"

		cprism_ detMat, detMat, detMat,
			4, height,
			fbGlassBack+thicknes, fbGlassBack+thicknes, 15,
			A-fbGlassBack-thicknes, fbGlassBack+thicknes, 10,
			A+offset, -offset, 15,
			-offset, -offset, 10
		gosub "Texture_01"

		cprism_ detMat, detMat, detMat,
			6, height,
			A-fbGlassBack-thicknes, fbGlassBack+thicknes, 15,
			A-fbGlassBack-thicknes, fbOpenWidthSide, 15,
			A, fbOpenWidthSide, 15,
			A, fbOpenWidthSide+overHang, 15,
			A+offset, fbOpenWidthSide+overHang, 15,
			A+offset, -offset, 10
		gosub "Texture_02"
	endif

	if fpStyle_m = STYLE_4 then
		cprism_ detMat, detMat, detMat,
			6, height,
			A-fbWidth-minWallY-overHang, -offset, 15,
			A-fbWidth-minWallY-overHang, 0, 15,
			A-fbWidth-minWallY, 0, 15,
			A-fbWidth-minWallY, fbGlassBack+thicknes, 15,
			A-fbGlassBack-thicknes, fbGlassBack+thicknes, 10,
			A+offset, -offset, 15
		gosub "Texture_01"

		cprism_ detMat, detMat, detMat,
			6, height,
			A-fbGlassBack-thicknes, fbGlassBack+thicknes, 15,
			A-fbGlassBack-thicknes, fbOpenWidthSide, 15,
			A, fbOpenWidthSide, 15,
			A, fbOpenWidthSide+overHang, 15,
			A+offset, fbOpenWidthSide+overHang, 15,
			A+offset, -offset, 10
		gosub "Texture_02"
	endif

	if fpStyle_m = STYLE_5 then
		cprism_ detMat, detMat, detMat,
			6, height,
			A-cornerX-fbOpenWidthSide-overHang, -offset, 15,
			A-cornerX-fbOpenWidthSide-overHang, 0, 15,
			A-cornerX-fbOpenWidthSide, 0, 15,
			A-cornerX-fbOpenWidthSide, fbGlassBack+thicknes, 15,
			A-cornerX-tan(halfAlfa)*(fbGlassBack+thicknes), fbGlassBack+thicknes, 10,
			A-cornerX+tan(halfAlfa)*(offset), -offset, 15
		gosub "Texture_01"

		cprism_ detMat, detMat, detMat,
			4, height,
			A-cornerX-tan(halfAlfa)*(fbGlassBack+thicknes), fbGlassBack+thicknes, 15,
			A-fbGlassBack-thicknes, cornerX+tan(halfAlfa)*(fbGlassBack+thicknes), 10,
			A+offset, cornerX-tan(halfAlfa)*(offset), 15,
			A-cornerX+tan(halfAlfa)*(offset), -offset, 10
		gosub "Texture_03"

		cprism_ detMat, detMat, detMat,
			6, height,
			A-fbGlassBack-thicknes, cornerX+tan(halfAlfa)*(fbGlassBack+thicknes), 15,
			A-fbGlassBack-thicknes, cornerX+fbOpenWidthSide, 15,
			A, cornerX+fbOpenWidthSide, 15,
			A, cornerX+fbOpenWidthSide+overHang, 15,
			A+offset, cornerX+fbOpenWidthSide+overHang, 15,
			A+offset, cornerX-tan(halfAlfa)*(offset), 10
		gosub "Texture_02"

	endif
return

!-----! Texture-----
"Texture_01":
	base
	vert 0, 0, 0
	vert 1, 0, 0
	vert 0, 1, 0
	vert 0, 0, 1

	coor 2+256, -1, -2, -3, -4
	body -1
return

"Texture_02":
	base
	vert 0,	0, 0
	vert 0,	1, 0
	vert 1,	0, 0
	vert 0,	0, 1

	coor 2+256, -1, -2, -3, -4
	body -1
return

"Texture_03":
	rotz 45
	base
	vert 0, 0, 0
	vert 1, 0, 0
	vert 0, 1, 0
	vert 0, 0, 1

	coor 2+256, -1, -2, -3, -4
	body -1
	del 1
return


!-----! Fire-----
"Fire":
	!mul 0.6,0.6,0.8
	mul flameScale, flameScale, flameScale
	rotx 90
	material mat_flame

	for i=1 to 3
	POLY_    95,
			   -0.129043,     0.302607,      1,
			   -0.346118,     0.224719,    900,
				0.0,     -31.1873,   4001,
			   -0.120081,     0.178941,      1,
			   -0.3843,     0.379142,    900,
				0.0,      13.3511,   4001,
			   -0.080992,     0.245364,      1,
			   -0.189805,     0.289821,    900,
				0.0,      30.548,   4001,
			   -0.0735,     0.30684,      1,
				0.050842,     0.32425,    900,
				0.0,     -45.079,   4001,
			   -0.049287,     0.4,      1,
				0.23656,     0.390482,    900,
				0.0,      14.6556,   4001,
			   -0.042395,     0.327369,      1,
			   -0.281144,     0.273306,    900,
				0.0,     -26.1583,   4001,
			   -0.043014,     0.216578,      1,
			   -0.235291,     0.333978,    900,
				0.0,      15.1135,   4001,
			   -0.019055,     0.270772,      1,
			   -0.120953,     0.298418,    900,
				0.0,      29.2016,   4001,
			   -0.018517,     0.323999,      1,
				0.094462,     0.353887,    900,
				0.0,     -14.7193,   4001,
			   -0.022403,     0.353686,      1,
			   -0.079215,     0.275515,    900,
				0.0,     -21.5781,   4001,
				0.002364,     0.327314,      1,
			   -0.070116,     0.28175,    900,
				0.0,     -19.2236,   4001,
				0.013325,     0.300909,      1,
			   -0.23017,     0.246977,    900,
				0.0,    -6.602259,   4001,
				0.017911,     0.272555,      1,
				0.348755,     0.311202,    900,
				0.0,      10.4851,   4001,
				0.030468,     0.212994,      1,
			   -0.068765,     0.302066,    900,
				0.0,      57.3478,   4001,
				0.059771,     0.337559,      1,
				0.196422,     0.375604,    900,
				0.0,    -4.163671,   4001,
				0.057369,     0.347581,      1,
				0.102858,     0.356725,    900,
				0.0,     -13.9188,   4001,
				0.056505,     0.358791,      1,
				0.106785,     0.356181,    900,
				0.0,     -21.4352,   4001,
				0.060937,     0.376986,      1,
			   -0.199912,     0.210733,    900,
				0.0,     -37.0772,   4001,
				0.108432,     0.18611,      1,
				0.015841,     0.270529,    900,
				0.0,      47.1962,   4001,
				0.140692,     0.2811,      1,
				0.008912,     0.18327,    900,
				0.0,     -39.9676,   4001,
				0.172751,     0.173598,      1,
				0.373824,     0.164068,    900,
				0.0,      15.3334,   4001,
				0.177388,     0.120088,      1,
				0.094885,     0.096785,    900,
				0.0,     -79.9669,   4001,
				0.132204,     0.019603,      1,
				0.061295,     0.197184,    900,
				0.0,     -17.2592,   4001,
				0.076324,     0.006561,      1,
			   -0.132883,     1.993124,    900,
				0.0,    -2.197404,   4001,
				0.0,     0.0,      1,
			   -0.001792,     0.0,      1,
				0.006552,     0.783794,    900,
				0.0,    -9.709621,   4001,
			   -0.133863,     0.012635,      1,
			   -0.12247,     0.085503,    900,
				0.0,     -39.9421,   4001,
			   -0.177987,     0.03695,      1,
			   -0.101524,     0.095576,    900,
				0.0,     -46.9528,   4001,
			   -0.196561,     0.111436,      1,
			   -0.065986,     0.091885,    900,
				0.0,     -16.181,   4001,
			   -0.18594,     0.147049,      1,
				0.096429,     0.014348,    900,
				0.0,    -7.542846,   4001,
			   -0.166077,     0.182967,      1,
			   -0.359028,     0.303356,    900,
				0.0,      22.9183,   4001,
			   -0.134427,     0.267609,      1,
				 14.2607,    -1.929091,    900,
				0.0,    -0.139325,   4001,
			   -0.129043,     0.302607,     -1

	roty 60
	next i

	del 5

	rotz 90
	gosub "Firewoods"
	del 1

return

!!!!!!!!!!!*************************** woods
"Firewoods":
	woodSideMat = mat_wood_2
	woodMat = mat_wood_1
	mul woodScale, woodScale, woodScale
	rotx 270.0
	add -0.2, -0.27, woodLength/2

	rotx  12
	rotz  -20
	addz    -woodLength
	wx = 0.11 : wy = 0.2 : wr = 0.03 : gosub "Firewood"
	del 3

	addz    -woodLength
	wx = 0.13 : wy = 0.24 : wr = 0.03 : gosub "Firewood"
	del 1

	rotx -5
	addy 0.05
	addz -woodLength
	wx = 0.05 : wy = 0.17 : wr = 0.02 : gosub "Firewood"
	del  3

	addy    -0.05
	rotz  15
	roty  -8
	addz    -woodLength
	wx = 0.12 : wy = 0.12 : wr = 0.04 : gosub "Firewood"
	del  4

	roty    15
	addx    0.06
	addz    -woodLength
	wx = 0.21 : wy = 0.19 : wr = 0.07 : gosub "Firewood"
	del 3

	addy -0.01
	roty    -15
	rotx    2
	addz    -woodLength
	wx = 0.30 : wy = 0.2 : wr = 0.03 : gosub "Firewood"
	del  4

	addz    -woodLength
	wx = 0.32 : wy = 0.18 : wr = 0.02 : gosub "Firewood"
	del 1

	addy    -0.02
	addz    -woodLength
	wx = 0.30 : wy = 0.13 : wr = 0.028 : gosub "Firewood"
	del  2

	rotx    -8
	roty 20
	addy   -0.05
	addz    -0.45
	addx    -0.05
	wx = 0.35 : wy = 0.2 : wr = 0.04 : gosub "Firewood"
	del 5

	del 3
return

"Firewood":
	cprism_ woodMat,woodMat,woodSideMat,
			2, woodLength,
			wx, wy, 979,
			wr, 360, 4079

	base
	vert 0, 0, 0
	vert 1, 0, 0
	vert 0, 1, 0
	vert 0, 0, 1

	coor 3, -1, -2, -3, -4
	body -1
return
