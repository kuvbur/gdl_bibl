
if not(gs_shadow) then shadow off
if gs_detlevel_3D_m = 2 then	! Detailed
	resol gs_resol
else
	if gs_detlevel_3D_m = 1 then ! Simple
		resol 6
		gs_resol = 6
	else
		END	! Off
	endif
endif

pen gs_cont_pen


unID = 1

! ======================================================================
! BODY
! ======================================================================
material mat_stove
if iStoveType = 1 then gosub "MODERN_TYPE_1"			! Modern Type 1
if iStoveType = 2 then gosub "MODERN_TYPE_2"			! Modern Type 2
if iStoveType = 3 then gosub "MODERN_TYPE_3"			! Modern Type 3
if iStoveType = 4 then gosub "MODERN_TYPE_4"			! Modern Type 4
if iStoveType = 5 then gosub "MODERN_TYPE_5"			! Modern Type 5
if iStoveType = 6 then gosub "TRADITIONAL_TYPE_1"		! Traditional Type 1
if iStoveType = 7 then gosub "TRADITIONAL_TYPE_2"		! Traditional Type 2
if iStoveType = 8 then gosub "TRADITIONAL_TYPE_3"		! Traditional Type 3



! ======================================================================
! FLUE
! ======================================================================
resol gs_resol
material mat_flue
if bFlue then
	if iStoveType = 4 or iStoveType = 2 or iStoveType = 6 then
		if iStoveType = 4 then
			add 0, A/2-0.05-flue_diameter/2, 0
		else
			if iStoveType = 2 then
				add 0, y1+circleOffset2-0.05-flue_diameter/2, 0
			else
				add a/2, b-0.05, 0
			endif
		endif
	else
		add A/2, B-0.05-flue_diameter/2, 0
	endif
	addz ZZYZX
	if flue_height-ZZYZX > 0.2 and gs_detlevel_3D_m = 2 then
		prism_ 9, 0.1,
			0, flue_diameter/2+0.005, 79,
			0, 0, 900,
			flue_diameter/2+0.005, 180, 4079,
			0, -(flue_diameter/2+0.005), 79,
			0, 0, 900,
			flue_diameter/2+0.005, 180, 4079,
			0, flue_diameter/2+0.005, -1,
			0, 0, 900,
			flue_diameter/2, 360, 4079

		addz 0.1
		prism_ 9, abs(flue_height-ZZYZX-0.1),
			0, flue_diameter/2, 79,
			0, 0, 900,
			flue_diameter/2, 180, 4079,
			0, -flue_diameter/2, 79,
			0, 0, 900,
			flue_diameter/2, 180, 4079,
			0, flue_diameter/2, -1,
			0, 0, 900,
			flue_diameter/2 - flue_wallthk, 360, 4079
		del 1
	else
		prism_ 9, abs(flue_height-ZZYZX),
			0, flue_diameter/2, 79,
			0, 0, 900,
			flue_diameter/2, 180, 4079,
			0, -flue_diameter/2, 79,
			0, 0, 900,
			flue_diameter/2, 180, 4079,
			0, flue_diameter/2, -1,
			0, 0, 900,
			flue_diameter/2 - flue_wallthk, 360, 4079
	endif
	del 1

	hotspot 0, 0, ZZYZX, unID : unID = unID + 1

	hotspot 0, 0,  0, unID, flue_height, 1+128		: unID=unID+1
	hotspot 0, 0, -1, unID, flue_height, 3 			: unID=unID+1
	hotspot 0, 0, flue_height, unID, flue_height,2 	: unID=unID+1
	del 1
endif



END


! ======================================================================
! HOTSPOTS
! ======================================================================
"Hotspots":
	call "Resize_A_B_ZZYZX" Parameters ALL
	hotspot A/2, B, 0, unID : unID = unID + 1
	hotspot A/2, B, ZZYZX, unID : unID = unID + 1
return

! ======================================================================
! FIREWOOD
! ======================================================================
"FireWoods":
	!woodLength = 0.5
	!woodA = 0.38
	!woodB = 0.12
	material mat_wood_1

	rotx 90
	mul woodA / 0.38, woodB / 0.12, 1
	addz - woodLength

	prism_ 7, woodLength,
		0.1874925806697, 0.09442154334234,      79,
		0.1622906949251, 0.09442154334234,    900,
				   0,          180,   4079,
		0.1370888091805, 0.09442154334234,      79,
		0.1622906949251, 0.09442154334234,    900,
				   0,          180,   4079,
		0.1874925806697, 0.09442154334234,     -1

	prism_ 6, woodLength,
		0.1836761028174, 0.06918484344611,     79,
		0.1996416336019, 0.04153173295754,     79,
		0.183768797633, 0.06820714241696,    900,
				   0, 120.2963887373,   4079,
		0.1987936552686, 0.09536921237771,      15,
		0.1836761028174, 0.06918484344611,      -1

	prism_ 6, woodLength,
		0.1483207772778, 0.03666089113787,      79,
		0.1697186398675, 0.05096662063161,    900,
				   0, 87.69929966074,   4079,
		0.1831538416548, 0.02901171747341,      15,
		0.1751105089391, 0.07034551059562,      15,
		0.1483207772778, 0.03666089113787,      -1

	prism_ 5, woodLength,
		0.1759516135451, 0.004246951432431,      79,
		0.1474795986678, -0.001671534443873,    900,
				   0, 154.3284830156,   4079,
		0.119254031747, 0.005328571143933,      15,
		0.1759516135451, 0.004246951432431,      -1

	prism_ 5, woodLength,
		0.1071642598031, 0.06321238778577,      15,
		0.07666595623171, 0.01038777645549,      79,
		0.09221865763866, 0.03662482766508,    900,
				   0, 181.3169124058,   4079,
		0.1071642598031, 0.06321238778577,      -1

	prism_ 7, woodLength,
		0.1491639759331, 0.04809194690006,      79,
		0.1364233369115, 0.04809194690006,    900,
				   0,          180,   4079,
		0.1236826978898, 0.04809194690006,      79,
		0.1364233369115, 0.04809194690006,    900,
				   0,          180,   4079,
		0.1491639759331, 0.04809194690006,      -1

	prism_ 5, woodLength,
		0.1418204004166, 0.06515065400574,      79,
		0.1113281388386, 0.06585162553627,    900,
				   0, 181.3169124058,   4079,
		0.08082782118074, 0.06585162553627,      15,
		0.1418204004166, 0.06515065400574,      -1

	prism_ 6, woodLength,
		0.07069163106558, 0.09319155493823,     79,
		0.06717746246242, 0.0491354179711,    900,
				   0, 81.79355620367,   4079,
		0.02407406553896, 0.05890218606993,      15,
		0.07851134135863, 0.03419306796738,      15,
		0.07069163106558, 0.09319155493823,     -1

	prism_ 7, woodLength,
		0.03956661075429, 0.02012054366754,      79,
		0.0562799052031, 0.02012054366754,    900,
				   0,          180,   4079,
		0.07299319965191, 0.02012054366754,      79,
		0.0562799052031, 0.02012054366754,    900,
				   0,          180,   4079,
		0.03956661075429, 0.02012054366754,      -1

	prism_ 6, woodLength,
		0.0439571840121, 0.0340000279822,      79,
		0.02400814698647, 0.02656973258563,    900,
				   0, 108.7447991604,   4079,
		0.01056126657663, 0.04307290728548,      15,
		0.01287774639874, 0.002920590368846,      15,
		0.0439571840121, 0.0340000279822,      -1

	prism_ 5, woodLength,
		0.2132195079122, 0.05746514573403,      15,
		0.1827212043409, 0.00464053440375,      79,
		0.1982739057478, 0.03087758561334,    900,
				   0, 181.3169124058,   4079,
		0.2132195079122, 0.05746514573403,      -1

	prism_ 6, woodLength,
		0.2645798802695, 0.0956716357773,     79,
		0.2610657116664, 0.05161549881017,    900,
				   0, 81.79355620367,   4079,
		0.2179623147429, 0.061382266909,      15,
		0.2723995905626, 0.03667314880646,      15,
		0.2645798802695, 0.0956716357773,      -1

	prism_ 7, woodLength,
		0.2347544693076, 0.02244953047196,      79,
		0.2514677637564, 0.02244953047196,    900,
				   0,          180,   4079,
		0.2681810582052, 0.02244953047196,      79,
		0.2514677637564, 0.02244953047196,    900,
				   0,          180,   4079,
		0.2347544693076, 0.02244953047196,      -1

	prism_ 6, woodLength,
		0.3697359351996, 0.07349238111312,      79,
		0.349786898174, 0.06606208571654,    900,
				   0, 108.7447991604,   4079,
		0.3363400177641, 0.0825652604164,      15,
		0.3386564975863, 0.04241294349977,      15,
		0.3697359351996, 0.07349238111312,      -1

	prism_ 5, woodLength,
		0.3332163749929, 0.06414341960104,      79,
		0.3027241134149, 0.06484439113157,    900,
				   0, 181.3169124058,   4079,
		0.2722237957571, 0.06484439113157,      15,
		0.3332163749929, 0.06414341960104,      -1

	prism_ 5, woodLength,
		0.3698302520979, 0.003803759113662,      79,
		0.3413582372206, -0.002114726762641,    900,
				   0, 154.3284830156,   4079,
		0.3131326702998, 0.004885378825165,      15,
		0.3698302520979, 0.003803759113662,      -1

	prism_ 7, woodLength,
		0.3696758749744, 0.03984551605677,      79,
		0.3569352359528, 0.03984551605677,    900,
				   0,          180,   4079,
		0.3441945969311, 0.03984551605677,      79,
		0.3569352359528, 0.03984551605677,    900,
				   0,          180,   4079,
		0.3696758749744, 0.03984551605677,      -1

	prism_ 5, woodLength,
		0.2973354541626, 0.06107423725623,      15,
		0.3105017219905, 0.001515564718873,      79,
		0.3035763420659, 0.03121924277612,    900,
				   0, -181.3169124058,   4079,
		0.2973354541626, 0.06107423725623,      15

	prism_ 7, woodLength,
		0.3052228239205, 0.03967191198443,      79,
		0.3255583856135, 0.0506615761198,    900,
				   0, 87.69929966074,   4079,
		0.3357228401213, 0.02990123768959,      15,
		0.3346532399268, 0.05978634800238,      15,
		0.3117625606848, 0.06098133339863,      15,
		0.3052228239205, 0.03967191198443,      -1

	base
	vert 0, 0, 0
	vert 1, 0, 0
	vert 0, 1, 0
	vert 0, 0, 1

	coor 3, -1, -2, -3, -4
	body -1

	del 3
return


! ======================================================================
! MODERN TYPE 1
! ======================================================================
"MODERN_TYPE_1":
	gosub "Hotspots"
	mul a/0.675, b/0.550, 1

	if legHeight > EPS then
		prism_ 5,    0.02,
			0.0,     0.0,     15,
			0.675,   0.0,     15,
			0.675,   0.55,   15,
			0.0,     0.55,   15,
			0.0,     0.0,     -1

		addZ 0.02
		cPRISM_ mat_stove, mat_stove, mat_stove,
					 9,     legHeight-0.02,
					0.1,     0.55,     15,
					0.575,   0.55,     15,
					0.575,   0.1,     15,
					0.525,   0.1,     15,
					0.525,   0.5,     15,
					0.15,    0.5,     15,
					0.15,    0.1,     15,
					0.1,     0.1,     15,
					0.1,     0.55,     -1

		if not(bOpen) then
			cPRISM_ mat_stove, mat_stove, mat_stove,
						 5,     legHeight-0.02,
						0.525,   0.13,     15,
						0.15,    0.13,     15,
						0.15,    0.18,     15,
						0.525,   0.18,     15,
						0.525,   0.13,     -1
		else
			if gs_detlevel_3D_m = 2 then	! Detailed
				woodLength = 0.35
				woodA = 0.38
				if legHeight > 0.14 then
					woodB = 0.12
				else
					woodB = legHeight-0.02
				endif
				add 0.15, 0.13, 0
				gosub "FireWoods"
				del 1
				material mat_stove
			endif
		endif
		del          1
	endif

	addZ legHeight
	mulz (ZZYZX-legHeight)/0.55
	add  0.07,     0.08,     0.05
	cWALL_  mat_stove, mat_stove, mat_stove,
			0.45,     0.0,     0.535,     0.535,     0.0,     0.05,
			10,     15,     15,     15,
			1,
			0.05,     0.1,     0.485,     0.35,   -255,
			0
	del 1

	add 0.12,     0.09,     0.15
	cWALL_  mat_glass, mat_glass, mat_glass,
			0.25,     0.0,     0.435,     0.435,     0.0,     0.02,
			15,     15,     15,     15,
			0,
			0
	del 1

	addZ 0.5
	cPRISM_ mat_stove, mat_stove, mat_stove,
				 5,     0.05,
				0.0,     0.550,     15,
				0.675,     0.550,     15,
				0.675,     0.0,     15,
				0.0,     0.0,     15,
				0.0,     0.550,     -1
	del          1

	cPRISM_ mat_stove, mat_stove, mat_stove,
				 9,     0.5,
				0.02,     0.02,     15,
				0.02,     0.550,     15,
				0.655,     0.550,     15,
				0.655,     0.02,     15,
				0.605,     0.02,     15,
				0.605,     0.500,     15,
				0.07,     0.500,     15,
				0.07,     0.02,     15,
				0.02,     0.02,     -1

	addZ 0.45
	cPRISM_ mat_stove, mat_stove, mat_stove,
				 5,     0.05,
				0.07,     0.03,     15,
				0.605,     0.03,     15,
				0.605,     0.08,     15,
				0.07,     0.08,     15,
				0.07,     0.03,     -1
	del 1

	cPRISM_ mat_stove, mat_stove, mat_stove,
				 5,     0.05,
				0.07,     0.504,     15,
				0.605,     0.504,     15,
				0.605,     0.08,     11,
				0.07,     0.08,     15,
				0.07,     0.504,     -1

	cPRISM_ mat_stove, mat_stove, mat_stove,
				 5,     0.1,
				0.07,     0.03,     15,
				0.605,     0.03,     15,
				0.605,     0.08,     15,
				0.07,     0.08,     15,
				0.07,     0.03,     -1

	if bFire then
		rotx 90
		add 0.07, 0.1, -0.13
		picture "fire_2", 0.535, 0.3, 0  			! fire_2.jpg
		del 2
	endif

	del 3
return



! ======================================================================
! MODERN TYPE 2
! ======================================================================
"MODERN_TYPE_2":
	thickness = 0.006
	overHang = 0.01
	alfa = 30
	origoOffset = 0.02

	radius1 = A/2 + origoOffset
	x1 = cos(alfa) * radius1 - origoOffset
	y1 = sin(alfa) * radius1
	circleOffset1 = 0.10
	circleOffset2 = B - circleOffset1 - 2*y1
	alfa1 = ATN(circleOffset1/x1)
	atfogo1 = sqr(circleOffset1*circleOffset1 + x1*x1)
	cirleRadius1 = (atfogo1/2)/cos(90-alfa1)
	alfa2 = ATN(circleOffset2/x1)
	atfogo2 = sqr(circleOffset2*circleOffset2 + x1*x1)
	cirleRadius2 = (atfogo2/2)/cos(90-alfa2)
	gosub "MODERN_TYPE_2_Hotspots"

	toler 0.01 / gs_resol

	!leg
	if legHeight > EPS then
		cylind thickness, y1+circleOffset1
		addz thickness
		cylind legHeight-thickness, 0.12
		del 1
	endif

	! Top, Bottom
	baseHeight = thickness
	addz ZZYZX-thickness
	gosub "MODERN_TYPE_2_Plate"
	del 1
	addz legHeight
	gosub "MODERN_TYPE_2_Plate"
	del 1

	! Base
	baseHeight = ZZYZX - 2*thickness - legHeight
	addz legHeight+thickness
	gosub "MODERN_TYPE_2_Base"
	del 1


	doorHeight = ZZYZX - legHeight -  4*thickness
	realA = ((2*cirleRadius1*PI)/360) * (4*alfa1) - 10*thickness
	baseHeight = thickness

	if gs_detlevel_3D_m = 2 then	! Detailed
		profilRadius = 0.0075
		handleRadius = 0.01
		handleLength= 0.1
		addy -y1-circleOffset1+cirleRadius1
		beta = ( 0.04 *360 ) / ( 2*(cirleRadius1-thickness-overHang)*PI)
		rotz 2*alfa1-beta
		add 0, -cirleRadius1+overHang+thickness, legHeight+doorHeight/2+handleLength/2+2*thickness
		gosub "TRADITIONAL_TYPE_3_Handle"	! Handle
		del 3
	endif
	rotx 90
	add 0, legHeight+2*thickness, y1+circleOffset1-2*thickness-overHang
	gosub "MODERN_TYPE_2_Door"	!!Door
	del 1

	if bFire then
		add -x1+overHang+thickness, legHeight+thickness, y1
		picture "fire_2", 2*x1-2*(thickness+overHang), ZZYZX-legHeight-2*thickness, 0  			! fire_2.jpg
		del 1
	endif

	del 1

	base
	vert 0, 0, 0
	vert 1, 0, 0
	vert 0, 1, 0
	vert 0, 0, 1

	coor 3, -1, -2, -3, -4
	body -1
return


!-----! Plate -----
"MODERN_TYPE_2_Plate":
	prism_  18, baseHeight,
		-x1, -y1, 79,
		0, -y1-circleOffset1+cirleRadius1, 900,
		0, -y1-circleOffset1,3079,
		0, -y1-circleOffset1+cirleRadius1, 900,
		x1, -y1, 3079,
		-origoOffset, 0, 900,
		A/2, 0, 3079,
		-origoOffset, 0, 900,
		x1, y1, 3079,
		0, y1+circleOffset2-cirleRadius2, 900,
		0, y1+circleOffset2, 3079,
		0, y1+circleOffset2-cirleRadius2, 900,
		-x1, y1, 3079,
		origoOffset, 0, 900,
		-A/2, 0, 3079,
		origoOffset, 0, 900,
		-x1, -y1, 3079,
		-x1, -y1, -1

	lin_  -x1, -y1, 0, -x1, -y1, baseHeight
	lin_  -x1,  y1, 0, -x1,  y1, baseHeight
	lin_   x1,  y1, 0,  x1,  y1, baseHeight
	lin_   x1, -y1, 0,  x1, -y1, baseHeight
return

!-----! Base -----
"MODERN_TYPE_2_Base":
	group "base2"
		rate = (A/2-overHang)/(A/2)
		mul rate, rate, 1
		gosub "MODERN_TYPE_2_Plate"
		del 1
	endgroup

	group "cutter2"
		rate = (A/2-overHang-thickness)/(A/2)
		mul rate, rate, 1
		gosub "MODERN_TYPE_2_Plate"
		del 1

		prism_ 4, baseHeight,
			 x1-thickness-overHang,  0, 15,
			 x1-thickness-overHang, -B, 15,
			-x1+thickness+overHang, -B, 15,
			-x1+thickness+overHang,  0, 15
	endgroup

	placegroup subgroup ("base2", "cutter2")
	killgroup "base2"
	killgroup "cutter2"
return

!-----! Door -----
"MODERN_TYPE_2_Door":
	doorFrameX = 0.06
	doorFrameY1 = 0.1
	doorFrameY2 = 0.15
	doorRadius = 0.01


	put	-realA/2+doorFrameX+doorRadius, doorFrameY1, 15
	put realA/2-doorFrameX-doorRadius, doorFrameY1, 79
	put realA/2-doorFrameX-doorRadius, doorFrameY1+doorRadius, 900
	put -realA/2+doorRadius, 90, 4079
	put realA/2-doorFrameX, doorHeight-doorFrameY2-doorRadius, 79
	put realA/2-doorFrameX-doorRadius, doorHeight-doorFrameY2-doorRadius, 900
	put -realA/2+doorRadius, 90, 4079
	put -realA/2+doorFrameX+doorRadius, doorHeight-doorFrameY2, 79
	put -realA/2+doorFrameX+doorRadius, doorHeight-doorFrameY2-doorRadius, 900
	put -realA/2+doorRadius, 90, 4079
	put -realA/2+doorFrameX, doorFrameY1+doorRadius, 79
	put -realA/2+doorFrameX+doorRadius, doorFrameY1+doorRadius, 900
	put -realA/2+doorRadius, 90, 4079
	put -realA/2+doorFrameX+doorRadius, doorFrameY1, -1

	holeY = 0.04
	holeX = 0.02
	nHole = 3
	if gs_detlevel_3D_m = 2 then	! Detailed
		for i = 1 to nHole
			put (1+(i-1)*3)*holeX, doorHeight-doorFrameY2/2-holeY/2, 15
			put (2+(i-1)*3)*holeX, doorHeight-doorFrameY2/2-holeY/2, 15
			put (2+(i-1)*3)*holeX, doorHeight-doorFrameY2/2+holeY/2, 15
			put (1+(i-1)*3)*holeX, doorHeight-doorFrameY2/2+holeY/2, 15
			put (1+(i-1)*3)*holeX, doorHeight-doorFrameY2/2-holeY/2, -1

			put -(1+(i-1)*3)*holeX, doorHeight-doorFrameY2/2-holeY/2, 15
			put -(2+(i-1)*3)*holeX, doorHeight-doorFrameY2/2-holeY/2, 15
			put -(2+(i-1)*3)*holeX, doorHeight-doorFrameY2/2+holeY/2, 15
			put -(1+(i-1)*3)*holeX, doorHeight-doorFrameY2/2+holeY/2, 15
			put -(1+(i-1)*3)*holeX, doorHeight-doorFrameY2/2-holeY/2, -1
		next i
	endif

	bprism_ mat_stove, mat_stove, mat_stove,
		5+NSP/3, baseHeight, cirleRadius1,
		-realA/2, 0, 15,
		-realA/2, doorHeight, 15,
		realA/2, doorHeight, 15,
		realA/2, 0, 15,
		-realA/2, 0, -1,
		 get (NSP)

	bprism_ mat_glass, mat_glass, mat_glass,
		14, baseHeight, cirleRadius1,
		-realA/2+doorFrameX+doorRadius, doorFrameY1, 15,
		realA/2-doorFrameX-doorRadius, doorFrameY1, 79,
		realA/2-doorFrameX-doorRadius, doorFrameY1+doorRadius, 900,
		-realA/2+doorRadius, 90, 4079,
		realA/2-doorFrameX, doorHeight-doorFrameY2-doorRadius, 79,
		realA/2-doorFrameX-doorRadius, doorHeight-doorFrameY2-doorRadius, 900,
		-realA/2+doorRadius, 90, 4079,
		-realA/2+doorFrameX+doorRadius, doorHeight-doorFrameY2, 79,
		-realA/2+doorFrameX+doorRadius, doorHeight-doorFrameY2-doorRadius, 900,
		-realA/2+doorRadius, 90, 4079,
		-realA/2+doorFrameX, doorFrameY1+doorRadius, 79,
		-realA/2+doorFrameX+doorRadius, doorFrameY1+doorRadius, 900,
		-realA/2+doorRadius, 90, 4079,
		-realA/2+doorFrameX+doorRadius, doorFrameY1, -1
return

!-----! Hotspots -----
"MODERN_TYPE_2_Hotspots":
	hotspot  -A/2, 0, 0, unID, A, 1+256			: unID=unID+1
	hotspot  -A/2-1, 0, 0, unID, A, 3 			: unID=unID+1
	hotspot   A/2, 0, 0, unID, A, 2 			: unID=unID+1

	hotspot   0, -y1-circleOffset1,  0, unID, B, 1+256		: unID=unID+1
	hotspot   0, -y1-circleOffset1-1, 0, unID, B, 3 		: unID=unID+1
	hotspot   0, y1+circleOffset2,  0, unID, B, 2 			: unID=unID+1

	hotspot 0, 0, 0, unID : unID = unID + 1

	hotspot  -A/2, 0, 0, unID, ZZYZX, 1+128			: unID=unID+1
	hotspot  -A/2, 0, -1, unID, ZZYZX, 3 			: unID=unID+1
	hotspot  -A/2, 0, ZZYZX, unID, ZZYZX, 2 		: unID=unID+1

	hotspot   A/2, 0, 0, unID, ZZYZX, 1+128			: unID=unID+1
	hotspot   A/2, 0, -1, unID, ZZYZX, 3 			: unID=unID+1
	hotspot   A/2, 0, ZZYZX, unID, ZZYZX, 2 		: unID=unID+1

	hotspot   0, -y1-circleOffset1, 0, unID, ZZYZX, 1+128		: unID=unID+1
	hotspot   0, -y1-circleOffset1, -1, unID, ZZYZX, 3 			: unID=unID+1
	hotspot   0, -y1-circleOffset1, ZZYZX, unID, ZZYZX, 2 		: unID=unID+1

	hotspot   0, y1+circleOffset2, 0, unID, ZZYZX, 1+128		: unID=unID+1
	hotspot   0, y1+circleOffset2, -1, unID, ZZYZX, 3 			: unID=unID+1
	hotspot   0, y1+circleOffset2, ZZYZX, unID, ZZYZX, 2 		: unID=unID+1
return


! ======================================================================
! MODERN TYPE 3
! ======================================================================
"MODERN_TYPE_3":
	gosub "Hotspots"
	thickness  = 0.006
	wallRadius = 0.02
	backOffset = 0.03

	! Bottom, top
	realB = B
	realA = A
	baseHeight = thickness
	gosub "MODERN_TYPE_5_MotherBoard"
	addZ ZZYZX - thickness
	gosub "MODERN_TYPE_5_MotherBoard"
	del 1

	! Base
	realB = B-backOffset
	baseHeight = ZZYZX - 2*thickness
	add 0, backOffset, thickness
	gosub 1301
	del 1

	! Top Plate
	realA = A-4*wallRadius
	realB = B-backOffset-3*wallRadius
	baseHeight = 0.04
	add 2*wallRadius, backOffset+wallRadius, ZZYZX-thickness-baseHeight
	gosub 1302
	del 1


	! Bottom Plate
	add 2*wallRadius, backOffset+wallRadius, legHeight
	gosub 1302
	del 1
	! Storage
	if legHeight > EPS then
		if gs_detlevel_3D_m = 2 and bOpen then	! Detailed
			woodLength = B-backOffset-2*wallRadius
			woodA = realA
			if legHeight > 0.14 then
				woodB = 0.12
			else
				woodB = legHeight-0.02
			endif
			add 2*wallRadius, backOffset, thickness
			gosub "FireWoods"
			del 1
			material mat_stove
		endif
		if not(bOpen) then
			rotx 90
			add 2*wallRadius, thickness, -backOffset-wallRadius
			realB = legHeight+thickness
			baseHeight = wallRadius
			gosub 1302
			del 2
		endif
	endif

	rotx 90
	add 2*wallRadius, legHeight+0.03, -backOffset-wallRadius
	baseHeight = wallRadius
	doorHeight = ZZYZX - legHeight - thickness - 0.06
	gosub 1305	!!Door
	del 2

return

!-----! Base -----
1301:
	prism_  15, baseHeight,
		0, realB-wallRadius, 79,
		wallRadius, realB-wallRadius, 900,
		wallRadius, -90 , 4079,
		realA-wallRadius, realB, 79,
		realA-wallRadius, realB-wallRadius, 900,
		wallRadius, -90 , 4079,
		realA, wallRadius, 79,
		realA-wallRadius, wallRadius, 900,
		wallRadius, -180, 4079,
		realA-2*wallRadius, realB-2*wallRadius, 15,
		2*wallRadius, realB-2*wallRadius, 15,
		2*wallRadius, wallRadius, 79,
		wallRadius, wallRadius, 900,
		wallRadius, -180, 4079,
		0, realB, -1

return

!-----! Plate -----
1302:
	prism_  4, baseHeight,
		0, 0, 15,
		realA, 0, 15,
		realA, realB, 15,
		0, realB, 15
return

!-----! Door -----
1305:
	doorFrameX = 0.06
	doorFrameY = 0.12
	doorRadius = 0.01
	prism_ 19, baseHeight,
		0, 0, 15,
		0, doorHeight, 15,
		realA, doorHeight, 15,
		realA, 0, 15,
		0, 0, -1,
		doorFrameX+doorRadius, doorFrameY, 15,
		realA-doorFrameX-doorRadius, doorFrameY, 79,
		realA-doorFrameX-doorRadius, doorFrameY+doorRadius, 900,
		doorRadius, 90, 4079,
		realA-doorFrameX, doorHeight-doorFrameY-doorRadius, 79,
		realA-doorFrameX-doorRadius, doorHeight-doorFrameY-doorRadius, 900,
		doorRadius, 90, 4079,
		doorFrameX+doorRadius, doorHeight-doorFrameY, 79,
		doorFrameX+doorRadius, doorHeight-doorFrameY-doorRadius, 900,
		doorRadius, 90, 4079,
		doorFrameX, doorFrameY+doorRadius, 79,
		doorFrameX+doorRadius, doorFrameY+doorRadius, 900,
		doorRadius, 90, 4079,
		doorFrameX+doorRadius, doorFrameY, -1

	cprism_ mat_glass, mat_glass, mat_glass,
		14, baseHeight,
		doorFrameX+doorRadius, doorFrameY, 15,
		realA-doorFrameX-doorRadius, doorFrameY, 79,
		realA-doorFrameX-doorRadius, doorFrameY+doorRadius, 900,
		doorRadius, 90, 4079,
		realA-doorFrameX, doorHeight-doorFrameY-doorRadius, 79,
		realA-doorFrameX-doorRadius, doorHeight-doorFrameY-doorRadius, 900,
		doorRadius, 90, 4079,
		doorFrameX+doorRadius, doorHeight-doorFrameY, 79,
		doorFrameX+doorRadius, doorHeight-doorFrameY-doorRadius, 900,
		doorRadius, 90, 4079,
		doorFrameX, doorFrameY+doorRadius, 79,
		doorFrameX+doorRadius, doorFrameY+doorRadius, 900,
		doorRadius, 90, 4079,
		doorFrameX+doorRadius, doorFrameY, -1

	if bFire then
		add doorFrameX, doorFrameY, 0
		picture "fire_2", realA-2*doorFrameX, doorHeight-2*doorFrameY, 0  			! fire_2.jpg
		del 1
	endif

	if gs_detlevel_3D_m = 2 then	! Detailed
		profilRadius = 0.0075
		handleRadius = 0.01
		handleLength= 0.1
		add realA-doorFrameX/2, doorHeight/2+handleLength/2, baseHeight
		rotx 90
		mul 1, -1, -1
		gosub "TRADITIONAL_TYPE_3_Handle"	! Handle
		del 3
	endif
return



! ======================================================================
! MODERN TYPE 4
! ======================================================================
"MODERN_TYPE_4":
	hotspot  -A/2, 0, 0, unID, A, 1+256			: unID=unID+1
	hotspot  -A/2-1, 0, 0, unID, A, 3 			: unID=unID+1
	hotspot   A/2, 0, 0, unID, A, 2 			: unID=unID+1

	hotspot   0, -A/2,  0, unID, A, 1+256		: unID=unID+1
	hotspot   0, -A/2-1, 0, unID, A, 3 			: unID=unID+1
	hotspot   0, A/2,  0, unID, A, 2 			: unID=unID+1

	hotspot 0, 0, 0, unID : unID = unID + 1

	hotspot  -A/2, 0, 0, unID, ZZYZX, 1+128			: unID=unID+1
	hotspot  -A/2, 0, -1, unID, ZZYZX, 3 			: unID=unID+1
	hotspot  -A/2, 0, ZZYZX, unID, ZZYZX, 2 		: unID=unID+1

	hotspot   A/2, 0, 0, unID, ZZYZX, 1+128			: unID=unID+1
	hotspot   A/2, 0, -1, unID, ZZYZX, 3 			: unID=unID+1
	hotspot   A/2, 0, ZZYZX, unID, ZZYZX, 2 		: unID=unID+1

	hotspot   0, A/2, 0, unID, ZZYZX, 1+128			: unID=unID+1
	hotspot   0, A/2, -1, unID, ZZYZX, 3 			: unID=unID+1
	hotspot   0, A/2, ZZYZX, unID, ZZYZX, 2 		: unID=unID+1

	hotspot   0, -A/2, 0, unID, ZZYZX, 1+128		: unID=unID+1
	hotspot   0, -A/2, -1, unID, ZZYZX, 3 			: unID=unID+1
	hotspot   0, -A/2, ZZYZX, unID, ZZYZX, 2 		: unID=unID+1

	thickness = 0.006
	border	= 0.04
	overHang = 0.01
	alfa = 25
	wallRadius = A/2-overHang
	toler 0.01 / gs_resol


	!leg
	cylind thickness, wallRadius-3*overHang

	! Top
	addz ZZYZX-thickness
	cylind thickness, A/2
	del 1

	! Base
	group "base"
		addz thickness
		cylind ZZYZX-2*thickness, wallRadius
		del 1
	endgroup

	! Cutter
	group "cutter"
		addz thickness+border
		prism_ 8, ZZYZX-topHeight-thickness-border-(topHeight > EPS and bComp)*border,
			-cos(alfa)*(wallRadius-thickness),-sin(alfa)*(wallRadius-thickness),79,
			0, 0, 900,
			wallRadius-thickness, -(180+2*alfa), 4079,
			cos(alfa)*(wallRadius),-sin(alfa)*(wallRadius),15,
			A/2, -A/2,15,
			-A/2, -A/2,15,
			-cos(alfa)*(wallRadius),-sin(alfa)*(wallRadius),15,
			-cos(alfa)*(wallRadius-thickness),-sin(alfa)*(wallRadius-thickness), -1
		del 1

		if topHeight > EPS and bComp then
			addz ZZYZX-topHeight
			prism_ 11, topHeight-thickness-border,
				-cos(alfa)*(wallRadius-thickness),-sin(alfa)*(wallRadius-thickness),79,
				0, 0, 900,
				wallRadius-thickness, -alfa, 4079,
				wallRadius-thickness, 0, 79,
				0, 0, 900,
				wallRadius-thickness, -alfa, 4079,
				cos(alfa)*(wallRadius),-sin(alfa)*(wallRadius),15,
				A/2, -A/2,15,
				-A/2, -A/2,15,
				-cos(alfa)*(wallRadius),-sin(alfa)*(wallRadius),15,
				-cos(alfa)*(wallRadius-thickness),-sin(alfa)*(wallRadius-thickness), -1
			del 1
		endif
	endgroup

	placegroup subgroup ("base", "cutter")
	killgroup "base"
	killgroup "cutter"


	if legHeight > border and bOpen then
		if gs_detlevel_3D_m = 2 then	! Detailed
			woodLength = sin(90-alfa-20)*(wallRadius-border)*2
			woodA = cos(alfa)*(wallRadius-border)*2
			if legHeight > 0.14 then
				woodB = 0.12
			else
				woodB = legHeight-0.02
			endif
			add -woodA/2, -woodLength/2, border+thickness
			gosub "FireWoods"
			del 1
			material mat_stove
		endif
	endif

	if legHeight > border then
		addz legHeight
		prism_ 7, border,
			-cos(alfa)*(wallRadius-thickness),-sin(alfa)*(wallRadius-thickness), 79,
			0, 0, 900,
			wallRadius-thickness, -(180+2*alfa), 4079,
			cos(alfa)*(wallRadius-border/2),-sin(alfa)*(wallRadius-border/2), 79,
			0, 0, 900,
			wallRadius-border/2, -(180-2*alfa), 4079,
			-cos(alfa)*(wallRadius-thickness),-sin(alfa)*(wallRadius-thickness), -1
		addz border
		cylind thickness, wallRadius-thickness
		del 2

		if not(bOpen) then
			addz border+thickness
			prism_ 7, legHeight-border,
				-cos(alfa)*(wallRadius-border/2),-sin(alfa)*(wallRadius-border/2), 79,
				0, 0, 900,
				wallRadius-border/2, 180-2*alfa, 4079,
				cos(alfa)*(wallRadius-border/2+thickness),-sin(alfa)*(wallRadius-border/2+thickness), 79,
				0, 0, 900,
				wallRadius-border/2+thickness, -(180-2*alfa), 4079,
				-cos(alfa)*(wallRadius-border/2),-sin(alfa)*(wallRadius-border/2), -1
			del 1
		endif
	endif

	if topHeight > border+2*thickness and bComp and gs_detlevel_3D_m = 2 then
		addz ZZYZX-topHeight
		prism_ 10, thickness,
			-cos(alfa)*(wallRadius-thickness),-sin(alfa)*(wallRadius-thickness),79,
			0, 0, 900,
			wallRadius-thickness, -alfa, 4079,
			wallRadius-thickness, 0, 79,
			0, 0, 900,
			wallRadius-thickness, -alfa, 4079,
			cos(alfa)*(wallRadius+overHang),-sin(alfa)*(wallRadius+overHang),79,
			0, 0, 900,
			wallRadius+overHang, -(180-2*alfa), 4079,
			-cos(alfa)*(wallRadius-thickness),-sin(alfa)*(wallRadius-thickness), -1
		del 1
	endif

	doorHeight = ZZYZX - legHeight - topHeight - 2*border + 2*thickness + (topHeight > EPS and not(bComp))*border
	realA = ((2*wallRadius*PI)/360) * (180-2*alfa) + 2*thickness
	baseHeight = thickness
	rotx 90
	if gs_detlevel_3D_m = 2 then	! Detailed
		profilRadius = 0.0075
		handleRadius = 0.01
		handleLength= 0.1
		rotx 90
		rotz 270+alfa+5
		mul 1, -1, -1
		add 0, -wallRadius-thickness, legHeight+doorHeight/2+handleLength/2
		gosub "TRADITIONAL_TYPE_3_Handle"	! Handle
		del 4
	endif
	add 0, legHeight+border-thickness, A/2-overHang
	gosub "MODERN_TYPE_4_Door"	!!Door
	del 1

	if bFire then
		add -wallRadius+thickness, legHeight, 0
		picture "fire_2", 2*wallRadius-2*thickness, ZZYZX-legHeight-topHeight, 0  			! fire_2.jpg
		del 1
	endif

	del 1

	base
	vert 0, 0, 0
	vert 1, 0, 0
	vert 0, 1, 0
	vert 0, 0, 1

	coor 3, -1, -2, -3, -4
	body -1
return


!-----! Door -----
"MODERN_TYPE_4_Door":
	doorFrameX = 0.06
	doorFrameY = 0.06
	doorRadius = 0.01
	bprism_ mat_stove, mat_stove, mat_stove,
		19, baseHeight, wallRadius,
		-realA/2, 0, 15,
		-realA/2, doorHeight, 15,
		realA/2, doorHeight, 15,
		realA/2, 0, 15,
		-realA/2, 0, -1,
		-realA/2+doorFrameX+doorRadius, doorFrameY, 15,
		realA/2-doorFrameX-doorRadius, doorFrameY, 79,
		realA/2-doorFrameX-doorRadius, doorFrameY+doorRadius, 900,
		-realA/2+doorRadius, 90, 4079,
		realA/2-doorFrameX, doorHeight-doorFrameY-doorRadius, 79,
		realA/2-doorFrameX-doorRadius, doorHeight-doorFrameY-doorRadius, 900,
		-realA/2+doorRadius, 90, 4079,
		-realA/2+doorFrameX+doorRadius, doorHeight-doorFrameY, 79,
		-realA/2+doorFrameX+doorRadius, doorHeight-doorFrameY-doorRadius, 900,
		-realA/2+doorRadius, 90, 4079,
		-realA/2+doorFrameX, doorFrameY+doorRadius, 79,
		-realA/2+doorFrameX+doorRadius, doorFrameY+doorRadius, 900,
		-realA/2+doorRadius, 90, 4079,
		-realA/2+doorFrameX+doorRadius, doorFrameY, -1

	bprism_ mat_glass, mat_glass, mat_glass,
		14, baseHeight, wallRadius,
		-realA/2+doorFrameX+doorRadius, doorFrameY, 15,
		realA/2-doorFrameX-doorRadius, doorFrameY, 79,
		realA/2-doorFrameX-doorRadius, doorFrameY+doorRadius, 900,
		-realA/2+doorRadius, 90, 4079,
		realA/2-doorFrameX, doorHeight-doorFrameY-doorRadius, 79,
		realA/2-doorFrameX-doorRadius, doorHeight-doorFrameY-doorRadius, 900,
		-realA/2+doorRadius, 90, 4079,
		-realA/2+doorFrameX+doorRadius, doorHeight-doorFrameY, 79,
		-realA/2+doorFrameX+doorRadius, doorHeight-doorFrameY-doorRadius, 900,
		-realA/2+doorRadius, 90, 4079,
		-realA/2+doorFrameX, doorFrameY+doorRadius, 79,
		-realA/2+doorFrameX+doorRadius, doorFrameY+doorRadius, 900,
		-realA/2+doorRadius, 90, 4079,
		-realA/2+doorFrameX+doorRadius, doorFrameY, -1
return



! ======================================================================
! MODERN TYPE 5
! ======================================================================
"MODERN_TYPE_5":
	gosub "Hotspots"
	thickness = 0.006
	overHang = 0.008
	wallRadius	 = 0.04
	legRadius = 0.015
	legPos	= 0.035
	wallX	= 0.065
	backOffset = 0.02


	!leg
	add legPos, legPos, 0
	gosub "MODERN_TYPE_5_Leg"
	addX a-2*legPos
	gosub "MODERN_TYPE_5_Leg"
	del 2
	add legPos, b-legPos, 0
	gosub "MODERN_TYPE_5_Leg"
	addX a-2*legPos
	gosub "MODERN_TYPE_5_Leg"
	del 2

	! Bottom, top
	realB = B
	realA = A
	baseHeight = thickness
	addZ thickness
	gosub "MODERN_TYPE_5_MotherBoard"
	del 1
	addZ ZZYZX - thickness
	gosub "MODERN_TYPE_5_MotherBoard"
	del 1

	! Base
	realB = B-2*overHang-backOffset
	realA = A-2*overHang
	baseHeight = ZZYZX - 3*thickness
	wallRadius	 = wallRadius - overHang
	add overHang, overHang+backOffset, 2*thickness
	mask = 8
	if legHeight > EPS and bOpen then
		if gs_detlevel_3D_m = 2 then	! Detailed
			woodLength = B-0.05
			woodA = realA-2*wallX
			if legHeight > 0.14 then
				woodB = 0.12
			else
				woodB = legHeight-0.02
			endif
			addx wallX
			gosub "FireWoods"
			del 1
		endif
		cutHeight = -legHeight+2*thickness
		cutZ = -legHeight+2*thickness
		gosub "MODERN_TYPE_5_Cutter"
	endif
	material mat_stove
	if topHeight > EPS and bComp then
		realB = 0.15-overHang
		cutHeight = ZZYZX-2*thickness-topHeight
		cutZ = ZZYZX-2*thickness-topHeight
		gosub "MODERN_TYPE_5_Cutter"
	endif
	realB = B-2*overHang-backOffset
	addz legHeight-2*thickness+0.05
	cutHeight = ZZYZX-topHeight-legHeight-2*0.05
	cutZ = -(B-overHang-0.05)
	gosub "MODERN_TYPE_5_MainCutter" !Firebox cutter
	del 1
	gosub "MODERN_TYPE_5_MotherBoard"	!main
	del 1
	if topHeight > EPS and bComp then cutend
	if legHeight > EPS and bOpen then cutend
	cutend

	doorHeight = ZZYZX - legHeight - topHeight
	doorOffset = 0.01
	add overHang, overHang, 0
	if legHeight > EPS and not(bOpen) then
		addz 2*thickness+overHang
		cutHeight = legHeight-2*thickness-2*overHang
		gosub "MODERN_TYPE_5_Plate"
		del 1
	endif

	if topHeight > EPS and not(bComp) then
		addz ZZYZX-topHeight+overHang
		cutHeight = topHeight-thickness-2*overHang
		gosub "MODERN_TYPE_5_Plate"
		del 1
	endif

	addz legHeight
	gosub "MODERN_TYPE_5_Door"	!!Door
	del 1

	del 1

return

!-----! Leg -----
"MODERN_TYPE_5_Leg":
	prism_ 2, thickness,
		0, 0, 979,
		legRadius, 360, 4079
return

!-----! MotherBoard -----
"MODERN_TYPE_5_MotherBoard":
	prism_  14, baseHeight,
		wallRadius, 0, 79,
		realA-wallRadius, 0, 79,
		realA-wallRadius, wallRadius, 979,
		realA, wallRadius, 3079,
		realA, realB-wallRadius, 79,
		realA-wallRadius, realB-wallRadius, 979,
		realA-wallRadius, realB, 3079,
		wallRadius, realB, 79,
		wallRadius, realB-wallRadius, 979,
		0, realB-wallRadius, 3079,
		0, wallRadius, 79,
		wallRadius, wallRadius, 979,
		wallRadius, 0, 3079,
		wallRadius, 0, -1
return

!-----! Cutter -----
"MODERN_TYPE_5_Cutter":
	cutpolya 16, 1, cutZ,
		wallX, 0, 15+mask,
		wallX, thickness, 15+mask,
		wallRadius, thickness, 79+mask,
		wallRadius, wallRadius, 979+mask,
		thickness, wallRadius, 3079+mask,
		thickness, realB-wallRadius, 79+mask,
		wallRadius, realB-wallRadius, 979+mask,
		wallRadius, realB-thickness, 3079+mask,
		realA-wallRadius, realB-thickness, 79+mask,
		realA-wallRadius, realB-wallRadius, 979+mask,
		realA-thickness, realB-wallRadius, 3079+mask,
		realA-thickness, wallRadius, 79+mask,
		realA-wallRadius, wallRadius, 979+mask,
		realA-wallRadius, thickness, 3079+mask,
		realA-wallX, thickness, 15+mask,
		realA-wallX, 0, 15+mask,
		0, 0, cutHeight
return

!-----! Main Cutter -----
"MODERN_TYPE_5_MainCutter":
	rotx 90
	cutpolya 4, 1, cutZ,
		wallX, 0, 15+mask,
		wallX, cutHeight, 15+mask,
		realA-wallX, cutHeight, 15+mask,
		realA-wallX, 0, 15+mask,
		0, 0, cutHeight
	del 1
return

!-----! Plate -----
"MODERN_TYPE_5_Plate":
	rotx 90
	prism_ 4, thickness,
		overHang*2, 0, 15,
		overHang*2, cutHeight, 15,
		realA-overHang*2, cutHeight, 15,
		realA-overHang*2, 0, 15
	addz -backOffset
	prism_ 4, backOffset,
		overHang*2+doorOffset, doorOffset, 15,
		overHang*2+doorOffset, cutHeight-doorOffset, 15,
		realA-overHang*2-doorOffset, cutHeight-doorOffset, 15,
		realA-overHang*2-doorOffset, doorOffset, 15
	del 2
return

!-----! Door -----
"MODERN_TYPE_5_Door":
	doorFrameX = 0.08
	doorFrameY = 0.16
	rotx 90
	prism_ 10, thickness,
		overHang*2, 0, 15,
		overHang*2, doorHeight, 15,
		realA-overHang*2, doorHeight, 15,
		realA-overHang*2, 0, 15,
		overHang*2, 0, -1,
		overHang*2+doorFrameX, doorFrameY, 15,
		overHang*2+doorFrameX, doorHeight-doorFrameY, 15,
		realA-overHang*2-doorFrameX, doorHeight-doorFrameY, 15,
		realA-overHang*2-doorFrameX, doorFrameY, 15,
		overHang*2+doorFrameX, doorFrameY, -1

	addz -backOffset
	cprism_ mat_glass, mat_glass, mat_glass,
		5, backOffset,
		overHang*2+doorFrameX, doorFrameY, 15,
		overHang*2+doorFrameX, doorHeight-doorFrameY, 15,
		realA-overHang*2-doorFrameX, doorHeight-doorFrameY, 15,
		realA-overHang*2-doorFrameX, doorFrameY, 15,
		overHang*2+doorFrameX, doorFrameY, -1

	if bFire then
		add overHang*2+doorFrameX, doorFrameY, 0
		picture "fire_2", realA-overHang*2-doorFrameX - (overHang*2+doorFrameX), doorHeight-2*doorFrameY, 0  			! fire_2.jpg
		del 1
	endif

	prism_ 10, backOffset,
		overHang*2+doorOffset, doorOffset, 15,
		overHang*2+doorOffset, doorHeight-doorOffset, 15,
		realA-overHang*2-doorOffset, doorHeight-doorOffset, 15,
		realA-overHang*2-doorOffset, doorOffset, 15,
		overHang*2+doorOffset, doorOffset, -1,
		overHang*2+doorFrameX, doorFrameY, 15,
		overHang*2+doorFrameX, doorHeight-doorFrameY, 15,
		realA-overHang*2-doorFrameX, doorHeight-doorFrameY, 15,
		realA-overHang*2-doorFrameX, doorFrameY, 15,
		overHang*2+doorFrameX, doorFrameY, -1
	del 1

	if gs_detlevel_3D_m = 2 then	! Detailed
		buttonX = 0.02
		buttonY = 0.06
		addz thickness
		prism_ 2, overHang/4,
			overHang*2+doorFrameX-buttonX, doorFrameY-buttonY, 979,
			0.01, 360, 4079
		prism_ 2, overHang/4,
			realA-overHang*2-doorFrameX+buttonX, doorFrameY-buttonY, 979,
			0.01, 360, 4079
		prism_ 2, overHang/4,
			overHang*2+doorFrameX-buttonX, doorHeight-doorFrameY+buttonY, 979,
			0.01, 360, 4079
		prism_ 2, overHang/4,
			realA-overHang*2-doorFrameX+buttonX, doorHeight-doorFrameY+buttonY, 979,
			0.01, 360, 4079
		add realA-0.05, doorHeight/2, 0
		gosub "MODERN_TYPE_5_Handle"	! Handle
		del 2
	endif

	del 1

	if gs_detlevel_3D_m = 2 then	! Detailed
		add overHang*2+doorOffset-backOffset/6, backOffset/2, 0.1
		cylind 0.05, backOffset/3
		addz doorHeight-0.25
		cylind 0.05, backOffset/3
		del 2
	endif
return

!-----! Handle -----
"MODERN_TYPE_5_Handle":
	handleLength = 0.15
	handleRadius = 0.02/2

	rotz -3
	cylind 0.01, handleRadius/2
	addz 0.01
	prism_ 6 , 0.01,
		-handleRadius, 0, 79,
			0, 0, 900,
		 handleRadius, -180, 4079,
		 handleRadius, -handleLength/2, 13,
		-handleRadius, -handleLength/2, 13,
		-handleRadius, 0, -1

	sprism_{2} mat_stove, mat_stove, mat_stove,
		 6 , handleRadius, -handleLength/2, -handleRadius, -handleLength/2, 0.01, -10,
		 handleRadius, -handleLength/2, -handleRadius, -handleLength/2, 0, -10,
		 handleRadius, -handleLength/2, 13, mat_stove,
		 handleRadius, -handleLength, 79, mat_stove,
		 0, -handleLength, 900, mat_stove,
		 handleRadius, -180, 4079, mat_stove,
		-handleRadius, -handleLength/2, 13, mat_stove,
		 handleRadius, -handleLength/2, -1, mat_stove

	del 2
return



! ======================================================================
! TRADITIONAL TYPE 1
! ======================================================================
"TRADITIONAL_TYPE_1":
	gosub "Hotspots"
	!legHeight = 0.203
	!ZZYZX = 0.813
	aa = 0.940
	bb = 0.508
	addz legHeight
	mul A/0.940 , B/0.508, (ZZYZX-legHeight)/(0.813-0.203)
	addz -0.203
	material mat_stove
	gosub "TRADITIONAL_TYPE_1_TopStove"	! Top of the Stove
	gosub "TRADITIONAL_TYPE_1_BoxStove"	! Box of the Stove
	gosub "TRADITIONAL_TYPE_1_Door"	! Door
	gosub "TRADITIONAL_TYPE_1_Sides"	! Sides
	del 3
	if legHeight > EPS then
		mul A/0.940 , B/0.508,	legHeight/0.203
		gosub "TRADITIONAL_TYPE_1_Legs"	! Legs
		del 1
	endif
return

!-----! Handle -----
"TRADITIONAL_TYPE_1_Handle":
	if gs_detlevel_3D_m = 2 then	! Detailed
		add 3 1/4",1",18"
		rotz -90
		roty 90
		rotx 90
		addz -1/3"
		cylind 2/3",2/6"
		del 2
		elbow 1",80,1/4"
		add 1"-1"*cos(80),0,1"*sin(80)
		roty 80
		cylind 1",2/6"
		addz 1"
		roty -90

		revolve 11, 360, 1+2,
				0, 3/8", 1,
				1/8", 3/8", 901,
				0, -135, 4001,
				1/8"+1/8"*cos(45)+3/5"*sin(45), 3/8"+1/8"*sin(45)+3/5"*cos(45), 901,
				0, 45, 4001,
				1/8"+1/8"*cos(45)+3/5"*sin(45), 3/8"+1/8"*sin(45)+3/5"*cos(45)+3"-(1/8"*sin(45)+3/5"*cos(45)), 901,
				0, 15, 4001,
				1/8"+1/8"*cos(45)+3/5"*sin(45)+3"*sin(15)+3"*sin(25), 3/8"+1/8"*sin(45)+3/5"*cos(45)+3"-(1/8"*sin(45)+3/5"*cos(45))-3"*cos(15)-3"*cos(25), 901,
				0, -25, 4001,
				1 1/2", 0, 301,
				1/2", -90, 2001
		del 4

		addz -1/2"
		rotx 90
		addz 1/3"

		for L=1 to 2
			prism_  5, 1/4",
					-5/8", 0, 15,
					-4/8", 1/2", 79,
					0, 1/2", 915,
					4/8", 1/2", 3079,
					5/8", 0, 15
		addz -2/3"-1/4"
		next L
		del 5
		del 3
	endif
return


!-----! Legs -----
"TRADITIONAL_TYPE_1_Legs":
	mulz -1
	cutplane
	del 1
	add 2",2",8"
	mulz -1

	for J=1 to 2
		for I=1 to 2
			sweep   7, 9, 0, 0.9, 1+2+16+32,
					0, 0, 1,
					3", 0, 1,
					3", 1/4", 1,
					1/4", 1/4", 1,
					1/4", 3", 1,
					0, 3", 1,
					0, 0, 1,

					0, 0, 0,
					-1/12", -1/12", 1",
					-1/4", -1/4", 2",
					-2/4", -2/4", 3",
					-6/8", -6/8", 4",
					-1", -1", 5",
					-1 1/6", -1 1/6", 6",
					-1 1/4", -1 1/4", 7",
					-1 1/3", -1 1/3", 8"
		addx aa-4"
		mulx -1
		next I
		del 4
	addy bb-4"
	muly -1
	next J
	del 6

	cutend
return


!-----! Door -----
"TRADITIONAL_TYPE_1_Door":
	addy 1 1/2"
	rotx 90

	ADDZ    -1/2"
	PRISM_  40, 1/2",                           !  Fire hole door
			2'-11.5000", 24 3/4",     15,
			2'-11.5000", 10 1/4",     15,
			0'-1.5000", 10 1/4",     15,
			0'-1.5000", 24 3/4",     15,
			2'-11.5000", 24 3/4",     -1,
			0'-7.9697", 1'-9.9366",     79,
			0'-7.8002", 1'-9.8893",     79,
			0'-7.4830", 1'-9.7372",     79,
			0'-7.1969", 1'-9.5323",     79,
			0'-6.9508", 1'-9.2809",     79,
			0'-6.7521", 1'-8.9905",     79,
			0'-6.6068", 1'-8.6701",     79,
			0'-6.5194", 1'-8.3293",     79,
			0'-6.5000", 1'-8.0000",     79,
			0'-6.5000", 1',     15,
			2'-6.5000", 1',     15,
			2'-6.5000", 1'-8.0000",     79,
			2'-6.5000", 1'-8.1759",     79,
			2'-6.4389", 1'-8.5224",     79,
			2'-6.3186", 1'-8.8531",     79,
			2'-6.1426", 1'-9.1578",     79,
			2'-5.9165", 1'-9.4273",     79,
			2'-5.6469", 1'-9.6535",     79,
			2'-5.3422", 1'-9.8294",     79,
			2'-5.0303", 1'-9.9366",     79,
			2'-4.7496", 1'-10.0139",     79,
			2'-4.3773", 1'-10.1130",     79,
			2'-0.9534", 1'-10.8444",     79,
			2'-0.6016", 1'-10.9016",     79,
			1'-9.6870", 1'-11.2502",     79,
			1'-9.3489", 1'-11.2764",     79,
			1'-6.6667", 1'-11.3799",     79,
			1'-6.3333", 1'-11.3799",     79,
			1'-3.6511", 1'-11.2764",     79,
			1'-3.3130", 1'-11.2502",     79,
			1'-0.3984", 1'-10.9016",     79,
			1'-0.0466", 1'-10.8444",     79,
			0'-8.6227", 1'-10.1130",     79,
			0'-8.2504", 1'-10.0139",     79,
			0'-7.9697", 1'-9.9366",     -1
	DEL          1

	material mat_glass

	ADDZ    -1/2"
	PRISM_  36, 1/2",
			1'-3.3130", 1'-11.2502",     15,
			1'-3.2934", 1'-11.2479",     13,
			1'-0.3984", 1'-10.9016",     79,
			1'-0.0466", 1'-10.8444",     79,
			0'-8.6227", 1'-10.1130",     79,
			0'-8.2504", 1'-10.0139",     79,
			0'-7.9697", 1'-9.9366",     79,
			0'-7.8002", 1'-9.8893",     79,
			0'-7.4830", 1'-9.7372",     79,
			0'-7.1969", 1'-9.5323",     79,
			0'-6.9508", 1'-9.2809",     79,
			0'-6.7521", 1'-8.9905",     79,
			0'-6.6068", 1'-8.6701",     79,
			0'-6.5194", 1'-8.3293",     79,
			0'-6.5000", 1'-8.0000",     79,
			0'-6.5000", 1',     15,
			2'-6.5000", 1',     15,
			2'-6.5000", 1'-8.0000",     79,
			2'-6.5000", 1'-8.1759",     79,
			2'-6.4389", 1'-8.5224",     79,
			2'-6.3186", 1'-8.8531",     79,
			2'-6.1426", 1'-9.1578",     79,
			2'-5.9165", 1'-9.4273",     79,
			2'-5.6469", 1'-9.6535",     79,
			2'-5.3422", 1'-9.8294",     79,
			2'-5.0303", 1'-9.9366",     79,
			2'-4.7496", 1'-10.0139",     79,
			2'-4.3773", 1'-10.1130",     79,
			2'-0.9534", 1'-10.8444",     79,
			2'-0.6016", 1'-10.9016",     79,
			1'-9.6870", 1'-11.2502",     79,
			1'-9.3489", 1'-11.2764",     79,
			1'-6.6667", 1'-11.3799",     79,
			1'-6.3333", 1'-11.3799",     79,
			1'-3.6511", 1'-11.2764",     79,
			1'-3.3130", 1'-11.2502",     -1
	DEL          1

	material mat_stove

	PRISM_  240, 1/2",
			0'-6.0000", 0'-11.5000",     15,
			0'-6.0000", 0'-11.5197",     13,
			0'-6.0000", 1'-8.0000",     79,
			0'-6.0242", 1'-8.4111",     79,
			0'-6.1333", 1'-8.8367",     79,
			0'-6.3148", 1'-9.2368",     79,
			0'-6.5629", 1'-9.5994",     79,
			0'-6.8702", 1'-9.9133",     79,
			0'-7.2274", 1'-10.1692",     79,
			0'-7.6236", 1'-10.3591",     79,
			0'-7.8351", 1'-10.4182",     79,
			0'-8.0283", 1'-10.4717",     79,
			0'-11.9551", 1'-11.3360",     79,
			1'-3.3503", 1'-11.7548",     79,
			1'-6.5000", 1'-11.8802",     79,
			1'-9.6497", 1'-11.7548",     79,
			2'-1.0449", 1'-11.3360",     79,
			2'-4.9717", 1'-10.4717",     79,
			2'-5.1649", 1'-10.4182",     79,
			2'-5.5543", 1'-10.2843",     79,
			2'-5.9348", 1'-10.0646",     79,
			2'-6.2714", 1'-9.7822",     79,
			2'-6.5538", 1'-9.4457",     79,
			2'-6.7734", 1'-9.0652",     79,
			2'-6.9237", 1'-8.6523",     79,
			2'-7.0000", 1'-8.2197",     79,
			2'-7.0000", 1'-8.0000",     79,
			2'-7.0000", 0'-11.5000",     15,
			0'-6.0000", 0'-11.5000",     -1,
			0'-9.6421", 1'-8.3036",     15,
			0'-9.8986", 1'-8.3657",     15,
			0'-8.2504", 1'-10.0139",     15,
			0'-7.9697", 1'-9.9366",     79,
			0'-7.8002", 1'-9.8893",     79,
			0'-7.4830", 1'-9.7372",     79,
			0'-7.1969", 1'-9.5323",     79,
			0'-6.9508", 1'-9.2809",     79,
			0'-6.7521", 1'-8.9905",     79,
			0'-6.6068", 1'-8.6701",     79,
			0'-6.5194", 1'-8.3293",     79,
			0'-6.5000", 1'-8.0000",     79,
			0'-6.5000", 1'-7.1207",     15,
			0'-8.5000", 1'-5.9660",     15,
			0'-8.5000", 1'-6.8571",     79,
			0'-8.4946", 1'-6.8784",     79,
			0'-8.5229", 1'-7.1393",     79,
			0'-8.5961", 1'-7.3914",     79,
			0'-8.7120", 1'-7.6269",     79,
			0'-8.8670", 1'-7.8387",     79,
			0'-9.0564", 1'-8.0204",     79,
			0'-9.2745", 1'-8.1664",     79,
			0'-9.5147", 1'-8.2723",     79,
			0'-9.6421", 1'-8.3036",     -1,
			0'-10.2811", 1'-8.4546",     15,
			0'-8.6227", 1'-10.1130",     15,
			1'-0.0466", 1'-10.8444",     15,
			1'-1.1206", 1'-8.9841",     15,
			0'-10.2811", 1'-8.4546",     -1,
			1'-0.3984", 1'-10.9016",     15,
			1'-1.4764", 1'-9.0344",     15,
			1'-3.8408", 1'-9.2805",     15,
			1'-3.3130", 1'-11.2502",     15,
			1'-0.3984", 1'-10.9016",     -1,
			1'-4.1797", 1'-9.3033",     15,
			1'-3.6511", 1'-11.2764",     15,
			1'-6.3333", 1'-11.3799",     15,
			1'-6.3333", 1'-9.3755",     15,
			1'-4.1797", 1'-9.3033",     -1,
			1'-6.6667", 1'-11.3799",     15,
			1'-9.3489", 1'-11.2764",     15,
			1'-8.8203", 1'-9.3033",     15,
			1'-6.6667", 1'-9.3755",     15,
			1'-6.6667", 1'-11.3799",     -1,
			1'-9.6870", 1'-11.2502",     15,
			1'-9.1592", 1'-9.2805",     15,
			1'-11.5236", 1'-9.0344",     15,
			2'-0.6016", 1'-10.9016",     15,
			1'-9.6870", 1'-11.2502",     -1,
			1'-11.8794", 1'-8.9841",     15,
			2'-0.9534", 1'-10.8444",     15,
			2'-4.3773", 1'-10.1130",     15,
			2'-2.7189", 1'-8.4546",     15,
			1'-11.8794", 1'-8.9841",     -1,
			2'-3.3579", 1'-8.3037",     79,
			2'-3.3798", 1'-8.3040",     79,
			2'-3.6271", 1'-8.2159",     79,
			2'-3.8553", 1'-8.0862",     79,
			2'-4.0575", 1'-7.9189",     79,
			2'-4.2276", 1'-7.7190",     79,
			2'-4.3603", 1'-7.4926",     79,
			2'-4.4518", 1'-7.2465",     79,
			2'-4.4991", 1'-6.9884",     79,
			2'-4.5000", 1'-6.8571",     79,
			2'-4.5000", 1'-5.9660",     15,
			2'-6.5000", 1'-7.1207",     15,
			2'-6.5000", 1'-8.0000",     79,
			2'-6.5000", 1'-8.1759",     79,
			2'-6.4389", 1'-8.5224",     79,
			2'-6.3186", 1'-8.8531",     79,
			2'-6.1426", 1'-9.1578",     79,
			2'-5.9165", 1'-9.4273",     79,
			2'-5.6469", 1'-9.6535",     79,
			2'-5.3422", 1'-9.8294",     79,
			2'-5.0303", 1'-9.9366",     79,
			2'-4.7496", 1'-10.0139",     15,
			2'-3.1014", 1'-8.3657",     15,
			2'-3.3579", 1'-8.3037",     -1,
			2'-6.5000", 1'-3.3879",     15,
			2'-4.5000", 1'-2.8520",     15,
			2'-4.5000", 1'-5.5811",     15,
			2'-6.5000", 1'-6.7358",     15,
			2'-6.5000", 1'-3.3879",     -1,
			2'-6.5000", 1'-3.0428",     79,
			2'-6.5000", 1',     15,
			2'-4.5000", 1',     15,
			2'-4.5000", 1'-2.5069",     15,
			2'-6.5000", 1'-3.0428",     -1,
			2'-4.1666", 1',     15,
			1'-8.5000", 1',     15,
			1'-8.5000", 1'-0.1750",     79,
			1'-8.4683", 1'-0.3548",     15,
			2'-4.1666", 1'-2.4176",     15,
			2'-4.1666", 1',     -1,
			2'-4.1666", 1'-2.7627",     79,
			2'-4.1666", 1'-5.3886",     15,
			1'-8.3094", 1'-0.8522",     15,
			1'-8.3228", 1'-0.8415",     79,
			1'-8.3820", 1'-0.6768",     15,
			2'-4.1666", 1'-2.7627",     -1,
			2'-4.1666", 1'-5.7735",     79,
			2'-4.1666", 1'-6.8588",     79,
			2'-4.1656", 1'-6.9609",     79,
			2'-4.1281", 1'-7.1616",     79,
			2'-4.0563", 1'-7.3527",     79,
			2'-3.9524", 1'-7.5284",     79,
			2'-3.8196", 1'-7.6835",     79,
			2'-3.6619", 1'-7.8131",     79,
			2'-3.4841", 1'-7.9133",     79,
			2'-3.2916", 1'-7.9812",     79,
			2'-3.2784", 1'-7.9799",     15,
			2'-2.8242", 1'-8.0885",     15,
			1'-8.0271", 1'-1.2914",     15,
			1'-8.0429", 1'-1.2846",     79,
			1'-8.1427", 1'-1.1409",     15,
			2'-4.1666", 1'-5.7735",     -1,
			1'-11.6999", 1'-8.6732",     15,
			2'-2.4399", 1'-8.1756",     15,
			1'-7.7914", 1'-1.5271",     15,
			1'-7.6578", 1'-1.6401",     79,
			1'-7.6409", 1'-1.6427",     15,
			1'-11.6999", 1'-8.6732",     -1,
			1'-11.3434", 1'-8.7223",     79,
			1'-9.0714", 1'-8.9526",     15,
			1'-7.1768", 1'-1.8820",     15,
			1'-7.1939", 1'-1.8839",     79,
			1'-7.3522", 1'-1.8094",     15,
			1'-11.3434", 1'-8.7223",     -1,
			1'-8.7322", 1'-8.9747",     79,
			1'-6.6667", 1'-9.0421",     15,
			1'-6.6667", 1'-1.9930",     15,
			1'-6.6826", 1'-1.9993",     79,
			1'-6.8548", 1'-1.9683",     15,
			1'-8.7322", 1'-8.9747",     -1,
			1'-6.3333", 1'-9.0421",     79,
			1'-4.2678", 1'-8.9747",     15,
			1'-6.1452", 1'-1.9683",     15,
			1'-6.1590", 1'-1.9785",     79,
			1'-6.3333", 1'-1.9930",     15,
			1'-6.3333", 1'-9.0421",     -1,
			1'-1.6566", 1'-8.7223",     79,
			1'-3.9286", 1'-8.9526",     15,
			1'-5.8232", 1'-1.8820",     15,
			1'-5.6585", 1'-1.8228",     79,
			1'-5.6478", 1'-1.8094",     15,
			1'-1.6566", 1'-8.7223",     -1,
			0'-10.5601", 1'-8.1756",     79,
			1'-1.3001", 1'-8.6732",     15,
			1'-5.3591", 1'-1.6427",     15,
			1'-5.2154", 1'-1.5429",     79,
			1'-5.2086", 1'-1.5271",     15,
			0'-10.5601", 1'-8.1756",     -1,
			0'-10.1758", 1'-8.0885",     79,
			0'-9.7216", 1'-7.9799",     79,
			0'-9.6225", 1'-7.9556",     79,
			0'-9.4357", 1'-7.8732",     79,
			0'-9.2661", 1'-7.7596",     79,
			0'-9.1188", 1'-7.6183",     79,
			0'-8.9982", 1'-7.4536",     79,
			0'-8.9081", 1'-7.2704",     79,
			0'-8.8512", 1'-7.0744",     79,
			0'-8.8291", 1'-6.8714",     79,
			0'-8.8334", 1'-6.8588",     15,
			0'-8.8334", 1'-5.7735",     15,
			1'-4.8573", 1'-1.1409",     15,
			1'-4.8599", 1'-1.1578",     79,
			1'-4.9729", 1'-1.2914",     15,
			0'-10.1758", 1'-8.0885",     -1,
			0'-8.8334", 1'-2.7627",     15,
			0'-8.8334", 1'-5.3886",     15,
			1'-4.6906", 1'-0.8522",     15,
			1'-4.6161", 1'-0.6939",     79,
			1'-4.6180", 1'-0.6768",     15,
			0'-8.8334", 1'-2.7627",     -1,
			0'-8.8334", 1',     15,
			1'-4.5000", 1',     15,
			1'-4.5007", 1'-0.1826",     79,
			1'-4.5317", 1'-0.3548",     15,
			0'-8.8334", 1'-2.4176",     15,
			0'-8.8334", 1',     -1,
			0'-8.5000", 1',     79,
			0'-6.5000", 1',     15,
			0'-6.5000", 1'-3.0428",     15,
			0'-8.5000", 1'-2.5069",     15,
			0'-8.5000", 1',     -1,
			0'-8.5000", 1'-2.8520",     15,
			0'-6.5000", 1'-3.3879",     15,
			0'-6.5000", 1'-6.7358",     15,
			0'-8.5000", 1'-5.5811",     15,
			0'-8.5000", 1'-2.8520",     -1,
			1'-4.8333", 1',     15,
			1'-8.1667", 1',     15,
			1'-8.1667", 1'-0.1458",     79,
			1'-8.1160", 1'-0.4330",     79,
			1'-8.0163", 1'-0.7071",     79,
			1'-7.8705", 1'-0.9596",     79,
			1'-7.6830", 1'-1.1830",     79,
			1'-7.4596", 1'-1.3705",     79,
			1'-7.2071", 1'-1.5163",     79,
			1'-6.9330", 1'-1.6160",     79,
			1'-6.6458", 1'-1.6667",     79,
			1'-6.3542", 1'-1.6667",     79,
			1'-6.0670", 1'-1.6160",     79,
			1'-5.7929", 1'-1.5163",     79,
			1'-5.5404", 1'-1.3705",     79,
			1'-5.3170", 1'-1.1830",     79,
			1'-5.1295", 1'-0.9596",     79,
			1'-4.9837", 1'-0.7071",     79,
			1'-4.8840", 1'-0.4330",     79,
			1'-4.8333", 1'-0.1458",     79,
			1'-4.8333", 1',     -1

	if gs_detlevel_3D_m = 2 then	! Detailed
		PRISM_  9, 1/3",                            !  Grille around the door
				0'-4.1667", 2'-0.7500",     15,
				0'-4.1667", 0'-10.5000",     15,
				2'-8.8333", 0'-10.5000",     15,
				2'-8.8333", 2'-0.7500",     15,
				2'-8.5000", 2'-0.7500",     15,
				2'-8.5000", 0'-10.8333",     15,
				0'-4.5000", 0'-10.8333",     15,
				0'-4.5000", 2'-0.7500",     15,
				0'-4.1667", 2'-0.7500",     -1

		prism_  13,      1/3",
				0'-4.5000", 2'-1.5488",      15,
				0'-4.5000", 2'-1.2500",      15,
				0'-4.1667", 2'-1.2500",      15,
				0'-4.1667", 2'-1.8107",      15,
				1'-6.5000", -2'-8.4521",    915,
				0', -90'-8.2654",   4079,
				2'-8.8333", 2'-1.8107",      15,
				2'-8.8333", 2'-1.2500",      15,
				2'-8.5000", 2'-1.2500",      15,
				2'-8.5000", 2'-1.5488",      15,
				1'-6.5000", -2'-8.4521",    915,
				0', 89'-0.5211",   4079,
				0'-4.5000", 2'-1.5488",     -1

		del 2
		gosub "TRADITIONAL_TYPE_1_Handle"		!! Handle
	else
		del 2
	endif

	if bFire then
		add 3",5",10"
		rotx 90
		picture "fire_2", aa-6", 13", 0	 	! fire_2.jpg
		del 2
	endif
return


!-----! Top of the Stove  -----
"TRADITIONAL_TYPE_1_TopStove":
	addz 28"
	r=3"     ! Fillet radius

	tube    7, 41, 1+2,
			2 1/4", 0, 0,
			0, 0, 0,
			0, 1/4", 0,
			3/4", 1", 0,
			1 1/4", 1", 0,
			2 1/4", 2", 0,
			2 1/4", 2", 0,

			r-r*cos(15), bb-r+r*sin(15), 0, 0,
			r-r*cos(0), bb-r+r*sin(0), 0, 0,

			0, r, 0, 0,
			r-r*cos(0), r-r*sin(0), 0, 0,
			r-r*cos(15), r-r*sin(15), 0, 0,
			r-r*cos(30), r-r*sin(30), 0, 0,
			r-r*cos(45), r-r*sin(45), 0, 0,
			r-r*cos(60), r-r*sin(60), 0, 0,
			r-r*cos(75), r-r*sin(75), 0, 0,
			r-r*cos(90), r-r*sin(90), 0, 0,

			aa-r+r*cos(90), r-r*sin(90), 0, 0,
			aa-r+r*cos(75), r-r*sin(75), 0, 0,
			aa-r+r*cos(60), r-r*sin(60), 0, 0,
			aa-r+r*cos(45), r-r*sin(45), 0, 0,
			aa-r+r*cos(30), r-r*sin(30), 0, 0,
			aa-r+r*cos(15), r-r*sin(15), 0, 0,
			aa-r+r*cos(0), r-r*sin(0), 0, 0,

			aa-r+r*cos(0), bb-r+r*sin(0), 0, 0,
			aa-r+r*cos(15), bb-r+r*sin(15), 0, 0,
			aa-r+r*cos(30), bb-r+r*sin(30), 0, 0,
			aa-r+r*cos(45), bb-r+r*sin(45), 0, 0,
			aa-r+r*cos(60), bb-r+r*sin(60), 0, 0,
			aa-r+r*cos(75), bb-r+r*sin(75), 0, 0,
			aa-r+r*cos(90), bb-r+r*sin(90), 0, 0,

			aa/2+7 3/4", bb, 0, 0,
			aa/2+7 1/2"*cos(45), bb-2"+7 1/2"*sin(45), 0, 0,
			aa/2+7 1/2"*cos(60), bb-2"+7 1/2"*sin(60), 0, 0,
			aa/2+7 1/2"*cos(75), bb-2"+7 1/2"*sin(75), 0, 0,
			aa/2-7 1/2"*cos(90), bb-2"+7 1/2"*sin(90), 0, 0,
			aa/2-7 1/2"*cos(75), bb-2"+7 1/2"*sin(75), 0, 0,
			aa/2-7 1/2"*cos(60), bb-2"+7 1/2"*sin(60), 0, 0,
			aa/2-7 1/2"*cos(45), bb-2"+7 1/2"*sin(45), 0, 0,
			aa/2-7 3/4", bb, 0, 0,

			r-r*cos(90), bb-r+r*sin(90), 0, 0,
			r-r*cos(75), bb-r+r*sin(75), 0, 0,
			r-r*cos(60), bb-r+r*sin(60), 0, 0,
			r-r*cos(45), bb-r+r*sin(45), 0, 0,
			r-r*cos(30), bb-r+r*sin(30), 0, 0,
			r-r*cos(15), bb-r+r*sin(15), 0, 0,
			r-r*cos(0), bb-r+r*sin(0), 0, 0,

			r-r*cos(0), r-r*sin(0), 0, 0

	addz 1 1/2"
	prism_      38,      1/2",                          ! Fill plate
			2'-9.8525", 0'-2.2500",      15,
			2'-10.1891", 0'-2.2943",      15,
			2'-10.3653", 0'-2.3673",      15,
			2'-10.5166", 0'-2.4834",      15,
			2'-10.6327", 0'-2.6347",      15,
			2'-10.7057", 0'-2.8109",      15,
			2'-10.7500", 0'-3.1475",      15,
			2'-10.7500", 1'-4.8525",      15,
			2'-10.7057", 1'-5.1891",      15,
			2'-10.6327", 1'-5.3653",      15,
			2'-10.5166", 1'-5.5166",      15,
			2'-10.3653", 1'-5.6327",      15,
			2'-10.1891", 1'-5.7057",      15,
			2'-9.8525", 1'-5.7500",      15,
			2'-1.1166", 1'-5.7500",      15,
			1'-10.1831", 1'-9.7104",      15,
			1'-9.1153", 1'-10.5298",      15,
			1'-7.8538", 1'-11.0524",      15,
			1'-6.5000", 1'-11.2306",      15,
			1'-5.1462", 1'-11.0524",      15,
			1'-3.8847", 1'-10.5298",      15,
			1'-2.8169", 1'-9.7104",      15,
			0'-11.8834", 1'-5.7500",      15,
			0'-3.1475", 1'-5.7500",      15,
			0'-2.8109", 1'-5.7057",      15,
			0'-2.6347", 1'-5.6327",      15,
			0'-2.4834", 1'-5.5166",      15,
			0'-2.3673", 1'-5.3653",      15,
			0'-2.2943", 1'-5.1891",      15,
			0'-2.2500", 1'-4.8525",      15,
			0'-2.2500", 0'-3.1475",      15,
			0'-2.2943", 0'-2.8109",      15,
			0'-2.3673", 0'-2.6347",      15,
			0'-2.4834", 0'-2.4834",      15,
			0'-2.6347", 0'-2.3673",      15,
			0'-2.8109", 0'-2.2943",      15,
			0'-3.1475", 0'-2.2500",      15,
			2'-9.8525", 0'-2.2500",     -1
	del 1

	addz 2"
	prism_  2, 2",
			aa/2, bb-2", 979,
			5", 360, 4079
	cutpolya 2, 1, 0,
			 aa/2, bb-2", 979,
			5", 360, 4079
	del 1

	if gs_detlevel_3D_m = 2 then	! Detailed
		add aa/2,bb-2",3 1/2"
		prism_  3, 1/2",
				-sqr((5 1/2"*5 1/2")-(4 1/10"*4 1/10")), -4 1/10", 79,
				0, 0, 979,
				5 1/2", 2*(90-(asn(4 1/10"/5 1/2"))), 4079

		prism_  3, 3/8",
				-sqr((6"*6")-(4 6/10"*4 6/10")), -4 6/10", 79,
				0, 0, 979,
				5 1/2", 2*(90-(asn(4 6/10"/6"))), 4079
		del 1

		add aa/2,1.2*r,0
		for I=1 to 18
			addx 1 1/8"
			cutpolya 7, 1, 0,
					 -1/4", 1/2", 79,
					 0, 1/2", 900,
					 0, 180, 4079,
					 1/4", 1 1/2", 79,
					 0, 1 1/2", 900,
					 0, 180, 4079,
					 -1/4", 1/2", 79
			if I=9 then
				del 9
				mulx -1
			endif
		next I
		del 10
		del 1
	endif

	add 1.2*r,1.2*r,2"

	aa=aa-2.4*r
	bb=bb-2.4*r
	r=3 1/4"        ! Fillet radius

	tube    9, 31, 1+2,
			3", 1 1/2", 0,
			2", 1 1/2", 0,
			1/2", 0, 0,
			0, 0, 0,
			0, 1/4", 0,
			2", 2", 0,
			2 1/2", 2", 0,
			2 1/2", 1 7/8", 0,
			3", 1 7/8", 0,

			r-r*cos(15), bb-r+r*sin(15), 0, 0,
			r-r*cos(0), bb-r+r*sin(0), 0, 0,

			r-r*cos(0), r-r*sin(0), 0, 0,
			r-r*cos(15), r-r*sin(15), 0, 0,
			r-r*cos(30), r-r*sin(30), 0, 0,
			r-r*cos(45), r-r*sin(45), 0, 0,
			r-r*cos(60), r-r*sin(60), 0, 0,
			r-r*cos(75), r-r*sin(75), 0, 0,
			r-r*cos(90), r-r*sin(90), 0, 0,

			aa-r+r*cos(90), r-r*sin(90), 0, 0,
			aa-r+r*cos(75), r-r*sin(75), 0, 0,
			aa-r+r*cos(60), r-r*sin(60), 0, 0,
			aa-r+r*cos(45), r-r*sin(45), 0, 0,
			aa-r+r*cos(30), r-r*sin(30), 0, 0,
			aa-r+r*cos(15), r-r*sin(15), 0, 0,
			aa-r+r*cos(0), r-r*sin(0), 0, 0,

			aa-r+r*cos(0), bb-r+r*sin(0), 0, 0,
			aa-r+r*cos(15), bb-r+r*sin(15), 0, 0,
			aa-r+r*cos(30), bb-r+r*sin(30), 0, 0,
			aa-r+r*cos(45), bb-r+r*sin(45), 0, 0,
			aa-r+r*cos(60), bb-r+r*sin(60), 0, 0,
			aa-r+r*cos(75), bb-r+r*sin(75), 0, 0,
			aa-r+r*cos(90), bb-r+r*sin(90), 0, 0,

			r-r*cos(90), bb-r+r*sin(90), 0, 0,
			r-r*cos(75), bb-r+r*sin(75), 0, 0,
			r-r*cos(60), bb-r+r*sin(60), 0, 0,
			r-r*cos(45), bb-r+r*sin(45), 0, 0,
			r-r*cos(30), bb-r+r*sin(30), 0, 0,
			r-r*cos(15), bb-r+r*sin(15), 0, 0,
			r-r*cos(0), bb-r+r*sin(0), 0, 0,

			r-r*cos(0), r-r*sin(0), 0, 0

	if gs_detlevel_3D_m = 2 then	! Detailed
		for I=1 to 18
		cutend
		next I
	endif

	del 1
	cutend

	addz 3 1/4"
	prism_      29,      3/8",
			0'-7.0466", 1'-1.4000",      15,
			0'-6.7920", 1'-1.3665",      15,
			0'-6.7379", 1'-1.3441",      15,
			0'-6.6915", 1'-1.3085",      15,
			0'-6.6559", 1'-1.2621",      15,
			0'-6.6335", 1'-1.2080",      15,
			0'-6.6000", 1'-0.9534",      15,
			0'-6.6000", 0'-7.0466",      15,
			0'-6.6335", 0'-6.7920",      15,
			0'-6.6559", 0'-6.7379",      15,
			0'-6.6915", 0'-6.6915",      15,
			0'-6.7379", 0'-6.6559",      15,
			0'-6.7920", 0'-6.6335",      15,
			0'-7.0466", 0'-6.6000",      15,
			2'-5.9534", 0'-6.6000",      15,
			2'-6.2080", 0'-6.6335",      15,
			2'-6.2621", 0'-6.6559",      15,
			2'-6.3085", 0'-6.6915",      15,
			2'-6.3441", 0'-6.7379",      15,
			2'-6.3665", 0'-6.7920",      15,
			2'-6.4000", 0'-7.0466",      15,
			2'-6.4000", 1'-0.9534",      15,
			2'-6.3665", 1'-1.2080",      15,
			2'-6.3441", 1'-1.2621",      15,
			2'-6.3085", 1'-1.3085",      15,
			2'-6.2621", 1'-1.3441",      15,
			2'-6.2080", 1'-1.3665",      15,
			2'-5.9534", 1'-1.4000",      15,
			0'-7.0466", 1'-1.4000",     -1
	del 1

	add 37"/2,18",4"
	addz -12"
	cone 8",1",6",90,90	!  Chinmney Pipe
	del 2

	del 1       !  del first tramsform (addz 25")
return


!-----! Box of the Stove  -----
"TRADITIONAL_TYPE_1_BoxStove":
	aa=37"
	bb=20"
	r=3"     ! Fillet radius

	addz 8"
	f=tan(60)*3"

	q=(aa/2-(3"+f))/sin(15)+6"

	tube   9, 53, 1+2,
			1 1/2", 0, 0,
			0, 0, 0,
			0, 1/4", 0,
			1/2", 3/4", 0,
			3/5", 3/4", 0,
			5/5", 5/4", 0,
			11/10", 5/4", 0,
			1 2/5", 2", 0,
			1 1/2", 2", 0,

			r-r*cos(15), bb-r+r*sin(15), 0, 0,
			r-r*cos(0), bb-r+r*sin(0), 0, 0,

			0, r-1", 0, 0,
			r-r*cos(0), r-1"-r*sin(0), 0, 0,
			r-r*cos(15), r-1"-r*sin(15), 0, 0,
			r-r*cos(30), r-1"-r*sin(30), 0, 0,
			r-r*cos(45), r-1"-r*sin(45), 0, 0,
			r-r*cos(60), r-1"-r*sin(60), 0, 0,
			r-r*cos(75), r-1"-r*sin(75), 0, 0,
			r-r*cos(90), r-1"-r*sin(90), 0, 0,

			3", -1", 0, 0,
			3"+3"*sin(15), -1"-(3"-3"*cos(15)), 0, 0,
			3"+3"*sin(30), -1"-(3"-3"*cos(30)), 0, 0,
			3"+3"*sin(45), -1"-(3"-3"*cos(45)), 0, 0,
			3"+3"*sin(60), -1"-(3"-3"*cos(60)), 0, 0,

			3"+f-cos(45)*3", -1"-3"*sin(45), 0, 0,
			3"+f-cos(60)*3", -1"-3"*sin(60), 0, 0,
			3"+f-cos(75)*3", -1"-3"*sin(75), 0, 0,

			aa/2-q*sin(10), -(1"+3"*sin(75))+q*cos(15)-q*cos(10), 0, 0,
			aa/2-q*sin(5), -(1"+3"*sin(75))+q*cos(15)-q*cos(5), 0, 0,

			aa/2, -1"-3"*sin(75)+q*cos(15)-q, 0, 0,

			aa/2+q*sin(5), -(1"+3"*sin(75))+q*cos(15)-q*cos(5), 0, 0,
			aa/2+q*sin(10), -(1"+3"*sin(75))+q*cos(15)-q*cos(10), 0, 0,

			aa-3"-f+cos(75)*3", -1"-3"*sin(75), 0, 0,
			aa-3"-f+cos(60)*3", -1"-3"*sin(60), 0, 0,
			aa-3"-f+cos(45)*3", -1"-3"*sin(45), 0, 0,

			aa-3"-3"*sin(60), -1"-(3"-3"*cos(60)), 0, 0,
			aa-3"-3"*sin(45), -1"-(3"-3"*cos(45)), 0, 0,
			aa-3"-3"*sin(30), -1"-(3"-3"*cos(30)), 0, 0,
			aa-3"-3"*sin(15), -1"-(3"-3"*cos(15)), 0, 0,
			aa-3", -1", 0, 0,

			aa-r+r*cos(90), r-1"-r*sin(90), 0, 0,
			aa-r+r*cos(75), r-1"-r*sin(75), 0, 0,
			aa-r+r*cos(60), r-1"-r*sin(60), 0, 0,
			aa-r+r*cos(45), r-1"-r*sin(45), 0, 0,
			aa-r+r*cos(30), r-1"-r*sin(30), 0, 0,
			aa-r+r*cos(15), r-1"-r*sin(15), 0, 0,
			aa-r+r*cos(0), r-1"-r*sin(0), 0, 0,

			aa-r+r*cos(0), bb-r+r*sin(0), 0, 0,
			aa-r+r*cos(15), bb-r+r*sin(15), 0, 0,
			aa-r+r*cos(30), bb-r+r*sin(30), 0, 0,
			aa-r+r*cos(45), bb-r+r*sin(45), 0, 0,
			aa-r+r*cos(60), bb-r+r*sin(60), 0, 0,
			aa-r+r*cos(75), bb-r+r*sin(75), 0, 0,
			aa-r+r*cos(90), bb-r+r*sin(90), 0, 0,

			r-r*cos(90), bb-r+r*sin(90), 0, 0,
			r-r*cos(75), bb-r+r*sin(75), 0, 0,
			r-r*cos(60), bb-r+r*sin(60), 0, 0,
			r-r*cos(45), bb-r+r*sin(45), 0, 0,
			r-r*cos(30), bb-r+r*sin(30), 0, 0,
			r-r*cos(15), bb-r+r*sin(15), 0, 0,
			r-r*cos(0), bb-r+r*sin(0), 0, 0,

			r-r*cos(0), r-1"-r*sin(0), 0, 0


	prism_      44,      2",                    ! Lower fill plate
			0'-1.5000", 0'-2.0983",      15,
			0'-1.5636", 0'-1.6151",      15,
			0'-1.7122", 0'-1.2565",      15,
			0'-1.9485", 0'-0.9485",      15,
			0'-2.2565", 0'-0.7122",      15,
			0'-2.6151", 0'-0.5636",      15,
			0'-4.1680", 0'-0.3592",      15,
			0'-5.2565", -0'-0.0917",      15,
			0'-6.1911", -0'-0.8089",      15,
			0'-7.1446", -0'-2.0515",      15,
			0'-7.4526", -0'-2.2878",      15,
			0'-7.9086", -0'-2.4767",      15,
			0'-10.8444", -0'-3.2893",      15,
			1'-2.6382", -0'-3.7887",      15,
			1'-6.5000", -0'-3.9573",      15,
			1'-10.3618", -0'-3.7887",      15,
			2'-2.1556", -0'-3.2893",      15,
			2'-5.0914", -0'-2.4767",      15,
			2'-5.5474", -0'-2.2878",      15,
			2'-5.8554", -0'-2.0515",      15,
			2'-6.8089", -0'-0.8089",      15,
			2'-7.7435", -0'-0.0917",      15,
			2'-8.8320", 0'-0.3592",      15,
			2'-10.3849", 0'-0.5636",      15,
			2'-10.7435", 0'-0.7122",      15,
			2'-11.0515", 0'-0.9485",      15,
			2'-11.2878", 0'-1.2565",      15,
			2'-11.4364", 0'-1.6151",      15,
			2'-11.5000", 0'-2.0983",      15,
			2'-11.5000", 1'-4.9017",      15,
			2'-11.4364", 1'-5.3849",      15,
			2'-11.2878", 1'-5.7435",      15,
			2'-11.0515", 1'-6.0515",      15,
			2'-10.7435", 1'-6.2878",      15,
			2'-10.3849", 1'-6.4364",      15,
			2'-9.9017", 1'-6.5000",      15,
			0'-3.0983", 1'-6.5000",      15,
			0'-2.6151", 1'-6.4364",      15,
			0'-2.2565", 1'-6.2878",      15,
			0'-1.9485", 1'-6.0515",      15,
			0'-1.7122", 1'-5.7435",      15,
			0'-1.5636", 1'-5.3849",      15,
			0'-1.5000", 1'-4.9017",      15,
			0'-1.5000", 0'-2.0983",     -1

	roty -90
	addy 2"
	cutpoly 4,
			0, 0,
			17", 0,
			17", -10",
			0, -10"
	del 2

	addz 2"
	prism_  24, 18",                    ! Wood Burning Box
			aa-1 1/2", 1 3/4",      15,
			2'-11.5000", 1'-4.9017",      79,
			2'-11.4364", 1'-5.3849",      79,
			2'-11.2878", 1'-5.7435",      79,
			2'-11.0515", 1'-6.0515",      79,
			2'-10.7435", 1'-6.2878",      79,
			2'-10.3849", 1'-6.4364",      79,
			2'-9.9017", 1'-6.5000",      79,
			0'-3.0983", 1'-6.5000",      79,
			0'-2.6151", 1'-6.4364",      79,
			0'-2.2565", 1'-6.2878",      79,
			0'-1.9485", 1'-6.0515",      79,
			0'-1.7122", 1'-5.7435",      79,
			0'-1.5636", 1'-5.3849",      79,
			0'-1.5000", 1'-4.9017",      79,
			1 1/2", 1 3/4",         15,
			1 3/4", 1 1/2",         15,
			aa-1 3/4", 1 1/2",      15,
			aa-1 1/2", 1 3/4",      -1,

			1 3/4", 1 3/4",         15,
			aa-1 3/4", 1 3/4",      15,
			aa-1 3/4", bb-4",      15,
			1 3/4", bb-4",      15,
			1 3/4", 1 3/4",        -1
	del 1

	del 1                                       ! Del addz 8"
	cutend
return


!-----! Sides -----
"TRADITIONAL_TYPE_1_Sides":
	if gs_detlevel_3D_m = 2 then	! Detailed
		addx 1 1/2"
		rotx 90
		roty -90

		for K=1 to 2
			PRISM_   29, 1/3",
					-1'-2.9017", 0'-10.5000",     15,
					-0'-4.0000", 0'-10.5000",     15,
					-0'-4.0000", 2'-1.8107",     15,
					-0'-4.6722", 2'-2.2876",     79,
					-0'-6.1618", 2'-2.9934",     79,
					-0'-7.7513", 2'-3.4299",     79,
					-0'-9.3924", 2'-3.5837",     79,
					-0'-11.0353", 2'-3.4502",     79,
					-1'-0.6301", 2'-3.0334",     79,
					-1'-2.1283", 2'-2.3460",     79,
					-1'-2.9017", 2'-1.8107",     15,
					-1'-2.9017", 0'-10.5000",     -1,
					-0'-4.3333", 0'-10.8333",     15,
					-1'-2.5684", 0'-10.8333",     15,
					-1'-2.5684", 1'-10.9072",     15,
					-0'-4.3333", 1'-10.9072",     15,
					-0'-4.3333", 0'-10.8333",     -1,
					-0'-4.3333", 1'-11.2406",     79,
					-0'-4.3333", 2'-1.6195",     15,
					-0'-4.9888", 2'-2.0672",     79,
					-0'-6.4353", 2'-2.7214",     79,
					-0'-7.9734", 2'-3.1145",     79,
					-0'-9.5564", 2'-3.2346",     79,
					-0'-11.1362", 2'-3.0779",     79,
					-1'-0.6648", 2'-2.6492",     79,
					-1'-2.0958", 2'-1.9617",     79,
					-1'-2.5684", 2'-1.6195",     15,
					-1'-2.5684", 1'-11.2406",     15,
					-0'-4.3333", 1'-11.2406",     -1
			addz -(aa-3"+1/3")
		next K
		del 5
	endif
return



! ======================================================================
! TRADITIONAL TYPE 2
! ======================================================================
"TRADITIONAL_TYPE_2":
	gosub "Hotspots"
	doorHeight	= ZZYZX-legHeight-0.125 !0.525
	doorWidth	= (A-0.2)/2	!0.2375
	thickness	= 0.01
	reducer		= 0.025
	holeX		= A/2-doorWidth-0.025+0.01


	! Box
	addz legHeight+ 0.01
	rotx 90

	addy 0.045
	cutpolya 4, 1, -0.1,
		holeX, 0, 15,
		A-holeX, 0, 15,
		A-holeX, doorHeight-0.03, 15,
		holeX, doorHeight-0.03, 15,
		0, 0, 0.1
	del 1

	if gs_detlevel_3D_m = 2 then
		holeHeight = ZZYZX - legHeight - doorHeight - 0.035 -0.04
		holeX = 0.025
		nHole = int((doorWidth) / (2*holeX))

		add A/2, ZZYZX-legHeight - 0.035 - holeHeight/2, -0.05
		prism_ 2, 0.01,
			0,0,979,
			0.015, 360, 4079
		del 1

		addy ZZYZX-legHeight - 0.035 - holeHeight
		for i = 1 to nHole
			addx A/2+holeX*2*i
			cutpolya 4, 1, -0.05-thickness*0.9,
				0, 0, 23,
				holeX, 0, 23,
				holeX, holeHeight, 23,
				0, holeHeight, 23,
				0, 0, 0.1
			del 1
		next i

		for i = 1 to nHole
			addx A/2-holeX*2*i-holeX
			cutpolya 4, 1, -0.05-thickness*0.9,
				0, 0, 23,
				holeX, 0, 23,
				holeX, holeHeight, 23,
				0, holeHeight, 23,
				0, 0, 0.1
			del 1
		next i

		del 1
	endif

	del 1
	prism_ 10, ZZYZX - 0.02 - legHeight,
		reducer, B, 15,
		A-reducer, B, 15,
		A-reducer, 0.05, 15,
		reducer, 0.05, 15,
		reducer, B, -1,
		reducer+thickness, B-thickness, 15,
		A-reducer-thickness, B-thickness, 15,
		A-reducer-thickness, 0.05+thickness, 15,
		reducer+thickness, 0.05+thickness, 15,
		reducer+thickness, B-thickness, -1

	cutend
	if gs_detlevel_3D_m = 2 then
		for i = 1 to nHole*2
			cutend
		next i
	endif
	del 1


	! Top
	cirleSize = 0.04
	alfa = ATN(cirleSize/(A/2))
	cirleRadius	= (A/4)/cos(90-alfa)
	toler 0.01 / gs_resol
	addz ZZYZX-0.01
	prism_ 8, 0.01,
		0, B, 15,
		A, B, 15,
		A, cirleSize, 79,
		A/2, cirleRadius, 900,
		A/2, 0, 3079,
		A/2, cirleRadius, 900,
		0, cirleSize, 3079,
		0, B, -1
	del 1

	! Bottom
	cirleSize = 0.02
	alfa = ATN(cirleSize/((A-reducer)/2))
	cirleRadius	= ((A/2-reducer)/2)/cos(90-alfa)
	toler 0.01 / gs_resol
	addz legHeight
	prism_ 8, 0.01,
		reducer, B, 15,
		A-reducer, B, 15,
		A-reducer, cirleSize, 79,
		A/2, cirleRadius, 900,
		A/2, 0, 3079,
		A/2, cirleRadius, 900,
		reducer, cirleSize, 3079,
		reducer, B, -1
	del 1

	!! Legs
	if legHeight > EPS then gosub "TRADITIONAL_TYPE_2_Legs"

	!! Picture
	if bFire then gosub "TRADITIONAL_TYPE_2_Picture"

	!! Door
	gosub "TRADITIONAL_TYPE_2_Door"
return

!-----! Legs -----
"TRADITIONAL_TYPE_2_Legs":
	legOffset = legHeight/2
	reducerL = reducer
	reducerY = 0.05
	gosub "TRADITIONAL_TYPE_2_Leg"
	mulx -1
	addx -A
	gosub "TRADITIONAL_TYPE_2_Leg"
	del 2

	muly -1
	addy -B
	reducerY = 0
	gosub "TRADITIONAL_TYPE_2_Leg"
	mulx -1
	addx -A
	gosub "TRADITIONAL_TYPE_2_Leg"
	del 2
	del 2
return

!-----! Leg -----
"TRADITIONAL_TYPE_2_Leg":
	ruled 6, 1+2+4+16+32,
		0, 0, 0,
		0, 0.05, 0,
		thickness, 0.05, 0,
		thickness, thickness, 0,
		0.05, thickness, 0,
		0.05, 0, 0,

		reducerL, reducerY, legHeight,
		reducerL, legOffset+0.05+reducerY, legHeight,
		reducerL+thickness, legOffset+0.05+reducerY, legHeight,
		reducerL+thickness, thickness+reducerY, legHeight,
		legOffset+0.05, thickness+reducerY, legHeight,
		legOffset+0.05, reducerY, legHeight

return

!-----! Picture -----
"TRADITIONAL_TYPE_2_Picture":
	pHeight = 0.19*doorHeight/0.525
	rotx 90
	add reducer+thickness, legHeight+0.01+pHeight, -0.05-thickness
	picture "fire_2", A-2*(reducer+thickness), doorHeight-pHeight+0.045, 0  			! fire_2.jpg
	del 2
return


!-----! Door -----
"TRADITIONAL_TYPE_2_Door":
	rotx 90
	add a/2+0.025, legHeight + 0.035, -0.05
	mirror = 1
	gosub "TRADITIONAL_TYPE_2_HalfDoor"
	del 1
	mulx -1
	add -a/2+0.025, legHeight + 0.035, -0.05
	mirror = -1
	gosub "TRADITIONAL_TYPE_2_HalfDoor"
	del 2
	material mat_stove
	add a/2, legHeight + 0.035, -0.05
	hprism_ mat_stove, mat_stove, mat_stove, mat_stove,
		 4, 0.015+gs_detlevel_3D_m*0.01, 0, 0.005, 1,
		-0.025, 0, 15,
		 0.025, 0, 15,
		 0.025, doorHeight, 15,
		-0.025, doorHeight, 15
	!Knob
	if gs_detlevel_3D_m = 2 then
		add 0, 0.17, 0.045
		prism_ 2, 0.01,
			0,0,979,
			0.025, 360, 4079
		addz -0.01
		prism_ 2, 0.01,
			0,0,979,
			0.01, 360, 4079
		del 2
	endif
	del 1
	del 1
return


!-----! Half Door -----
"TRADITIONAL_TYPE_2_HalfDoor":
	toler 0.01 / gs_resol
	mul doorWidth/0.2375, doorHeight/0.525, 1
	material mat_stove
	if gs_detlevel_3D_m = 2 then
		mask = 23
		! Top Cutter
		cutpolya 6, 1, 0.02,
			0,	0.525, 64+mask,
			0, 0.525-0.55, 900,
			0.2375-0.023, 0.525- 0.044, 3000+64+mask,
			0.2375, 0.525-0.078, 1000+64+mask,
			0.2375, 0.525, mask,
			0,	0.525, -1,
			0,	0, 0.01*mirror

		cutpolya 7, 1, 0.02,
			  0.2275,        0.145,      mask,
				   0,        0.145,      mask,
				   0,         0.01,      mask,
			  0.2175,         0.01,      64+mask,
			  0.2175,         0.02,    900,
				   0,           90,   4000+64+mask,
			  0.2275,         0.02,      mask,
			0,	0, 0.01*mirror

		cutpolya 4, 1, 0.02,
				   0,         0.18,      mask,
			  0.2275,         0.18,      mask,
			  0.2275,         0.16,      mask,
				   0,         0.16,      mask,
			0,	0, 0.01*mirror

		cutpolya 4, 1, 0.015,
				0.01,         0.18,      mask,
				0.11,         0.18,      mask,
				0.11,         0.16,      mask,
				0.01,         0.16,      mask,
			0,	0, 0.015*mirror

		cutpolya 4, 1, 0.015,
				0.2175,         0.18,      mask,
				0.12,         0.18,      mask,
				0.12,         0.16,      mask,
				0.2175,         0.16,      mask,
			0,	0, 0.015*mirror

		cutpolya 10, 10, 0.02,
					 0,         0.19,      mask,
				  0.2275,         0.19,      mask,
				  0.2275, 0.4471359980047,      mask+64,
			0.200409840979, 0.4471359980047,    900,
					   0,           67,   4000+64+mask,
			0.2109948093842, 0.4720726208643,      mask+64,
			2.775557561563E-016,       -0.025,    900,
					   0,           23,   4000+64+mask,
					   0,        0.515,      mask,
					   0,         0.19,      mask,
			0,	0, 0.01*mirror

		cutpolya 4, 1, 0.005,
		   0.025,       0.1075,       mask,
		   0.025,       0.0475,       mask,
			0.05,       0.0475,       mask,
			0.05,       0.1075,       mask,
			0,	0, 0.005*mirror

		cutpolya 4, 1, 0.005,
		   0.075,       0.1075,      mask,
		   0.075,       0.0475,      mask,
			 0.1,       0.0475,      mask,
			 0.1,       0.1075,      mask,
			0,	0, 0.005*mirror

		cutpolya 4, 1, 0.005,
			0.15,       0.0475,      mask,
			0.15,       0.1075,      mask,
		   0.125,       0.1075,      mask,
		   0.125,       0.0475,      mask,
			0,	0, 0.005*mirror

		cutpolya 4, 1, 0.005,
			 0.2,       0.0475,      mask,
			 0.2,       0.1075,      mask,
		   0.175,       0.1075,      mask,
		   0.175,       0.0475,      mask,
			0,	0, 0.005*mirror
	endif

	! base
	prism_ 36, 0.01+gs_detlevel_3D_m*0.01,
		0,	0,	15,
		0,	0.525, 15,
		0.2275, 0.525, 79,
		0.2275, 0.515, 979,
		0.2375, 0.515, 3079,
		0.2375, 0.02, 79,
		0.2175, 0.02, 979,
		0.2175, 0, 3079,
		0,	0,	-1,
		0.11,         0.34,      15,
		0.01,         0.34,      15,
		0.01,         0.19,      15,
		0.11,         0.19,      15,
		0.11,         0.34,      -1,
		0.12,         0.34,      15,
	  0.2175,         0.34,      15,
	  0.2175,         0.19,      15,
		0.12,         0.19,      15,
		0.12,         0.34,      -1,
		0.01,         0.35,      15,
		0.11,         0.35,      15,
		0.11, 0.4934592558726,      79,
		0,       -0.025,    900,
		   0, 10.89753213896,   4079,
		0.01, 0.5049056519797,      15,
		0.01,         0.35,      -1,

			0.12, 0.4912363799656,      15,
			0.12,         0.35,      15,
		  0.2175,         0.35,      15,
		  0.2175, 0.4471359980047,      79,
	0.200409840979, 0.4471359980047,    900,
			   0,           67,   4079,
	0.2070874980993, 0.4628675723298,      79,
		0,       -0.025,    900,
			   0, 9.913895242013,   4079,
			0.12, 0.4912363799656,      -1
	body -1

	if gs_detlevel_3D_m = 2 then
		cutend
		cutend
		cutend
		cutend
		cutend
		cutend
		cutend
		cutend
		cutend
		cutend
	endif

	material mat_glass
	prism_ 5, 0.010,
		0.11,         0.34,      15,
		0.01,         0.34,      15,
		0.01,         0.19,      15,
		0.11,         0.19,      15,
		0.11,         0.34,      -1
	body -1

	prism_ 5, 0.010,
		0.12,         0.34,      15,
	  0.2175,         0.34,      15,
	  0.2175,         0.19,      15,
		0.12,         0.19,      15,
		0.12,         0.34,      -1
	body -1

	prism_ 7, 0.010,
		0.01,         0.35,      15,
		0.11,         0.35,      15,
		0.11, 0.4934592558726,      79,
			0,       -0.025,    900,
		   0, 10.89753213896,   4079,
		0.01, 0.5049056519797,      15,
		0.01,         0.35,      -1
	body -1


	prism_ 10, 0.010,
			0.12, 0.4912363799656,      15,
			0.12,         0.35,      15,
		  0.2175,         0.35,      15,
		  0.2175, 0.4471359980047,      79,
	0.200409840979, 0.4471359980047,    900,
			   0,           67,   4079,
	0.2070874980993, 0.4628675723298,      79,
		0,       -0.025,    900,
			   0, 9.913895242013,   4079,
			0.12, 0.4912363799656,      -1
	body -1
	del 1


	!-----! Hinge-----
	if gs_detlevel_3D_m = 2 then
		resol gs_resol
		material mat_stove
		rotx 90

		add doorWidth+0.02, 0.0075, -0.085
		cylind 0.05, 0.0075
		addz 0.015
		prism_ 4, 0.02,
			-0.02,  0.005, 15,
				0,  0.005, 15,
				0, -0.005, 15,
			-0.02, -0.005, 15
		del 2

		add doorWidth+0.02, 0.0075, -doorHeight+0.09
		cylind 0.05, 0.0075
		addz 0.015
		prism_ 4, 0.02,
			-0.02,  0.005, 15,
				0,  0.005, 15,
				0, -0.005, 15,
			-0.02, -0.005, 15
		del 2

		del 1
	endif
return


! ======================================================================
! TRADITIONAL TYPE 3
! ======================================================================
"TRADITIONAL_TYPE_3":
	gosub "Hotspots"
	doorHeight	= ZZYZX-legHeight-2*0.01-0.02-0.065 !0.565
	doorWidth	= A-0.02	!0.655
	thickness	= 0.01
	reducer		= 0.05
	holeX		= 0.03
	cirleSize   = 0.035
	doorBottom  = 0.10

	! Box
	addz legHeight+ 0.01
	rotx 90

	addy 0.02+holeX
	cutpolya 5, 1, -0.1,
		holeX, 0.1, 15,
		A-holeX, 0.1, 15,
		A-holeX, doorHeight-0.03-cirleSize, 15,
		A/2, doorHeight-0.04, 15,
		holeX, doorHeight-0.03-cirleSize, 15,
		0, 0, 0.1
	del 2

	prism_ 10, ZZYZX - 0.02 - legHeight,
		0, B, 15,
		A, B, 15,
		A, reducer, 15,
		0, reducer, 15,
		0, B, -1,
		thickness, B-thickness, 15,
		A-thickness, B-thickness, 15,
		A-thickness, reducer+thickness, 15,
		thickness, reducer+thickness, 15,
		thickness, B-thickness, -1

	cutend
	del 1

	! Top
	addz ZZYZX-0.01
	prism_ 5, 0.01,
		0, B, 15,
		A, B, 15,
		A, 0, 15,
		0, 0, 15,
		0, B, -1
	del 1

	! Bottom
	addz legHeight
	prism_ 5, 0.01,
		0, B, 15,
		A, B, 15,
		A, 0, 15,
		0, 0, 15,
		0, B, -1
	del 1

	!! Legs
	if legHeight > EPS then gosub "TRADITIONAL_TYPE_3_Legs"

	!! Picture
	if bFire then gosub "TRADITIONAL_TYPE_3_Picture"

	!! Door
	gosub "TRADITIONAL_TYPE_3_Door"
return

!-----! Legs -----
"TRADITIONAL_TYPE_3_Legs":
	legOffset = legHeight/4
	reducerL = 0
	reducerY = 0
	addy reducer
	gosub "TRADITIONAL_TYPE_2_Leg"
	mulx -1
	addx -A
	gosub "TRADITIONAL_TYPE_2_Leg"
	del 3

	muly -1
	addy -B
	reducerY = 0
	gosub "TRADITIONAL_TYPE_2_Leg"
	mulx -1
	addx -A
	gosub "TRADITIONAL_TYPE_2_Leg"
	del 2
	del 2
return

!-----! Picture -----
"TRADITIONAL_TYPE_3_Picture":
	pHeight = 0.565*(doorHeight/0.565) -doorBottom -0.05
	rotx 90
	add thickness, legHeight+0.16, -0.05-thickness
	picture "fire_2", A-2*thickness, pHeight+0.045, 0  			! fire_2.jpg
	del 2
return


!-----! Door -----
"TRADITIONAL_TYPE_3_Door":
	doorWidth = doorWidth/2
	alfa = ATN(cirleSize/(doorWidth))
	cirleRadius	= (doorWidth/2)/cos(90-alfa)
	toler 0.01 / gs_resol
	sizer1 = 0.02
	sizer2 = 0.03
	cirleRad2 = (cirleRadius-sizer1) - sqr((cirleRadius-sizer1)*(cirleRadius-sizer1) - (doorWidth-sizer1)*(doorWidth-sizer1))
	cirleRad3 = (cirleRadius-sizer1-sizer2) - sqr((cirleRadius-sizer1-sizer2)*(cirleRadius-sizer1-sizer2) - (doorWidth-sizer1-sizer2)*(doorWidth-sizer1-sizer2))

	rotx 90
	if gs_detlevel_3D_m = 2 then
		add a/2, ZZYZX-0.01, -0.05
		prism_ 4, 0.005,
			-doorWidth+sizer1+sizer2, 0, 15,
			 doorWidth-sizer1-sizer2, 0, 15,
			 doorWidth-sizer1-sizer2, -0.04, 15,
			-doorWidth+sizer1+sizer2, -0.04, 15

		add 0, -0.02, 0.005
		hprism_ mat_stove, mat_stove, mat_stove, mat_stove,
			2, 0.01, 0, 0.005, 1,
			0,0,979,
			0.015, 360, 4079

		holeX = 0.05
		nHole = int((doorWidth) / holeX)-1
		if nHole < 0 then nHole = 0
		for i = 1 to nHole
			addx holeX*i
			hprism_ mat_stove, mat_stove, mat_stove, mat_stove,
				2, 0.005, 0, 0.005, 1,
				0,0,979,
				0.01, 360, 4079
			del 1
			addx -holeX*i
			hprism_ mat_stove, mat_stove, mat_stove, mat_stove,
				2, 0.005, 0, 0.005, 1,
				0,0,979,
				0.01, 360, 4079
			del 1
		next i

		del 2
	endif


	add a/2, legHeight + 0.03, -0.05
	if gs_detlevel_3D_m = 2 then
		hprism_ mat_stove, mat_stove, mat_stove, mat_stove,
			 16, 0.015+gs_detlevel_3D_m*0.01, 0, 0.005, 1,
			-doorWidth, doorBottom, 15,
			 doorWidth, doorBottom, 15,
			 doorWidth, doorHeight-cirleSize, 79,
			 0, doorHeight-cirleRadius, 900,
			 0, doorHeight, 3079,
			 0, doorHeight-cirleRadius, 900,
			-doorWidth, doorHeight-cirleSize, 3079,
			-doorWidth, doorBottom, -1,
			-doorWidth+sizer1, doorBottom+sizer1, 15,
			 doorWidth-sizer1, doorBottom+sizer1, 15,
			 doorWidth-sizer1, doorHeight-sizer1-cirleRad2, 79,
			 0, doorHeight-cirleRadius, 900,
			 0, doorHeight-sizer1, 3079,
			 0, doorHeight-cirleRadius, 900,
			-doorWidth+sizer1, doorHeight-sizer1-cirleRad2, 3079,
			-doorWidth+sizer1, doorBottom+sizer1, -1

		cprism_ mat_stove, mat_stove, mat_stove,
			 16, 0.025,
			-doorWidth+sizer1, doorBottom+sizer1, 15,
			 doorWidth-sizer1, doorBottom+sizer1, 15,
			 doorWidth-sizer1, doorHeight-sizer1-cirleRad2, 79,
			 0, doorHeight-cirleRadius, 900,
			 0, doorHeight-sizer1, 3079,
			 0, doorHeight-cirleRadius, 900,
			-doorWidth+sizer1, doorHeight-sizer1-cirleRad2, 3079,
			-doorWidth+sizer1, doorBottom+sizer1, -1,
			-doorWidth+sizer1+sizer2, doorBottom+sizer1+sizer2, 15,
			 doorWidth-sizer1-sizer2, doorBottom+sizer1+sizer2, 15,
			 doorWidth-sizer1-sizer2, doorHeight-sizer1-sizer2-cirleRad3, 79,
			 0, doorHeight-cirleRadius, 900,
			 0, doorHeight-sizer1-sizer2, 3079,
			 0, doorHeight-cirleRadius, 900,
			-doorWidth+sizer1+sizer2, doorHeight-sizer1-sizer2-cirleRad3, 3079,
			-doorWidth+sizer1+sizer2, doorBottom+sizer1+sizer2, -1

		hprism_ mat_stove, mat_stove, mat_stove, mat_stove,
			 9, 0.015+gs_detlevel_3D_m*0.01, 0, 0.005, 1,
			-doorWidth, 0, 15,
			 doorWidth, 0, 15,
			 doorWidth, doorBottom, 15,
			 doorWidth-sizer1, doorBottom, 15,
			 doorWidth-sizer1, sizer1, 15,
			-doorWidth+sizer1, sizer1, 15,
			-doorWidth+sizer1, doorBottom, 15,
			-doorWidth, doorBottom, 15,
			-doorWidth, 0, -1

		hprism_ mat_stove, mat_stove, mat_stove, mat_stove,
			 5, 0.015+gs_detlevel_3D_m*0.01, 0, 0.005, 1,
			 doorWidth-sizer1, doorBottom, 15,
			 doorWidth-sizer1, sizer1, 15,
			-doorWidth+sizer1, sizer1, 15,
			-doorWidth+sizer1, doorBottom, 15,
			 doorWidth-sizer1, doorBottom, -1

	else
		cprism_ mat_stove, mat_stove, mat_stove,
			 16, 0.015+gs_detlevel_3D_m*0.01,
			-doorWidth, doorBottom, 15,
			 doorWidth, doorBottom, 15,
			 doorWidth, doorHeight-cirleSize, 79,
			 0, doorHeight-cirleRadius, 900,
			 0, doorHeight, 3079,
			 0, doorHeight-cirleRadius, 900,
			-doorWidth, doorHeight-cirleSize, 3079,
			-doorWidth, doorBottom, -1,
			-doorWidth+sizer1+sizer2, doorBottom+sizer1+sizer2, 15,
			 doorWidth-sizer1-sizer2, doorBottom+sizer1+sizer2, 15,
			 doorWidth-sizer1-sizer2, doorHeight-sizer1-sizer2-cirleRad3, 79,
			 0, doorHeight-cirleRadius, 900,
			 0, doorHeight-sizer1-sizer2, 3079,
			 0, doorHeight-cirleRadius, 900,
			-doorWidth+sizer1+sizer2, doorHeight-sizer1-sizer2-cirleRad3, 3079,
			-doorWidth+sizer1+sizer2, doorBottom+sizer1+sizer2, -1

		cprism_ mat_stove, mat_stove, mat_stove,
			 5, 0.015+gs_detlevel_3D_m*0.01,
			-doorWidth, 0, 15,
			 doorWidth, 0, 15,
			 doorWidth, doorBottom, 15,
			-doorWidth, doorBottom, 15,
			-doorWidth, 0, -1
	endif

	cprism_ mat_glass, mat_glass, mat_glass,
		 8, 0.02,
		-doorWidth+sizer1+sizer2, doorBottom+sizer1+sizer2, 15,
		 doorWidth-sizer1-sizer2, doorBottom+sizer1+sizer2, 15,
		 doorWidth-sizer1-sizer2, doorHeight-sizer1-sizer2-cirleRad3, 79,
		 0, doorHeight-cirleRadius, 900,
		 0, doorHeight-sizer1-sizer2, 3079,
		 0, doorHeight-cirleRadius, 900,
		-doorWidth+sizer1+sizer2, doorHeight-sizer1-sizer2-cirleRad3, 3079,
		-doorWidth+sizer1+sizer2, doorBottom+sizer1+sizer2, -1

	del 2


	!Knob
	if gs_detlevel_3D_m = 2 then
		rotx 90
		add a/2-doorWidth+sizer1+sizer2/2, legHeight + 0.03+doorHeight/2, -0.025
		cylind 0.005, 0.015

		del 2
		add a/2-doorWidth+sizer1+sizer2/2, 0.02, legHeight + 0.03+doorHeight/2
		profilRadius = 0.0075
		handleRadius = 0.01
		handleLength= 0.08
		gosub "TRADITIONAL_TYPE_3_Handle"
		del 1
	endif

return


!-----! Handle -----
"TRADITIONAL_TYPE_3_Handle":
	rotx 90
	rotz -90
	rotx 90
	iRes = int(gs_resol/2)
	iAlpha = 90/iRes

	put  0, -1, 0, 0
	put  0, 0, 0, 0
	put  0, handleRadius, 0,0
	for i=1 to iRes-1
		put handleRadius-cos(i*iAlpha)*handleRadius, handleRadius+sin(i*iAlpha)*handleRadius, 0, 0
	next i
	put handleRadius , handleRadius*2,0,0
	put handleRadius+handleLength, handleRadius*2,0,0
	put handleRadius+handleLength+1, handleRadius*2,0,0

	tube 2, NSP/4, 1+2+16+32+128,
		0, 0, 901,
		profilRadius , 360, 4001,
		GET (NSP)

	del 3
	return
return

