
!!Fireplace-Tradicional.gsm


if gs_detlevel_3D_m = DLEV3D_OFF then end

IF gs_shadow=0 THEN SHADOW OFF
IF gs_shadow=1 THEN SHADOW ON

pen gs_cont_pen
material comat

ADD a/2,b/2,0
c=zzyzx
z=1/tan(45+(atn((a-i)/2/(b-1"))/2))
y=1/sin(90-atn((a-i)/2/(b-1")))
x=1/tan(45-(atn((a-i)/2/(b-1"))/2))


	HOTSPOT 0,b/2,zzyzx,1
	HOTSPOT -i/2,b/2,zzyzx,2
	HOTSPOT i/2,b/2,zzyzx,3
	HOTSPOT -a/2,-b/2,zzyzx,4
	HOTSPOT a/2,-b/2,zzyzx,5
	HOTSPOT -a/2,-b/2+1",zzyzx,6
	HOTSPOT a/2,-b/2+1",zzyzx,7

	prism 4,d+1",
	-a/2,-b/2,
	a/2,-b/2,
	a/2,-b/2+1",
	-a/2,-b/2+1"

addz f+d+1"
	prism 4,c-f-1"-d,
	-a/2,-b/2,
	a/2,-b/2,
	a/2,-b/2+1",
	-a/2,-b/2+1"

add -a/2,-b/2,-f
	block (a-g)/2,1",f
addx a/2+g/2
	block (a-g)/2,1",f
del 3


	prism 8,c-6",
	-i/2+z*1",b/2-1",
	i/2-z*1",b/2-1",
	a/2-y*1",-b/2+1",
	a/2,-b/2+1",
	i/2,b/2,
	-i/2,b/2,
	-a/2,-b/2+1",
	-a/2+y*1",-b/2+1"

	MATERIAL p
	prism 4,d,
	-i/2+z*1",b/2-1",
	i/2-z*1",b/2-1",
	a/2-y*1",-b/2+1",
	-a/2+y*1",-b/2+1"

addz d+f+2"
	prism 4,c-d-f-8",
	-i/2+z*1",b/2-1",
	i/2-z*1",b/2-1",
	a/2-y*1",-b/2+1",
	-a/2+y*1",-b/2+1"


addz -f-2"
	material o
	prism 8,f+2",
	-i/2+z*1",b/2-1",
	i/2-z*1",b/2-1",
	a/2-y*1",-b/2+1",
	a/2-y*1"-y*j,-b/2+1",
	i/2-z*1"-z*j,b/2-j-1",
	-i/2+z*1"+z*j,b/2-j-1",
	-a/2+y*1"+y*j,-b/2+1",
	-a/2+y*1",-b/2+1"

if (a-g-2")<=(j*x+1"*y)*2 or v=0 then 10
	prism 4,f+2",
	-a/2+y*1"+y*j,-b/2+1",
	-g/2-1",-b/2+1",
	-g/2-1",-b/2+j+1",
	-a/2+y*1"+x*j,-b/2+j+1"

	prism 4,f+2",
	a/2-y*1"-y*j,-b/2+1",
	g/2+1",-b/2+1",
	g/2+1",-b/2+j+1",
	a/2-y*1"-x*j,-b/2+j+1"
10:

addz -d
	material n
	prism 4,d,
	a/2,-b/2,
	a/2,-b/2-e,
	-a/2,-b/2-e,
	-a/2,-b/2
	del 3

if l<=0 or m<=0 then 1
add 0,b/2-k,c-6"
	material q
	RESOL gs_resol

	prism_ 9, l+6",			         !!Chimney
		0,   m/2,  79,
		0,   0,    900,
		m/2, 180,  4079,
		0,  -m/2,  79,
		0,   0,    900,
		m/2, 180,  4079,
		0,   m/2, -1,
		0,   0,    900,
		m/2 - flue_wallthk, 360, 4079

	HOTSPOT 0,0,l+6",10
	del 1
1:


add -g/2,-b/2+3/4",d+1"
material gmat
	block 4",1/4",f
addx g-4"
	block 4",1/4",f
	del 2


!!!!!!!!!!!!!!!!!!!!!!!!! *** Fire *** !!!!!!!!!!!!!!!!!!!!!!!!!!

if iFireType = 1 then		!! Model

add 0,0,d
mul 0.6,0.6,0.8

	rotx 90
	material flamemat

	for i=1 to 3
	POLY_    95,
			   -0.129043,     0.302607,      1,
			   -0.346118,     0.224719,    900,
				0.0,     -31.1873,   4001,
			   -0.120081,     0.178941,      1,
			   -0.3843,     0.379142,    900,
				0.0,      13.3511,   4001,
			   -0.080992,     0.245364,      1,
			   -0.189805,     0.289821,    900,
				0.0,      30.548,   4001,
			   -0.0735,     0.30684,      1,
				0.050842,     0.32425,    900,
				0.0,     -45.079,   4001,
			   -0.049287,     0.4,      1,
				0.23656,     0.390482,    900,
				0.0,      14.6556,   4001,
			   -0.042395,     0.327369,      1,
			   -0.281144,     0.273306,    900,
				0.0,     -26.1583,   4001,
			   -0.043014,     0.216578,      1,
			   -0.235291,     0.333978,    900,
				0.0,      15.1135,   4001,
			   -0.019055,     0.270772,      1,
			   -0.120953,     0.298418,    900,
				0.0,      29.2016,   4001,
			   -0.018517,     0.323999,      1,
				0.094462,     0.353887,    900,
				0.0,     -14.7193,   4001,
			   -0.022403,     0.353686,      1,
			   -0.079215,     0.275515,    900,
				0.0,     -21.5781,   4001,
				0.002364,     0.327314,      1,
			   -0.070116,     0.28175,    900,
				0.0,     -19.2236,   4001,
				0.013325,     0.300909,      1,
			   -0.23017,     0.246977,    900,
				0.0,    -6.602259,   4001,
				0.017911,     0.272555,      1,
				0.348755,     0.311202,    900,
				0.0,      10.4851,   4001,
				0.030468,     0.212994,      1,
			   -0.068765,     0.302066,    900,
				0.0,      57.3478,   4001,
				0.059771,     0.337559,      1,
				0.196422,     0.375604,    900,
				0.0,    -4.163671,   4001,
				0.057369,     0.347581,      1,
				0.102858,     0.356725,    900,
				0.0,     -13.9188,   4001,
				0.056505,     0.358791,      1,
				0.106785,     0.356181,    900,
				0.0,     -21.4352,   4001,
				0.060937,     0.376986,      1,
			   -0.199912,     0.210733,    900,
				0.0,     -37.0772,   4001,
				0.108432,     0.18611,      1,
				0.015841,     0.270529,    900,
				0.0,      47.1962,   4001,
				0.140692,     0.2811,      1,
				0.008912,     0.18327,    900,
				0.0,     -39.9676,   4001,
				0.172751,     0.173598,      1,
				0.373824,     0.164068,    900,
				0.0,      15.3334,   4001,
				0.177388,     0.120088,      1,
				0.094885,     0.096785,    900,
				0.0,     -79.9669,   4001,
				0.132204,     0.019603,      1,
				0.061295,     0.197184,    900,
				0.0,     -17.2592,   4001,
				0.076324,     0.006561,      1,
			   -0.132883,     1.993124,    900,
				0.0,    -2.197404,   4001,
				0.0,     0.0,      1,
			   -0.001792,     0.0,      1,
				0.006552,     0.783794,    900,
				0.0,    -9.709621,   4001,
			   -0.133863,     0.012635,      1,
			   -0.12247,     0.085503,    900,
				0.0,     -39.9421,   4001,
			   -0.177987,     0.03695,      1,
			   -0.101524,     0.095576,    900,
				0.0,     -46.9528,   4001,
			   -0.196561,     0.111436,      1,
			   -0.065986,     0.091885,    900,
				0.0,     -16.181,   4001,
			   -0.18594,     0.147049,      1,
				0.096429,     0.014348,    900,
				0.0,    -7.542846,   4001,
			   -0.166077,     0.182967,      1,
			   -0.359028,     0.303356,    900,
				0.0,      22.9183,   4001,
			   -0.134427,     0.267609,      1,
				 14.2607,    -1.929091,    900,
				0.0,    -0.139325,   4001,
			   -0.129043,     0.302607,     -1

	roty 60
	next i

	del 4

	!!!!!!!!!!!*************************** woods

mulz 0.8
	add -a*0.25,-b*0.6,theight
	material woodmat
	block a*0.5,b*0.15,zzyzx*0.1
	addy b*0.18
	block a*0.5,b*0.15,zzyzx*0.1
	addz zzyzx*0.1
	rotz -10
	block a*0.5,b*0.15,zzyzx*0.1
	del 4
del 1
del 2
endif
del 1

if iFireType = 2 then		!! Image
	define material "pictmat" 0,
		1, 1, 1,	! surface RGB
		1, 1, 0, 0.5,	! ambient, diffuse, specular, transparent
		0, 0,
		1, 1, 0,	! specular color RGB
		0, 0, 0,	! emission color RGB
		0

	material "pictmat"

	fBoxHeight	= F+2" 	!	Firebox Opening Height
	flushHeight	= D		!	Flush Heart Height
	brickThickness = J	!	Refractory Brick Thickness
	bBrick	= V			!	Refr. Brick on Opn. Side

	pictStartX	= y*1"+x*brickThickness*bBrick
	pictX		= A-2*pictStartX

	rotx 90
	add pictStartX, flushHeight, -(1"+brickThickness)

	!Main picture
	picture "fire_1", pictX, fBoxHeight, 0

	!Back (Wood) picture
	addz -0.01
	picture "fire_1_a", pictX, fBoxHeight, 1
	del 1

	del 2
endif



