
!!Column Faceted.gsm

if gs_detlevel_3D_m = DLEV3D_OFF then end
IF gs_detlevel_3D_m = DLEV3D_SIMPLE then gs_resol = 12

IF gs_shadow=0 THEN SHADOW OFF
IF gs_shadow=1 THEN SHADOW ON

!!---- Hotspot Editing
unID=1
hotspot 0,0,0,unID,zzyzx,1+256 : unID=unID+1
hotspot 0,0,-1,unID,zzyzx,3 : unID=unID+1
hotspot 0,0,zzyzx,unID,zzyzx,2 : unID=unID+1

for i=1 to 4
	hotspot 0,B2,0,unID,A2,1+128,A : unID=unID+1
	hotspot -1,B2,0,unID,A2,3,A : unID=unID+1
	hotspot A2,B2,0,unID,A2,2,A : unID=unID+1

	hotspot A2,0,0,unID,B2,1+128,B : unID=unID+1
	hotspot A2,-1,0,unID,B2,3,B : unID=unID+1
	hotspot A2,B2,0,unID,B2,2,B : unID=unID+1

	hotspot 0,0,zzyzx,unID,A2,1+128,A : unID=unID+1
	hotspot -1,0,zzyzx,unID,A2,3,A : unID=unID+1
	hotspot A2,0,zzyzx,unID,A2,2,A : unID=unID+1

	!!---- Base Height Editing
	if gs_base then
		hotspot A2,B2,0,unID,hb,1+128 : unID=unID+1
		hotspot A2,B2,-1,unID,hb,3 : unID=unID+1
		hotspot A2,B2,hb,unID,hb,2 : unID=unID+1
	endif

	!!---- Capital Height Editing
	if capital then
		hotspot A2*0.96,0,zzyzx,unID,hc,1+128 : unID=unID+1
		hotspot A2*0.96,0,zzyzx+1,unID,hc,3 : unID=unID+1
		hotspot A2*0.96,0,zzyzx-hc,unID,hc,2 : unID=unID+1
	endif
	rotz 90
next i
del 4

pen gs_cont_pen
T=A/2*.96
ROTY -90
IF capital=1 GOSUB 50
IF gs_base=1 GOSUB 60
GOSUB 70

DEL top
END

50:
ROTX 360/nf/2
MATERIAL gs_capital_mat
RESOL gs_resol
REVOLVE 4,360,3,
ZZYZX,T,0,
ZZYZX-hc/3,T,0,
ZZYZX-hc/3*2,T*.8,0,
ZZYZX-hc,T*.8,1
DEL 1
RETURN

60:ADDZ -A/2
ADDY -A/2
MATERIAL gs_base_mat
BLOCK hb,A,A
DEL 2
RETURN

70:IF capital=1 THEN 75
IF gs_base=1 THEN 80
GOTO 100
75: IF gs_base=1 THEN 85
ZZYZX=ZZYZX-hc
GOTO 100
80:ZZYZX=ZZYZX-hb
ADDX hb
GOTO 100
85:ZZYZX=ZZYZX-(hb+hc)
ADDX hb
GOTO 100

100:ROTX 360/nf/2
MATERIAL gs_column_mat
RESOL nf
REVOLVE 2,360,1,
0,T,1,
ZZYZX,T*.7,1
IF nf>24 THEN 200
FOR P= 1 TO 2*nf STEP 2
VERT 0,T,0
VERT ZZYZX,T*.7,0
EDGE P,P+1,-1,-1,0
ROTX 360/nf
NEXT P
200:RETURN
