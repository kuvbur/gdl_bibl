
IF iBeamType = BEAM_INCLINED | iBeamType = BEAM_INCLINED_2WAY THEN
	if iBeamType = BEAM_INCLINED then nSlope = 1
	if iBeamType = BEAM_INCLINED_2WAY then nSlope = 2

	PUT 2
	PUT -b/2+0.001, 0, 1,
		-b/2+0.001, MAX (zzyzx, zzyzx2), 1
	cuth= zzyzx2
	cutang= ATN ((zzyzx-zzyzx2)/a*nSlope)
	GOSUB 0
ENDIF

IF gs_detlevel_3D_m = DLEV3D_OFF THEN 999
if not(gs_shadow) then shadow off

RESOL gs_resol

unID = 1

!!! *** Length

HOTSPOT 0, 0, 0, unID, A, 1+256 : unID=unID+1
HOTSPOT -1, 0, 0, unID, A, 3 : unID=unID+1
HOTSPOT A, 0, 0, unID, A, 2 : unID=unID+1

pen gs_cont_pen
MATERIAL gs_rbeam_mat

ROTx angy

unID = 10
IF iBeamType = BEAM_STRAIGHT THEN

	!!! *** Width (Bottom)
	HOTSPOT A,0,0,unID,w12,1+128, rbeam_w1 : unID=unID+1
	HOTSPOT A,-w12,0,unID,w12,2, rbeam_w1 : unID=unID+1
	HOTSPOT A,1,0,unID,w12,3, rbeam_w1 : unID=unID+1

	HOTSPOT A,0,0,unID,w12,1+128, rbeam_w1 : unID=unID+1
	HOTSPOT A,w12,0,unID,w12,2, rbeam_w1 : unID=unID+1
	HOTSPOT A,-1,0,unID,w12,3, rbeam_w1 : unID=unID+1

	HOTSPOT 0,0,0,unID,w12,1+128, rbeam_w1 : unID=unID+1
	HOTSPOT 0,-w12,0,unID,w12,2, rbeam_w1 : unID=unID+1
	HOTSPOT 0,1,0,unID,w12,3, rbeam_w1 : unID=unID+1

	HOTSPOT 0,0,0,unID,w12,1+128, rbeam_w1 : unID=unID+1
	HOTSPOT 0,w12,0,unID,w12,2, rbeam_w1 : unID=unID+1
	HOTSPOT 0,-1,0,unID,w12,3, rbeam_w1 : unID=unID+1

	!!! *** Width (Top)
	HOTSPOT A,0,ZZYZX,unID,w22,1+128, rbeam_w2 : unID=unID+1
	HOTSPOT A,-w22,ZZYZX,unID,w22,2, rbeam_w2 : unID=unID+1
	HOTSPOT A,1,ZZYZX,unID,w22,3, rbeam_w2 : unID=unID+1

	HOTSPOT A,0,ZZYZX,unID,w22,1+128, rbeam_w2 : unID=unID+1
	HOTSPOT A,w22,ZZYZX,unID,w22,2, rbeam_w2 : unID=unID+1
	HOTSPOT A,-1,ZZYZX,unID,w22,3, rbeam_w2 : unID=unID+1

	HOTSPOT 0,0,ZZYZX,unID,w22,1+128, rbeam_w2 : unID=unID+1
	HOTSPOT 0,-w22,ZZYZX,unID,w22,2, rbeam_w2 : unID=unID+1
	HOTSPOT 0,1,ZZYZX,unID,w22,3, rbeam_w2 : unID=unID+1

	HOTSPOT 0,0,ZZYZX,unID,w22,1+128, rbeam_w2 : unID=unID+1
	HOTSPOT 0,w22,ZZYZX,unID,w22,2, rbeam_w2 : unID=unID+1
	HOTSPOT 0,-1,ZZYZX,unID,w22,3, rbeam_w2 : unID=unID+1

	!!! *** Height
	HOTSPOT 0,0,0,unID,ZZYZX,1+128 : unID=unID+1
	HOTSPOT 0,0,ZZYZX,unID,ZZYZX,2 : unID=unID+1
	HOTSPOT 0,0,-1,unID,ZZYZX,3 : unID=unID+1

	HOTSPOT A,0,0,unID,ZZYZX,1+128 : unID=unID+1
	HOTSPOT A,0,ZZYZX,unID,ZZYZX,2 : unID=unID+1
	HOTSPOT A,0,-1,unID,ZZYZX,3 : unID=unID+1

ENDIF
Unid=100
IF iBeamType = BEAM_INCLINED | iBeamType = BEAM_INCLINED_2WAY THEN

	!!! *** Width
	HOTSPOT A,0,0,unID,B2,1+128, B : unID=unID+1
	HOTSPOT A,-b2,0,unID,B2,2, B : unID=unID+1
	HOTSPOT A,1,0,unID,B2,3, B : unID=unID+1

	HOTSPOT A,0,0,unID,B2,1+128, B : unID=unID+1
	HOTSPOT A,b2,0,unID,B2,2, B : unID=unID+1
	HOTSPOT A,-1,0,unID,B2,3, B : unID=unID+1

	HOTSPOT 0,0,0,unID,B2,1+128, B : unID=unID+1
	HOTSPOT 0,-b2,0,unID,B2,2, B : unID=unID+1
	HOTSPOT 0,1,0,unID,B2,3, B : unID=unID+1

	HOTSPOT 0,0,0,unID,B2,1+128, B : unID=unID+1
	HOTSPOT 0,b2,0,unID,B2,2, B : unID=unID+1
	HOTSPOT 0,-1,0,unID,B2,3, B : unID=unID+1

	!!! *** End Height
	HOTSPOT 0,B/2,0,unID,ZZYZX2,1+128 : unID=unID+1
	HOTSPOT 0,B/2,ZZYZX2,unID,ZZYZX2,2 : unID=unID+1
	HOTSPOT 0,B/2,-1,unID,ZZYZX2,3 : unID=unID+1

	HOTSPOT 0,-B/2,0,unID,ZZYZX2,1+128 : unID=unID+1
	HOTSPOT 0,-B/2,ZZYZX2,unID,ZZYZX2,2 : unID=unID+1
	HOTSPOT 0,-B/2,-1,unID,ZZYZX2,3 : unID=unID+1

	IF iBeamType = BEAM_INCLINED_2WAY THEN

		HOTSPOT A,B/2,0,unID,ZZYZX2,1+128 : unID=unID+1
		HOTSPOT A,B/2,ZZYZX2,unID,ZZYZX2,2 : unID=unID+1
		HOTSPOT A,B/2,-1,unID,ZZYZX2,3 : unID=unID+1

		HOTSPOT A,-B/2,0,unID,ZZYZX2,1+128 : unID=unID+1
		HOTSPOT A,-B/2,ZZYZX2,unID,ZZYZX2,2 : unID=unID+1
		HOTSPOT A,-B/2,-1,unID,ZZYZX2,3 : unID=unID+1

		HOTSPOT A/2,B/2,0,unID,ZZYZX,1+128 : unID=unID+1
		HOTSPOT A/2,B/2,ZZYZX,unID,ZZYZX,2 : unID=unID+1
		HOTSPOT A/2,B/2,-1,unID,ZZYZX,3 : unID=unID+1

		HOTSPOT A/2,-B/2,0,unID,ZZYZX,1+128 : unID=unID+1
		HOTSPOT A/2,-B/2,ZZYZX,unID,ZZYZX,2 : unID=unID+1
		HOTSPOT A/2,-B/2,-1,unID,ZZYZX,3 : unID=unID+1

	ELSE

		HOTSPOT A,B/2,0,unID,ZZYZX,1+128 : unID=unID+1
		HOTSPOT A,B/2,ZZYZX,unID,ZZYZX,2 : unID=unID+1
		HOTSPOT A,B/2,-1,unID,ZZYZX,3 : unID=unID+1

		HOTSPOT A,-B/2,0,unID,ZZYZX,1+128 : unID=unID+1
		HOTSPOT A,-B/2,ZZYZX,unID,ZZYZX,2 : unID=unID+1
		HOTSPOT A,-B/2,-1,unID,ZZYZX,3 : unID=unID+1

	ENDIF

ENDIF


FOR w=1 TO nn*2
	PUT GET (2), MAX (-1, 15*GET (1))
NEXT w
PUT 0, 0, 777

ROTz 90
ROTx 90
if Shape=1 then
	if gs_shap_m = HOLE_RECTANGULAR then
		gosub "holeRectangular"
	endif

	if gs_shap_m = HOLE_CIRCULAR then
		gosub "holeCircular"
	endif
	del 1
endif

IF iBeamType = BEAM_INCLINED | iBeamType = BEAM_INCLINED_2WAY THEN
	GROUP "ra"
		ADDy cuth
		ROTx 270-cutang
			CUTPLANE
		DEL 2
		PRISM_ NSP/3, a/nSlope,
			GET (NSP)
		CUTEND
	ENDGROUP
	IF nSlope = 1 THEN
		PLACEGROUP "ra"
	ELSE
		GROUP "rb"
			ADDz a
			MULz -1
				PLACEGROUP "ra"
			DEL 2
		ENDGROUP
		rbeam2= ADDGROUP ("ra", "rb")
		PLACEGROUP rbeam2
		KILLGROUP "rb"
		KILLGROUP rbeam2
	ENDIF
	KILLGROUP "ra"
ELSE
	PRISM_ NSP/3, a,
		GET (NSP)
ENDIF

if Shape=1 then
	for i=1 to hnum
		if gs_shap_m = HOLE_RECTANGULAR then cutend
		if gs_shap_m = HOLE_CIRCULAR then cutend
	next i
endif
DEL 2

DEL 1



999:
FOR w=1 TO NSP
	qq= GET (1)
NEXT w




END

"holeRectangular":

	addz -((a+0.02)/(hnum))/2
	addy pos
	roty 90
	for i=1 to hnum
		HOTSPOT 0,	0,	0,					unID,	gs_hole_pos[i],	1+128	:unID=unID+1 !!base
		HOTSPOT 1,	0,	0,					unID,	gs_hole_pos[i],	3		:unID=unID+1 !!lgth ref
		HOTSPOT -gs_hole_pos[i],	0,	0,	unID,	gs_hole_pos[i],	2		:unID=unID+1 !!lgth mov
		addx -gs_hole_pos[i]-rectw/2
		cutpolya 4, 2, 0,
			0,0,15,
			rectw,0,15,
			rectw,recth,15,
			0,recth,15
		del 1
	next i
	del 2
return

"holeCircular":

	addz -((a+0.02)/(hnum))/2
	addy pos
	roty 90
	for i=1 to hnum
		HOTSPOT 0,	0,	0,								unID,	gs_hole_pos[i],	1+128	:unID=unID+1 !!base
		HOTSPOT 1,	0,	0,								unID,	gs_hole_pos[i],	3		:unID=unID+1 !!lgth ref
		HOTSPOT -gs_hole_pos[i],	0,	0,	unID,	gs_hole_pos[i],	2		:unID=unID+1 !!lgth mov
		addx -gs_hole_pos[i]
		addy cdia/2
		cutpolya 2, 2, 0,
			0,0,979,
			cdia/2,360,4079
		del 2
	next i
	del 2
return

