
!!! *** Column Hotspots *** !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

Unid=1
hLineID = 1000

HOTSPOT2 0,0,unID : unID=unID+1	!!! Center

Unid=10
IF iColumnSectionType = COLSECT_RECTANGULAR THEN

	HOTSPOT2 a/2,0,unID,B2,1+128, B : unID=unID+1
	HOTSPOT2 a/2,b2,unID,B2,2, B : unID=unID+1
	HOTSPOT2 a/2,-1,unID,B2,3, B : unID=unID+1

	HOTSPOT2 -a/2,0, unID,B2,1+128, B : unID=unID+1
	HOTSPOT2 -a/2,b2, unID,B2,2, B : unID=unID+1
	HOTSPOT2 -a/2,-1, unID,B2,3, B : unID=unID+1

	HOTSPOT2 0,b2, unID,A2,1+128, A : unID=unID+1
	HOTSPOT2 a2,b2, unID,A2,2, A : unID=unID+1
	HOTSPOT2 -1,b2, unID,A2,3, A : unID=unID+1

	HOTSPOT2 0,b2, unID,A2,1+128, A : unID=unID+1
	HOTSPOT2 -a2,b2, unID,A2,2, A : unID=unID+1
	HOTSPOT2 1,b2, unID,A2,3, A : unID=unID+1

	HOTSPOT2 a/2,0, unID,B2,1+128, B : unID=unID+1
	HOTSPOT2 a/2,-b2, unID,B2,2, B : unID=unID+1
	HOTSPOT2 a/2,1, unID,B2,3, B : unID=unID+1

	HOTSPOT2 -a/2,0, unID,B2,1+128, B : unID=unID+1
	HOTSPOT2 -a/2,-b2, unID,B2,2, B : unID=unID+1
	HOTSPOT2 -a/2,1, unID,B2,3, B : unID=unID+1

	HOTSPOT2 0,-b2, unID,A2,1+128, A : unID=unID+1
	HOTSPOT2 a2,-b2, unID,A2,2, A : unID=unID+1
	HOTSPOT2 -1,-b2, unID,A2,3, A : unID=unID+1

	HOTSPOT2 0,-b2, unID,A2,1+128, A : unID=unID+1
	HOTSPOT2 -a2,-b2, unID,A2,2, A : unID=unID+1
	HOTSPOT2 1,-b2, unID,A2,3, A : unID=unID+1

ENDIF

Unid=100
IF iColumnSectionType = COLSECT_CIRCULAR THEN

	FOR KK=1 TO 4
		HOTSPOT2 0,0,unID,A2,1+128, A : unID=unID+1
		HOTSPOT2 -1,0,unID,A2,3, A : unID=unID+1
		HOTSPOT2 a/2,0,unID,A2,2, A : unID=unID+1
	ROT2 90
	NEXT KK
	DEL 4

ENDIF


!!! *** Capital *** !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

IF iDet2D = DETLEVEL_2D_DETAILED THEN
	LINE_TYPE capital_line_type
	PEN capital_cont_pen

	if bColumnHead then
		IF iColumnHeadType = COLHEAD_CIRCULAR THEN
			CIRCLE2 0, 0, a/2+xOfHead_1
	
			HOTARC2 0,0,a/2+xOfHead_1,0,180, hLineID : hLineID = hLineID + 1
			HOTARC2 0,0,a/2+xOfHead_1,180,360, hLineID : hLineID = hLineID + 1
	
			FILL capital_fill_type
			IF iColumnSectionType = COLSECT_RECTANGULAR THEN
				POLY2_B 7, 2+64,capital_fill_pen,capital_back_pen,
						0,0,900,
						a/2+xOfHead_1,360,4001,
						-a/2, -b/2, 1,
						-a/2, b/2, 1,
						a/2, b/2, 1,
						a/2, -b/2, 1,
						-a/2, -b/2, -1
			ELSE
				POLY2_B 4, 2+64,capital_fill_pen,capital_back_pen,
						0,0,900,
						a/2+xOfHead_1,360,4001,
						0,0,900,
						a/2,360,4001
			ENDIF
	
		else
			hLineID = hLineID + 2
		endif
		IF iColumnHeadType = COLHEAD_RECTANGULAR THEN
			RECT2 -a/2-xOfHead_1, -b/2-xOfHead_1, a/2+xOfHead_1, b/2+xOfHead_1
	
			HOTLINE2 -A/2-xOfHead_1,-B/2-xOfHead_1,A/2+xOfHead_1,-B/2-xOfHead_1, hLineID : hLineID = hLineID + 1
			HOTLINE2 -A/2-xOfHead_1,B/2+xOfHead_1,A/2+xOfHead_1,B/2+xOfHead_1, hLineID : hLineID = hLineID + 1
	
			HOTLINE2 -A/2-xOfHead_1,-B/2-xOfHead_1,-A/2-xOfHead_1,B/2+xOfHead_1, hLineID : hLineID = hLineID + 1
			HOTLINE2 A/2+xOfHead_1,-B/2-xOfHead_1,A/2+xOfHead_1,B/2+xOfHead_1, hLineID : hLineID = hLineID + 1
	
			FILL capital_fill_type
			IF iColumnSectionType = COLSECT_RECTANGULAR THEN
				POLY2_B 10, 2+64, capital_fill_pen,capital_back_pen,
					-a/2-xOfHead_1, -b/2-xOfHead_1, 1,
					-a/2-xOfHead_1, b/2+xOfHead_1, 1,
					 a/2+xOfHead_1, b/2+xOfHead_1, 1,
					 a/2+xOfHead_1, -b/2-xOfHead_1, 1,
					-a/2-xOfHead_1, -b/2-xOfHead_1, -1,
					-a/2, -b/2, 1,
					-a/2, b/2, 1,
					a/2, b/2, 1,
					a/2, -b/2, 1,
					-a/2, -b/2, -1
				ELSE
				POLY2_B 7, 2+64, capital_fill_pen,capital_back_pen,
					-a/2-xOfHead_1, -b/2-xOfHead_1, 1,
					-a/2-xOfHead_1, b/2+xOfHead_1, 1,
					 a/2+xOfHead_1, b/2+xOfHead_1, 1,
					 a/2+xOfHead_1, -b/2-xOfHead_1, 1,
					-a/2-xOfHead_1, -b/2-xOfHead_1, -1,
					0, 0, 900,
					a/2,360,4001
			ENDIF
	
		else
			hLineID = hLineID + 4
		endif
	endif

	IF TypeOfHead_2=1 THEN
		IF iColumnSectionType = COLSECT_CIRCULAR THEN
			CIRCLE2 0, 0, a/2+xOfHead_2

			HOTARC2 0,0,a/2+xOfHead_2,0,180, hLineID : hLineID = hLineID + 1
			HOTARC2 0,0,a/2+xOfHead_2,180,360, hLineID : hLineID = hLineID + 1

			FILL capital_fill_type
			IF iColumnSectionType = COLSECT_RECTANGULAR THEN
				POLY2_B 7, 2+64,capital_fill_pen,capital_back_pen,
						0,0,900,
						a/2+xOfHead_2,360,4001,
						-a/2, -b/2, 1,
						-a/2, b/2, 1,
						a/2, b/2, 1,
						a/2, -b/2, 1,
						-a/2, -b/2, -1
			ELSE
				POLY2_B 4, 2+64,capital_fill_pen,capital_back_pen,
						0,0,900,
						a/2+xOfHead_2,360,4001,
						0,0,900,
						a/2,360,4001
			ENDIF
		else
			hLineID = hLineID + 2
		endif
		IF iColumnSectionType = COLSECT_RECTANGULAR THEN
			RECT2 -a/2-xOfHead_2, -b/2-xOfHead_2, a/2+xOfHead_2, b/2+xOfHead_2

			HOTLINE2 -A/2-xOfHead_2,-B/2-xOfHead_2,A/2+xOfHead_2,-B/2-xOfHead_2, hLineID : hLineID = hLineID + 1
			HOTLINE2 -A/2-xOfHead_2,B/2+xOfHead_2,A/2+xOfHead_2,B/2+xOfHead_2, hLineID : hLineID = hLineID + 1

			HOTLINE2 -A/2-xOfHead_2,-B/2-xOfHead_2,-A/2-xOfHead_2,B/2+xOfHead_2, hLineID : hLineID = hLineID + 1
			HOTLINE2 A/2+xOfHead_2,-B/2-xOfHead_2,A/2+xOfHead_2,B/2+xOfHead_2, hLineID : hLineID = hLineID + 1

			FILL capital_fill_type
			IF iColumnSectionType = COLSECT_RECTANGULAR THEN
				POLY2_B 10, 2+64, capital_fill_pen,capital_back_pen,
					-a/2-xOfHead_2, -b/2-xOfHead_2, 1,
					-a/2-xOfHead_2, b/2+xOfHead_2, 1,
					 a/2+xOfHead_2, b/2+xOfHead_2, 1,
					 a/2+xOfHead_2, -b/2-xOfHead_2, 1,
					-a/2-xOfHead_2, -b/2-xOfHead_2, -1,
					-a/2, -b/2, 1,
					-a/2, b/2, 1,
					a/2, b/2, 1,
					a/2, -b/2, 1,
					-a/2, -b/2, -1
			ELSE
				POLY2_B 7, 2+64, capital_fill_pen,capital_back_pen,
					-a/2-xOfHead_2, -b/2-xOfHead_2, 1,
					-a/2-xOfHead_2, b/2+xOfHead_2, 1,
					 a/2+xOfHead_2, b/2+xOfHead_2, 1,
					 a/2+xOfHead_2, -b/2-xOfHead_2, 1,
					-a/2-xOfHead_2, -b/2-xOfHead_2, -1,
					0, 0, 900,
					a/2,360,4001
			ENDIF
		else
			hLineID = hLineID + 4
		endif
	else
		hLineID = hLineID + 12
	endif

	Unid=200
	IF bColumnHead THEN
		IF iColumnHeadType = COLHEAD_RECTANGULAR THEN
				HOTSPOT2 a/2, 			 b/2, unID, TempxOfHead_1, 1+128, xOfHead_1 : unID=unID+1
				HOTSPOT2 a/2-1, 		 b/2, unID, TempxOfHead_1, 3, xOfHead_1 : unID=unID+1
				HOTSPOT2 a/2+xOfHead_1*TAN(45),  b/2+xOfHead_1*TAN(45), unID, TempxOfHead_1, 2, xOfHead_1 : unID=unID+1

				HOTSPOT2 -a/2, 			 b/2, unID, TempxOfHead_1, 1+128, xOfHead_1 : unID=unID+1
				HOTSPOT2 -a/2+1, 		 b/2, unID, TempxOfHead_1, 3, xOfHead_1 : unID=unID+1
				HOTSPOT2 -a/2-xOfHead_1*TAN(45),  b/2+xOfHead_1*TAN(45), unID, TempxOfHead_1, 2, xOfHead_1 : unID=unID+1

				HOTSPOT2 -a/2, 			 -b/2, unID, TempxOfHead_1, 1+128, xOfHead_1 : unID=unID+1
				HOTSPOT2 -a/2+1, 		 -b/2, unID, TempxOfHead_1, 3, xOfHead_1 : unID=unID+1
				HOTSPOT2 -a/2-xOfHead_1*TAN(45),  -b/2-xOfHead_1*TAN(45), unID, TempxOfHead_1, 2, xOfHead_1 : unID=unID+1

				HOTSPOT2 a/2, 			 -b/2, unID, TempxOfHead_1, 1+128, xOfHead_1 : unID=unID+1
				HOTSPOT2 a/2-1, 		 -b/2, unID, TempxOfHead_1, 3, xOfHead_1 : unID=unID+1
				HOTSPOT2 a/2+xOfHead_1*TAN(45),  -b/2-xOfHead_1*TAN(45), unID, TempxOfHead_1, 2, xOfHead_1 : unID=unID+1
		ELSE
				HOTSPOT2 -a/2, 			 0, unID, xOfHead_1, 1+128 : unID=unID+1
				HOTSPOT2 -a/2+1, 		 0, unID, xOfHead_1, 3 : unID=unID+1
				HOTSPOT2 -a/2-xOfHead_1, 0, unID, xOfHead_1, 2 : unID=unID+1

				HOTSPOT2 a/2, 			 0, unID, xOfHead_1, 1+128 : unID=unID+1
				HOTSPOT2 a/2-1, 		 0, unID, xOfHead_1, 3 : unID=unID+1
				HOTSPOT2 a/2+xOfHead_1,  0, unID, xOfHead_1, 2 : unID=unID+1

				HOTSPOT2 0, 	b/2, unID, xOfHead_1, 1+128 : unID=unID+1
				HOTSPOT2 0, 	b/2-1, unID, xOfHead_1, 3 : unID=unID+1
				HOTSPOT2 0, 	b/2+xOfHead_1, unID, xOfHead_1, 2 : unID=unID+1

				HOTSPOT2 0, 	-b/2, unID, xOfHead_1, 1+128 : unID=unID+1
				HOTSPOT2 0, 	-b/2+1, unID, xOfHead_1, 3 : unID=unID+1
				HOTSPOT2 0, 	-b/2-xOfHead_1, unID, xOfHead_1, 2 : unID=unID+1
		ENDIF
	ENDIF

	Unid=300
	IF TypeOfHead_2=1 THEN

		IF iColumnSectionType = COLSECT_RECTANGULAR THEN
				HOTSPOT2 a/2, 			 b/2, unID, TempxOfHead_2, 1+128, xOfHead_2 : unID=unID+1
				HOTSPOT2 a/2-1, 		 b/2, unID, TempxOfHead_2, 3, xOfHead_2 : unID=unID+1
				HOTSPOT2 a/2+xOfHead_2*TAN(45),  b/2+xOfHead_2*TAN(45), unID, TempxOfHead_2, 2, xOfHead_2 : unID=unID+1

				HOTSPOT2 -a/2, 			 b/2, unID, TempxOfHead_2, 1+128, xOfHead_2 : unID=unID+1
				HOTSPOT2 -a/2+1, 		 b/2, unID, TempxOfHead_2, 3, xOfHead_2 : unID=unID+1
				HOTSPOT2 -a/2-xOfHead_2*TAN(45),  b/2+xOfHead_2*TAN(45), unID, TempxOfHead_2, 2, xOfHead_2 : unID=unID+1

				HOTSPOT2 -a/2, 			 -b/2, unID, TempxOfHead_2, 1+128, xOfHead_2 : unID=unID+1
				HOTSPOT2 -a/2+1, 		 -b/2, unID, TempxOfHead_2, 3, xOfHead_2 : unID=unID+1
				HOTSPOT2 -a/2-xOfHead_2*TAN(45),  -b/2-xOfHead_2*TAN(45), unID, TempxOfHead_2, 2, xOfHead_2 : unID=unID+1

				HOTSPOT2 a/2, 			 -b/2, unID, TempxOfHead_2, 1+128, xOfHead_2 : unID=unID+1
				HOTSPOT2 a/2-1, 		 -b/2, unID, TempxOfHead_2, 3, xOfHead_2 : unID=unID+1
				HOTSPOT2 a/2+xOfHead_2*TAN(45),  -b/2-xOfHead_2*TAN(45), unID, TempxOfHead_2, 2, xOfHead_2 : unID=unID+1
		ELSE

				HOTSPOT2 -a/2, 			 0, unID, xOfHead_2, 1+128 : unID=unID+1
				HOTSPOT2 -a/2+1, 		 0, unID, xOfHead_2, 3 : unID=unID+1
				HOTSPOT2 -a/2-xOfHead_2, 0, unID, xOfHead_2, 2 : unID=unID+1

				HOTSPOT2 a/2, 			 0, unID, xOfHead_2, 1+128 : unID=unID+1
				HOTSPOT2 a/2-1, 		 0, unID, xOfHead_2, 3 : unID=unID+1
				HOTSPOT2 a/2+xOfHead_2,  0, unID, xOfHead_2, 2 : unID=unID+1

				HOTSPOT2 0, 	b/2, unID, xOfHead_2, 1+128 : unID=unID+1
				HOTSPOT2 0, 	b/2-1, unID, xOfHead_2, 3 : unID=unID+1
				HOTSPOT2 0, 	b/2+xOfHead_2, unID, xOfHead_2, 2 : unID=unID+1

				HOTSPOT2 0, 	-b/2, unID, xOfHead_2, 1+128 : unID=unID+1
				HOTSPOT2 0, 	-b/2+1, unID, xOfHead_2, 3 : unID=unID+1
				HOTSPOT2 0, 	-b/2-xOfHead_2, unID, xOfHead_2, 2 : unID=unID+1

		ENDIF

	ENDIF
else
	hLineID = hLineID + 12
ENDIF

!!! *** Column *** !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

PEN gs_cont_pen
FILL gs_fill_type
LINE_TYPE gs_line_type

IF iColumnSectionType = COLSECT_CIRCULAR THEN
	POLY2_B 7, 1+2+4+32, gs_fill_pen, gs_back_pen,
		a/2,            0,      1+32,
		0, 0,    900+32,
		0,          180,   4001+32,
		-a/2, 0,      1+32,
		0, 0,    900,
		0,          180,   4001+32,
		a/2,            0,      1+32

	HOTARC2 0,0,a/2,0,180, hLineID : hLineID = hLineID + 1
	HOTARC2 0,0,a/2,180,360, hLineID : hLineID = hLineID + 1

else
	hLineID = hLineID + 2
endif


IF iColumnSectionType = COLSECT_RECTANGULAR THEN

	POLY2_B 5, 1+2+4+32, gs_fill_pen, gs_back_pen,
		-a/2, -b/2, 1+32,
		-a/2, b/2, 1+32,
		 a/2, b/2, 1+32,
		 a/2, -b/2, 1+32,
		-a/2, -b/2, -1

	HOTLINE2 -A/2,-B/2,A/2,-B/2, hLineID : hLineID = hLineID + 1
	HOTLINE2 -A/2,B/2,A/2,B/2, hLineID : hLineID = hLineID + 1

	HOTLINE2 -A/2,-B/2,-A/2,B/2, hLineID : hLineID = hLineID + 1
	HOTLINE2 A/2,-B/2,A/2,B/2, hLineID : hLineID = hLineID + 1
else
	hLineID = hLineID + 4
endif
