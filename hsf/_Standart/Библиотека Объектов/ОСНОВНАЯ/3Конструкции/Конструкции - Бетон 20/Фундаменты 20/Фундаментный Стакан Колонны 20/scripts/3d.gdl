
IF gs_detlevel_3D_m = DLEV3D_OFF THEN END

RESOL gs_resol
MATERIAL gs_foundation_mat
PEN gs_cont_pen

IF gs_shadow=0 THEN
	SHADOW OFF
ELSE
	SHADOW ON
ENDIF

!!! *** 3D HOTSPOTs
	Unid=1

	HOTSPOT 0,0,depthOfColumn, unID : unID=unID+1	!!! Center


	!!! *** X Dimension, Y Dimension
	Unid=10
	ADDz depthOfColumn
		IF iColumnSectionType = COLSECT_RECTANGULAR THEN

			HOTSPOT holeWidthX/2,0,0,unID,holeHalfWidthY,1+128, holeWidthY : unID=unID+1
			HOTSPOT holeWidthX/2,holeHalfWidthY,0,unID,holeHalfWidthY,2, holeWidthY : unID=unID+1
			HOTSPOT holeWidthX/2,-1,0,unID,holeHalfWidthY,3, holeWidthY : unID=unID+1

			HOTSPOT -holeWidthX/2,0,0, unID,holeHalfWidthY,1+128, holeWidthY : unID=unID+1
			HOTSPOT -holeWidthX/2,holeHalfWidthY,0, unID,holeHalfWidthY,2, holeWidthY : unID=unID+1
			HOTSPOT -holeWidthX/2,-1,0, unID,holeHalfWidthY,3, holeWidthY : unID=unID+1

			HOTSPOT 0,holeHalfWidthY,0, unID,holeHalfWidthX,1+128, holeWidthX : unID=unID+1
			HOTSPOT holeHalfWidthX,holeHalfWidthY,0, unID,holeHalfWidthX,2, holeWidthX : unID=unID+1
			HOTSPOT -1,holeHalfWidthY,0, unID,holeHalfWidthX,3, holeWidthX : unID=unID+1

			HOTSPOT 0,holeHalfWidthY,0, unID,holeHalfWidthX,1+128, holeWidthX : unID=unID+1
			HOTSPOT -holeHalfWidthX,holeHalfWidthY,0, unID,holeHalfWidthX,2, holeWidthX : unID=unID+1
			HOTSPOT 1,holeHalfWidthY,0, unID,holeHalfWidthX,3, holeWidthX : unID=unID+1

			HOTSPOT holeWidthX/2,0,0, unID,holeHalfWidthY,1+128, holeWidthY : unID=unID+1
			HOTSPOT holeWidthX/2,-holeHalfWidthY,0, unID,holeHalfWidthY,2, holeWidthY : unID=unID+1
			HOTSPOT holeWidthX/2,1,0, unID,holeHalfWidthY,3, holeWidthY : unID=unID+1

			HOTSPOT -holeWidthX/2,0,0, unID,holeHalfWidthY,1+128, holeWidthY : unID=unID+1
			HOTSPOT -holeWidthX/2,-holeHalfWidthY,0, unID,holeHalfWidthY,2, holeWidthY : unID=unID+1
			HOTSPOT -holeWidthX/2,1,0, unID,holeHalfWidthY,3, holeWidthY : unID=unID+1

			HOTSPOT 0,-holeHalfWidthY,0, unID,holeHalfWidthX,1+128, holeWidthX : unID=unID+1
			HOTSPOT holeHalfWidthX,-holeHalfWidthY,0, unID,holeHalfWidthX,2, holeWidthX : unID=unID+1
			HOTSPOT -1,-holeHalfWidthY,0, unID,holeHalfWidthX,3, holeWidthX : unID=unID+1

			HOTSPOT 0,-holeHalfWidthY,0, unID,holeHalfWidthX,1+128, holeWidthX : unID=unID+1
			HOTSPOT -holeHalfWidthX,-holeHalfWidthY,0, unID,holeHalfWidthX,2, holeWidthX : unID=unID+1
			HOTSPOT 1,-holeHalfWidthY,0, unID,holeHalfWidthX,3, holeWidthX : unID=unID+1

		ENDIF

		IF iColumnSectionType = COLSECT_CIRCULAR THEN

			FOR KK=1 TO 4
				HOTSPOT 0,0,0,unID,holeHalfWidthX,1+128, holeWidthX : unID=unID+1
				HOTSPOT -1,0,0,unID,holeHalfWidthX,3, holeWidthX : unID=unID+1
				HOTSPOT holeWidthX/2,0,0,unID,holeHalfWidthX,2, holeWidthX : unID=unID+1
			ROTZ 90
			NEXT KK
			DEL 4

		ENDIF
	DEL 1
	!!! *** Width of Wall *** !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

	Unid=100

	HOTSPOT holeWidthX/2, 			 holeWidthY/2, depthOfColumn, unID, widthOfWall2, 1+128, widthOfWall : unID=unID+1
	HOTSPOT holeWidthX/2-1, 		 holeWidthY/2, depthOfColumn, unID, widthOfWall2, 3, widthOfWall : unID=unID+1
	HOTSPOT holeWidthX/2+widthOfWall*TAN(45),  holeWidthY/2+widthOfWall*TAN(45), depthOfColumn, unID, widthOfWall2, 2, widthOfWall : unID=unID+1

	HOTSPOT -holeWidthX/2, 			 holeWidthY/2, depthOfColumn, unID, widthOfWall2, 1+128, widthOfWall : unID=unID+1
	HOTSPOT -holeWidthX/2+1, 		 holeWidthY/2, depthOfColumn, unID, widthOfWall2, 3, widthOfWall : unID=unID+1
	HOTSPOT -holeWidthX/2-widthOfWall*TAN(45),  holeWidthY/2+widthOfWall*TAN(45), depthOfColumn, unID, widthOfWall2, 2, widthOfWall : unID=unID+1

	HOTSPOT -holeWidthX/2, 			 -holeWidthY/2, depthOfColumn, unID, widthOfWall2, 1+128, widthOfWall : unID=unID+1
	HOTSPOT -holeWidthX/2+1, 		 -holeWidthY/2, depthOfColumn, unID, widthOfWall2, 3, widthOfWall : unID=unID+1
	HOTSPOT -holeWidthX/2-widthOfWall*TAN(45),  -holeWidthY/2-widthOfWall*TAN(45), depthOfColumn, unID, widthOfWall2, 2, widthOfWall : unID=unID+1

	HOTSPOT holeWidthX/2, 			 -holeWidthY/2, depthOfColumn, unID, widthOfWall2, 1+128, widthOfWall : unID=unID+1
	HOTSPOT holeWidthX/2-1, 		 -holeWidthY/2, depthOfColumn, unID, widthOfWall2, 3, widthOfWall : unID=unID+1
	HOTSPOT holeWidthX/2+widthOfWall*TAN(45),  -holeWidthY/2-widthOfWall*TAN(45), depthOfColumn, unID, widthOfWall2, 2, widthOfWall : unID=unID+1

	!!! *** Z Dimension *** !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

	Unid=300

	HOTSPOT -A/2, -B/2, depthOfColumn,         unID, zzyzx, 1+128 : unID=unID+1
	HOTSPOT -A/2, -B/2, depthOfColumn+1,       unID, zzyzx, 3 : unID=unID+1
	HOTSPOT -A/2, -B/2, depthOfColumn-zzyzx,   unID, zzyzx, 2 : unID=unID+1

	HOTSPOT -A/2, B/2, depthOfColumn,         unID, zzyzx, 1+128 : unID=unID+1
	HOTSPOT -A/2, B/2, depthOfColumn+1,       unID, zzyzx, 3 : unID=unID+1
	HOTSPOT -A/2, B/2, depthOfColumn-zzyzx,   unID, zzyzx, 2 : unID=unID+1

	HOTSPOT A/2, -B/2, depthOfColumn,         unID, zzyzx, 1+128 : unID=unID+1
	HOTSPOT A/2, -B/2, depthOfColumn+1,       unID, zzyzx, 3 : unID=unID+1
	HOTSPOT A/2, -B/2, depthOfColumn-zzyzx,   unID, zzyzx, 2 : unID=unID+1

	HOTSPOT A/2, B/2, depthOfColumn,         unID, zzyzx, 1+128 : unID=unID+1
	HOTSPOT A/2, B/2, depthOfColumn+1,       unID, zzyzx, 3 : unID=unID+1
	HOTSPOT A/2, B/2, depthOfColumn-zzyzx,   unID, zzyzx, 2 : unID=unID+1

	!!! *** Thickness of Plate

	Unid=400
	ADDZ -(ZZYZX-depthOfColumn)

		HOTSPOT A/2,B/2,0,unID, thickOfPlate,1+256 : unID=unID+1
		HOTSPOT A/2,B/2,-1,unID, thickOfPlate,3 : unID=unID+1
		HOTSPOT A/2,B/2,thickOfPlate,unID, thickOfPlate,2 : unID=unID+1

		HOTSPOT -A/2,B/2,0,unID, thickOfPlate,1+256 : unID=unID+1
		HOTSPOT -A/2,B/2,-1,unID, thickOfPlate,3 : unID=unID+1
		HOTSPOT -A/2,B/2,thickOfPlate,unID, thickOfPlate,2 : unID=unID+1

		HOTSPOT -A/2,-B/2,0,unID, thickOfPlate,1+256 : unID=unID+1
		HOTSPOT -A/2,-B/2,-1,unID, thickOfPlate,3 : unID=unID+1
		HOTSPOT -A/2,-B/2,thickOfPlate,unID, thickOfPlate,2 : unID=unID+1

		HOTSPOT A/2,-B/2,0,unID, thickOfPlate,1+256 : unID=unID+1
		HOTSPOT A/2,-B/2,-1,unID, thickOfPlate,3 : unID=unID+1
		HOTSPOT A/2,-B/2,thickOfPlate,unID, thickOfPlate,2 : unID=unID+1

	DEL 1

	!!! *** Ascent of Plate *** !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

	Unid=500
	ADDZ -(ZZYZX-depthOfColumn)+thickOfPlate

		HOTSPOT holeWidthX/2+widthOfWall,holeWidthY/2+widthOfWall,0,unID, asofplate,1+128 : unID=unID+1
		HOTSPOT holeWidthX/2+widthOfWall,holeWidthY/2+widthOfWall,-1,unID, asofplate,3 : unID=unID+1
		HOTSPOT holeWidthX/2+widthOfWall,holeWidthY/2+widthOfWall,asofplate,unID, asofplate,2 : unID=unID+1

		HOTSPOT holeWidthX/2+widthOfWall,-holeWidthY/2-widthOfWall,0,unID, asofplate,1+128 : unID=unID+1
		HOTSPOT holeWidthX/2+widthOfWall,-holeWidthY/2-widthOfWall,-1,unID, asofplate,3 : unID=unID+1
		HOTSPOT holeWidthX/2+widthOfWall,-holeWidthY/2-widthOfWall,asofplate,unID, asofplate,2 : unID=unID+1

		HOTSPOT -holeWidthX/2-widthOfWall,-holeWidthY/2-widthOfWall,0,unID, asofplate,1+128 : unID=unID+1
		HOTSPOT -holeWidthX/2-widthOfWall,-holeWidthY/2-widthOfWall,-1,unID, asofplate,3 : unID=unID+1
		HOTSPOT -holeWidthX/2-widthOfWall,-holeWidthY/2-widthOfWall,asofplate,unID, asofplate,2 : unID=unID+1

		HOTSPOT -holeWidthX/2-widthOfWall,holeWidthY/2+widthOfWall,0,unID, asofplate,1+128 : unID=unID+1
		HOTSPOT -holeWidthX/2-widthOfWall,holeWidthY/2+widthOfWall,-1,unID, asofplate,3 : unID=unID+1
		HOTSPOT -holeWidthX/2-widthOfWall,holeWidthY/2+widthOfWall,asofplate,unID, asofplate,2 : unID=unID+1

	DEL 1

GROUP "depth"
	IF iColumnSectionType = COLSECT_RECTANGULAR THEN
		PRISM_ 5, depthOfColumn,
				-holeWidthX/2, -holeWidthY/2, 15,
				-holeWidthX/2,  holeWidthY/2, 15,
				 holeWidthX/2,  holeWidthY/2, 15,
				 holeWidthX/2, -holeWidthY/2, 15,
				-holeWidthX/2, -holeWidthY/2, -1
		ELSE
		PRISM_ 2, depthOfColumn,
				0, 0, 979,
				holeWidthX/2,  360, 4079
	ENDIF
ENDGROUP

GROUP "wall"
	ADDz depthOfColumn-zzyzx+thickOfPlate
		PRISM_ 5, zzyzx-thickOfPlate,
				-holeWidthX/2-widthOfWall, -holeWidthY/2-widthOfWall, 15,
				-holeWidthX/2-widthOfWall, holeWidthY/2+widthOfWall, 15,
				holeWidthX/2+widthOfWall, holeWidthY/2+widthOfWall, 15,
				holeWidthX/2+widthOfWall, -holeWidthY/2-widthOfWall, 15,
				-holeWidthX/2-widthOfWall, -holeWidthY/2-widthOfWall, -1
	DEL 1
ENDGROUP
result_01=SUBGROUP ("wall", "depth")
PLACEGROUP result_01

KILLGROUP result_01
KILLGROUP "wall"
KILLGROUP "depth"

ADDz -zzyzx+depthOfColumn
	PRISM_ 5, thickOfPlate,
		-A/2, -B/2, 15,
		-A/2,  B/2, 15,
		 A/2,  B/2, 15,
		 A/2, -B/2, 15,
		-A/2, -B/2, -1
DEL 1


IF asofplate>0 THEN



	IF ABS(widthOfWall-(A/2-holeWidthX/2))>0.001 THEN
		felt1=1
	ELSE
		felt1=0
	ENDIF
	IF ABS(widthOfWall-(A/2-holeWidthY/2))>0.001 THEN
		felt2=1
	ELSE
		felt2=0
	ENDIF

	IF felt1=1 THEN
		FOR I=-1 To 1 STEP 2
		MULx I

		  IF felt2=1 THEN
			ADDy B/2
			ADDx A/2
			ROTz -ATN((A/2-holeWidthX/2-widthOfWall)/(B/2-holeWidthY/2-widthOfWall))
			ROTy -90
			  CUTPLANE
			DEL 4
			ADDy -B/2
			ADDx A/2
			ROTz ATN((A/2-holeWidthX/2-widthOfWall)/(B/2-holeWidthY/2-widthOfWall))
			ROTy -90
			  CUTPLANE
			DEL 4
		  ENDIF
				ADDz -zzyzx+depthOfColumn+thickOfPlate
				ADDy B/2
				ADDx holeWidthX/2+widthOfWall
				ROTx 90
					PRISM_ 4, B,
						   0, 0, 15,
						   0, asofplate, 15,
						   (A-holeWidthX-2*widthOfWall)/2, 0, 15,
						   0, 0, -1
				DEL 4
		  IF felt2=1 THEN
			CUTEND
			CUTEND
		  ENDIF

		DEL 1
		NEXT I
	ENDIF

	IF felt2=1 THEN
		ROTz 90
		FOR I=-1 To 1 STEP 2
		MULx I

		  IF felt1=1 THEN
			ADDy A/2
			ADDx B/2
			ROTz -ATN((B/2-holeWidthY/2-widthOfWall)/(A/2-holeWidthX/2-widthOfWall))
			ROTy -90
			  CUTPLANE
			DEL 4
			ADDy -A/2
			ADDx B/2
			ROTz ATN((B/2-holeWidthY/2-widthOfWall)/(A/2-holeWidthX/2-widthOfWall))
			ROTy -90
			  CUTPLANE
			DEL 4
		  ENDIF
				ADDz -zzyzx+depthOfColumn+thickOfPlate
				ADDy A/2
				ADDx holeWidthY/2+widthOfWall
				ROTx 90
					PRISM_ 4, A,
						   0, 0, 15,
						   0, asofplate, 15,
						   (B-holeWidthY-2*widthOfWall)/2, 0, 15,
						   0, 0, -1
				DEL 4

		  IF felt1=1 THEN
			CUTEND
			CUTEND
		  ENDIF
		DEL 1
		NEXT I
		DEL 1
	ENDIF

ENDIF



