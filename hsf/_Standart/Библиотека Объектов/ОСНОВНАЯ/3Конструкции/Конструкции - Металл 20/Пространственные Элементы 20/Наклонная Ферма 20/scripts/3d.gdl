
if gs_detlevel_3D_m = 0 then end
if gs_detlevel_3D_m = 1 then
	rh=6
	rd=3
endif

IF not(gs_shadow) THEN SHADOW OFF

! --- Hotspot Editing

unID = 1

hotspot 0,0,0,unID,ang,6: unID=unID+1
hotspot 1,0,0,unID,ang,4+128 : unID=unID+1
hotspot 0,-1,0,unID,ang,7 : unID=unID+1
hotspot a2/2*cos(ang),0,a2/2*sin(ang),unID,ang,5 : unID=unID+1

diff = h*tan(ang)

roty -ang
hotspot diff,0,0,unID,h,1+128 : unID=unID+1
hotspot diff,0,-1,unID,h,3 : unID=unID+1
hotspot diff,0,h,unID,h,2 : unID=unID+1

hotspot a2+diff,0,0,unID,h,1+128 : unID=unID+1
hotspot a2+diff,0,-1,unID,h,3 : unID=unID+1
hotspot a2+diff,0,h,unID,h,2 : unID=unID+1

hotspot 0,0,0,unID,a2,1+256,a : unID=unID+1
hotspot -1,0,0,unID,a2,3,a : unID=unID+1
hotspot a2,0,0,unID,a2,2,a : unID=unID+1

hotspot diff,0,h,unID,a2,1+256,a : unID=unID+1
hotspot diff-1,0,h,unID,a2,3,a : unID=unID+1
hotspot diff+a2,0,h,unID,a2,2,a : unID=unID+1
del 1

!!---- Hotspot Editing

pen gs_cont_pen
material chordmat

DH=b/2
b=H
aa=H*tan(30)
x=int((a2-(Dd/2))/aa)
Abe=(a2-x*aa)/2

rotz 90
cutplane -90
addy -a!!!!*cos(ang)
cutplane 90
del 2

group "struts"
	rotz 90
	rotx 90-ang
	addz -b*tan(ABS(ang))

	resol Rh
	for i=1 to 2
		cylind A2+2*b*tan(ABS(ang)),Dh
		add 0, H, diff
	next i
	del 5
endgroup

xx=int(x/2)
Ld=b/cos(30)

group "chords"
	material strutmat
	rotz    90
	rotx     90-ang
	addz    Abe
	rotz    90

del top
	roty    90-ang
	rotz    180


		addz Dd/2

	Resol   Rd
	for k=1 to xx
		roty    60
		cylind Ld,Dd

		del 1
		addz 2*aa

	next k
del k-1


		addz Dd/2

	for kk=1 to xx
		addz 2*aa
		roty    120
		cylind Ld,Dd
		del 1
	next kk

	if ang>eps3 then
		roty    60
		cylind Ld,Dd
		del 1
	endif
endgroup

If gs_detlevel_3D_m = 2 Then
	result=subgroup("chords","struts")
	placegroup "struts"
	placegroup result
Else
	placegroup "struts"
	placegroup "chords"
EndIf

cutend
cutend
end
