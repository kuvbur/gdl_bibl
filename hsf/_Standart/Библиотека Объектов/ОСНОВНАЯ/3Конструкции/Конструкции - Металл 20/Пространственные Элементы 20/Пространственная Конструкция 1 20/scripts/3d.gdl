
IF gs_detlevel_3D_m = 0 THEN END
IF gs_detlevel_3D_m = 1 THEN gs_resol=3

IF not(gs_shadow) THEN SHADOW OFF

! --- Hotspot Editing

unID = 1

for j=1 to ncy
	for i=1 to ncx
		hotspot A/(2*ncx),B/(2*ncy),0,unID,zzyzx,1+256 : unID=unID+1
		hotspot A/(2*ncx),B/(2*ncy),-1,unID,zzyzx,3 : unID=unID+1
		hotspot A/(2*ncx),B/(2*ncy),zzyzx,unID,zzyzx,2 : unID=unID+1
		addx A/ncx
	next i
	del ncx
	addy B/ncy
next j
del ncy

hotspot 0,0,zzyzx,unID,A,1+256 : unID=unID+1
hotspot -1,0,zzyzx,unID,A,3 : unID=unID+1
hotspot A,0,zzyzx,unID,A,2 : unID=unID+1

hotspot 0,B,zzyzx,unID,A,1+256 : unID=unID+1
hotspot -1,B,zzyzx,unID,A,3 : unID=unID+1
hotspot A,B,zzyzx,unID,A,2 : unID=unID+1

hotspot 0,0,zzyzx,unID,B,1+256 : unID=unID+1
hotspot 0,-1,zzyzx,unID,B,3 : unID=unID+1
hotspot 0,B,zzyzx,unID,B,2 : unID=unID+1

hotspot A,0,zzyzx,unID,B,1+256 : unID=unID+1
hotspot A,-1,zzyzx,unID,B,3 : unID=unID+1
hotspot A,B,zzyzx,unID,B,2 : unID=unID+1

!!---- Hotspot Editing

pen gs_cont_pen

IF GLOB_CONTEXT=2 THEN GOTO 11

11:

IF GLOB_CONTEXT=2 AND gs_detlevel_2D_m = 1 THEN rs=0

C=ZZYZX
ADDZ ZZYZX
material mat1
resol gs_resol
P= A/ncx
Q= B/ncy
if sph=0 then 1:
if sph=1 then 2:
EXIT

1:
FOR J=0 TO ncy STEP 1
!SPHERE rs
FOR I=1 TO ncx STEP 1
ADDX P
!SPHERE rs
ROTY -90
CYLIND P, brad
DEL 1
NEXT I
DEL ncx
ADDY  Q
NEXT J
DEL ncy+1
FOR J=1 TO ncy STEP 1
FOR I=0 TO ncx STEP 1
ROTX -90
CYLIND Q, brad
DEL 1
ADDX P
NEXT I
DEL ncx+1
ADDY Q
NEXT J
DEL ncy

ADD P/2, Q/2, -C

FOR J=0 TO ncy-1 STEP 1
FOR I=1 TO ncx-1 STEP 1
ADDX P
ROTY -90
CYLIND P, brad
DEL 1
NEXT I
DEL ncx-1
ADDY  Q
NEXT J
DEL ncy

FOR J=1 TO ncy-1 STEP 1
FOR I=0 TO ncx-1 STEP 1
ROTX -90
CYLIND Q, brad
DEL 1
ADDX P
NEXT I
DEL ncx
ADDY Q
NEXT J
DEL ncy-1
T=sqr((0.5*p)**2+c**2)
U=sqr((0.5*q)**2+c**2)
for I=1 to ncy Step 1
for J=1 to ncx Step 1
roty -atn((p/2)/c)
rotx atn((q/2)/t)
cylind sqr((p/2)**2+(q/2)**2+c**2), brad
del 1
rotx -atn((q/2)/t)
cylind sqr((p/2)**2+(q/2)**2+c**2), brad
del 2
roty atn((p/2)/c)
rotx atn((q/2)/t)
cylind sqr((p/2)**2+(q/2)**2+c**2), brad
del 1
rotx -atn((q/2)/t)
cylind sqr((p/2)**2+(q/2)**2+c**2), brad
del 2
addx P
next J
del ncx
addy Q
next I
Del I
del top
exit

2:
FOR J=0 TO ncy STEP 1
RESOL 2*gs_resol
SPHERE rs
FOR I=1 TO ncx STEP 1
ADDX P
SPHERE rs
ROTY -90
RESOL gs_resol
CYLIND P, brad
DEL 1
NEXT I
DEL ncx
ADDY  Q
NEXT J
DEL ncy+1
FOR J=1 TO ncy STEP 1
FOR I=0 TO ncx STEP 1
ROTX -90
CYLIND Q, brad
DEL 1
ADDX P
NEXT I
DEL ncx+1
ADDY Q
NEXT J
DEL ncy

ADD P/2, Q/2, -C

FOR J=0 TO ncy-1 STEP 1
RESOL 2*gs_resol
SPHERE rs
FOR I=1 TO ncx-1 STEP 1
ADDX P
SPHERE rs
ROTY -90
RESOL gs_resol
CYLIND P, brad
DEL 1
NEXT I
DEL ncx-1
ADDY  Q
NEXT J
DEL ncy

FOR J=1 TO ncy-1 STEP 1
FOR I=0 TO ncx-1 STEP 1
ROTX -90
CYLIND Q, brad
DEL 1
ADDX P
NEXT I
DEL ncx
ADDY Q
NEXT J
DEL ncy-1
T=sqr((0.5*p)**2+c**2)
U=sqr((0.5*q)**2+c**2)
for I=1 to ncy Step 1
for J=1 to ncx Step 1
roty -atn((p/2)/c)
rotx atn((q/2)/t)
cylind sqr((p/2)**2+(q/2)**2+c**2), brad
del 1
rotx -atn((q/2)/t)
cylind sqr((p/2)**2+(q/2)**2+c**2), brad
del 2
roty atn((p/2)/c)
rotx atn((q/2)/t)
cylind sqr((p/2)**2+(q/2)**2+c**2), brad
del 1
rotx -atn((q/2)/t)
cylind sqr((p/2)**2+(q/2)**2+c**2), brad
del 2
addx P
next J
del ncx
addy Q
next I
Del I
del top
EXIT
