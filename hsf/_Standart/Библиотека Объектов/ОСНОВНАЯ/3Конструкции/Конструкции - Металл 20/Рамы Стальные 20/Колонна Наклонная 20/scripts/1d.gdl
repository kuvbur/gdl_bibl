
EPS=0.0001

VALUES "numofbeam" RANGE [1, 9]

rh = 0
parameters rh = rh
ap=b

IF GLOB_MODPAR_NAME = "ang" THEN
	rh = (A)*TAN(ang) : rot_p = ang
	PARAMETERS rh = rh
ELSE
	rot_p=ATN((rh)/(a)) : ang = rot_p
	PARAMETERS ang = ang
ENDIF

btotal = zzyzx / COS(rot_p)

if GLOB_MODPAR_NAME = "numofbeam" then

	if numofbeam>=1 then : b1p=btotal/numofbeam		: endif
	if numofbeam>=2 then : b2p=btotal/numofbeam+b1p : else : b2p=0 : endif
	if numofbeam>=3 then : b3p=btotal/numofbeam+b2p : else : b3p=0 : endif
	if numofbeam>=4 then : b4p=btotal/numofbeam+b3p : else : b4p=0 : endif
	if numofbeam>=5 then : b5p=btotal/numofbeam+b4p : else : b5p=0 : endif
	if numofbeam>=6 then : b6p=btotal/numofbeam+b5p : else : b6p=0 : endif
	if numofbeam>=7 then : b7p=btotal/numofbeam+b6p : else : b7p=0 : endif
	if numofbeam>=8 then : b8p=btotal/numofbeam+b7p : else : b8p=0 : endif

else
	if numofbeam = 1 then b1p = btotal
	if numofbeam = 2 then b2p = btotal
	if numofbeam = 3 then b3p = btotal
	if numofbeam = 4 then b4p = btotal
	if numofbeam = 5 then b5p = btotal
	if numofbeam = 6 then b6p = btotal
	if numofbeam = 7 then b7p = btotal
	if numofbeam = 8 then b8p = btotal
	if numofbeam = 9 then b9p = btotal
endif

parameters 	b1p = b1p,
			b2p = b2p,
			b3p = b3p,
			b4p = b4p,
			b5p = b5p,
			b6p = b6p,
			b7p = b7p,
			b8p = b8p

DIM BEAMLENGTH_0[9]
	BEAMLENGTH_0[1]=b1p
	BEAMLENGTH_0[2]=b2p
	BEAMLENGTH_0[3]=b3p
	BEAMLENGTH_0[4]=b4p
	BEAMLENGTH_0[5]=b5p
	BEAMLENGTH_0[6]=b6p
	BEAMLENGTH_0[7]=b7p
	BEAMLENGTH_0[8]=b8p
	BEAMLENGTH_0[9]=btotal

DIM BEAMLENGTH[9]
	BEAMLENGTH[1]=b1p
	BEAMLENGTH[2]=b2p-b1p
	BEAMLENGTH[3]=b3p-b2p
	BEAMLENGTH[4]=b4p-b3p
	BEAMLENGTH[5]=b5p-b4p
	BEAMLENGTH[6]=b6p-b5p
	BEAMLENGTH[7]=b7p-b6p
	BEAMLENGTH[8]=b8p-b7p
	IF numofbeam>1 THEN
		BEAMLENGTH[9]=btotal-BEAMLENGTH_0[numofbeam-1]
	ELSE
		BEAMLENGTH[9]=btotal
	ENDIF


DIM SECTHEIGHT[8]
	SECTHEIGHT[1]=h1
	SECTHEIGHT[2]=h2
	SECTHEIGHT[3]=h3
	SECTHEIGHT[4]=h4
	SECTHEIGHT[5]=h5
	SECTHEIGHT[6]=h6
	SECTHEIGHT[7]=h7
	SECTHEIGHT[8]=h8

DIM BETA[] 		    !!!! gerendak also lemezeinek hajlasszogei

	BETA[1]=-ATN((hs*COS(rot_p)-h1)/(BEAMLENGTH[1]+hs*SIN(rot_p)))
	BETA[2]=ATN((hs*COS(rot_p)-h1)/(BEAMLENGTH[1]+hs*SIN(rot_p)))

FOR I=3 TO numofbeam
	IF ABS(BEAMLENGTH[I-1]-0)>0.0001 THEN BETA[I]=ATN((SECTHEIGHT[I-2]-SECTHEIGHT[I-1])/(BEAMLENGTH[I-1]))
NEXT I

IF numofbeam>1 & (abs((BEAMLENGTH[9]-he*SIN(rot_p))) > EPS) THEN	BETA[numofbeam+1]=ATN((SECTHEIGHT[numofbeam-1]-he*COS(rot_p))/(BEAMLENGTH[9]-he*SIN(rot_p)))
IF numofbeam=1 THEN	BETA[numofbeam+1]=ATN((hs-he*COS(rot_p))/(BEAMLENGTH[9]-he*SIN(rot_p)))

IF numofbeam<9 THEN
FOR I=numofbeam+2 TO 10
	BETA[I]=0
NEXT I
ENDIF


DIM GAMMA[10]			!!!! Szogfelezok
	GAMMA[1]=10
	GAMMA[2]=(180-BETA[1]+BETA[2])/2
	GAMMA[3]=(180-BETA[2]+BETA[3])/2
	GAMMA[4]=(180-BETA[3]+BETA[4])/2
	GAMMA[5]=(180-BETA[4]+BETA[5])/2
	GAMMA[6]=(180-BETA[5]+BETA[6])/2
	GAMMA[7]=(180-BETA[6]+BETA[7])/2
	GAMMA[8]=(180-BETA[7]+BETA[8])/2
	GAMMA[9]=(180-BETA[8]+BETA[9])/2
	GAMMA[10]=(180-BETA[9]+BETA[10])/2
	
	GAMMA[numofbeam+1]=(180-BETA[numofbeam]+BETA[numofbeam+1])/2
