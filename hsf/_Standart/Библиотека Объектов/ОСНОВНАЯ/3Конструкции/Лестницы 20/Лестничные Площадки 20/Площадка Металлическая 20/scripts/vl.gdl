
call "FM_types" parameters all

! ---------- 2D detail level ----------

values "gs_detlevel_2D" stDetlevel2D[2], stDetlevel2D[1]
if GLOB_MODPAR_NAME = "gs_detlevel_2D" then
	gs_detlevel_2D_m = 1
	for i = 2 to vardim1(stDetlevel2D)
	   if gs_detlevel_2D = stDetlevel2D[i]	then gs_detlevel_2D_m = i
	next i
	parameters gs_detlevel_2D_m = gs_detlevel_2D_m
else
	parameters gs_detlevel_2D = stDetlevel2D[max(1,min(gs_detlevel_2D_m, vardim1(stDetlevel2D)))]
endif


! ---------- 3D detail level ----------

values "gs_detlevel_3D" stDetlevel3D[3],stDetlevel3D[2],stDetlevel3D[1]		! Detailed, Simple, Off
if GLOB_MODPAR_NAME = "gs_detlevel_3D" then
	gs_detlevel_3D_m = 2
	for i = 1 to vardim1(stDetlevel3D)
	   if gs_detlevel_3D = stDetlevel3D[i]	then gs_detlevel_3D_m = i-1
	next i
	parameters gs_detlevel_3D_m = gs_detlevel_3D_m
else
	gs_detlevel_3D = stDetlevel3D[max(1, min(gs_detlevel_3D_m+1, vardim1(stDetlevel3D)))]
	parameters gs_detlevel_3D = gs_detlevel_3D
endif

! ---------- Landing Type ----------

values "gs_shape_landing" stLandingType
if GLOB_MODPAR_NAME = "gs_shape_landing" then
	gs_shape_landing_m = 1
	for i = 2 to vardim1(stLandingType)
	   if gs_shape_landing = stLandingType[i]	then gs_shape_landing_m = i
	next i
	parameters gs_shape_landing_m = gs_shape_landing_m
else
	gs_shape_landing = stLandingType[max(1, min(gs_shape_landing_m, vardim1(stLandingType)))]
	parameters gs_shape_landing = gs_shape_landing
endif

! ---------- Beam Type ----------

values "gs_type_beam" stBeamType
if GLOB_MODPAR_NAME = "gs_type_beam" then
	gs_type_beam_m = 1
	for i = 2 to vardim1(stBeamType)
	   if gs_type_beam = stBeamType[i]	then gs_type_beam_m = i
	next i
	parameters gs_type_beam_m = gs_type_beam_m
else
	gs_type_beam = stBeamType[max(1, min(gs_type_beam_m, vardim1(stBeamType)))]
	parameters gs_type_beam = gs_type_beam
endif

! ---------- Beam Position ----------

values "gs_position_beam" stBeamPosition		! Single, Double
if GLOB_MODPAR_NAME = "gs_position_beam" then
	gs_position_beam_m = 1
	for i = 2 to vardim1(stBeamPosition)
	   if gs_position_beam = stBeamPosition[i]	then gs_position_beam_m = i
	next i
	parameters gs_position_beam_m = gs_position_beam_m
else
	gs_position_beam = stBeamPosition[max(1, min(gs_position_beam_m, vardim1(stBeamPosition)))]
	parameters gs_position_beam = gs_position_beam
endif


VALUES "h" Range(0,)
VALUES "v" Range(0,)
VALUES "s" Range(0,)
VALUES "t" Range(0,)

VALUES "flwl" RANGE (0,)
VALUES "flwr" RANGE (0,)
VALUES "fx" RANGE (0,)
VALUES "fy" RANGE (0,)
VALUES "yl" RANGE (0,)
VALUES "yr" RANGE (0,)
VALUES "lth" RANGE (0,)

VALUES "schneid1" RANGE (0,180)
VALUES "schneid2" RANGE (0,180)

PARAMETERS ZZYZX=h/1000+lth
LOCK "ZZYZX"

if gs_shape_landing_m = 1 then  ! Straight
	PARAMETERS a=flwl
	PARAMETERS b=fy
endif

if gs_shape_landing_m = 2 then	! L-Shape
	PARAMETERS a=flwl+fx
	PARAMETERS b=fy+yl
endif

if gs_shape_landing_m = 3 then	! U-Shape
	PARAMETERS a=flwl+fx+flwr
	PARAMETERS b=fy+MAX(yl,yr)
endif

! --- Default Beam Sections Values ---

if GLOB_MODPAR_NAME = "gs_type_beam" then

	if gs_type_beam_m = 1 then		! I-Beam
		PARAMETERS h=0.203, v=0.152, s=0.009, t=0.016
	endif

	if gs_type_beam_m = 2 then		! if-Beam
		PARAMETERS h=0.203, v=0.134, s=0.006, t=0.009
	endif

	if gs_type_beam_m = 3 then		! IS-Beam
		PARAMETERS h=0.203, v=0.208, s=0.011, t=0.011
	endif

	if gs_type_beam_m = 4 then		! U-Shape
		PARAMETERS h=0.200, v=0.075, s=0.006, t=0.012
	endif
endif


! --- Hide and LOCK PARAMETERS ---

if gs_shape_landing_m = 1 then  ! Straight
	HIDEPARAMETER "flwr","fx","yl","yr"
endif
if gs_shape_landing_m = 2 then	! L-Shape
	HIDEPARAMETER "flwr","yr"
endif

if gs_type_beam_m = 5 then
	LOCK "gs_position_beam","boff","h","v","s","t","al","schema"
	hideparameter 	"penLineStringer", "typeFillStringer",
					"penFillStringer", "penBackFillStringer"

endif
if gs_position_beam_m = 1 then LOCK "boff"		! Single

! --- Connecting integer and section pencolor type parameters ---

dim iPenNumber[255]
for i=1 to 255
	iPenNumber[i]=i
next i

values "gs_cont_pen"		iPenNumber
values "gs_fill_pen"		iPenNumber
values "penLineStringer" 	iPenNumber
values "penFillStringer" 	iPenNumber
values "penLineTread" 		iPenNumber
values "penFillTread" 		iPenNumber

if GLOB_MODPAR_NAME = "penLineStringer_m" then
	if penLineStringer_m < -1 | penLineStringer_m > 255 then
		penLineStringer_m = 1
		parameters penLineStringer_m = penLineStringer_m
	endif
	parameters penLineStringer = penLineStringer_m
else
	parameters penLineStringer_m = penLineStringer
endif
if GLOB_MODPAR_NAME = "penFillStringer_m" then
	if penFillStringer_m < -1 | penFillStringer_m > 255 then
		penFillStringer_m = 1
		parameters penFillStringer_m = penFillStringer_m
	endif
	parameters penFillStringer = penFillStringer_m
else
	parameters penFillStringer_m = penFillStringer
endif

if GLOB_MODPAR_NAME = "penLineTread_m" then
	if penLineTread_m < 1 | penLineTread_m > 255 then
		penLineTread_m = 1
		parameters penLineTread_m = penLineTread_m
	endif
	parameters penLineTread = penLineTread_m
else
	parameters penLineTread_m = penLineTread
endif
if GLOB_MODPAR_NAME = "penFillTread_m" then
	if penFillTread_m < 1 | penFillTread_m > 255 then
		penFillTread_m = 1
		parameters penFillTread_m = penFillTread_m
	endif
	parameters penFillTread = penFillTread_m
else
	parameters penFillTread_m = penFillTread
endif

if GLOB_MODPAR_NAME = "penBackFillStringer_m" then
	if penBackFillStringer_m < -1 | penBackFillStringer_m > 255 then
		penBackFillStringer_m = 1
		parameters penBackFillStringer_m = penBackFillStringer_m
	endif
	parameters penBackFillStringer = penBackFillStringer_m
else
	parameters penBackFillStringer_m = penBackFillStringer
endif

if GLOB_MODPAR_NAME = "penBackFillTread_m" then
	if penBackFillTread_m < -1 | penBackFillTread_m > 255 then
		penBackFillTread_m = 1
		parameters penBackFillTread_m = penBackFillTread_m
	endif
	parameters penBackFillTread = penBackFillTread_m
else
	parameters penBackFillTread_m = penBackFillTread
endif
