
EPS = 0.0001

SIDE_LEFT				= 1
SIDE_RIGHT				= 2

dim stRiseRunText[7]
	stRiseRunText[1] = `Кол-во x Подступенок = Высота Марша`
	stRiseRunText[2] = `Кол-во Проступей/Подступенок @`
	stRiseRunText[3] = `Кол-во х Проступь х Подступенок`
	stRiseRunText[4] = `Кол-во х Подступенок х Проступь`
	stRiseRunText[5] = `Кол-во <текст подступенка> Подступенок / Проступь`
	stRiseRunText[6] = `Кол-во <текст подступенка> // Подступенок / Проступь`
	stRiseRunText[7] = `Специальный Текст`

dim stStartSymbolStyles[4]
	stStartSymbolStyles[1] = `Стиль 1`
	stStartSymbolStyles[2] = `Стиль 2`
	stStartSymbolStyles[3] = `Стиль 3`
	stStartSymbolStyles[4] = `Нет`

! gs_StartEndStyle_m
STARTSYMB_STYLE1	= 1
STARTSYMB_STYLE2	= 2
STARTSYMB_STYLE3	= 3
STARTSYMB_NONE		= 4

dim stWalkingDirUPDN[3]
	stWalkingDirUPDN[1] = `Нет`
	stWalkingDirUPDN[2] = `ВВЕРХ`
	stWalkingDirUPDN[3] = `ВНИЗ`

! walkingDirUPDN_m
WALKDIRSTR_NONE			= 1
WALKDIRSTR_UP			= 2
WALKDIRSTR_DOWN			= 3

dim stRailPosition[4]
	stRailPosition[1] = `Оба`
	stRailPosition[2] = `Справа`
	stRailPosition[3] = `Слева`
	stRailPosition[4] = `Нет`

! rail_m
RAILPOS_BOTH	= 1
RAILPOS_RIGHT	= 2
RAILPOS_LEFT	= 3
RAILPOS_NONE	= 4

dim stDetlevel2D[2]
	stDetlevel2D[1] = `Зависит от Масштаба`
	stDetlevel2D[2] = `Специальный`

DET2D_SCALESENSITIVE	= 1
DET2D_CUSTOM			= 2

dim stDetlevel3D[3]
	stDetlevel3D[1] = `Детальный`
	stDetlevel3D[2] = `Простой`
	stDetlevel3D[3] = `Откл.`

! gs_detlevel_3D_m
DET3D_OFF		= 0
DET3D_SIMPLE	= 1
DET3D_DETAILED	= 2

dim stRailTypes[11]
	stRailTypes[ 1] = `Балюстрада Ограждения`
	stRailTypes[ 2] = `Параллельные Прутья`
	stRailTypes[ 3] = `Простой Брусок`
	stRailTypes[ 4] = `Объемная Рама с Панелью`
	stRailTypes[ 5] = `Объемная Рама`
	stRailTypes[ 6] = `Панель Ограждения`
	stRailTypes[ 7] = `Стойки Ограждения с Балясинами`
	stRailTypes[ 8] = `Стойки с Леерами`
	stRailTypes[ 9] = `Деревянная Балюстрада`
	stRailTypes[10] = `Стойки Ограждения с Брусками`
	stRailTypes[11] = `Как и Правое`

dim stShowCarriageValues[5]
	stShowCarriageValues[1]	= `Всегда`
	stShowCarriageValues[2]	= `До 1:20`
	stShowCarriageValues[3]	= `До 1:50`
	stShowCarriageValues[4]	= `До 1:100`
	stShowCarriageValues[5]	= `До 1:200`

! leftRailType_m, rightRailType_m
RAIL_BALUSTRADE				= 1
RAIL_PARALLEL_BARS			= 2
RAIL_SIMPLE_BAR				= 3
RAIL_SOLID_FRAME_FILLED		= 4
RAIL_SOLID_FRAME			= 5
RAIL_SOLID					= 6
RAIL_POST_WITH_BALUSTERS	= 7
RAIL_WIRED					= 8
RAIL_WOODEN_BALUSTRADE		= 9
RAIL_POST_WITH_BARS			= 10
RAIL_SAMERAILS				= 11

dim stPostSymbolType[5]
	stPostSymbolType[1] = `Тип 1`
	stPostSymbolType[2] = `Тип 2`
	stPostSymbolType[3] = `Тип 3`
	stPostSymbolType[4] = `Тип 4`
	stPostSymbolType[5] = `Нет`

dim stBattenStyle[5]
	stBattenStyle[1] = `Нет`
	stBattenStyle[2] = `Выступ`
	stBattenStyle[3] = `Промежуточный`
	stBattenStyle[4] = `Проступь`
	stBattenStyle[5] = `Сплошная`

BATTEN_NONE		= 1
BATTEN_NOSING	= 2
BATTEN_INTERM	= 3
BATTEN_TREAD	= 4
BATTEN_FULL		= 5

dim stTopTread[2]
	stTopTread[1] = `на Уровне Пола`
	stTopTread[2] = `Ниже Уровня Пола`

! iTopTread
TOPTREAD_AT_FLOOR_LEVEL		= 1
TOPTREAD_BELOW_FLOOR_LEVEL	= 2

dim stFirstTread[2]
	stFirstTread[1] = `на Уровне Пола`
	stFirstTread[2] = `Выше Уровня Пола`

! iFirstTread
FIRSTTREAD_AT_FLOOR_LEVEL		= 1
FIRSTTREAD_ABOVE_FLOOR_LEVEL	= 2

dim stFlightSectionType[2]
	stFlightSectionType[1] = `без Софита`
	stFlightSectionType[2] = `с Софитом`

! iFlightSectionType
FLIGHTSECTION_WITHOUT_SOFFIT	= 1
FLIGHTSECTION_WITH_SOFFIT		= 2

dim stLowerJunctionType[2]
	stLowerJunctionType[1] = `Первый Этаж`
	stLowerJunctionType[2] = `Пол или Площадка`

! iLowerJunctionType
LOWERJUNCTION_GROUND_FLOOR		= 1
LOWERJUNCTION_FLOOR_OR_LANDING	= 2

dim stHandrailStyle[2]
	stHandrailStyle[1] = `Прямоугольные`
	stHandrailStyle[2] = `Круглые`

! hrtr_m, hrtl_m
HANDRAIL_RECTANGULAR	= 1
HANDRAIL_ROUND			= 2

dim stBarStyle[2]
	stBarStyle[1] = `Прямоугольные`
	stBarStyle[2] = `Круглые`

! btypr_m, btypl_m
BAR_RECTANGULAR	= 1
BAR_ROUND		= 2

dim stPostStyle[2]
	stPostStyle[1] = `Прямоугольные`
	stPostStyle[2] = `Круглые`

! ptr_m, ptl_m
POST_RECTANGULAR	= 1
POST_ROUND			= 2

dim stBoardStyle[2]
	stBoardStyle[1] = `Прямоугольные`
	stBoardStyle[2] = `Круглые`

! btr_m, btl_m
BOARD_RECTANGULAR	= 1
BOARD_ROUND			= 2

dim stCalculationMode[2]
	stCalculationMode[1] = `Кол-во Подступенков`
	stCalculationMode[2] = `Высота Ступени`

! iCalculationMode
CALCMODE_NO_OF_RISERS	= 1
CALCMODE_TREAD_HEIGHT	= 2

dim stArrowStyle[9]
	stArrowStyle[1] = `Стиль 1`
	stArrowStyle[2] = `Стиль 2`
	stArrowStyle[3] = `Стиль 3`
	stArrowStyle[4] = `Стиль 4`
	stArrowStyle[5] = `Стиль 5`
	stArrowStyle[6] = `Стиль 6`
	stArrowStyle[7] = `Стиль 7`
	stArrowStyle[8] = `Стиль 8`
	stArrowStyle[9] = `Стиль 9`

! arrow_style_m
ARROW_STYLE_1 = 1
ARROW_STYLE_2 = 2
ARROW_STYLE_3 = 3
ARROW_STYLE_4 = 4
ARROW_STYLE_5 = 5
ARROW_STYLE_6 = 6
ARROW_STYLE_7 = 7
ARROW_STYLE_8 = 8
ARROW_STYLE_9 = 9

! -------------- 2D Symbol variables --------------

! gs_SymbolType_m
SYMBOL_TYPE1	= 1
SYMBOL_TYPE2	= 2
SYMBOL_TYPE3	= 3
SYMBOL_TYPE4	= 4
SYMBOL_TYPE5	= 5
SYMBOL_TYPE6	= 6
SYMBOL_TYPE7	= 7
SYMBOL_TYPE8	= 8
SYMBOL_TYPE9	= 9
SYMBOL_TYPE10	= 10
SYMBOL_TYPE11	= 11
SYMBOL_TYPE12	= 12
SYMBOL_TYPE13	= 13
SYMBOL_TYPE14	= 14
SYMBOL_TYPE15	= 15
SYMBOL_TYPE16	= 16
SYMBOL_TYPE17	= 17
SYMBOL_TYPE18	= 18
SYMBOL_TYPE19	= 19
SYMBOL_TYPE20	= 20

dim stStairSymbolTypes[20]
	stStairSymbolTypes[ 1] = `Тип 1`
	stStairSymbolTypes[ 2] = `Тип 2`
	stStairSymbolTypes[ 3] = `Тип 3`
	stStairSymbolTypes[ 4] = `Тип 4`
	stStairSymbolTypes[ 5] = `Тип 5`
	stStairSymbolTypes[ 6] = `Тип 6`
	stStairSymbolTypes[ 7] = `Тип 7`
	stStairSymbolTypes[ 8] = `Тип 8`
	stStairSymbolTypes[ 9] = `Тип 9`
	stStairSymbolTypes[10] = `Тип 10`
	stStairSymbolTypes[11] = `Тип 11`
	stStairSymbolTypes[12] = `Тип 12`
	stStairSymbolTypes[13] = `Тип 13`
	stStairSymbolTypes[14] = `Тип 14`
	stStairSymbolTypes[15] = `Тип 15`
	stStairSymbolTypes[16] = `Тип 16`
	stStairSymbolTypes[17] = `Тип 17`
	stStairSymbolTypes[18] = `Тип 18`
	stStairSymbolTypes[19] = `Тип 19`
	stStairSymbolTypes[20] = `Тип 20`

! iSymbolGroup
SYMBOLGROUP_TYPE1	= 1
SYMBOLGROUP_TYPE2	= 2
SYMBOLGROUP_TYPE3	= 3
SYMBOLGROUP_TYPE4	= 4
SYMBOLGROUP_TYPE5	= 5
SYMBOLGROUP_TYPE6	= 6
SYMBOLGROUP_TYPE7	= 7
SYMBOLGROUP_TYPE8	= 8

dim stSymbolGroup[8]
	stSymbolGroup[1] = `Тип 1`
	stSymbolGroup[2] = `Тип 2`
	stSymbolGroup[3] = `Тип 3`
	stSymbolGroup[4] = `Тип 4`
	stSymbolGroup[5] = `Тип 5`
	stSymbolGroup[6] = `Тип 6`
	stSymbolGroup[7] = `Тип 7`
	stSymbolGroup[8] = `Тип 8`

dim	iEnabledSymbolTypes[8][3]
	iEnabledSymbolTypes[1][1] = 1
	iEnabledSymbolTypes[1][2] = 6
	iEnabledSymbolTypes[1][3] = 13

	iEnabledSymbolTypes[2][1] = 2
	iEnabledSymbolTypes[2][2] = 7
	iEnabledSymbolTypes[2][3] = 14

	iEnabledSymbolTypes[3][1] = 3
	iEnabledSymbolTypes[3][2] = 8
	iEnabledSymbolTypes[3][3] = 15

	iEnabledSymbolTypes[4][1] = 4
	iEnabledSymbolTypes[4][2] = 9
	iEnabledSymbolTypes[4][3] = 16

	iEnabledSymbolTypes[5][1] = 5
	iEnabledSymbolTypes[5][2] = 10
	iEnabledSymbolTypes[5][3] = 17

	iEnabledSymbolTypes[6][1] = 4
	iEnabledSymbolTypes[6][2] = 11
	iEnabledSymbolTypes[6][3] = 18

	iEnabledSymbolTypes[7][1] = 4
	iEnabledSymbolTypes[7][2] = 11
	iEnabledSymbolTypes[7][3] = 19

	iEnabledSymbolTypes[8][1] = 5
	iEnabledSymbolTypes[8][2] = 12
	iEnabledSymbolTypes[8][3] = 20


! iScaleType
SCALE_10		= 10
SCALE_20		= 20
SCALE_50		= 50
SCALE_100		= 100
SCALE_200		= 200
SCALE_500		= 500

SCALE_1_1		= 1
SCALE_1_4		= 4
SCALE_1_8		= 8
SCALE_1_16		= 16
SCALE_1_24		= 24
SCALE_1_48		= 48
SCALE_1_96		= 96
SCALE_1_192		= 192
SCALE_CUSTOM	= 999

dim	iScaleType[15]
	iScaleType[1]	= SCALE_10
	iScaleType[2]	= SCALE_20
	iScaleType[3]	= SCALE_50
	iScaleType[4]	= SCALE_100
	iScaleType[5]	= SCALE_200
	iScaleType[6]	= SCALE_500
	iScaleType[7]	= SCALE_1_1
	iScaleType[8]	= SCALE_1_4
	iScaleType[9]	= SCALE_1_8
	iScaleType[10]	= SCALE_1_16
	iScaleType[11]	= SCALE_1_24
	iScaleType[12]	= SCALE_1_48
	iScaleType[13]	= SCALE_1_96
	iScaleType[14]	= SCALE_1_192
	iScaleType[15]	= SCALE_CUSTOM

dim stScaleType[15]
	stScaleType[1]	= `1:10`
	stScaleType[2]	= `1:20`
	stScaleType[3]	= `1:50`
	stScaleType[4]	= `1:100`
	stScaleType[5]	= `1:200`
	stScaleType[6]	= `1:500`
	
	stScaleType[7]	= `1'=1'-0"`
	stScaleType[8]	= `3"=1'-0"`
	stScaleType[9]	= `1 1/2"=1'-0"`
	stScaleType[10]	= `3/4"=1'-0"`
	stScaleType[11]	= `1/2"=1'-0"`
	stScaleType[12]	= `1/4"=1'-0"`
	stScaleType[13]	= `1/8"=1'-0"`
	stScaleType[14]	= `1/16"=1'-0"`
	stScaleType[15]	= `Специальный Масштаб`

if iScaleChangeSM = SCALE_CUSTOM then
	_iScaleSM = gs_ScaleChangeSM
else
	_iScaleSM = iScaleChangeSM
endif
if iScaleChangeMD = SCALE_CUSTOM then
	_iScaleMD = gs_ScaleChangeMD
else
	_iScaleMD = iScaleChangeMD
endif

! -------------- End of 2D Symbol variables --------------


!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
FlightWidth=flw-2*st			!!! StringWidth is in Total Width
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

parameters cfs=1

if iFlightSectionType = FLIGHTSECTION_WITH_SOFFIT then soffit=1 else soffit=0
if thd<2*pth then parameters thd=2*pth+td


if r < st+flw+0.05 then
	parameters r=st+flw+0.05
endif

if wldo<=0 then
	parameters wldo=r-flw/2
endif

if ad then
	IF iCalculationMode = CALCMODE_TREAD_HEIGHT THEN

		_rnu= int(zzyzx/pth)

		if fra(zzyzx/pth) > 0.5 then
			_rnu = _rnu+1
		endif

		_th = zzyzx/_rnu
		_td = abs(thd - 2 * _th)


!		values "rnu" _rnu, CUSTOM
		parameters rnu=_rnu

!		values "th" _th, CUSTOM
		parameters th=_th

!		values "td" _td, CUSTOM
		parameters td=_td

		lock "rnu", "td", "th"
	else								    !No. of Risers
		_th = zzyzx/rnu
		_pth= _th
		_td = abs(thd-2*_th)
		values "th" _th, CUSTOM
		values "pth" _pth, CUSTOM
		values "td" _td, CUSTOM
		parameters th=_th, pth=_pth, td=_td
		lock "td", "th"
	endif
else
	lock "pth", "thd"
endif

if roffl > abs(r)-abs(flw)-abs(st)-0.05 then
	parameters roffl = r-flw-st-0.05
endif

nRiser = rnu
if iTopTread = TOPTREAD_AT_FLOOR_LEVEL then
	numTread = rnu
else	! Below Floor Level
	numTread = rnu - 1
endif
if iFirstTread = FIRSTTREAD_AT_FLOOR_LEVEL then numTread = numTread + 1

!				OTHER
k=2*r*pi
mtd=td*r/wldo
ktd=td*(r-st-flw)/wldo

parameters tdor=mtd
lock "tdor"

fordul=mtd*rnu/k
fokszog=2*asn(mtd/(2*r))

resolka=(360.0/fokszog)*res

stepup = (zzyzx)/(resolka*fordul)

coss= td / sqr(th*th+td*td)

!rescs=int(res*360.0/fokszog)/2
!if rescs<3 then rescs=3

if bSameRails then
!!!	depthTreadOut			= depthTreadIn
	roffl					= roffr
	hrl						= hrr
	dsl						= dsr
	fswl					= fswr
	fthl					= fthr
	ftwl					= ftwr
	fbwl					= fbwr
	bwl						= bwr
	bthl					= bthr
	abdistl					= abdistr
	pmatl					= pmatr
	fmatl					= fmatr
	bmatl					= bmatr
	bhl						= bhr
	nbl						= nbr
	btypl_m					= btypr_m
	bdl						= bdr
	fdfl					= fdfr
	hrtl_m					= hrtr_m
	hrdl					= hrdr
	hrwl					= hrwr
	hrhl					= hrhr
	hrol					= hror
	ptl_m					= ptr_m
	npl						= npr
	pdl						= pdr
	pwl						= pwr
	pthl					= pthr
	btl_m					= btr_m
	nbtl					= nbtr
	sbhl					= sbhr
!!!	gs_PostBaseTypeL_m		= gs_PostBaseTypeR_m
!!!	gs_PostBaseOverhangL	= gs_PostBaseOverhangR
!!!	OverhangLBottom			= OverhangRBottom
!!!	OverhangLTop			= OverhangRTop
!!!	roml					= romr
!!!	roml_m					= romr_m
!!!	rmml_m					= romr_m
endif

bComplexRailRight		= (rightRailType_m > 6)
if bSameRails then
	bComplexRailLeft 	= (rightRailType_m > 6)
else
	bComplexRailLeft 	= (leftRailType_m > 6)
endif

if NOT(bComplexRailLeft) then
	handRailWidthL = fthl
else
	IF hrtl_m = HANDRAIL_ROUND THEN
		handRailWidthL = hrdl
	ELSE
		handRailWidthL = hrwl
	ENDIF
endif
if NOT(bComplexRailRight) then
	handRailWidthR = fthr
else
	IF hrtr_m = HANDRAIL_ROUND THEN
		handRailWidthR = hrdr
	ELSE
		handRailWidthR = hrwr
	ENDIF
endif

bEnableCarriageLine		= 1

