
actualGUID = FROM_GUID

! ==============================================================================
! Subroutines
! ==============================================================================

	_startID	= "A9653396-991E-4303-B5BC-E3EF2D615E5E"	!19
	_endID		= "6BB482FC-7132-4863-8EEC-B5F50002670A"	!20

gosub "repairoffsethorizontal_FWM"
gosub "change_armparams_FWM"

! ==============================================================================
! Set migration GUID
! ==============================================================================

setmigrationguid actualGUID

! ==============================================================================
end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! en
! ==============================================================================


! ==============================================================================
! Repair geometry with horizontal offset & vertical rotation
! ==============================================================================
"repairoffsethorizontal_FWM":
	!always migrate
return

! ==============================================================================
! Change Console, Arm and Frame parameters
! ==============================================================================
"change_armparams_FWM":
	if actualGUID = _startID then

		!deleted parameters
		bSuccess =	deleted_par_value("gs_nConsol_left", 	_nConsol_left) &\
					deleted_par_value("gs_nConsol_right", 	_nConsol_right) &\
					deleted_par_value("gs_casing_left", 	_casing_left) &\
					deleted_par_value("gs_casing_right", 	_casing_right) &\
					deleted_par_value("gs_gap_thickness", 	_gap_thickness)

		if	bSuccess then

			!transfer number of consoles settings
			if _nConsol_left = 0 then bArmLeft = 0 else bArmLeft = 1
			if _nConsol_right = 0 then bArmRight = 0 else bArmRight = 1

			!transfer offsets
			if _nConsol_left = 2 then
				gs_deltaA1 = (_gap_thickness + gs_arm_thickness) / 2
				gs_deltaF1 = _gap_thickness / 2
			else
				gs_deltaA1 = 0
				gs_deltaF1 = 0
			endif

			if _nConsol_right = 2 then
				gs_deltaA2 = (_gap_thickness + gs_arm_thickness) / 2
				gs_deltaF2 = _gap_thickness / 2
			else
				gs_deltaA2 = 0
				gs_deltaF2 = 0
			endif

			!don't migrate when casing has effect
			if	(_nConsol_left = 1 & _casing_left) |\
				(_nConsol_right = 1 & _casing_right) then

				_endID = ""
			else
				parameters	bArmLeft = bArmLeft,
							bArmRight = bArmRight,
							gs_deltaA1 = gs_deltaA1,
							gs_deltaA2 = gs_deltaA2,
							gs_deltaF1 = gs_deltaF1,
							gs_deltaF2 = gs_deltaF2
			endif
		else
			_endID = ""
		endif

		actualGUID = _endID
	endif
return

