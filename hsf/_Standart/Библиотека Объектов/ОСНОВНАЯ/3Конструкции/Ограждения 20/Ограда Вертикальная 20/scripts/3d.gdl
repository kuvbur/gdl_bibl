
!!Fence Vertical.gsm

if gs_detlevel_3D_m = DETLEV_OFF then end

if not(gs_shadow) then shadow off

resol gs_resol
pen gs_cont_pen
rotx 90

if np<1 then goto 10
material pomat


if np>=1 then
addz -pd/2


if np>1 and np*pw>=a then
	pw=a/np
	endif
	if np>1 then aa=(a-np*pw)/(np-1)
	if np=1 then aa=a-pw
	if np=1 and pw>=a then
		pw=a
	endif
	for t=1 to np
		block pw,zzyzx+ph,pd
		addx aa+pw
	next t
	del np+1
	a=aa
endif

gosub 3000

if aa<=0 then end


if np>=1 then
addx pw
if np>1 then uu=np-1
if np=1 then uu=1
for u=1 to uu
gosub 10
addx pw+aa
next u

gosub 1000

end
endif


10:

zz=(zzyzx-nhb*hbh)/(nhb+1)
if nhb*hbh>=zzyzx then
zz=0
hbh=zzyzx/nhb
endif
addz -hbd/2
addy zz
material bamat
for n=1 to nhb
block a,hbh,hbd
addy hbh+zz
next n


del nhb+2
addz hbd/2

material bomat
!---------------------------------
if bw>=a then
	bw=a
	if iBoardEndStyle = BOARDEND_PLANE then
		block bw,zzyzx,bd
	endif

	if iBoardEndStyle = BOARDEND_TRIANGULAR then
		prism 6,bd,
			0,0,
			bw,0,
			bw,zzyzx-(bw/2),
			bw/2,zzyzx,
			0,zzyzx-(bw/2),
			0,0
	endif

	if iBoardEndStyle = BOARDEND_ROUND then
		prism_ 7,bd,
			0,0,15,
			bw,0,15,
			bw,zzyzx-(bw/2),79,
			bw/2,zzyzx-(bw/2),979,
			bw/2,180,4079,
			0,zzyzx-(bw/2),13,
			0,0,-1
	endif
endif


!---------------------------------
if (2*bw+gb*3)>a then
addx (a-bw)/2
if iBoardEndStyle = BOARDEND_PLANE then
	block bw,zzyzx,bd
endif

if iBoardEndStyle = BOARDEND_TRIANGULAR then
	prism 6,bd,
		0,0,
		bw,0,
		bw,zzyzx-(bw/2),
		bw/2,zzyzx,
		0,zzyzx-(bw/2),
		0,0
endif

if iBoardEndStyle = BOARDEND_ROUND then
	prism_ 7,bd,
		0,0,15,
		bw,0,15,
		bw,zzyzx-(bw/2),79,
		bw/2,zzyzx-(bw/2),979,
		bw/2,180,4079,
		0,zzyzx-(bw/2),13,
		0,0,-1
		endif
		addx -(a-bw)/2
endif


!---------------------------------

if (2*bw+gb*3)<=a then
	nn=int((a-gb)/(gb+bw))
	ggb=(a-nn*bw)/(nn+1)
	addx ggb
	for t=1 to nn
		if iBoardEndStyle = BOARDEND_PLANE then
			block bw,zzyzx,bd
		endif

		if iBoardEndStyle = BOARDEND_TRIANGULAR then
			prism 6,bd,
				0,0,
				bw,0,
				bw,zzyzx-(bw/2),
				bw/2,zzyzx,
				0,zzyzx-(bw/2),
				0,0
		endif

		if iBoardEndStyle = BOARDEND_ROUND then
			prism_ 7,bd,
				0,0,15,
				bw,0,15,
				bw,zzyzx-(bw/2),79,
				bw/2,zzyzx-(bw/2),979,
				bw/2,180,4079,
				0,zzyzx-(bw/2),13,
				0,0,-1
		endif

		addx bw+ggb
	next t
	addx -a

	if np<1 then end
endif
addz -hbd/2
if np<=1 then end
return

END

1000:
roty 90
gosub 5000
del 1
return

2000:
gosub 5000
return

3000:
rotz 90
gosub 5000
del 1
return

4000:
rotx 90
gosub 5000
del 1
return


5000:

vert 0, 0, 0
vert 1, 0, 0
vert 0, 1, 0
vert 0, 0, 1

coor 2, -1, -2, -3, -4

base

body -1

return


