
! ==============================================================================
! Fence Horizontal
! ==============================================================================


pen gs_cont_pen

unID=1
hLineID = 1000

!!! LENGTH
HOTSPOT2 0,0,unID,A,1+256 : unID=unID+1
HOTSPOT2 A,0,unID,A,2 : unID=unID+1
HOTSPOT2 -1,0,unID,A,3 : unID=unID+1

HOTLINE2 0,0,A,0, hLineID : hLineID = hLineID + 1

if np<1 then
	add2 0,bd/2
	rect2 0,0,a,-bd
	end
endif

add2 0,-pd/2

if np>=1 then

	if np>1 and np*pw>=a then
		pw=a/np
		endif
		if np>1 then aa=(a-np*pw)/(np-1)
		if np=1 then aa=a-pw
		if np=1 and pw>a then
		pw=a
	endif

	for t=1 to np
		fill gs_fill_type
		POLY2_B 4, 1+2+4+64, gs_fill_pen, gs_back_pen,
				0, 0, 1,
				pw, 0, 1,
				pw, pd, 1,
				0, pd, 1
		HOTSPOT2 0,0,unID: unID=unID+1
		HOTSPOT2 pw,0,unID: unID=unID+1
		HOTSPOT2 pw,pd,unID: unID=unID+1
		HOTSPOT2 0,pd,unID: unID=unID+1
		HOTSPOT2 pw/2,pd/2,unID: unID=unID+1
		add2 aa+pw,0
	next t
	del np
	a=aa
endif


if aa<=0 then end

add2 pw,0
if bp_m = 1 then
	add2 0,(-bd/2+pd/2)
endif

if bp_m = 2 then
	add2 -pw/2,0
	add2 0,-bd
		if np>1 then
			aa=aa+pw
		endif
		if np=1 then
			aa=aa+pw/2
		endif
endif


if np>1 then uu=np-1
if np=1 then uu=1
for u=1 to uu
gosub 10

if bp_m = 1 then
add2 pw+aa,0
endif
if bp_m = 2 then
add2 aa,0
endif
next u
end


10:
fill gs_fill_type
POLY2_B 4, 1+2+4+64, gs_fill_pen, gs_back_pen,
		0, 0, 1,
		aa, 0, 1,
		aa, bd, 1,
		0, bd, 1

return


