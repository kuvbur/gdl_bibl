
! ==============================================================================
! Fence Horizontal
! ==============================================================================


IF gs_detlevel_3D_m = 0 then end

IF gs_shadow=0 THEN SHADOW OFF


pen gs_cont_pen
if ABS(zzyzx)<EPS then end


rotx 90


if np<1 then
material bomat
addz -bd/2

if zzyzx>=bh+gb then
nn=int (zzyzx/(bh+gb))
ggb=(zzyzx-nn*bh)/nn
addy ggb
for t=1 to nn
block a,bh,bd
addy bh+ggb
next t
endif

if zzyzx<=gb then
block a,zzyzx,bd
endif

if zzyzx>gb and zzyzx<bh+gb then
addy gb
block a,zzyzx-gb,bd
endif

end
endif



material pomat
addz -pd/2

if np>=1 then



if np>1 and np*pw>=a then
pw=a/np
endif
if np>1 then aa=(a-np*pw)/(np-1)
if np=1 then aa=a-pw
if np=1 and pw>=a then
pw=a
endif
for t=1 to np
block pw,zzyzx+ph,pd
addx aa+pw
next t
del np
a=aa
endif

gosub 3000

if aa<=0 then end



addx pw
if bp_m = 1 then
	addz -bd/2+pd/2
endif
if bp_m = 2 then
	addx -pw/2
addz pd
if np>1 then
aa=aa+pw
endif
if np=1 then
aa=aa+pw/2
endif
endif


if np>1 then uu=np-1
if np=1 then uu=1
for u=1 to uu
gosub 10

if bp_m = 1 then
 addx pw+aa
endif
if bp_m = 2 then
addx aa
endif
next u
del top

gosub 2000

end


10:
material bomat

if zzyzx>=bh+gb then
nn=int (zzyzx/(bh+gb))
ggb=(zzyzx-nn*bh)/nn
addy ggb
for t=1 to nn
block aa,bh,bd
addy bh+ggb
next t
del nn+1
endif

if zzyzx<=gb then
block aa,zzyzx,bd
endif

if zzyzx>gb and zzyzx<bh+gb then
addy gb
block aa,zzyzx-gb,bd
del 1
endif

return

END

2000:
gosub 5000
return

3000:
rotz 90
gosub 5000
del 1
return


5000:

vert 0, 0, 0
vert 1, 0, 0
vert 0, 1, 0
vert 0, 0, 1

coor 2, -1, -2, -3, -4

base

body -1

return


