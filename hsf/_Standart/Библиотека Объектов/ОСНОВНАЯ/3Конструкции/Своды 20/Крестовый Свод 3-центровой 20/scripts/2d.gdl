
shell_angle=180
angle_1=0


!! Shell



pen gs_cont_pen
fill gs_fill_type


min_y=-b/2
max_y=b/2


unID=1

!!----------------!!
!! Length Editing !!
!!----------------!!

hotspot2 0,min_y,unId,a,1+256 : unID=unID+1
hotspot2 a,min_y,unId,a,2 : unID=unID+1
hotspot2 -1,min_y,unId,a,3 : unID=unID+1

hotspot2 0,max_y,unId,a,1+256 : unID=unID+1
hotspot2 a,max_y,unId,a,2 : unID=unID+1
hotspot2 -1,max_y,unId,a,3 : unID=unID+1

hotspot2 0,0,unID : unID=unID+1

hotspot2 0,0,unId,a,1+256 : unID=unID+1
hotspot2 a,0,unId,a,2 : unID=unID+1
hotspot2 -1,0,unId,a,3 : unID=unID+1

!!-------------------!!
!! Thickness Editing !!
!!-------------------!!

hotspot2 0,-b/2,unID,shell_thk,1+128 : unID=unID+1
hotspot2 0,-b/2+shell_thk,unID,shell_thk,2 : unID=unID+1
hotspot2 0,-b/2+shell_thk-1,unID,shell_thk,3 : unID=unID+1

hotspot2 a,-b/2,unID,shell_thk,1+128 : unID=unID+1
hotspot2 a,-b/2+shell_thk,unID,shell_thk,2 : unID=unID+1
hotspot2 a,-b/2+shell_thk-1,unID,shell_thk,3 : unID=unID+1

hotspot2 0,b/2,unID,shell_thk,1+128 : unID=unID+1
hotspot2 0,b/2-shell_thk,unID,shell_thk,2 : unID=unID+1
hotspot2 0,b/2-shell_thk+1,unID,shell_thk,3 : unID=unID+1

hotspot2 a,b/2,unID,shell_thk,1+128 : unID=unID+1
hotspot2 a,b/2-shell_thk,unID,shell_thk,2 : unID=unID+1
hotspot2 a,b/2-shell_thk+1,unID,shell_thk,3 : unID=unID+1


!!---------------------!!
!! Shell Width Editing !!
!!---------------------!!

hotspot2 0, 0,unID,half_b,1+128 : unID=unID+1
hotspot2 0,-b/2,unID,half_b,2 : unID=unID+1
hotspot2 0,b,unID,half_b,3 : unID=unID+1

hotspot2 a, 0,unID,half_b,1+128 : unID=unID+1
hotspot2 a,-b/2,unID,half_b,2 : unID=unID+1
hotspot2 a,b,unID,half_b,3 : unID=unID+1

hotspot2 0, 0,unID,half_b,1+128 : unID=unID+1
hotspot2 0, b/2,unID,half_b,2 : unID=unID+1
hotspot2 0, -b,unID,half_b,3 : unID=unID+1

hotspot2 a, 0,unID,half_b,1+128 : unID=unID+1
hotspot2 a, b/2,unID,half_b,2 : unID=unID+1
hotspot2 a, -b,unID,half_b,3 : unID=unID+1


!!!******************************

x=gs_firstaxis-gs_b2/2
y=-b/2

unID=100

for i=1 to gs_f_num

	put x, y, 1
	put x, y-gs_f_length, 1
	put x+2*(gs_b2/2), y-gs_f_length, 1
	put x+2*(gs_b2/2), y, 1

	!!****** Hotspot editing - length

	hotspot2 x, y,unId,gs_f_length,1+128 : unID=unID+1
	hotspot2 x, y+1,unId,gs_f_length,3 : unID=unID+1
	hotspot2 x, y-gs_f_length,unId,gs_f_length,2 : unID=unID+1

	hotspot2 x+2*(gs_b2/2), y,unId,gs_f_length,1+128 : unID=unID+1
	hotspot2 x+2*(gs_b2/2), y+1,unId,gs_f_length,3 : unID=unID+1
	hotspot2 x+2*(gs_b2/2), y-gs_f_length,unId,gs_f_length,2 : unID=unID+1

	!!**********************

	!!****** Hotspot editing - thickness

	hotspot2 x, y,unId,gs_shell_thk2,1+128 : unID=unID+1
	hotspot2 x+gs_shell_thk2, y,unId,gs_shell_thk2,2 : unID=unID+1
	hotspot2 x-1, y-gs_f_length/2,unId,gs_shell_thk2,3 : unID=unID+1

	hotspot2 x+2*(gs_b2/2), y,unId,gs_shell_thk2,1+128 : unID=unID+1
	hotspot2 x+2*(gs_b2/2)-gs_shell_thk2, y,unId,gs_shell_thk2,2 : unID=unID+1
	hotspot2 x+2*(gs_b2/2)+1, y,unId,gs_shell_thk2,3 : unID=unID+1

	!!**********************

	!!****** Hotspot editing - width

	hotspot2 x+gs_b2/2, y-gs_f_length,unId,half_b2,1+128 : unID=unID+1
	hotspot2 x, y-gs_f_length,unId,half_b2,2 : unID=unID+1
	hotspot2 x+gs_b2+1, y-gs_f_length,unId,half_b2,3 : unID=unID+1

	hotspot2 x+gs_b2/2, y-gs_f_length,unId,half_b2,1+128 : unID=unID+1
	hotspot2 x+gs_b2, y-gs_f_length,unId,half_b2,2 : unID=unID+1
	hotspot2 x-1, y-gs_f_length,unId,half_b2,3 : unID=unID+1

	!!*********************

	if gs_axis then
		PEN gs_axis_pen
		line_type gs_axis_line
		line2 x+gs_b2/2, y+gs_h2-gs_shell_thk2+shell_thk, x+gs_b2/2, y-gs_f_length
	endif
	PEN gs_cont_pen
	line_type SYMB_LINETYPE

	!!****** Hotspot editing - axes

	if i<2 then
		hotspot2 x+gs_b2/2+gs_ax_length, y,unId,gs_ax_length,1+128 : unID=unID+1
		hotspot2 x+gs_b2/2, y,unId,gs_ax_length,2 : unID=unID+1
		hotspot2 a, y,unId,gs_ax_length,3 : unID=unID+1
	else
		hotspot2 x+gs_b2/2-gs_ax_length, y,unId,gs_ax_length,1+128 : unID=unID+1
		hotspot2 x+gs_b2/2, y,unId,gs_ax_length,2 : unID=unID+1
		hotspot2 0, y,unId,gs_ax_length,3 : unID=unID+1
	endif

	unID=unID+21

	x=x+gs_ax_length

next i

poly2_b 5+nsp/3, 1+2+4+64, gs_fill_pen, gs_back_pen,
		0, min_y, 1,
		get (nsp),
		a, min_y, 1,
		a, 0, 0,
		0, 0, 1,
		0, min_y, -1

unID=100

if gs_f_type_m = LOCATION_BOTH_SIDES then

	x=gs_firstaxis-gs_b2/2
	y=b/2

	for i=1 to gs_f_num

		unID=unID+21

		put x, y, 1
		put x, y+gs_f_length, 1
		put x+2*(gs_b2/2), y+gs_f_length, 1
		put x+2*(gs_b2/2), y, 1

		!!****** Hotspot editing - length

		hotspot2 x, y,unId,gs_f_length,1+128 : unID=unID+1
		hotspot2 x, y-1,unId,gs_f_length,3 : unID=unID+1
		hotspot2 x, y+gs_f_length,unId,gs_f_length,2 : unID=unID+1

		hotspot2 x+2*(gs_b2/2), y,unId,gs_f_length,1+128 : unID=unID+1
		hotspot2 x+2*(gs_b2/2), y-1,unId,gs_f_length,3 : unID=unID+1
		hotspot2 x+2*(gs_b2/2), y+gs_f_length,unId,gs_f_length,2 : unID=unID+1

		!!*********************

		!!****** Hotspot editing - thickness

		hotspot2 x, y,unId,gs_shell_thk2,1+128 : unID=unID+1
		hotspot2 x+gs_shell_thk2, y,unId,gs_shell_thk2,2 : unID=unID+1
		hotspot2 x-1, y,unId,gs_shell_thk2,3 : unID=unID+1

		hotspot2 x+2*(gs_b2/2), y,unId,gs_shell_thk2,1+128 : unID=unID+1
		hotspot2 x+2*(gs_b2/2)-gs_shell_thk2, y,unId,gs_shell_thk2,2 : unID=unID+1
		hotspot2 x+2*(gs_b2/2)+1, y,unId,gs_shell_thk2,3 : unID=unID+1

		!!**********************

		!!****** Hotspot editing - width

		hotspot2 x+gs_b2/2, y+gs_f_length,unId,half_b2,1+128 : unID=unID+1
		hotspot2 x, y+gs_f_length,unId,half_b2,2 : unID=unID+1
		hotspot2 x+gs_b2, y+gs_f_length,unId,half_b2,3 : unID=unID+1

		hotspot2 x+gs_b2/2, y+gs_f_length,unId,half_b2,1+128 : unID=unID+1
		hotspot2 x+gs_b2, y+gs_f_length,unId,half_b2,2 : unID=unID+1
		hotspot2 x-1, y+gs_f_length,unId,half_b2,3 : unID=unID+1

		!!*********************

		if gs_axis then
			PEN gs_axis_pen
			line_type gs_axis_line
			line2 x+gs_b2/2, y-gs_h2+gs_shell_thk2-shell_thk, x+gs_b2/2, y+gs_f_length
		endif
		PEN gs_cont_pen
		line_type SYMB_LINETYPE

		!!****** Hotspot editing - axes

		if i<2 then
			hotspot2 x+gs_b2/2+gs_ax_length, y,unId,gs_ax_length,1+128 : unID=unID+1
			hotspot2 x+gs_b2/2, y,unId,gs_ax_length,2 : unID=unID+1
			hotspot2 a, y,unId,gs_ax_length,3 : unID=unID+1
		else
			hotspot2 x+gs_b2/2-gs_ax_length, y,unId,gs_ax_length,1+128 : unID=unID+1
			hotspot2 x+gs_b2/2, y,unId,gs_ax_length,2 : unID=unID+1
			hotspot2 0, y,unId,gs_ax_length,3 : unID=unID+1
		endif

		x=x+gs_ax_length

	next i

	poly2_b 5+nsp/3, 1+2+4+64, gs_fill_pen, gs_back_pen,
			0, max_y, 1,
			get (nsp),
			a, max_y, 1,
			a, 0, 0,
			0, 0, 1,
			0, max_y, -1

else

	poly2_b 5, 1+2+4+64, gs_fill_pen, gs_back_pen,
			0, max_y, 1,
			a, max_y, 1,
			a, 0, 0,
			0, 0, 1,
			0, max_y, -1

endif

!!!*********************

line_type gs_DashedLine


x=gs_firstaxis-gs_b2/2+gs_shell_thk2
y=-b/2+shell_thk

for i=1 to gs_f_num

	put x, y, 1
	put x, y-gs_f_length-shell_thk, 1
	put x+2*(gs_b2/2-gs_shell_thk2), y-gs_f_length-shell_thk, 1
	put x+2*(gs_b2/2-gs_shell_thk2), y, 1

	if gs_arc=1 then

		poly2_	6, 1,
			x+gs_b2-2*gs_shell_thk2, y, 1,
			0,1,801,
			x+gs_b2/2-gs_shell_thk2+(rr1_2-gs_shell_thk2)*sin(alpha2),y+(rr2_2-gs_shell_thk2)*cos(alpha2),1001,
			x+gs_b2/2-gs_shell_thk2,y+gs_h2-gs_shell_thk2,1001,
			x+gs_b2/2-gs_shell_thk2-(rr1_2-gs_shell_thk2)*sin(alpha2),y+(rr2_2-gs_shell_thk2)*cos(alpha2),1001,
			x, y, 1000

	endif

	x=x+gs_ax_length

next i

poly2_ 5+nsp/3, 1,
		0, min_y+shell_thk, 1,
		get (nsp),
		a, min_y+shell_thk, 1,
		a, 0, 0,
		0, 0, 1,
		0, min_y+shell_thk, -1


if gs_f_type_m = LOCATION_BOTH_SIDES then

	x=gs_firstaxis-gs_b2/2+gs_shell_thk2
	y=b/2-shell_thk

	for k=1 to gs_f_num

		put x, y, 1
		put x, y+gs_f_length+shell_thk, 1
		put x+2*(gs_b2/2-gs_shell_thk2), y+gs_f_length+shell_thk, 1
		put x+2*(gs_b2/2-gs_shell_thk2), y, 1

		if gs_arc=1 then

			poly2_	6, 1,
				x+gs_b2-2*gs_shell_thk2, y, 1,
				0,-1,801,
				x+gs_b2/2-gs_shell_thk2+(rr1_2-gs_shell_thk2)*sin(alpha2),y-(rr2_2-gs_shell_thk2)*cos(alpha2),1001,
				x+gs_b2/2-gs_shell_thk2,y-gs_h2+gs_shell_thk2,1001,
				x+gs_b2/2-gs_shell_thk2-(rr1_2-gs_shell_thk2)*sin(alpha2),y-(rr2_2-gs_shell_thk2)*cos(alpha2),1001,
				x, y, 1000

		endif

		x=x+gs_ax_length

	next k

	poly2_ 5+nsp/3, 1,
		0, max_y-shell_thk, 1,
		get (nsp),
		a, max_y-shell_thk, 1,
		a, 0, 0,
		0, 0, 1,
		0, max_y-shell_thk, -1

else

	poly2_ 5, 1,
		0, max_y-shell_thk, 1,
		a, max_y-shell_thk, 1,
		a, 0, 0,
		0, 0, 1,
		0, max_y-shell_thk, -1

endif

!!*****************

if gs_arc=1 then

	rot2 -90

	for i=1 to 2

		poly2_	6, 1,
			 b/2-shell_thk, 0, 1,
			 0,1,801,
			 (rr1-shell_thk)*sin(alpha), (rr2-shell_thk)*cos(alpha),1001,
			 0,gs_h1-shell_thk,1001,
			-(rr1-shell_thk)*sin(alpha),(rr2-shell_thk)*cos(alpha),1001,
			-b/2+shell_thk, 0, 1000

			add2 0, a
			rot2 180

	next i

	del 4
	del 1

endif


if gs_axis then
	PEN gs_axis_pen
	line_type gs_axis_line
	line2 0,0,a,0
endif




