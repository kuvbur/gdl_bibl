
!! Curve Base.gsm

if gs_detlevel_3D_m = DLEV3D_OFF then End

rotx angle_1
roty angle_2

unID=1
hotspot 0,0,0,unID,zzyzx,1+256 : unID=unID+1
hotspot 0,0,-1,unID,zzyzx,3 : unID=unID+1
hotspot 0,0,zzyzx,unID,zzyzx,2 : unID=unID+1

!curvature<1 gives convex sides
!curvature=1 gives straight sides
!curvature>1 gives concave sides
!do not set inside diameter=0

if gs_shadow then
	shadow on
else
	shadow off
endif

pen gs_cont_pen
material gs_prim_mat



!HOTSPOT a/2,0,0
!HOTSPOT 0,b/2,0
!HOTSPOT -a/2,0,0
!HOTSPOT 0,-b/2,0

muly b/a
a=a/2
! Coefficient of x
z=zzyzx/(-c/2+a)^g
! x increment
y=(a-c/2)/e
! Angle of circular segment
x=360/f
f=h
! Constants
n=cos(x)
o=sin(x)
! Initial conditions
v=y-a
t=(y-a)*n
b=z*y^g
h=v*n
i=v*o
j=-a*n
k=-a*o


HOTSPOT 0,0,ZZYZX

for m =0 to f
	HOTSPOT -a,0,0
	rotz x
next m
del f+1

for m = 1 to f
   plane 4,-a,0,0,
		   v,0,b,
		   h,i,b,
		   j,k,0
   rotz x

next m
del f

for l = 1 to e-1
   w=v
   v=w+y
   u=t
   t=v*n
   s=z*(w+a)^g
   r=z*(v+a)^g
   q=w*o
   p=q*t/u

   for m = 1 to f
	  plane 4,w,0,s,
			 v,0,r,
			 t,p,r,
			 u,q,s
	  rotz x

   next m
   del f
next l
GOTO 2

2:
end
