
!! Cylinder Shell

if gs_detlevel_3D_m = DLEV3D_OFF then End
if gs_detlevel_3D_m = DLEV3D_SIMPLE then gs_resol = 18

if gs_shadow then
	shadow on
else
	shadow off
endif

if GLOB_CONTEXT<20 or GLOB_CONTEXT>40 then
	resol gs_resol
else
	resol 12
endif

pen gs_cont_pen

rotx angle_1
roty angle_2

unID=1
!----------------!
! Height Editing !
!----------------!

hotspot	-radius_1,0,0,unID,zzyzx,1+256 : unID=unID+1
hotspot	-radius_1,0,-1,unID,zzyzx,3 : unID=unID+1
hotspot	-radius_1,0,zzyzx,unID,zzyzx,2 : unID=unID+1

hotspot	-radius_1+shell_thk,0,0,unID,zzyzx,1+256 : unID=unID+1
hotspot	-radius_1+shell_thk,0,-1,unID,zzyzx,3 : unID=unID+1
hotspot	-radius_1+shell_thk,0,zzyzx,unID,zzyzx,2 : unID=unID+1

hotspot (radius_1-shell_thk)*cos(180-shell_angle),(radius_1-shell_thk)*sin(shell_angle),0,unID,zzyzx,1+256 : unID=unID+1
hotspot (radius_1-shell_thk)*cos(180-shell_angle),(radius_1-shell_thk)*sin(shell_angle),-1,unID,zzyzx,3 : unID=unID+1
hotspot (radius_1-shell_thk)*cos(180-shell_angle),(radius_1-shell_thk)*sin(shell_angle),zzyzx,unID,zzyzx,2 : unID=unID+1

hotspot radius_1*cos(180-shell_angle),radius_1*sin(shell_angle),0,unID,zzyzx,1+256 : unID=unID+1
hotspot radius_1*cos(180-shell_angle),radius_1*sin(shell_angle),-1,unID,zzyzx,3 : unID=unID+1
hotspot radius_1*cos(180-shell_angle),radius_1*sin(shell_angle),zzyzx,unID,zzyzx,2 : unID=unID+1

!---------------------!
! Shell angle editing !
!---------------------!

hotspot 0,0,0,unID,shell_angle,6 : unID=unID+1
hotspot -radius_1+shell_thk/2,0,0,unID,shell_angle,4+256 : unID=unID+1
hotspot 0,0,-1,unID,shell_angle,7 : unID=unID+1
hotspot (radius_1-shell_thk/2)*cos(180-shell_angle),(radius_1-shell_thk/2)*sin(shell_angle),0,unID,shell_angle,5 : unID=unID+1

hotspot 0,0,zzyzx,unID,shell_angle,6 : unID=unID+1
hotspot -radius_1+shell_thk/2,0,zzyzx,unID,shell_angle,4+256 : unID=unID+1
hotspot 0,0,zzyzx-1,unID,shell_angle,7 : unID=unID+1
hotspot (radius_1-shell_thk/2)*cos(180-shell_angle),(radius_1-shell_thk/2)*sin(shell_angle),zzyzx,unID,shell_angle,5 : unID=unID+1

!-------------------------!
! Shell Thickness Editing !
!-------------------------!

hotspot	-radius_1,0,zzyzx/2,unID,shell_thk,1+128 : unID=unID+1
hotspot	-radius_1-1,0,zzyzx/2,unID,shell_thk,3 : unID=unID+1
hotspot	-radius_1+shell_thk,0,zzyzx/2,unID,shell_thk,2 : unID=unID+1

hotspot	radius_1*cos(180-shell_angle),radius_1*sin(shell_angle),zzyzx/2,unID,shell_thk,1+128 : unID=unID+1
hotspot	(radius_1+1)*cos(180-shell_angle),(radius_1+1)*sin(shell_angle),zzyzx/2,unID,shell_thk,3 : unID=unID+1
hotspot	(radius_1-shell_thk)*cos(180-shell_angle),(radius_1-shell_thk)*sin(shell_angle),zzyzx/2,unID,shell_thk,2 : unID=unID+1

!----------------------!
! Shell Radius Editing !
!----------------------!

hotspot	-radius_1,0,zzyzx/2,unID,shell_thk,1+128 : unID=unID+1
hotspot	-radius_1-1,0,zzyzx/2,unID,shell_thk,3 : unID=unID+1
hotspot	-radius_1+shell_thk,0,zzyzx/2,unID,shell_thk,2 : unID=unID+1

hotspot	radius_1*cos(180-shell_angle),radius_1*sin(shell_angle),zzyzx/2,unID,shell_thk,1+128 : unID=unID+1
hotspot	(radius_1+1)*cos(180-shell_angle),(radius_1+1)*sin(shell_angle),zzyzx/2,unID,shell_thk,3 : unID=unID+1
hotspot	(radius_1-shell_thk)*cos(180-shell_angle),(radius_1-shell_thk)*sin(shell_angle),zzyzx/2,unID,shell_thk,2 : unID=unID+1

material gs_prim_mat

if shell_angle>360-0.001 and shell_angle<360+0.001 then
	prism_  14, zzyzx,
			radius_1, 0.0, 79,
			0.0, 0.0, 900,
			0.0, 180.0, 4079,
		   -radius_1, 0.0, 79,
			0.0, 0.0, 900,
			0.0, 180.0, 4079,
			radius_1, 0.0, -1,
			(radius_1-shell_thk), 0.0, 79,
			0.0, 0.0, 900,
			0.0, 180.0, 4079,
		   -(radius_1-shell_thk), 0.0, 79,
			0.0, 0.0, 900,
			0.0, 180.0, 4079,
			(radius_1-shell_thk), 0.0, -1
else
	prism_	8, zzyzx,
			-(radius_1-shell_thk), 0, 15,
			-radius_1, 0, 15,
			-radius_1, 0.0001, 79,
			0, 0, 979,
			radius_1,-shell_angle-0.0001, 4015,
			(radius_1-shell_thk)*cos(180-shell_angle),(radius_1-shell_thk)*sin(shell_angle), 79,
			0, 0, 979,
			-(radius_1-shell_thk), shell_angle, 4015

	for i=1 to 2
		lin_	-radius_1,0,0, -radius_1,0,zzyzx
		lin_	-radius_1+shell_thk,0,0, -radius_1+shell_thk,0,zzyzx
		rotz -shell_angle
	next i
	del 2
endif


