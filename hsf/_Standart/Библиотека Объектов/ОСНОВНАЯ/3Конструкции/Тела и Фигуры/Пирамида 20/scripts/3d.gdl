
if iDetlevel3D = DETLEVEL_OFF		then End

if gs_shadow then
	shadow on
else
	shadow off
endif

pen gs_cont_pen

unID=1
hotspot 0,0,0,unID : unID=unID+1

!--------------------!
! Base Angle Editing !
!--------------------!

!-------------------!
! Top Angle Editing !
!-------------------!

!---------------------------!
! Top Circle Center Editing !
!---------------------------!

if iEditMode = EDITMODE_COORDINATES then
	hotspot dist_x,dist_y,0,unID,zzyzx,1+128 : unID=unID+1
	hotspot dist_x,dist_y,-1,unID,zzyzx,3 : unID=unID+1
	hotspot dist_x,dist_y,zzyzx,unID,zzyzx,2 : unID=unID+1

	hotspot dist_x,0,zzyzx,unID,dist_y,1+128 : unID=unID+1
	hotspot dist_x,-1,zzyzx,unID,dist_y,3 : unID=unID+1
	hotspot dist_x,dist_y,zzyzx,unID,dist_y,2 : unID=unID+1

	hotspot 0,dist_y,zzyzx,unID,dist_x,1+128 : unID=unID+1
	hotspot -1,dist_y,zzyzx,unID,dist_x,3 : unID=unID+1
	hotspot dist_x,dist_y,zzyzx,unID,dist_x,2 : unID=unID+1
else
	hotspot 0,0,0,unID,gamma,6 : unID=unID+1
	hotspot 1,0,0,unID,gamma,4+128 : unID=unID+1
	hotspot 0,-1,0,unID,gamma,7 : unID=unID+1
	hotspot length/2*cos(gamma),0,length/2*sin(gamma),unID,gamma,5 : unID=unID+1

	roty 90-gamma
	hotspot 0,0,0,unID,length,1+128 : unID=unID+1
	hotspot 0,0,-1,unID,length,3 : unID=unID+1
	hotspot 0,0,length,unID,length,2 : unID=unID+1
	del 1
endif

material gs_prim_mat

angle	= 0
for i=1 to edge_num
	put radius_1*cos(angle), radius_1*sin(angle), 0
	angle=i*360/edge_num
next i

if iEndMode = ENDMODE_HORIZONTAL then
	angle=0
	for i=1 to edge_num
		hotspot 0,0,0,unID,radius_1,1+128 : unID=unID+1
		hotspot -cos(angle),-sin(angle),0,unID,radius_1,3 : unID=unID+1
		hotspot radius_1*cos(angle),radius_1*sin(angle),0,unID,radius_1,2 : unID=unID+1

		put dist_x, dist_y, zzyzx
		angle	= i*360/edge_num
	next i

	ruled	nsp/6, 1+4+16+64,
			get(3*edge_num),
			get(nsp)

else
	rotz beta
	roty 90-gamma

	for i=1 to edge_num
		hotspot 0,0,0,unID,radius_1,1+128 : unID=unID+1
		hotspot -cos(angle),-sin(angle),0,unID,radius_1,3 : unID=unID+1
		hotspot radius_1*cos(angle),radius_1*sin(angle),0,unID,radius_1,2 : unID=unID+1

		angle=i*360/edge_num
	next i

	pyramid nsp/3, length, 1+4+16,
			get(nsp)
	del 2
endif
