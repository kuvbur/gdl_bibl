
gs_fill_type	= gs_fill_type * gs_bFills
gs_fill_pen		= gs_fill_pen * gs_bFills
gs_back_pen		= gs_back_pen * gs_bFills

gs_fillGlass = gs_fillGlass * gs_bFills
gs_penGlass_fg = gs_penGlass_fg * gs_bFills
gs_penGlass_bg	= gs_penGlass_bg * gs_bFills

gs_fillSdl = gs_fillSdl * gs_bFills
gs_penSdl_fg = gs_penSdl_fg * gs_bFills
gs_penSdl_bg	= gs_penSdl_bg * gs_bFills

if gs_detlevel_3D_m = 0 then end
if not(gs_shadow) then shadow off

unID = 1
pen gs_cont_pen
gosub iStyle

end



! =============================================================================
! SUBRUTINES
!
! =============================================================================

! -----------------------------------------------------------------------------
! Vertical
! -----------------------------------------------------------------------------
2:
	material gs_frame_mat
	sect_fill gs_fill_type, gs_back_pen, gs_fill_pen, gs_cont_pen

	rotx 90
	addz -B
	gosub 200

	if  u <= 0 or w <= 0 then
		addz yCoordEdges[1]
		prism_ 5, -yCoordEdges[1] + yCoordEdges[2],
			xCoordFrames[1]-thickEdge/2, yCoordFrames[1]-thickEdge/2, 15,
			xCoordFrames[iNumFramesA]+thickEdge/2, yCoordFrames[1]-thickEdge/2, 15,
			xCoordFrames[iNumFramesA]+thickEdge/2, yCoordFrames[iNumFramesB]+thickEdge/2, 15,
			xCoordFrames[1]-thickEdge/2, yCoordFrames[iNumFramesB]+thickEdge/2, 15,
			xCoordFrames[1]-thickEdge/2, yCoordFrames[1]-thickEdge/2, -1

		del 1
		end
	endif



	gs_SashText_typ = `Тип 1`

	put	xCoordFrames[1]-thickEdge/2, yCoordFrames[1]-thickEdge/2, 10,
		xCoordFrames[1]+thickEdge/2, yCoordFrames[1]+thickEdge/2, 15

	if iNumFramesB > 2 then
		for kj = 2 to iNumFramesB-1
			put xCoordFrames[1]+thickEdge/2, yCoordFrames[kj]-thickFrame/2, 10,
				xCoordFrames[1]+thickEdge/2, yCoordFrames[kj]+thickFrame/2, 15
		next kj
	endif

	put	xCoordFrames[1]+thickEdge/2, yCoordFrames[iNumFramesB]-thickEdge/2, 10,
		xCoordFrames[1]-thickEdge/2, yCoordFrames[iNumFramesB]+thickEdge/2, 15,
		xCoordFrames[iNumFramesA]+thickEdge/2, yCoordFrames[1]-thickEdge/2, 10,
		xCoordFrames[iNumFramesA]-thickEdge/2, yCoordFrames[1]+thickEdge/2, 15

	if iNumFramesB > 2 then
		for kj = 2 to iNumFramesB-1
			put xCoordFrames[iNumFramesA]-thickEdge/2, yCoordFrames[kj]-thickFrame/2, 10,
				xCoordFrames[iNumFramesA]-thickEdge/2, yCoordFrames[kj]+thickFrame/2, 15
		next kj
	endif

	put	xCoordFrames[iNumFramesA]-thickEdge/2, yCoordFrames[iNumFramesB]-thickEdge/2, 10,
		xCoordFrames[iNumFramesA]+thickEdge/2, yCoordFrames[iNumFramesB]+thickEdge/2, 15,
		xCoordFrames[1]-thickEdge/2, yCoordFrames[1]-thickEdge/2, 10,
		xCoordFrames[1]+thickEdge/2, yCoordFrames[1]+thickEdge/2, 15

	if iNumFramesA > 2 then
		for ij = 2 to iNumFramesA-1
			put xCoordFrames[ij]-thickFrame/2, yCoordFrames[1]+thickEdge/2, 10,
				xCoordFrames[ij]+thickFrame/2, yCoordFrames[1]+thickEdge/2, 15
		next ij
	endif

	put	xCoordFrames[iNumFramesA]-thickEdge/2, yCoordFrames[1]+thickEdge/2, 10,
		xCoordFrames[iNumFramesA]+thickEdge/2, yCoordFrames[1]-thickEdge/2, 15,
		xCoordFrames[1]-thickEdge/2, yCoordFrames[iNumFramesB]+thickEdge/2, 10,
		xCoordFrames[1]+thickEdge/2, yCoordFrames[iNumFramesB]-thickEdge/2, 15

	if iNumFramesA > 2 then
		for ij = 2 to iNumFramesA-1
			put xCoordFrames[ij]-thickFrame/2, yCoordFrames[iNumFramesB]-thickEdge/2, 10,
				xCoordFrames[ij]+thickFrame/2, yCoordFrames[iNumFramesB]-thickEdge/2, 15
		next ij
	endif

	put	xCoordFrames[iNumFramesA]-thickEdge/2, yCoordFrames[iNumFramesB]-thickEdge/2, 10,
		xCoordFrames[iNumFramesA]+thickEdge/2, yCoordFrames[iNumFramesB]+thickEdge/2, 15

	! -------------------------------------------------------------------------

	if gs_SashText_typ = `Тип 1` then
		base

		prism_ 4+((iNumFramesB-2)*2),-yCoordEdges[1]+yCoordEdges[2],
			get ((iNumFramesB-2)*6+12)

		prism_ 4+((iNumFramesB-2)*2),-yCoordEdges[1]+yCoordEdges[2],
			get ((iNumFramesB-2)*6+12)

		vert 0, 0, 0
		vert 0, 1, 0
		vert 0, 0, 1
		vert 1, 0, 0
		coor 5, -1, -2, -3, -4
		body 1

		base

		prism_ 4+((iNumFramesA-2)*2),-yCoordEdges[1]+yCoordEdges[2],
			get ((iNumFramesA-2)*6+12)

		prism_ 4+((iNumFramesA-2)*2),-yCoordEdges[1]+yCoordEdges[2],
			get ((iNumFramesA-2)*6+12)

		vert 0, 0, 0
		vert 1, 0, 0
		vert 0, 0, 1
		vert 0, 1, 0
		coor 5, -1, -2, -3, -4
		body 1
	endif
	if gs_SashText_typ = `Тип 2` then
		base
		prism_ 6+((iNumFramesB-2)*2),-yCoordEdges[1]+yCoordEdges[2],
			xCoordFrames[1]-thickEdge/2, yCoordFrames[1]-thickEdge/2, 15,
			xCoordFrames[1]-thickEdge/2, yCoordFrames[1]+thickEdge/2, 8,
			xCoordFrames[1]+thickEdge/2, yCoordFrames[1]+thickEdge/2, 15,
			get((iNumFramesB-2)*6),
			xCoordFrames[1]+thickEdge/2, yCoordFrames[iNumFramesB]-thickEdge/2, 10,
			xCoordFrames[1]-thickEdge/2, yCoordFrames[iNumFramesB]-thickEdge/2, 13,
			xCoordFrames[1]-thickEdge/2, yCoordFrames[iNumFramesB]+thickEdge/2, 15

		prism_ 6+((iNumFramesB-2)*2),-yCoordEdges[1]+yCoordEdges[2],
			xCoordFrames[iNumFramesA]+thickEdge/2, yCoordFrames[1]-thickEdge/2, 15,
			xCoordFrames[iNumFramesA]+thickEdge/2, yCoordFrames[1]+thickEdge/2, 8,
			xCoordFrames[iNumFramesA]-thickEdge/2, yCoordFrames[1]+thickEdge/2, 15,
			get((iNumFramesB-2)*6),
			xCoordFrames[iNumFramesA]-thickEdge/2, yCoordFrames[iNumFramesB]-thickEdge/2, 10,
			xCoordFrames[iNumFramesA]+thickEdge/2, yCoordFrames[iNumFramesB]-thickEdge/2, 13,
			xCoordFrames[iNumFramesA]+thickEdge/2, yCoordFrames[iNumFramesB]+thickEdge/2, 15

		vert 0, 0, 0
		vert 0, 1, 0
		vert 0, 0, 1
		vert 1, 0, 0
		coor 5, -1, -2, -3, -4
		body 1

		base
		prism_ 6+((iNumFramesA-2)*2),-yCoordEdges[1]+yCoordEdges[2],
			xCoordFrames[1]-thickEdge/2, yCoordFrames[1]-thickEdge/2, 15,
			xCoordFrames[1]-thickEdge/2, yCoordFrames[1]+thickEdge/2, 8,
			xCoordFrames[1]+thickEdge/2, yCoordFrames[1]+thickEdge/2, 15,
			get((iNumFramesA-2)*6),
			xCoordFrames[iNumFramesA]-thickEdge/2, yCoordFrames[1]+thickEdge/2, 10,
			xCoordFrames[iNumFramesA]+thickEdge/2, yCoordFrames[1]+thickEdge/2, 13,
			xCoordFrames[iNumFramesA]+thickEdge/2, yCoordFrames[1]-thickEdge/2, 15

		prism_ 6+((iNumFramesA-2)*2),-yCoordEdges[1]+yCoordEdges[2],
			xCoordFrames[1]-thickEdge/2, yCoordFrames[iNumFramesB]+thickEdge/2, 15,
			xCoordFrames[1]-thickEdge/2, yCoordFrames[iNumFramesB]-thickEdge/2, 8,
			xCoordFrames[1]+thickEdge/2, yCoordFrames[iNumFramesB]-thickEdge/2, 15,
			get((iNumFramesA-2)*6),
			xCoordFrames[iNumFramesA]-thickEdge/2, yCoordFrames[iNumFramesB]-thickEdge/2, 10,
			xCoordFrames[iNumFramesA]+thickEdge/2, yCoordFrames[iNumFramesB]-thickEdge/2, 13,
			xCoordFrames[iNumFramesA]+thickEdge/2, yCoordFrames[iNumFramesB]+thickEdge/2, 15

		vert 0, 0, 0
		vert 1, 0, 0
		vert 0, 0, 1
		vert 0, 1, 0
		coor 5, -1, -2, -3, -4
		body 1
	endif

	! --- Both in type1 and type 2 / inner grids ---

	for ij = 2 to iNumFramesA-1
		for kj = 2 to iNumFramesB-1
			put xCoordFrames[ij]-thickFrame/2, yCoordFrames[kj]-thickFrame/2, 10,
				xCoordFrames[ij]-thickFrame/2, yCoordFrames[kj]+thickFrame/2, 15
		next kj
			put xCoordFrames[ij]-thickFrame/2, yCoordFrames[iNumFramesB]-thickEdge/2, 10,
				xCoordFrames[ij]+thickFrame/2, yCoordFrames[iNumFramesB]-thickEdge/2, 15
		for kj = iNumFramesB-1 to 2 step -1
			put xCoordFrames[ij]+thickFrame/2, yCoordFrames[kj]+thickFrame/2, 10,
				xCoordFrames[ij]+thickFrame/2, yCoordFrames[kj]-thickFrame/2, 15
		next kj
			put xCoordFrames[ij]+thickFrame/2, yCoordFrames[1]+thickEdge/2, 10,
				xCoordFrames[ij]-thickFrame/2, yCoordFrames[1]+thickEdge/2, 15
	next ij
	if iNumFramesA > 2 then parn = (nsp/3)/(iNumFramesA-2) else parn = 0
	if iNumFramesA > 2 then outst = nsp/(iNumFramesA-2) else outst = 0

	for ij = 2 to iNumFramesA-1
		base
			prism_ parn,-yCoordEdges[1]+yCoordEdges[2],
				get(outst)
		vert 0, 0, 0
		vert 0, 1, 0
		vert 0, 0, 1
		vert 1, 0, 0
		coor 5, -1, -2, -3, -4
		body 1
	next ij

	for ij = 1 to iNumFramesA-1
		if ij = 1 or ij = iNumFramesA-1 then
			if ij = 1 then
				dx1 = thickEdge
				dx2 = thickFrame
			else
				dx1 = thickFrame
				dx2 = thickEdge
			endif
		else
			dx1 = thickFrame
			dx2 = thickFrame
		endif
		for kj = 2 to iNumFramesB-1
			base
			prism_ 4,-yCoordEdges[1]+yCoordEdges[2],
				xCoordFrames[ij]+dx1/2, yCoordFrames[kj]-thickFrame/2, 10,
				xCoordFrames[ij]+dx1/2, yCoordFrames[kj]+thickFrame/2, 15,
				xCoordFrames[ij+1]-dx2/2, yCoordFrames[kj]+thickFrame/2, 10,
				xCoordFrames[ij+1]-dx2/2, yCoordFrames[kj]-thickFrame/2, 15
			vert 0, 0, 0
			vert 1, 0, 0
			vert 0, 0, 1
			vert 0, 1, 0
			coor 5, -1, -2, -3, -4
			body 1
		next kj
	next ij

	for o = 1 to iNumFramesA-1  step 1
		for e = 1 to iNumFramesB-1 step 1

			if o = 1 then
				dx1 = thickEdge
				dx2 = thickFrame
			else
				dx1 = thickFrame
				dx2 = thickFrame
			endif

			if o = iNumFramesA-1 then
				dx1 = thickFrame
				dx2 = thickEdge
			endif

			if e = 1 then
				dy1 = thickEdge
				dy2 = thickFrame
			else
				dy1 = thickFrame
				dy2 = thickFrame
			endif

			if e = iNumFramesB-1 then
				dy1 = thickFrame
				dy2 = thickEdge
			endif

			put xCoordFrames[o]+dx1/2,yCoordFrames[e]+dy1/2,15,
				xCoordFrames[o+1]-dx2/2,yCoordFrames[e]+dy1/2,15,
				xCoordFrames[o+1]-dx2/2,yCoordFrames[e+1]-dy2/2,15,
				xCoordFrames[o]+dx1/2,yCoordFrames[e+1]-dy2/2,15,
				xCoordFrames[o]+dx1/2,yCoordFrames[e]+dy1/2,-1

		next  e
	next  o

	if ifx1 = 0 then
		mask1 = 13
		mask4 = 8
	else
		mask1 = 15
		mask4 = 15
	endif

	if ifx2 = 0 then
		mask2 = 8
		mask3 = 13
	else
		mask2 = 15
		mask3 = 15
	endif

	addz yCoordEdges[1]
	body 1

	if bFilling <> 0 then

		material gs_glass_mat
		sect_fill gs_fillGlass, gs_penGlass_bg, gs_penGlass_fg, gs_cont_pen

		r = (iNumFramesA-1)*(iNumFramesB-1)

		addz (yCoordEdges[2]-yCoordEdges[1]-thickFilling)/2
		for k = 1 to r step 1
			prism_  5, thickFilling,
				get (15)
		next k
		body 1
		del 1
	endif
	del 3





return

! -----------------------------------------------------------------------------
! Horizontal
! -----------------------------------------------------------------------------
1:

	material gs_frame_mat

	sect_fill gs_fill_type, gs_back_pen, gs_fill_pen, gs_cont_pen

	if  u <= 0 or w <= 0 then
		prism_ 5, zCoordEdges[2]-zCoordEdges[1],
			xCoordFrames[1]-thickEdge/2, yCoordFrames[1]-thickEdge/2, 15,
			xCoordFrames[iNumFramesA]+thickEdge/2, yCoordFrames[1]-thickEdge/2, 15,
			xCoordFrames[iNumFramesA]+thickEdge/2, yCoordFrames[iNumFramesB]+thickEdge/2, 15,
			xCoordFrames[1]-thickEdge/2, yCoordFrames[iNumFramesB]+thickEdge/2, 15,
			xCoordFrames[1]-thickEdge/2, yCoordFrames[1]-thickEdge/2, -1
		end
	endif

	gosub 100

	gs_SashText_typ = `Тип 1`

	put	xCoordFrames[1]-thickEdge/2, yCoordFrames[1]-thickEdge/2, 10,
		xCoordFrames[1]+thickEdge/2, yCoordFrames[1]+thickEdge/2, 15

	if iNumFramesB > 2 then
		for kj = 2 to iNumFramesB-1
			put xCoordFrames[1]+thickEdge/2, yCoordFrames[kj]-thickFrame/2, 10,
				xCoordFrames[1]+thickEdge/2, yCoordFrames[kj]+thickFrame/2, 15
		next kj
	endif

	put	xCoordFrames[1]+thickEdge/2, yCoordFrames[iNumFramesB]-thickEdge/2, 10,
		xCoordFrames[1]-thickEdge/2, yCoordFrames[iNumFramesB]+thickEdge/2, 15,
		xCoordFrames[iNumFramesA]+thickEdge/2, yCoordFrames[1]-thickEdge/2, 10,
		xCoordFrames[iNumFramesA]-thickEdge/2, yCoordFrames[1]+thickEdge/2, 15

	if iNumFramesB > 2 then
		for kj = 2 to iNumFramesB-1
			put xCoordFrames[iNumFramesA]-thickEdge/2, yCoordFrames[kj]-thickFrame/2, 10,
				xCoordFrames[iNumFramesA]-thickEdge/2, yCoordFrames[kj]+thickFrame/2, 15
		next kj
	endif

	put	xCoordFrames[iNumFramesA]-thickEdge/2, yCoordFrames[iNumFramesB]-thickEdge/2, 10,
		xCoordFrames[iNumFramesA]+thickEdge/2, yCoordFrames[iNumFramesB]+thickEdge/2, 15,
		xCoordFrames[1]-thickEdge/2, yCoordFrames[1]-thickEdge/2, 10,
		xCoordFrames[1]+thickEdge/2, yCoordFrames[1]+thickEdge/2, 15

	if iNumFramesA > 2 then
		for ij = 2 to iNumFramesA-1
			put xCoordFrames[ij]-thickFrame/2, yCoordFrames[1]+thickEdge/2, 10,
				xCoordFrames[ij]+thickFrame/2, yCoordFrames[1]+thickEdge/2, 15
		next ij
	endif

	put	xCoordFrames[iNumFramesA]-thickEdge/2, yCoordFrames[1]+thickEdge/2, 10,
		xCoordFrames[iNumFramesA]+thickEdge/2, yCoordFrames[1]-thickEdge/2, 15,
		xCoordFrames[1]-thickEdge/2, yCoordFrames[iNumFramesB]+thickEdge/2, 10,
		xCoordFrames[1]+thickEdge/2, yCoordFrames[iNumFramesB]-thickEdge/2, 15

	if iNumFramesA > 2 then
		for ij = 2 to iNumFramesA-1
			put xCoordFrames[ij]-thickFrame/2, yCoordFrames[iNumFramesB]-thickEdge/2, 10,
				xCoordFrames[ij]+thickFrame/2, yCoordFrames[iNumFramesB]-thickEdge/2, 15
		next ij
	endif

	put	xCoordFrames[iNumFramesA]-thickEdge/2, yCoordFrames[iNumFramesB]-thickEdge/2, 10,
		xCoordFrames[iNumFramesA]+thickEdge/2, yCoordFrames[iNumFramesB]+thickEdge/2, 15


	! -------------------------------------------------------------------------

	if gs_SashText_typ = `Тип 1` then
		base

		prism_ 4+((iNumFramesB-2)*2),zCoordEdges[2]-zCoordEdges[1],
			get ((iNumFramesB-2)*6+12)

		prism_ 4+((iNumFramesB-2)*2),zCoordEdges[2]-zCoordEdges[1],
			get ((iNumFramesB-2)*6+12)

		vert 0, 0, 0
		vert 0, 1, 0
		vert 0, 0, 1
		vert 1, 0, 0
		coor 5, -1, -2, -3, -4
		body 1

		base

		prism_ 4+((iNumFramesA-2)*2),zCoordEdges[2]-zCoordEdges[1],
			get ((iNumFramesA-2)*6+12)

		prism_ 4+((iNumFramesA-2)*2),zCoordEdges[2]-zCoordEdges[1],
			get ((iNumFramesA-2)*6+12)

		vert 0, 0, 0
		vert 1, 0, 0
		vert 0, 0, 1
		vert 0, 1, 0
		coor 5, -1, -2, -3, -4
		body 1
	endif
	if gs_SashText_typ = `Тип 2` then
		base
		prism_ 6+((iNumFramesB-2)*2),zCoordEdges[2]-zCoordEdges[1],
			xCoordFrames[1]-thickEdge/2, yCoordFrames[1]-thickEdge/2, 15,
			xCoordFrames[1]-thickEdge/2, yCoordFrames[1]+thickEdge/2, 8,
			xCoordFrames[1]+thickEdge/2, yCoordFrames[1]+thickEdge/2, 15,
			get((iNumFramesB-2)*6),
			xCoordFrames[1]+thickEdge/2, yCoordFrames[iNumFramesB]-thickEdge/2, 10,
			xCoordFrames[1]-thickEdge/2, yCoordFrames[iNumFramesB]-thickEdge/2, 13,
			xCoordFrames[1]-thickEdge/2, yCoordFrames[iNumFramesB]+thickEdge/2, 15

		prism_ 6+((iNumFramesB-2)*2),zCoordEdges[2]-zCoordEdges[1],
			xCoordFrames[iNumFramesA]+thickEdge/2, yCoordFrames[1]-thickEdge/2, 15,
			xCoordFrames[iNumFramesA]+thickEdge/2, yCoordFrames[1]+thickEdge/2, 8,
			xCoordFrames[iNumFramesA]-thickEdge/2, yCoordFrames[1]+thickEdge/2, 15,
			get((iNumFramesB-2)*6),
			xCoordFrames[iNumFramesA]-thickEdge/2, yCoordFrames[iNumFramesB]-thickEdge/2, 10,
			xCoordFrames[iNumFramesA]+thickEdge/2, yCoordFrames[iNumFramesB]-thickEdge/2, 13,
			xCoordFrames[iNumFramesA]+thickEdge/2, yCoordFrames[iNumFramesB]+thickEdge/2, 15

		vert 0, 0, 0
		vert 0, 1, 0
		vert 0, 0, 1
		vert 1, 0, 0
		coor 5, -1, -2, -3, -4
		body 1

		base
		prism_ 6+((iNumFramesA-2)*2),zCoordEdges[2]-zCoordEdges[1],
			xCoordFrames[1]-thickEdge/2, yCoordFrames[1]-thickEdge/2, 15,
			xCoordFrames[1]-thickEdge/2, yCoordFrames[1]+thickEdge/2, 8,
			xCoordFrames[1]+thickEdge/2, yCoordFrames[1]+thickEdge/2, 15,
			get((iNumFramesA-2)*6),
			xCoordFrames[iNumFramesA]-thickEdge/2, yCoordFrames[1]+thickEdge/2, 10,
			xCoordFrames[iNumFramesA]+thickEdge/2, yCoordFrames[1]+thickEdge/2, 13,
			xCoordFrames[iNumFramesA]+thickEdge/2, yCoordFrames[1]-thickEdge/2, 15

		prism_ 6+((iNumFramesA-2)*2),zCoordEdges[2]-zCoordEdges[1],
			xCoordFrames[1]-thickEdge/2, yCoordFrames[iNumFramesB]+thickEdge/2, 15,
			xCoordFrames[1]-thickEdge/2, yCoordFrames[iNumFramesB]-thickEdge/2, 8,
			xCoordFrames[1]+thickEdge/2, yCoordFrames[iNumFramesB]-thickEdge/2, 15,
			get((iNumFramesA-2)*6),
			xCoordFrames[iNumFramesA]-thickEdge/2, yCoordFrames[iNumFramesB]-thickEdge/2, 10,
			xCoordFrames[iNumFramesA]+thickEdge/2, yCoordFrames[iNumFramesB]-thickEdge/2, 13,
			xCoordFrames[iNumFramesA]+thickEdge/2, yCoordFrames[iNumFramesB]+thickEdge/2, 15

		vert 0, 0, 0
		vert 1, 0, 0
		vert 0, 0, 1
		vert 0, 1, 0
		coor 5, -1, -2, -3, -4
		body 1
	endif

	! --- Both in type1 and type 2 / inner grids ---

	for ij = 2 to iNumFramesA-1
		for kj = 2 to iNumFramesB-1
			put xCoordFrames[ij]-thickFrame/2, yCoordFrames[kj]-thickFrame/2, 10,
				xCoordFrames[ij]-thickFrame/2, yCoordFrames[kj]+thickFrame/2, 15
		next kj
			put xCoordFrames[ij]-thickFrame/2, yCoordFrames[iNumFramesB]-thickEdge/2, 10,
				xCoordFrames[ij]+thickFrame/2, yCoordFrames[iNumFramesB]-thickEdge/2, 15
		for kj = iNumFramesB-1 to 2 step -1
			put xCoordFrames[ij]+thickFrame/2, yCoordFrames[kj]+thickFrame/2, 10,
				xCoordFrames[ij]+thickFrame/2, yCoordFrames[kj]-thickFrame/2, 15
		next kj
			put xCoordFrames[ij]+thickFrame/2, yCoordFrames[1]+thickEdge/2, 10,
				xCoordFrames[ij]-thickFrame/2, yCoordFrames[1]+thickEdge/2, 15
	next ij

	if iNumFramesA > 2 then parn = (nsp/3)/(iNumFramesA-2) else parn = 0
	if iNumFramesA > 2 then outst = nsp/(iNumFramesA-2) else outst = 0

	for ij = 2 to iNumFramesA-1
		base

		prism_ parn,zCoordEdges[2]-zCoordEdges[1],
			get(outst)

		vert 0, 0, 0
		vert 0, 1, 0
		vert 0, 0, 1
		vert 1, 0, 0
		coor 5, -1, -2, -3, -4
		body 1
	next ij


	for ij = 1 to iNumFramesA-1
		if ij = 1 or ij = iNumFramesA-1 then
			if ij = 1 then
				dx1 = thickEdge
				dx2 = thickFrame
			else
				dx1 = thickFrame
				dx2 = thickEdge
			endif
		else
			dx1 = thickFrame
			dx2 = thickFrame
		endif
		for kj = 2 to iNumFramesB-1
			base
			prism_ 4,zCoordEdges[2]-zCoordEdges[1],
				xCoordFrames[ij]+dx1/2, yCoordFrames[kj]-thickFrame/2, 10,
				xCoordFrames[ij]+dx1/2, yCoordFrames[kj]+thickFrame/2, 15,
				xCoordFrames[ij+1]-dx2/2, yCoordFrames[kj]+thickFrame/2, 10,
				xCoordFrames[ij+1]-dx2/2, yCoordFrames[kj]-thickFrame/2, 15
			vert 0, 0, 0
			vert 1, 0, 0
			vert 0, 0, 1
			vert 0, 1, 0
			coor 5, -1, -2, -3, -4
			body 1
		next kj
	next ij

	for o = 1 to iNumFramesA-1  step 1
		for e = 1 to iNumFramesB-1  step 1

			if o = 1 then
				dx1 = thickEdge
				dx2 = thickFrame
			else
				dx1 = thickFrame
				dx2 = thickFrame
			endif

			if o = iNumFramesA-1 then
				dx1 = thickFrame
				dx2 = thickEdge
			endif

			if e = 1 then
				dy1 = thickEdge
				dy2 = thickFrame
			else
				dy1 = thickFrame
				dy2 = thickFrame
			endif

			if e = iNumFramesB-1 then
				dy1 = thickFrame
				dy2 = thickEdge
			endif

			put xCoordFrames[o]+dx1/2,yCoordFrames[e]+dy1/2,15,
				xCoordFrames[o+1]-dx2/2,yCoordFrames[e]+dy1/2,15,
				xCoordFrames[o+1]-dx2/2,yCoordFrames[e+1]-dy2/2,15,
				xCoordFrames[o]+dx1/2,yCoordFrames[e+1]-dy2/2,15,
				xCoordFrames[o]+dx1/2,yCoordFrames[e]+dy1/2,-1

		next  e
	next  o

	body 1

	if bFilling <> 0 then

		material gs_glass_mat
		sect_fill gs_fillGlass, gs_penGlass_bg, gs_penGlass_fg, gs_cont_pen

		r = (iNumFramesA-1)*(iNumFramesB-1)

		addz (zCoordEdges[2]-zCoordEdges[1]-thickFilling)/2
		for k = 1 to r step 1
			prism_  5,thickFilling,
				get (15)
		next  k
		del 1

	endif

return

! -----------------------------------------------------------------------------
! hotspot editing for Horizontal
! -----------------------------------------------------------------------------

100:

	for k0 = 1 to 2
		for k1 = 1 to 2
			hotspot 0,    yCoordEdges[k1],zCoordEdges[k0],unID,a,1+256:unID=unID+1
			hotspot -1,   yCoordEdges[k1],zCoordEdges[k0],unID,a,3    :unID=unID+1
			hotspot a,    yCoordEdges[k1],zCoordEdges[k0],unID,a,2    :unID=unID+1
		next k1
	next k0

	for k0 = 1 to 2
		for k1 = 1 to 2
			hotspot a*(k1-1),0,zCoordEdges[k0],unID,b,1+128:unID=unID+1
			hotspot a*(k1-1),-1,zCoordEdges[k0],unID,b,3    :unID=unID+1
			hotspot a*(k1-1),b,zCoordEdges[k0],unID,b,2    :unID=unID+1
		next k1
	next k0

	for k0 = 1 to 2
		for k1 = 1 to 2
			hotspot xCoordEdges[k1],yCoordEdges[k0],0,unID,ZZYZX,1+256:unID=unID+1
			hotspot xCoordEdges[k1],yCoordEdges[k0],-1,unID,ZZYZX,3    :unID=unID+1
			hotspot xCoordEdges[k1],yCoordEdges[k0],ZZYZX,unID,ZZYZX,2    :unID=unID+1
		next k1
	next k0

	xCoordFrames[1] = xCoordEdges[1] + thickEdge/2
	xCoordFrames[iNumFramesA] = xCoordEdges[2] - thickEdge/2
	yCoordFrames[1] = yCoordEdges[1] + thickEdge/2
	yCoordFrames[iNumFramesB] = yCoordEdges[2] - thickEdge/2

	for k = 2 to iNumFramesA-1
		hotspot 0,yCoordFrames[1],(zCoordEdges[2]-zCoordEdges[1])/2,unID,  xCoordFrames[k], 1+128 :unID=unID+1
		hotspot -1,yCoordFrames[1],(zCoordEdges[2]-zCoordEdges[1])/2, unID, xCoordFrames[k], 3   :unID=unID+1
		hotspot xCoordFrames[k],yCoordFrames[1],(zCoordEdges[2]-zCoordEdges[1])/2, unID,  xCoordFrames[k], 2   :unID=unID+1

		hotspot 0,yCoordFrames[iNumFramesB],(zCoordEdges[2]-zCoordEdges[1])/2,    unID,  xCoordFrames[k], 1+128 :unID=unID+1
		hotspot -1,yCoordFrames[iNumFramesB],(zCoordEdges[2]-zCoordEdges[1])/2,   unID, xCoordFrames[k], 3   :unID=unID+1
		hotspot xCoordFrames[k],yCoordFrames[iNumFramesB],(zCoordEdges[2]-zCoordEdges[1])/2,unID,  xCoordFrames[k], 2   :unID=unID+1
	next k

	for k = 2 to iNumFramesB-1
		hotspot xCoordFrames[1],0,(zCoordEdges[2]-zCoordEdges[1])/2, unID,  yCoordFrames[k], 1+128 :unID=unID+1
		hotspot xCoordFrames[1],-1,(zCoordEdges[2]-zCoordEdges[1])/2, unID, yCoordFrames[k], 3   :unID=unID+1
		hotspot xCoordFrames[1],yCoordFrames[k],(zCoordEdges[2]-zCoordEdges[1])/2, unID,  yCoordFrames[k], 2   :unID=unID+1

		hotspot xCoordFrames[iNumFramesA],0,(zCoordEdges[2]-zCoordEdges[1])/2, unID,  yCoordFrames[k], 1+128 :unID=unID+1
		hotspot xCoordFrames[iNumFramesA],-1,(zCoordEdges[2]-zCoordEdges[1])/2, unID, yCoordFrames[k], 3   :unID=unID+1
		hotspot xCoordFrames[iNumFramesA],yCoordFrames[k],(zCoordEdges[2]-zCoordEdges[1])/2, unID,  yCoordFrames[k], 2   :unID=unID+1
	next k

return


! -----------------------------------------------------------------------------
! hotspot editing for Vertical
! -----------------------------------------------------------------------------
200:



	for k0 = 1 to 2
		for k1 = 1 to 2
			hotspot 0,  zCoordEdges[k0],    yCoordEdges[k1],  unID,    a, 1+256 :unID=unID+1
			hotspot -1, zCoordEdges[k0],    yCoordEdges[k1],  unID,    a, 3   :unID=unID+1
			hotspot a,  zCoordEdges[k0],    yCoordEdges[k1],  unID,    a, 2   :unID=unID+1
		next k1
	next k0

	addy ZZYZX
	muly -1
	for k0 = 1 to 2
		for k1 = 1 to 2
			hotspot a*(k0-1),     0,       yCoordEdges[k1],   unID,  ZZYZX, 1+256 :unID=unID+1
			hotspot a*(k0-1),    -1,      yCoordEdges[k1],   unID,  ZZYZX, 3   :unID=unID+1
			hotspot a*(k0-1), ZZYZX,   yCoordEdges[k1],   unID,  ZZYZX, 2   :unID=unID+1
		next k1
	next k0
	del 2

	for k0 = 1 to 2
		for k1 = 1 to 2
			hotspot a*(k1-1), ZZYZX, 0,     unID,   b, 1+256 :unID=unID+1
			hotspot a*(k1-1), ZZYZX, -1,    unID,   b, 3   :unID=unID+1
			hotspot a*(k1-1), ZZYZX, b,     unID,   b, 2   :unID=unID+1
		next k1
	next k0


	xCoordFrames[1] = xCoordEdges[1] + thickEdge/2
	xCoordFrames[iNumFramesA] = xCoordEdges[2] - thickEdge/2
	yCoordFrames[1] = zCoordEdges[1] + thickEdge/2
	yCoordFrames[iNumFramesB] = zCoordEdges[2] - thickEdge/2

	for k = 2 to iNumFramesA-1
		hotspot 0,    yCoordFrames[1],(yCoordEdges[1]+yCoordEdges[2])/2, unID,  xCoordFrames[k], 1+128 :unID=unID+1
		hotspot -1,   yCoordFrames[1],(yCoordEdges[1]+yCoordEdges[2])/2, unID,  xCoordFrames[k], 3   :unID=unID+1
		hotspot xCoordFrames[k],yCoordFrames[1],(yCoordEdges[1]+yCoordEdges[2])/2, unID,  xCoordFrames[k], 2   :unID=unID+1

		hotspot 0,    yCoordFrames[iNumFramesB],(yCoordEdges[1]+yCoordEdges[2])/2, unID,  xCoordFrames[k], 1+128 :unID=unID+1
		hotspot -1,   yCoordFrames[iNumFramesB],(yCoordEdges[1]+yCoordEdges[2])/2, unID,  xCoordFrames[k], 3   :unID=unID+1
		hotspot xCoordFrames[k],yCoordFrames[iNumFramesB],(yCoordEdges[1]+yCoordEdges[2])/2, unID,  xCoordFrames[k], 2   :unID=unID+1
	next k

	for k = 2 to iNumFramesB-1
		hotspot xCoordFrames[1],    0,(yCoordEdges[1]+yCoordEdges[2])/2, unID,  yCoordFrames[k], 1+128 :unID=unID+1
		hotspot xCoordFrames[1],   -1,(yCoordEdges[1]+yCoordEdges[2])/2, unID,  yCoordFrames[k], 3     :unID=unID+1
		hotspot xCoordFrames[1],yCoordFrames[k],(yCoordEdges[1]+yCoordEdges[2])/2, unID,  yCoordFrames[k], 2     :unID=unID+1

		hotspot xCoordFrames[iNumFramesA],    0,(yCoordEdges[1]+yCoordEdges[2])/2, unID,  yCoordFrames[k], 1+128 :unID=unID+1
		hotspot xCoordFrames[iNumFramesA],   -1,(yCoordEdges[1]+yCoordEdges[2])/2, unID,  yCoordFrames[k], 3     :unID=unID+1
		hotspot xCoordFrames[iNumFramesA],yCoordFrames[k],(yCoordEdges[1]+yCoordEdges[2])/2, unID,  yCoordFrames[k], 2     :unID=unID+1
	next k

return

