
!project2 3,270,1
unID = 1
LINE_TYPE gs_line_type
PEN gs_cont_pen
FILL gs_fill_type

!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!2D MITRESS1_GUTTER_BODY!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!


	POLY2_B 4, 1+2+4+64, gs_fill_pen, gs_back_pen,
		0,					  										 gs_gutter_p_w/2,	 1,
		gs_gutter_lgth1,											 gs_gutter_p_w/2,	 1,
		gs_gutter_lgth1+gs_gutter_p_w * TAN(gs_gutter_endcap1_ang),	-gs_gutter_p_w/2,	 1,
		0,															-gs_gutter_p_w/2,	 0

	LGTH = -gs_gutter_lgth1/COS(slope_ang1) - ABS(gs_gutter_p_h*TAN(slope_ang1))

	IF L_ANG 					< 0 THEN LGTH = LGTH + gs_gutter_p_w * TAN(L_ANG)
	IF gs_gutter_endcap1_ang 	> 0 THEN LGTH = LGTH - gs_gutter_p_w * TAN(gs_gutter_endcap1_ang)


IF gs_gutter_mitress_ang > 180 THEN
	POLY2_B 3, 1+2+4+64, gs_fill_pen, gs_back_pen, 	0,	  gs_gutter_p_w/2,	 1, 	-L,	  gs_gutter_p_w/2,	 1, 	0,	 -gs_gutter_p_w/2,	 0								!!Corner of the Miter!!
ELSE
	POLY2_B 3, 1+2+4+64, gs_fill_pen, gs_back_pen, 	0,	  gs_gutter_p_w/2,	 1, 	-L,	 -gs_gutter_p_w/2,	 1, 	0,	 -gs_gutter_p_w/2,	 0								!!Corner of the Miter!!
ENDIF

!!2D DOWNSPOUT_HOLE!!
IF gs_gutter_downspout1 THEN
	CALL "m_DSProfiles" PARAMETERS gs_gutter_ds_profile_num=gs_gutter_g_ds_profile_num, gs_mask=0, gs_gutter_aa=gs_gutter_aa, gs_gutter_bb=gs_gutter_bb, gs_gutter_dd=gs_gutter_dd

	!!2D Body DownSpout_Hole 1!!
	IF gs_gutter_g_ds_profile_num = 1 THEN
	   ADD2 gs_gutter_downspout_x_pos1 + gs_gutter_dd, gs_gutter_downspout_y_pos1
	ELSE
	   ADD2 gs_gutter_downspout_x_pos1 + gs_gutter_aa, gs_gutter_downspout_y_pos1
	ENDIF

		POLY2_B nsp/3, 1+2+4+64, gs_fill_pen, gs_back_pen, use (nsp)
	DEL 1

	if iDownspoutProfile = DOWNSPOUT_ROUND | iDownspoutProfile = DOWNSPOUT_ROUND_3 | iDownspoutProfile = DOWNSPOUT_ROUND_4 then													!!2D HOTSPOTs DownSpout_Hole!!
		AAA= gs_gutter_dd	: BBB= 0			: GOSUB 1																								!!2D HOTSPOTs DownSpout_HOle - Round Profile!!
		AAA= gs_gutter_dd	: BBB= gs_gutter_dd	: GOSUB 1
		AAA= gs_gutter_dd	: BBB=-gs_gutter_dd	: GOSUB 1
		AAA= 0				: BBB= 0			: GOSUB 1
		AAA= 2*gs_gutter_dd	: BBB= 0			: GOSUB 1
	else																																!!2D HOTSPOTs DownSpout_HOle - NOT_Round Profile!!
		AAA= gs_gutter_aa	: BBB= 0			: GOSUB 1
		AAA= 2*gs_gutter_aa	: BBB= gs_gutter_bb	: GOSUB 1
		AAA= 2*gs_gutter_aa	: BBB=-gs_gutter_bb	: GOSUB 1
		AAA= 0				: BBB= gs_gutter_bb	: GOSUB 1
		AAA= 0				: BBB=-gs_gutter_bb	: GOSUB 1
	endif
ENDIF


!!2D GUTTER_HANGER - hotspots/'body'!!
IF gs_gutter_hanger1 THEN
	IF gs_gutter_hanger_positioning1 = HANGER_UNIFORM THEN
		FOR i=1 TO INT((gs_gutter_lgth1+R_END1-gs_gutter_hanger_off1-sthw)/gs_gutter_hanger_dist1)+1												!!2D HOTSPOTs HANGER POSITION!!
				HOTSPOT2  sthw/2,							0, unID, gs_gutter_hanger_pos1[i], 1+128	:unID=unID+1 !!base
				HOTSPOT2 -100,								0, unID, gs_gutter_hanger_pos1[i], 3		:unID=unID+1 !!lgth ref
				HOTSPOT2  gs_gutter_hanger_pos1[i],	0, unID, gs_gutter_hanger_pos1[i], 2		:unID=unID+1 !!lgth mov
	
			ADD2 gs_gutter_hanger_pos1[i] - sthw/2,0																									!!GUTTER HANGERs 2D Body!!
				CALL "m_GutterHanger" PARAMETERS gs_gutter_p_num=gs_gutter_p_num, gs_gutter_p_w=gs_gutter_p_w, gs_gutter_p_h=gs_gutter_p_h, gs_gutter_p_r=gs_gutter_p_r,
										gs_detlevel_3D_m=gs_detlevel_3D_m, gs_resol=gs_resol, gs_shadow=gs_shadow, gs_line_type=gs_line_type,
										gs_cont_pen=gs_cont_pen, gs_fill_type=gs_fill_type, gs_fill_pen=gs_fill_pen, gs_back_pen=gs_back_pen,
										gs_gutter_hanger_mat=gs_gutter_hanger_mat
	!									gs_gutter_slope=gs_gutter_slope
			DEL 1
		NEXT i

	ELSE
		FOR i=1 TO hangeri1												!!2D HOTSPOTs HANGER POSITION!!
				HOTSPOT2  sthw/2,							0, unID, gs_gutter_hanger_pos1[i], 1+128	:unID=unID+1 !!base
				HOTSPOT2 -100,								0, unID, gs_gutter_hanger_pos1[i], 3		:unID=unID+1 !!lgth ref
				HOTSPOT2  gs_gutter_hanger_pos1[i],	0, unID, gs_gutter_hanger_pos1[i], 2		:unID=unID+1 !!lgth mov
	
			ADD2 gs_gutter_hanger_pos1[i] - sthw/2,0																									!!GUTTER HANGERs 2D Body!!
				CALL "m_GutterHanger" PARAMETERS gs_gutter_p_num=gs_gutter_p_num, gs_gutter_p_w=gs_gutter_p_w, gs_gutter_p_h=gs_gutter_p_h, gs_gutter_p_r=gs_gutter_p_r,
										gs_detlevel_3D_m=gs_detlevel_3D_m, gs_resol=gs_resol, gs_shadow=gs_shadow, gs_line_type=gs_line_type,
										gs_cont_pen=gs_cont_pen, gs_fill_type=gs_fill_type, gs_fill_pen=gs_fill_pen, gs_back_pen=gs_back_pen,
										gs_gutter_hanger_mat=gs_gutter_hanger_mat
	!									gs_gutter_slope=gs_gutter_slope
			DEL 1
		NEXT i
	ENDIF
ENDIF

!!2D HOTSPOTs GUTTER BODY - [4 corner]!!
HOTSPOT2  0,				 gs_gutter_p_w/2,	unID,	gs_gutter_lgth1,	1+256	:unID=unID+1 !!base
HOTSPOT2 -1,				 gs_gutter_p_w/2,	unID,	gs_gutter_lgth1,	3		:unID=unID+1 !!lgth ref
HOTSPOT2  gs_gutter_lgth1,	 gs_gutter_p_w/2,	unID,	gs_gutter_lgth1,	2		:unID=unID+1 !!lgth mov

!HOTSPOT2  0,				-gs_gutter_p_w/2,	unID,	gs_gutter_lgth1,	1+256	:unID=unID+1 !!base
!HOTSPOT2 -1,				-gs_gutter_p_w/2,	unID,	gs_gutter_lgth1,	3		:unID=unID+1 !!lgth ref
!HOTSPOT2  gs_gutter_lgth1,	-gs_gutter_p_w/2,	unID,	gs_gutter_lgth1,	2		:unID=unID+1 !!lgth mov

HOTSPOT2  gs_gutter_p_w/2 * TAN(L_ANG),										0,	unID	:unID=unID+1											!!Left Middle!!
HOTSPOT2  gs_gutter_lgth1 + gs_gutter_p_w/2 * TAN(gs_gutter_endcap1_ang),	0,	unID	:unID=unID+1											!!Rigth Middle!!

HOTSPOT2  gs_gutter_p_w * TAN(L_ANG),									-gs_gutter_p_w/2,	unID	:unID=unID+1								!!Left End!!
HOTSPOT2  gs_gutter_lgth1 + gs_gutter_p_w * TAN(gs_gutter_endcap1_ang),	-gs_gutter_p_w/2,	unID	:unID=unID+1								!!Rigth End!!


!!2D HOTLINE GUTTER BODY!!
HOTLINE2  0,				 0,					gs_gutter_lgth1,	 	 0																		!!CenterLine - not visible!!
HOTLINE2  0, gs_gutter_p_w/2, gs_gutter_lgth1, gs_gutter_p_w/2																					!!Length lines!!
HOTLINE2  gs_gutter_p_w * TAN(gs_gutter_endcap1_ang), -gs_gutter_p_w/2, gs_gutter_lgth1 + gs_gutter_p_w * TAN(gs_gutter_endcap1_ang), -gs_gutter_p_w/2
HOTLINE2  gs_gutter_lgth1 + gs_gutter_p_w * TAN(gs_gutter_endcap1_ang),	-gs_gutter_p_w/2,	gs_gutter_lgth1,		 gs_gutter_p_w/2			!!Width lines!!
HOTLINE2  gs_gutter_p_w * TAN(gs_gutter_endcap1_ang), -gs_gutter_p_w/2, 0, gs_gutter_p_w/2


GOSUB 3

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!MITRESS2_GUTTER BODY 3D - w/ hole [is cut by Downspout]!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
IF gs_gutter_mitress_ang < 180 THEN																		!!   0 < MITRESS_ANGLE < 180!!
	ADD2 -gs_gutter_p_w/2 * SIN(gs_gutter_mitress_ang), gs_gutter_p_w/2 * (1+COS(gs_gutter_mitress_ang))
	ROT2 gs_gutter_mitress_ang
	MUL2 1,-1
ELSE																										!! 180 < MITRESS_ANGLE < 360!!
	ADD2 gs_gutter_p_w/2 * SIN(gs_gutter_mitress_ang), -gs_gutter_p_w/2 * (1+COS(gs_gutter_mitress_ang))
	ROT2 gs_gutter_mitress_ang
	MUL2 1,-1
ENDIF


	!!2D MITRESS2_GUTTER_BODY!!
		POLY2_B 4, 1+2+4+64, gs_fill_pen, gs_back_pen,
			0,															 gs_gutter_p_w/2,	 1,
			gs_gutter_lgth2,	  										 gs_gutter_p_w/2,	 1,
			gs_gutter_lgth2+gs_gutter_p_w * TAN(gs_gutter_endcap2_ang),	-gs_gutter_p_w/2,	 1,
			0,															-gs_gutter_p_w/2, 	 0

	IF L_ANG 					< 0 THEN LGTH = LGTH + gs_gutter_p_w * TAN(L_ANG)
	IF gs_gutter_endcap2_ang 	> 0 THEN LGTH = LGTH - gs_gutter_p_w * TAN(gs_gutter_endcap2_ang)

	IF gs_gutter_mitress_ang > 180 THEN
		POLY2_B 3, 1+2+4+64, gs_fill_pen, gs_back_pen, 0,	  gs_gutter_p_w/2,	 1, 	-L,	  gs_gutter_p_w/2,	 1, 	0,	 -gs_gutter_p_w/2,	 0								!!Corner of the Miter!!
	ELSE
		POLY2_B 3, 1+2+4+64, gs_fill_pen, gs_back_pen, 0,	  gs_gutter_p_w/2,	 1, 	-L,	 -gs_gutter_p_w/2,	 1, 	0,	 -gs_gutter_p_w/2,	 0								!!Corner of the Miter!!
	ENDIF


	!!2D DOWNSPOUT_HOLE!!
	IF gs_gutter_downspout2 THEN
	CALL "m_DSProfiles" PARAMETERS gs_gutter_ds_profile_num=gs_gutter_g_ds_profile_num, gs_mask=0, gs_gutter_aa=gs_gutter_aa, gs_gutter_bb=gs_gutter_bb, gs_gutter_dd=gs_gutter_dd

		!!2D Body DownSpout_Hole 2!!
		IF gs_gutter_g_ds_profile_num = 1 THEN
		   ADD2 gs_gutter_downspout_x_pos2 + gs_gutter_dd, gs_gutter_downspout_y_pos2
		ELSE
		   ADD2 gs_gutter_downspout_x_pos2 + gs_gutter_aa, gs_gutter_downspout_y_pos2
		ENDIF

			POLY2_B nsp/3, 1+2+4+64, gs_fill_pen, gs_back_pen, use (nsp)
		DEL 1

		if iDownspoutProfile = DOWNSPOUT_ROUND | iDownspoutProfile = DOWNSPOUT_ROUND_3 | iDownspoutProfile = DOWNSPOUT_ROUND_4 then													!!2D HOTSPOTs DownSpout_Hole!!
			AAA= gs_gutter_dd	: BBB= 0			: GOSUB 2																				!!2D HOTSPOTs DownSpout_HOle - Round Profile!!
			AAA= gs_gutter_dd	: BBB= gs_gutter_dd	: GOSUB 2
			AAA= gs_gutter_dd	: BBB=-gs_gutter_dd	: GOSUB 2
			AAA= 0				: BBB= 0			: GOSUB 2
			AAA= 2*gs_gutter_dd	: BBB= 0			: GOSUB 2
		else																																!!2D HOTSPOTs DownSpout_HOle - NOT_Round Profile!!
			AAA= gs_gutter_aa	: BBB= 0			: GOSUB 2
			AAA= 2*gs_gutter_aa	: BBB= gs_gutter_bb	: GOSUB 2
			AAA= 2*gs_gutter_aa	: BBB=-gs_gutter_bb	: GOSUB 2
			AAA= 0				: BBB= gs_gutter_bb	: GOSUB 2
			AAA= 0				: BBB=-gs_gutter_bb	: GOSUB 2
		endif
	ENDIF


	!!2D GUTTER_HANGER - hotspots/'body'!!
	IF gs_gutter_hanger2 THEN
		IF gs_gutter_hanger_positioning2 = HANGER_UNIFORM THEN
			FOR i=1 TO INT((gs_gutter_lgth2+R_END2-gs_gutter_hanger_off2-sthw)/gs_gutter_hanger_dist2)+1												!!2D HOTSPOTs HANGER POSITION!!
					HOTSPOT2  sthw/2,							0, unID, gs_gutter_hanger_pos2[i], 1+128	:unID=unID+1 !!base
					HOTSPOT2 -100,								0, unID, gs_gutter_hanger_pos2[i], 3		:unID=unID+1 !!lgth ref
					HOTSPOT2  gs_gutter_hanger_pos2[i],	0, unID, gs_gutter_hanger_pos2[i], 2		:unID=unID+1 !!lgth mov
	
				ADD2 gs_gutter_hanger_pos2[i] - sthw/2,0																									!!GUTTER HANGERs 2D Body!!
				CALL "m_GutterHanger" PARAMETERS gs_gutter_p_num=gs_gutter_p_num, gs_gutter_p_w=gs_gutter_p_w, gs_gutter_p_h=gs_gutter_p_h, gs_gutter_p_r=gs_gutter_p_r,
										gs_detlevel_3D_m=gs_detlevel_3D_m, gs_resol=gs_resol, gs_shadow=gs_shadow, gs_line_type=gs_line_type,
										gs_cont_pen=gs_cont_pen, gs_fill_type=gs_fill_type, gs_fill_pen=gs_fill_pen, gs_back_pen=gs_back_pen,
										gs_gutter_hanger_mat=gs_gutter_hanger_mat
				DEL 1
			NEXT i
		ELSE
			FOR i=1 TO hangeri2											!!2D HOTSPOTs HANGER POSITION!!
					HOTSPOT2  sthw/2,							0, unID, gs_gutter_hanger_pos2[i], 1+128	:unID=unID+1 !!base
					HOTSPOT2 -100,								0, unID, gs_gutter_hanger_pos2[i], 3		:unID=unID+1 !!lgth ref
					HOTSPOT2  gs_gutter_hanger_pos2[i],	0, unID, gs_gutter_hanger_pos2[i], 2		:unID=unID+1 !!lgth mov
	
				ADD2 gs_gutter_hanger_pos2[i] - sthw/2,0																									!!GUTTER HANGERs 2D Body!!
				CALL "m_GutterHanger" PARAMETERS gs_gutter_p_num=gs_gutter_p_num, gs_gutter_p_w=gs_gutter_p_w, gs_gutter_p_h=gs_gutter_p_h, gs_gutter_p_r=gs_gutter_p_r,
										gs_detlevel_3D_m=gs_detlevel_3D_m, gs_resol=gs_resol, gs_shadow=gs_shadow, gs_line_type=gs_line_type,
										gs_cont_pen=gs_cont_pen, gs_fill_type=gs_fill_type, gs_fill_pen=gs_fill_pen, gs_back_pen=gs_back_pen,
										gs_gutter_hanger_mat=gs_gutter_hanger_mat
				DEL 1
			NEXT i
		ENDIF
	ENDIF


	!!2D HOTSPOTs GUTTER BODY - [4 corner]!!
	HOTSPOT2  0,				 gs_gutter_p_w/2,	unID,	gs_gutter_lgth2,	1+256	:unID=unID+1 !!base
	HOTSPOT2 -1,				 gs_gutter_p_w/2,	unID,	gs_gutter_lgth2,	3		:unID=unID+1 !!lgth ref
	HOTSPOT2  gs_gutter_lgth2,	 gs_gutter_p_w/2,	unID,	gs_gutter_lgth2,	2		:unID=unID+1 !!lgth mov

!	HOTSPOT2  0,				-gs_gutter_p_w/2,	unID,	gs_gutter_lgth2,	1+256	:unID=unID+1 !!base
!	HOTSPOT2 -1,				-gs_gutter_p_w/2,	unID,	gs_gutter_lgth2,	3		:unID=unID+1 !!lgth ref
!	HOTSPOT2  gs_gutter_lgth2,	-gs_gutter_p_w/2,	unID,	gs_gutter_lgth2,	2		:unID=unID+1 !!lgth mov

	HOTSPOT2  gs_gutter_p_w/2 * TAN(L_ANG),										0,				unID	:unID=unID+1							!!Left Middle!!
	HOTSPOT2  gs_gutter_lgth2 + gs_gutter_p_w/2 * TAN(gs_gutter_endcap2_ang),	0,				unID	:unID=unID+1							!!Rigth Middle!!

	HOTSPOT2  gs_gutter_p_w * TAN(L_ANG),									-gs_gutter_p_w/2,	unID	:unID=unID+1							!!Left End!!
	HOTSPOT2  gs_gutter_lgth2 + gs_gutter_p_w * TAN(gs_gutter_endcap2_ang),	-gs_gutter_p_w/2,	unID	:unID=unID+1							!!Rigth End!!

	!!2D HOTLINE GUTTER BODY!!
	HOTLINE2  0,				 0,					gs_gutter_lgth2,	 	 0																	!!CenterLine - not visible!!
	HOTLINE2  0, gs_gutter_p_w/2, gs_gutter_lgth2, gs_gutter_p_w/2																				!!Length lines!!
	HOTLINE2  gs_gutter_p_w * TAN(gs_gutter_endcap2_ang), -gs_gutter_p_w/2, gs_gutter_lgth2 + gs_gutter_p_w * TAN(gs_gutter_endcap2_ang), -gs_gutter_p_w/2
	HOTLINE2  gs_gutter_lgth2 + gs_gutter_p_w * TAN(gs_gutter_endcap2_ang),	-gs_gutter_p_w/2,	gs_gutter_lgth2,		 gs_gutter_p_w/2			!!Width lines!!
	HOTLINE2  gs_gutter_p_w * TAN(gs_gutter_endcap2_ang), -gs_gutter_p_w/2, 0, gs_gutter_p_w/2
DEL 3

GOSUB 3

END


1: !!2D HOTSPOTs DOWNSPOUT_HOLE Position!!
	HOTSPOT2 AAA,							 BBB,		unID,	gs_gutter_downspout_x_pos1,	1+128:	unID=unID+1 !!base
	HOTSPOT2 AAA-1,							 BBB,		unID,	gs_gutter_downspout_x_pos1,	3:		unID=unID+1 !!lgth ref
	HOTSPOT2 AAA+gs_gutter_downspout_x_pos1, BBB,		unID,	gs_gutter_downspout_x_pos1,	2:		unID=unID+1 !!lgth mov
RETURN

2: !!2D HOTSPOTs DOWNSPOUT_HOLE Position!!
	HOTSPOT2 AAA,							 BBB,		unID,	gs_gutter_downspout_x_pos2,	1+128:	unID=unID+1 !!base
	HOTSPOT2 AAA-1,							 BBB,		unID,	gs_gutter_downspout_x_pos2,	3:		unID=unID+1 !!lgth ref
	HOTSPOT2 AAA+gs_gutter_downspout_x_pos2, BBB,		unID,	gs_gutter_downspout_x_pos2,	2:		unID=unID+1 !!lgth mov
RETURN

3: !!flush buffer!!
	FOR i=1 TO nsp
		temp = get(1)
	NEXT i
RETURN

