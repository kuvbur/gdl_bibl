
! Projector Screen

lod3D = 0												! Don't draw anything
if gs_detlevel_3D_m = DLEV3D_SIMPLE then lod3D = 1 			! Simple
if gs_detlevel_3D_m = DLEV3D_DETAILED then lod3D = 2 			! Detailed
if GLOB_CONTEXT > 20 & GLOB_CONTEXT < 40 then lod3D	= 1	! Simple
if lod3D = 1 then gs_resol = 8

IF gs_shadow=0 THEN SHADOW OFF

if lod3D = 0 then end

pen gs_cont_pen
resol gs_resol



! --- Top frame ----------------------------------------------------------------

if iScreenType = SCREEN_WALLMOUNT then
	material matStand
	add A/2, r02, ZZYZX-3*r03
	rotz -90
	rotx 90
	prism_ 7, A,
		0, 0, 15,
		r03-r03/8, 0, 15,
		r03-r03/8, r03/2, 15,
		r03, r03/2, 15,
		r03, 3*r03, 15,
		0, 3*r03, 15,
		0, 0, -1
	del 3
else
	material matFrame
	if lod3D = 1 then
		add -A/2, 0, ZZYZX-4*r02
		roty 90
		prism_ 5, A,
			-r02, -r02, 15,
			r02, -r02, 15,
			r02, r02, 15,
			-r02, r02, 15,
			-r02, -r02, -1
		del 2
	endif
	if lod3D = 2 then
		add -(A-2*r04)/2, 0, ZZYZX-4*r02
		roty 90
		prism_ 9, A-2*r04,
			r02, r02*tan(22.5), 15,
			r02*tan(22.5), r02, 15,
			-r02*tan(22.5), r02, 15,
			-r02, r02*tan(22.5), 15,
			-r02, -r02*tan(22.5), 15,
			-r02*tan(22.5), -r02, 15,
			r02*tan(22.5), -r02, 15,
			r02, -r02*tan(22.5), 15,
			r02, r02*tan(22.5), -1
		del 2

		for hi = 1 to 2
			add -A/2, 0, ZZYZX-4*r02
			roty 90
			prism_ 9, r04,
				r05, r05*tan(22.5), 15,
				r05*tan(22.5), r05, 15,
				-r05*tan(22.5), r05, 15,
				-r05, r05*tan(22.5), 15,
				-r05, -r05*tan(22.5), 15,
				-r05*tan(22.5), -r05, 15,
				r05*tan(22.5), -r05, 15,
				r05, -r05*tan(22.5), 15,
				r05, r05*tan(22.5), -1
			del 2
		addx A-r04
		next hi
		del 2
	endif
endif


! --- Bottom Frame -------------------------------------------------------------

material matFrame

if iScreenType = SCREEN_FLOORMOUNT then addz r09+r03*tan(22.5)*0+r03
if iScreenType = SCREEN_TRIPOD then addz ZZYZX-5*r02-min((A-2*r04),(ZZYZX-5*r02-0.5-2*r03))-r03
if iScreenType = SCREEN_WALLMOUNT then addz 3*r02

if iScreenType = SCREEN_WALLMOUNT then
	if lod3D = 1 then
		add -A/2, 0, 0
		roty 90
		prism_ 5, A,
			-r02, -r02, 15,
			r02, -r02, 15,
			r02, r02, 15,
			-r02, r02, 15,
			-r02, -r02, -1
		del 2
	endif
	if lod3D = 2 then
		material matFrame
		add -(A-2*r04)/2, 0, 0
		roty 90
		prism_ 9, A-2*r04,
			r02, r02*tan(22.5), 15,
			r02*tan(22.5), r02, 15,
			-r02*tan(22.5), r02, 15,
			-r02, r02*tan(22.5), 15,
			-r02, -r02*tan(22.5), 15,
			-r02*tan(22.5), -r02, 15,
			r02*tan(22.5), -r02, 15,
			r02, -r02*tan(22.5), 15,
			r02, r02*tan(22.5), -1
		del 2

		for hi = 1 to 2
			add -A/2, 0, 0
			roty 90
			prism_ 9, r04,
				r05, r05*tan(22.5), 15,
				r05*tan(22.5), r05, 15,
				-r05*tan(22.5), r05, 15,
				-r05, r05*tan(22.5), 15,
				-r05, -r05*tan(22.5), 15,
				-r05*tan(22.5), -r05, 15,
				r05*tan(22.5), -r05, 15,
				r05, -r05*tan(22.5), 15,
				r05, r05*tan(22.5), -1
			del 2
		addx A-r04
		next hi
		del 2

		material matStand
		add 0, 0.0015, -3*r02
		rotx 90
		prism_ 9, 0.003,
			-r02-0.0015, 2*r02, 15,
			-r02-0.0015, r02+0.0015, 15+64,
			r02+0.0015, r02+0.0015, 1015+64,
			r02+0.0015, 2*r02, 15,
			r02-0.0015, 2*r02, 15,
			r02-0.0015, r02+0.0015, 15+64,
			-r02+0.0015, r02+0.0015, 1015+64,
			-r02+0.0015, 2*r02, 15,
			-r02-0.0015, 2*r02, -1
		del 2
	endif
else
	if lod3D = 1 then
		add -A/2, 0, 0
		rotx 90
		roty 90
		prism_ 5, A,
			r01/2, r03, 15,
			-r03, r03, 15,
			-r03, -r03, 15,
			r01/2, -r03, 15,
			r01/2, r03, -1
		del 3
	endif
	if lod3D = 2 then
		add -(A-2*r04)/2, 0, 0
		rotx 90
		roty 90
		prism_ 7, A-2*r04,
			r01/2, r03, 15,
			-r03*tan(22.5), r03, 15,
			-r03, r03*tan(22.5), 15,
			-r03, -r03*tan(22.5), 15,
			-r03*tan(22.5), -r03, 15,
			r01/2, -r03, 15,
			r01/2, r03, -1
		del 3

		for hi = 1 to 2
			add -A/2, 0, 0
			rotx 90
			roty 90
			prism_ 7, r04,
				r01/2, r06, 15,
				-r06*tan(22.5), r06, 15,
				-r06, r06*tan(22.5), 15,
				-r06, -r06*tan(22.5), 15,
				-r06*tan(22.5), -r06, 15,
				r01/2, -r06, 15,
				r01/2, r06, -1
			del 3
		addx A-r04
		next hi
		del 2
	endif
endif

del 1

! --- Screen -------------------------------------------------------------------

material matScreen

if iScreenType = SCREEN_FLOORMOUNT then
	screenBottom = r09+2*r03
	screenTop = ZZYZX-5*r02
endif
if iScreenType = SCREEN_TRIPOD then
	screenBottom = ZZYZX-5*r02-min((A-2*r04),(ZZYZX-5*r02-0.5-2*r03))
	screenTop = ZZYZX-5*r02
endif
if iScreenType = SCREEN_WALLMOUNT then
	screenBottom = 4*r02
	screenTop = ZZYZX-3*r03
endif

rotx 90
plane 4,
	-A/2+r04, screenBottom, 0,
	A/2-r04, screenBottom, 0,
	A/2-r04, screenTop, 0,
	-A/2+r04, screenTop, 0
del 1


! --- Stand --------------------------------------------------------------------

material matStand

if iScreenType = SCREEN_FLOORMOUNT then
	material matFrame
	for hj = 1 to 2
		add A/4-2*r02, 0, 0
		rotz 90
		rotx 90
		prism_ 8, 2*r02,
			0, 0, 13,
			r01/2-r02, 0, 15+64,
			r01/2, r02, 1015+64,
			r01/2, r09, 15,
			-r08/2+r02-r02*sin(40)+(r09-r02-r02*cos(40))/tan(40), r09, 15,
			-r08/2+r02-r02*sin(40), r02+r02*cos(40), 15+64,
			-r08/2+r02, 0, 1015+64,
			0, 0, -1
		del 3
	mulx -1
	next hj
	del 2

	add -3*r02, 0, 0
	rotz 90
	rotx 90
	prism_ 6, 6*r02,
		-1.5*r08, 0, 15,
		r01/2-r02, 0, 15+64,
		r01/2-r02, 2*r02, 1015+64,
		-r08/2+r02, 2*r02, 15+64,
		-1.5*r08, r02, 15,
		-1.5*r08, 0, -1
	del 3

	material matStand
	for hj = 1 to 2
		add -A/4+2*r02, r01/2-r02, r02
		roty 90
		cylind A/4-5*r02, r02-0.002
		del 2

		add -A/4+2*r02, -r08/2+r02, r02
		roty 90
		cylind A/4-5*r02, r02-0.002
		del 2
	mulx -1
	next hj
	del 2

	addy 0.0015
	rotx 90
	prism_ 9, 0.003,
		-r02-0.0015, ZZYZX-3*r02, 15,
		-r02+0.0015, ZZYZX-3*r02, 15,
		-r02+0.0015, ZZYZX-2*r02, 15+64,
		r02-0.0015, ZZYZX-2*r02, 1015+64,
		r02-0.0015, ZZYZX-3*r02, 15,
		r02+0.0015, ZZYZX-3*r02, 15,
		r02+0.0015, ZZYZX-2*r02, 15+64,
		-r02-0.0015, ZZYZX-2*r02, 1015+64,
		-r02-0.0015, ZZYZX-3*r02, -1
	del 2

	add 0, r01/2, ZZYZX-r02-0.0045
	rotz -90
	rotx 90
	prism_ 7, 0.003,
		0, 0, 15,
		r01/2+0.0045, 0, 15,
		r01/2+0.0045, r02+0.0045, 15,
		r01/2+0.0015, r02+0.0045, 15,
		r01/2+0.0015, 0.003, 15,
		0, 0.003, 15,
		0, 0, -1
	del 3
endif


if iScreenType = SCREEN_TRIPOD then
	addy r01

	for hk = 1 to 2
		addy -r01+0.0015
		rotx 90
		prism_ 8, 0.003,
			-r01/2-r02-0.0015, ZZYZX-3*r02, 15,
			-r01/2-r02+0.0015, ZZYZX-3*r02, 15,
			-r01/2-r02+0.0015, ZZYZX-2*r02, 15+64,
			-r01/2, ZZYZX-r02-0.0015, 1015+64,
			-r01/2, ZZYZX-r02+0.0015, 15+64,
			-1, 0, 800,
			-r01/2-r02-0.0015, ZZYZX-2*r02, 1015+64,
			-r01/2-r02-0.0015, ZZYZX-3*r02, -1
		del 2
	mulx -1
	next hk
	del 2

	addx -r01/2
	rotz 90
	rotx 90
	prism_ 9, r01,
		-r01/2, (r07)*sin(45)-2*r02-(r07*3/8-2*r02)*sin(45)*2, 15,
		r01/2, (r07)*sin(45)-2*r02-(r07*3/8-2*r02)*sin(45)*2, 15,
		r01/2, ZZYZX, 15,
		-r01, ZZYZX, 15,
		-1.5*r01, ZZYZX-0.5*r02, 15,
		-1.5*r01, ZZYZX-1.5*r02, 15,
		-r01, ZZYZX-2*r02, 15,
		-r01/2, ZZYZX-2*r02, 15,
		-r01/2, (r07)*sin(45)-2*r02-(r07*3/8-2*r02)*sin(45)*2, -1
	del 3

	material matFrame

	cutpoly 4,
		-r01/2, -r01/2,
		r01/2, -r01/2,
		r01/2, r01/2,
		-r01/2, r01/2

	addz (r07)*sin(45)-2*r02
	cylind 4*r02, r01/2/sin(45)+0.002
	del 1

	addz (r07)*sin(45)-2*r02-(r07*3/8-2*r02)*sin(45)*2
	cylind 4*r02, r01/2/sin(45)+0.002
	del 1

	cutend

	cutpolya 2, 1, 0,
		0, 0, 907,
		r01/2/sin(45)+0.002, 360, 4007

	for hj = 1 to 3
		rotz 90
		add r01/2+0.002, r02, (r07+2*r02)*sin(45)
		rotx 90
		rotz -45
		prism_ 9, 2*r02,
			0, 0, 15,
			r07, 0, 15,
			r07, -2*r02, 15,
			r07*3/8, -2*r02, 15,
			r07*3/8, -r07*3/8, 15,
			r07*3/8-2*r02, -r07*3/8, 15,
			r07*3/8-2*r02, -2*r02, 15,
			0, -2*r02, 15,
			0, 0, -1
		del 4
	rotz 120
	next hj
	del 3

	cutend

	del 1
endif

