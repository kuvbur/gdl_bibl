
if gs_detlevel_3D_m = 0 then end

if not(gs_shadow) then shadow off

pen gs_cont_pen

! --- start of modifying to Shaft

				! --- CONNECTIONS --- !

if bShowMEP then

	if gs_detlevel_3D_m=1 then RESOL 8
	if gs_detlevel_3D_m=2 then RESOL 24

	if useSysMat then
		matAppliance	= sMat
		matKnob			= sMat
		matGreaseFilter	= sMat
		matFilterTrim	= sMat
		matLamp			= sMat
		matGlass		= sMat
		gs_con_mat		= sMat
	endif


	CALL "MEP_m_ConnectionsACL_4" PARAMETERS SetProgram = SetProgram,
		ui_current_con = ui_current_con,
		MEP_NumberConnections = MEP_NumberConnections,
		MEP_NumConnectionData = gs_Connections,
		gs_AddConnections = gs_AddConnections,
		cShow3D = 1,
		gs_ConMat = gs_con_mat,
		MEP_InsShow = 0,
		MEP_cline_show_3D = 0,
		gs_cont_pen = gs_cont_pen,
		ConPosX_1=ConPosX_1, ConPosY_1=ConPosY_1, ConPosZ_1=ConPosZ_1, ConLength_1=ConLength_1, ConEdit_1 = 1
endif

! --- end of modifying to Shaft



if gs_detlevel_3D_m = 1 then gs_resol=10

resol gs_resol

addx a


! --- Hood 1 ------------------------------------------------------------

if type_m = 1 then

	hotspot -a/2,b-.18,zzyzx

	if gs_detlevel_3D_m = 2 then
		resol gs_resol/2
		material matKnob
		add -a/2-0.05, 0.04, 0.02
		rotx -90
		mulz -1
		add 0.025, -0.01, 0
		gx=0.006 : gy=0.007 : gz=0.003 : gr=0.0026

		for i = 1 to 4
			muly 3
			add gx/2 ,gy/2, 0

			prism_ 10, gz-gr,
						-gx/2,		-gy/2+gr,	64+11,
						-gx/2,		 gy/2-gr,   64+11,
						-gx/2+gr,    gy/2,      1000+64+11,
						 gx/2-gr,    gy/2,      64+11,
						 gx/2,		 gy/2-gr,   1000+64+11,
						 gx/2,		-gy/2+gr,   64+11,
						 gx/2-gr,	-gy/2,		1000+64+11,
						-gx/2+gr,   -gy/2,      64+11,
						-gx/2,		-gy/2+gr,	1000+64+11,
						-gx/2,		-gy/2+gr,	-1

			roty -90
			add gz-gr,-gy/2, -gx/2+gr
			prism_ 8, gx-2*gr,
					gr,		gy-gr,		10+64,
					0,		gy-gr,		900+10+64,
					-0.01,	gy,			3000+8,
					-0.01,	-0.0001,	8,
					0,		0,			10+64,
					0,		gr,			900+10+64,
					gr,		gr,			3000+10+64,
					gr,		gy-gr,		10+64
			del 2

			del 2
			add 0.016, 0, 0
		next i

		del 8

		resol 2*gs_resol
		material matLamp
		add -a*5/6-.02,0.04,0.018
		rect .02,b-0.08
		del 1
		add -a*1/6,0.04,0.018
		rect .02,b-0.08
		del 1

	else					! Simple
		toler 0.002
	endif

	rotx -90
	material matAppliance
	resol 3*gs_resol
	prism_      10,      b,
		0,			0.01,				1*64+15,
		-a/2,		0.125*a*a/0.073,	900+0*64+15,
		-a,			0.01,				3000+0*64+15,
		-a,			0.01,				0*64+15,
		-a,			0,					0*64+15,
		-a+0.0001,  0,					64+15,
		-a/2,		0.125*a*a/0.073,	900+64+15,
		0,			0,					3000+0*64+15,
		0.00001,    0.01,				15,
		0,			0.01,				-1

	add 0, -0.026, 0.04
	cprism_ matFilterTrim, matFilterTrim, matGreaseFilter,
	  7,      b-0.08,
		-a/6,		0.01,				64+15,
		-a/2,		-0.125*a*a/0.073,	900+64+15,
		-a*5/6,		0.01,				3000+64+15,
		-a*5/6,		0,					64+15,
		-a/2,		0.125*a*a/0.073,	900+64+15,
		-a/6,		0,					3000+64+15,
		-a/6,		0.01,				-1

	del 2
	add -a/2, b-0.18, zzyzx-0.157
	addz 0.01
	prism_ 6, 0.080,
			-0.04,	0.18,	15,
			0.13,	0.18,	15,
			0.13,	0,		64+13,
			0,		0,		900,
			-0.06,	0.07,	3000+15,
			-0.04,	0.18,	-1
	del 1

	resol int (1.5*gs_resol)
	cylind  0.092, 0.130
	del 1

	add -a/2, b-0.18, zzyzx-0.065
	material matFilterTrim
	ellips  0.065, 0.118
	del 1
	material matAppliance
	add -a/2, b-0.18, 0.073
	cylind  zzyzx-0.073-0.157, 0.1
	del 1
endif


! --- Hood 2 -----------------------------------------------------------

if type_m = 2 then
	IF gs_detlevel_3D_m = 1 THEN gs_resol=10

	RESOL gs_resol
	HOTSPOT -A/2,B,zzyzx
	addx -a
	mul (10/6)*a, (10/5)*b, 1
	material matAppliance
	addz 0.01
	PRISM_ 6+6, zzyzx-0.01,
		0.175,         0.27,      15,
		0.3,         0.21,      15,
		0.425,         0.27,      15,
		0.425,          0.49,      15,
		0.175,          0.49,      15,
		0.175,         0.27,      -1,
		0.4163793103448,         0.48,      15,
		0.1836206896552,         0.48,      15,
		0.1836206896552, 0.2758620689655,      15,
		0.3,         0.22,      15,
		0.4163793103448, 0.2758620689655,      15,
		0.4163793103448,         0.48,      -1
	del 1

	addz 0.01
	rotx 49
	CUTPLANE
	del 1

	roty -38.66
	CUTPLANE
	del 1

	addx 0.6
	roty 38.99
	CUTPLANE
	del 2
	del 1

	CUTFORM 5, 1, 1,
			0, 0, 1, 0.01,
			0.01,         0.49,      15,
			0.59,         0.49,      15,
			0.59,         0.06,      15,
			0.01,         0.06,      15,
			0.01,         0.49,      15

	PRISM_  5+6, 0.25,
			   0,            0,      15,
			 0.6,            0,      15,
			 0.6,          0.5,      15,
			   0,          0.5,      15,
			   0,            0,      -1,
		   0.425,          0.49,      15,
		   0.175,          0.49,      15,
		   0.175,         0.27,      15,
			 0.3,         0.21,      15,
		   0.425,         0.27,      15,
		   0.425,          0.49,      -1

	CUTEND :  CUTEND :  CUTEND :  CUTEND

	if gs_detlevel_3D_m = 1 THEN
		material matGreaseFilter
		PRISM_ 5, 0.01,
			0.01,         0.49,      15,
			0.59,         0.49,      15,
			0.59,         0.06,      15,
			0.01,         0.06,      15,
			0.01,         0.49,      15
	else
		material matGreaseFilter
		PRISM_ 5, 0.01,
			0.01,         0.49,      15,
			0.59,         0.49,      15,
			0.59,         0.06,      15,
			0.01,         0.06,      15,
			0.01,         0.49,      15
		del 1

		add 0.1, 0.02, 0
		mul 1.35, 1.5, 1
		material matKnob
		add -0.04, 0.008, 0
		mulz -1
		RESOL gs_resol/2
		gz=.004 : gr1=.012 : gr2=.008 : gv=.002 : beta=-90
		GOSUB 9996

		add .025, -.008,0
		gx=.01 : gy=.016 : gz=.004 : gr=.0015
		ADD gx/2 ,gy/2, 0
		GOSUB 9997
		DEL 1

		add .018, 0,0
		gx=.01 : gy=.016 : gz=.004 : gr=.0015
		ADD gx/2 ,gy/2, 0
		GOSUB 9997
		DEL 1

		add .018, 0,0
		gx=.01 : gy=.016 : gz=.004 : gr=.0015
		ADD gx/2 ,gy/2, 0
		GOSUB 9997
		DEL 7
	endif
	del 2
endif


! --- Hood 3 -----------------------------------------------------------

if type_m = 3 then

	RESOL gs_resol
	HOTSPOT -A/2,B,zzyzx
	addx -a

	mul (10/9)*a, (10/5)*b, 1

	material matAppliance

	addz 0.16
	prism_ 8+7, zzyzx-0.16,
				0.31,          0.5,      15,
				0.31,        0.28501,      15,
				0.31,        0.285,      79,
				0.45, 0.3897434547245,    915,
				   0, 106.3947134638,   4015,
				0.59,        0.285,      15,
				0.59,          0.5,      15,
				0.31,          0.5,      -1,
				0.3189995398812, 0.4908429786156,      15-1,
				0.3189995398812, 0.2896588354412,      79-1,
				0.4500031679947, 0.3876714967988,    979-1,
						   0, 106.3947134638,   4015-1,
				0.5810067961083, 0.2896588354412,      15-1,
				0.5810067961083, 0.4908429786156,      15-1,
				0.3189995398812, 0.4908429786156,      -1
	del 1

	material matGlass
	CUTPOLYA 22, 0, 0,
			0.31,          0.5,      79,
				0.31,        0.28501,      15,
			0.31,        0.285,      79,
			0.45, 0.3897434547245,    900,
			   0, 106.3947134638,   4001,
			0.59,        0.285,      79,
			0.59,          0.5,      79,
			0.5671425505895, 0.01361595941019,    900,
			0, -38.82488050475,   4001,
			0.8898846768701, 0.378210827528,     79,
			0.87, 0.3557475324498,    900,
			0, -48.48450563558,   4001,
			0.9, 0.3557475324498,      79,
			0.9, 0.6651975957322,      79,
			1.894772568431E-017, 0.6651975957322,      79,
			-3.286490871153E-033, 0.3557475324498,     79,
			0.03, 0.3557475324498,    900,
			0, -48.48450364693,   4001,
			0.01011532235019, 0.3782108268378,      79,
			0.3328574494105, 0.01361595941019,    900,
			0, -38.82488062727,   4001,
			0.31,          0.5,      79

	CUTPOLYA 13, 0, 0,
			0.9, -0.16,      79,
			0.9, 0.08896330669444,      79,
			0.84, 0.08896330669444,    900,
			0, -81.50547075968,   4001,
			0.848862898589, 0.02962150836812,     79,
			0.45, 2.700217754626,    900,
			0, -16.98907134613,   4001,
			0.05113709467372, 0.02962150937436,79,
			0.06, 0.08896330669444,    900,
			0, -81.50546425466,   4001,
			1.779002595432E-033, 0.08896330669444, 79,
			-3.782621688799E-018, -0.06177694043466, 79,
			0.9, -0.16,      79


	add 0.0, 0.62, 0.205
	rotx 90+20.22
	RESOL gs_resol*2
	prism_       9,     0.62,
			0, 0.006341176470588,      15,
			0.002964705882353,            0,      79,
			0.45, -0.9561588235294,    900,
			0, -50.11523083661,   4079,
			0.8970352941176, 0,      79,
			0.9, 0.006341176470588,      79,
			0.45, -0.9561588235294,    900,
			0, 50.11523083661,   4079,
			0, 0.006341176470588,      1
	del 2

	CUTEND
	CUTEND

	if gs_detlevel_3D_m = 1 then
		material matAppliance
		addz 0.205
		prism_ 7, 0.02,
					0.3189995398812, 0.4908429786156,      15,
					0.3189995398812, 0.2896588354412,      79,
					0.4500031679947, 0.3876714967988,    979,
							   0, 106.3947134638,   4015,
					0.5810067961083, 0.2896588354412,      15,
					0.5810067961083, 0.4908429786156,      15,
					0.3189995398812, 0.4908429786156,      -1
		del 1
	else
		addz 0.16
		material matAppliance
		prism_ 12, 0.02,
					0.3189995398812, 0.4908429786156,      14,
					0.3189995398812, 0.2896588354412,      14,
					0.4500031679947, 0.3876714967988,    900,
							   0, 106.3947134638,   4001,
					0.5810067961083, 0.2896588354412,      14,
					0.5810067961083, 0.4908429786156,      14,
					0.3189995398812, 0.4908429786156,     -1,
					0.5510067961083, 0.3196588354412,      14,
					0.3489995398812, 0.3196588354412,      14,
					0.3489995398812, 0.4608429786156,      14,
					0.5510067961083, 0.4608429786156,      14,
					0.5510067961083, 0.3196588354412,     -1

		material matGreaseFilter
		prism_     5,      0.01,
					0.5510067961083, 0.3196588354412,      15,
					0.3489995398812, 0.3196588354412,      15,
					0.3489995398812, 0.4608429786156,      15,
					0.5510067961083, 0.4608429786156,      15,
					0.5510067961083, 0.3196588354412,     -1
		del 1

		add 0.45, 0.27, 0.16

		mul 1.35, 1.5, 1

		material matKnob
		add -0.04, 0.008, 0
		mulz -1
		RESOL gs_resol/2
		gz=.004 : gr1=.012 : gr2=.008 : gv=.002 : beta=-90
		GOSUB 9996

		add .025, -.008,0
		gx=.01 : gy=.016 : gz=.004 : gr=.0015
		ADD gx/2 ,gy/2, 0
		GOSUB 9997
		DEL 1

		add .018, 0,0
		gx=.01 : gy=.016 : gz=.004 : gr=.0015
		ADD gx/2 ,gy/2, 0
		GOSUB 9997
		DEL 1

		add .018, 0,0
		gx=.01 : gy=.016 : gz=.004 : gr=.0015
		ADD gx/2 ,gy/2, 0
		GOSUB 9997
		DEL 8
	endif
	del 2
endif


! --- Hood 4 -----------------------------------------------------------

if type_m = 4 then

	if gs_detlevel_3D_m = 1 then gs_resol=10

	hotspot -A/2,B/2,zzyzx
	addx -a

	mul (100/89.5)*a, (100/56.4)*0.93*b, 1

	if bWallMounted then
		addy 0.606452869
		rotx -90
		cutplane 1, 1, 0
		del 2
		muly 1.127235816
	endif

	resol gs_resol
	add 0.288, 0.288, 0

	material matAppliance

	addz 0.555
	prism_       10,     zzyzx-0.555,
					0.32,         0.25,      14,
					0.32,            0,      14,
					   0,            0,      14,
					   0,         0.25,      14,
					0.32,         0.25,     -1,
				   0.005,        0.005,      14,
				   0.315,        0.005,      14,
				   0.315,        0.245,      14,
				   0.005,        0.245,      14,
				   0.005,        0.005,     -1

	roty 90

	prism_ 6,     0.320,
					   0,            0,      8,
			0.1050952014402,            0,      8,
			0.3925166432147,        0.227,      15,
			0.3925166432147,         0.25,      15,
					   0,         0.25,      8,
					   0,            0,      1

	prism_ 4,     0.320,
			0,		0,      8,
			0.105,	0,		8,
			0,		-0.083,	15,
			0,		0,		10

	del 1

	del 1

	add 0.32/2, -0.083, 0.557
	rotx -51.7
	va=0.03
	addz -va
	aa = 0.32: bb = 0.505: zz=0.0115: e=0.001: part=0: t=va
	gosub "shell"

	addz -0.02
	aa = 0.32: bb = 0.505: zz=0.0115: e=0.001: part=3: t=va: az=0.4
	gosub "shell"
	addz -0.018

	if gs_detlevel_3D_m <> 1 then
		mul a*1.5, b*3, 1

		material matKnob
		add -0.04, 0.008, 0
		mulz -1
		RESOL gs_resol/2
		gz=.004 : gr1=.012 : gr2=.008 : gv=.002 : beta=-90
		GOSUB 9996

		add .025, -.008,0
		gx=.01 : gy=.016 : gz=.004 : gr=.0015
		ADD gx/2 ,gy/2, 0
		GOSUB 9997
		DEL 1

		add .018, 0,0
		gx=.01 : gy=.016 : gz=.004 : gr=.0015
		ADD gx/2 ,gy/2, 0
		GOSUB 9997
		DEL 1

		add .018, 0,0
		gx=.01 : gy=.016 : gz=.004 : gr=.0015
		ADD gx/2 ,gy/2, 0
		GOSUB 9997
		DEL 7
	endif

	del 5

	add 0.32/2, -0.225, 0.685
	rotx -51.7
	material matGlass
	aa=0.895: bb=0.873: zz=0.1: e=0.02: part=1
	gosub "shell"

	del 2
	del 1

	if bWallMounted then
		cutend
		del 1
	endif

	del 1
endif


! --- Hood 5 -----------------------------------------------------------

if type_m = 5 then
	add -a/2, b/2, 0
	if bWallMounted then
		material matGlass
		if gs_detlevel_3D_m = 2 then
			prism_ 14, gs,
				-a/2, b/2, 15,
				-skl/2+skr-gz, b/2, 15,
				-skl/2+skr-gz, b/2-sks+gzl, 15,
				skl/2-skr+gz, b/2-sks+gzl, 15,
				skl/2-skr+gz, b/2, 15,
				a/2, b/2, 15,
				a/2, -b/2+ar, 15+64,
				a/2-ar, -b/2+ar, 900,
				ar, -90, 4000,
				a/2-ar, -b/2, 13,
				-a/2+ar, -b/2, 15+64,
				-a/2+ar, -b/2+ar, 900,
				ar, -90, 4000,
				-a/2, -b/2+ar, 13
		else
			prism_ 10, gs,
				-a/2, b/2, 15,
				a/2, b/2, 15,
				a/2, -b/2+ar, 15+64,
				a/2-ar, -b/2+ar, 900,
				ar, -90, 4000,
				a/2-ar, -b/2, 13,
				-a/2+ar, -b/2, 15+64,
				-a/2+ar, -b/2+ar, 900,
				ar, -90, 4000,
				-a/2, -b/2+ar, 13
		endif

		material matAppliance
		addz gs
		if gs_detlevel_3D_m = 2 then
			prism_ 8, skf,
				skl/2-skr, b/2-sks+skr+gzl, 15,
				skl/2-skr, b/2, 11,
				skl/2, b/2, 11,
				skl/2, b/2-sks, 11,
				-skl/2, b/2-sks, 11,
				-skl/2, b/2, 11,
				-skl/2+skr, b/2, 15,
				-skl/2+skr, b/2-sks+skr+gzl, 15
			addz skf
			cprism_ matAppliance, matGreaseFilter, matAppliance, 6, skh-skf,
				skl/2-skr, b/2, 12,
				skl/2, b/2, 14,
				skl/2, b/2-sks, 14,
				-skl/2, b/2-sks, 14,
				-skl/2, b/2, 14,
				-skl/2+skr, b/2, 13
			del 1
		else
			cprism_ matAppliance, matGreaseFilter, matAppliance, 4, skh,
				skl/2, b/2, 15,
				skl/2, b/2-sks, 15,
				-skl/2, b/2-sks, 15,
				-skl/2, b/2, 15
		endif

		addz skh
		prism 8, zzyzx-gs-skh-so,
			sl/2-sws, b/2-ss+sws,
			sl/2-sws, b/2,
			sl/2, b/2,
			sl/2, b/2-ss,
			-sl/2, b/2-ss,
			-sl/2, b/2,
			-sl/2+sws, b/2,
			-sl/2+sws, b/2-ss+sws
		del 2

		addz zzyzx-so
		prism 8, so,
			sl/2-sws, b/2-ss+sws,
			sl/2-sws, b/2,
			sl/2, b/2,
			sl/2, b/2-ss,
			-sl/2, b/2-ss,
			-sl/2, b/2,
			-sl/2+sws, b/2,
			-sl/2+sws, b/2-ss+sws
		del 1

		if gs_detlevel_3D_m = 2 then
			material matLamp
			add (skl/2-skr+gz)/2, b/2-sks+gzl+skr/2, gs-lh
			CYLIND lh, (gzl-0.005)/2
			addx -(skl/2-skr+gz)
			CYLIND lh, (gzl-0.005)/2
			del 2


			material matKnob
			add -ad, b/2-2*ad-sks, gs+2*skh/3
				BLOCK ad*2, ad*2, ad*2
			del 1

			add -ad, b/2-2*ad-sks, gs+skh/3
				BLOCK ad*2, ad*2, ad*2
			del 1

			add skl/20-ad/2, b/2-ad-sks, gs+skh/3+ad/2
			for i=1 to 3
					BLOCK ad, ad, ad
				addx skl/25
			next i
			del i

			add -skl/20-ad/2, b/2-ad-sks, gs+skh/3+ad/2
			for i=1 to 3
				BLOCK ad, ad, ad
				addx -skl/25
			next i
			del i

			add -ad*3-sks/4.5, b/2-ad-sks, gs+skh/3
				BLOCK ad*6, ad, ad*1.5
			del 1
		endif
	else
		material matGlass
		if gs_detlevel_3D_m = 2 then
			prism_ 17+5, gs,
				-a/2, b/2-ar, 15+64,
				-a/2+ar, b/2-ar, 900,
				ar, -90, 4000,
				-a/2+ar, b/2, 13,
				a/2-ar, b/2, 15+64,
				a/2-ar, b/2-ar, 900,
				ar, -90, 4000,
				a/2, b/2-ar, 13,
				a/2, -b/2+ar, 15+64,
				a/2-ar, -b/2+ar, 900,
				ar, -90, 4000,
				a/2-ar, -b/2, 13,
				-a/2+ar, -b/2, 15+64,
				-a/2+ar, -b/2+ar, 900,
				ar, -90, 4000,
				-a/2, -b/2+ar, 13,
				-a/2, b/2-ar, -1,

				skl/2-skr+gz, sks/2-skr+gz, 15,
				skl/2-skr+gz, gzl-sks/2, 15,
				skr-skl/2-gz, gzl-sks/2, 15,
				skr-skl/2-gz, sks/2-skr+gz, 15,
				skl/2-skr+gz, sks/2-skr+gz, -1
		else
			prism_ 16, gs,
				-a/2, b/2-ar, 15+64,
				-a/2+ar, b/2-ar, 900,
				ar, -90, 4000,
				-a/2+ar, b/2, 13,
				a/2-ar, b/2, 15+64,
				a/2-ar, b/2-ar, 900,
				ar, -90, 4000,
				a/2, b/2-ar, 13,
				a/2, -b/2+ar, 15+64,
				a/2-ar, -b/2+ar, 900,
				ar, -90, 4000,
				a/2-ar, -b/2, 13,
				-a/2+ar, -b/2, 15+64,
				-a/2+ar, -b/2+ar, 900,
				ar, -90, 4000,
				-a/2, -b/2+ar, 13
		endif

		material matAppliance
		addz gs
		if gs_detlevel_3D_m = 2 then
			prism_ 5+5, skf,
				skl/2, sks/2, 11,
				skl/2, -sks/2, 11,
				-skl/2, -sks/2, 11,
				-skl/2, sks/2, 11,
				skl/2, sks/2, -1,

				skl/2-skr, sks/2-skr, 15,
				skl/2-skr, gzl+skr-sks/2, 15,
				skr-skl/2, gzl+skr-sks/2, 15,
				skr-skl/2, sks/2-skr, 15,
				skl/2-skr, sks/2-skr, -1

			addz skf
			cprism_ matAppliance, matGreaseFilter, matAppliance, 4, skh-skf,
				skl/2, sks/2, 14,
				skl/2, -sks/2, 14,
				-skl/2, -sks/2, 14,
				-skl/2, sks/2, 14
			del 1
		else
			cprism_ matAppliance, matGreaseFilter, matAppliance, 4, skh,
				skl/2, sks/2, 15,
				skl/2, -sks/2, 15,
				-skl/2, -sks/2, 15,
				-skl/2, sks/2, 15
		endif

		addz skh
		prism_ 5+5, zzyzx-gs-skh-so,
			sl/2, ss/2, 15,
			sl/2, -ss/2, 15,
			-sl/2, -ss/2, 15,
			-sl/2, ss/2, 15,
			sl/2, ss/2, -1,

			sl/2-sws, ss/2-sws, 15,
			sl/2-sws, sws-ss/2, 15,
			sws-sl/2, sws-ss/2, 15,
			sws-sl/2, ss/2-sws, 15,
			sl/2-sws, ss/2-sws, -1
		del 2

		addz zzyzx-so
		prism_ 5+5, so,
			sl/2, ss/2, 15,
			sl/2, -ss/2, 15,
			-sl/2, -ss/2, 15,
			-sl/2, ss/2, 15,
			sl/2, ss/2, -1,

			sl/2-sws, ss/2-sws, 15,
			sl/2-sws, sws-ss/2, 15,
			sws-sl/2, sws-ss/2, 15,
			sws-sl/2, ss/2-sws, 15,
			sl/2-sws, ss/2-sws, -1
		del 1

		if gs_detlevel_3D_m = 2 then
			material matLamp
			add (skl/2-skr+gz)/2, -sks/2+gzl+skr/2, gs-lh
			CYLIND lh, (gzl-0.005)/2
			addx -(skl/2-skr+gz)
			CYLIND lh, (gzl-0.005)/2
			del 2

			material matKnob
			add -ad, -2*ad-sks/2, gs+2*skh/3
				BLOCK ad*2, ad*2, ad*2
			del 1

			material matKnob
			add -ad, -2*ad-sks/2, gs+skh/3
				BLOCK ad*2, ad*2, ad*2
			del 1

			add skl/20-ad/2, -ad-sks/2, gs+skh/3+ad/2
			for i=1 to 3
				BLOCK ad, ad, ad
				addx skl/25
			next i
			del i

			add -skl/20-ad/2, -ad-sks/2, gs+skh/3+ad/2
			for i=1 to 3
				BLOCK ad, ad, ad
				addx -skl/25
			next i
			del i

			add -ad*3-sks/4.5, -ad-sks/2, gs+skh/3
				BLOCK ad*6, ad, ad*1.5
			del 1
		endif
	endif
	del 1
endif


! --- Hood 6 -----------------------------------------------------------

if type_m = 6 then
	if gs_detlevel_3D_m = 1 then gs_resol=10

	RESOL gs_resol
	material matAppliance

	addx -a
	mul (10/9)*a, (10/5)*b, 1
	if gs_detlevel_3D_m = 1 THEN

		addz 0.06
		PRISM_ 5,     0.001,
			   0,            0,      15-1,
			 0.9,            0,      15-1,
			 0.9,          0.5,      15-1,
			   0,          0.5,      15-1,
			   0,            0,      15-1
		del 1
		PRISM_ 10,     0.06,
			   0,            0,      15-4,
			 0.9,            0,      15-4,
			 0.9,          0.5,      15-4,
			   0,          0.5,      15-4,
			   0,            0,      -1,
			   0,            0,      15,
			 0.9,            0,      15,
			 0.9,          0.5,      15,
			   0,          0.5,      15,
			   0,            0,      -1

		if not(bWallMounted) then addy -0.125

		addz 0.061
		PRISM_ 5,   zzyzx-0.061,
				0.3147877696169,          0.5,      15,
				0.5852122303831,          0.5,      15,
				0.5852122303831, 0.2541595811217,      15,
				0.3147877696169, 0.2541595811217,      15,
				0.3147877696169,          0.5,      15
		del 1

		if not(bWallMounted) then del 1
	else

		addz 0.060
		PRISM_      21,     0.001,
					   0.005,            0,      79-1,
					   0.895,            0,      79-1,
					   0.895,       0.0005,      79-1,
					  0.8995,       0.0005,      15-1,
					  0.8995,        0.005,      79-1,
						 0.9,        0.005,      79-1,
						 0.9,        0.495,      79-1,
					  0.8995,        0.495,      79-1,
					  0.8995,       0.4995,      15-1,
					   0.895,       0.4995,      79-1,
					   0.895,          0.5,      79-1,
					   0.005,          0.5,      79-1,
					   0.005,       0.4995,      79-1,
					  0.0005,       0.4995,      15-1,
					  0.0005,        0.495,      79-1,
						   0,        0.495,      79-1,
						   0,        0.005,      79-1,
					  0.0005,        0.005,      79-1,
					  0.0005,       0.0005,      15-1,
					   0.005,       0.0005,      79-1,
					   0.005,            0,      79-1
		del 1
		PRISM_      21+21,     0.060,
					   0.005,            0,      15-4,
					   0.895,            0,      15-4,
					   0.895,       0.0005,      15-4,
					  0.8995,       0.0005,      15-4,
					  0.8995,        0.005,      15-4,
						 0.9,        0.005,      15-4,
						 0.9,        0.495,      15-4,
					  0.8995,        0.495,      15-4,
					  0.8995,       0.4995,      15-4,
					   0.895,       0.4995,      15-4,
					   0.895,          0.5,      15-4,
					   0.005,          0.5,      15-4,
					   0.005,       0.4995,      15-4,
					  0.0005,       0.4995,      15-4,
					  0.0005,        0.495,      15-4,
						   0,        0.495,      15-4,
						   0,        0.005,      15-4,
					  0.0005,        0.005,      15-4,
					  0.0005,       0.0005,      15-4,
					   0.005,       0.0005,      15-4,
					   0.005,            0,      -1,
					0.006288051034306, 0.0007236241765766,      11,
					0.8937119489657, 0.0007236241765766,      11,
					0.8937119489657, 0.001222176928223,      11,
					0.8981989237305, 0.001222176928223,      11,
					0.8981989237305, 0.005709151693045,      11,
					0.8986974764822, 0.005709151693045,      11,
					0.8986974764822, 0.494290848307,      11,
					0.8981989237305, 0.494290848307,      11,
					0.8981989237305, 0.4987778230718,      11,
					0.8937119489657, 0.4987778230718,      11,
					0.8937119489657, 0.4992763758234,      11,
					0.006288051034306, 0.4992763758234,      11,
					0.006288051034306, 0.4987778230718,      11,
					0.001801076269485, 0.4987778230718,      11,
					0.001801076269485, 0.494290848307,      11,
					0.001302523517838, 0.494290848307,      11,
					0.001302523517838, 0.005709151693045,      11,
					0.001801076269485, 0.005709151693045,      11,
					0.001801076269485, 0.001222176928223,      11,
					0.006288051034306, 0.001222176928223,      11,
					0.006288051034306, 0.0007236241765766,     -1

		if not(bWallMounted) then addy -0.125
		resol 128
		addz 0.061
		PRISM_	14,	zzyzx-0.061,
				 0.31251,		 0.25001,		15,
				 0.3125,		 0.25,      	79,
				 0.45,   		-0.6903125,		900,
				 0, 			-16.63856917,   4015,
				 0.58751,		 0.25001,      	15,
				 0.5875,		 0.25,      	79,
				 1.70007143,	 0.375,    		900,
				 0, 			-12.82086372,   4079,
				 0.5875,		 0.5,			15,
				 0.31251,		 0.5001,		15,
				 0.3125,		 0.5,			79,
				-0.80007143,	 0.375,			900,
				 0, 			-12.82086372,	4015,
				 0.3125,		 0.25,			15

		del 1

		if not(bWallMounted) then del 1


	endif

	del 2


	if gs_detlevel_3D_m = 1 THEN

		material matAppliance
		PRISM_      5,      0.001,
			-0.002,      0.002,      15,
			-0.002,      B-0.002,      15,
			-A+0.002,   B-0.002,      15,
			-A+0.002,   0.002,      15,
			-0.002,      0.002,      -1

	else !!!! Detailed

		mul a*1.5, b*3, 1

		material matKnob
		add -0.1, 0.03, -0.000
		MULZ -1
		RESOL gs_resol/2
		gz=.004 : gr1=.012 : gr2=.008 : gv=.002 : beta=-90
		GOSUB 9996

		add .025, -.008,0
		gx=.01 : gy=.016 : gz=.004 : gr=.0015
		ADD gx/2 ,gy/2, 0
		GOSUB 9997
		DEL 1

		add .018, 0,0
		gx=.01 : gy=.016 : gz=.004 : gr=.0015
		ADD gx/2 ,gy/2, 0
		GOSUB 9997
		DEL 1

		add .018, 0,0
		gx=.01 : gy=.016 : gz=.004 : gr=.0015
		ADD gx/2 ,gy/2, 0
		GOSUB 9997
		DEL 6
		del 1

		RESOL gs_resol
		material matGreaseFilter
		PRISM_      5,      -0.001,
			-0.025,0.08,15,
			-0.025,B-0.025,15,
			-A+0.025,B-0.025,15,
			-A+0.025,0.08,15,
			-0.025,0.08,-1

		material matAppliance
		ROTx -86
		CUTPOLYA 4, 1, 0 ,
			-0.03, .02, 15,
			-0.03, .01, 15,
			-A+0.03, .01, 15,
			-A+0.03, .02, 15
		DEL 1

		PRISM_      10,      0.01,
			-0.002,      0.002,      15,
			-0.002,      B-0.002,      15,
			-A+0.002,   B-0.002,      15,
			-A+0.002,   0.002,      15,
			-0.002,      0.002,      -1,
			-0.025,0.08,15,
			-0.025,B-0.025,15,
			-A+0.025,B-0.025,15,
			-A+0.025,0.08,15,
			-0.025,0.08,-1
		CUTEND
	endif
endif


! --- Hood 7 -----------------------------------------------------------

if type_m = 7 then
	IF gs_detlevel_3D_m = 1 THEN gs_resol=10

	if bWallMounted then
		dy=(b-bbb)/2
		HOTSPOT -A/2,b-0.15,zzyzx
	else
		HOTSPOT -A/2,B/2,zzyzx
		dy=0
	endif

	material matAppliance
	addx -a/2
	prism_ 8, 0.04,
		a/2-ds, 0, 15,
		a/2, ds, 15,
		a/2, b-ds, 15,
		a/2-ds, b, 15,
		-a/2+ds, b, 15,
		-a/2, b-ds, 15,
		-a/2, ds, 15,
		-a/2+ds, 0, 15

	addz 0.04
	RULED 8 , 2+4+16+32,
		a/2-ds, 0, 0,
		a/2, ds, 0,
		a/2, b-ds, 0,
		a/2-ds, b, 0,
		-a/2+ds, b, 0,
		-a/2, b-ds, 0,
		-a/2, ds, 0,
		-a/2+ds, 0, 0,

		aaa/2-0.001, b/2-bbb/2+dy, 0.056,
		aaa/2, b/2-bbb/2+0.001+dy, 0.056,
		aaa/2, b/2+bbb/2-0.001+dy, 0.056,
		aaa/2-0.001, b/2+bbb/2+dy, 0.056,
		-aaa/2+0.001, b/2+bbb/2+dy, 0.056,
		-aaa/2, b/2+bbb/2-0.001+dy, 0.056,
		-aaa/2, b/2-bbb/2+0.001+dy, 0.056,
		-aaa/2+0.001, b/2-bbb/2+dy, 0.056


	addz 0.056
	PRISM_    8,     0.3,
		aaa/2-0.001, b/2-bbb/2+dy, 15,
		aaa/2, b/2-bbb/2+0.001+dy, 15,
		aaa/2, b/2+bbb/2-0.001+dy, 15,
		aaa/2-0.001, b/2+bbb/2+dy, 15,
		-aaa/2+0.001, b/2+bbb/2+dy, 15,
		-aaa/2, b/2+bbb/2-0.001+dy, 15,
		-aaa/2, b/2-bbb/2+0.001+dy, 15,
		-aaa/2+0.001, b/2-bbb/2+dy, 15

	addz 0.3
	PRISM_      4,     hhh-0.3,
		aaa/2, b/2-bbb/2+dy, 15,
		aaa/2, b/2+bbb/2+dy, 15,
		-aaa/2, b/2+bbb/2+dy, 15,
		-aaa/2, b/2-bbb/2+dy, 15

	del 2
	del 2

	IF gs_detlevel_3D_m = 2 THEN
		material matKnob
		add -0.25, 0.004, 0
		ROTX 90
		MULZ 1

		add -0.03, 0.014, 0.004
		BLOCK  0.04, 0.016, 0.004
		add 0.148, 0, 0
		BLOCK  0.02, 0.016, 0.004
		del 2

		ADD 0.02, 0.01, .0041
		gx=.01 : gy=.024 : gz=.005 : gr=.0040
		ADD gx/2 ,gy/2, 0
		GOSUB 9997
		DEL 1

		add .018, 0,0
		gx=.01 : gy=.024 : gz=.005 : gr=.0040
		ADD gx/2 ,gy/2, 0
		GOSUB 9997
		DEL 1

		add .038, 0,0
		gx=.01 : gy=.024 : gz=.005 : gr=.0040
		ADD gx/2 ,gy/2, 0
		GOSUB 9997
		DEL 1

		add .022, 0,0
		gx=.01 : gy=.024 : gz=.005 : gr=.0040
		ADD gx/2 ,gy/2, 0
		GOSUB 9997
		DEL 1

		DEL 7

		ADD -a/2, 0, -0.001

		pm=0.12
		dss=ds+(pm/2)*2/sqr(2)-pm
		a2=a-pm

		material matGreaseFilter
		PRISM_   8,      0.001,
			a2/2-dss, pm/2, 15,
			a2/2, pm/2+dss, 15,
			a2/2, b-pm/2-dss, 15,
			a2/2-dss, b-pm/2, 15,
			-a2/2+dss, b-pm/2, 15,
			-a2/2, b-pm/2-dss, 15,
			-a2/2, pm/2+dss, 15,
			-a2/2+dss, pm/2, 15

		pm2=0.08
		dss2=ds+(pm2/2)*2/sqr(2)-pm2
		a3=a-pm2

		addz -0.002
		material matFilterTrim
		PRISM_   28,      0.003,
			a3/2-dss2, pm2/2, 15,
			a3/2, pm2/2+dss2, 15,
			a3/2, b-pm2/2-dss2, 15,
			a3/2-dss2, b-pm2/2, 15,
			-a3/2+dss2, b-pm2/2, 15,
			-a3/2, b-pm2/2-dss2, 15,
			-a3/2, pm2/2+dss2, 15,
			-a3/2+dss2, pm2/2, 15,
			a3/2-dss2, pm2/2, -1,

			a2/2-dss, pm/2, 15,
			a2/2, pm/2+dss, 15,
			a2/2, b-pm/2-dss, 15,
			a2/2-dss, b-pm/2, 15,
			0.15, b-pm/2, 15,
			0.15, pm/2, 15,
			a2/2-dss, pm/2, -1,

			-a2/2+dss, b-pm/2, 15,
			-a2/2, b-pm/2-dss, 15,
			-a2/2, pm/2+dss, 15,
			-a2/2+dss, pm/2, 15,
			-0.15, pm/2, 15,
			-0.15, b-pm/2, 15,
			-a2/2+dss, b-pm/2, -1,

			-0.13, pm/2, 15,
			 0.13, pm/2, 15,
			 0.13, b-pm/2, 15,
			-0.13, b-pm/2, 15,
			-0.13, pm/2, -1


		del 1


		DEL 1

		material matLamp
		ADD -A+ds+0.02, b-pm2/2+0.01, -0.001
		RECT A-2*(ds+0.02), pm2/2-0.02
		DEL 1
		ADD -A+ds+0.02, 0.01, -0.001
		RECT A-2*(ds+0.02), pm2/2-0.02
		DEL 1
	ENDIF
endif


! --- Hood 8 -----------------------------------------------------------

if type_m = 8 then
	addx -a
	RESOL gs_resol
	HOTSPOT A/2,B,zzyzx

	mul (10/6)*a, (10/5)*b, 1
	if not(bWallMounted) then
		muly 1/1.6
		parts=2
	else
		parts=1
	endif

	for i=1 to parts
		if not(bWallMounted) then
			addy 0.4
			CUTPOLYA 4, 1, 0,
				0, 0, 8,
				a, 0, 8,
				a, zzyzx, 8,
				0, zzyzx, 8
			del 1
		endif

		addz 0.0618
		material matAppliance
		PRISM_ 11+11, zzyzx-0.0618,
			   0.215,         0.26,      79,
			   0.385,         0.26,      79,
			   0.385,          0.3,    979,
				   0,           90,   4079,
			   0.425,          0.3,      79,
			   0.425,          0.5,      15,
			   0.175,          0.5,      15,
			   0.175,          0.3,      79,
			   0.215,          0.3,    900,
				   0,           90,   4001,
			   0.215,         0.26,      -1,
				0.2210444444319, 0.2685333333157,      79,
				0.3789555555681, 0.2685333333157,      79,
				0.3789555555681, 0.3056888888771,    900,
						   0,           90,   4001,
				0.4161111111295, 0.3056888888771,      79,
				0.4161111111295, 0.4914666666843,      79,
				0.1838888888705, 0.4914666666843,      79,
				0.1838888888705, 0.3056888888771,      79,
				0.2210444444319, 0.3056888888771,    900,
						   0,           90,   4001,
				0.2210444444319, 0.2685333333157,     -1


		CUTPOLYA 11, 1, 0,
			   0.215,         0.26,      79,
			   0.385,         0.26,      79,
			   0.385,          0.3,    900,
				   0,           90,   4001,
			   0.425,          0.3,      79,
			   0.425,          0.5,      15,
			   0.175,          0.5,      15,
			   0.175,          0.3,      79,
			   0.215,          0.3,    900,
				   0,           90,   4001,
			   0.215,         0.26,      1
		del 1

		material matGlass
		addx 0.6
		roty -90
		PRISM_ 13, 0.6,
				0.009639186745231, 0,      15,
				0.07890188948125, 0.2508053734962,      79,
				0.02106676900987, 0.2667771874214,    900,
						   0, 15.43808484718,   4079,
				0.08106676900987, 0.2667771874214,      79,
				0.08106676900987,          0.5,      79,
				0.07106676900987,          0.5,      79,
				0.07106676900987, 0.2681326249057,      79,
				0.01106676900987, 0.2681326249057,    900,
						   0, -15.43808484718,   4079,
				0.06890188948125, 0.2521608109805,      79,
						   0, 0.002661968987527,      79,
				0.009639186745231, 0,      1

		material matAppliance
		addz 0.1
		PRISM_ 10, 0.4,
				0.08057773594985,        0.134,      15,
				0.1116370219232, 0.2464679735465,      79,
				0.05380190145183, 0.2624397874717,    900,
						   0, 15.43808484718,   4001,
				0.1138019014518, 0.2624397874717,      79,
				0.1138019014518,          0.5,      79,
				0.08180190145183,          0.5,      79,
				0.08180190145183, 0.2586445625157,      79,
				0.04737991455083,        0.134,      79,
				0.08057773594985,        0.134,      1
		del 3
		CUTEND

		material matGreaseFilter
		addz 0.0618
		PRISM_ 11, 0.01,
				0.2210444444319, 0.2685333333157,      15,
				0.3789555555681, 0.2685333333157,      15,
				0.3789555555681, 0.3056888888771,    900,
						   0,           90,   4001,
				0.4161111111295, 0.3056888888771,      15,
				0.4161111111295, 0.4914666666843,      15,
				0.1838888888705, 0.4914666666843,      15,
				0.1838888888705, 0.3056888888771,      15,
				0.2210444444319, 0.3056888888771,    900,
						   0,           90,   4001,
				0.2210444444319, 0.2685333333157,     -1
		del 1

		muly -1
		addy -2*0.4
		if not(bWallMounted) then
			cutend
		endif
	next i
	del 2*parts

	if gs_detlevel_3D_m = 2 THEN
		material matKnob
		add 0.215, 0.134, 0.05
		rotx 90

		gx=.006 : gy=.007 : gz=.003 : gr=.0026
		MULy 3
		ADD gx/2 ,gy/2, 0
		GOSUB 9998
		DEL 2

		add .016, 0,0
		MULy 3
		ADD gx/2 ,gy/2, 0
		GOSUB 9998
		DEL 2

		add .016, 0,0
		MULy 3
		ADD gx/2 ,gy/2, 0
		GOSUB 9998
		DEL 2

		add .016, 0,0
		MULy 3
		ADD gx/2 ,gy/2, 0
		GOSUB 9998
		DEL 2
		del 3
		del 2
	ENDIF
	del 1
	if not(bWallMounted) then del 1
	del 1
endif


! --- Hood 9 ------------------------------------------------------------

if type_m = 9 then

	hotspot -a/2, b-0.08, zzyzx
	material matAppliance

	addz 0.04
	ruled 4 , 1*0+2*1+4*1+16*1+32*1+64*0,
		-0.04,			0.04,		0,
		-a+0.04,		0.04,		0,
		-a+0.04,		b,			0,
		-0.04,			b,			0,
		-(a-0.28)/2,	b-0.15,		0.24,
		-a+(a-0.28)/2,	b-0.15,		0.24,
		-a+(a-0.28)/2,	b,			0.24,
		-(a-0.28)/2,	b,			0.24

	addz 0.24
	prism_      5,     zzyzx-0.28,
		-(a-0.28)/2,	b-0.15,		15,
		-a+(a-0.28)/2,	b-0.15,		15,
		-a+(a-0.28)/2,	b,			15,
		-(a-0.28)/2,	b,			15,
		-(a-0.28)/2,	b-0.15,		-1
	del 2

	if gs_detlevel_3D_m = 1 then
		material matFilterTrim
		prism_      5,      0.04,
			0,      0,      15,
			0,      b,      15,
			-a,     b,      15,
			-a,     0,      15,
			0,      0,      -1
	else  ! Detailed
		material matKnob
		add -0.25, 0, 0.001
		rotx 90
		mulz 1

		block  0.16, 0.038, 0.004

		add 0.02, 0.01, 0.0041
		gx=0.01 : gy=0.024 : gz=0.005 : gr=0.0040
		add gx/2 ,gy/2, 0
		gosub 9997
		del 1

		add 0.018, 0,	0
		gx=0.01 : gy=0.024 : gz=0.005 : gr=0.0040
		add gx/2 ,gy/2, 0
		gosub 9997
		del 1

		add 0.038, 0,0
		gx=0.01 : gy=0.024 : gz=0.005 : gr=0.0040
		add gx/2 ,gy/2, 0
		gosub 9997
		del 1

		add 0.022, 0, 0
		gx=0.01 : gy=0.024 : gz=0.005 : gr=0.0040
		add gx/2 ,gy/2, 0
		gosub 9997
		del 1

		del 7

		addz 0.001
		material matGreaseFilter
		prism_      5,      0.001,
			-0.025,		0.08,		11,
			-0.025,		b-0.025,	11,
			-a+0.025,	b-0.025,	11,
			-a+0.025,	0.08,		11,
			-0.025,		0.08,		-1
		del 1

		resol gs_resol/2
		material matLamp
		add -a+2",0.01,-0.001
		rect a-4", .06
		del 1

		resol gs_resol
		material matFilterTrim
		prism_      17,      0.04,
			0,				b,			15,
			-a,				b,			15,
			-a,				0.04,		79,
			-a+.04,			0,			1079,
			-0.04,			0,			79,
			0,				0.04,		1079,
			0,				b,			-1,
			-0.025,			0.08,		11,
			-0.025,			b-0.025,	11,
			-a/2+0.015,		b-0.025,	11,
			-a/2+0.015,		0.08,		11,
			-0.025,			0.08,		-1,
			-a/2-0.015,		0.08,		11,
			-a/2-0.015,		b-0.025,	11,
			-a+0.025,		b-0.025,	11,
			-a+0.025,		0.08,		11,
			-a/2-0.015,		0.08,		-1

	endif
endif


! --- Hood 10 ----------------------------------------------------------

if type_m = 10 then
	RESOL gs_resol
	HOTSPOT -A/2,B,zzyzx
	addx -a

	mul (10/9)*a, (10/4)*b, 1

	MATERIAL matAppliance
	addz 0.076
	PRISM_ 11+11, zzyzx-0.076,
	   0.385,         0.16,      79,
	   0.515,         0.16,      79,
	   0.515,         0.22,    900,
		   0,           90,   4000,
	   0.575,         0.22,      79,
	   0.575,          0.4,      15,
	   0.325,          0.4,      15,
	   0.325,         0.22,      79,
	   0.385,         0.22,    900,
		   0,           90,   4000,
	   0.385,         0.16,      -1,
		0.3893662649005, 0.1680607967393,      79,
		0.5106337350995, 0.1680607967393,      79,
		0.5106337350995, 0.2240303983697,    900,
				   0,           90,   4001,
		0.5666033367299, 0.2240303983697,     79,
		0.5666033367299, 0.3919392032607,      15,
		0.3333966632701, 0.3919392032607,      15,
		0.3333966632701, 0.2240303983697,      79,
		0.3893662649005, 0.2240303983697,    900,
				   0,           90,   4001,
		0.3893662649005, 0.1680607967393,  -1
	del 1

	RESOL gs_resol*4
	CUTPOLYA  11, 1, 0,
		0.385,         0.16,      15,
		0.515,         0.16,      15,
		0.515,         0.22,    915,
			0,           90,   4015,
		0.575,         0.22,      15,
		0.575,          0.4,      15,
		0.325,          0.4,      15,
		0.325,         0.22,      15,
		0.385,         0.22,    915,
			0,           90,   4015,
		0.385,         0.16,      1


	MATERIAL matGlass
	addy 0.4
	rotx 90
	PRISM_ 11, 0.4,
		0.8965533748205,            0,      15,
		0.9, 0.009,      15,
		0.9, 0.009387266634753,      79,
		0.45, -1.216237733365,    900,
		0, 40.32239195017,   4000,
		0, 0.009387266634753,      15,
		0.003446625179512,            0.001,      15,
		0.003446625179512,            0,      79,
		0.45, -1.216237733365,    900,
		0, -40.32239195017,   4000,
		0.8965533748205,            0,      1

	CUTEND
	del 2


	CUTPOLYA  5, 1, 0,
		0.47, 0.129435206085,      15,
		0.6638981272483, 0.129435206085,      15,
		0.6638981272483, 0.3805647939149,      15,
		0.47, 0.3805647939149,      15,
		0.47, 0.129435206085,      1

	CUTPOLYA  5, 1, 0,
		0.43, 0.129435206085,      15,
		0.2361018727517, 0.129435206085,      15,
		0.2361018727517, 0.3805647939149,      15,
		0.43, 0.3805647939149,      15,
		0.43, 0.129435206085,      1

	MATERIAL matAppliance
	addy 0.4
	rotx 90
	PRISM_ 10, 0.29,
		0.6833333333333, 0.03820320139029,      15,
		0.6833333333333, 0.05820320139029,      15,
		0.45, -1.216237733365,    900,
		0, 20.75038426503,   4000,
		0.2166666666667, 0.05820320139029,      15,
		0.2166666666667, 0.0383,      15,
		0.2166666666667, 0.03820320139029,      79,
		0.45, 0.9306106087977,    900,
		0, 29.30562664068,   4000,
		0.6833333333333, 0.03820320139029,      1
	del 2

	CUTEND
	CUTEND

	MATERIAL matGreaseFilter
	addy 0.4-0.019
	rotx 90
	PRISM_ 7, 0.251,
		0.43, 0.03820320139029,      15,
		0.43, 0.008420050810866,      79,
		0.45, 0.9306106087977,    979,
		0, -12.16603110208,   4079,
		0.2361018727517, 0.03334642451319,      15,
		0.2361018727517, 0.03820320139029,      15,
		0.43, 0.03820320139029,      1

	PRISM_ 7, 0.251,
		0.47, 0.03820320139029,      15,
		0.47, 0.008420050810866,      79,
		0.45, 0.9306106087977,    979,
		0, 12.16603110208,   4079,
		0.6638981272483, 0.03334642451319,      15,
		0.6638981272483, 0.03820320139029,      15,
		0.47, 0.03820320139029,      1
	del 2

	if gs_detlevel_3D_m = 2 THEN
		material matKnob
		add 0.46, 0.19, 0.008
		rotz 90

		gx=.006 : gy=.007 : gz=.003 : gr=.0026
		MULy 3
		ADD gx/2 ,gy/2, 0
		GOSUB 9998
		DEL 2
				add .016, 0,0
		MULy 3
		ADD gx/2 ,gy/2, 0
		GOSUB 9998
		DEL 2
				add .016, 0,0
		MULy 3
		ADD gx/2 ,gy/2, 0
		GOSUB 9998
		DEL 2
				add .016, 0,0
		MULy 3
		ADD gx/2 ,gy/2, 0
		GOSUB 9998
		DEL 2
		del 3
		del 2
	ENDIF

	del 2
endif

del 1

end


9996:
	rotz beta
	roty -90
	addz  0 !-gr1-.002
	cutpolya 6, 1,.0,
		0,2*gv, 15,
		gz,gv,15,
		gz+gv, 0, 15,
		gz, -gv, 15,
		0,-2*gv, 15,
		0,2*gv, -1
	del 2
	cone  gz,gr1,gr2, 90,90
	cutend

	roty -90
	addz -gr1-gv/4

	prism_ 6, 1.9*gr1,
		0,2*gv, 64+15,
		gz,gv,64+15,
		gz+gv, 0, 15,
		gz, -gv, 64+15,
		0,-2*gv, 64+15,
		0,2*gv, -1

	del  3
return

9997:
	mm=15
	prism_ 10, gz-gr,
				-gx/2,		-gy/2+gr,	64+mm,
				-gx/2,		 gy/2-gr,   64+mm,
				-gx/2+gr,    gy/2,      1000+64+mm,
				 gx/2-gr,    gy/2,      64+mm,
				 gx/2,		 gy/2-gr,   1000+64+mm,
				 gx/2,		-gy/2+gr,   64+mm,
				 gx/2-gr,	-gy/2,		1000+64+mm,
				-gx/2+gr,   -gy/2,      64+mm,
				-gx/2,		-gy/2+gr,	1000+64+mm,
				-gx/2,		-gy/2+gr,	-1
	m=64
	mm=15
	rotz -90
	rotx 90
	add 0,gz-gr, -(gx-2*gr)/2
	mul 5*(gy-2*gr), 5*(gy-2*gr), 1
	prism_      20,      gx-2*gr,
			   -0.095396,   0.029993,		m+mm,
				0.0,		0.0,			900+m+mm,
				0.0,		17.4536,		4000+m+mm,
			   -0.1,		0.0,			m+mm,
				0.1,		0.0,			m+mm,
				0.0,		0.0,			900+m+mm,
				0.0,		11.3325,		4000+m+mm,
				0.09805,    0.01965,		m+mm,
				0.088245,   0.017685,		900+m+mm,
				0.0,		105.1596,		4000+m+mm,
				0.083785,   0.026635,		m+mm,
				0.035992,   0.114475,		900+m+mm,
				0.0,		-91.6331,		4000+m+mm,
			   -0.053174,   0.069205,		m+mm,
			   -0.062248,   0.065002,		900+m+mm,
				0.0,		108.9013,		4000+m+mm,
			   -0.069164,   0.072224,		m+mm,
			   -0.0,		0.0,			900+m+mm,
				0.0,		28.7861,		4000+m+mm,
			   -0.095396,   0.029993,		-1
	del 4
return

9998:
	Prism_ 10, gz-gr,
			-gx/2,    -gy/2+gr,  64+11,
			-gx/2,     gy/2-gr,    64+11,
			-gx/2+gr,     gy/2,      1000+64+11,
			gx/2-gr,     gy/2,      64+11,
			gx/2,     gy/2-gr,      1000+64+11,
			gx/2,    -gy/2+gr,      64+11,
			gx/2-gr,  -gy/2,   1000+64+11,
			-gx/2+gr,    -gy/2,      64+11,
			-gx/2,    -gy/2+gr,  1000+64+11,
			-gx/2,    -gy/2+gr,  -1

	ROTy -90
	ADD gz-gr,-gy/2, -gx/2+gr
	PRISM_ 8,gx-2*gr,
		gr,gy-gr,10+64,
		0,gy-gr,900+10+64,
		-0.01,gy,3000+8,
		-0.01,-0.0001,8,
		0,0,10+64,
		0,gr,900+10+64,
		gr,gr,3000+10+64,
		gr,gy-gr,10+64
	DEL 2
return

"shell":
	if part=3 then
		h1= zz-e
		ty= b
		ax= aa/1.5
		az1= h1/0.103
		az2= zz/0.136

		for i=1 to 5

			addy (ty/6)*i

			cutpolya 9, 2, 0,

					0.5668507756979*ax, 0.01621367865759*az,      79,
					-0.5668507756979*ax, 0.01621367865759*az,     79,
					-0.5668507756979*ax,            0,    979,
							   0,          180,   4079,
					-0.5668507756979*ax, -0.01621367865759*az,     79,
					0.5668507756979*ax, -0.01621367865759*az,      79,
					0.5668507756979*ax,            0,    979,
							   0,          180,   4079,
					0.5668507756979*ax, 0.01621367865759*az,     79

			del 1
		next i

		ax=aa/1.2
		rotx 90
		roty 180
		ruled{2} 25, 7,
				-0.6*ax, 				-0.09202588626644*az1,      1,
				-0.602669410363*ax, 	-0.09381897180287*az1,      1,
				-0.6037176578658*ax,	 -0.09690119910453*az1,      1,
				-0.6037176578658*ax, 	-0.1369011991045*az1,      1,
				-0.6018580114653*ax, 	-0.1427093522771*az1,      1,
				-0.5977638499585*ax, 	-0.1460460517304*az1,      1,
				-0.45*ax, 				-0.1512111212153*az1,      1,
				-0.225*ax, 			-0.1562761586036*az1,      1,
				0, 					-0.1579641242481*az1,      1,
				0.225*ax, 				-0.1562761586036*az1,      1,
				0.45*ax, 				-0.1512111212153*az1,      1,
				0.5977638499585*ax, 	-0.1460460517304*az1,      1,
				0.6018580114653*ax, 	-0.1427093522771*az1,      1,

				0.6037176578658*ax, 	-0.1369011991045*az1,      1,
				0.6037176578658*ax, 	-0.09690119910453*az1,      1,
				0.602669410363*ax, 	-0.09381897180287*az1,      1,
				0.6*ax, 				-0.0922173151039*az1,      1,
				0.4535189588908*ax, 	-0.05216928551319*az1,      1,
				0.3044215651166*ax, 	-0.02335076285338*az1,      1,
				0.1535673852837*ax, 	-0.005927889798668*az1,      1,
				0,            		0,      				1,
				-0.1521962614328*ax, 	-0.005776105762362*az1,      1,
				-0.3035116612282*ax, 	-0.02311724691044*az1,      1,
				-0.4530686810814*ax, 	-0.05192285754793*az1,      1,
				-0.6*ax, 				-0.09202588626644*az1,      1,


				-0.6*ax, 				-0.1252272915132*az2,			ty,
				-0.6023588520592*ax, 	-0.1266673773412*az2,			ty,
				-0.6037176578658*ax, 	-0.1301581901925*az2,			ty,
				-0.6037176578658*ax, 	-0.1369011991045*az2,			ty,
				-0.6020258680752*ax, 	-0.1424665960461*az2,			ty,
				-0.5977638499585*ax, 	-0.1460460517304*az2,			ty,
				-0.45*ax, 				-0.1512111212153*az2,			ty,
				-0.225*ax, 			-0.1562761586036*az2,			ty,
				0, 					-0.1579641242481*az2, 			ty,
				0.225*ax, 				-0.1562761586036*az2,			ty,
				0.45*ax, 				-0.1512111212153*az2,			ty,
				0.5977638499585*ax, 	-0.1460460517304*az2,			ty,
				0.6020258680752*ax, 	-0.1424665960461*az2,			ty,

				0.6037176578658*ax, 	-0.1369011991045*az2,			ty,
				0.6037176578658*ax, 	-0.1301581901925*az2,			ty,
				0.6023588520592*ax, 	-0.1266673773412*az2,			ty,
				0.6*ax, 				-0.1252272915132*az2,			ty,
				0.4556413910887*ax, 	-0.0708775690212*az2,			ty,
				0.3064644655338*ax, 	-0.03164053060395*az2,			ty,
				0.1540467395077*ax, 	-0.007931100100588*az2,			ty,
				0,            		0,			ty,
				-0.1540467395077*ax, 	-0.007931100100588*az2,			ty,
				-0.3064644655338*ax, 	-0.03164053060395*az2,			ty,
				-0.4556413910887*ax, 	-0.0708775690212*az2,			ty,
				-0.6*ax, 				-0.1252272915132*az2, 			ty

		tt=0.097
		rotx -90
		addz -tt*az1
		revolve 14, 90,15,
			0.6037176578658*ax, 				0,      1,
			0.6037176578658*ax, 	tt*az1-0.09690119910453*az1,      1,
			0.602669410363*ax, 		tt*az1-0.09381897180287*az1,      1,
			0.6*ax, 				tt*az1-0.0922173151039*az1,      1,
			0.4535189588908*ax, 	tt*az1-0.05216928551319*az1,      1,
			0.3044215651166*ax, 	tt*az1-0.02335076285338*az1,      1,
			0.1535673852837*ax, 	tt*az1-0.005927889798668*az1,     1,
			0,            			tt*az1-0,      					1,
			-0.1521962614328*ax, 	tt*az1-0.005776105762362*az1,      1,
			-0.3035116612282*ax, 	tt*az1-0.02311724691044*az1,      1,
			-0.4530686810814*ax, 	tt*az1-0.05192285754793*az1,      1,
			-0.6*ax, 				tt*az1-0.09202588626644*az1,      1,
			-0.602669410363*ax, 	tt*az1-0.09381897180287*az1,      1,
			-0.6037176578658*ax,	tt*az1-0.09690119910453*az1,      1

		th=zz*0.6
		addz -th
		prism_ 15, th,
				0.6037176578658*ax, 				0,      9,
				0.6037176578658*ax, 	tt*az1-0.09690119910453*az1,      75,
				0.602669410363*ax, 		tt*az1-0.09381897180287*az1,      75,
				0.6*ax, 				tt*az1-0.0922173151039*az1,      75,
				0.4535189588908*ax, 	tt*az1-0.05216928551319*az1,    75,
				0.3044215651166*ax, 	tt*az1-0.02335076285338*az1,      75,
				0.1535673852837*ax, 	tt*az1-0.005927889798668*az1,     75,
				0,            		tt*az1-0,      				75,
				-0.1521962614328*ax, 	tt*az1-0.005776105762362*az1,      75,
				-0.3035116612282*ax, 	tt*az1-0.02311724691044*az1,      75,
				-0.4530686810814*ax, 	tt*az1-0.05192285754793*az1,      75,
				-0.6*ax, 				tt*az1-0.09202588626644*az1,      75,
				-0.602669410363*ax, 	tt*az1-0.09381897180287*az1,      75,
				-0.6037176578658*ax,	tt*az1-0.09690119910453*az1,      75,
				-0.6037176578658*ax, 				0,      8

		rotz 180
		az1= h1/0.03
		prism_ 15, th/2,
							0.6037176578658*ax, 				0,      9,
				0.6037176578658*ax, 	tt*az1-0.09690119910453*az1,      75,
				0.602669410363*ax, 		tt*az1-0.09381897180287*az1,      75,
				0.6*ax, 				tt*az1-0.0922173151039*az1,      75,
				0.4535189588908*ax, 	tt*az1-0.05216928551319*az1,    75,
				0.3044215651166*ax, 	tt*az1-0.02335076285338*az1,      75,
				0.1535673852837*ax, 	tt*az1-0.005927889798668*az1,     75,
				0,            		tt*az1-0,      				75,
				-0.1521962614328*ax, 	tt*az1-0.005776105762362*az1,      75,
				-0.3035116612282*ax, 	tt*az1-0.02311724691044*az1,      75,
				-0.4530686810814*ax, 	tt*az1-0.05192285754793*az1,      75,
				-0.6*ax, 				tt*az1-0.09202588626644*az1,      75,
				-0.602669410363*ax, 	tt*az1-0.09381897180287*az1,      75,
				-0.6037176578658*ax,	tt*az1-0.09690119910453*az1,      75,
						-0.6037176578658*ax, 				0,      8
		del 6

		addy ty
		tt=0.14
		addz -tt*az2
		revolve 14, 90,15,
			0.6037176578658*ax, 	0,      1,
			0.6037176578658*ax, 	tt*az2-0.1301581901925*az2,      1,
			0.602669410363*ax, 		tt*az2-0.1266673773412*az2,      1,
			0.6*ax, 				tt*az2-0.1252272915132*az2,      1,
			0.4535189588908*ax, 	tt*az2-0.0708775690212*az2,      1,
			0.3044215651166*ax, 	tt*az2-0.03164053060395*az2,      1,
			0.1535673852837*ax, 	tt*az2-0.007931100100588*az2,     1,
			0,            			tt*az2-0,      					1,
			-0.1521962614328*ax, 	tt*az2-0.007931100100588*az2,      1,
			-0.3035116612282*ax, 	tt*az2-0.03164053060395*az2,      1,
			-0.4530686810814*ax, 	tt*az2-0.0708775690212*az2,      1,
			-0.6*ax, 				tt*az2-0.1252272915132*az2,      1,
			-0.602669410363*ax, 	tt*az2-0.1266673773412*az2,      1,
			-0.6037176578658*ax,	tt*az2-0.1301581901925*az2,      1

		th=zz*0.3
		addz -th
		prism_ 15, th,
			0.6037176578658*ax, 	0,      9,
			0.6037176578658*ax, 	tt*az2-0.1301581901925*az2,      75,
			0.602669410363*ax, 		tt*az2-0.1266673773412*az2,      75,
			0.6*ax, 				tt*az2-0.1252272915132*az2,      75,
			0.4535189588908*ax, 	tt*az2-0.0708775690212*az2,      75,
			0.3044215651166*ax, 	tt*az2-0.03164053060395*az2,      75,
			0.1535673852837*ax, 	tt*az2-0.007931100100588*az2,     75,
			0,            			tt*az2-0,      					75,
			-0.1521962614328*ax, 	tt*az2-0.007931100100588*az2,      75,
			-0.3035116612282*ax, 	tt*az2-0.03164053060395*az2,     75,
			-0.4530686810814*ax, 	tt*az2-0.0708775690212*az2,      75,
			-0.6*ax, 				tt*az2-0.1252272915132*az2,      75,
			-0.602669410363*ax, 	tt*az2-0.1266673773412*az2,      75,
			-0.6037176578658*ax,	tt*az2-0.1301581901925*az2,      75,
			-0.6037176578658*ax,	0,      8

		rotz 180
		prism_ 15, th,
			0.6037176578658*ax, 	0,      9,
			0.6037176578658*ax, 	tt*az2-0.1301581901925*az2,      75,
			0.602669410363*ax, 		tt*az2-0.1266673773412*az2,      75,
			0.6*ax, 				tt*az2-0.1252272915132*az2,      75,
			0.4535189588908*ax, 	tt*az2-0.0708775690212*az2,      75,
			0.3044215651166*ax, 	tt*az2-0.03164053060395*az2,      75,
			0.1535673852837*ax, 	tt*az2-0.007931100100588*az2,     75,
			0,            			tt*az2-0,      					75,
			-0.1521962614328*ax, 	tt*az2-0.007931100100588*az2,      75,
			-0.3035116612282*ax, 	tt*az2-0.03164053060395*az2,     75,
			-0.4530686810814*ax, 	tt*az2-0.0708775690212*az2,      75,
			-0.6*ax, 				tt*az2-0.1252272915132*az2,      75,
			-0.602669410363*ax, 	tt*az2-0.1266673773412*az2,      75,
			-0.6037176578658*ax,	tt*az2-0.1301581901925*az2,      75,
			-0.6037176578658*ax,	0,      8

		del 4

		for i=1 to 5
			cutend
		next i
	endif

	if part=0 then
		h1= zz-e
		ty= bb
		ax=aa/1.2
		az1=h1/0.103
		az2=zz/0.136

		rotx 90
		roty 180
		ruled{2} 11, 55,
			-0.6*ax,					t,					0,
			-0.62*ax, 					-0.1025108121015*az1,		0,		!1
			-0.4531008700192*ax,		-0.06219830647545*az1,		1,		!2
			-0.3035485506533*ax,		-0.03324047038111*az1,		1,		!3
			-0.1522193530286*ax,		-0.01580698406193*az1,		1,		!4
			0,							-0.009999976842397*az1,		1,		!5
			0.1522249751529*ax, 		-0.015854114205*az1,		1,		!6
			0.3035561081205*ax, 		-0.03333558745052*az1,		1,		!7
			0.4531065782975*ax, 		-0.06234197609019*az1,		1,		!8
			0.62*ax, 					-0.1027032988213*az1,		0,		!9
			0.6*ax, 					t,					0,

			-0.6*ax,					t,					ty,
			-0.62*ax, 					-0.1361451690154*az2,		ty,
			-0.4557232869545*ax, 		-0.08140340979987*az2,		ty,
			-0.306558560338*ax, 		-0.04187728599973*az2,		ty,
			-0.1541057366544*ax, 		-0.01799074836552*az2,		ty,
			0,						-0.01*az2,					ty,
			0.1541057366544*ax, 		-0.01799074836552*az2,		ty,
			0.306558560338*ax, 			-0.04187728599973*az2,		ty,
			0.4557232869545*ax, 		-0.08140340979987*az2,		ty,
			0.62*ax, 					-0.1361451690154*az2,		ty,
			0.6*ax, 					t,					ty
		del 2
	endif

	if part=1 then
		h1= zz-e
		ty= bb
		ax=aa/1.2
		az1=h1/0.103
		az2=zz/0.136

		if SYMB_MIRRORED then mulx -1
		rotx 90
		roty 180

		vert	-0.6*ax, 					-0.1025108121015*az1,		0		!1
		vert	-0.4531008700192*ax,		-0.06219830647545*az1,		0		!2
		vert	-0.3035485506533*ax,		-0.03324047038111*az1,		0		!3
		vert	-0.1522193530286*ax,		-0.01580698406193*az1,		0		!4
		vert	0,							-0.009999976842397*az1,		0		!5
		vert	0.1522249751529*ax, 		-0.015854114205*az1,		0		!6
		vert	0.3035561081205*ax, 		-0.03333558745052*az1,		0		!7
		vert	0.4531065782975*ax, 		-0.06234197609019*az1,		0		!8
		vert	0.6*ax, 					-0.1027032988213*az1,		0		!9
		vert	0.6*ax, 					-0.0922173151039*az1,		0		!10
		vert	0.4535189588908*ax, 		-0.05216928551319*az1,		0		!11
		vert	0.3044215651166*ax, 		-0.02335076285338*az1,		0 		!12
		vert	0.1535673852837*ax, 		-0.005927889798668*az1,		0		!13
		vert	0,            			0,						0		!14
		vert	-0.1521962614328*ax, 		-0.005776105762362*az1,		0		!15
		vert	-0.3035116612282*ax, 		-0.02311724691044*az1,		0		!16
		vert	-0.4530686810814*ax, 		-0.05192285754793*az1,		0		!17
		vert	-0.6*ax, 					-0.09202588626644*az1,		0		!18
		vert	-0.6*ax, 					-0.1025108121015*az1,		0		!19

		addz ty

		vert	-0.6*ax, 					-0.1361451690154*az2,		0
		vert	-0.4557232869545*ax, 		-0.08140340979987*az2,		0
		vert	-0.306558560338*ax, 		-0.04187728599973*az2,		0
		vert	-0.1541057366544*ax, 		-0.01799074836552*az2,		0
		vert	0,						-0.01*az2,					0
		vert	0.1541057366544*ax, 		-0.01799074836552*az2,		0
		vert	0.306558560338*ax, 			-0.04187728599973*az2,		0
		vert	0.4557232869545*ax, 		-0.08140340979987*az2,		0
		vert	0.6*ax, 					-0.1361451690154*az2,		0
		vert	0.6*ax, 					-0.1252272915132*az2,		0
		vert	0.4556413910887*ax, 		-0.0708775690212*az2,		0
		vert	0.3064644655338*ax, 		-0.03164053060395*az2,		0
		vert	0.1540467395077*ax, 		-0.007931100100588*az2,		0
		vert	0,            			0,						0
		vert	-0.1540467395077*ax, 		-0.007931100100588*az2,		0
		vert	-0.3064644655338*ax, 		-0.03164053060395*az2,		0
		vert	-0.4556413910887*ax, 		-0.0708775690212*az2,		0
		vert	-0.6*ax, 					-0.1252272915132*az2,		0
		vert	-0.6*ax, 					-0.1361451690154*az2,		0

		del 3


		n_p=2
		n_n=19
		bc_b=0
		bc_t=1
		bc_c=1
		te_i=2

		gosub 2000

		if SYMB_MIRRORED then del 1
	endif

	rotz 90
	vert 0, 0, 0
	vert 0.1, 0, 0
	vert 0, 0.1, 0
	vert 0, 0, 0.1
	del 1

	coor 2, 1, 2, 3, 4

	base

	body -1

	base

return

2000:
	for pii = 0 to n_p-2 step 1
		for nii = pii*n_n+1 to pii*n_n+n_n-1 step 1
			edge nii, nii+1, -1, -1, 2
		next nii

		if bc_c = 1 and bc_b = 1 then
			edge pii*n_n+n_n, pii*n_n+1, -1, -1, 2
		else
			if bc_b = 1 and pii = 0 then
				edge pii*n_n+n_n, pii*n_n+1, -1, -1, 2
			endif
			if bc_c = 1 then
				edge pii*n_n+n_n, pii*n_n+1, -1, -1, 2
			endif
		endif

		for nii = pii*n_n+1 to pii*n_n+n_n-1 step 1
			edge nii, nii+n_n, -1, -1, 2
			edge nii, nii+n_n+1, -1, -1, 2
		next nii

		edge pii*n_n+n_n, pii*n_n+n_n+n_n, -1, -1, 2

		if bc_c = 1 then
			edge pii*n_n+n_n, pii*n_n+1+n_n, -1, -1, 2
		endif
	next pii

	if te_i=0 then
		teic = 1
	else
		if te_i=2 then
			teic = 0
		else
			teic = 2
		endif
	endif

	for nii = (n_p-1)*n_n+1 to (n_p-1)*n_n+n_n-1 step 1
		edge nii, nii+1, -1, -1, teic
	next nii
	if bc_c = 1 or bc_t = 1 then
		edge (n_p-1)*n_n+n_n, (n_p-1)*n_n+1, -1, -1, teic
	endif

	if bc_b = 1 then
		for ii = -1 to -(n_n) step -1
			put -(ii)
		next ii
		pgon nsp, 0, 2, get(nsp)
	endif

	if bc_c = 1 then
		ste_1 = n_n + n_n*2
		ste_n_1 = n_n
		ste = n_n + n_n*2
		ste_n = n_n
	else
		if bc_b = 1 then
			ste_1 = n_n + n_n*2 - 1
			ste_n_1 = n_n
		else
			ste_1 = n_n-1 + (n_n-1)*2 + 1
			ste_n_1 = n_n-1
		endif
		ste = n_n-1 + (n_n-1)*2 + 1
		ste_n = n_n-1
	endif

	pcc = ste_1 + (n_p-2)*ste

	jj = 1+ste_n_1
	for nii = 1 to n_n-1 step 1
		pgon 3, 0, 2, jj+1, -(jj+2), -(nii)
		pgon 3, 0, 2, nii+ste_1, -(jj+1), jj
	jj = jj+2
	next nii
	if bc_c = 1 then
		pgon 3, 0, 2, ste_n_1+n_n*2, -(1+ste_n_1), -(n_n)
		pgon 3, 0, 2, ste_n_1+n_n*2+n_n, -(ste_n_1+n_n*2), ste_n_1+n_n*2-1
	endif


	for pii = ste_1+1 to pcc step ste
		jj = pii+ste_n
		for nii = pii to pii+n_n-2 step 1
			pgon 3, 0, 2, jj+1, -(jj+2), -(nii)
			pgon 3, 0, 2, nii+ste, -(jj+1), jj
		jj = jj+2
		next nii
		if bc_c = 1 then
			pgon 3, 0, 2, pii+ste_n+n_n*2-1, -(pii+ste_n), -(pii+n_n-1)
			pgon 3, 0, 2, pii+ste_n+n_n*2-1+n_n, -(pii+ste_n+n_n*2-1), pii+ste_n+n_n*2-2
		endif

	next pii

	if bc_t = 1 then

		if bc_c = 1 then
			e_c = n_n*3*(n_p-1)
		else
			if bc_b = 1 then
				e_c = ((n_n-1)*3+1)*(n_p-1) + 1
			else
				e_c = ((n_n-1)*3+1)*(n_p-1)
			endif
		endif

		for ii = e_c+n_n to e_c+1 step -1
			put -(ii)
		next ii
		pgon nsp, 0, 2, get(nsp)
	endif

	base
return

end
