
IF not(gs_shadow) THEN SHADOW OFF

pen gs_cont_pen


if gs_detlevel_3D_m = DLEV3D_OFF then end
if gs_detlevel_3D_m = DLEV3D_SIMPLE then gs_resol = 4


! ------------------------------------------------------------------------------
! legs
! ------------------------------------------------------------------------------
RESOL gs_resol
material gs_leg_mat

minkonzol = min(b - tbtt, (a - 0.08) / 2) 
if tableTopUp then
	add (a - tbtt) / 2, b - minkonzol - tbtt, zzyzx - tbtt - 0.08
else
	add a, b - 2*tbtt, zzyzx - tbtt - 0.08
endif
if not(tableTopUp) then
	rotz 90
	addy a/2 - minkonzol - 0.04
else
	addy 0
endif
block tbtt, minkonzol, .08

add 0, minkonzol - 0.08, -b/2
block tbtt, 0.08, b/2
del 1

alfa = atn(minkonzol / (b/2))
valtx = (minkonzol - 0.08) / sin(alfa)
valtxx = 0.08 / tan(alfa)
valtxxx = 0.08 * tan(alfa)

rotx 90
roty 90
rotz -90+alfa
prism_ 5, tbtt,
		0, 0, 15,
		valtx, 0, 15,
		valtx-valtxx, 0.08, 15,
		valtxxx, 0.08, 15,
		0, 0, -1

del 5

if not(tableTopUp) then del 2


!vert 0,0,0
!vert zzyzx,0,0
!vert 0,0.1,0
!vert 0,0,0.1
!coor 2,-1,-4,-3,-2
!base
!

! ------------------------------------------------------------------------------
! table
! ------------------------------------------------------------------------------

material gs_top_mat


unID = 1
hotspot 0, b, zzyzx,					2
hotspot a, b, zzyzx,					4
if tableTopUp then
	if top_type_m = 1 then
		hotspot a/2, b/2, zzyzx,		5
		hotspot 0, 0, zzyzx,			1
		hotspot a, 0, zzyzx,			3
	else
		hotspot a/2, 0, zzyzx,			1
		hotspot a/2, 0, zzyzx,			3
	endif
else
		hotspot 0, b - 3*tbtt, zzyzx,	1
		hotspot a, b - 3*tbtt, zzyzx,	3
endif
unID = 6


add 0, 0, zzyzx-tbtt
if not(tableTopUp) then
	addy b-3*tbtt
	rotx -90
endif
if top_type_m = 2 then
	resol 30
	if tableTopUp then
		addy b-2*tbtt
		muly (b-2*tbtt)/(a/2)
	else
		muly -(b-2*tbtt)/(a/2)
	endif

	prism_  5, tbtt,
		0,0,15,
		A,0,15,
		A/2, 0,900+15,
		0, -180,4000+15,
		0,0,-1

	if tableTopUp then
		del 2
	else
		del 1
	endif
else
	block a, b-2*tbtt, tbtt
endif
if not(tableTopUp) then del 2

add 0, b-2*tbtt, 0
block a, 2*tbtt, tbtt
del 1

add 0, b-tbtt, -.08
block a, tbtt, .08
del 1

add a/2-0.04, b-tbtt, -b/2-.08
block .08, tbtt, b/2
del 1

if a>b then gosub 5000
if a<b then gosub 1000

del 1

vert 0,0,0
vert a,0,0
vert 0,b,0
vert 0,0,tbtt
coor 1,-1,-2,-3,-4
base
body -1


! ==============================================================================
end
! ==============================================================================


1000:
	roty 90
	gosub 5000
	del 1
	return

5000:
	vert 0, 0, 0
	vert 1, 0, 0
	vert 0, 1, 0
	vert 0, 0, 1

	coor 2, -1, -2, -3, -4

	base

	body -1

	return
