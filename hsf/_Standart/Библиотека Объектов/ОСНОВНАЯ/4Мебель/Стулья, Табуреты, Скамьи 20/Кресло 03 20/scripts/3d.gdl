
IF gs_detlevel_3D_m=0 THEN END

RESOL gs_resol
PEN gs_cont_pen


IF gs_shadow=0 THEN SHADOW OFF

IF GLOB_CONTEXT>20 and GLOB_CONTEXT<40 THEN gs_detlevel_3D_m=1


IF gs_detlevel_3D_m=1 THEN
RESOL 4
ENDIF

ADD a/2,b/2,0
unID=1

HOTSPOT -a/2, -b/2, 0, unID: unID=unID+1
HOTSPOT  a/2, -b/2, 0, unID: unID=unID+1
HOTSPOT -a/2,  b/2, 0, unID: unID=unID+1
HOTSPOT  a/2,  b/2, 0, unID: unID=unID+1

hotspot -a/2, b/2-b/(0.678+(zzyzx-0.79870707-gs_seat_height+0.34737)*TAN(15))*0.11*COS(15), 0, unID, zzyzx, 1+128: unID=unID+1
hotspot -a/2, b/2-b/(0.678+(zzyzx-0.79870707-gs_seat_height+0.34737)*TAN(15))*0.11*COS(15), -1, unID, zzyzx, 3: unID=unID+1
hotspot -a/2, b/2-b/(0.678+(zzyzx-0.79870707-gs_seat_height+0.34737)*TAN(15))*0.11*COS(15), zzyzx, unID, zzyzx, 2: unID=unID+1

hotspot a/2, b/2-b/(0.678+(zzyzx-0.79870707-gs_seat_height+0.34737)*TAN(15))*0.11*COS(15), 0, unID, zzyzx, 1+128: unID=unID+1
hotspot a/2, b/2-b/(0.678+(zzyzx-0.79870707-gs_seat_height+0.34737)*TAN(15))*0.11*COS(15), -1, unID, zzyzx, 3: unID=unID+1
hotspot a/2, b/2-b/(0.678+(zzyzx-0.79870707-gs_seat_height+0.34737)*TAN(15))*0.11*COS(15), zzyzx, unID, zzyzx, 2: unID=unID+1


ADDY -b/2
MUL a/0.5774, b/(0.678+(zzyzx-0.79870707-gs_seat_height+0.34737)*TAN(15)), 1

! Hotspot editing !
IF gs_full_edit=1 THEN

	hotspot -0.258, 0.11*SIN(15), 0, unID, gs_seat_height, 1+128: unID=unID+1
	hotspot -0.258, 0, -1, unID, gs_seat_height, 3: unID=unID+1
	hotspot -0.258, 0.11*SIN(15), gs_seat_height+0.44*SIN(15), unID, gs_seat_height, 2: unID=unID+1

	hotspot 0.258, 0.11*SIN(15), 0, unID, gs_seat_height, 1+128: unID=unID+1
	hotspot 0.258, 0, -1, unID, gs_seat_height, 3: unID=unID+1
	hotspot 0.258, 0.11*SIN(15), gs_seat_height+0.44*SIN(15), unID, gs_seat_height, 2: unID=unID+1

ENDIF

ADD -0.516/2, -0.02, 0

ROTZ 90

ADDZ gs_seat_height-0.34737
ADD 0.02,-0.518, 0.355
ROTY 15
	CALL "fa_cushion" parameters gs_detlevel_3D_m=gs_detlevel_3D_m,
	cush_a=0.44, cush_b=0.516, cush_h=0.11,
	r1=0.015, r2=0.005, gs_resol=gs_resol, cush_mat=gs_seat_mat
DEL 2

ADD 0.555,-0.518, 0.21
ROTY -75
	CALL "fa_cushion" parameters gs_detlevel_3D_m=gs_detlevel_3D_m,
	cush_a=0.58+(zzyzx-0.79870707-gs_seat_height+0.34737)/COS(15), cush_b=0.516, cush_h=0.11,
	r1=0.015, r2=0.005, gs_resol=gs_resol, cush_mat=gs_seat_mat
DEL 2
DEL 1

MATERIAL gs_frame_mat
ADDY -0.26
GOSUB 20
MULY -1
GOSUB 20
DEL 1
GOSUB 10
MULY -1
GOSUB 10
DEL 2

IF gs_detlevel_3D_m=2 THEN
ADD 0.05,0.01,0
CYLIND 0.005,0.019
ADD 0,-0.54,0
CYLIND 0.005,0.019
ADD 0.53,0.07,0
CYLIND 0.005,0.019
ADD 0,0.4,0
CYLIND 0.005,0.019
DEL 4
ENDIF

DEL 5

END

10:
seg=24
FOR xx=1 TO seg/4-1
PUT 0.181-0.05*cos(4.6+360/seg*xx),
 -0.27,
 0.547+0.05*sin(4.6+360/seg*xx)+gs_seat_height-0.34737,
 0
NEXT xx
FOR xx=1 TO seg/4-1
PUT  0.642+0.02*sin(360/seg*xx),
 -0.25-0.02*cos(360/seg*xx),
 0.55+gs_seat_height-0.34737,
 0
NEXT xx

TUBE 2, 8+nsp/4,1+2+4+8,
 0,0,901,
 0.012,360,4001,

 0.05,-0.27, -1,0,
 0.05,-0.27, 0,0,
 0.131,-0.27,0.551+gs_seat_height-0.34737,0,

 GET (nsp/2),
 0.186,-0.27, 0.597+gs_seat_height-0.34737,0,
 0.642,-0.27, 0.55+gs_seat_height-0.34737,0,
 GET (nsp),
 0.662,-0.25, 0.55+gs_seat_height-0.34737,0,
 0.662,-0.00001, 0.55+gs_seat_height-0.34737,0,
 0.662,-0.0, 0.55+gs_seat_height-0.34737,0

RETURN

20:
TUBE 2,5,17,
	0,0,901,
	0.012,360,4001,

	0.581,0.2,0,0,
	0.581,0.2,0.0001,0,
	0.58,0.2,0.248+gs_seat_height-0.34737,0,
	0.66,0.2,0.55+gs_seat_height-0.34737,0,
	0.66,0.2,0.5501+gs_seat_height-0.34737,0
RETURN
