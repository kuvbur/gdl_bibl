
! Armchair 04

IF gs_detlevel_3D_m=0 THEN END

RESOL gs_resol
PEN gs_cont_pen


IF gs_shadow=0 THEN SHADOW OFF

IF GLOB_CONTEXT>20 and GLOB_CONTEXT<40  THEN gs_detlevel_3D_m=1

ADD a/2,b/2,0
armw=0.06: frmw=a-armw*2
zz=1.02-0.0193
bb=(b-0.08)/0.8031

PEN gs_cont_pen
RESOL gs_resol

unID=1

HOTSPOT -a/2, -b/2, 0, unID: unID=unID+1
HOTSPOT  a/2, -b/2, 0, unID: unID=unID+1
HOTSPOT -a/2,  b/2, 0, unID: unID=unID+1
HOTSPOT  a/2,  b/2, 0, unID: unID=unID+1

hotspot -a/2+armw, b/2-0.02, 0, unID, zzyzx, 1+128: unID=unID+1
hotspot -a/2+armw, b/2-0.02, -1, unID, zzyzx, 3: unID=unID+1
hotspot -a/2+armw, b/2-0.02, zzyzx, unID, zzyzx, 2: unID=unID+1

hotspot a/2-armw, b/2-0.02, 0, unID, zzyzx, 1+128: unID=unID+1
hotspot a/2-armw, b/2-0.02, -1, unID, zzyzx, 3: unID=unID+1
hotspot a/2-armw, b/2-0.02, zzyzx, unID, zzyzx, 2: unID=unID+1


! Hotspot editing !
IF gs_full_edit=1 THEN

	hotspot -a/2+0.085, -b/2, 0, unID, gs_seat_height, 1+128: unID=unID+1
	hotspot -a/2+0.085, 0, -1, unID, gs_seat_height, 3: unID=unID+1
	hotspot -a/2+0.085, -b/2, gs_seat_height+0.073, unID, gs_seat_height, 2: unID=unID+1

	hotspot a/2-0.085, -b/2, 0, unID, gs_seat_height, 1+128: unID=unID+1
	hotspot a/2-0.085, 0, -1, unID, gs_seat_height, 3: unID=unID+1
	hotspot a/2-0.085, -b/2, gs_seat_height+0.073, unID, gs_seat_height, 2: unID=unID+1
ENDIF


ADDY -b/2

MATERIAL gs_frame_mat

ROTZ -90

ADDX -0.06
ADD -0.704847*bb, -a/2+armw, 0
	BLOCK 0.07, a-armw*2, 0.02
DEL 1

gosub 2000

ADDY -a/2
	GOSUB 100
ADDY a-armw
	GOSUB 100
DEL 2

ADDY -a/2+armw
   GOSUB 110
DEL 1

 MATERIAL gs_seat_mat
	GOSUB 120

DEL 4

END


!---------------->!!! RETURN !!!<----------------

100:
IF gs_detlevel_3D_m=2 THEN

TUBE 5, 32, 1+2+16+32,
	0, 0, 0,
	armw, 0, 0,
	armw, 0.02, 0,
	0, 0.02, 0,
	0, 0, 0,

	-0.754847*bb,  0,   0.0,     0,
	-0.704847*bb,  0,   0.0,     0,
	-0.178613*bb,  0,   0.0,     0,
	-0.171614*bb,  0,   0.0,     0,
	-0.157828*bb,  0,   zz*0.002431,     0,
	-0.144674*bb,  0,   zz*0.007218,     0,
	-0.132552*bb,  0,   zz*0.014218,     0,
	-0.121828*bb,  0,   zz*0.023215,     0,
	-0.112831*bb,  0,   zz*0.033939,     0,
	-0.105831*bb,  0,   zz*0.046061,     0,
	-0.101044*bb,  0,   zz*0.059215,     0,
	-0.098613*bb,  0,   zz*0.073001,     0,
	-0.075807*bb,  0,   zz*0.39068+gs_seat_height-0.319,     0,
	-0.075172*bb,  0,   zz*0.399406+gs_seat_height-0.319,     0,
	-0.076953*bb,  0,   zz*0.416813+gs_seat_height-0.319,     0,
	-0.081729*bb,  0,   zz*0.433646+gs_seat_height-0.319,     0,
	-0.089356*bb,  0,   zz*0.449394+gs_seat_height-0.319,     0,
	-0.099601*bb,  0,   zz*0.463579+gs_seat_height-0.319,     0,
	-0.112154*bb,  0,   zz*0.475769+gs_seat_height-0.319,     0,
	-0.126633*bb,  0,   zz*0.485594+gs_seat_height-0.319,     0,
	-0.142598*bb,  0,   zz*0.492755+gs_seat_height-0.319,     0,
	-0.159564*bb,  0,   zz*0.497035+gs_seat_height-0.319,     0,
	-0.169432*bb,  0,   zz*0.497746+gs_seat_height-0.319,     0,
	-0.58825*bb,   0,   zz*0.523388+gs_seat_height-0.319,     0,
	-0.591067*bb,  0,   zz*0.523217+gs_seat_height-0.319,     0,
	-0.608293*bb,  0,   zz*0.526286+gs_seat_height-0.319,     0,
	-0.624725*bb,  0,   zz*0.5323+gs_seat_height-0.319,     0,
	-0.639863*bb,  0,   zz*0.541076+gs_seat_height-0.319,     0,
	-0.653247*bb,  0,   zz*0.552347+gs_seat_height-0.319,     0,
	-0.658858*bb,  0,   zz*0.559059+gs_seat_height-0.319,     0,
	-0.722261*bb,  0,   zz*0.634894+gs_seat_height-0.319,     0,
	-0.73791*bb,  0,   zz*0.653611+gs_seat_height-0.319,     0

ELSE

TUBE 5, 7, 1+2+16+32,
	0, 0, 0,
	armw, 0, 0,
	armw, 0.02, 0,
	0, 0.02, 0,
	0, 0, 0,

	-0.754847*bb,  0,   zz*0.0,     0,
	-0.704847*bb,  0,   zz*0.0,     0,
	-0.104192*bb,  0,   zz*0.00039,     0,
	-0.068471*bb,  0,   zz*0.491552+gs_seat_height-0.319,     0,
	-0.631236*bb,  0,   zz*0.526021+gs_seat_height-0.319,     0,
	-0.722261*bb,  0,   zz*0.634894+gs_seat_height-0.319,     0,
	-0.73791*bb,  0,   zz*0.653611+gs_seat_height-0.319,     0

ENDIF

gosub 1000

RETURN

110:
IF gs_detlevel_3D_m=2 THEN

ADDZ gs_seat_height-0.319
TUBE 5, 26, 1+2+16+32,
	0, 0, 0,
	-frmw, 0, 0,
	-frmw, -0.02, 0,
	0, -0.02, 0,
	0, 0, 0,

	0.117352*bb,  0,  zz*0.40388,     0,
	-0.003998*bb,  0,   zz*0.37912,     0,
	-0.489401*bb,  0,   zz*0.28008,     0,
	-0.497461*bb,  0,   zz*0.278769,     0,
	-0.507957*bb,  0,   zz*0.278998,     0,
	-0.518254*bb,  0,   zz*0.281047,     0,
	-0.528038*bb,  0,   zz*0.284853,     0,
	-0.537013*bb,  0,   zz*0.2903,     0,
	-0.544906*bb,  0,   zz*0.297223,     0,
	-0.551477*bb,  0,   zz*0.305411,     0,
	-0.556526*bb,  0,   zz*0.314616,     0,
	-0.5599*bb,  0,   zz*0.324557,     0,
	-0.560698*bb,  0,   zz*0.329746,     0,
	-0.57332*bb,  0,   zz*0.411786,     0,
	-0.575981*bb,  0,   zz*0.429081,     0,
	-0.587227*bb,  0,   zz*0.46222,     0,
	-0.604058*bb,  0,   zz*0.492902,     0,
	-0.617556*bb,  0,   zz*0.509659,     0,
	-0.617877*bb,  0,   zz*0.510043,     0,
	-0.73791*bb,  0,   zz*0.653611,     0,
	-0.753335*bb,  0,   zz*0.671994,     0,
	-0.777832*bb,  0,   zz*0.714424,     0,
	-0.794589*bb,  0,   zz*0.760463,     0,
	-0.803097*bb,  0,   zz*0.808712,     0,
	-0.803097*bb,  0,   zz*(1+zzyzx-1.02-gs_seat_height+0.319),     0,
	-0.803097*bb,  0,   zz*(2+zzyzx-1.02-gs_seat_height+0.319),     0
DEL 1

ELSE

ADDZ gs_seat_height-0.319
TUBE 5, 7, 1+2+16+32,
	0, 0, 0,
	-frmw, 0, 0,
	-frmw, -0.02, 0,
	0, -0.02, 0,
	0, 0, 0,

	0.117352*bb,  0,  zz*0.40388,     0,
	-0.003998*bb,  0,   zz*0.37912,     0,
	-0.55112*bb,  0,   zz*0.267487,     0,
	-0.581797*bb,  0,   zz*0.466888,     0,
	-0.803097*bb,  0,   zz*0.73158,     0,
	-0.803097*bb,  0,   zz*(1+zzyzx-1.02-gs_seat_height+0.319),     0,
	-0.803097*bb,  0,   zz*(2+zzyzx-1.02-gs_seat_height+0.319),     0
DEL 1

ENDIF

gosub 2000

RETURN

120:
IF gs_detlevel_3D_m=2 THEN

ADDZ gs_seat_height-0.319

ADDX -0.803097*bb
ROTZ -90
	CUTPLANE 90
DEL 2

ADD -0.003998*bb,  0,   zz*0.37912
ROTY -ATN((zz*0.37912-zz*0.3296)/(0.2467*bb-0.003998*bb))
	CUTPLANE -180
DEL 2

bbb=zz*1.00-0.05
TUBE 7, 46, 1+2+16+32,
	frmw/2, 0, 1,
	-frmw/2, 0, 1,
	-frmw/2, 0.015, 1,
	-frmw/2+0.025, 0.04, 1001,
	frmw/2-0.025, 0.04, 1,
	frmw/2, 0.015, 1001,
	frmw/2, 0, 1,


	0.04,  0,   zz*0.37912-0.040009,     0,
	0.04,  0,   zz*0.37912-0.036509,     0,
	0.038785,  0,   zz*0.37912-0.029616,     0,
	0.036391,  0,   zz*0.37912-0.023039,     0,
	0.032891,  0,   zz*0.37912-0.016978,     0,
	0.028392,  0,   zz*0.37912-0.011616,     0,
	0.023031,  0,   zz*0.37912-0.007117,     0,
	0.016969,  0,   zz*0.37912-0.003618,     0,
	0.010392,  0,   zz*0.37912-0.001224,     0,
	0.0035,   0,  zz*0.37912-0.000009,     0,
	-0.003998*bb,  0,   zz*0.37912,     0,
	-0.489401*bb,  0,   zz*0.28008,     0,
	-0.497461*bb,  0,   zz*0.278769,     0,
	-0.507957*bb,  0,   zz*0.278998,     0,
	-0.518254*bb,  0,   zz*0.281047,     0,
	-0.528038*bb,  0,   zz*0.284853,    0,
	-0.537013*bb,  0,   zz*0.2903,     0,
	-0.544906*bb,  0,   zz*0.297223,     0,
	-0.551477*bb,  0,   zz*0.305411,     0,
	-0.556526*bb,  0,   zz*0.314616,     0,
	-0.5599*bb,  0,   zz*0.324557,     0,
	-0.560698*bb,  0,   zz*0.329746,     0,
	-0.57332*bb,  0,   zz*0.411786,     0,
	-0.575981*bb,  0,   zz*0.429081,     0,
	-0.587227*bb,  0,   zz*0.46222,     0,
	-0.604058*bb,  0,   zz*0.492902,     0,
	-0.617556*bb,  0,   zz*0.509659,     0,
	-0.617877*bb,  0,   zz*0.510043,     0,
	-0.73791*bb,  0,   zz*0.653611,     0,
	-0.753335*bb,  0,   zz*0.671994,     0,
	-0.777832*bb,  0,   zz*0.714424,     0,
	-0.794589*bb,  0,   zz*0.760463,     0,
	-0.803097*bb,  0,   zz*0.808712,     0,
	-0.803097*bb,  0,   zz*0.833209,     0,
	-0.803097*bb,  0,   zz*bbb+zzyzx-1.02-gs_seat_height+0.319,     0,
	-0.803097*bb,  0,   bbb+0.0035+zzyzx-1.02-gs_seat_height+0.319,     0,
	-0.803097*bb-0.001215,  0,   bbb+0.010392+zzyzx-1.02-gs_seat_height+0.319,     0,
	-0.803097*bb-0.003609,  0,   bbb+0.016969+zzyzx-1.02-gs_seat_height+0.319,     0,
	-0.803097*bb-0.007108,  0,   bbb+0.023031+zzyzx-1.02-gs_seat_height+0.319,     0,
	-0.803097*bb-0.011607,  0,   bbb+0.028392+zzyzx-1.02-gs_seat_height+0.319,     0,
	-0.803097*bb-0.016909,  0,   bbb+0.032891+zzyzx-1.02-gs_seat_height+0.319,     0,
	-0.803097*bb-0.023030,  0,   bbb+0.036391+zzyzx-1.02-gs_seat_height+0.319,     0,
	-0.803097*bb-0.029607,  0,   bbb+0.038785+zzyzx-1.02-gs_seat_height+0.319,     0,
	-0.803097*bb-0.036500,  0,   bbb+0.04+zzyzx-1.02-gs_seat_height+0.319,     0,
	-0.803097*bb-0.04,  0,   bbb+0.04+zzyzx-1.02-gs_seat_height+0.319,     0,
	-0.803097*bb-0.05,  0,   bbb+0.04+zzyzx-1.02-gs_seat_height+0.319,     0
CUTEND
CUTEND

DEL 1

gosub 1000

ELSE

addz gs_seat_height-0.32

TUBE 5, 8, 1+2+16+32,
	frmw/2, 0, 0,
	-frmw/2, 0, 0,
	-frmw/2, 0.04, 0,
	frmw/2, 0.04, 0,
	frmw/2, 0, 0,

	0.117352,  0,  zz*0.37912+0.02476,     0,
	0.06,  0,   zz*0.37912+0.013058,     0,
	-0.003998*bb,  0,   zz*0.37912,     0,
	-0.55112*bb,  0,   zz*0.267487,     0,
	-0.581797*bb,  0,   zz*0.466888,     0,
	-0.803097*bb,  0,   zz*0.73158,     0,
	-0.803097*bb,  0,   zz*1.000000+0.0193+zzyzx-1.02-gs_seat_height+0.319,     0,
	-0.803097*bb,  0,   zz*2.000000+zzyzx-1.02-gs_seat_height+0.319,     0

del 1

	gosub 4000

ENDIF

RETURN

END

1000:
roty 90
gosub 5000
del 1
return

2000:
gosub 5000
return

3000:
rotx 90
gosub 5000
del 1
return

4000:
rotz 90
gosub 5000
del 1
return


5000:

vert 0, 0, 0
vert 1, 0, 0
vert 0, 1, 0
vert 0, 0, 1

coor 2, -1, -2, -3, -4

base

body -1

return


