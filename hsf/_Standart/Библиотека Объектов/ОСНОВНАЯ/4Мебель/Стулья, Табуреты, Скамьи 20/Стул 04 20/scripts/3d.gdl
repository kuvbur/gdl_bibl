
!IF gs_detlevel_3D_m=0 THEN END

unID=1

RESOL gs_resol
PEN gs_cont_pen


IF gs_shadow=0 THEN SHADOW OFF

IF GLOB_CONTEXT>20 and GLOB_CONTEXT<40 THEN gs_detlevel_3D_m=1

ADD A/2, B/2, 0

HOTSPOT -a/2, -b/2, 0
HOTSPOT  a/2, -b/2, 0
HOTSPOT -a/2,  b/2, 0
HOTSPOT  a/2,  b/2, 0

C=gs_seat_height/16
D=A/19
r1=(b-2*d)/4
z1=(gs_seat_height-c+(r1+d/2)*SIN(80)+(b-r1-d/2+(r1+d/2)*COS(80))*TAN(10))

unID=unID+1
hotspot -a/2, b/2+(zzyzx-z1-d)*TAN(7)-d/2, 0, unID, zzyzx, 1+128
unID=unID+1
hotspot -a/2, b/2+(zzyzx-z1-d)*TAN(7)-d/2, -1, unID, zzyzx,3
unID=unID+1
hotspot -a/2, b/2+(zzyzx-z1-d)*TAN(7)-d/2, zzyzx, unID, zzyzx, 2

unID=unID+1
hotspot a/2, b/2+(zzyzx-z1-d)*TAN(7)-d/2, 0, unID, zzyzx, 1+128
unID=unID+1
hotspot a/2, b/2+(zzyzx-z1-d)*TAN(7)-d/2, -1, unID, zzyzx,3
unID=unID+1
hotspot a/2, b/2+(zzyzx-z1-d)*TAN(7)-d/2, zzyzx, unID, zzyzx, 2


! Hotspot editing
unID=unID+1
hotspot -a/2+a/19, -b/2, 0, unID, gs_seat_height, 1+128
unID=unID+1
hotspot -a/2+a/19, -b/2, -1, unID, gs_seat_height, 3
unID=unID+1
hotspot -a/2+a/19, -b/2, gs_seat_height, unID, gs_seat_height, 2

unID=unID+1
hotspot a/2-a/19, -b/2, 0, unID, gs_seat_height, 1+128
unID=unID+1
hotspot a/2-a/19, -b/2, -1, unID, gs_seat_height, 3
unID=unID+1
hotspot a/2-a/19, -b/2, gs_seat_height, unID, gs_seat_height, 2


ADDY -b/2

! Simple Model
IF gs_detlevel_3D_m=1 THEN
RESOL 8
	GOSUB 1
ENDIF

! Detailed Model
IF gs_detlevel_3D_m=2 THEN
RESOL gs_resol
	GOSUB 1
ENDIF
DEL 1

DEL 1
END

1:
MATERIAL gs_frame_mat
ZH=gs_seat_height
C=gs_seat_height/16
D=A/22

! Legs

MATERIAL gs_frame_mat
ADD -A/2+D/2,D/2,0

PRISM_ 2,ZH-C,
0,0,974,
D/2,360,4074
PRISM_ 2,0,
0,0,901,
D/2,360,4001
IF gs_armrest=0 THEN
	ADDZ ZH-C
	PRISM_ 2,0,
	0,0,901,
	D/2,360,4001
	DEL 1
ENDIF


DEL 1
ADD A/2-D/2,D/2,0

PRISM_ 2,ZH-C,
0,0,974,
D/2,360,4074
PRISM_ 2,0,
0,0,901,
D/2,360,4001
IF gs_armrest=0 THEN
	ADDZ ZH-C
	PRISM_ 2,0,
	0,0,901,
	D/2,360,4001
	DEL 1
ENDIF

DEL 1
ADD -A/2+D/2*3,B-D/2,0

PRISM_ 2,ZH+(B-((B-2*D)/4-SIN(10)*(B-2*D)/4))*TAN(10)+((B-2*D)/4)*COS(10),
0,0,974,
D/2,360,4074

PRISM_ 2,0,
0,0,901,
D/2,360,4001

DEL 1
ADD A/2-D/2*3,B-D/2,0

PRISM_ 2,ZH+(B-((B-2*D)/4-SIN(10)*(B-2*D)/4))*TAN(10)+((B-2*D)/4)*COS(10),
0,0,974,
D/2,360,4074
PRISM_ 2,0,
0,0,901,
D/2,360,4001

DEL 1


ADD -A/2+D/2,D/2,0
CUTPOLYA 2,1,0,
0,0,915,
D/2,360,4015
DEL 1
ADD A/2-D/2,D/2,0
CUTPOLYA 2,1,0,
0,0,915,
D/2,360,4015
DEL 1
ADD -A/2+D/2,0,ZH-D/2-C
BLOCK A-D,D,D/2
CUTEND
CUTEND
DEL 1


ADD -A/2+D/2*3,B-D/2,0
CUTPOLYA 2,1,0,
0,0,915,
D/2,360,4015
DEL 1
ADD A/2-D/2*3,B-D/2,0
CUTPOLYA 2,1,0,
0,0,915,
D/2,360,4015
DEL 1
ADD -A/2+D/2*3,B-D,ZH-D/2-C
BLOCK A-3*D,D,D/2
CUTEND
CUTEND
DEL 1

ADD -A/2+D/2*3,B-D/2,0
CUTPOLYA 2,1,0,
0,0,915,
D/2,360,4015
DEL 1
ADD -A/2+D/2,D/2,0
CUTPOLYA 2,1,0,
0,0,915,
D/2,360,4015
DEL 1
ADD -A/2,D/2,ZH-D/2-C
ROTZ -ATN(D/(B-D))
BLOCK D,B-D,D/2
CUTEND
CUTEND
DEL 2

MULX -1
ADD -A/2+D/2*3,B-D/2,0
CUTPOLYA 2,1,0,
0,0,915,
D/2,360,4015
DEL 1
ADD -A/2+D/2,D/2,0
CUTPOLYA 2,1,0,
0,0,915,
D/2,360,4015
DEL 1
ADD -A/2,D/2,ZH-D/2-C
ROTZ -ATN(D/(B-D))
BLOCK D,B-D,D/2
CUTEND
CUTEND
DEL 3

! Seat
MATERIAL gs_seat_mat

ADD -A/2,0,ZH-C
PRISM 4,C,
D,0,
A-D,0,
A-2*D,B,
2*D,B
gosub 2000
DEL 1

! Back

MATERIAL gs_frame_mat
toth2=((B-((B-2*D)/4-SIN(10)*(B-2*D)/4))*TAN(10)+((B-2*D)/4)*COS(10))/COS(7)+2*D*TAN(7)
ADD -A/2+D*3/2, B-D/2, ZH+(B-((B-2*D)/4-SIN(10)*(B-2*D)/4))*TAN(10)+((B-2*D)/4)*COS(10)
ROTZ 90

ROTZ 90
ADDY -D
REVOLVE 2,7,1,
0,D,901,
D/2,360,4001
DEL 2

DEL 1
ROTX -7


PRISM_ 2,toth*COS(7)-(A-4*D)/4-toth2,
0,0,974,
D/2,360,4074

MATERIAL gs_back_mat
ROTX 90
ADDZ -D/2
PRISM_ 10,D,
D/2,0,79,
A-D*7/2,0,79,
A-D*7/2,toth*COS(7)-(A-4*D)/4-toth2, 79,
A-D*6/2-(A-4*D)/4,toth*COS(7)-(A-4*D)/4-toth2, 979,
0,90,4079,
A-D*6/2-(A-4*D)/4,(A-4*D)/4+toth*COS(7)-(A-4*D)/4-D/2-toth2, 79,
(A-4*D)/4,(A-4*D)/4+toth*COS(7)-(A-4*D)/4-D/2-toth2, 79,
(A-4*D)/4,toth*COS(7)-(A-4*D)/4-toth2, 979,
0,90,4079,
D/2,toth*COS(7)-(A-4*D)/4-toth2,79

gosub 2000
DEL 2

ADDZ toth*COS(7)-(A-4*D)/4-toth2


ROTZ 90
ADDY -(A-4*D)/4
MATERIAL gs_frame_mat
REVOLVE 2,90,1,
0,(A-4*D)/4,901,
D/2,360,4001
DEL 2

DEL 1

ADDZ toth*COS(7)-toth2
ROTY 90
ADDZ (A-4*D)/4

PRISM_ 2,(A-4*D)/4*2+D,
0,0,974,
D/2,360,4074

DEL 5

MULX -1
ADD -A/2+D*3/2,B-D/2,ZH+(B-((B-2*D)/4-SIN(10)*(B-2*D)/4))*TAN(10)+((B-2*D)/4)*COS(10)
ROTZ 90

ROTZ 90
ADDY -D
REVOLVE 2,7,1,
0,D,901,
D/2,360,4001
DEL 2

DEL 1
ROTX -7


PRISM_ 2,toth*COS(7)-(A-4*D)/4-toth2,
0,0,974,
D/2,360,4074


ADDZ toth*COS(7)-(A-4*D)/4-toth2

ROTZ 90
ADDY -(A-4*D)/4
REVOLVE 2,90,1,
0,(A-4*D)/4,901,
D/2,360,4001
DEL 2

DEL 1

DEL 2

! Arm
IF gs_armrest=1 THEN
MATERIAL gs_frame_mat

	ADD -A/2+D/2,D/2,ZH-C
	ROTZ 90

ROTZ 90
ADDY -(B-2*D)/4
REVOLVE 2,80,1,
0,(B-2*D)/4,901,
D/2,360,4001
DEL 2


	ROTY 90
	ADD -((B-2*D)/4)*COS(10),0,(B-2*D)/4-((B-2*D)/4)*SIN(10)
	ROTY -10

PRISM_ 2,(B-D-((B-2*D)/4-((B-2*D)/4)*SIN(10)))/COS(10)-D,
0,0,974,
D/2,360,4074

	DEL 5
	ADD -A/2+D*3/2,B-D/2,0
	CUTPOLYA 2,1,0,
	0,0,915,
	D/2,360,4015
	DEL 1
	ADD -A/2+D/2,D/2,ZH-C
	ROTZ 90
	ROTY 90
	ADD -((B-2*D)/4)*COS(10),0,(B-2*D)/4-((B-2*D)/4)*SIN(10)
	ROTY -10
	ADDZ (B-D-((B-2*D)/4-((B-2*D)/4)*SIN(10)))/COS(10)-D
	ROTZ -90

ROTZ 90
ADDY -D
REVOLVE 2,90,1,
0,D,901,
D/2,360,4001
DEL 2

	DEL 7
	CUTEND

	ADD A/2-D/2,D/2,ZH-C
	ROTZ 90

ROTZ 90
ADDY -(B-2*D)/4
REVOLVE 2,80,1,
0,(B-2*D)/4,901,
D/2,360,4001
DEL 2

	ROTY 90
	ADD -((B-2*D)/4)*COS(10),0,(B-2*D)/4-((B-2*D)/4)*SIN(10)
	ROTY -10


PRISM_ 2,(B-D-((B-2*D)/4-((B-2*D)/4)*SIN(10)))/COS(10)-D,
0,0,974,
D/2,360,4074

	DEL 5
	ADD A/2-D*3/2,B-D/2,0
	CUTPOLYA 2,1,0,
	0,0,915,
	D/2,360,4015
	DEL 1
	ADD A/2-D/2,D/2,ZH-C
	ROTZ 90
	ROTY 90
	ADD -((B-2*D)/4)*COS(10),0,(B-2*D)/4-((B-2*D)/4)*SIN(10)
	ROTY -10
	ADDZ (B-D-((B-2*D)/4-((B-2*D)/4)*SIN(10)))/COS(10)-D
	ROTZ 90

ROTZ 90
ADDY -D
REVOLVE 2,90,1,
0,D,901,
D/2,360,4001
DEL 2
	DEL 7
	CUTEND

ENDIF
DEL 1
RETURN


END

1000:
roty 90
gosub 5000
del 1
return

2000:
gosub 5000
return

5000:

vert 0, 0, 0
vert 1, 0, 0
vert 0, 1, 0
vert 0, 0, 1

coor 2, -1, -2, -3, -4

base

body -1

return



