
!!! Chair 04.gsm !!!

IF gs_detlevel_3D_m=0 THEN END

RESOL gs_resol
PEN gs_cont_pen


IF gs_shadow=0 THEN SHADOW OFF

IF GLOB_CONTEXT>20 and GLOB_CONTEXT<40 THEN gs_detlevel_3D_m=1

ADD a/2,b/2,0

unID=1

HOTSPOT -a/2, -b/2, 0, unID: unID=unID+1
HOTSPOT  a/2, -b/2, 0, unID: unID=unID+1
HOTSPOT -a/2,  b/2, 0, unID: unID=unID+1
HOTSPOT  a/2,  b/2, 0, unID: unID=unID+1


hotspot -a/2,  b/2, 0, unID, zzyzx, 1+128: unID=unID+1
hotspot -a/2,  b/2, -1, unID, zzyzx, 3: unID=unID+1
hotspot -a/2,  b/2, zzyzx, unID, zzyzx, 2: unID=unID+1

hotspot  a/2,  b/2, 0, unID, zzyzx, 1+128: unID=unID+1
hotspot  a/2,  b/2, -1, unID, zzyzx, 3: unID=unID+1
hotspot  a/2,  b/2, zzyzx, unID, zzyzx, 2: unID=unID+1


IF gs_full_edit=1 THEN

	hotspot -a/2, -b/2, 0, unID, gs_seat_height, 1+128: unID=unID+1
	hotspot -a/2, -b/2, -1, unID, gs_seat_height, 3: unID=unID+1
	hotspot -a/2, -b/2, gs_seat_height, unID, gs_seat_height, 2: unID=unID+1

	hotspot a/2, -b/2, 0, unID, gs_seat_height, 1+128: unID=unID+1
	hotspot a/2, -b/2, -1, unID, gs_seat_height, 3: unID=unID+1
	hotspot a/2, -b/2, gs_seat_height, unID, gs_seat_height, 2: unID=unID+1
ENDIF



ADDY -b/2

IF gs_detlevel_3D_m=2 THEN
	IF iChairModelStyle = 1 THEN
		ADDX -A/2
		!!   ********* Seat ************
		MATERIAL gs_seat_mat
		ADDZ C-C/8
			BLOCK   A,B, C/8
		DEL 1

		!!     ******** Feet and top caps********

		MATERIAL gs_frame_mat
		ADD 0,B,0
			CYLIND  0, rr*2
		DEL 1

		ADD A,B,0
			CYLIND 0,rr*2
		DEL 1

		ADD A,0,0
			CYLIND 0.005,rr*2
		DEL 1

			CYLIND  0.005,rr*2

		!!     ******** Legs ********
			CYLIND C-C/8,rr

		ADD A,0,0
			CYLIND C-C/8,rr
		DEL 1

		ADD A,B,0
			CYLIND C+toth,rr
		DEL 1

		ADD 0,B,0
			CYLIND C+toth,rr
		DEL 1

		!!     ******** Diagonal lower struts ********
		ADD 0,0,C/5
		ROTY 90
		ROTX -ATN(B/A)
			CYLIND  SQR(A^2+B^2),rr
		DEL 3

		ADD 0,B, C/5
		ROTY 90
		ROTX ATN(B/A)
			CYLIND  SQR(A^2+B^2),rr
		DEL 3

		!!     ******** In line upper struts & back ********

		ADDZ C-C/8
		ROTY 90
			CYLIND  A, rr/1.1
		DEL 1

		ADDY B
		ROTY 90
			CYLIND  A, rr/1.1
		DEL 2

		ADDY B
		ROTY 90
		ROTX 90
			CYLIND  B, rr/1.1
		DEL 3

		ADD A,B,0
		ROTY 90
		ROTX 90
			CYLIND  B, rr/1.1
		DEL 4

		ADDZ (C-C/8)*.75
		ROTY 90
			CYLIND A,rr
		DEL 1

		ADDY B
		ROTY 90
			CYLIND A,rr
		DEL 2

		ADDY B
		ROTY 90
		ROTX 90
			CYLIND B,rr
		DEL 3

		ADD A,B,0
		ROTY 90
		ROTX 90
			CYLIND B,rr
		DEL 4

		!  ** The backs and circle

		MATERIAL gs_back_mat
		ADDY B
		ADDZ C+toth*0.9
		ROTY 90
			CYLIND  A,rr
		DEL 3

		ADDY B
		ADDZ C+toth*0.5
		ROTY 90
			CYLIND  A,rr
		DEL 3

		ADD A/2, B,C+toth*0.7
		ROTX 90
			CYLIND  rr, (toth*0.2)-rr
		DEL 3

	ENDIF

	IF iChairModelStyle = 2 THEN
		ADDX -A/2
		!!   ********* Seat ************
		MATERIAL gs_seat_mat
		ADDZ C-C/8
			BLOCK A,B, C/8
		DEL 1

		!!     ******** Feet and top caps********

		MATERIAL gs_frame_mat
		ADD 0,B,0
			CYLIND 0, rr*2
		DEL 1

		ADD A,B,0
			CYLIND 0,rr*2
		DEL 1

		ADD A,0,0
			CYLIND 0.005,rr*2
		DEL 1

			CYLIND  0.005,rr*2

		!!     ******** Legs ********
			CYLIND C-C/8,rr

		ADD A,0,0
			CYLIND C-C/8,rr
		DEL 1

		ADD A,B,0
			CYLIND C+toth,rr
		DEL 1

		ADD 0,B,0
			CYLIND C+toth,rr
		DEL 1



		!!     ******** In line upper struts & back ********

		ADDZ C-C/8
		ROTY 90
			CYLIND  A, rr/1.1
		DEL 1

		ADDY B
		ROTY 90
			CYLIND  A, rr/1.1
		DEL 2

		ADDY B
		ROTY 90
		ROTX 90
			CYLIND  B, rr/1.1
		DEL 3

		ADD A,B,0
		ROTY 90
		ROTX 90
			CYLIND  B, rr/1.1
		DEL 4

		ADDZ (C-C/8)*.75
		ROTY 90
			CYLIND A,rr
		DEL 1

		ADDY B
		ROTY 90
			CYLIND A,rr
		DEL 2

		ADDY B
		ROTY 90
		ROTX 90
			CYLIND B,rr
		DEL 3

		ADD A,B,0
		ROTY 90
		ROTX 90
			CYLIND B,rr
		DEL 4

		ADDZ (C-C/8)*.25

		ADDY B
		ROTY 90
			CYLIND A,rr
		DEL 2


		ADDY B
		ROTY 90
		ROTX 90
			CYLIND B,rr
		DEL 3

		ADD A,B,0
		ROTY 90
		ROTX 90
			CYLIND B,rr
		DEL 4
		!  ** The backs and circle

		MATERIAL gs_back_mat
	ADD A/2,B+rr/2,0! rr,B-rr/2,C+toth*0.1+rr
!    BLOCK A-2*rr,rr,0.8*toth-rr*2
ROTX 90

PRISM_ 10,rr,
-A/2+rr,C+toth*0.1+rr,15,
-A/2+rr,C+toth*0.1+rr+(0.8*toth-rr*2),15,
A/2-rr,C+toth*0.1+rr+(0.8*toth-rr*2),15,
A/2-rr,C+toth*0.1+rr,15,
-A/2+rr,C+toth*0.1+rr,-1,

0,C+toth*0.1+rr+(0.8*toth-rr*2)/2+(0.8*toth-rr*2)/2-toth/20,15,
-A/4,C+toth*0.1+rr+(0.8*toth-rr*2)/2,15,
0,C+toth*0.1+rr-(0.8*toth-rr*2)/2+(0.8*toth-rr*2)/2+toth/20,15,
A/4,C+toth*0.1+rr+(0.8*toth-rr*2)/2,15,
0,C+toth*0.1+rr+(0.8*toth-rr*2)/2+(0.8*toth-rr*2)/2-toth/20,-1



DEL 1


	DEL 1

		ADDY B
		ADDZ C+toth*0.9
		ROTY 90
			CYLIND  A,rr
		DEL 3

		ADDY B
		ADDZ C+toth*0.1
		ROTY 90
			CYLIND  A,rr
		DEL 4

	ENDIF

	IF iChairModelStyle = 3 THEN
		ADDX -A/2
		!!   ********* Seat ************
		MATERIAL gs_seat_mat
		ADDZ C-C/8
			BLOCK   A,B, C/8
		DEL 1

		!!     ******** Feet and top caps********

		MATERIAL gs_frame_mat
		ADD 0,B,0
			CYLIND  0, rr*2
		DEL 1

		ADD A,B,0
			CYLIND 0,rr*2
		DEL 1

		ADD A,0,0
			CYLIND 0.005,rr*2
		DEL 1

			CYLIND  0.005,rr*2

		!!     ******** Legs ********
			CYLIND C+C*0.4,rr

		ADD A,0,0
			CYLIND C+C*0.4,rr
		DEL 1

		ADD A,B,0
			CYLIND C+toth,rr
		DEL 1

		ADD 0,B,0
			CYLIND C+toth,rr
		DEL 1


		!!     ******** In line upper struts & back ********

		ADDZ C-C/8
		ROTY 90
			CYLIND  A, rr/1.1
		DEL 1

		ADDY B
		ROTY 90
			CYLIND  A, rr/1.1
		DEL 2

		ADDY B
		ROTY 90
		ROTX 90
			CYLIND  B, rr/1.1
		DEL 3

		ADD A,B,0
		ROTY 90
		ROTX 90
			CYLIND  B, rr/1.1
		DEL 4

		ADDZ (C-C/8)*.75
		ROTY 90
			CYLIND A,rr
		DEL 1

		ADDY B
		ROTY 90
			CYLIND A,rr
		DEL 2


		ADDY B
		ROTY 90
		ROTX 90
			CYLIND B,rr
		DEL 3

		ADD A,B,0
		ROTY 90
		ROTX 90
			CYLIND B,rr
		DEL 4

		ADDZ (C-C/8)*.25

		ADDY B
		ROTY 90

		Prism 4,A,
			-C/15,-rr/2,
			C/15,-rr/2,
			C/15,rr/2,
			-C/15,rr/2
		DEL 2


		ADDY B
		ROTY 90
		ROTX 90

		Prism 4,B,
			-C/15,-rr/2,
			C/15,-rr/2,
			C/15,rr/2,
			-C/15,rr/2
		DEL 3

		ADD A,B,0
		ROTY 90
		ROTX 90

		Prism 4,B,
			-C/15,-rr/2,
			C/15,-rr/2,
			C/15,rr/2,
			-C/15,rr/2

		DEL 4


		ADD A,B,C+0.4*C
		ROTY 90
		ROTX 90
			CYLIND B+rr,rr
		DEL 3

		ADD 0,B,C+0.4*C
		ROTY 90
		ROTX 90
			CYLIND B+rr,rr
		DEL 3

		!  ** The backs and circle

		MATERIAL gs_back_mat
	ADD rr,B-rr/2,C+toth*0.4+rr
	BLOCK A-2*rr,rr,0.5*toth-rr*2
	DEL 1


		ADDY B
		ADDZ C+toth*0.9
		ROTY 90
			CYLIND  A,rr
		DEL 3

		ADDY B
		ADDZ C+toth*0.4
		ROTY 90
			CYLIND  A,rr
		DEL 4

	ENDIF
ELSE
		RESOL 4
		ADDX -A/2
		!!   ********* Seat ************
		MATERIAL gs_seat_mat
		ADDZ C-C/8
			BLOCK   A,B, C/8
		DEL 1

		MATERIAL gs_frame_mat

		!!     ******** Legs ********
			CYLIND C-C/8,rr

		ADD A,0,0
			CYLIND C-C/8,rr
		DEL 1

		ADD A,B,0
			CYLIND C+toth,rr
		DEL 1

		ADD 0,B,0
			CYLIND C+toth,rr
		DEL 1

		!!     ******** In line upper struts & back ********

		ADDZ C-C/8
		ROTY 90
			CYLIND  A, rr/1.1
		DEL 1

		ADDY B
		ROTY 90
			CYLIND  A, rr/1.1
		DEL 2

		ADDY B
		ROTY 90
		ROTX 90
			CYLIND  B, rr/1.1
		DEL 3

		ADD A,B,0
		ROTY 90
		ROTX 90
			CYLIND  B, rr/1.1
		DEL 5

		IF iChairModelStyle = 1 THEN
			MATERIAL gs_back_mat
			ADDX -a/2

			ADDY B
			ADDZ C+toth*0.9
			ROTY 90
				CYLIND  A,rr
			DEL 3

			ADDY B
			ADDZ C+toth*0.5
			ROTY 90
				CYLIND  A,rr
			DEL 3

			ADD A/2, B,C+toth*0.7
			ROTX 90
				CYLIND  rr, (toth*0.2)-rr
			DEL 2
			DEL 1
		ENDIF

		IF iChairModelStyle = 2 THEN
		MATERIAL gs_back_mat
			ADDY B+rr/2
			ROTX 90

			PRISM_ 5,rr,
			-A/2+rr,C+toth*0.1+rr,15,
			-A/2+rr,C+toth*0.1+rr+(0.8*toth-rr*2),15,
			A/2-rr,C+toth*0.1+rr+(0.8*toth-rr*2),15,
			A/2-rr,C+toth*0.1+rr,15,
			-A/2+rr,C+toth*0.1+rr,-1

			DEL 2
		ENDIF

		IF iChairModelStyle = 3 THEN
		MATERIAL gs_back_mat
		ADD -a/2+rr,B-rr/2,C+toth*0.4+rr
		BLOCK A-2*rr,rr,0.5*toth-rr*2
		DEL 1
		ENDIF



ENDIF

DEL 2
