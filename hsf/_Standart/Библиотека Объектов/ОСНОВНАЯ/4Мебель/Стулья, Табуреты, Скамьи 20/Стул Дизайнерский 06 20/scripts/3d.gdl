
IF gs_detlevel_3D_m=0 THEN END

PEN gs_cont_pen

IF gs_shadow=0 THEN SHADOW OFF

IF GLOB_CONTEXT>20 and GLOB_CONTEXT<40 THEN gs_detlevel_3D_m=1

IF gs_detlevel_3D_m=1 THEN RESOL 4

ADD a/2,b/2,0

HOTSPOT  a/2, -b/2, 0
HOTSPOT  a/2,  b/2, 0
HOTSPOT -a/2, -b/2, 0
HOTSPOT -a/2,  b/2, 0


unID=1
hotspot -a/4,  b/2, 0, unID, zzyzx, 1+128
unID=unID+1
hotspot -a/4,  b/2, -1, unID, zzyzx, 3
unID=unID+1
hotspot -a/4,  b/2, zzyzx, unID, zzyzx, 2

unID=unID+1
hotspot  a/4,  b/2, 0, unID, zzyzx, 1+128
unID=unID+1
hotspot  a/4,  b/2, -1, unID, zzyzx, 3
unID=unID+1
hotspot  a/4,  b/2, zzyzx, unID, zzyzx, 2


IF gs_full_edit=1 THEN
	unID=unID+1
	hotspot -a/2, -b/2, 0, unID, gs_seat_height, 1+128
	unID=unID+1
	hotspot -a/2, -b/2, -1, unID, gs_seat_height, 3
	unID=unID+1
	hotspot -a/2, -b/2, gs_seat_height, unID, gs_seat_height, 2

	unID=unID+1
	hotspot  a/2, -b/2, 0, unID, gs_seat_height, 1+128
	unID=unID+1
	hotspot  a/2, -b/2, -1, unID, gs_seat_height, 3
	unID=unID+1
	hotspot  a/2, -b/2, gs_seat_height, unID, gs_seat_height, 2
ENDIF


IF gs_detlevel_3D_m=1 THEN
	ZH=gs_seat_height
	ADD -A/2, -b/2, 0
	MATERIAL gs_frame_mat

	CYLIND ZH,0.01
	ADDX A
	CYLIND ZH,0.01
	ADDX -A/4
	ADDY B
	CYLIND ZH+TOTH,0.01
	ADDX -A*2/4
	CYLIND ZH+TOTH,0.01
	DEL 4

	! Bretterung hinten

	MATERIAL gs_frame_mat

	ADD A/4,B,0
	CUTPOLYA 2,1,0,
	0,0,900,
	0.01,360,4000
	ADDX A/4*2
	CUTPOLYA 2,1,0,
	0,0,900,
	0.01,360,4000
	DEL 2
	ADD A/4,B-0.005,0.04
	BRICK A/4*2,0.01,ZH+toth-0.04
	gosub 5000
	DEL 1
	CUTEND
	CUTEND

	CUTPOLYA 2,1,0,
	0,0,900,
	0.01,360,4000
	ADDX A
	CUTPOLYA 2,1,0,
	0,0,900,
	0.01,360,4000
	ADD -A/4,B,0
	CUTPOLYA 2,1,0,
	0,0,900,
	0.01,360,4000
	ADDX -A/4*2
	CUTPOLYA 2,1,0,
	0,0,900,
	0.01,360,4000
	DEL 3
	ADDZ ZH-0.055
	PRISM 4,0.055,
	0,0,
	A,0,
	A*3/4,B,
	A/4,B
	gosub 2000
	DEL 2
	CUTEND
	CUTEND
	CUTEND
	CUTEND

ENDIF

IF gs_detlevel_3D_m=2 THEN
	ZH=gs_seat_height
	RESOL gs_resol
	ADD -A/2, -b/2, 0
	MATERIAL gs_frame_mat

	CYLIND ZH,0.01
	ADDX A
	CYLIND ZH,0.01
	ADDX -A/4
	ADDY B
	CYLIND ZH+TOTH,0.01
	ADDX -A*2/4
	CYLIND ZH+TOTH,0.01
	DEL 4

	ADDZ ZH/3
	CUTPOLYA 2,1,0,
	0,0,900,
	0.01,360,4000
	ADDX A
	CUTPOLYA 2,1,0,
	0,0,900,
	0.01,360,4000
	DEL 1
	ROTY 90
	CYLIND A,0.005
	CUTEND
	CUTEND
	DEL 2

	ADD A/4,B,0
	CUTPOLYA 2,1,0,
	0,0,900,
	0.01,360,4000
	DEL 1
	ROTZ ATN(B/(A/4))
	ADDZ 0.11
	CUTPOLYA 2,1,0,
	0,0,900,
	0.01,360,4000
	ROTY 90
	CYLIND SQR((A/4)^2+B^2),0.005
	ADDX -0.05
	CYLIND SQR((A/4)^2+B^2),0.005
	CUTEND
	CUTEND
	DEL 4

	ADD A*3/4,B,0
	CUTPOLYA 2,1,0,
	0,0,900,
	0.01,360,4000
	DEL 1
	ADDX A
	ROTZ 90+ATN((A/4)/B)
	ADDZ 0.11
	CUTPOLYA 2,1,0,
	0,0,900,
	0.01,360,4000
	ROTY 90
	CYLIND SQR((A/4)^2+B^2),0.005
	ADDX -0.05
	CYLIND SQR((A/4)^2+B^2),0.005
	CUTEND
	CUTEND
	DEL 5

	! Bretterung hinten

	gap = (ZH+toth-0.04-(31*0.02))/30

	MATERIAL gs_frame_mat

	ADD A/4,B,0
	CUTPOLYA 2,1,0,
	0,0,900,
	0.01,360,4000
	ADDX A/4*2
	CUTPOLYA 2,1,0,
	0,0,900,
	0.01,360,4000
	DEL 2
	ROTX 90
	ADDY ZH-0.055
	CUTPOLY 4,
	0,0,
	A,0,
	A,0.055,
	0,0.055
	DEL 2
	ADD A/4,B-0.005,0.04
	FOR s = 1 to 31
		BRICK A/4*2,0.01,0.02
		gosub 1000
		ADDZ 0.02+gap
	NEXT s
	DEL 32
	CUTEND
	CUTEND
	CUTEND

	ADD A/4+0.01+(A/4*2-0.02-0.08)/5,B-0.005, zzyzx-0.02-gap
	FOR l = 1 TO 5
		FOR h = 1 TO 4
			BRICK 0.02,0.01, gap
			ADDX (A/4*2-0.02-0.08)/5+0.02
		NEXT h
		DEL 4
		ADDZ -0.02-gap
	NEXT l
	DEL 6

	CUTPOLYA 2,1,0,
	0,0,900,
	0.01,360,4000
	ADDX A
	CUTPOLYA 2,1,0,
	0,0,900,
	0.01,360,4000
	ADD -A/4,B,0
	CUTPOLYA 2,1,0,
	0,0,900,
	0.01,360,4000
	ADDX -A/4*2
	CUTPOLYA 2,1,0,
	0,0,900,
	0.01,360,4000
	DEL 3
	ADDZ ZH-0.055
	PRISM 4,0.055,
	0,0,
	A,0,
	A*3/4,B,
	A/4,B
	DEL 1
	CUTEND
	CUTEND
	CUTEND
	CUTEND

	MATERIAL gs_seat_mat
	CUTPOLYA 2,1,0,
	0,0,900,
	0.01,360,4000
	ADDX A
	CUTPOLYA 2,1,0,
	0,0,900,
	0.01,360,4000
	ADD -A/4,B,0
	CUTPOLYA 2,1,0,
	0,0,900,
	0.01,360,4000
	ADDX -A/4*2
	CUTPOLYA 2,1,0,
	0,0,900,
	0.01,360,4000
	DEL 3
	ADD A/2,B/2,ZH
	PYRAMID 5,0.055,5,
	-A/2,-B/2,1,
	A/2,-B/2,1,
	A/4,B/2,1,
	-A/4,B/2,1,
	-A/2,-B/2,1

	gosub 2000

	DEL 2
	CUTEND
	CUTEND
	CUTEND
	CUTEND

ENDIF

DEL 1
END

1000:
	roty 90
	gosub 5000
	del 1
	return

2000:
	gosub 5000
	return

5000:

	vert 0, 0, 0
	vert 1, 0, 0
	vert 0, 1, 0
	vert 0, 0, 1

	coor 2, -1, -2, -3, -4

	base

	body -1

	return
