
!! Office Chair 05.gsm

if not(gs_shadow) then shadow off
if gs_detlevel_3D_m = 0 then end
if gs_detlevel_3D_m = 1 then gs_resol=5

pen gs_cont_pen
resol gs_resol

! --- MUL Definition ---


IF gs_leg_type_m = 1 or gs_leg_type_m = 2 THEN   !!!! 5 star MUL
	xmul = 0.55
	ymul = 0.56
	zmul = gs_seat_height + 0.430
	ymove = 0.075
ENDIF

IF gs_leg_type_m = 3 or gs_leg_type_m = 4 THEN   !!!! Leg MUL
	xmul = 0.55
	ymul = 0.54
	zmul = gs_seat_height + 0.430
	ymove = 0.08
ENDIF

IF gs_leg_type_m = 5 THEN  !!!! FRAME MUL
	xmul = 0.53
	ymul = 0.56
	zmul = gs_seat_height + 0.430
	ymove = 0.085
ENDIF

MUL a/xmul,b/ymul,1

HOTSPOT 0,0,0,UnID,"gs_seat_height",1 :UnID = UnID+1
HOTSPOT 0,0,-0.1,UnID,"gs_seat_height",3 :UnID = UnID+1
HOTSPOT 0,0,gs_seat_height,UnID,"gs_seat_height",2 :UnID = UnID+1

HOTSPOT 0,0.2,0,UnID,"zzyzx",1 :UnID = UnID+1
HOTSPOT 0,0.2,-0.1,UnID,"zzyzx",3 :UnID = UnID+1
HOTSPOT 0,0.2,zzyzx,UnID,"zzyzx",2 :UnID = UnID+1

ADD 0,ymove, gs_seat_height-0.055
ROTx -2

ADD 0,-0.35,-0.03
CALL "fa_OfficechairSeat" PARAMETERS 	a=0.46, b=0.44 ,
					mat=gs_seat_mat,
					mat2=gs_frame_mat,
					bDetailed = bDetailed,
					gs_cont_pen = gs_cont_pen
del 1

MATERIAL gs_frame_mat
MULz (zzyzx-gs_seat_height+0.05)/0.485
ADD 0.17,0.01,0.02
ROTx 90
ROTy 90
FOR i=1 to 2
	PRISM_     28, 0.05,
		0.04228143775294, -0.01862179073177,      79,
		0.0323268885736, 0.05892110116064,    900,
		0, 44.51422913682,   4079,
		0.09378950725374, 0.01060609689301,      79,
		0.04137843856283, 0.04930889918782,    900,
		0, 77.32938607145,   4079,
		0.09063486800925, 0.09195431142624,      79,
		0.1122288276424, 0.120407000575,    900,
		0, -34.4383460693,   4079,
		0.07832898994611, 0.1091528628204,      79,
		0.1026463928232, 0.1339364989582,    900,
		0, -18.60195607659,   4079,
		0.0716936179961, 0.118204670285,      79,
		0.06390920180139, 0.1157750139159,      79,
		0.1027735693692, 0.1036154865776,    900,
		0, 15.96977414448,   4079,
		0.06206364207906, 0.104612979218,      79,
		0.1109991813139, 0.1227239464595,    900,
		0, 31.88636754245,   4079,
		0.07901501313627, 0.08149644204056,      79,
		0.04298257996282, 0.05151704219197,    900,
		0, -79.45207930846,   4079,
		0.07905141134813, 0.02158144368152,      79,
		0.03721219249143, 0.04837978180471,    900,
		0, -51.37079107121,   4079,
		0.04239656939964, -0.001034724130058,      79,
		-0.04,            0,      79,
		-0.04, -0.015, 79
	ADDz -0.39
NEXT i
DEL 2
DEL 3

ADD 0, 0.07,0.15
ROTz 180
CALL "fa_officechair_back_01" PARAMETERS a=0.46, b=0.12, zzyzx=0.39, mat1=gs_back_mat, mat2=gs_frame_mat
DEL 2

DEL 1

! --- OfficeRoll LEG ---
IF gs_leg_type_m = 1 or gs_leg_type_m = 2 THEN
	GOSUB 10:

	! --- OfficeRoll ARM ---
	IF gs_Armrest THEN
		ADD -0.25,-0.08,-0.05
		ROTz 90
		GOSUB 20:
		DEL 2
		ADD 0.25,-0.08,-0.05
		ROTz 90
		MULy -1
		GOSUB 20:
		DEL 3
	ENDIF

ENDIF

! --- OfficeRoll FRAME ---
IF gs_leg_type_m = 5 THEN
	ADD 0.24,-0.27,-0.367
	ROTz 90
	GOSUB 11:
	DEL 2
	ADD -0.24,-0.27,-0.367
	ROTz 90
	MULy -1
	GOSUB 11:
	DEL 3
ENDIF

! --- LEG ---
IF gs_leg_type_m = 3 or gs_leg_type_m = 4 THEN
	ADD 0.24,0,0
	ROTz 90
	GOSUB 12:
	DEL 2
	ADD -0.24,0,0
	ROTz 90
	GOSUB 12:
	DEL 2
ENDIF


DEL 2

END


! --- OfficeRoll LEG ---
10:

MATERIAL gs_frame_mat
ADD 0,-0.075,-0.12
ROTz 90
PRISM_ 7,0.04,
	0,0,979,
	0,-0.045,79,
	0.045,-180,4079,
	0,0.047,79,
	-0.05,0.047,79,
	-0.05,-0.047,79,
	0,-0.047,79

ADDx -0.05
ROTy -90
ROTz -90
RULED 4,4+16+32,
	-0.05,0,1,
	-0.05,0.04,1,
	0.05,0.04,1,
	0.05,0,1,

	-0.1,0.08,0.12,
	-0.1,0.08,0.06,
	 0.1,0.08,0.06,
	 0.1,0.08,0.12
DEL 3
ADD -0.11,0,0.08
ROTz 90
PRISM_ 4, 0.05,
	-0.1,0,15,
	-0.1,0.06,15,
	0.1,0.06,15,
	0.1,0,15
DEL 2

ADDz 0.04
ROTy 90
MATERIAL gs_frame_mat
REVOLVE 6,360,1+2+16+32,
		0.06633000489993, 0.0175,      1,
		0.06633000489993, 0.028,      1,
		0.06240039918891, 0.034,      1,
		0.05713070580123, 0.040,      1,
		0.05035270444958, 0.045,      1,
		0, 0.045,      1

MATERIAL chrommat
REVOLVE 2,360,1+2+16+32,
		Leglength, 0.0175,      1,
		0.06633000489993, 0.0175,      1

! --- ARMREST ---
ADDx Leglength
MATERIAL gs_frame_mat
REVOLVE 2,360,1+2,
	0, 0.0266,      1,
	0.1, 0.0266, 1

IF gs_leg_type_m = 2 THEN
	ADDx -0.02
	MATERIAL chrommat
	resol max(gs_resol,16)
	REVOLVE 2,360,1+2+16+32,
		0.02,0.0266,0,
		-0.04,0.0266,0

	REVOLVE 2,360,0,
		0,0.2,901,
		0.011,360,4001

	FOR z=1 to 5
		ROTx (360/5)*(z-1)
		PRISM_ 4,0.2,
			-0.01,-0.007,79,
			-0.01,0.007,79,
			0.01,0.007,79,
			0.01,-0.007,79
		DEL 1
	NEXT z
	DEL 1
ENDIF

! --- LEG'S ARMS ---
ADDx 0.08
ROTz 90
Rollrot = rnd(360)
FOR t=1 to 5
	MATERIAL gs_frame_mat
	ROTy 72*(t-1)
	RULED 4,4+16,
		-0.025,0,1,
		-0.025,0.04,1,
		0.025,0.04,1,
		0.025,0,1,

		-0.015,-0.05,0.28,
		-0.015,-0.01,0.28,
		0.015,-0.01,0.28,
		0.015,-0.05,0.28

	ADD 0,-0.05,0.28
	ROTz 90
	REVOLVE 2,180,1+2,
		0,0.015,1,
		0.04,0.015,1

	REVOLVE 2,360,1+2,
		0,0.008,1,
		-0.04,0.008,1
	DEL 2

	ADD 0,-0.08,0.28
	ROTy Rollrot-(72*(t-1))
	ADDz -0.015
	MATERIAL rollmat
	REVOLVE 4,360,1+2,
		-0.015,0.022,1,
		-0.012,0.025,1,
		0.012,0.025,1,
		0.015,0.022,1
	DEL 3
	DEL 1
NEXT t
DEL 2


DEL 1
DEL 2+2

RETURN

! --- FRAME ---
11:

heightdiff = (gs_seat_height-0.435)/3

IF gs_Armrest THEN
	MATERIAL chrommat
	ADDz -heightdiff*3
	TUBE 2,25,1+2,
		0,0,901,
		0.013,360,4001,

		0.3065786751853, 0 ,0.59+heightdiff*3,     0,
		0.17, 0 ,0.59+heightdiff*3,     0,
		0.1097855537533, 0 ,0.5787801792493+heightdiff*3,     0,
		0.08656206145181, 0 ,0.5724980731724+heightdiff*3,     0,
		0.06397849403029, 0 ,0.5606606636833+heightdiff*3,     0,
		0.04635179326089, 0 ,0.5459152961138+heightdiff*3,     0,
		0.02936782214395, 0 ,0.5235160364389+heightdiff*3,     0,
		0.0195919570923, 0 ,0.5015428093687+heightdiff*3,     0,
		0.001780754752989, 0 ,0.4418305322271+heightdiff*3,     0,
		-0.02005489883911, 0 ,0.3569546786755+heightdiff*3 ,     0,
		-0.03800549719149, 0 ,0.2716558192391+heightdiff*2,     0,
		-0.05211103782558, 0 ,0.1860169274813+heightdiff*1,     0,
		-0.06250229539245, 0 ,0.09908900489047,     0,
		-0.06250229539245, 0 ,0.06250229539245,     0,
		-0.05470800580027, 0 ,0.03649764704552,     0,
		-0.03935141883868, 0 ,0.01703609976948,     0,
		-0.01923338664202, 0 ,0.004652598670707,     0,
		0,         0 ,    0,     0,
		0.4,      0,       0,     0,
		0.415,	  0.005,   0,     0,
		0.435,	  0.020,   0,     0,
		0.445,	  0.035,   0,     0,
		0.45,	  0.05,       0,     0,
		0.45,	  0.24,       0,     0,
		0.45,	  0.4,       0,     0

	ADD 0.17, 0 ,0.59+heightdiff*3
	ROTz 90
	ROTx 85

	MATERIAL gs_arm_mat
	RULED 4,1+2+4+16+32,
		-0.015,-0.015,1,
		-0.015,0.015,1,
		0.015,0.015,1,
		0.015,-0.015,1,

		-0.025,0,0.16,
		-0.025,0.03,0.16,
		0.025,0.03,0.16,
		0.025,0,0.16
	DEL 3
	DEL 1
ELSE
	MATERIAL chrommat
	ADDz -heightdiff*3
	TUBE 2,22,1+2+16,
		0,0,901,
		0.013,360,4001,

		0.3873000569264, 0, 0.3812449960918+heightdiff*3,      0,
		0.3021248290733, 0 , 0.3871256010035+heightdiff*3,      0,
		0.03123923490251, 0 , 0.396498804954+heightdiff*3,      0,
		0.0112917368587, 0 , 0.392555266031+heightdiff*3,      0,
		-0.002855992695727, 0 , 0.3838960773315+heightdiff*3,      0,
		-0.0129479983255, 0 , 0.3722821393241+heightdiff*3,      0,
		-0.02005489883911, 0 ,0.3569546786755+heightdiff*3,     0,
		-0.03800549719149, 0 ,0.2716558192391+heightdiff*2,     0,
		-0.05211103782558, 0 ,0.1860169274813+heightdiff*1,     0,
		-0.06250229539245, 0 ,0.09908900489047,     0,
		-0.06250229539245, 0 ,0.06250229539245,     0,
		-0.05470800580027, 0 ,0.03649764704552,     0,
		-0.03935141883868, 0 ,0.01703609976948,     0,
		-0.01923338664202, 0 ,0.004652598670707,     0,
		0,         0 ,    0,     0,
		0.4,      0,       0,     0,
		0.415,	  0.005,   0,     0,
		0.435,	  0.020,   0,     0,
		0.445,	  0.035,   0,     0,
		0.45,	  0.05,       0,     0,
		0.45,	  0.24,       0,     0,
		0.45,	  0.4,       0,     0
	DEL 1
ENDIF

RETURN

! --- LEG ---
12:

legend = -gs_seat_height+0.055
IF gs_leg_type_m = 4 THEN legend = -gs_seat_height+0.055+0.08


MATERIAL chrommat
TUBE 2,13,1+2+16+32,
	0,0,901,
	0.015,360,4001,

	0.1666810241979, 0,  -0.1974957142823,     0,
	0,            0,     0,   0,
	-0.2498165350382, 0, 0.02560920944928,     0,
	-0.2678673955094, 0,  0.02398325410074,     0,
	-0.2844831417012, 0,  0.01493487596126,     0,
	-0.2950125464472, 0,  -0.0004064932272643,     0,
	-0.2998535869573, 0,  -0.01847350237249,     0,
	-0.3329875894101, 0,  -0.1759483051709,     0,
	-0.3355402591985, 0,  -0.1874353192186,     0,
	-0.3355402591985, 0,  -0.2641439740963,     0,
	-0.3355402591985, 0,  -0.3307922339102,     0,
	-0.3355402591985, 0,  legend,     0,
	-0.3355402591985, 0,  legend-0.1,     0

IF gs_Armrest THEN
	MATERIAL chrommat
	TUBE 2,12,1+2+16+32,
		0,0,901,
		0.015,360,4001,

		0.06405648704355, 0, 0.2702793498005,     0,
		-0.09356701944356, 0,  0.2280442585291,     0,
		-0.1101722496348, 0,  0.2235949005092,     0,
		-0.12454475381, 0,  0.2165933141982,     0,
		-0.1353572492538, 0,  0.2055024169148,     0,
		-0.1427364033396, 0,  0.1875378491927,     0,
		-0.1420739701745, 0,  0.1683394996855,     0,
		0, 0,  0,     0,
		0.1666810241979, 0,  -0.1974957142823,     0,
		0.1666810241979, 0,  -0.2641439740963,     0,
		0.1666810241979, 0,  legend,     0,
		0.1666810241979, 0,  legend-0.1,     0

	ADD -0.09356701944356, 0,  0.2280442585291
	ROTz 90
	ROTx 75
	MATERIAL gs_arm_mat
	RULED 4,1+2+4+16+32,
		-0.015,-0.015,1,
		-0.015,0.015,1,
		0.015,0.015,1,
		0.015,-0.015,1,

		-0.025,0,0.16,
		-0.025,0.03,0.16,
		0.025,0.03,0.16,
		0.025,0,0.16

	DEL 3
ELSE
	MATERIAL chrommat
	TUBE 2,6,1+2+16+32,
		0,0,901,
		0.015,360,4001,

		-0.2498165350382, 0, 0.02560920944928,     0,
		0, 0,  0,     0,
		0.1666810241979, 0,  -0.1974957142823,     0,
		0.1666810241979, 0,  -0.2641439740963,     0,
		0.1666810241979, 0,  legend,     0,
		0.1666810241979, 0,  legend-0.1,     0
ENDIF


IF gs_leg_type_m = 3 THEN
	MATERIAL gs_arm_mat
	ADDz -gs_seat_height+0.055
	PRISM_ 2,0.02,
		-0.3355402591985, 0,979,
		0.017,360,4079

	PRISM_ 2,0.02,
		0.1666810241979, 0,979,
		0.017,360,4079
	DEL 1
ENDIF

IF gs_leg_type_m = 4 THEN
	ADD 0.15, 0, legend-0.05
	ROTz 90
	MATERIAL rollmat
	ADD 0,-0.015,0
	PRISM_ 2,0.05,
		0,0,979,
		0.008,360,4079
	DEL 1

	REVOLVE 4,360,1+2,
		-0.015,0.027,1,
		-0.012,0.03,1,
		0.012,0.03,1,
		0.015,0.027,1
	DEL 2

	ADD -0.35, 0, legend-0.05
	ROTz 90
	MATERIAL rollmat
	ADD 0,-0.015,0
	PRISM_ 2,0.05,
		0,0,979,
		0.008,360,4079
	DEL 1

	REVOLVE 4,360,1+2,
		-0.015,0.027,1,
		-0.012,0.03,1,
		0.012,0.03,1,
		0.015,0.027,1
	DEL 2

ENDIF



RETURN


! --- OfficeRoll ARMS ---
20:
RESOL gs_resol
MATERIAL chrommat
TUBE 2,14,1+2+16+32,
	0,0,901,
	0.015,360,4001,

	0.1315540313927, 0, 0.3079860575501,     0,
	-0.02606947509445, 0,  0.2657509662787,     0,
	-0.04267470528566, 0,  0.2613016082589,     0,
	-0.05704720946092, 0,  0.2543000219478,     0,
	-0.06785970490467, 0,  0.2432091246645,     0,
	-0.07523885899044, 0,  0.2252445569424,     0,
	-0.07457642582541, 0,  0.2060462074352,     0,
	0,           0, 0,      20,
	0,-0.004035471402933, -0.01710207503344,     70,
	0,-0.01334557821189, -0.03115264500524,     70,
	0,-0.02637409626766, -0.04095973473294,     70,
	0,-0.0444645836285, -0.04624436611928,     70,
	0,-0.21, -0.04624436611928,     70,
	0,-0.26, -0.04624436611928,     0

ADD -0.02606947509445, 0,  0.2657509662787
ROTz 90
ROTx 75
MATERIAL gs_arm_mat
RULED 4,1+2+4+16+32,
	-0.015,-0.015,1,
	-0.015,0.015,1,
	0.015,0.015,1,
	0.015,-0.015,1,

	-0.025,0,0.16,
	-0.025,0.03,0.16,
	0.025,0.03,0.16,
	0.025,0,0.16

DEL 3


RETURN
