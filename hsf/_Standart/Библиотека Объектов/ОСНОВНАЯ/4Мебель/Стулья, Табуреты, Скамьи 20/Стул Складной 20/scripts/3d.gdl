
IF gs_detlevel_3D_m=0 THEN END


PEN gs_cont_pen

IF gs_shadow=0 THEN SHADOW OFF

IF GLOB_CONTEXT>20 and GLOB_CONTEXT<40 THEN gs_detlevel_3D_m=1

IF gs_detlevel_3D_m=1 THEN RESOL 4
IF gs_detlevel_3D_m=2 THEN RESOL gs_resol

ADD a/2,b/2,0

unID=1

HOTSPOT  -a/2, -b/2, 0, unID: unID=unID+1
HOTSPOT  -a/2,  b/2, 0, unID: unID=unID+1
HOTSPOT   a/2, -b/2, 0, unID: unID=unID+1
HOTSPOT   a/2,  b/2, 0, unID: unID=unID+1

hotspot -a/2, -b/2+zzyzx/TAN(alfa)*bm+wh/SIN(alfa)-wh/TAN(alfa), 0, unID, zzyzx, 1+128: unID=unID+1
hotspot -a/2, -b/2+zzyzx/TAN(alfa)*bm+wh/SIN(alfa)-wh/TAN(alfa), -1, unID, zzyzx, 3: unID=unID+1
hotspot -a/2, -b/2+zzyzx/TAN(alfa)*bm+wh/SIN(alfa)-wh/TAN(alfa), zzyzx, unID, zzyzx, 2: unID=unID+1

hotspot a/2, -b/2+zzyzx/TAN(alfa)*bm+wh/SIN(alfa)-wh/TAN(alfa), 0, unID, zzyzx, 1+128: unID=unID+1
hotspot a/2, -b/2+zzyzx/TAN(alfa)*bm+wh/SIN(alfa)-wh/TAN(alfa), -1, unID, zzyzx, 3: unID=unID+1
hotspot a/2, -b/2+zzyzx/TAN(alfa)*bm+wh/SIN(alfa)-wh/TAN(alfa), zzyzx, unID, zzyzx, 2: unID=unID+1

hotspot -a/2+2*th, -b/2+wh/SIN(alfa)*b/(b+wh/SIN(Alfa)+wh/COS(Beta)), 0, unID, gs_seat_height, 1+128: unID=unID+1
hotspot -a/2+2*th, -b/2+wh/SIN(alfa)*b/(b+wh/SIN(Alfa)+wh/COS(Beta)), -1, unID, gs_seat_height, 3: unID=unID+1
hotspot -a/2+2*th, -b/2+wh/SIN(alfa)*b/(b+wh/SIN(Alfa)+wh/COS(Beta)), gs_seat_height, unID, gs_seat_height, 2: unID=unID+1

hotspot a/2-2*th, -b/2+wh/SIN(alfa)*b/(b+wh/SIN(Alfa)+wh/COS(Beta)), 0, unID, gs_seat_height, 1+128: unID=unID+1
hotspot a/2-2*th, -b/2+wh/SIN(alfa)*b/(b+wh/SIN(Alfa)+wh/COS(Beta)), -1, unID, gs_seat_height, 3: unID=unID+1
hotspot a/2-2*th, -b/2+wh/SIN(alfa)*b/(b+wh/SIN(Alfa)+wh/COS(Beta)), gs_seat_height, unID, gs_seat_height, 2: unID=unID+1


ADDY -b/2
MULY b/(b+wh/SIN(Alfa)+wh/COS(Beta))

ADD -A/2, wh/SIN(Alfa), 0

seatH = 0.024

IF iChairModelStyle = 1  OR iChairModelStyle = 4 OR iChairModelStyle = 5 THEN
	MATERIAL gs_frame_mat
	rotx 90
	Roty 90

	ADD (gs_seat_height/4)/TAN(Alfa),gs_seat_height/4,0
	ROTZ Alfa+90
	CUTPOLY 4,
		-Wh/4,-Wh,
		-Wh/4,Wh,
		Wh/4,Wh,
		Wh/4,-Wh
	DEL 2


! --- cut for back -------------------------------------------------------------

	if iChairModelStyle = 1 then
		ADD (gs_seat_height+0.85*toth)/TAN(Alfa),gs_seat_height+0.85*toth,0
		ROTZ Alfa+90
		CUTPOLY 4,
			-Wh/4,-Wh,
			-Wh/4,Wh,
			Wh/4,Wh,
			Wh/4,-Wh
		DEL 2
		ADD (gs_seat_height+0.65*toth)/TAN(Alfa),gs_seat_height+0.65*toth,0
		ROTZ Alfa+90
		CUTPOLY 4,
			-Wh/4,-Wh,
			-Wh/4,Wh,
			Wh/4,Wh,
			Wh/4,-Wh
		DEL 2
	endif

	ADDZ th*2
	ADD (gs_seat_height-seatH/2)/TAN(Alfa),gs_seat_height-seatH/2,-2*th
	CUTPOLYA 2,1,0,
		0,0,915,
		seatH/2,360,4015
	DEL 2

	FOR I=1 TO 2
		PRISM_ 5,th,
			0, 0, 15,
			0+wh/SIN(Alfa), 0, 15,
			B+wh*SIN(Alfa)-wh/TAN(alfa), zzyzx-wh*COS(Alfa)-wh, 79,
			B-wh*SIN(Alfa)-wh/TAN(alfa), zzyzx+wh*COS(Alfa)-wh, 1079,
			-wh/SIN(Alfa), 0, 15
		rotz alfa
		gosub 5000
		del 1
		ADDZ A-th
	NEXT I
	DEL 2
	if iChairModelStyle = 1 then
		CUTEND
		CUTEND
	endif
	CUTEND
	CUTEND
	ADD (gs_seat_height/4)/TAN(Alfa),gs_seat_height/4,0
	ROTZ Alfa+90
	PRISM 4,A,
		-Wh/4,-Wh,
		-Wh/4,Wh,
		Wh/4,Wh,
		Wh/4,-Wh
	DEL 2

! --- back ---------------------------------------------------------------------
	MATERIAL gs_back_mat

	if iChairModelStyle = 1 then
		ADD (gs_seat_height+0.85*toth)/TAN(Alfa),gs_seat_height+0.85*toth,0
		ROTZ Alfa+90

		PRISM 4,A,
			-Wh/4,-Wh,
			-Wh/4,Wh,
			Wh/4,Wh,
			Wh/4,-Wh

		DEL 2

		ADD (gs_seat_height+0.65*toth)/TAN(Alfa),gs_seat_height+0.65*toth,0
		ROTZ Alfa+90

		PRISM 4,A,
			-Wh/4,-Wh,
			-Wh/4,Wh,
			Wh/4,Wh,
			Wh/4,-Wh

		DEL 2
	else
		if iChairModelStyle = 5 then

			ADD (gs_seat_height+0.85*toth)/TAN(Alfa),gs_seat_height+0.85*toth, th

			ROTx 90
			ROTy 90+Alfa
			muly-1
			ROTx 180

			mulx B/(0.48)
			muly A/(0.46)

			GROUP "rygstoed_1"
			kd=0.416
			rund_x=0.46
			rund_y=0.211

			PRISM_ 6, 0.0426,
				0.000,0.000,15,
				rund_x,rund_y,900+15,
				0.000,kd,3000+15,
				0.0163,kd,15,
				0.0163,0.000,15,
				0.000,0.000,-1

			ENDGROUP

			GROUP "rygstoed_2"
			ADDx 0.016
			PRISM_ 6, 0.043,
				0.000,0.000,15,
				rund_x,rund_y,900+15,
				0.000,kd,3000+15,
				0.01615,kd,15,
				0.01615,0.000,15,
				0.000,0.000,-1
			DEL 1
			ENDGROUP

			resultat=SUBGROUP("rygstoed_1","rygstoed_2")
			for i=1 to 2
				PLACEGROUP resultat
				addz 0.057
			next i
			DEL 7+2
			KILLGROUP "rygstoed_1"
			KILLGROUP "rygstoed_2"
		else
			positionBack = 0.62
			for i = 1 to 5
				ADD (gs_seat_height+positionBack*toth)/TAN(Alfa),gs_seat_height+positionBack*toth,th
				ROTZ Alfa+90

				PRISM 4,A-2*th,
					-Wh/4,-Wh/2,
					-Wh/4,Wh/2,
					Wh/4,Wh/2,
					Wh/4,-Wh/2

				DEL 2

				positionBack = positionBack + 0.09
			next i
		endif
	endif
	rotz 90 + alfa
	gosub 1000
	del 1

! --- back legs ----------------------------------------------------------------

	MATERIAL gs_frame_mat
	Beta=ATN(ABS(X4-B)/ABS(Y4))

	ADD B-0.3*gs_seat_height/TAN(90-Beta),0.3*gs_seat_height,th
	ROTZ Beta
	CUTPOLY 4,
		-Wh/4,-Wh,
		-Wh/4,Wh,
		Wh/4,Wh,
		Wh/4,-Wh
	DEL 2

	addz th
	FOR I=1 TO 2
		PRISM_ 5,th,
			B,0,15,
			B+wh/COS(Beta),0,15,
			X4+wh*COS(Beta),Y4+wh*SIN(Beta),79,
			X4-wh*COS(Beta),Y4-wh*SIN(Beta),1079,
			B-wh/COS(Beta),0,15
		rotz 90 + beta
		gosub 5000
		del 1
		ADDZ A-3*th
	NEXT I
	DEL 3
	CUTEND

	ADD B-0.3*gs_seat_height/TAN(90-Beta),0.3*gs_seat_height,th
	ROTZ Beta
	PRISM 4, A-2*th,
		-Wh/4, -Wh,
		-Wh/4,  Wh,
		 Wh/4,  Wh,
		 Wh/4, -Wh
	gosub 1000
	DEL 2

! --- seat ---------------------------------------------------------------------

	MATERIAL gs_seat_mat
	ADDZ th*2

	if iChairModelStyle = 1 then
		PRISM 4,A-4*th,
			0, gs_seat_height,
			0, gs_seat_height-seatH,
			B-gs_seat_height/TAN(90-Beta),gs_seat_height-seatH ,
			B-gs_seat_height/TAN(90-Beta),gs_seat_height
		rotz 90
		gosub 1000
		del 1
	else
		if iChairModelStyle = 5 then
			rotx -90
			rotz 90
			add 0.04-0.045, -0.08, th-0.002
			mulx A/0.46
			muly B/0.46

			ADD 0,-0.314901,gs_seat_height-(0.45-0.399898)
			ROTz 90
			ROTy -2.47
			R=0.02
			D=0.430-R

			PRISM_ 23, 0.04,
				0,0,15,
				D+R*SIN(0), R-R*COS(0),15,
				D+R*SIN(5), R-R*COS(5),15,
				D+R*SIN(10), R-R*COS(10),15,
				D+R*SIN(15), R-R*COS(15),15,
				D+R*SIN(20), R-R*COS(20),15,
				D+R*SIN(25), R-R*COS(25),15,
				D+R*SIN(30), R-R*COS(30),15,
				D+R*SIN(35), R-R*COS(35),15,
				D+R*SIN(40), R-R*COS(40),15,
				D+R*SIN(45), R-R*COS(45),15,
				D+R*SIN(50), R-R*COS(50),15,
				D+R*SIN(55), R-R*COS(55),15,
				D+R*SIN(60), R-R*COS(60),15,
				D+R*SIN(65), R-R*COS(65),15,
				D+R*SIN(70), R-R*COS(70),15,
				D+R*SIN(75), R-R*COS(75),15,
				D+R*SIN(80), R-R*COS(80),15,
				D+R*SIN(85), R-R*COS(85),15,
				D+R*SIN(90), R-R*COS(90),15,
				0.430,0.02,15,
				0,0.02,15,
				0,0,-1
			GOSUB 5000

			ROTx -90.0
			ADDx 0.055402
			ADDz -0.01
			ADDy -0.026
			MATERIAL gs_seat_mat
			CYLIND 0.03, 0.0032
			DEL 4+3

			MATERIAL gs_seat_mat
			ADD -0.405+0.045,-0.314901,gs_seat_height-(0.45-0.439898)
			ADDz -0.04
			ROTz 90
			ROTy -2.47
			ROTx 180
			R=0.02
			D=0.430-R

			MULx -1
			ROTy 180
			PRISM_ 23, 0.04,
				0,0,15,
				D+R*SIN(0), R-R*COS(0),15,
				D+R*SIN(5), R-R*COS(5),15,
				D+R*SIN(10), R-R*COS(10),15,
				D+R*SIN(15), R-R*COS(15),15,
				D+R*SIN(20), R-R*COS(20),15,
				D+R*SIN(25), R-R*COS(25),15,
				D+R*SIN(30), R-R*COS(30),15,
				D+R*SIN(35), R-R*COS(35),15,
				D+R*SIN(40), R-R*COS(40),15,
				D+R*SIN(45), R-R*COS(45),15,
				D+R*SIN(50), R-R*COS(50),15,
				D+R*SIN(55), R-R*COS(55),15,
				D+R*SIN(60), R-R*COS(60),15,
				D+R*SIN(65), R-R*COS(65),15,
				D+R*SIN(70), R-R*COS(70),15,
				D+R*SIN(75), R-R*COS(75),15,
				D+R*SIN(80), R-R*COS(80),15,
				D+R*SIN(85), R-R*COS(85),15,
				D+R*SIN(90), R-R*COS(90),15,
				0.430,0.02,15,
				0,0.02,15,
				0,0,-1
			DEL 3
			GOSUB 5000

			MATERIAL gs_seat_mat
			ROTx -90.0
			ADDx 0.055402
			ADDz -0.02
			ADDy -0.026
			CYLIND 0.03, 0.0032
			DEL 5+3

			MATERIAL gs_seat_mat
			ADD -0.385+0.045,-0.234996,gs_seat_height-(0.45-0.403354)
			ROTx 2.47
			PRISM_ 5,0.04,
				0,0,15,
				0.32,0,15,
				0.32,0.02,15,
				0,0.02,15,
				0,0,-1
			GOSUB 5000
			DEL 2

			ADD -0.405014+0.045,0.094809,gs_seat_height-(0.45-0.417567)
			ROTx 2.47

			k=(90-ATN((0.32/2)/0.008))*2
			r1=(0.324/2)/SIN(k)

			GROUP "overkant"
			ADD 0.018,0.01,0.032
			ROTx 180
			ROTy 84.2752
			ELBOW r1,2*k,0.01
			DEL 3
			ENDGROUP

			GROUP "krop"
			R=0.02
			D=0.360-R
			E=0.02-R
			PRISM_ 22, 0.032,
				D,0.02,15,
				R-R*COS(90), E+R*SIN(90),15,
				R-R*COS(80), E+R*SIN(80),15,
				R-R*COS(70), E+R*SIN(70),15,
				R-R*COS(60), E+R*SIN(60),15,
				R-R*COS(50), E+R*SIN(50),15,
				R-R*COS(40), E+R*SIN(40),15,
				R-R*COS(30), E+R*SIN(30),15,
				R-R*COS(20), E+R*SIN(20),15,
				R-R*COS(10), E+R*SIN(10),15,
				R-R*COS(0), E+R*SIN(0),15,

				D+R*COS(0), E+R*SIN(0),15,
				D+R*COS(10), E+R*SIN(10),15,
				D+R*COS(20), E+R*SIN(20),15,
				D+R*COS(30), E+R*SIN(30),15,
				D+R*COS(40), E+R*SIN(40),15,
				D+R*COS(50), E+R*SIN(50),15,
				D+R*COS(60), E+R*SIN(60),15,
				D+R*COS(70), E+R*SIN(70),15,
				D+R*COS(80), E+R*SIN(80),15,
				D+R*COS(90), E+R*SIN(90),15,
				D,0.02,-1
			ENDGROUP

			resultat=ADDGROUP("krop","overkant")

			PLACEGROUP resultat

			KILLGROUP "overkant"
			KILLGROUP "krop"
			DEL 2
			MATERIAL gs_seat_mat

			ADDz gs_seat_height-(0.45-0.44)
			ADDx -0.065+0.045
			ROTx 92.47
			ADDz -0.103643
			ROTz 4.4983

			FOR i=1 TO 10 STEP 1
				ADDx -0.03205
				ROTz -0.969
				EXTRUDE 9, 0,0,0.32,63,
					0.000,0.000,0,
					0.005,-0.003,0,
					0.027,-0.003,0,
					0.032,0.000,0,
					0.032,0.004,0,
					0.027,0.007,0,
					0.005,0.007,0,
					0.000,0.004,0,
					0.000,0.000,-1
			NEXT i
			DEL 21+5

			del 4
		else
			prism_ 5, th,
				(B-gs_seat_height/TAN(90-Beta))*0.25, gs_seat_height + seatH/2,15,
				(B-gs_seat_height/TAN(90-Beta))*0.25, gs_seat_height-seatH- seatH/2,15,
				B-gs_seat_height/TAN(90-Beta)+th,gs_seat_height-seatH- seatH/2,15,
				B-gs_seat_height/TAN(90-Beta)+th,gs_seat_height + seatH/2,15,
				(B-gs_seat_height/TAN(90-Beta))*0.25, gs_seat_height + seatH/2, -1

			dist = (a - 6 * th) / 25
			addz th + dist

			for i = 1 to 8
				prism_ 5, dist * 2,
					0, gs_seat_height,15,
					0, gs_seat_height-seatH,15,
					B-gs_seat_height/TAN(90-Beta)+th*3,gs_seat_height-seatH,15,
					B-gs_seat_height/TAN(90-Beta)+th*3,gs_seat_height,15,
					0, gs_seat_height, -1
				addz dist * 3
			next i
			del 9

			addz a - 5*th
			prism_ 5, th,
				(B-gs_seat_height/TAN(90-Beta))*0.25, gs_seat_height + seatH/2, 15,
				(B-gs_seat_height/TAN(90-Beta))*0.25, gs_seat_height-seatH- seatH/2, 15,
				B-gs_seat_height/TAN(90-Beta)+th,gs_seat_height-seatH-seatH/2,15,
				B-gs_seat_height/TAN(90-Beta)+th,gs_seat_height + seatH/2,15,
				(B-gs_seat_height/TAN(90-Beta))*0.25, gs_seat_height + seatH/2, -1
			del 1
			gosub 5000
		endif
	endif

	ADD (gs_seat_height-seatH/2)/TAN(Alfa),gs_seat_height-seatH/2,-2*th
		CYLIND A,seatH/2
	DEL 4
	gosub 5000
ENDIF


IF iChairModelStyle = 2 THEN
	MATERIAL gs_frame_mat
	rotx 90
	Roty 90

	ADD (gs_seat_height/4)/TAN(Alfa),gs_seat_height/4,0
	ROTZ Alfa+90
	CUTPOLY 4,
		-Wh/4,-Wh,
		-Wh/4,Wh,
		Wh/4,Wh,
		Wh/4,-Wh
	DEL 2
	ADD (gs_seat_height+0.75*toth)/TAN(Alfa),gs_seat_height+0.75*toth,0
	ROTZ Alfa+90
	CUTPOLY 4,
		-Wh/4,-0.5*toth/SIN(Alfa)/2,
		-Wh/4,0.5*toth/SIN(Alfa)/2,
		Wh/4,0.5*toth/SIN(Alfa)/2,
		Wh/4,-0.5*toth/SIN(Alfa)/2
	DEL 2

	ADDZ th*2
	ADD (gs_seat_height-seatH/2)/TAN(Alfa),gs_seat_height-seatH/2,-2*th
	CUTPOLYA 2,1,0,
	0,0,915,
	seatH/2,360,4015
	DEL 2

	FOR I=1 TO 2
		PRISM_ 5,th,
			0,0,15,
			0+wh/SIN(Alfa), 0, 15,
			B+wh*SIN(Alfa)-wh/TAN(alfa), zzyzx-wh*COS(Alfa)-wh, 79,
			B-wh*SIN(Alfa)-wh/TAN(alfa), zzyzx+wh*COS(Alfa)-wh, 1079,
			-wh/SIN(Alfa), 0, 15

		rotz alfa
		gosub 5000
		del 1
		ADDZ A-th
	NEXT I
	DEL 2
	CUTEND
	CUTEND
	CUTEND

	ADD (gs_seat_height/4)/TAN(Alfa),gs_seat_height/4,0
	ROTZ Alfa+90

	PRISM 4,A,
		-Wh/4,-Wh,
		-Wh/4,Wh,
		Wh/4,Wh,
		Wh/4,-Wh

	DEL 2

	MATERIAL gs_back_mat

	ADD (gs_seat_height+0.75*toth)/TAN(Alfa),gs_seat_height+0.75*toth,0
	ROTZ Alfa+90

	PRISM 4,A,
		-Wh/4,-0.5*toth/SIN(Alfa)/2,
		-Wh/4,0.5*toth/SIN(Alfa)/2,
		Wh/4,0.5*toth/SIN(Alfa)/2,
		Wh/4,-0.5*toth/SIN(Alfa)/2

	DEL 2

	rotz 90 + alfa
	gosub 1000
	del 1

	MATERIAL gs_frame_mat
	Beta=ATN(ABS(X4-B)/ABS(Y4))

	ADD B-0.3*gs_seat_height/TAN(90-Beta),0.3*gs_seat_height,th
	ROTZ Beta
	CUTPOLY 4,
		-Wh/4,-Wh,
		-Wh/4,Wh,
		Wh/4,Wh,
		Wh/4,-Wh
	DEL 2
	ADD B-0.6*gs_seat_height/TAN(90-Beta),0.6*gs_seat_height,th
	ROTZ Beta
	CUTPOLY 4,
		-Wh/4,-Wh,
		-Wh/4,Wh,
		Wh/4,Wh,
		Wh/4,-Wh
	DEL 2

	addz th
	FOR I=1 TO 2
		PRISM_ 5,th,
			B,0,15,
			B+wh/COS(Beta),0,15,
			X4+wh*COS(Beta),Y4+wh*SIN(Beta),79,
			X4-wh*COS(Beta),Y4-wh*SIN(Beta),1079,
			B-wh/COS(Beta),0,15

		rotz 90 + beta
		gosub 5000
		del 1
		ADDZ A-3*th
	NEXT I
	DEL 3
	CUTEND
	CUTEND

	ADD B-0.3*gs_seat_height/TAN(90-Beta),0.3*gs_seat_height,th
	ROTZ Beta

	PRISM 4,A-2*th,
		-Wh/4,-Wh,
		-Wh/4,Wh,
		Wh/4,Wh,
		Wh/4,-Wh

	DEL 2


	ADD B-0.6*gs_seat_height/TAN(90-Beta),0.6*gs_seat_height,th
	ROTZ Beta

	PRISM 4,A-2*th,
		-Wh/4,-Wh,
		-Wh/4,Wh,
		Wh/4,Wh,
		Wh/4,-Wh
	rotz - beta*0
	gosub 1000
	del 1
	DEL 2

	MATERIAL gs_seat_mat

	ADDZ th*2
	PRISM 4,A-4*th,
		0,gs_seat_height,
		0,gs_seat_height-seatH,
		B-gs_seat_height/TAN(90-Beta),gs_seat_height-seatH,
		B-gs_seat_height/TAN(90-Beta),gs_seat_height

	ADD (gs_seat_height-seatH/2)/TAN(Alfa),gs_seat_height-seatH/2,-2*th
		CYLIND A,seatH/2
	DEL 4

	gosub 5000

ENDIF



IF iChairModelStyle = 3 THEN
	MATERIAL gs_frame_mat
	rotx 90
	Roty 90

	ADD (gs_seat_height/4)/TAN(Alfa),gs_seat_height/4,0
	ROTZ Alfa+90
	CUTPOLY 4,
		-Wh/4,-Wh,
		-Wh/4,Wh,
		Wh/4,Wh,
		Wh/4,-Wh
	DEL 2

	ADD (gs_seat_height+0.75*toth)/TAN(Alfa),gs_seat_height+0.75*toth,0
	ROTZ Alfa+90
	CUTPOLYA 5,1,0,
		-Wh/4,-0.5*toth/SIN(Alfa)/2,15,
		-Wh/4,0.5*toth/SIN(Alfa)/2,15,
		Wh/4,0.5*toth/SIN(Alfa)/2,15,
		Wh/4,-0.5*toth/SIN(Alfa)/2,15,
		-Wh/4,-0.5*toth/SIN(Alfa)/2,15
	DEL 2

	ADDZ th*2
	ADD (gs_seat_height-seatH/2)/TAN(Alfa),gs_seat_height-seatH/2,-2*th
	CUTPOLYA 2,1,0,
		0,0,915,
		seatH/2,360,4015
	DEL 2

	FOR I=1 TO 2
		PRISM_ 5, th,
			0, 0, 15,
			wh/SIN(Alfa), 0, 15,
			B+wh*SIN(Alfa)-wh/TAN(alfa), zzyzx-wh*COS(Alfa)-wh, 79,
			B-wh*SIN(Alfa)-wh/TAN(alfa), zzyzx+wh*COS(Alfa)-wh, 1079,
			-wh/SIN(Alfa), 0, 15
		rotz alfa
		gosub 5000
		del 1
		ADDZ A-th
	NEXT I
	DEL 2
	CUTEND
	CUTEND
	CUTEND
	ADD (gs_seat_height/4)/TAN(Alfa),gs_seat_height/4,0
	ROTZ Alfa+90

	PRISM 4,A,
		-Wh/4,-Wh,
		-Wh/4,Wh,
		Wh/4,Wh,
		Wh/4,-Wh

	DEL 2

	MATERIAL gs_back_mat
	ADD (gs_seat_height+0.75*toth)/TAN(Alfa),gs_seat_height+0.75*toth,0
	ROTZ Alfa+90

	PRISM_ 5,A,
		-Wh/4,-0.5*toth/SIN(Alfa)/2,15,
		-Wh/4,0.5*toth/SIN(Alfa)/2,15,
		Wh/4,0.5*toth/SIN(Alfa)/2,15,
		Wh/4,-0.5*toth/SIN(Alfa)/2,15,
		-Wh/4,-0.5*toth/SIN(Alfa)/2,15

	DEL 2
	rotz 90 + alfa
	gosub 1000
	del 1

	MATERIAL gs_frame_mat

	Beta=ATN(ABS(X4-B)/ABS(Y4))

	ADD B-0.3*gs_seat_height/TAN(90-Beta),0.3*gs_seat_height,th
	ROTZ Beta
	CUTPOLY 4,
		-Wh/4,-Wh,
		-Wh/4,Wh,
		Wh/4,Wh,
		Wh/4,-Wh
	DEL 2

	ADD B-0.6*gs_seat_height/TAN(90-Beta),0.6*gs_seat_height,th
	ROTZ Beta
	CUTPOLY 4,
		-Wh/4,-Wh,
		-Wh/4,Wh,
		Wh/4,Wh,
		Wh/4,-Wh
	DEL 2

	addz th
	FOR I=1 TO 2
		PRISM_ 5,th,
			B,0,15,
			B+wh/COS(Beta),0,15,
			X4+wh*COS(Beta),Y4+wh*SIN(Beta),79,
			X4-wh*COS(Beta),Y4-wh*SIN(Beta),1079,
			B-wh/COS(Beta),0,15
		rotz 90 + beta
		gosub 5000
		del 1
		ADDZ A-3*th
	NEXT I
	DEL 3
	CUTEND
	CUTEND

	ADD B-0.3*gs_seat_height/TAN(90-Beta),0.3*gs_seat_height,th
	ROTZ Beta

	PRISM 4,A-2*th,
		-Wh/4,-Wh,
		-Wh/4,Wh,
		Wh/4,Wh,
		Wh/4,-Wh

	DEL 2


	ADD B-0.6*gs_seat_height/TAN(90-Beta),0.6*gs_seat_height,th
	ROTZ Beta

	PRISM 4,A-2*th,
		-Wh/4,-Wh,
		-Wh/4,Wh,
		Wh/4,Wh,
		Wh/4,-Wh
	rotz - beta*0
	gosub 1000
	del 1
	DEL 2
	vv=ABS((B-gs_seat_height/TAN(90-Beta)))/20
	ADDZ th*2

	ADD vv*2,0,th
	ROTX 90
	MATERIAL gs_seat_mat
	FOR I=1 TO 6
	CUTPOLY 4,
		0,0,
		0,A-6*th,
		-vv,A-6*th,
		-vv,0

	ADDX 2*vv
	NEXT I

	DEL 8

	PRISM 4,A-4*th,
		0,gs_seat_height,
		0,gs_seat_height-seatH,
		B-gs_seat_height/TAN(90-Beta),gs_seat_height-seatH,
		B-gs_seat_height/TAN(90-Beta),gs_seat_height
	rotz 90
	gosub 1000
	del 1

	FOR I=1 TO 6
	CUTEND
	NEXT i
	ADD (gs_seat_height-seatH/2)/TAN(Alfa),gs_seat_height-seatH/2,-2*th
		CYLIND A,seatH/2
	DEL 4
	gosub 5000

ENDIF

DEL 1

DEL 3

END

1000:
roty 90
gosub 5000
del 1
return

5000:

vert 0, 0, 0
vert 1, 0, 0
vert 0, 1, 0
vert 0, 0, 1

coor 2, -1, -2, -3, -4

base

body -1

return


