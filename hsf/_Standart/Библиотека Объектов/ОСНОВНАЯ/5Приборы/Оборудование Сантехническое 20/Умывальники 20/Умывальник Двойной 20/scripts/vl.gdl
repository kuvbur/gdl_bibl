
call "FM_types" parameters all

ac_toplevel = h_top
ac_bottomlevel = ac_toplevel - zzyzx
parameters ac_toplevel = ac_toplevel, ac_bottomlevel = ac_bottomlevel

values "A" RANGE[0.40, ]
values "B" RANGE[0.20, ]
values "ZZYZX" RANGE[0.05, ]

dim st_detail3D[4]
	st_detail3D[1] = `Детальный`
	st_detail3D[2] = `Простой`
	st_detail3D[3] = `Упрощенный`
	st_detail3D[4] = `Откл.`

values "gs_detlevel_3D" st_detail3D		!`Detailed`,`Simple`,`Draft`,`Off`
values "gs_detlevel_3D_m" 2, 1, 3, 0

if GLOB_MODPAR_NAME = "gs_detlevel_3D" OR gs_detlevel_3D_m = -1 then
	gs_detlevel_3D_m = 2	! Detailed
	if gs_detlevel_3D = st_detail3D[4] then gs_detlevel_3D_m = 0
	if gs_detlevel_3D = st_detail3D[2] then gs_detlevel_3D_m = 1
	if gs_detlevel_3D = st_detail3D[3] then gs_detlevel_3D_m = 3
	parameters gs_detlevel_3D_m = gs_detlevel_3D_m
else
	gs_detlevel_3D = st_detail3D[1]
	if gs_detlevel_3D_m = 0 then gs_detlevel_3D = st_detail3D[4]
	if gs_detlevel_3D_m = 1 then gs_detlevel_3D = st_detail3D[2]
	if gs_detlevel_3D_m = 3 then gs_detlevel_3D = st_detail3D[3]
	parameters gs_detlevel_3D = gs_detlevel_3D
endif

call "2dDetailLevel" parameters	all enable2dDetLevels	= 2 + 4 + 8 + 16

call "tapType_m" parameters	all	enableTapGroups			= 2 + 4 + 8 + 16 + 32 + 64,
								enableSingleLevelTaps	= 2 + 2**3 + 2**5 + 2**9 + 2**18 + 2**19,
								enableTwoHandleTaps		= 2 + 2**4 + 2**6 + 2**7 + 2**8 + 2**11 + 2**12 + 2**13 + 2**14 + 2**20 + 2**21,
								enableTraditionalTaps	= 2 + 2**10 + 2**16 + 2**17,
								enableSensorFaucets		= 2 + 2**15 + 2**22,
								enableWallMountedTaps	= 2 + 2**23 + 2**24 + 2**25,
								enableCustomTaps		= 0,
								bEnableTapEdit			= 1,
								bShower 				= 0,
								enableTapSymbols		= 2 + 4 + 8 + 32,
								xTapRangeMin 			= -A/4,
								xTapRangeMax 			= A/4,
								yTapRangeMin 			= -0.035,
								yTapRangeMax 			= -yWallPos,
								zTapRangeMin 			= h_top - tapHeight

if gs_tap_type_m = 0 or not(bWallMountedTap) then
	lock "tapHeight"
	hideparameter "tapHeight"
else
	values "tapHeight" range[h_top + 0.1,]
endif

!!!!!!!!!!!!!!!!!!!!!!!!!!!!! *** Limitation

if gs_cont_pen=0 then parameters gs_cont_pen=75
if gs_fill_pen=0 then parameters gs_fill_pen=19
VALUES "gs_resol" RANGE [4,)

if gs_detlevel_3D_m = 1 then lock "gs_resol"


! --- Minimal Space ---

if MSFront < 0 then
	MSFront = 0
	parameters MSFront = MSFront
endif
if MSSide < 0 then
	MSSide = 0
	parameters MSSide = MSSide
endif
if MSSide2 < 0 then
	MSSide2 = 0
	parameters MSSide2 = MSSide2
endif


! --- start of modify to Shaft


	ConPosX_3 = -0.26*(A/1.120034)
	PARAMETERS ConPosX_3 = ConPosX_3
	ConPosY_3 = -0.2415*(B/0.500017)
	PARAMETERS ConPosY_3 = ConPosY_3

	ConPosX_4 = 0.26*(A/1.120034)
	PARAMETERS ConPosX_4 = ConPosX_4
	ConPosY_4 = -0.2415*(B/0.500017)
	PARAMETERS ConPosY_4 = ConPosY_4

IF isMEPEnabled THEN

	IF lock_conn_param THEN
		LOCK "gs_con_mat"
		HIDEPARAMETER "gs_con_mat"
	ENDIF

	DIM shape_typ_to_validation[3]
		shape_typ_to_validation[1] = 0		! Rectangle
		shape_typ_to_validation[2] = 1		! Circle
		shape_typ_to_validation[3] = 0		! Oval

					! --- CONNECTIONS --- !

	PARAMETERS MEP_NumberConnections = 6


					! --- 1st CONNECTION --- !

	ConID = 1
	ConName = `Подключение Горячей Воды`

	ConDVecX = 0
	ConDVecY = 1
	ConDVecZ = 0

	ConWVecX = -1
	ConWVecY = 0
	ConWVecZ = 0

	IF ConWidth_1 < 0.001 THEN
		ConWidth_1 = 0.001
		PARAMETERS ConWidth_1 = ConWidth_1
	ENDIF
	IF ConWidth_1 > zzyzx THEN
		ConWidth_1 = zzyzx
		PARAMETERS ConWidth_1 = ConWidth_1
	ENDIF
	VALUES "ConWidth_1" RANGE (0, zzyzx]
	PARAMETERS ConDepth_1 = ConWidth_1
	VALUES "ConLength_1" RANGE [0, ]

	PARAMETERS ConPosY_1 = 0

	! Default Position
	if (GLOB_MODPAR_NAME = "gs_tap_type" | GLOB_MODPAR_NAME = "gs_tap_type_m" | \
			GLOB_MODPAR_NAME = "tapGroup" | GLOB_MODPAR_NAME = "iTapGroup") then
		if bWallMountedTap then
			ConPosX_1 = posTap + widthTap/2
		else
			ConPosX_1 = -0.07
		endif
		parameters ConPosX_1 = ConPosX_1
	endif

	if bWallmountedTap then
		pos1st = -posTap - widthTap + ConWidth_1/2
		pos2nd = -posTap - ConWidth_1/2

		pos3rd = +posTap + ConWidth_1/2
		pos4th = +posTap + widthTap - ConWidth_1/2

		! --- X Range

		values "ConPosX_1"	range [pos1st, pos2nd],
							range [pos3rd, pos4th]


		! --- Change Connection Side
		if GLOB_MODPAR_NAME = "ConPosX_2" | (GLOB_MODPAR_NAME = "" & sgn(ConPosX_1) = sgn(ConPosX_2)) then
			if ConPosX_2 < 0 & ConPosX_1 < 0 then
				ConPosX_1 = posTap + widthTap/2
				parameters 	ConPosX_1 = ConPosX_1
			endif
			if ConPosX_2 > 0 & ConPosX_1 > 0 then
				ConPosX_1 = -(posTap + widthTap/2)
				parameters 	ConPosX_1 = ConPosX_1
			endif
		endif

		ConPosZ_1 = tapHeight-h_top
		parameters	ConPosX_1 = ConPosX_1,
					ConPosZ_1 = ConPosZ_1
	else
		VALUES "ConPosX_1" RANGE [-A/2+ConWidth_1/2, A/2-ConWidth_1/2]
		VALUES "ConPosZ_1" RANGE [, -ConWidth_1/2]
	endif


	CALL "MEP_m_ConnectionsACL_4" PARAMETERS SetProgram = SetProgram,
		gs_Connections = gs_Connections,
		MEP_NumConnectionData = MEP_NumConnectionData,
		MEP_StrConnectionData = MEP_StrConnectionData,
		MEP_NumberConnections = MEP_NumberConnections,
		gs_AddConnections = gs_AddConnections,
		ConName = ConName,
		ConID = ConID,
		ConPosX = ConPosX_1+(a/1.120034*0.2675 + xTapPos)*bWallmountedTap,
		ConPosY = ConPosY_1,
		ConPosZ = ConPosZ_1+h_top+zTapPos*bWallmountedTap,
		ConDVecX = ConDVecX,
		ConDVecY = ConDVecY,
		ConDVecZ = ConDVecZ,
		ConWVecX = ConWVecX,
		ConWVecY = ConWVecY,
		ConWVecZ = ConWVecZ,

		ConNominalWidth = ConNominalWidth_1,
		ConNominalDepth = ConNominalDepth_1,
		ConWidth = ConWidth_1,
		ConDepth = ConDepth_1,
		ConLength = ConLength_1,
		ConWallThickness = ConWallThickness_1,
		ConConnectorWidth = ConConnectorWidth_1,
		ConConnectorDepth = ConConnectorDepth_1,
		ConConnectorWidth2 = ConConnectorWidth2_1,
		ConToolType = ConToolType_1,
		ConStatus = ConStatus_1,
		ConType_1 = ConType_1,
		ConConnectorType_1 = ConConnectorType_1,
		ConSystem_1 = ConSystem_1,
		ui_current_con = ui_current_con,
		shape_typ_to_validation = shape_typ_to_validation,
		MEP_enabled_geometry_mod = 1,
		gs_ui = 1

	PARAMETERS MEP_ConInfo[ConID][1] = STR(ConToolType_1, 1, 0)
	PARAMETERS MEP_ConInfo[ConID][2] = ConName
	PARAMETERS MEP_ConInfo[ConID][3] = "0"


					! --- 2nd CONNECTION --- !

	ConID = 2
	ConName = `Подключение Холодной Воды`

	ConDVecX = 0
	ConDVecY = 1
	ConDVecZ = 0

	ConWVecX = -1
	ConWVecY = 0
	ConWVecZ = 0

	IF ConWidth_2 < 0.001 THEN
		ConWidth_2 = 0.001
		PARAMETERS ConWidth_2 = ConWidth_2
	ENDIF
	IF ConWidth_2 > zzyzx THEN
		ConWidth_2 = zzyzx
		PARAMETERS ConWidth_2 = ConWidth_2
	ENDIF
	VALUES "ConWidth_2" RANGE (0, zzyzx]
	PARAMETERS ConDepth_2 = ConWidth_2
	VALUES "ConLength_2" RANGE [0, ]

	PARAMETERS ConPosY_2 = 0

	! Default Position
	if (GLOB_MODPAR_NAME = "gs_tap_type" | GLOB_MODPAR_NAME = "gs_tap_type_m" | \
	GLOB_MODPAR_NAME = "tapGroup" | GLOB_MODPAR_NAME = "iTapGroup") then
		if bWallMountedTap then
			ConPosX_2 = -posTap - widthTap/2
		else
			ConPosX_2 = 0.07
		endif
		parameters ConPosX_2 = ConPosX_2
	endif

	if bWallmountedTap then
		pos1st = -posTap - widthTap + ConWidth_2/2
		pos2nd = -posTap - ConWidth_2/2

		pos3rd = +posTap + ConWidth_2/2
		pos4th = +posTap + widthTap - ConWidth_2/2

		! --- X Range

		values "ConPosX_2"	range [pos1st, pos2nd],
							range [pos3rd, pos4th]

		! --- Change Connection Side
		if GLOB_MODPAR_NAME = "ConPosX_1" | (GLOB_MODPAR_NAME = "" & sgn(ConPosX_1) = sgn(ConPosX_2)) then
			if ConPosX_1 < 0 & ConPosX_2 < 0 then
				ConPosX_2 = posTap + widthTap/2
				parameters 	ConPosX_2 = ConPosX_2
			endif
			if ConPosX_1 > 0 & ConPosX_2 > 0 then
				ConPosX_2 = -(posTap + widthTap/2)
				parameters 	ConPosX_2 = ConPosX_2
			endif
		endif

		ConPosZ_2 = tapHeight-h_top
		parameters	ConPosX_2 = ConPosX_2,
					ConPosZ_2 = ConPosZ_2
	else
		VALUES "ConPosX_2" RANGE [-A/2+ConWidth_2/2, A/2-ConWidth_2/2]
		VALUES "ConPosZ_2" RANGE [, -ConWidth_2/2]
	endif


	CALL "MEP_m_ConnectionsACL_4" PARAMETERS SetProgram = SetProgram,
		gs_Connections = gs_Connections,
		MEP_NumConnectionData = MEP_NumConnectionData,
		MEP_StrConnectionData = MEP_StrConnectionData,
		MEP_NumberConnections = MEP_NumberConnections,
		gs_AddConnections = gs_AddConnections,
		ConName = ConName,
		ConID = ConID,
		ConPosX = ConPosX_2+(a/1.120034*0.2675 + xTapPos)*bWallmountedTap,
		ConPosY = ConPosY_2,
		ConPosZ = ConPosZ_2+h_top+zTapPos*bWallmountedTap,
		ConDVecX = ConDVecX,
		ConDVecY = ConDVecY,
		ConDVecZ = ConDVecZ,
		ConWVecX = ConWVecX,
		ConWVecY = ConWVecY,
		ConWVecZ = ConWVecZ,

		ConNominalWidth = ConNominalWidth_2,
		ConNominalDepth = ConNominalDepth_2,
		ConWidth = ConWidth_2,
		ConDepth = ConDepth_2,
		ConLength = ConLength_2,
		ConWallThickness = ConWallThickness_2,
		ConConnectorWidth = ConConnectorWidth_2,
		ConConnectorDepth = ConConnectorDepth_2,
		ConConnectorWidth2 = ConConnectorWidth2_2,
		ConToolType = ConToolType_2,
		ConStatus = ConStatus_2,
		ConType_2 = ConType_2,
		ConConnectorType_2 = ConConnectorType_2,
		ConSystem_2 = ConSystem_2,
		shape_typ_to_validation = shape_typ_to_validation,
		MEP_enabled_geometry_mod = 1,
		gs_ui = 0

	PARAMETERS MEP_ConInfo[ConID][1] = STR(ConToolType_2, 1, 0)
	PARAMETERS MEP_ConInfo[ConID][2] = ConName
	PARAMETERS MEP_ConInfo[ConID][3] = "0"


					! --- 3rd CONNECTION --- !

	ConID = 3
	ConName = `Подключение Канализации #1`

	ConDVecX = 0
	ConDVecY = 0
	ConDVecZ = -1

	ConWVecX = -1
	ConWVecY = 0
	ConWVecZ = 0

	IF ConWidth_3 < 0.001 THEN
		ConWidth_3 = 0.001
		PARAMETERS ConWidth_3 = ConWidth_3
	ENDIF
	IF ConWidth_3 > MIN(A/6, B/3) THEN
		ConWidth_3 = MIN(A/6, B/3)
		PARAMETERS ConWidth_3 = ConWidth_3
	ENDIF
	VALUES "ConWidth_3" RANGE (0, MIN(A/6, B/3)]
	PARAMETERS ConDepth_3 = ConWidth_3
	VALUES "ConLength_3" RANGE [0, ]

	PARAMETERS ConPosZ_3 = -zzyzx


	CALL "MEP_m_ConnectionsACL_4" PARAMETERS SetProgram = SetProgram,
		gs_Connections = gs_Connections,
		MEP_NumConnectionData = MEP_NumConnectionData,
		MEP_StrConnectionData = MEP_StrConnectionData,
		MEP_NumberConnections = MEP_NumberConnections,
		gs_AddConnections = gs_AddConnections,
		ConName = ConName,
		ConID = ConID,
		ConPosX = ConPosX_3,
		ConPosY = ConPosY_3,
		ConPosZ = ConPosZ_3+h_top,
		ConDVecX = ConDVecX,
		ConDVecY = ConDVecY,
		ConDVecZ = ConDVecZ,
		ConWVecX = ConWVecX,
		ConWVecY = ConWVecY,
		ConWVecZ = ConWVecZ,

		ConNominalWidth = ConNominalWidth_3,
		ConNominalDepth = ConNominalDepth_3,
		ConWidth = ConWidth_3,
		ConDepth = ConDepth_3,
		ConLength = ConLength_3,
		ConWallThickness = ConWallThickness_3,
		ConConnectorWidth = ConConnectorWidth_3,
		ConConnectorDepth = ConConnectorDepth_3,
		ConConnectorWidth2 = ConConnectorWidth2_3,
		ConToolType = ConToolType_3,
		ConStatus = ConStatus_3,
		ConType_3 = ConType_3,
		ConConnectorType_3 = ConConnectorType_3,
		ConSystem_3 = ConSystem_3,
		shape_typ_to_validation = shape_typ_to_validation,
		MEP_enabled_geometry_mod = 1,
		gs_ui = 0

	PARAMETERS MEP_ConInfo[ConID][1] = STR(ConToolType_3, 1, 0)
	PARAMETERS MEP_ConInfo[ConID][2] = ConName
	PARAMETERS MEP_ConInfo[ConID][3] = "0"


					! --- 4th CONNECTION --- !

	ConID = 4
	ConName = `Подключение Канализации #2`

	ConDVecX = 0
	ConDVecY = 0
	ConDVecZ = -1

	ConWVecX = -1
	ConWVecY = 0
	ConWVecZ = 0

	IF ConWidth_4 < 0.001 THEN
		ConWidth_4 = 0.001
		PARAMETERS ConWidth_4 = ConWidth_4
	ENDIF
	IF ConWidth_4 > MIN(A/6, B/3) THEN
		ConWidth_4 = MIN(A/6, B/3)
		PARAMETERS ConWidth_4 = ConWidth_4
	ENDIF
	VALUES "ConWidth_4" RANGE (0, MIN(A/6, B/3)]
	PARAMETERS ConDepth_4 = ConWidth_4
	VALUES "ConLength_4" RANGE [0, ]

	PARAMETERS ConPosZ_4 = -zzyzx


	CALL "MEP_m_ConnectionsACL_4" PARAMETERS SetProgram = SetProgram,
		gs_Connections = gs_Connections,
		MEP_NumConnectionData = MEP_NumConnectionData,
		MEP_StrConnectionData = MEP_StrConnectionData,
		MEP_NumberConnections = MEP_NumberConnections,
		gs_AddConnections = gs_AddConnections,
		ConName = ConName,
		ConID = ConID,
		ConPosX = ConPosX_4,
		ConPosY = ConPosY_4,
		ConPosZ = ConPosZ_4+h_top,
		ConDVecX = ConDVecX,
		ConDVecY = ConDVecY,
		ConDVecZ = ConDVecZ,
		ConWVecX = ConWVecX,
		ConWVecY = ConWVecY,
		ConWVecZ = ConWVecZ,

		ConNominalWidth = ConNominalWidth_4,
		ConNominalDepth = ConNominalDepth_4,
		ConWidth = ConWidth_4,
		ConDepth = ConDepth_4,
		ConLength = ConLength_4,
		ConWallThickness = ConWallThickness_4,
		ConConnectorWidth = ConConnectorWidth_4,
		ConConnectorDepth = ConConnectorDepth_4,
		ConConnectorWidth2 = ConConnectorWidth2_4,
		ConToolType = ConToolType_4,
		ConStatus = ConStatus_4,
		ConType_4 = ConType_4,
		ConConnectorType_4 = ConConnectorType_4,
		ConSystem_4 = ConSystem_4,
		shape_typ_to_validation = shape_typ_to_validation,
		MEP_enabled_geometry_mod = 1,
		gs_ui = 0

	PARAMETERS MEP_ConInfo[ConID][1] = STR(ConToolType_4, 1, 0)
	PARAMETERS MEP_ConInfo[ConID][2] = ConName
	PARAMETERS MEP_ConInfo[ConID][3] = "0"


	if bWallMountedTap then
		if GLOB_MODPAR_NAME = "gs_tap_type" then
			ConStatus_5 = 1
			parameters ConStatus_5 = ConStatus_5
			ConStatus_6 = 1
			parameters ConStatus_6 = ConStatus_6

			ConPosX_5 = posTap + widthTap/2
			ConPosX_6 = -posTap - widthTap/2

			parameters 	ConPosX_5 = ConPosX_5,
						ConPosX_6 = ConPosX_6
		else
			ConStatus_5 = 0
			parameters ConStatus_5 = ConStatus_5
			ConStatus_6 = 0
			parameters ConStatus_6 = ConStatus_6

			hideparameter 	"ConStatus_5",
							"ConToolType_5",
							"ConSystem_5",
							"ConType_5",
							"ConConnectorType_5",
							"ConNominalWidth_5",
							"ConWidth_5",
							"ConWallThickness_5",
							"ConLength_5",
							"ConConnectorWidth_5",
							"ConConnectorWidth2_5",
							"ConStatus_6",
							"ConToolType_6",
							"ConSystem_6",
							"ConType_6",
							"ConConnectorType_6",
							"ConNominalWidth_6",
							"ConWidth_6",
							"ConWallThickness_6",
							"ConLength_6",
							"ConConnectorWidth_6",
							"ConConnectorWidth2_6"
		endif
	endif


					! --- 5th CONNECTION --- !

	ConID = 5
	ConName = `Подключение Горячей Воды 2`

	ConDVecX = 0
	ConDVecY = 1
	ConDVecZ = 0

	ConWVecX = -1
	ConWVecY = 0
	ConWVecZ = 0

	IF ConWidth_5 < 0.001 THEN
		ConWidth_5 = 0.001
		PARAMETERS ConWidth_5 = ConWidth_5
	ENDIF
	IF ConWidth_5 > zzyzx THEN
		ConWidth_5 = zzyzx
		PARAMETERS ConWidth_5 = ConWidth_5
	ENDIF
	VALUES "ConWidth_5" RANGE (0, zzyzx]
	PARAMETERS ConDepth_5 = ConWidth_5
	VALUES "ConLength_5" RANGE [0, ]

	PARAMETERS ConPosY_5 = 0

	! Default Position
	if (GLOB_MODPAR_NAME = "gs_tap_type" | GLOB_MODPAR_NAME = "gs_tap_type_m" | \
	GLOB_MODPAR_NAME = "tapGroup" | GLOB_MODPAR_NAME = "iTapGroup") then
		if bWallMountedTap then
			ConPosX_5 = posTap + widthTap/2
		else
			ConPosX_5 = -0.29
		endif
		parameters ConPosX_5 = ConPosX_5
	endif

	if bWallmountedTap then
		pos1st = -posTap - widthTap + ConWidth_5/2
		pos2nd = -posTap - ConWidth_5/2

		pos3rd = +posTap + ConWidth_5/2
		pos4th = +posTap + widthTap - ConWidth_5/2

		! --- X Range

		values "ConPosX_5"	range [pos1st, pos2nd],
							range [pos3rd, pos4th]


		! --- Change Connection Side
		if GLOB_MODPAR_NAME = "ConPosX_6" | (GLOB_MODPAR_NAME = "" & sgn(ConPosX_5) = sgn(ConPosX_6)) then
			if ConPosX_6 < 0 & ConPosX_5 < 0 then
				ConPosX_5 = posTap + widthTap/2
				parameters 	ConPosX_5 = ConPosX_5
			endif
			if ConPosX_6 > 0 & ConPosX_5 > 0 then
				ConPosX_5 = -(posTap + widthTap/2)
				parameters 	ConPosX_5 = ConPosX_5
			endif
		endif

		ConPosZ_5 = tapHeight-h_top
		parameters ConPosZ_5 = ConPosZ_5
	else
		VALUES "ConPosX_5" RANGE [-A/2+ConWidth_5/2, A/2-ConWidth_5/2]
		VALUES "ConPosZ_5" RANGE [, -ConWidth_5/2]
	endif


	CALL "MEP_m_ConnectionsACL_4" PARAMETERS SetProgram = SetProgram,
		gs_Connections = gs_Connections,
		MEP_NumConnectionData = MEP_NumConnectionData,
		MEP_StrConnectionData = MEP_StrConnectionData,
		MEP_NumberConnections = MEP_NumberConnections,
		gs_AddConnections = gs_AddConnections,
		ConName = ConName,
		ConID = ConID,
		ConPosX = ConPosX_5+(-a/1.120034*0.2675 + xTapPos)*bWallmountedTap,
		ConPosY = ConPosY_5,
		ConPosZ = ConPosZ_5+h_top+zTapPos*bWallmountedTap,
		ConDVecX = ConDVecX,
		ConDVecY = ConDVecY,
		ConDVecZ = ConDVecZ,
		ConWVecX = ConWVecX,
		ConWVecY = ConWVecY,
		ConWVecZ = ConWVecZ,

		ConNominalWidth = ConNominalWidth_5,
		ConNominalDepth = ConNominalDepth_5,
		ConWidth = ConWidth_5,
		ConDepth = ConDepth_5,
		ConLength = ConLength_5,
		ConWallThickness = ConWallThickness_5,
		ConConnectorWidth = ConConnectorWidth_5,
		ConConnectorDepth = ConConnectorDepth_5,
		ConConnectorWidth2 = ConConnectorWidth2_5,
		ConToolType = ConToolType_5,
		ConStatus = ConStatus_5,
		ConType_5 = ConType_5,
		ConConnectorType_5 = ConConnectorType_5,
		ConSystem_5 = ConSystem_5,
		ui_current_con = ui_current_con,
		shape_typ_to_validation = shape_typ_to_validation,
		MEP_enabled_geometry_mod = 1,
		gs_ui = 0

	PARAMETERS MEP_ConInfo[ConID][1] = STR(ConToolType_5, 1, 0)
	PARAMETERS MEP_ConInfo[ConID][2] = ConName
	PARAMETERS MEP_ConInfo[ConID][3] = "0"


					! --- 6th CONNECTION --- !

	ConID = 6
	ConName = `Подключение Холодной Воды 2`

	ConDVecX = 0
	ConDVecY = 1
	ConDVecZ = 0

	ConWVecX = -1
	ConWVecY = 0
	ConWVecZ = 0

	IF ConWidth_6 < 0.001 THEN
		ConWidth_6 = 0.001
		PARAMETERS ConWidth_6 = ConWidth_6
	ENDIF
	IF ConWidth_6 > zzyzx THEN
		ConWidth_6 = zzyzx
		PARAMETERS ConWidth_6 = ConWidth_6
	ENDIF
	VALUES "ConWidth_6" RANGE (0, zzyzx]
	PARAMETERS ConDepth_6 = ConWidth_6
	VALUES "ConLength_6" RANGE [0, ]

	PARAMETERS ConPosY_6 = 0

	! Default Position
	if (GLOB_MODPAR_NAME = "gs_tap_type" | GLOB_MODPAR_NAME = "gs_tap_type_m" | \
	GLOB_MODPAR_NAME = "tapGroup" | GLOB_MODPAR_NAME = "iTapGroup") then
		if bWallMountedTap then
			ConPosX_6 = -posTap - widthTap/2
		else
			ConPosX_6 = -0.14
		endif
		parameters ConPosX_6 = ConPosX_6
	endif

	if bWallmountedTap then
		pos1st = -posTap - widthTap + ConWidth_6/2
		pos2nd = -posTap - ConWidth_6/2

		pos3rd = +posTap + ConWidth_6/2
		pos4th = +posTap + widthTap - ConWidth_6/2

		! --- X Range

		values "ConPosX_6"	range [pos1st, pos2nd],
							range [pos3rd, pos4th]

		! --- Change Connection Side
		if GLOB_MODPAR_NAME = "ConPosX_5" | (GLOB_MODPAR_NAME = "" & sgn(ConPosX_5) = sgn(ConPosX_6)) then
			if ConPosX_6 < 0 & ConPosX_5 < 0 then
				ConPosX_6 = posTap + widthTap/2
				parameters 	ConPosX_6 = ConPosX_6
			endif
			if ConPosX_6 > 0 & ConPosX_5 > 0 then
				ConPosX_6 = -(posTap + widthTap/2)
				parameters 	ConPosX_6 = ConPosX_6
			endif
		endif

		ConPosZ_6 = tapHeight-h_top
		parameters ConPosZ_6 = ConPosZ_6
	else
		VALUES "ConPosX_6" RANGE [-A/2+ConWidth_6/2, A/2-ConWidth_6/2]
		VALUES "ConPosZ_6" RANGE [, -ConWidth_6/2]
	endif


	CALL "MEP_m_ConnectionsACL_4" PARAMETERS SetProgram = SetProgram,
		gs_Connections = gs_Connections,
		MEP_NumConnectionData = MEP_NumConnectionData,
		MEP_StrConnectionData = MEP_StrConnectionData,
		MEP_NumberConnections = MEP_NumberConnections,
		gs_AddConnections = gs_AddConnections,
		ConName = ConName,
		ConID = ConID,
		ConPosX = ConPosX_6+(-a/1.120034*0.2675 + xTapPos)*bWallmountedTap,
		ConPosY = ConPosY_6,
		ConPosZ = ConPosZ_6+h_top+zTapPos*bWallmountedTap,
		ConDVecX = ConDVecX,
		ConDVecY = ConDVecY,
		ConDVecZ = ConDVecZ,
		ConWVecX = ConWVecX,
		ConWVecY = ConWVecY,
		ConWVecZ = ConWVecZ,

		ConNominalWidth = ConNominalWidth_6,
		ConNominalDepth = ConNominalDepth_6,
		ConWidth = ConWidth_6,
		ConDepth = ConDepth_6,
		ConLength = ConLength_6,
		ConWallThickness = ConWallThickness_6,
		ConConnectorWidth = ConConnectorWidth_6,
		ConConnectorDepth = ConConnectorDepth_6,
		ConConnectorWidth2 = ConConnectorWidth2_6,
		ConToolType = ConToolType_6,
		ConStatus = ConStatus_6,
		ConType_6 = ConType_6,
		ConConnectorType_6 = ConConnectorType_6,
		ConSystem_6 = ConSystem_6,
		shape_typ_to_validation = shape_typ_to_validation,
		MEP_enabled_geometry_mod = 1,
		gs_ui = 0

	PARAMETERS MEP_ConInfo[ConID][1] = STR(ConToolType_6, 1, 0)
	PARAMETERS MEP_ConInfo[ConID][2] = ConName
	PARAMETERS MEP_ConInfo[ConID][3] = "0"

	IF gs_ui_current_page = 4 THEN
		ac_mep_connectionpage_active = 1
	ELSE
		ac_mep_connectionpage_active = 0
	ENDIF
	PARAMETERS ac_mep_connectionpage_active = ac_mep_connectionpage_active

	IF SetProgram THEN
		SetProgram = 0
		PARAMETERS SetProgram = SetProgram
	ENDIF
ELSE
	HIDEPARAMETER "gs_connection", "gs_con_mat", "useSysMat"

	ac_mep_connectionpage_active = 0
	PARAMETERS ac_mep_connectionpage_active = ac_mep_connectionpage_active
ENDIF


call "ui_plumbingfixtures" parameters iObjectType 		= 11,
								gs_ui_current_page = gs_ui_current_page

! =============================================================================
! Onorm list Settings
! =============================================================================
if LibraryLangCode = "AUT" or LibraryLangCode = "CHE" or LibraryLangCode = "GER" then
	call "Onorm_Plumbing" parameters all
else
	hideparameter "gs_onorm_Title"
endif

END

parameters ac_bottomlevel = h_top - zzyzx
parameters ac_toplevel = h_top
