
IF gs_detlevel_3D_m = -1 THEN
	gs_detlevel_3D_m = 2	! Detailed
	IF gs_detlevel_3D = `Откл.` THEN gs_detlevel_3D_m = 0
	IF gs_detlevel_3D = `Простой` THEN gs_detlevel_3D_m = 1
ENDIF

IF gs_detlevel_3D_m = 0 THEN END

IF gs_shadow=0 THEN SHADOW OFF
IF gs_shadow=1 THEN SHADOW ON


! --- start of modifying to Shaft

				! --- CONNECTIONS --- !

PEN gs_cont_pen
IF gs_detlevel_3D_m = 1 THEN RESOL 8
IF gs_detlevel_3D_m = 2 THEN RESOL 24

hotspot 0,0,ZZYZX
hotspot 0,0,0
hotspot -A/2,0,0
hotspot A/2,0,0
hotspot 0,-A/2,0
hotspot 0,A/2,0


IF bShowMEP THEN
	IF useSysMat THEN
		mat1	= sMat
		mat2	= sMat
		mat3	= sMat
		gs_con_mat	= sMat
	ENDIF

	CALL "MEP_m_ConnectionsACL_4" PARAMETERS SetProgram = SetProgram,
		ui_current_con = ui_current_con,
		MEP_NumberConnections = MEP_NumberConnections,
		MEP_NumConnectionData = gs_Connections,
		gs_AddConnections = gs_AddConnections,
		cShow3D = 1,
		gs_ConMat = gs_con_mat,
		MEP_InsShow = 0,
		MEP_cline_show_3D = 0,
		gs_cont_pen = gs_cont_pen,
		ConPosX_1=ConPosX_1, ConPosY_1=ConPosY_1, ConPosZ_1=ConPosZ_1, ConLength_1=ConLength_1, ConEdit_1 = 1,
		ConPosX_2=ConPosX_2, ConPosY_2=ConPosY_2, ConPosZ_2=ConPosZ_2, ConLength_2=ConLength_2, ConEdit_2 = 1
ENDIF

! --- end of modifying to Shaft


if gs_detlevel_3D_m = 1 then gs_resol=8
pen gs_cont_pen
if zzyzx<=0.4 then zzyzx=0.4


mulx a/0.6
muly a/0.6
if gs_detlevel_3D_m = 2 then
		material mat3
		addy -0.6/2-0.005
		addx -0.025
		addz 0.4
		block 0.05,0.005,0.02
		del 3

	material mat1
	rotx 90
	addy  0.1
	addz (0.6/2-0.1)*0.8
	addx -0.05
		muly a/0.6
		resol gs_resol
		cylind 0.015,0.03
		del 1
		addx 0.1
		muly a/0.6
		cylind 0.015,0.03
		del 1
	del 5
ENDIF

rotx 90
addz (0.6/2-0.1)*0.8
material mat2
cutplane
del 2
resol 2*gs_resol
cone 0.2,0.6/2-0.1-0.01,0.6/2-0.1,90,90
cutend
addz 0.2
cone 0.1,0.6/2-0.01,0.6/2,90,90
addz 0.1
material mat1
cylind zzyzx-0.40,0.6/2
addz zzyzx-0.40
material mat2
cone 0.1,0.6/2,0.6/2-0.01,90,90
del 4
