!-----------3d---------------------
if show_el < EPS and GLOB_VIEW_TYPE<>2 then end
if GLOB_VIEW_TYPE=2 then gs_detlevel_3D_m = gs_detlevel_2D_m
IF gs_detlevel_3D_m < EPS THEN END
if GLOB_PREVIEW_MODE = 0 and GLOB_FEEDBACK_MODE = 0 then CALL "MEP_m_RequestSystemGlobals" PARAMETERS ALL one_ConID=0 returned_parameters gs_cont_pen, sMat, gs_InsMat, MEP_cline_pen, show_el
MATERIAL sMat
PEN gs_cont_pen
RESOL res

! Fire Hose Cabinet
add a/2, b/2,0
unID = 1


PEN gs_cont_pen

IF gs_shadow=0 THEN SHADOW OFF

IF GLOB_CONTEXT>20 and GLOB_CONTEXT<40 THEN gs_detlevel_3D_m=1

IF GLOB_CONTEXT>40 THEN
	ROTX 90
	prism_ 5, b,
		-a/2+2*th, 0, 15,
		 a/2-2*th, 0, 15,
		 a/2-2*th, zzyzx, 15,
		-a/2+2*th, zzyzx, 15,
		-a/2+2*th, 0, -1
	del 1
	END
ENDIF

IF gs_detlevel_3D_m=1 THEN	RESOL 8
IF gs_detlevel_3D_m=2 THEN	RESOL gs_resol

hotspot a/2, -b/2, 0, unID, zzyzx, 1+128: unID=unID+1
hotspot a/2, -b/2, -1, unID,  zzyzx, 3: unID=unID+1
hotspot a/2, -b/2, zzyzx, unID,  zzyzx, 2: unID=unID+1

hotspot a/2,  b/2, 0, unID, zzyzx, 1+128: unID=unID+1
hotspot a/2,  b/2, -1, unID,  zzyzx, 3: unID=unID+1
hotspot a/2,  b/2, zzyzx, unID,  zzyzx, 2: unID=unID+1

hotspot -a/2, -b/2, 0, unID, zzyzx, 1+128: unID=unID+1
hotspot -a/2, -b/2, -1, unID,  zzyzx, 3: unID=unID+1
hotspot -a/2, -b/2, zzyzx, unID,  zzyzx, 2: unID=unID+1

hotspot -a/2,  b/2, 0, unID, zzyzx, 1+128: unID=unID+1
hotspot -a/2,  b/2, -1, unID,  zzyzx, 3: unID=unID+1
hotspot -a/2,  b/2, zzyzx, unID,  zzyzx, 2: unID=unID+1

hotspot -a/2, -b/2, 0, unID: unID=unID+1
hotspot -a/2,  b/2, 0, unID: unID=unID+1
hotspot a/2, -b/2, 0, unID: unID=unID+1
hotspot a/2,  b/2, 0, unID: unID=unID+1


ROTX 90

IF iFireCabPlacing = 1 THEN
MATERIAL cab_mat

ADDZ b/2-2*th
PRISM_ 10, th,
	-a/2, 0, 15,
	 a/2, 0, 15,
	 a/2, zzyzx, 15,
	-a/2, zzyzx, 15,
	-a/2, 0, -1,

	-a/2+3*th, 3*th, 14,
	 a/2-3*th, 3*th, 14,
	 a/2-3*th, zzyzx-3*th, 14,
	-a/2+3*th, zzyzx-3*th, 14,
	-a/2+3*th, 3*th, -1
DEL 1

ADDZ b/2-th
PRISM_ 10, th,
	-a/2+2*th, 2*th, 15,
	 a/2-2*th, 2*th, 15,
	 a/2-2*th, zzyzx-2*th, 15,
	-a/2+2*th, zzyzx-2*th, 15,
	-a/2+2*th, 2*th, -1,

	-a/2+4*th, 4*th, 15,
	 a/2-4*th, 4*th, 15,
	 a/2-4*th, zzyzx-4*th, 15,
	-a/2+4*th, zzyzx-4*th, 15,
	-a/2+4*th, 4*th, -1
DEL 1

ADDZ -b/2+th
PRISM_ 10, b-3*th,
	-a/2+2*th, 2*th, 14,
	 a/2-2*th, 2*th, 14,
	 a/2-2*th, zzyzx-2*th, 14,
	-a/2+2*th, zzyzx-2*th, 14,
	-a/2+2*th, 2*th, -1,

	-a/2+3*th, 3*th, 11,
	 a/2-3*th, 3*th, 11,
	 a/2-3*th, zzyzx-3*th, 11,
	-a/2+3*th, zzyzx-3*th, 11,
	-a/2+3*th, 3*th, -1
DEL 1

ADDZ -b/2
PRISM_ 5, th,
	-a/2+2*th, 2*th, 11,
	 a/2-2*th, 2*th, 11,
	 a/2-2*th, zzyzx-2*th, 11,
	-a/2+2*th, zzyzx-2*th, 11,
	-a/2+2*th, 2*th, -1
DEL 1

MATERIAL glass_mat
ADDZ b/2-3*th/4
PRISM_ 5, th/2,
	-a/2+4*th, 4*th, 13,
	 a/2-4*th, 4*th, 13,
	 a/2-4*th, zzyzx-4*th, 13,
	-a/2+4*th, zzyzx-4*th, 13,
	-a/2+4*th, 4*th, -1
DEL 1

IF gs_detlevel_3D_m=2 THEN
	MATERIAL met_mat
	ADD a/2-3*th, zzyzx/2, b/2
	CYLIND 0.002, th/2
	DEL 1

	FOR HI=1 TO 2
	ADD -a/2+2*th-0.003, 4*th, b/2-th+0.003
	ROTX -90
	CYLIND 2*th, 0.003
	DEL 2
	ADDY zzyzx-10*th
	NEXT HI
	DEL 2
ENDIF
ENDIF


IF iFireCabPlacing = 2 THEN
MATERIAL cab_mat
th=0.02
PRISM_ 10, b/2-th,
	-a/2, 0, 15,
	 a/2, 0, 15,
	 a/2, zzyzx, 15,
	-a/2, zzyzx, 15,
	-a/2, 0, -1,

	-a/2+3*th, 3*th, 14,
	 a/2-3*th, 3*th, 14,
	 a/2-3*th, zzyzx-3*th, 14,
	-a/2+3*th, zzyzx-3*th, 14,
	-a/2+3*th, 3*th, -1


ADDZ b/2-th
PRISM_ 10, th,
	-a/2+2*th, 2*th, 15,
	 a/2-2*th, 2*th, 15,
	 a/2-2*th, zzyzx-2*th, 15,
	-a/2+2*th, zzyzx-2*th, 15,
	-a/2+2*th, 2*th, -1,

	-a/2+4*th, 4*th, 15,
	 a/2-4*th, 4*th, 15,
	 a/2-4*th, zzyzx-4*th, 15,
	-a/2+4*th, zzyzx-4*th, 15,
	-a/2+4*th, 4*th, -1
DEL 1

ADDZ -b/2+th
PRISM_ 10, b/2-th,
	-a/2+2*th, 2*th, 14,
	 a/2-2*th, 2*th, 14,
	 a/2-2*th, zzyzx-2*th, 14,
	-a/2+2*th, zzyzx-2*th, 14,
	-a/2+2*th, 2*th, -1,

	-a/2+3*th, 3*th, 11,
	 a/2-3*th, 3*th, 11,
	 a/2-3*th, zzyzx-3*th, 11,
	-a/2+3*th, zzyzx-3*th, 11,
	-a/2+3*th, 3*th, -1
DEL 1

ADDZ -b/2
PRISM_ 5, th,
	-a/2+2*th, 2*th, 11,
	 a/2-2*th, 2*th, 11,
	 a/2-2*th, zzyzx-2*th, 11,
	-a/2+2*th, zzyzx-2*th, 11,
	-a/2+2*th, 2*th, -1
DEL 1

MATERIAL glass_mat
ADDZ b/2-3*th/4
PRISM_ 5, th/2,
	-a/2+4*th, 4*th, 13,
	 a/2-4*th, 4*th, 13,
	 a/2-4*th, zzyzx-4*th, 13,
	-a/2+4*th, zzyzx-4*th, 13,
	-a/2+4*th, 4*th, -1
DEL 1

IF gs_detlevel_3D_m=2 THEN
	MATERIAL met_mat
	ADD a/2-3*th, zzyzx/2, b/2
	CYLIND 0.002, th/2
	DEL 1

	FOR HI=1 TO 2
	ADD -a/2+2*th-0.003, 4*th, b/2-th+0.003
	ROTX -90
	CYLIND 2*th, 0.003
	DEL 2
	ADDY zzyzx-10*th
	NEXT HI
	DEL 2
ENDIF
ENDIF

IF iFireCabPlacing = 3 THEN
MATERIAL cab_mat
th=0.02
ADDZ b/2-2*th
PRISM_ 10, th,
	-a/2, 0, 14,
	 a/2, 0, 14,
	 a/2, zzyzx, 14,
	-a/2, zzyzx, 14,
	-a/2, 0, -1,

	-a/2+3*th, 3*th, 15,
	 a/2-3*th, 3*th, 15,
	 a/2-3*th, zzyzx-3*th, 15,
	-a/2+3*th, zzyzx-3*th, 15,
	-a/2+3*th, 3*th, -1
DEL 1

ADDZ b/2-th
PRISM_ 10, th,
	-a/2+2*th, 2*th, 15,
	 a/2-2*th, 2*th, 15,
	 a/2-2*th, zzyzx-2*th, 15,
	-a/2+2*th, zzyzx-2*th, 15,
	-a/2+2*th, 2*th, -1,

	-a/2+4*th, 4*th, 15,
	 a/2-4*th, 4*th, 15,
	 a/2-4*th, zzyzx-4*th, 15,
	-a/2+4*th, zzyzx-4*th, 15,
	-a/2+4*th, 4*th, -1
DEL 1

ADDZ -b/2+th
PRISM_ 10, b-3*th,
	-a/2, 0, 10,
	 a/2, 0, 10,
	 a/2, zzyzx, 10,
	-a/2, zzyzx, 10,
	-a/2, 0, -1,

	-a/2+th, th, 15,
	 a/2-th, th, 15,
	 a/2-th, zzyzx-th, 15,
	-a/2+th, zzyzx-th, 15,
	-a/2+th, th, -1
DEL 1

ADDZ -b/2
PRISM_ 5, th,
	-a/2, 0, 11,
	 a/2, 0, 11,
	 a/2, zzyzx, 11,
	-a/2, zzyzx, 11,
	-a/2, 0, -1
DEL 1

MATERIAL glass_mat
ADDZ b/2-3*th/4
PRISM_ 5, th/2,
	-a/2+4*th, 4*th, 13,
	 a/2-4*th, 4*th, 13,
	 a/2-4*th, zzyzx-4*th, 13,
	-a/2+4*th, zzyzx-4*th, 13,
	-a/2+4*th, 4*th, -1
DEL 1

IF gs_detlevel_3D_m=2 THEN
	MATERIAL met_mat
	ADD a/2-3*th, zzyzx/2, b/2
	CYLIND 0.002, th/2
	DEL 1

	FOR HI=1 TO 2
	ADD -a/2+2*th-0.003, 4*th, b/2-th+0.003
	ROTX -90
	CYLIND 2*th, 0.003
	DEL 2
	ADDY zzyzx-10*th
	NEXT HI
	DEL 2
ENDIF
ENDIF

DEL 1

!!!! SHOW TOOLS in CABINET
IF show_tool=1 then
	IF iFireCabStyle = 1 OR iFireCabStyle = 2 OR iFireCabStyle = 5 OR iFireCabStyle = 6 THEN
		ADD -a/2+swa/2+3*th, b/2-0.05-th, zzyzx-swz-4*th

		CALL "m_Swing Rack Semiautomatic" PARAMETERS a=swa, b=0.1, zzyzx=swz,
			hotspot_3D=0,
			gs_detlevel_3D_m=gs_detlevel_3D_m, gs_resol=gs_resol, gs_shadow=gs_shadow,
			rack_mat=rack_mat, hose_mat=hose_mat, squirt_mat=squirt_mat
		DEL 1
	ENDIF

	IF iFireCabStyle = 1 OR iFireCabStyle = 3 OR iFireCabStyle = 4 OR iFireCabStyle = 5 THEN
		IF iFireCabStyle <> 4 THEN ADD a/2-3*th-0.15, b/2-th-0.105, 4*th
		IF iFireCabStyle = 4 THEN ADD 0, b/2-th-0.105, 4*th
		CALL "m_Pressurized Extinguisher" PARAMETERS	a					= 0.28,
														b					= 0.2,
														zzyzx				= 0.635,
														gs_detlevel_3D_m	= gs_detlevel_3D_m,
														gs_resol			= gs_resol,
														gs_shadow			= gs_shadow,
														cyl_mat				= rack_mat,
														pipe_mat			= squirt_mat,
														startUnID			= unID
		DEL 1
	ENDIF

	IF iFireCabStyle = 3 THEN
		ADD -a/2+3*th+0.15, b/2-th-0.105, 4*th
		CALL "m_Pressurized Extinguisher" PARAMETERS	a					= 0.28,
														b					= 0.2,
														zzyzx				= 0.635,
														gs_detlevel_3D_m	= gs_detlevel_3D_m,
														gs_resol			= gs_resol,
														gs_shadow			= gs_shadow,
														cyl_mat				= rack_mat,
														pipe_mat			= squirt_mat,
														startUnID			= unID
		DEL 1
	ENDIF


!! Lower connection !!

IF iFireCabStyle = 5 OR iFireCabStyle = 6 THEN

MATERIAL rack_mat
ADD  -a/2+3*th, b/2-th-0.06, 4*th+0.05	!a/2+0.045-0.05, 0.05, 0
ROTX -90

ADDZ 0!zzyzx-0.05
RESOL gs_resol*2
REVOLVE 11, 360, 1+2+4+8+16+32,
	0.21, 0.005, 0,
	0.16, 0.005, 0,
	0.16, 0.027, 0,
	0.15, 0.027, 0,
	0.15, 0.025, 0,
	0.1499, 0.025, 1,
   -1, 0, 800,
	0.09, 0.05, 1000,
	0.08, 0.05, 0,
	0.08, 0.04, 0,
	0.02, 0.04, 0

RESOL gs_resol
REVOLVE 4, 360, 1+2+4+8+16+32,
	0.21, 0.045, 1,
	0, 1, 800,
	0.2, 0.045, 1001,
	0.21, 0.045, 1001

ROTY 90
CUTPOLYA 4, 1, 0,
	 0.005, 0, 15,
	 0, 1, 800,
	-0.005, 0, 1015,
	 0.005, 0, 1015
DEL 1



FOR HI=1 TO gs_resol

IF gs_resol/4-INT(gs_resol/4)=0 THEN rk=1
ROTX 180/gs_resol*rk
ADD 0.205, 0, 0.045*COS(180/gs_resol)
ROTX 90
MULY COS(180/gs_resol)
CUTPOLYA 4, 1, 0,
	 0.005, 0, 79,
	 0, 1, 800,
	-0.005, 0, 1079,
	 0.005, 0, 1079
DEL 4

ROTX 360/gs_resol
NEXT HI
DEL gs_resol

FOR HJ=1 TO 2
	ROTX 45
	ADD 0.205-0.004, -0.0015, -0.045*COS(180/gs_resol)
	BLOCK 0.008, 0.003, 0.09*COS(180/gs_resol)
	DEL 2
ROTX 90
NEXT HJ
DEL 2

FOR HI=1 TO gs_resol
CUTEND
NEXT HI


CUTEND

RESOL 6
REVOLVE 2, 360, 1+2+4+8+16+32+64,
	0.02, 0.05, 0,
	0, 0.05, 0
DEL 1

FOR HJ=1 TO 2
RESOL gs_resol*2
ADDZ 0!zzyzx-0.05
ROTY 90
	CUTPOLYA 4, 1, 0,
		0.04, 0, 79,
		0, 1, 800,
	   -0.04, 0, 1079,
		0.04, 0, 1079
DEL 2

ADD 0.05, 0, -0.06
	CYLIND 0.06, 0.03
DEL 1

CUTEND
MULZ -1
NEXT HJ
DEL 2

MATERIAL squirt_mat

ADD 0.05, 0, -0.09
CYLIND 0.03, 0.05
DEL 1


DEL 2

ENDIF
!! End of lower connection !!
ENDIF

END
