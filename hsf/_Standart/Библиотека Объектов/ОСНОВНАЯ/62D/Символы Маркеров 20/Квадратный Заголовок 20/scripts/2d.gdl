
if gs_debug then
	pen 10

	crossSize = 0.01
	line2 -crossSize,-crossSize, crossSize, crossSize	! Origo
	line2  crossSize,-crossSize,-crossSize, crossSize
endif


if bPositioningPreview then
	if gs_position_side_int = 1 | gs_position_side_int = 4 then		! Top or Bottom
		previewRatio = titleRectX / savedTitleRectX
	else
		previewRatio = titleRectY / savedTitleRectY
	endif
endif

hID = 1		! Hotspot ID


if AC_UseUniformTextFormat then
	gs_drawing_name_font_type		= AC_TextFont
	gs_drawing_name_font_size		= AC_TextSize
	gs_drawing_name_font_pen		= AC_TextPen
	drawingNameFontStyle			= AC_TextStyle

	gs_backref_font_type			= AC_TextFont
	gs_backref_font_size			= AC_TextSize
	gs_backref_font_pen				= AC_TextPen
	backrefFontStyle				= AC_TextStyle

	gs_drawing_scale_font_type		= AC_TextFont
	gs_drawing_scale_font_size		= AC_TextSize
	gs_drawing_scale_font_pen		= AC_TextPen
	drawingScaleFontStyle			= AC_TextStyle

	gs_drawing_number_font_type		= AC_TextFont
	gs_drawing_number_font_size		= AC_TextSize
	gs_drawing_number_font_pen		= AC_TextPen
	drawingNumberFontStyle			= AC_TextStyle

	gs_source_filename_font_type	= AC_TextFont
	gs_source_filename_font_size	= AC_TextSize
	gs_source_filename_font_pen		= AC_TextPen
	sourceFileNameFontStyle			= AC_TextStyle

	gs_drawing_magn_font_type		= AC_TextFont
	gs_drawing_magn_font_size		= AC_TextSize
	gs_drawing_magn_font_pen		= AC_TextPen
	drawingMagnFontStyle			= AC_TextStyle

	gs_project_filename_font_type	= AC_TextFont
	gs_project_filename_font_size	= AC_TextSize
	gs_project_filename_font_pen	= AC_TextPen
	projectFileNameFontStyle		= AC_TextStyle

	gs_layout_name_font_type		= AC_TextFont
	gs_layout_name_font_size		= AC_TextSize
	gs_layout_name_font_pen			= AC_TextPen
	layoutNameFontStyle				= AC_TextStyle

	gs_layout_number_font_type		= AC_TextFont
	gs_layout_number_font_size		= AC_TextSize
	gs_layout_number_font_pen		= AC_TextPen
	layoutNumberFontStyle			= AC_TextStyle
else
	drawingNameFontStyle		= gs_drawing_name_font_bold + 2 * gs_drawing_name_font_italic + 4 * gs_drawing_name_font_under
	drawingNumberFontStyle		= gs_drawing_number_font_bold + 2 * gs_drawing_number_font_italic + 4 * gs_drawing_number_font_under
	drawingScaleFontStyle		= gs_drawing_scale_font_bold + 2 * gs_drawing_scale_font_italic + 4 * gs_drawing_scale_font_under
	sourceFileNameFontStyle		= gs_source_filename_font_bold + 2 * gs_source_filename_font_italic + 4 * gs_source_filename_font_under
	drawingMagnFontStyle		= gs_drawing_magn_font_bold + 2 * gs_drawing_magn_font_italic + 4 * gs_drawing_magn_font_under
	projectFileNameFontStyle	= gs_project_filename_font_bold + 2 * gs_project_filename_font_italic + 4 * gs_project_filename_font_under
	layoutNameFontStyle			= gs_layout_name_font_bold + 2 * gs_layout_name_font_italic + 4 * gs_layout_name_font_under
	layoutNumberFontStyle		= gs_layout_number_font_bold + 2 * gs_layout_number_font_italic + 4 * gs_layout_number_font_under
	backrefFontStyle			= gs_backref_font_bold + 2 * gs_backref_font_italic + 4 * gs_backref_font_under
endif

bInside = (AC_titleFitMode = 2 | AC_titleFitMode = 3)	! Layout or Cell; Position of the title inside or outside the drawing

anchorDrawingNumber			= 1
anchorLayoutNumber			= 1
anchorDrawingName			= 1
anchorDrawingScale			= 7
anchorSourceFileName		= 7
anchorDrawingMagnification	= 7
anchorProjectFileName		= 7
anchorLayoutName			= 7
anchorBackRef				= 7

define style "styleDrawingName" 	gs_drawing_name_font_type,
									gs_drawing_name_font_size,
									anchorDrawingName,
									drawingNameFontStyle

define style "styleBackref" 		gs_backref_font_type,
									gs_backref_font_size,
									anchorBackRef,
									backrefFontStyle

define style "styleDrawingScale"	gs_drawing_scale_font_type,
									gs_drawing_scale_font_size,
									anchorDrawingScale,
									drawingScaleFontStyle

define style "styleDrawingNumber"	gs_drawing_number_font_type,
									gs_drawing_number_font_size,
									anchorDrawingNumber,
									drawingNumberFontStyle

define style "styleSourceFileName" 	gs_source_filename_font_type,
									gs_source_filename_font_size,
									anchorSourceFileName,
									sourceFileNameFontStyle

define style "styleDrawingMagnification" 	gs_drawing_magn_font_type,
											gs_drawing_magn_font_size,
											anchorDrawingMagnification,
											drawingMagnFontStyle

define style "styleProjectFilename" gs_project_filename_font_type,
									gs_project_filename_font_size,
									anchorProjectFileName,
									projectFileNameFontStyle

define style "styleLayoutName" 		gs_layout_name_font_type,
									gs_layout_name_font_size,
									anchorLayoutName,
									layoutNameFontStyle

define style "styleLayoutNumber"	gs_layout_number_font_type,
									gs_layout_number_font_size,
									anchorLayoutNumber,
									layoutNumberFontStyle



if gs_debug & GLOB_CONTEXT <> 5 then
	pen 10
	circle2 AC_LayoutRect[1], AC_LayoutRect[2], 0.01
	circle2 AC_LayoutRect[3], AC_LayoutRect[4], 0.01

	pen 7
	circle2 AC_GridRect[1], AC_GridRect[2], 0.01
	circle2 AC_GridRect[3], AC_GridRect[4], 0.01

	pen 4
	circle2 AC_DrawingRect[1], AC_DrawingRect[2], 0.01
	circle2 AC_DrawingRect[3], AC_DrawingRect[4], 0.01
endif


! ==============================================================================
! Input Parameter Definitions
! ==============================================================================

n = request ("HomeDB_info", "", n, AC_LayoutNumber, AC_LayoutName, n)
n = request ("Name_of_plan", "", n, AC_ProjectName, AC_ProjectPath)

if gs_drawing_name_custom then
	drawingName = gs_drawing_name_custom_text
else
	if AC_SourceFileName <> "" & gs_drawing_name_extension then
		drawingName = AC_SourceFileName
	else
	drawingName = AC_DrawingName
endif
endif

if gs_drawing_scale_original then
	drawingScale			= gs_drawing_scale_prefix + AC_OriginalDrawingScale
else
	drawingScale			= gs_drawing_scale_prefix + AC_DrawingScale
endif
drawingNumber			= gs_drawing_number_prefix + AC_DrawingNumber
drawingMagnification	= STR(AC_Magnification, 1,0) + gs_drawing_magn_suffix
layoutNumber			= gs_layout_number_prefix + AC_LayoutNumber


! ==============================================================================
! Draw Title
! ==============================================================================

if gs_debug then

	add2 titlePosX, titlePosY
	rot2 titleAlpha

	if not(AC_ManualPosition) then
		rect2 0,0, titleRectX, titleRectY	! Selected Drawing

		hotspot2 0,0
		hotspot2 0, titleRectY
		hotspot2 titleRectX, 0
		hotspot2 titleRectX, titleRectY
	endif

	del 2
endif


! ==============================================================================
! Precalculations
! ==============================================================================

drawingNameFontH	 = gs_show_drawing_name *			(1.6 * PAPER_TO_MODEL * gs_drawing_name_font_size)
drawingScaleFontH	 = gs_show_drawing_scale *			(1.6 * PAPER_TO_MODEL * gs_drawing_scale_font_size)
drawingNumberFontH	 = gs_show_drawing_number *			(1.6 * PAPER_TO_MODEL * gs_drawing_number_font_size)
sourceFileNameFontH	 = gs_show_source_filename *		(1.6 * PAPER_TO_MODEL * gs_source_filename_font_size)
drawingMagnFontH	 = gs_show_drawing_magnification *	(1.6 * PAPER_TO_MODEL * gs_drawing_magn_font_size)
projectFileNameFontH = gs_show_project_filename *		(1.6 * PAPER_TO_MODEL * gs_project_filename_font_size)
layoutNameFontH		 = gs_show_layout_name *			(1.6 * PAPER_TO_MODEL * gs_layout_name_font_size)
layoutNumberFontH	 = gs_show_layout_number *			(1.6 * PAPER_TO_MODEL * gs_layout_number_font_size)
backrefFontH		 = AC_ShowDrawingReferences *		(1.6 * PAPER_TO_MODEL * gs_backref_font_size)

if _bCustomPosition then
	titleWidth = gs_title_width
else
	if gs_position_side_int = 1 | gs_position_side_int = 4 then		! Top or Bottom
		titleWidth = titleRectX
	else
		titleWidth = titleRectY
	endif
endif

titleHeight = max(drawingNameFontH, drawingScaleFontH, drawingNumberFontH, layoutNumberFontH)


! ==============================================================================
! Positioning
! ==============================================================================

if SYMB_MIRRORED & not(bPositioningPreview) then mul2 -1, 1
if GLOB_CONTEXT = 5 then rot2 -SYMB_ROTANGLE

add2 titlePosX, titlePosY
rot2 titleAlpha

if gs_position_side_int = 1 then		! Top
	if bInside then
		add2 0,titleRectY - gs_offset
	else
		add2 0,titleRectY + titleHeight + gs_offset
	endif
endif
if gs_position_side_int = 2 then		! Left
	if bInside then
		add2 gs_offset, 0
	else
		if bSpecPos then
			add2 -gs_offset - titleWidth, 0
		else
			add2 -gs_offset - titleHeight, 0
		endif
	endif
	rot2 (gs_title_rotate_with_position) * 90
endif
if gs_position_side_int = 3 then		! Right
	if bInside then
		add2 titleRectX - titleHeight - gs_offset, 0
	else
		add2 titleRectX + gs_offset, 0
	endif
	rot2 (gs_title_rotate_with_position) * 90
endif
if gs_position_side_int = 4 then		! Bottom
	if bInside then
		add2 0, titleHeight + gs_offset
	else
		add2 0, -gs_offset
	endif
endif

if AC_titleFitMode = 1 & not(gs_title_rotate_with_position) then
	if gs_title_rotate_with_drawing then
		rot2 -gs_title_rotation_angle
	else
		rot2 -titleAlpha - SYMB_ROTANGLE - gs_title_rotation_angle
	endif
endif

if _bCustomPosition then
	if gs_position_alignment_int = 1 then	! Left
		if bSpecPos then
			add2 0, titleHeight
		else
			add2 0, 0
		endif

		hotspot2  0,				-titleHeight,	hID,	gs_title_width, 1 + (AC_ManualPosition + 1) * 128
		hotspot2 -1,				-titleHeight,	hID+1,	gs_title_width, 3
		hotspot2  gs_title_width,	-titleHeight,	hID+2,	gs_title_width, 2
		hID = hID + 3

		add2 0, 0
	endif
	if gs_position_alignment_int = 2 then	! Center
		if bSpecPos then
			add2 -(titleRectY - gs_title_width) / 2, (titleRectY + titleHeight) / 2
		else
			add2 0, 0
		endif

		if gs_position_side_int = 1 | gs_position_side_int = 4 then	! Top or Bottom
			hotspot2 titleRectX / 2,						-titleHeight,	hID,	gs_title_half_width, 1 + 128
			hotspot2 titleRectX / 2 - 1,					-titleHeight,	hID+1,	gs_title_half_width, 3
			hotspot2 titleRectX / 2 + gs_title_half_width,	-titleHeight,	hID+2,	gs_title_half_width, 2
			hID = hID + 3

			hotspot2 titleRectX / 2,						-titleHeight,	hID,	gs_title_half_width, 1 + 128
			hotspot2 titleRectX / 2 + 1,					-titleHeight,	hID+1,	gs_title_half_width, 3
			hotspot2 titleRectX / 2 - gs_title_half_width,	-titleHeight,	hID+2,	gs_title_half_width, 2
			hID = hID + 3

			add2 (titleRectX - gs_title_width) / 2, 0
		else
			hotspot2 titleRectY / 2,						-titleHeight,	hID,	gs_title_half_width, 1 + 128
			hotspot2 titleRectY / 2 - 1,					-titleHeight,	hID+1,	gs_title_half_width, 3
			hotspot2 titleRectY / 2 + gs_title_half_width,	-titleHeight,	hID+2,	gs_title_half_width, 2
			hID = hID + 3

			hotspot2 titleRectY / 2,						-titleHeight,	hID,	gs_title_half_width, 1 + 128
			hotspot2 titleRectY / 2 + 1,					-titleHeight,	hID+1,	gs_title_half_width, 3
			hotspot2 titleRectY / 2 - gs_title_half_width,	-titleHeight,	hID+2,	gs_title_half_width, 2
			hID = hID + 3

			add2 (titleRectY - gs_title_width) / 2, 0
		endif
	endif
	if gs_position_alignment_int = 3 then	! Right
		if bSpecPos then
			add2 -titleRectY + titleWidth, titleRectY
		else
			add2 0, 0
		endif

		if gs_position_side_int = 1 | gs_position_side_int = 4 then	! Top or Bottom
			hotspot2 titleRectX,					-titleHeight,	hID,	gs_title_width, 1 + (AC_ManualPosition + 1) * 128
			hotspot2 titleRectX + 1,				-titleHeight,	hID+1,	gs_title_width, 3
			hotspot2 titleRectX - gs_title_width,	-titleHeight,	hID+2,	gs_title_width, 2
			hID = hID + 3

			add2 titleRectX - gs_title_width, 0
		else
			hotspot2 titleRectY,					-titleHeight,	hID,	gs_title_width, 1 + (AC_ManualPosition + 1) * 128
			hotspot2 titleRectY + 1,				-titleHeight,	hID+1,	gs_title_width, 3
			hotspot2 titleRectY - gs_title_width,	-titleHeight,	hID+2,	gs_title_width, 2
			hID = hID + 3

			add2 titleRectY - gs_title_width, 0
		endif
	endif
else
	add2 0,0	! Empty transformation
endif

if SYMB_MIRRORED & not(bPositioningPreview) then
	add2 gs_title_width,0
	mul2 -1, 1
endif


! ==============================================================================
! Title Preview
! ==============================================================================

if bPositioningPreview then
	pen gs_frame_pen
	line_type gs_frame_linetype

	fill gs_frame_fill

	poly2_b 4, 7, gs_frame_fill_fg, gs_frame_fill_bg,
		0,			 0,					1,
		0,			-titleHeight,		1,
		titleWidth,	-titleHeight,		1,
		titleWidth,	 0,					1
endif


! ==============================================================================
! Drawing Title
! ==============================================================================

if not(bPositioningPreview) then

! Marker =======================================================================

	! Marker
	middleLineDx = 0

	WS2 = MAX(STW(layoutNumber), STW(drawingScale), STW(drawingNumber))
	autocolwidth2 = (WS2 /1000*_usedGlobalScale)

	! Drawing Number
	posX = autocolwidth2 / 4
	posY = -titleHeight + drawingNumberFontH
	gosub 202

	! Layout Number
	posX = autocolwidth2 / 4
	posY = -titleHeight + layoutNumberFontH
	gosub 207

	! Drawing Scale
	posX = autocolwidth2 / 4
	posY = -titleHeight - drawingScaleFontH
	gosub 201

	line2 autocolwidth2/2 + autocolwidth2 , -titleHeight*2, autocolwidth2/2 + autocolwidth2 , 0

	! Drawing Name
	posX = autocolwidth2 + autocolwidth2 * 2/3
	posY = -titleHeight + drawingNameFontH

	gosub 200

! Lines ========================================================================

	pen gs_title_pen
	line_type gs_title_linetype
	bvalt=titleWidth
	vvalt=autocolwidth2*2
	!WS3 = MAX(STW(bvalt),STW(vvalt))
	!	If STW(vvalt) > WS3 Then WS3 = STW(vvalt)
	! autocolwidth2 = (WS3 /1000*_usedGlobalScale)


	line2 0, -titleHeight, titleWidth,-titleHeight

	hotline2 0, -titleHeight, titleWidth,-titleHeight
	hotspot2 0, -titleHeight
	hotspot2 titleWidth,-titleHeight


	line2 0, 0, titleWidth,0

	hotline2 0,	0, titleWidth,0
	hotspot2 0,	0
	hotspot2 titleWidth,	0

	line2 titleWidth, -titleHeight*2, titleWidth, 0

	hotline2 titleWidth, -titleHeight, titleWidth, 0
	line2 middleLineDx, -titleHeight*2, middleLineDx, 0

	hotline2 middleLineDx, -titleHeight,
			 middleLineDx, 0
	line2 middleLineDx, -titleHeight*2 , titleWidth,-titleHeight * 2

	hotline2 middleLineDx, -titleHeight / 2, titleWidth,-titleHeight / 2
	hotspot2 middleLineDx, -titleHeight * 2
	hotspot2 titleWidth,-titleHeight * 2

! Data =========================================================================


	! Layout ID Separator
	if AC_ShowDrawingReferences then

		posY = -titleHeight-backrefFontH

		hotspot2 autocolwidth2+autocolwidth2*2/3+ gs_backref_pos_x,		posY+gs_backref_pos_y,	hID,	gs_backref_pos_x, 1+128
		hotspot2 autocolwidth2+autocolwidth2*2/3+ gs_backref_pos_x- 1,	posY+gs_backref_pos_y,	hID+1,	gs_backref_pos_x, 3
		hotspot2 autocolwidth2+autocolwidth2*2/3+ gs_backref_pos_x,		posY+gs_backref_pos_y,	hID+2,	 gs_backref_pos_x, 2
		hID = hID + 3

		hotspot2 autocolwidth2+autocolwidth2*2/3+ gs_backref_pos_x,		posY+gs_backref_pos_y,	hID,	gs_backref_pos_y, 1+128
		hotspot2 autocolwidth2+autocolwidth2*2/3+ gs_backref_pos_x,		posY+gs_backref_pos_y- 1,hID+1,	gs_backref_pos_y, 3
		hotspot2 autocolwidth2+autocolwidth2*2/3+ gs_backref_pos_x,		posY+gs_backref_pos_y,	hID+2,	gs_backref_pos_y, 2
		hID = hID + 3


		if gs_backref_custom=0 then
			STYLE styleBackref
			pen gs_backref_font_pen
			TEXT2 autocolwidth2+autocolwidth2*2/3+ gs_backref_pos_x,-titleHeight-backrefFontH+gs_backref_pos_y,"<BACKREFSHEETNUMBER_R><DUMMY><"+ gs_backref_separator + ">" + AC_BackReferenceGUIDList[1]
		else
			set style "styleBackref"
			pen gs_backref_font_pen
			TEXT2 autocolwidth2+autocolwidth2*2/3+ gs_backref_pos_x ,-titleHeight-backrefFontH+gs_backref_pos_y,gs_backref_customtxt
		endif
	endif



endif


del 4 + 2 * (SYMB_MIRRORED & not(bPositioningPreview))

! ==============================================================================

end



200:
! ==============================================================================
! Text Drawing Name
! ==============================================================================
! in:
!	posX:	position X
!	posY:	position Y
! ==============================================================================

	if gs_show_drawing_name then

		set style "styleDrawingName"
		pen gs_drawing_name_font_pen

		if (GLOB_CONTEXT = 22 | GLOB_CONTEXT = 28) & (gs_GLOB_MODPAR_NAME = "gs_drawing_name_pos_x" | gs_GLOB_MODPAR_NAME = "gs_drawing_name_pos_y") then
			textWidth	= stw(drawingName) * PAPER_TO_MODEL
			textHeight	= drawingNameFontH
			textAnchor	= anchorDrawingName
			gosub 300

			add2 anchorX, anchorY

			rect2 posX + gs_drawing_name_pos_x,				posY + gs_drawing_name_pos_y,
				  posX + gs_drawing_name_pos_x + textWidth,	posY + gs_drawing_name_pos_y + textHeight
			del 1
		else
			text2 posX + gs_drawing_name_pos_x, posY + gs_drawing_name_pos_y, drawingName
		endif

		hotspot2 posX,							posY + gs_drawing_name_pos_y,	hID,	gs_drawing_name_pos_x, 1+128
		hotspot2 posX- 1,						posY + gs_drawing_name_pos_y,	hID+1,	gs_drawing_name_pos_x, 3
		hotspot2 posX+ gs_drawing_name_pos_x,	posY + gs_drawing_name_pos_y,	hID+2,	gs_drawing_name_pos_x, 2
		hID = hID + 3

		hotspot2 posX+ gs_drawing_name_pos_x,	posY,							hID,	gs_drawing_name_pos_y, 1+128
		hotspot2 posX+ gs_drawing_name_pos_x,	posY - 1,						hID+1,	gs_drawing_name_pos_y, 3
		hotspot2 posX+ gs_drawing_name_pos_x,	posY + gs_drawing_name_pos_y,	hID+2,	gs_drawing_name_pos_y, 2
		hID = hID + 3
	endif
return

201:
! ==============================================================================
! Text Drawing Scale
! ==============================================================================
! in:
!	posX:	position X
!	posY:	position Y
! ==============================================================================

	if gs_show_drawing_scale then

		set style "styleDrawingScale"
		pen gs_drawing_scale_font_pen

		if (GLOB_CONTEXT = 22 | GLOB_CONTEXT = 28) & (gs_GLOB_MODPAR_NAME = "gs_drawing_scale_pos_x" | gs_GLOB_MODPAR_NAME = "gs_drawing_scale_pos_y") then
			textWidth	= stw(drawingScale) * PAPER_TO_MODEL
			textHeight	= drawingScaleFontH
			textAnchor	= anchorDrawingScale
			gosub 300

			add2 anchorX, anchorY

			rect2 posX + gs_drawing_scale_pos_x,				posY + gs_drawing_scale_pos_y,
				  posX + gs_drawing_scale_pos_x + textWidth,	posY + gs_drawing_scale_pos_y + textHeight
			del 1
		else
			text2 posX + gs_drawing_scale_pos_x, posY + gs_drawing_scale_pos_y, drawingScale
		endif

		hotspot2 posX,							posY + gs_drawing_scale_pos_y,	hID,	gs_drawing_scale_pos_x, 1+128
		hotspot2 posX - 1,						posY + gs_drawing_scale_pos_y,	hID+1,	gs_drawing_scale_pos_x, 3
		hotspot2 posX + gs_drawing_scale_pos_x,	posY + gs_drawing_scale_pos_y,	hID+2,	gs_drawing_scale_pos_x, 2
		hID = hID + 3

		hotspot2 posX + gs_drawing_scale_pos_x,	posY,							hID,	gs_drawing_scale_pos_y, 1+128
		hotspot2 posX + gs_drawing_scale_pos_x,	posY - 1,						hID+1,	gs_drawing_scale_pos_y, 3
		hotspot2 posX + gs_drawing_scale_pos_x,	posY + gs_drawing_scale_pos_y,	hID+2,	gs_drawing_scale_pos_y, 2
		hID = hID + 3
	endif
return

202:
! ==============================================================================
! Text Drawing Number
! ==============================================================================
! in:
!	posX:	position X
!	posY:	position Y
! ==============================================================================

	if gs_show_drawing_number then

		set style "styleDrawingNumber"
		pen gs_drawing_number_font_pen

		if (GLOB_CONTEXT = 22 | GLOB_CONTEXT = 28) & (gs_GLOB_MODPAR_NAME = "gs_drawing_number_pos_x" | gs_GLOB_MODPAR_NAME = "gs_drawing_number_pos_y") then
			textWidth	= stw(drawingNumber) * PAPER_TO_MODEL
			textHeight	= drawingNumberFontH
			textAnchor	= anchorDrawingNumber
			gosub 300

			add2 anchorX, anchorY

			rect2 posX + gs_drawing_number_pos_x,				posY + gs_drawing_number_pos_y,
				  posX + gs_drawing_number_pos_x + textWidth,	posY + gs_drawing_number_pos_y + textHeight
			del 1
		else
			text2 posX + gs_drawing_number_pos_x, posY + gs_drawing_number_pos_y, drawingNumber
		endif

		hotspot2 posX,								posY + gs_drawing_number_pos_y,	hID,	gs_drawing_number_pos_x, 1+128
		hotspot2 posX - 1,							posY + gs_drawing_number_pos_y,	hID+1,	gs_drawing_number_pos_x, 3
		hotspot2 posX + gs_drawing_number_pos_x,	posY + gs_drawing_number_pos_y,	hID+2,	gs_drawing_number_pos_x, 2
		hID = hID + 3

		hotspot2 posX + gs_drawing_number_pos_x,	posY,							hID,	gs_drawing_number_pos_y, 1+128
		hotspot2 posX + gs_drawing_number_pos_x,	posY - 1,						hID+1,	gs_drawing_number_pos_y, 3
		hotspot2 posX + gs_drawing_number_pos_x,	posY + gs_drawing_number_pos_y,	hID+2,	gs_drawing_number_pos_y, 2
		hID = hID + 3
	endif
return

!203:
!! ==============================================================================
!! Text Drawing Path
!! ==============================================================================
!! in:
!!	posX:	position X
!!	posY:	position Y
!! ==============================================================================
!
!	if gs_show_source_filename then
!
!		set style "styleSourceFileName"
!		pen gs_source_filename_font_pen
!
!		if (GLOB_CONTEXT = 22 | GLOB_CONTEXT = 28) & (gs_GLOB_MODPAR_NAME = "gs_source_filename_pos_x" | gs_GLOB_MODPAR_NAME = "gs_source_filename_pos_y") then
!			textWidth	= stw(drawingPath) * PAPER_TO_MODEL
!			textHeight	= sourceFileNameFontH
!			textAnchor	= anchorSourceFileName
!			gosub 300
!
!			add2 anchorX, anchorY
!
!			rect2 posX + gs_source_filename_pos_x,				posY + gs_source_filename_pos_y,
!				  posX + gs_source_filename_pos_x + textWidth,	posY + gs_source_filename_pos_y + textHeight
!			del 1
!		else
!			text2 posX + gs_source_filename_pos_x, posY + gs_source_filename_pos_y, drawingPath
!		endif
!
!		hotspot2 posX,								posY + gs_source_filename_pos_y,	hID,	gs_source_filename_pos_x, 1+128
!		hotspot2 posX - 1,							posY + gs_source_filename_pos_y,	hID+1,	gs_source_filename_pos_x, 3
!		hotspot2 posX + gs_source_filename_pos_x,	posY + gs_source_filename_pos_y,	hID+2,	gs_source_filename_pos_x, 2
!		hID = hID + 3
!
!		hotspot2 posX + gs_source_filename_pos_x,	posY,								hID,	gs_source_filename_pos_y, 1+128
!		hotspot2 posX + gs_source_filename_pos_x,	posY - 1,							hID+1,	gs_source_filename_pos_y, 3
!		hotspot2 posX + gs_source_filename_pos_x,	posY + gs_source_filename_pos_y,	hID+2,	gs_source_filename_pos_y, 2
!		hID = hID + 3
!	endif
!return

204:
! ==============================================================================
! Text Magnification
! ==============================================================================
! in:
!	posX:	position X
!	posY:	position Y
! ==============================================================================

	if gs_show_drawing_magnification then

		set style "styleDrawingMagnification"
		pen gs_drawing_magn_font_pen

		if (GLOB_CONTEXT = 22 | GLOB_CONTEXT = 28) & (gs_GLOB_MODPAR_NAME = "gs_drawing_magn_pos_x" | gs_GLOB_MODPAR_NAME = "gs_drawing_magn_pos_y") then
			textWidth	= stw(drawingMagnification) * PAPER_TO_MODEL
			textHeight	= drawingMagnFontH
			textAnchor	= anchorDrawingMagnification
			gosub 300

			add2 anchorX, anchorY

			rect2 posX + gs_drawing_magn_pos_x,				posY + gs_drawing_magn_pos_y,
				  posX + gs_drawing_magn_pos_x + textWidth,	posY + gs_drawing_magn_pos_y + textHeight
			del 1
		else
			text2 posX + gs_drawing_magn_pos_x, posY + gs_drawing_magn_pos_y, drawingMagnification
		endif

		hotspot2 posX,							posY + gs_drawing_magn_pos_y,	hID,	gs_drawing_magn_pos_x, 1+128
		hotspot2 posX - 1,						posY + gs_drawing_magn_pos_y,	hID+1,	gs_drawing_magn_pos_x, 3
		hotspot2 posX + gs_drawing_magn_pos_x,	posY + gs_drawing_magn_pos_y,	hID+2,	gs_drawing_magn_pos_x, 2
		hID = hID + 3

		hotspot2 posX + gs_drawing_magn_pos_x,	posY,							hID,	gs_drawing_magn_pos_y, 1+128
		hotspot2 posX + gs_drawing_magn_pos_x,	posY - 1,						hID+1,	gs_drawing_magn_pos_y, 3
		hotspot2 posX + gs_drawing_magn_pos_x,	posY + gs_drawing_magn_pos_y,	hID+2,	gs_drawing_magn_pos_y, 2
		hID = hID + 3
	endif
return

!205:
!! ==============================================================================
!! Text File Path
!! ==============================================================================
!! in:
!!	posX:	position X
!!	posY:	position Y
!! ==============================================================================
!
!	if gs_show_project_filename then
!
!		set style "styleProjectFilename"
!		pen gs_project_filename_font_pen
!
!		if (GLOB_CONTEXT = 22 | GLOB_CONTEXT = 28) & (gs_GLOB_MODPAR_NAME = "gs_project_filename_pos_x" | gs_GLOB_MODPAR_NAME = "gs_project_filename_pos_y") then
!			textWidth	= stw(filePath) * PAPER_TO_MODEL
!			textHeight	= projectFileNameFontH
!			textAnchor	= anchorProjectFileName
!			gosub 300
!
!			add2 anchorX, anchorY
!
!			rect2 posX + gs_project_filename_pos_x,				posY + gs_project_filename_pos_y,
!				  posX + gs_project_filename_pos_x + textWidth,	posY + gs_project_filename_pos_y + textHeight
!			del 1
!		else
!			text2 posX + gs_project_filename_pos_x, posY + gs_project_filename_pos_y, filePath
!		endif
!
!		hotspot2 posX,								posY + gs_project_filename_pos_y,	hID,	gs_project_filename_pos_x, 1+128
!		hotspot2 posX - 1,							posY + gs_project_filename_pos_y,	hID+1,	gs_project_filename_pos_x, 3
!		hotspot2 posX + gs_project_filename_pos_x,	posY + gs_project_filename_pos_y,	hID+2,	gs_project_filename_pos_x, 2
!		hID = hID + 3
!
!		hotspot2 posX + gs_project_filename_pos_x,	posY,								hID,	gs_project_filename_pos_y, 1+128
!		hotspot2 posX + gs_project_filename_pos_x,	posY - 1,							hID+1,	gs_project_filename_pos_y, 3
!		hotspot2 posX + gs_project_filename_pos_x,	posY + gs_project_filename_pos_y,	hID+2,	gs_project_filename_pos_y, 2
!		hID = hID + 3
!	endif
!return

!206:
!! ==============================================================================
!! Text Layout Name
!! ==============================================================================
!! in:
!!	posX:	position X
!!	posY:	position Y
!! ==============================================================================
!
!	if gs_show_layout_name then
!
!		set style "styleLayoutName"
!		pen gs_layout_name_font_pen
!
!		if (GLOB_CONTEXT = 22 | GLOB_CONTEXT = 28) & (gs_GLOB_MODPAR_NAME = "gs_layout_name_pos_x" | gs_GLOB_MODPAR_NAME = "gs_layout_name_pos_y") then
!			textWidth	= stw(layoutName) * PAPER_TO_MODEL
!			textHeight	= layoutNameFontH
!			textAnchor	= anchorLayoutName
!			gosub 300
!
!			add2 anchorX, anchorY
!
!			rect2 posX + gs_layout_name_pos_x,				posY + gs_layout_name_pos_y,
!				  posX + gs_layout_name_pos_x + textWidth,	posY + gs_layout_name_pos_y + textHeight
!			del 1
!		else
!			text2 posX + gs_layout_name_pos_x, posY + gs_layout_name_pos_y, layoutName
!		endif
!
!		hotspot2 posX,							posY + gs_layout_name_pos_y,	hID,	gs_layout_name_pos_x, 1+128
!		hotspot2 posX - 1,						posY + gs_layout_name_pos_y,	hID+1,	gs_layout_name_pos_x, 3
!		hotspot2 posX + gs_layout_name_pos_x,	posY + gs_layout_name_pos_y,	hID+2,	gs_layout_name_pos_x, 2
!		hID = hID + 3
!
!		hotspot2 posX + gs_layout_name_pos_x,	posY,							hID,	gs_layout_name_pos_y, 1+128
!		hotspot2 posX + gs_layout_name_pos_x,	posY - 1,						hID+1,	gs_layout_name_pos_y, 3
!		hotspot2 posX + gs_layout_name_pos_x,	posY + gs_layout_name_pos_y,	hID+2,	gs_layout_name_pos_y, 2
!		hID = hID + 3
!	endif
!return

207:
! ==============================================================================
! Text Layout Number
! ==============================================================================
! in:
!	posX:	position X
!	posY:	position Y
! ==============================================================================

	if gs_show_layout_number then

		set style "styleLayoutNumber"
		pen gs_layout_number_font_pen

		if (GLOB_CONTEXT = 22 | GLOB_CONTEXT = 28) & (gs_GLOB_MODPAR_NAME = "gs_layout_number_pos_x" | gs_GLOB_MODPAR_NAME = "gs_layout_number_pos_y") then
			textWidth	= stw(layoutNumber) * PAPER_TO_MODEL
			textHeight	= layoutNumberFontH
			textAnchor	= anchorLayoutNumber
			gosub 300

			add2 anchorX, anchorY

			rect2 posX + gs_layout_number_pos_x,				posY + gs_layout_number_pos_y,
				  posX + gs_layout_number_pos_x + textWidth,	posY + gs_layout_number_pos_y + textHeight
			del 1
		else
			text2 posX + gs_layout_number_pos_x, posY + gs_layout_number_pos_y, layoutNumber
		endif

		hotspot2 posX,							posY + gs_layout_number_pos_y,	hID,	gs_layout_number_pos_x, 1+128
		hotspot2 posX - 1,						posY + gs_layout_number_pos_y,	hID+1,	gs_layout_number_pos_x, 3
		hotspot2 posX + gs_layout_number_pos_x,	posY + gs_layout_number_pos_y,	hID+2,	gs_layout_number_pos_x, 2
		hID = hID + 3

		hotspot2 posX + gs_layout_number_pos_x,	posY,							hID,	gs_layout_number_pos_y, 1+128
		hotspot2 posX + gs_layout_number_pos_x,	posY - 1,						hID+1,	gs_layout_number_pos_y, 3
		hotspot2 posX + gs_layout_number_pos_x,	posY + gs_layout_number_pos_y,	hID+2,	gs_layout_number_pos_y, 2
		hID = hID + 3
	endif
return


300:
! ==============================================================================
! Text anchor relative position
! ==============================================================================
! in:
!	textWidth:		width of the text
!	textHeight:		height of the text
!	textAnchor:		text anchor code
! out:
!	anchorY:		anchor relative position X
!	anchorY:		anchor relative position Y
! ==============================================================================

	if textAnchor = 1 | textAnchor = 4 | textAnchor = 7 then
		anchorX = 0
	endif
	if textAnchor = 2 | textAnchor = 5 | textAnchor = 8 then
		anchorX = -textWidth / 2
	endif
	if textAnchor = 3 | textAnchor = 6 | textAnchor = 9 then
		anchorX = -textWidth
	endif
	if textAnchor = 1 | textAnchor = 2 | textAnchor = 3 then
		anchorY = -textHeight
	endif
	if textAnchor = 4 | textAnchor = 5 | textAnchor = 6 then
		anchorY = -textHeight / 2
	endif
	if textAnchor = 7 | textAnchor = 8 | textAnchor = 9 then
		anchorY = 0
	endif
return

