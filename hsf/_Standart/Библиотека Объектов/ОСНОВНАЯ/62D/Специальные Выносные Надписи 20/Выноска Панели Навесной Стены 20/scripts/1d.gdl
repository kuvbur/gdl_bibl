
EPS = 0.00001

! --- values for GLOB_ELEM_TYPE ---
ELEM_TYPE_LABEL		= 0
ELEM_TYPE_OBJECT	= 1
ELEM_TYPE_LAMP		= 2
ELEM_TYPE_WINDOW	= 3
ELEM_TYPE_DOOR		= 4
ELEM_TYPE_WALL		= 5
ELEM_TYPE_COLUMN	= 6
ELEM_TYPE_SLAB		= 7
ELEM_TYPE_ROOF		= 8
ELEM_TYPE_FILL		= 9
ELEM_TYPE_MESH		= 10
ELEM_TYPE_ZONE		= 11
ELEM_TYPE_BEAM		= 12
ELEM_TYPE_CW		= 13
ELEM_TYPE_CWFRAME	= 14
ELEM_TYPE_CWPANEL	= 15
ELEM_TYPE_CWJUNCT	= 16
ELEM_TYPE_CWACC		= 17
ELEM_TYPE_SHELL		= 18
ELEM_TYPE_SKYLIGHT	= 19
ELEM_TYPE_MORPH		= 20

! - Offered Tools: CWPanel
_isEnabledContent	= 0
bDefaultElem		= (GLOB_INTGUID = "" | GLOB_INTGUID = "{00000000-0000-0000-0000-000000000000}")
if GLOB_ELEM_TYPE = ELEM_TYPE_CWPANEL |\
	bDefaultElem then
	_isEnabledContent = 1
endif



dim stShapes[9]
	stShapes[1] = `Окружность`
	stShapes[2] = `Ромб`
	stShapes[3] = `Прямоугольник`
	stShapes[4] = `Овал`
	stShapes[5] = `Треугольник`
	stShapes[6] = `Пятиугольник`
	stShapes[7] = `Шестиугольник`
	stShapes[8] = `Восьмиугольник`
	stShapes[9] = `Нет`

SHAPE_CIRCLE	= 1
SHAPE_RECT		= 2
SHAPE_FRAGMENT	= 3
SHAPE_OVAL		= 4
SHAPE_TRIANGLE	= 5
SHAPE_PENTAGON	= 6
SHAPE_HEXAGON	= 7
SHAPE_OCTAGON	= 8
SHAPE_NONE		= 0

dim stDimensionTypes[4]
	stDimensionTypes[1] = `Размеры Элемента`
	stDimensionTypes[2] = `Размеры Полотна`
	stDimensionTypes[3] = `Размеры Прохода`
	stDimensionTypes[4] = `Размеры Четверти`

DIM_UNIT	= 1
DIM_LEAF	= 2
DIM_EGRESS	= 3
DIM_REVEAL	= 4

dim stCustomText[4]
	stCustomText[1] = `Компактный ID Элемента`
	stCustomText[2] = `Измеренное Значение`
	stCustomText[3] = `Специальный Текст`
	stCustomText[4] = `Полный ID Элемента`

CTXT_IDNUMBER		= 1
CTXT_MEASUREDVALUE	= 2
CTXT_CUSTOMTEXT		= 3
CTXT_FULLIDNUM		= 4

dim stMarkerDirValues[4]
	stMarkerDirValues[1] = `Стандарт`
	stMarkerDirValues[2] = `Выровнять по Линии Выноски`
	stMarkerDirValues[3] = `Горизонтально`
	stMarkerDirValues[4] = `Вертикально`

if GLOB_SCRIPT_TYPE = 7 | GLOB_SCRIPT_TYPE = 8 then
	goto "MasterEnd"
endif



wwidth =			CWPANEL_WIDTH
wheight =			CWPANEL_HEIGHT
unitwidth =			CWPANEL_NOMINAL_WIDTH
unitheight =		CWPANEL_NOMINAL_HEIGHT

frameWidth = 0
recessWidth = 0
adapterWidth = 0
if CWPANEL_TYPE = "Generic" then
else
	n = REQUEST ("ASSOCLP_PARVALUE", "frameWidth", index, type, flags, dim1, dim2, frameWidth)
	n = REQUEST ("ASSOCLP_PARVALUE", "recessWidth", index, type, flags, dim1, dim2, recessWidth)
	n = REQUEST ("ASSOCLP_PARVALUE", "adapterWidth", index, type, flags, dim1, dim2, adapterWidth)
endif

if CWPANEL_FUNCTION = 1 then gs_dw_marker_type = 2			! D
if CWPANEL_FUNCTION = 2 then gs_dw_marker_type = 1			! W

! ==============================================================================
! Uniform Text Format
! ==============================================================================

if GS_UniTextFormat then
	AC_TextFont_2	= AC_TextFont_1
	AC_TextSize_2	= AC_TextSize_1
	AC_TextPen_2	= AC_TextPen_1
	AC_TextStyle_2	= AC_TextStyle_1
	AC_TextFont_3	= AC_TextFont_1
	AC_TextSize_3	= AC_TextSize_1
	AC_TextPen_3	= AC_TextPen_1
	AC_TextStyle_3	= AC_TextStyle_1
	AC_TextFont_4	= AC_TextFont_1
	AC_TextSize_4	= AC_TextSize_1
	AC_TextPen_4	= AC_TextPen_1
	AC_TextStyle_4	= AC_TextStyle_1
	AC_TextFont_5	= AC_TextFont_1
	AC_TextSize_5	= AC_TextSize_1
	AC_TextPen_5	= AC_TextPen_1
	AC_TextStyle_5	= AC_TextStyle_1
	AC_TextFont_6	= AC_TextFont_1
	AC_TextSize_6	= AC_TextSize_1
	AC_TextPen_6	= AC_TextPen_1
	AC_TextStyle_6	= AC_TextStyle_1
else
	AC_TextStyle_1 = GS_Text_Style_1B + 2 * GS_Text_Style_1I + 4 * GS_Text_Style_1U
	AC_TextStyle_2 = GS_Text_Style_2B + 2 * GS_Text_Style_2I + 4 * GS_Text_Style_2U
	AC_TextStyle_3 = GS_Text_Style_3B + 2 * GS_Text_Style_3I + 4 * GS_Text_Style_3U
	AC_TextStyle_4 = GS_Text_Style_4B + 2 * GS_Text_Style_4I + 4 * GS_Text_Style_4U
	AC_TextStyle_5 = GS_Text_Style_5B + 2 * GS_Text_Style_5I + 4 * GS_Text_Style_5U
	AC_TextStyle_6 = GS_Text_Style_6B + 2 * GS_Text_Style_6I + 4 * GS_Text_Style_6U
endif


! ==============================================================================
! Investigation of associated WINDOW values
! ==============================================================================

if gs_dw_marker_type = 1 then

	! Reveal Width, Reveal Height --------------------------------------------------

	revealwidth = wwidth - adapterWidth
	revealheight = wheight - adapterWidth

	! Ventilation ------------------------------------------------------------------

	ventilation = ""

	if CWPANEL_TYPE <> "Generic" then
		rrr = request ("ASSOCLP_PARVALUE", "gs_list_ventilation",
			index_ventilation, type_ventilation, flags_ventilation,
			dim1_ventilation, dim2_ventilation, ventilation)
	endif
endif


! ==============================================================================
! Investigation of associated DOOR values
! ==============================================================================

if gs_dw_marker_type = 2 then

	! Leaf Width, Leaf Height ------------------------------------------------------

	leafwidth = wwidth - frameWidth - adapterWidth + recessWidth
	leafheight = wheight - frameWidth - adapterWidth + recessWidth

	! Egress Width, Egress Height --------------------------------------------------

	egresswidth = wwidth - frameWidth - adapterWidth
	egressheight = wheight - frameWidth - adapterWidth

endif

! ==============================================================================
! Investigation of associated DOOR / WINDOW values
! ==============================================================================

! Fire Rating ------------------------------------------------------------------

firerating = ""

if CWPANEL_TYPE <> "Generic" then
	rrr = request ("ASSOCLP_PARVALUE", "gs_list_firerating",
		index_firerating, type_firerating, flags_firerating,
		dim1_firerating, dim2_firerating, firerating)
endif

! Acoustic Rating --------------------------------------------------------------

acousticrating = ""

if CWPANEL_TYPE <> "Generic" then
	rrr = request ("ASSOCLP_PARVALUE", "gs_list_acousticrating",
		index_acousticrating, type_acousticrating, flags_acousticrating,
		dim1_acousticrating, dim2_acousticrating, acousticrating)
endif


"MasterEnd":

