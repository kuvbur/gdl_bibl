! Разработал Новиков Г.К.
! ©  ООО  "ФОРМАТ ЛТД"  1998 t.(044)  277-5066
! Доработал Титов С.А.
! Москва 1999 г.
if c<0 then c=0
if C>75 then C=75
L=0.001*GLOB_SCALE
MUL2   L,L
DEFINE STYLE "текст1"  fontType2 ,I, 5,1
DEFINE STYLE "текст"  fontType, H, 5,1
SET STYLE "текст1"
B = D*C+AA3
A=A1
LINE2  0,0,0,-B
IF A1>0 THEN 201
END
201:
GOSUB 101
A=A1
IF A3>0 THEN 202
GOSUB 301
END
202:
GOSUB 102
A=A+A3
IF A5>0 THEN 203
GOSUB 301
END
203:
GOSUB 103
A=A+A5
IF A7>0 THEN 204
GOSUB 301
END
204:
GOSUB 104
A=A+A7
IF A9>0 THEN 205
GOSUB 301
END
205:
GOSUB 105
A=A+A9
IF A11>0 THEN 206
GOSUB 301
END
206:
GOSUB 106
A=A+A11
IF A13>0 THEN 207
GOSUB 301
END
207:
GOSUB 107
A=A+A13
IF A15>0 THEN 208
GOSUB 301
END
208:
GOSUB 108
A=A+A15
IF A17>0 THEN 209
GOSUB 301
END
209:
GOSUB 109
A=A+A17
IF A19>0 THEN 210
GOSUB 301
END
210:
GOSUB 110
A=A+A19
GOSUB 301
END

101:
LINE2 A1,0,A1,-B
IF AA1=1 THEN TEXT2  A/2,-AA3/2,A2
RETURN
102:
LINE2 A+A3,0,A+A3,-B
IF AA1=1 THEN TEXT2  A+A3/2,-AA3/2,A4
RETURN
103:
LINE2 A+A5,0,A+A5,-B
IF AA1=1 THEN TEXT2  A+A5/2,-AA3/2,A6
RETURN
104:
LINE2 A+A7,0,A+A7,-B
IF AA1=1 THEN TEXT2  A+A7/2,-AA3/2,A8
RETURN
105:
LINE2 A+A9,0,A+A9,-B
IF AA1=1 THEN TEXT2  A+A9/2,-AA3/2,A10
RETURN
106:
LINE2 A+A11,0,A+A11,-B
IF AA1=1 THEN TEXT2  A+A11/2,-AA3/2,A12
RETURN
107:
LINE2 A+A13,0,A+A13,-B
IF AA1=1 THEN TEXT2  A+A13/2,-AA3/2,A14
RETURN
108:
LINE2 A+A15,0,A+A15,-B
IF AA1=1 THEN TEXT2  A+A15/2,-AA3/2,A16
RETURN
109:
LINE2 A+A17,0,A+A17,-B
IF AA1=1 THEN TEXT2  A+A17/2,-AA3/2,A18
RETURN
110:
LINE2 A+A19,0,A+A19,-B
IF AA1=1 THEN TEXT2  A+A19/2,-AA3/2,A20
RETURN
301:
FOR KK=1 TO C-1
LINE2  0,-(AA3+KK*D),A,-(AA3+KK*D)
NEXT KK
LINE2  0,0,A,0
LINE2  0,-AA3,A,-AA3
LINE2  0,-(AA3+KK*D),A,-(AA3+KK*D)
SET STYLE "текст"
PEN J
TEXT2  A/2,H,E
RETURN
END

