

EPS					= 0.0001
DOT_IN_MM			= 72 / 25.4


if GLOB_SCRIPT_TYPE = 7 | GLOB_SCRIPT_TYPE = 8 then goto "MasterEnd"

! _iScale, iUIDisplayScale
	SCALE_INSENSITIVE	= 1
	SCALE_50			= 2
	SCALE_100			= 3
	SCALE_200			= 4

dim stDisplayScale[4]
	stDisplayScale[SCALE_INSENSITIVE]	= ""
	stDisplayScale[SCALE_50]			= `1:50`
	stDisplayScale[SCALE_100]			= `1:100`
	stDisplayScale[SCALE_200]			= `1:200`

! for sync UI and ParamList
if bScaleSensitive then
	_iUIDisplayScale = iUIDisplayScale
else
	_iUIDisplayScale = SCALE_INSENSITIVE
endif

! iFontSizeType
	FONTSCALE_MODEL	= 1
	FONTSCALE_PAPER	= 2

dim stFontSizeTypes[2]
	stFontSizeTypes[1] = `Размер Модели`
	stFontSizeTypes[2] = `Размер Бумаги`

!plus minus glob_ui_button_id
	BUTTON_ID_INSENSITIVE = 1000
	BUTTON_ID_50 = 2000
	BUTTON_ID_100 = 3000
	BUTTON_ID_200 = 4000

dim _idGlobButton[4]
	_idGlobButton[1] = BUTTON_ID_INSENSITIVE
	_idGlobButton[2] = BUTTON_ID_50
	_idGlobButton[3] = BUTTON_ID_100
	_idGlobButton[4] = BUTTON_ID_200

! GLOB_BUTTON_ID
	idButton_addnewRow 	= 0
	idButton_pasteRow 	= 100
	idButton_dropRow 	= 200

! iOrder_x, iOrder_x_temp
! group values
ORDER_NONE			= 1
ORDER_ZONE_NAME		= 2
ORDER_ZONE_NUMBER	= 3
ORDER_MEAS_AREA		= 4
ORDER_CALC_AREA		= 5
ORDER_FLOORING		= 6
ORDER_PERIMETER		= 7
ORDER_CEIL_HEIGHT	= 8
ORDER_VOLUME		= 9
ORDER_OCCUPANCY		= 10
ORDER_ZONE_ID		= 11
ORDER_ADD_TAGS		= 12
ORDER_CUSTOM_TEXT	= 13
ORDER_ROOM_NUMBER	= 14		! managing by bEnableZone1CustomText2
ORDER_NAME_AND_NUMBER	= 15
ORDER_SURFACE_CODE	= 16		! managing by bEnableZone1SurfaceCode
! NEW_GROUP = 17

dim stGroupText[16]
	stGroupText[ORDER_NONE] 			= "** " + `Пустая Строка`	! by design AjkayA
	stGroupText[ORDER_ZONE_NAME] 		= `Имя Зоны`
	stGroupText[ORDER_ZONE_NUMBER] 		= `Номер Зоны`
	stGroupText[ORDER_MEAS_AREA] 		= `Измеренная Площадь`
	stGroupText[ORDER_CALC_AREA] 		= `Вычисленная Площадь`
	stGroupText[ORDER_FLOORING] 		= `Пол`
	stGroupText[ORDER_PERIMETER] 		= `Периметр`
	stGroupText[ORDER_CEIL_HEIGHT] 		= `Высота Потолка`
	stGroupText[ORDER_VOLUME] 			= `Объем`
	stGroupText[ORDER_OCCUPANCY] 		= `Расчетное Число Людей`
	stGroupText[ORDER_ZONE_ID] 			= `ID Зоны`
	stGroupText[ORDER_ADD_TAGS] 		= `Дополнительные Метки`
	stGroupText[ORDER_CUSTOM_TEXT] 		= `Специальный Текст`
	stGroupText[ORDER_ROOM_NUMBER] 		= `Номер Помещения`
	stGroupText[ORDER_NAME_AND_NUMBER] 	= `Имя и Номер Зоны`
	stGroupText[ORDER_SURFACE_CODE] 	= `Код Покрытия`
_maxGroupDisplay = 16
_maxOrderingRow = 14


! row values
ROW_NONE			= 1
ROW_ZONE_NAME		= 2
ROW_ZONE_NUMBER		= 3
ROW_MEAS_AREA		= 4
ROW_MEAS_AREA_TSUBO	= 5		! managing by bEnableTsubo Area
ROW_CALC_AREA		= 6
ROW_CALC_AREA_TSUBO	= 7		! managing by bEnableTsubo Area
ROW_FLOORING		= 8
ROW_PERIMETER		= 9
ROW_CEIL_HEIGHT		= 10
ROW_VOLUME			= 11
ROW_OCCUPANCY		= 12
ROW_ZONE_ID			= 13
ROW_CUSTOM_TEXT		= 14
ROW_ROOM_NUMBER		= 15	! managing by bEnableZone1CustomText2
ROW_NAME_AND_NUMBER	= 16
ROW_SURFACE_CODE	= 17	! managing by bEnableZone1SurfaceCode
ROW_ADD_TAGS		= 18 ! + _numTnCRow = VARDIM1(_sContentTnC)
! NEW_VALUE = 18 + _numTnCRow
! or if there is migration too then:
! NEW_VALUE = 18 and change ROW_ADD_TAGS = 19

! iAlignment
ALIIGN_LEFT		= 1
ALIIGN_CENTERED	= 2
ALIIGN_RIGHT	= 3

! iAlignment`s strings
dim stJustification[3]
	stJustification[1] = `По Левому Краю`
	stJustification[2] = `По центру`
	stJustification[3] = `По Правому Краю`

! iTypeCeilContent
CEIL_VALUE		= 1
CEIL_TYPICAL	= 2

! iTypeCeilContent`s strings
dim strTypeCeilContent[2]
	strTypeCeilContent[1] = `Значение`
	strTypeCeilContent[2] = `Типичный`


! sOrderNameandNumber
dim strOrderNameandNumber[2]
	strOrderNameandNumber[1] = `Сначала Номер Зоны`
	strOrderNameandNumber[2] = `Сначала Имя Зоны`

! iOrderNameandNumber
ZONE_NUMBER_FIRST	= 1
ZONE_NAME_FIRST		= 2

! sComponentSurfaceCode
dim strComponentSurfaceCode[3]
	strComponentSurfaceCode[1] = `Специальный Код`
	strComponentSurfaceCode[2] = `Код и Имя`
	strComponentSurfaceCode[3] = `Имя Покрытия`

! iComponentSurfaceCode
CUSTOM_CODE						= 1
CUSTOM_CODE_AND_SURFACE_NAME	= 2
SURFACE_NAME					= 3

! iAnchorStamp
ANCHOR_TOP_LEFT			= 1
ANCHOR_TOP_MIDDLE		= 2
ANCHOR_TOP_RIGHT		= 3
ANCHOR_MIDDLE_LEFT		= 4
ANCHOR_CENTER			= 5
ANCHOR_MIDDLE_RIGHT		= 6
ANCHOR_BOTTOM_LEFT		= 7
ANCHOR_BOTTOM_MIDDLE	= 8
ANCHOR_BOTTOM_RIGHT		= 9

! iAnchorStamp`s strings
dim strAnchorPoint[9]
	strAnchorPoint[1] = `Верхняя Левая`
	strAnchorPoint[2] = `Верхняя Средняя`
	strAnchorPoint[3] = `Верхняя Правая`
	strAnchorPoint[4] = `Средняя Левая`
	strAnchorPoint[5] = `Центр`
	strAnchorPoint[6] = `Средняя Правая`
	strAnchorPoint[7] = `Нижняя Левая`
	strAnchorPoint[8] = `Нижняя Средняя`
	strAnchorPoint[9] = `Нижняя Правая`

! iTypeStampWidth
WIDTH_AUTOMATIC	= 1
WIDTH_CUSTOM	= 2

! iTypeStampWidth`s strings
dim strTypeStampWidth[2]
	strTypeStampWidth[1] = `Автоматически`
	strTypeStampWidth[2] = `Фиксированная`


! iShowZoneIDAs
IDVALUE_IDNUMBER	= 1
IDVALUE_FULLIDNUM	= 2

dim stIDValue[2]
	stIDValue[1] = `Компактный ID Элемента`
	stIDValue[2] = `Полный ID Элемента`

! iAreaUnit
dim stAreaUnit[3]
	stAreaUnit[1] = `в Единицах Расчета Площади`				! it means 1 row with project preferences unit forms
	stAreaUnit[2] = `в Единицах Расчета Площади и Тсубо`	! it means 2 duplicated row with different unit forms
	stAreaUnit[3] = `только в Тсубо`							! it means 1 row with custom unit forms

AREA_UNIT_PROJECT 				= 1
AREA_UNIT_TSUBO_AND_PROJECT 	= 2
AREA_UNIT_TSUBO_ONLY 			= 3

! ==============================================================================
! Variables for UI
! ==============================================================================

SUBTAB_NONE				= 1
SUBTAB_ZONE_NAME		= 2
SUBTAB_ZONE_NUM			= 3
SUBTAB_MEASURED_AREA	= 4
SUBTAB_CALC_AREA		= 5
SUBTAB_FLOORING			= 6
SUBTAB_PERIMETER		= 7
SUBTAB_CEILING_HGT		= 8
SUBTAB_VOLUME			= 9
SUBTAB_OCCUPANCY		= 10
SUBTAB_ZONE_ID			= 11
SUBTAB_ADDITIONAL_TAGS	= 12
SUBTAB_CUSTOM_TEXT		= 13
SUBTAB_ROOM_NUMBER		= 14
SUBTAB_NAME_AND_NUMBER	= 15
SUBTAB_SURFACE_CODE		= 16

if GLOB_SCRIPT_TYPE = 4 | \		! parameter script
	GLOB_SCRIPT_TYPE = 5 then	! interface script

	w_units_form = ""
	rrr = request("Working_length_unit", "", w_units_form)
	bMetricDimensionNeeded = strstr(w_units_form, "m")		! m, cm, mm

endif


! ==============================================================================
! Calculated variables for listing
! ==============================================================================

bImperialArea = 0
rrr = request ("Area_dimension", "", szFormat)
if strstr (szFormat, "sqf") | strstr (szFormat, "sqi")	then bImperialArea = 1

if gs_show_occupancy_area then
	result_occupancy = str("%~",int(ROOM_CALC_AREA / gs_area_perPerson_sqm) + gs_number_add_occupants)
	parameters result_occupancy = result_occupancy
else
	result_occupancy = str("%~",gs_number_occupants)
	parameters result_occupancy = result_occupancy
endif

! ==============================================================================
! Additional Tag
! ------------------------------------------------------------------------------

_numTnCRow 		= 0
dim _contentTnC[]
	_contentTnC[1] 	= ""
gosub "analyze_TnC_params"	! output > _numTnCRow, _contentTnC array

! Max Row Number
! ------------------------------------------------------------------------------
maxRowNumber = 17 + _numTnCRow


! ==============================================================================
goto "MasterEnd"
! ==============================================================================
! ==============================================================================
"analyze_TnC_params" :
! Additional Tags`re sorted from the Tags and Categories
! - subroutine function: setting number of Additional Tags rows and content
! "None" displaying is by design:
! if a user sets the create sortings row type to none, then empty rows 
! (epmty instead "none") would be displayed only between two non-empty rows,
! At the begin and at the end the empty rows are not displyed. 
! For analyzing use TnCParamRequest macro with _sContentTnC array as returned variable
! for help:
! 	call "TnCParamRequest" parameters all bDebug = 1
! ==============================================================================

! Initialization for returned parameters
nRowProperty = 0
nColuProperty = 0
dim listProperty[]
	listProperty[1] = ""

! Request results in multiple rows: 
!  group = 2; name = 3; value = 5
DIM _columns[5]	! [iTncDisplayData]
	_columns[1] =     3 * 5	! DISPLAYDATABY_NAMEVALUE
	_columns[2] =     3   	! DISPLAYDATABY_NAME
	_columns[3] =         5	! DISPLAYDATABY_VALUE
	_columns[4] = 2 * 3    	! DISPLAYDATABY_GROUPNAME
	_columns[5] = 2 * 3 * 5	! DISPLAYDATABY_GROUPNAMEVALUE

call "TnCParamRequest" parameters all 	bShowAdditionalTags	= 1,

										! settings for parameter script
										bEnableHideTnCParameters 	= 1,

										! displayed datas of properties
										bUsePropertyFolder			= not(_columns[iTncDisplayData] mod 2),
										bUsePropertyID				= 0,
										bUsePropertyName			= not(_columns[iTncDisplayData] mod 3),
										bUsePropertyValue 			= not (_columns[iTncDisplayData] mod 5),
										bUsePropertyType			= 0,

					returned_parameters nRowProperty, nColuProperty, listProperty
					! listProperty is became to a single dimension array (a type of linear array)
					! it has to be sepparated by each columns

! Converting rows of the result
for i = 1 to nRowProperty
	! initializaton
	_contentTnC[i] = ""

	for j = 1 to nColuProperty
		_sContentCell = listProperty[nColuProperty * (i-1) + j]
		_sSeparator = ""
		if _contentTnC[i] # "" and _sContentCell # "" then
			_sSeparator = ": "
		endif
		_contentTnC[i] = _contentTnC[i] + _sSeparator + _sContentCell
	next j
next i

_numTnCRow = nRowProperty

return


! ==============================================================================
"MasterEnd":
