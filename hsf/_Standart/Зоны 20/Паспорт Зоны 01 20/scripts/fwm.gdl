
actualGUID = FROM_GUID

! ==============================================================================
! Subroutines
! ==============================================================================

	_autoID		= "BBC0F8B4-D19E-44D1-8B46-3528825D2DF3"
	_startID	= "990DC974-9F48-46A5-84D4-25B98C0C1CBA"
	_endID		= "7DD53A74-6A5A-4720-9DD7-1A912E99633B"
gosub "NewRequestForProperties_FWM"

	_startID	= "7DD53A74-6A5A-4720-9DD7-1A912E99633B"
	_endID		= "ACA1D0FD-3E31-46C9-99F3-DA95218528C9"
gosub "TnCShowCatOnly_FWM"

! ==============================================================================
! Set migration GUID
! ==============================================================================

setmigrationguid actualGUID

! ==============================================================================
end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! en
! ==============================================================================


! ==============================================================================
! NewRequestForProperties
! ==============================================================================
"NewRequestForProperties_FWM":
	if actualGUID = _startID | actualGUID = _autoID then

		_bUseOldLongName	= 0
		_iOldDisplayData	= 3
		bHas = DELETED_PAR_VALUE ("bDisplayPropertySetName", _bUseOldLongName) & \
				STORED_PAR_VALUE ("iTncDisplayData", _iOldDisplayData)

		_iNewDisplayData = _iOldDisplayData

		if _bUseOldLongName then
			if _iOldDisplayData = 1 then		! DISPLAYDATABY_NAMEVALUE
				_iNewDisplayData = 5			! DISPLAYDATABY_GROUPNAMEVALUE
			else
				if _iOldDisplayData = 2 then	! DISPLAYDATABY_NAME then
					_iNewDisplayData = 4		! DISPLAYDATABY_GROUPNAME
				endif
			endif
		endif

		iTncDisplayData = _iNewDisplayData
		parameters iTncDisplayData = iTncDisplayData

		actualGUID = _endID
	endif

return

! ==============================================================================
! TnCShowCatOnly
! ==============================================================================
"TnCShowCatOnly_FWM":
	if actualGUID = _startID then
		_prevDisplayContent = 1
        dim _numDisplayedGroup[4]
        dim _iOrder_1[4]
        dim _iOrder_2[4]
        dim _iOrder_3[4]
        dim _iOrder_4[4]
        dim _iOrder_5[4]
        dim _iOrder_6[4]
        dim _iOrder_7[4]
        dim _iOrder_8[4]
        dim _iOrder_9[4]
        dim _iOrder_10[4]
        dim _iOrder_11[4]
        dim _iOrder_12[4]
        dim _iOrder_13[4]
        dim _iOrder_14[4]
        
		bHas =  STORED_PAR_VALUE ("iTnCSelectParams", _prevDisplayContent)  &\
                STORED_PAR_VALUE ("bScaleSensitive", _bScaleSensitive)      &\
                STORED_PAR_VALUE ("numDisplayedGroup", _numDisplayedGroup)  &\
                STORED_PAR_VALUE ("iOrder_1", _iOrder_1) &\
                STORED_PAR_VALUE ("iOrder_2", _iOrder_2) &\
                STORED_PAR_VALUE ("iOrder_3", _iOrder_3) &\
                STORED_PAR_VALUE ("iOrder_4", _iOrder_4) &\
                STORED_PAR_VALUE ("iOrder_5", _iOrder_5) &\
                STORED_PAR_VALUE ("iOrder_6", _iOrder_6) &\
                STORED_PAR_VALUE ("iOrder_7", _iOrder_7) &\
                STORED_PAR_VALUE ("iOrder_8", _iOrder_8) &\
                STORED_PAR_VALUE ("iOrder_9", _iOrder_9) &\
                STORED_PAR_VALUE ("iOrder_10", _iOrder_10) &\
                STORED_PAR_VALUE ("iOrder_11", _iOrder_11) &\
                STORED_PAR_VALUE ("iOrder_12", _iOrder_12) &\
                STORED_PAR_VALUE ("iOrder_13", _iOrder_13) &\
                STORED_PAR_VALUE ("iOrder_14", _iOrder_14) 
                
        _cutMigration = 0
		if _prevDisplayContent = 2 then		! PARAMSELECTION_DISPLAYALL
            for i = (1 + _bScaleSensitive) to (1 + 3 * _bScaleSensitive)
                if _numDisplayedGroup[i] >= 1 & _iOrder_1[i] = 12 then _cutMigration = 1
                if _numDisplayedGroup[i] >= 2 & _iOrder_2[i] = 12 then _cutMigration = 1
                if _numDisplayedGroup[i] >= 3 & _iOrder_3[i] = 12 then _cutMigration = 1
                if _numDisplayedGroup[i] >= 4 & _iOrder_4[i] = 12 then _cutMigration = 1
                if _numDisplayedGroup[i] >= 5 & _iOrder_5[i] = 12 then _cutMigration = 1
                if _numDisplayedGroup[i] >= 6 & _iOrder_6[i] = 12 then _cutMigration = 1
                if _numDisplayedGroup[i] >= 7 & _iOrder_7[i] = 12 then _cutMigration = 1
                if _numDisplayedGroup[i] >= 8 & _iOrder_8[i] = 12 then _cutMigration = 1
                if _numDisplayedGroup[i] >= 9 & _iOrder_9[i] = 12 then _cutMigration = 1
                if _numDisplayedGroup[i] >= 10 & _iOrder_10[i] = 12 then _cutMigration = 1
                if _numDisplayedGroup[i] >= 11 & _iOrder_11[i] = 12 then _cutMigration = 1
                if _numDisplayedGroup[i] >= 12 & _iOrder_12[i] = 12 then _cutMigration = 1
                if _numDisplayedGroup[i] >= 13 & _iOrder_13[i] = 12 then _cutMigration = 1
                if _numDisplayedGroup[i] >= 14 & _iOrder_14[i] = 12 then _cutMigration = 1
            next i
		endif
        if _cutMigration = 0 then
            actualGUID = _endID
        else
            actualGUID = ""
        endif
	endif
	
return

