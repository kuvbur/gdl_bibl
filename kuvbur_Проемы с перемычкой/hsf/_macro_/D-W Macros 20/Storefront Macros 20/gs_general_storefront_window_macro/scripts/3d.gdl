
! Contact person: <SzL, NJ>

lod3D = 2

gs_fillFr		= gs_bFills * gs_fillFr
gs_penFr_fg		= gs_bFills * gs_penFr_fg
gs_penFr_bg		= gs_bFills * gs_penFr_bg

gs_gsect		= gs_bFills * gs_gsect
gs_penGlass_fg	= gs_bFills * gs_penGlass_fg
gs_penGlass_bg	= gs_bFills * gs_penGlass_bg

xpltp = 0
xprtp = 0
xpr = 0
xpl = 0

! =============================================================================
! GS Storefront Window Functions
! =============================================================================

call "GS Storefront Window Functions",
	parameters all	lod3D						= lod3D,
					bEnableVentilationProfile	= bEnableVentilationProfile,
					bEnableParapetInset			= bEnableParapetInset,
					bEnableMasonryArch			= bEnableMasonryArch,
					bEnableSill					= bEnableSill,
					bEnableBoard				= bEnableBoard,
					bEnableFaschen				= bEnableFaschen,
					bEnableThreshold			= bEnableThreshold,
					bEnableCasing				= bEnableCasing,
					bEnableShutter				= bEnableShutter,
					bEnableCustomCornerLeft		= bEnableCustomCornerLeft,
					bEnableCustomCornerRight	= bEnableCustomCornerRight,
				! --- Corner Functions
					bLeftCornerFunction	 		= gs_cl,
					leftCornerAngle		 		= leftCornerAngle,
					leftConnWallThk		 		= WALL_THICKNESS,
					bRightCornerFunction 		= gs_cr,
					rightCornerAngle	 		= rightCornerAngle,
					rightConnWallThk			= WALL_THICKNESS,
					gs_left_oversize			= gs_left_oversize - gs_cl * abs((gs_fthk)*TAN(90-leftCornerAngle/2)),
					gs_right_oversize			= gs_right_oversize - gs_cr * abs((gs_fthk)*TAN(90-rightCornerAngle/2)),
	returned_parameters	ac_unit_width,
						ac_unit_height,
						gs_frame_ovhg_left_out,
						gs_frame_ovhg_right_out,
						gs_frame_ovhg_top_out,
						gs_frame_ovhg_bottom_out,
						gs_frame_ovhg_left_in,
						gs_frame_ovhg_right_in,
						gs_frame_ovhg_top_in,
						gs_frame_ovhg_bottom_in,
						bMirrored,
						xform11, xform12, xform13, xform14,
						xform21, xform22, xform23, xform24,
						xform31, xform32, xform33, xform34,

						bShowAddHotspots, bShowAddHotspotsForIS, bShowUnitHotspots

if lod3D = 0 then end

xform	xform11, xform12, xform13, xform14,
		xform21, xform22, xform23, xform24,
		xform31, xform32, xform33, xform34
rotx 90

if (gs_cl | gs_cr) & WIDO_REVEAL_SIDE then
	leftCornerAngle = 360 - leftCornerAngle
	rightCornerAngle = 360 - rightCornerAngle
endif

!!! Butt Glazed !!!

gs_left_g  = 0
gs_right_g = 0

if iFrameStyleLeft <> FRAME_STYLE_VISIBLE_MULLIONS then
	if iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED OR iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED_WO_FRAME then gs_left_g=gs_fw_side_left
	if iFrameStyleLeft = FRAME_STYLE_ANGLE_FRAME AND leftCornerAngle<180 then
		gs_left_g=gs_fw_side_left-((gs_gsb+gs_glass_thk)*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2))
	endif
	if iFrameStyleLeft = FRAME_STYLE_ANGLE_FRAME AND leftCornerAngle>180 then
		gs_left_g=gs_fw_side_left+(gs_fthk-gs_gsb-gs_glass_thk)*TAN(90-leftCornerAngle/2)-(gs_frame_width/2)/SIN(180-leftCornerAngle/2)
	endif
endif
if iFrameStyleRight <> FRAME_STYLE_VISIBLE_MULLIONS then
	if iFrameStyleRight = FRAME_STYLE_BUTT_GLAZED OR iFrameStyleRight = FRAME_STYLE_BUTT_GLAZED_WO_FRAME then gs_right_g=gs_fw_side_right
	if iFrameStyleRight = FRAME_STYLE_ANGLE_FRAME AND rightCornerAngle<180 then
		gs_right_g=gs_fw_side_right-((gs_gsb+gs_glass_thk)*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2))
	endif
	if iFrameStyleRight = FRAME_STYLE_ANGLE_FRAME AND rightCornerAngle>180 then
		gs_right_g=gs_fw_side_right+(gs_fthk-gs_gsb-gs_glass_thk)*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(180-rightCornerAngle/2)
	endif
endif

!!! Butt Glazed END !!!

if gs_wthk then
	if WIDO_REVEAL_SIDE then
		addz -WALL_THICKNESS + WIDO_FRAME_THICKNESS + WIDO_SILL
	else
		addz -WIDO_SILL
	endif
endif

! =============================================================================
! Hotspots
! =============================================================================

unID=1

if gs_full_edit=1 then
	!! MIDDLE RAIL HEIGHT !!
	if bMiddleRail then
		hotspot ac_unit_width/2-gs_fw_side_right,  0, 0, unID, midRailElevation,1+128
		unID=unID+1
		hotspot ac_unit_width/2-gs_fw_side_right, -1, 0, unID, midRailElevation,3
		unID=unID+1
		hotspot ac_unit_width/2-gs_fw_side_right, midRailElevation, 0, unID, midRailElevation,2
		unID=unID+1
	else
		unID=unID+3
	endif

	!! TOP PANEL HEIGHT !!
	if gs_UTrans then
		hotspot (ac_unit_width/2-gs_fw_side_right)*gs_bSLight2+(-ac_unit_width/2+gs_fw_side_left)*(not(gs_bSLight2)),  ac_unit_height, 0, unID, transomHeight,1+128
		unID=unID+1
		hotspot (ac_unit_width/2-gs_fw_side_right)*gs_bSLight2+(-ac_unit_width/2+gs_fw_side_left)*(not(gs_bSLight2)), ac_unit_height+1, 0, unID, transomHeight,3
		unID=unID+1
		hotspot (ac_unit_width/2-gs_fw_side_right)*gs_bSLight2+(-ac_unit_width/2+gs_fw_side_left)*(not(gs_bSLight2)), ac_unit_height-transomHeight, 0, unID, transomHeight,2
		unID=unID+1
	else
		unID=unID+3
	endif

! First Panel Width ===========================================================
	if gs_bSLight then
		hotspot -ac_unit_width/2,  gs_fw_lower, 0, unID, gs_SLight_w,1+128
		unID=unID+1
		hotspot -ac_unit_width/2-1, gs_fw_lower, 0, unID, gs_SLight_w,3
		unID=unID+1
		hotspot -ac_unit_width/2+gs_SLight_w, gs_fw_lower, 0, unID, gs_SLight_w,2
		unID=unID+1
	else
		unID=unID + 3
	endif


! End Panel Width =============================================================

	if gs_bSLight2 then
		hotspot ac_unit_width/2,  gs_fw_lower, 0, unID, gs_SLight_w2,1+128
		unID=unID+1
		hotspot ac_unit_width/2+1, gs_fw_lower, 0, unID, gs_SLight_w2,3
		unID=unID+1
		hotspot ac_unit_width/2-gs_SLight_w2, gs_fw_lower, 0, unID, gs_SLight_w2,2
		unID=unID+1
	else
		unID=unID + 3
	endif

! Horizontal Grids ============================================================

	if gs_hor_gnum >0 then
		if bMiddleRail then
			for i=1 to gs_hor_gnum
				ADD  (iFrameStyleMullion = FRAME_STYLE_BUTT_GLAZED)*gs_fw_side_right, gs_fw_lower-gs_grid_w/2,0
				hotspot ac_unit_width/2-gs_fw_side_right,  0, 0, unID, gs_hor_d[i],1+128
				unID=unID+1
				hotspot ac_unit_width/2-gs_fw_side_right, -1, 0, unID, gs_hor_d[i],3
				unID=unID+1
				hotspot ac_unit_width/2-gs_fw_side_right, gs_hor_d[i], 0, unID, gs_hor_d[i],2
				unID=unID+1
				DEL 1
			next i
		endif
	else
		unID = unID + 3*gs_hor_gnum
	endif

! Horizontal Grids  ====================================================

	if gs_hor_gnumtr >0 then
		for i=1 to gs_hor_gnumtr
			ADD  (iFrameStyleMullion = FRAME_STYLE_BUTT_GLAZED)*gs_fw_side_right, ac_unit_height-gs_fw_upper-middlePanelHeight-gs_grid_w/2,0
			hotspot ac_unit_width/2-gs_fw_side_right,  0, 0, unID, gs_hor_dtr[i],1+128
			unID=unID+1
			hotspot ac_unit_width/2-gs_fw_side_right, -1, 0, unID, gs_hor_dtr[i],3
			unID=unID+1
			hotspot ac_unit_width/2-gs_fw_side_right, gs_hor_dtr[i], 0, unID, gs_hor_dtr[i],2
			unID=unID+1
			DEL 1
		next i
	else
		unID = unID + 3*gs_hor_gnumtr
	endif

! Horizontal Grids Transom ==================================================

	if gs_hor_gtp >0 and gs_UTrans then
		for i=1 to gs_hor_gtp
			ADD  (iFrameStyleMullion = FRAME_STYLE_BUTT_GLAZED)*gs_fw_side_right, ac_unit_height-topPanelHeight-gs_grid_w/2,0
			hotspot ac_unit_width/2-gs_fw_side_right,  0, 0, unID, gs_hor_dtp[i],1+128
			unID=unID+1
			hotspot ac_unit_width/2-gs_fw_side_right, -1, 0, unID, gs_hor_dtp[i],3
			unID=unID+1
			hotspot ac_unit_width/2-gs_fw_side_right, gs_hor_dtp[i], 0, unID, gs_hor_dtp[i],2
			unID=unID+1
			DEL 1
		next i
	else
		unID = unID + 3*gs_hor_gtp
	endif

! Vertica Grids ===============================================================
	if gs_ver_gnum >0 then
		for i=1 to gs_ver_gnum
			ADD -ac_unit_width/2+frameOrSLightWidthLeft-gridWidthVert/2, gs_fw_lower, 0
			hotspot 0,  0, 0, unID, gs_ver_d[i],1+128
			unID=unID+1
			hotspot -1, 0, 0, unID, gs_ver_d[i],3
			unID=unID+1
			hotspot gs_ver_d[i], 0, 0, unID, gs_ver_d[i],2
			unID=unID+1
			DEL 1
		next i
	else
		unID = unID + 3*gs_ver_gnum
	endif
endif

! =============================================================================
! Hotspots
! =============================================================================
! ------------------------------------------------------------------------------
! Unit hotspots
! ------------------------------------------------------------------------------

if bShowUnitHotspots then
	unID=100

	hotspot ac_unit_width/2, 0, 0, unID		:unID=unID+1
	hotspot -ac_unit_width/2, 0, 0, unID	:unID=unID+1
	hotspot ac_unit_width/2, 0, gs_frame_thk, unID		:unID=unID+1
	hotspot -ac_unit_width/2, 0, gs_frame_thk, unID	:unID=unID+1

	hotspot ac_unit_width/2, ac_unit_height, 0, unID		:unID=unID+1
	hotspot -ac_unit_width/2, ac_unit_height, 0, unID	:unID=unID+1
	hotspot ac_unit_width/2, ac_unit_height, gs_frame_thk, unID		:unID=unID+1
	hotspot -ac_unit_width/2, ac_unit_height, gs_frame_thk, unID

endif


! =============================================================================
! Draw Ventilation Profile
! =============================================================================

isVentilationOverFrame = (bEnableVentilationProfile & bVentilationProfile & (iVentilationProfileType = VENTPROFILE_OVER_FRAME))

if isVentilationOverFrame then
	addy ac_unit_height
	if WIDO_REVEAL_SIDE then
		addz gs_fthk
		mulz -1
	endif
	call "Ventilation_profile" parameters	A							= ac_unit_width,
											VentilationProfileThickness	= VentilationProfileThickness,
											VentilationProfileHeight	= VentilationProfileHeight,
											gs_frame_thk				= gs_fthk,
											bVentilationProfile			= bVentilationProfile,
											iVentilationProfileType		= iVentilationProfileType,
											gs_ventProfile_pen			= gs_frame_pen,
											gs_ventProfile_pen_cont		= gs_frame_pen,
											gs_ventProfile_fill			= gs_ventProfile_fill,
											gs_ventProfile_pen_bg		= gs_ventProfile_pen_bg,
											gs_ventProfile_pen_fg		= gs_ventProfile_pen_fg,
											gs_ventProfile_mat			= gs_ventProfile_mat
	if WIDO_REVEAL_SIDE then del 2
	del 1
endif


! =============================================================================
! Frame
! =============================================================================

pen gs_frame_pen
material gs_frame_mat

frameleftout	= -ac_unit_width/2 - gs_frame_ovhg_left_out
framerightout	= ac_unit_width/2 + gs_frame_ovhg_right_out
frameleftin		= -ac_unit_width/2 - gs_frame_ovhg_left_in
framerightin	= ac_unit_width/2 + gs_frame_ovhg_right_in
frametopin		= ac_unit_height + gs_frame_ovhg_top_in
frametopout		= ac_unit_height + gs_frame_ovhg_top_out
framebottomout	= -gs_frame_ovhg_bottom_out
framebottomin	= -gs_frame_ovhg_bottom_in

leftFrame = -ac_unit_width/2
if (abs(gs_tolerance_left) > EPS) then
	leftFrame = frameleftout
	if abs(frameleftout) > abs(frameleftin) then
		leftFrame = frameleftin
	endif
endif

rightFrame = ac_unit_width/2
if (abs(gs_tolerance_right) > EPS) then
	rightFrame = framerightout
	if abs(framerightout) > abs(framerightin) then
		rightFrame = framerightin
	endif
endif

topFrame = ac_unit_height
if (abs(gs_tolerance_upper) > EPS) | isVentilationOverFrame then
	topFrame = frametopout
	if  abs(frametopout) > abs(frametopin) then
		topFrame = frametopin
	endif
endif

bottomFrame = 0
if (abs(gs_tolerance_lower) > EPS) then
	bottomFrame = framebottomout
	if  abs(framebottomout) > abs(framebottomin) then
		bottomFrame = framebottomin
	endif
endif

GROUP "frame"

! Cut Ventilation Profile =====================================================

if isVentilationOverFrame then
	addy ac_unit_height
	cutpolya 5, 2, 0,
		-ac_unit_width/2, 0, 11+3*(WIDO_REVEAL_SIDE),
		-ac_unit_width/2, VentilationProfileHeight, 11+3*(WIDO_REVEAL_SIDE),
		ac_unit_width/2, VentilationProfileHeight, 11+3*(WIDO_REVEAL_SIDE),
		ac_unit_width/2, 0, 11+3*(WIDO_REVEAL_SIDE),
		-ac_unit_width/2, 0, -1
	del 1
endif


sect_fill gs_fillFr, gs_penFr_bg, gs_penFr_fg, gs_frame_pen

! Corner ======================================================================

if gs_cl AND leftCornerAngle<180 then
	ADDX -ac_unit_width/2
	ROTY -leftCornerAngle/2
		CUTPLANE
	DEL 2
endif

if gs_cl AND leftCornerAngle>180 then
	ADD -ac_unit_width/2-WIDO_REVEAL_SIDE*gs_fthk*TAN(90-leftCornerAngle/2), 0, (1-WIDO_REVEAL_SIDE)*gs_fthk
	ROTY -leftCornerAngle/2
	CUTPLANE
	DEL 2
endif

if gs_cr AND rightCornerAngle<180 then
	ADDX ac_unit_width/2
	ROTY rightCornerAngle/2
	CUTPLANE
	DEL 2
endif

if gs_cr AND rightCornerAngle>180 then
	ADD ac_unit_width/2+WIDO_REVEAL_SIDE*gs_fthk*TAN(90-rightCornerAngle/2), 0, (1-WIDO_REVEAL_SIDE)*gs_fthk
	ROTY rightCornerAngle/2
	CUTPLANE
	DEL 2
endif


! Butt Glazed =================================================================

if bMiddleRail then
	if iFrameStyleRight = FRAME_STYLE_BUTT_GLAZED then
		CUTFORM 5, 1, 1+2,
			 0, 0, 1, gs_gsb+gs_glass_thk,
			ac_unit_width/2,         gs_fw_lower, 2+8+16,
			(ac_unit_width/2-rightPanelWidth)*(gs_bSLight2),  gs_fw_lower,  2+8+16,
			(ac_unit_width/2-rightPanelWidth)*(gs_bSLight2), midRailElevation+midRailWidth/2, 2+8+16,
			ac_unit_width/2, midRailElevation+midRailWidth/2,  2+8+16,
			ac_unit_width/2,         gs_fw_lower,  -1
	endif

	if iFrameStyleRight = FRAME_STYLE_BUTT_GLAZED AND gs_cr AND rightCornerAngle<180 then
		ROTX 90
		ADDZ -gs_fw_lower
		CUTFORM 5, 1, 1+2,
			0,0,1, -(midRailElevation+midRailWidth/2-gs_fw_lower),
			ac_unit_width/2-gs_fw_side_right-(gs_fthk*TAN(90-rightCornerAngle/2)+(gs_ffwidth/2)/SIN(rightCornerAngle/2)-gs_fw_side_right)*(rightCornerAngle<60), 0, 1+2+4+8+16+64,
			ac_unit_width/2-(gs_frame_width/2)/SIN(rightCornerAngle/2), 0,     1+2+4+8+16+64,
			ac_unit_width/2-gs_fthk*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(rightCornerAngle/2), gs_fthk,      1+2+4+8+16+64,
			ac_unit_width/2-gs_fw_side_right-(gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)-gs_fw_side_right)*(rightCornerAngle<60), gs_fthk, 1+2+4+8+16+64,
			ac_unit_width/2-gs_fw_side_right-(gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)-gs_fw_side_right)*(rightCornerAngle<60), 0,      -1
		DEL 2
		xpr=gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)
	endif

	if iFrameStyleRight = FRAME_STYLE_BUTT_GLAZED_WO_FRAME AND gs_cr then
		ROTX 90
		ADDZ -gs_fw_lower
		CUTFORM 5, 1, 1+2,
			0,0,1, -(midRailElevation+midRailWidth/2-gs_fw_lower),
			ac_unit_width/2-gs_fw_side_right, 0, 1+2+4+8+16,
			ac_unit_width/2, 0,     1+2+4+8+16,
			ac_unit_width/2, gs_fthk,      1+2+4+8+16,
			ac_unit_width/2-gs_fw_side_right, gs_fthk, 1+2+4+8+16,
			ac_unit_width/2-gs_fw_side_right, 0,      -1
		DEL 2
		xpr=0
	endif

	if iFrameStyleRight = FRAME_STYLE_ANGLE_FRAME AND gs_cr AND rightCornerAngle<180 then
		ROTX 90
		ADDZ -gs_fw_lower
		lin_ ac_unit_width/2-(gs_gsb+gs_glass_thk)*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(rightCornerAngle/2), 0, 0, \
			ac_unit_width/2-gs_fw_side_right-(gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)-gs_fw_side_right)*(rightCornerAngle<60), 0, 0
		lin_ ac_unit_width/2-gs_fthk*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(rightCornerAngle/2), gs_fthk, 0, \
			ac_unit_width/2-gs_fw_side_right-(gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)-gs_fw_side_right)*(rightCornerAngle<60), gs_fthk, 0

		CUTFORM 6, 1, 1+2,
			0,0,1, -(midRailElevation+midRailWidth/2-gs_fw_lower),
			ac_unit_width/2-gs_fw_side_right-(gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)-gs_fw_side_right)*(rightCornerAngle<60), 0, 31,
			ac_unit_width/2-(gs_gsb+gs_glass_thk)*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(rightCornerAngle/2), 0,     31,
			ac_unit_width/2-(gs_gsb+gs_glass_thk)*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(rightCornerAngle/2), (gs_gsb+gs_glass_thk),     31,
			ac_unit_width/2-gs_fthk*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(rightCornerAngle/2), gs_fthk,      31,
			ac_unit_width/2-gs_fw_side_right-(gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)-gs_fw_side_right)*(rightCornerAngle<60), gs_fthk, 31,
			ac_unit_width/2-gs_fw_side_right-(gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)-gs_fw_side_right)*(rightCornerAngle<60), 0,      -1
		DEL 2
		xpr=gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)
	endif

	if iFrameStyleRight = FRAME_STYLE_BUTT_GLAZED AND gs_cr AND rightCornerAngle>180 then
		ROTX 90
		ADDZ -gs_fw_lower
		CUTFORM 5, 1, 1+2,
			0,0,1, -(midRailElevation+midRailWidth/2-gs_fw_lower),
			ac_unit_width/2-gs_fw_side_right, 0,      95,
			ac_unit_width/2+gs_fthk*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(180-rightCornerAngle/2), 0,    95,
			ac_unit_width/2-(gs_frame_width/2)/SIN(180-rightCornerAngle/2), gs_fthk,      95,
			ac_unit_width/2-gs_fw_side_right, gs_fthk,     95,
			ac_unit_width/2-gs_fw_side_right, 0,      -1
		DEL 2
		xpr=-gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)
	endif

	if iFrameStyleRight = FRAME_STYLE_ANGLE_FRAME AND gs_cr AND rightCornerAngle>180 then
		ROTX 90
		ADDZ -gs_fw_lower
		lin_ ac_unit_width/2-gs_fw_side_right, 0, 0, ac_unit_width/2+(gs_fthk-gs_gsb-gs_glass_thk)*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(180-rightCornerAngle/2), 0, 0
		lin_ ac_unit_width/2-(gs_frame_width/2)/SIN(180-rightCornerAngle/2), gs_fthk, 0, ac_unit_width/2-gs_fw_side_right, gs_fthk, 0

		CUTFORM 6, 1, 1+2,
			0,0,1, -(midRailElevation+midRailWidth/2-gs_fw_lower),
			ac_unit_width/2-gs_fw_side_right, 0,      31,
			ac_unit_width/2+(gs_fthk-gs_gsb-gs_glass_thk)*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(180-rightCornerAngle/2), 0,    31,
			ac_unit_width/2+(gs_fthk-gs_gsb-gs_glass_thk)*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(180-rightCornerAngle/2), (gs_gsb+gs_glass_thk),    31,
			ac_unit_width/2-(gs_frame_width/2)/SIN(180-rightCornerAngle/2), gs_fthk,      31,
			ac_unit_width/2-gs_fw_side_right, gs_fthk,     31,
			ac_unit_width/2-gs_fw_side_right, 0,      -1
		DEL 2
		xpr=-gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)
	endif

	if iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED then
		CUTFORM 5, 1, 1+2,
			0, 0, 1, gs_gsb+gs_glass_thk,
			-ac_unit_width/2,         gs_fw_lower,  2+8+16,
			(-ac_unit_width/2+leftPanelWidth)*(gs_bSLight),  gs_fw_lower,  2+8+16,
			(-ac_unit_width/2+leftPanelWidth)*(gs_bSLight), midRailElevation+midRailWidth/2,  2+8+16,
			-ac_unit_width/2, midRailElevation+midRailWidth/2, 2+8+16,
			-ac_unit_width/2,         gs_fw_lower,  -1
	endif

	if iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED AND gs_cl AND leftCornerAngle<180 then
		ROTX 90
		ADDZ -gs_fw_lower
		CUTFORM 5, 1, 1+2,
			0,0,1, -(midRailElevation+midRailWidth/2-gs_fw_lower),
			-ac_unit_width/2+(gs_frame_width/2)/SIN(leftCornerAngle/2),0,95,
			-ac_unit_width/2+gs_fw_side_left+(gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)-gs_fw_side_left)*(leftCornerAngle<60),0,95,
			-ac_unit_width/2+gs_fw_side_left+(gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)-gs_fw_side_left)*(leftCornerAngle<60), gs_fthk,95,
			-ac_unit_width/2+gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2),gs_fthk,95,
			-ac_unit_width/2+(gs_frame_width/2)/SIN(leftCornerAngle/2),0,-1
		DEL 2
		xpl=gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)
	endif

	if iFrameStyleLeft = FRAME_STYLE_ANGLE_FRAME AND gs_cl AND leftCornerAngle<180 then
		ROTX 90
		ADDZ -gs_fw_lower
		lin_ -ac_unit_width/2+(gs_gsb+gs_glass_thk)*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), 0, 0,\
			 -ac_unit_width/2+gs_fw_side_left+(gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)-gs_fw_side_left)*(leftCornerAngle<60), 0, 0
		lin_ -ac_unit_width/2+gs_fw_side_left+(gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)-gs_fw_side_left)*(leftCornerAngle<60), \
			gs_fthk, 0, -ac_unit_width/2+gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), gs_fthk, 0

		CUTFORM 6, 1, 1+2,
			0,0,1, -(midRailElevation+midRailWidth/2-gs_fw_lower),
			-ac_unit_width/2+(gs_gsb+gs_glass_thk)*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), gs_gsb+gs_glass_thk,31,
			-ac_unit_width/2+(gs_gsb+gs_glass_thk)*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), 0,31,
			-ac_unit_width/2+gs_fw_side_left+(gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)-gs_fw_side_left)*(leftCornerAngle<60),0,31,
			-ac_unit_width/2+gs_fw_side_left+(gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)-gs_fw_side_left)*(leftCornerAngle<60), gs_fthk,31,
			-ac_unit_width/2+gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2),gs_fthk,31,
			-ac_unit_width/2+(gs_gsb+gs_glass_thk)*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), gs_gsb+gs_glass_thk,-1
		DEL 2
		xpl=gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)
	endif

	if iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED AND gs_cl AND leftCornerAngle >180 then
		ROTX 90
		ADDZ -gs_fw_lower
		CUTFORM 5, 1, 1+2,
			0,0,1, -(midRailElevation+midRailWidth/2-gs_fw_lower),
			-ac_unit_width/2+gs_fthk*TAN(90+leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), 0, 95,
			-ac_unit_width/2+gs_fw_side_left, 0, 95,
			-ac_unit_width/2+gs_fw_side_left, gs_fthk, 95,
			-ac_unit_width/2+(gs_frame_width/2)/SIN(leftCornerAngle/2), gs_fthk, 95,
			-ac_unit_width/2+gs_fthk*TAN(90+leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), 0, -1
		DEL 2
		xpl=-gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)
	endif

	if iFrameStyleLeft = FRAME_STYLE_ANGLE_FRAME AND gs_cl AND leftCornerAngle >180 then
		ROTX 90
		ADDZ -gs_fw_lower
		lin_ -ac_unit_width/2+(gs_fthk-gs_gsb-gs_glass_thk)*TAN(90+leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), 0, 0, -ac_unit_width/2+gs_fw_side_left, 0, 0
		lin_ -ac_unit_width/2+gs_fw_side_left, gs_fthk, 0, -ac_unit_width/2+(gs_frame_width/2)/SIN(leftCornerAngle/2), gs_fthk, 0

		CUTFORM 6, 1, 1+2,
			0,0,1, -(midRailElevation+midRailWidth/2-gs_fw_lower),
			-ac_unit_width/2+(gs_fthk-gs_gsb-gs_glass_thk)*TAN(90+leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), 0, 31,
			-ac_unit_width/2+gs_fw_side_left, 0, 31,
			-ac_unit_width/2+gs_fw_side_left, gs_fthk, 31,
			-ac_unit_width/2+(gs_frame_width/2)/SIN(leftCornerAngle/2), gs_fthk, 31,
			-ac_unit_width/2+(gs_fthk-gs_gsb-gs_glass_thk)*TAN(90+leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), gs_gsb+gs_glass_thk, 31,
			-ac_unit_width/2+(gs_fthk-gs_gsb-gs_glass_thk)*TAN(90+leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), 0, -1
		DEL 2
		xpl=-gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)
	endif

	if iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED_WO_FRAME AND gs_cl then
		ROTX 90
		ADDZ -gs_fw_lower
		CUTFORM 5, 1, 1+2,
			0,0,1, -(midRailElevation+midRailWidth/2-gs_fw_lower),
			-ac_unit_width/2+gs_fw_side_left, 0, 1+2+4+8+16,
			-ac_unit_width/2, 0,     1+2+4+8+16,
			-ac_unit_width/2, gs_fthk,      1+2+4+8+16,
			-ac_unit_width/2+gs_fw_side_left, gs_fthk, 1+2+4+8+16,
			-ac_unit_width/2+gs_fw_side_left, 0,      -1
		DEL 2
		xpl=0
	endif
endif


! Butt Glazed of Transom ======================================================

if iFrameStyleRight = FRAME_STYLE_BUTT_GLAZED then
	CUTFORM 5, 1, 1+2,
		0, 0, 1, gs_gsb+gs_glass_thk,
		ac_unit_width/2, ac_unit_height-frameOrTransomHeight, 2+8+16,
		(ac_unit_width/2-rightPanelWidth)*(gs_bSLight2), ac_unit_height-frameOrTransomHeight,  2+8+16,
		(ac_unit_width/2-rightPanelWidth)*(gs_bSLight2),(midRailElevation)*bMiddleRail+midRailWidth/2,  2+8+16,
		ac_unit_width/2, (midRailElevation)*bMiddleRail+midRailWidth/2,  2+8+16,
		ac_unit_width/2, ac_unit_height-frameOrTransomHeight,  -1
endif

if iFrameStyleRight = FRAME_STYLE_BUTT_GLAZED AND gs_cr AND rightCornerAngle<180 then
	ROTX 90
	ADDZ -ac_unit_height+frameOrTransomHeight
	CUTFORM 5, 1, 1+2,
		0,0,1, ac_unit_height-frameOrTransomHeight-midRailElevation*bMiddleRail-midRailWidth/2,
		ac_unit_width/2-gs_fw_side_right-(gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)-gs_fw_side_right)*(rightCornerAngle<60), 0,     95,
		ac_unit_width/2-(gs_frame_width/2)/SIN(rightCornerAngle/2), 0,     95,
		ac_unit_width/2-gs_fthk*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(rightCornerAngle/2), gs_fthk,      95,
		ac_unit_width/2-gs_fw_side_right-(gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)-gs_fw_side_right)*(rightCornerAngle<60), gs_fthk,      95,
		ac_unit_width/2-gs_fw_side_right-(gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)-gs_fw_side_right)*(rightCornerAngle<60), 0,      -1
	DEL 2
	xprtr=gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)
endif

if iFrameStyleRight = FRAME_STYLE_ANGLE_FRAME AND gs_cr AND rightCornerAngle<180 then
	ROTX 90
	ADDZ -ac_unit_height+frameOrTransomHeight
	lin_ ac_unit_width/2-gs_fw_side_right-(gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)-gs_fw_side_right)*(rightCornerAngle<60), 0, 0,\
		 ac_unit_width/2-(gs_gsb+gs_glass_thk)*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(rightCornerAngle/2), 0, 0
	lin_ ac_unit_width/2-gs_fthk*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(rightCornerAngle/2), gs_fthk, 0, \
		 ac_unit_width/2-gs_fw_side_right-(gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)-gs_fw_side_right)*(rightCornerAngle<60), gs_fthk, 0

	ADDZ ac_unit_height-frameOrTransomHeight-midRailElevation*bMiddleRail-midRailWidth/2
	lin_ ac_unit_width/2-gs_fw_side_right-(gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)-gs_fw_side_right)*(rightCornerAngle<60), 0, 0, \
		 ac_unit_width/2-(gs_gsb+gs_glass_thk)*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(rightCornerAngle/2), 0, 0
	lin_ ac_unit_width/2-gs_fthk*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(rightCornerAngle/2), gs_fthk, 0, \
		 ac_unit_width/2-gs_fw_side_right-(gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)-gs_fw_side_right)*(rightCornerAngle<60), gs_fthk, 0
	DEL 1

	CUTFORM 6, 1, 1+2,
		0,0,1, ac_unit_height-frameOrTransomHeight-midRailElevation*bMiddleRail-midRailWidth/2,
		ac_unit_width/2-gs_fw_side_right-(gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)-gs_fw_side_right)*(rightCornerAngle<60), 0, 1+2+4+8+16,
		ac_unit_width/2-(gs_gsb+gs_glass_thk)*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(rightCornerAngle/2), 0,     1+2+4+8+16,
		ac_unit_width/2-(gs_gsb+gs_glass_thk)*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(rightCornerAngle/2), (gs_gsb+gs_glass_thk),     1+2+4+8+16,
		ac_unit_width/2-gs_fthk*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(rightCornerAngle/2), gs_fthk,      1+2+4+8+16,
		ac_unit_width/2-gs_fw_side_right-(gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)-gs_fw_side_right)*(rightCornerAngle<60), gs_fthk, 1+2+4+8+16,
		ac_unit_width/2-gs_fw_side_right-(gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)-gs_fw_side_right)*(rightCornerAngle<60), 0,      -1
	DEL 2
	xprtr=gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)
endif

if iFrameStyleRight = FRAME_STYLE_BUTT_GLAZED AND gs_cr AND rightCornerAngle >180 then
	ROTX 90
	ADDZ -ac_unit_height+frameOrTransomHeight
	CUTFORM 5, 1, 1+2,
		0,0,1, ac_unit_height-frameOrTransomHeight-midRailElevation*bMiddleRail-midRailWidth/2,
		ac_unit_width/2-gs_fw_side_right, 0,      95,
		ac_unit_width/2+gs_fthk*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(180-rightCornerAngle/2), 0,    95,
		ac_unit_width/2-(gs_frame_width/2)/SIN(180-rightCornerAngle/2), gs_fthk,      95,
		ac_unit_width/2-gs_fw_side_right,gs_fthk,     95,
		ac_unit_width/2-gs_fw_side_right, 0,      -1
	DEL 2
	xprtr=-gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)
endif

if iFrameStyleRight = FRAME_STYLE_ANGLE_FRAME AND gs_cr AND rightCornerAngle>180 then
	ROTX 90
	ADDZ -ac_unit_height+frameOrTransomHeight
	lin_ ac_unit_width/2-gs_fw_side_right, 0, 0, ac_unit_width/2+(gs_fthk-gs_gsb-gs_glass_thk)*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(180-rightCornerAngle/2), 0, 0
	lin_ ac_unit_width/2-(gs_frame_width/2)/SIN(180-rightCornerAngle/2), gs_fthk, 0, ac_unit_width/2-gs_fw_side_right, gs_fthk, 0

	ADDZ ac_unit_height-frameOrTransomHeight-midRailElevation*bMiddleRail-midRailWidth/2
	lin_ ac_unit_width/2-gs_fw_side_right, 0, 0, ac_unit_width/2+(gs_fthk-gs_gsb-gs_glass_thk)*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(180-rightCornerAngle/2), 0, 0
	lin_ ac_unit_width/2-(gs_frame_width/2)/SIN(180-rightCornerAngle/2), gs_fthk, 0, ac_unit_width/2-gs_fw_side_right, gs_fthk, 0
	DEL 1

	CUTFORM 6, 1, 1+2,
		0,0,1, ac_unit_height-frameOrTransomHeight-midRailElevation*bMiddleRail-midRailWidth/2,
		ac_unit_width/2-gs_fw_side_right, 0,      31,
		ac_unit_width/2+(gs_fthk-gs_gsb-gs_glass_thk)*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(180-rightCornerAngle/2), 0,    31,
		ac_unit_width/2+(gs_fthk-gs_gsb-gs_glass_thk)*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(180-rightCornerAngle/2), (gs_gsb+gs_glass_thk),    31,
		ac_unit_width/2-(gs_frame_width/2)/SIN(180-rightCornerAngle/2), gs_fthk,      31,
		ac_unit_width/2-gs_fw_side_right, gs_fthk,     31,
		ac_unit_width/2-gs_fw_side_right, 0,      -1
	DEL 2
	xprtr=-gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)
endif

if iFrameStyleRight = FRAME_STYLE_BUTT_GLAZED_WO_FRAME AND gs_cr then
	ROTX 90
	ADDZ -ac_unit_height+frameOrTransomHeight
	CUTFORM 5, 1, 1+2,
		0,0,1, ac_unit_height-frameOrTransomHeight-midRailElevation*bMiddleRail-midRailWidth/2,
		ac_unit_width/2-gs_fw_side_right, 0, 1+2+4+8+16,
		ac_unit_width/2, 0,     1+2+4+8+16,
		ac_unit_width/2, gs_fthk,      1+2+4+8+16,
		ac_unit_width/2-gs_fw_side_right, gs_fthk, 1+2+4+8+16,
		ac_unit_width/2-gs_fw_side_right, 0,      -1
	DEL 2
	xprtr=0
endif

if iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED then
	CUTFORM 5, 1, 1+2,
		 0, 0, 1, gs_gsb+gs_glass_thk,
		-ac_unit_width/2, ac_unit_height-frameOrTransomHeight, 2+8+16,
		(-ac_unit_width/2+leftPanelWidth)*(gs_bSLight), ac_unit_height-frameOrTransomHeight,  2+8+16,
		(-ac_unit_width/2+leftPanelWidth)*(gs_bSLight), midRailElevation*bMiddleRail+midRailWidth/2,  2+8+16,
		-ac_unit_width/2, midRailElevation*bMiddleRail+midRailWidth/2,  2+8+16,
		-ac_unit_width/2, ac_unit_height-frameOrTransomHeight,  -1
endif

if iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED AND gs_cl AND leftCornerAngle<180 then
	ROTX 90
	ADDZ -ac_unit_height+frameOrTransomHeight
	CUTFORM 5, 1, 1+2,
		0,0,1, ac_unit_height-frameOrTransomHeight-(midRailElevation)*bMiddleRail-midRailWidth/2,
		-ac_unit_width/2+(gs_frame_width/2)/SIN(leftCornerAngle/2),0,95,
		-ac_unit_width/2+gs_fw_side_left+(gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)-gs_fw_side_left)*(leftCornerAngle<60),0,95,
		-ac_unit_width/2+gs_fw_side_left+(gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)-gs_fw_side_left)*(leftCornerAngle<60), gs_fthk,95,
		-ac_unit_width/2+gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2),gs_fthk,95,
		-ac_unit_width/2+(gs_frame_width/2)/SIN(leftCornerAngle/2),0,-1
	DEL 2
	xpltr=gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)
endif

if iFrameStyleLeft = FRAME_STYLE_ANGLE_FRAME AND gs_cl AND leftCornerAngle<180 then
	ROTX 90
	ADDZ -ac_unit_height+frameOrTransomHeight
	lin_ -ac_unit_width/2+(gs_gsb+gs_glass_thk)*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), 0, 0, \
		 -ac_unit_width/2+gs_fw_side_left+(gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)-gs_fw_side_left)*(leftCornerAngle<60), 0, 0
	lin_ -ac_unit_width/2+gs_fw_side_left+(gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)-gs_fw_side_left)*(leftCornerAngle<60), \
		 gs_fthk, 0, -ac_unit_width/2+gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), gs_fthk, 0

	ADDZ ac_unit_height-frameOrTransomHeight-(midRailElevation)*bMiddleRail-midRailWidth/2
	lin_ -ac_unit_width/2+(gs_gsb+gs_glass_thk)*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), 0, 0, \
		 -ac_unit_width/2+gs_fw_side_left+(gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)-gs_fw_side_left)*(leftCornerAngle<60), 0, 0
	lin_ -ac_unit_width/2+gs_fw_side_left+(gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)-gs_fw_side_left)*(leftCornerAngle<60), \
		 gs_fthk, 0, -ac_unit_width/2+gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), gs_fthk, 0
	DEL 1

	CUTFORM 6, 1, 1+2,
		0,0,1, ac_unit_height-frameOrTransomHeight-(midRailElevation)*bMiddleRail-midRailWidth/2,
		-ac_unit_width/2+(gs_gsb+gs_glass_thk)*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), gs_gsb+gs_glass_thk,31,
		-ac_unit_width/2+(gs_gsb+gs_glass_thk)*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), 0,31,
		-ac_unit_width/2+gs_fw_side_left+(gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)-gs_fw_side_left)*(leftCornerAngle<60),0,31,
		-ac_unit_width/2+gs_fw_side_left+(gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)-gs_fw_side_left)*(leftCornerAngle<60), gs_fthk,31,
		-ac_unit_width/2+gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2),gs_fthk, 31,
		-ac_unit_width/2+(gs_gsb+gs_glass_thk)*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), gs_gsb+gs_glass_thk,-1
	DEL 2
	xpltr=gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)
endif

if iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED AND gs_cl AND leftCornerAngle >180 then
	ROTX 90
	ADDZ -ac_unit_height+frameOrTransomHeight
	CUTFORM 5, 1, 1+2,
		0,0,1, ac_unit_height-frameOrTransomHeight-(midRailElevation)*bMiddleRail-midRailWidth/2,
		-ac_unit_width/2+gs_fthk*TAN(90+leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), 0, 95,
		-ac_unit_width/2+gs_fw_side_left, 0, 95,
		-ac_unit_width/2+gs_fw_side_left, gs_fthk, 95,
		-ac_unit_width/2+(gs_frame_width/2)/SIN(leftCornerAngle/2), gs_fthk, 95,
		-ac_unit_width/2+gs_fthk*TAN(90+leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), 0, -1
	DEL 2
	xpltr=-gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)
endif

if iFrameStyleLeft = FRAME_STYLE_ANGLE_FRAME AND gs_cl AND leftCornerAngle >180 then
	ROTX 90
	ADDZ -ac_unit_height+frameOrTransomHeight
	lin_ -ac_unit_width/2+(gs_fthk-gs_gsb-gs_glass_thk)*TAN(90+leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), 0, 0, -ac_unit_width/2+gs_fw_side_left, 0, 0
	lin_ -ac_unit_width/2+gs_fw_side_left, gs_fthk, 0, -ac_unit_width/2+(gs_frame_width/2)/SIN(leftCornerAngle/2), gs_fthk, 0

	ADDZ ac_unit_height-frameOrTransomHeight-(midRailElevation)*bMiddleRail-midRailWidth/2
	lin_ -ac_unit_width/2+(gs_fthk-gs_gsb-gs_glass_thk)*TAN(90+leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), 0, 0, -ac_unit_width/2+gs_fw_side_left, 0, 0
	lin_ -ac_unit_width/2+gs_fw_side_left, gs_fthk, 0, -ac_unit_width/2+(gs_frame_width/2)/SIN(leftCornerAngle/2), gs_fthk, 0
	DEL 1

	CUTFORM 6, 1, 1+2,
		0,0,1, ac_unit_height-frameOrTransomHeight-(midRailElevation)*bMiddleRail-midRailWidth/2,
		-ac_unit_width/2+(gs_fthk-gs_gsb-gs_glass_thk)*TAN(90+leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), 0, 31,
		-ac_unit_width/2+gs_fw_side_left, 0, 31,
		-ac_unit_width/2+gs_fw_side_left, gs_fthk, 31,
		-ac_unit_width/2+(gs_frame_width/2)/SIN(leftCornerAngle/2), gs_fthk, 31,
		-ac_unit_width/2+(gs_fthk-gs_gsb-gs_glass_thk)*TAN(90+leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), gs_gsb+gs_glass_thk, 31,
		-ac_unit_width/2+(gs_fthk-gs_gsb-gs_glass_thk)*TAN(90+leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), 0, -1
	DEL 2
	xpltr=-gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)
endif

if iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED_WO_FRAME AND gs_cl then
	ROTX 90
	ADDZ -ac_unit_height+frameOrTransomHeight
	CUTFORM 5, 1, 1+2,
		0,0,1, ac_unit_height-frameOrTransomHeight-(midRailElevation)*bMiddleRail-midRailWidth/2,
		-ac_unit_width/2+gs_fw_side_left, 0, 1+2+4+8+16,
		-ac_unit_width/2, 0,     1+2+4+8+16,
		-ac_unit_width/2, gs_fthk,      1+2+4+8+16,
		-ac_unit_width/2+gs_fw_side_left, gs_fthk, 1+2+4+8+16,
		-ac_unit_width/2+gs_fw_side_left, 0,      -1
	DEL 2
	xpltr=0
endif


! Top Panel ===================================================================

if iFrameStyleRight = FRAME_STYLE_BUTT_GLAZED AND gs_UTrans then
	CUTFORM 5, 1, 1+2,
		0, 0, 1, gs_gsb+gs_glass_thk,
		ac_unit_width/2, ac_unit_height-topPanelHeight,  2+8+16,
		(ac_unit_width/2-rightPanelWidth)*(gs_bSLight2), ac_unit_height-topPanelHeight, 2+8+16,
		(ac_unit_width/2-rightPanelWidth)*(gs_bSLight2), ac_unit_height-gs_fw_upper, 2+8+16,
		ac_unit_width/2, ac_unit_height-gs_fw_upper, 2+8+16,
		ac_unit_width/2, ac_unit_height-topPanelHeight,  -1
endif

if iFrameStyleRight = FRAME_STYLE_BUTT_GLAZED AND gs_UTrans AND gs_cr AND rightCornerAngle<180 then
	ROTX 90
	ADDZ -ac_unit_height+gs_fw_upper
	CUTFORM 5, 1, 1+2,
			0,0,1, topPanelHeight-gs_fw_upper,
			ac_unit_width/2-gs_fw_side_right-(gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)-gs_fw_side_right)*(rightCornerAngle<60), 0,     95,
			ac_unit_width/2-(gs_frame_width/2)/SIN(rightCornerAngle/2), 0,     95,
			ac_unit_width/2-gs_fthk*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(rightCornerAngle/2), gs_fthk,      95,
			ac_unit_width/2-gs_fw_side_right-(gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)-gs_fw_side_right)*(rightCornerAngle<60),gs_fthk,      95,
			ac_unit_width/2-gs_fw_side_right-(gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)-gs_fw_side_right)*(rightCornerAngle<60), 0,      -1
	DEL 2
	xprtp=gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)
endif

if iFrameStyleRight = FRAME_STYLE_ANGLE_FRAME AND gs_UTrans AND gs_cr AND rightCornerAngle<180 then
	ROTX 90
	ADDZ -ac_unit_height+gs_fw_upper
	lin_ ac_unit_width/2-gs_fw_side_right-(gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)-gs_fw_side_right)*(rightCornerAngle<60), 0, 0, \
		 ac_unit_width/2-(gs_gsb+gs_glass_thk)*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(rightCornerAngle/2), 0, 0
	lin_ ac_unit_width/2-gs_fthk*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(rightCornerAngle/2), gs_fthk, 0, \
		 ac_unit_width/2-gs_fw_side_right-(gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)-gs_fw_side_right)*(rightCornerAngle<60), gs_fthk, 0

	CUTFORM 6, 1, 1+2,
		0,0,1, topPanelHeight-gs_fw_upper,
		ac_unit_width/2-gs_fw_side_right-(gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)-gs_fw_side_right)*(rightCornerAngle<60), 0, 1+2+4+8+16,
		ac_unit_width/2-(gs_gsb+gs_glass_thk)*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(rightCornerAngle/2), 0,     1+2+4+8+16,
		ac_unit_width/2-(gs_gsb+gs_glass_thk)*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(rightCornerAngle/2), (gs_gsb+gs_glass_thk),     1+2+4+8+16,
		ac_unit_width/2-gs_fthk*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(rightCornerAngle/2), gs_fthk,      1+2+4+8+16,
		ac_unit_width/2-gs_fw_side_right-(gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)-gs_fw_side_right)*(rightCornerAngle<60), gs_fthk, 1+2+4+8+16,
		ac_unit_width/2-gs_fw_side_right-(gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)-gs_fw_side_right)*(rightCornerAngle<60), 0,      -1

	DEL 2
	xprtp=gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)
endif

if iFrameStyleRight = FRAME_STYLE_BUTT_GLAZED AND gs_UTrans AND gs_cr=1 AND rightCornerAngle>180 then
	ROTX 90
	ADDZ -ac_unit_height+gs_fw_upper
		CUTFORM 5, 1, 1+2,
			0,0,1, topPanelHeight-gs_fw_upper,
			ac_unit_width/2-gs_fw_side_right, 0,      95,
			ac_unit_width/2+gs_fthk*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(180-rightCornerAngle/2), 0,    95,
			ac_unit_width/2-(gs_frame_width/2)/SIN(180-rightCornerAngle/2), gs_fthk,      95,
			ac_unit_width/2-gs_fw_side_right,gs_fthk,     95,
			ac_unit_width/2-gs_fw_side_right, 0,      -1
	DEL 2
	xprtp=-gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)
endif

if iFrameStyleRight = FRAME_STYLE_ANGLE_FRAME AND gs_UTrans AND gs_cr AND rightCornerAngle>180 then
	ROTX 90
	ADDZ -ac_unit_height+gs_fw_upper
	lin_ ac_unit_width/2-gs_fw_side_right, 0, 0, ac_unit_width/2+(gs_fthk-gs_gsb-gs_glass_thk)*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(180-rightCornerAngle/2), 0, 0
	lin_ ac_unit_width/2-(gs_frame_width/2)/SIN(180-rightCornerAngle/2), gs_fthk, 0, ac_unit_width/2-gs_fw_side_right, gs_fthk, 0

	CUTFORM 6, 1, 1+2,
		0,0,1, topPanelHeight-gs_fw_upper,
		ac_unit_width/2-gs_fw_side_right, 0,      31,
		ac_unit_width/2+(gs_fthk-gs_gsb-gs_glass_thk)*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(180-rightCornerAngle/2), 0,    31,
		ac_unit_width/2+(gs_fthk-gs_gsb-gs_glass_thk)*TAN(90-rightCornerAngle/2)-(gs_frame_width/2)/SIN(180-rightCornerAngle/2), (gs_gsb+gs_glass_thk),    31,
		ac_unit_width/2-(gs_frame_width/2)/SIN(180-rightCornerAngle/2), gs_fthk,      31,
		ac_unit_width/2-gs_fw_side_right, gs_fthk,     31,
		ac_unit_width/2-gs_fw_side_right, 0,      -1
	DEL 2
	xprtp=-gs_fthk*TAN(90-rightCornerAngle/2)+(gs_frame_width/2)/SIN(rightCornerAngle/2)
endif

if iFrameStyleRight = FRAME_STYLE_BUTT_GLAZED_WO_FRAME AND gs_UTrans AND gs_cr then
	ROTX 90
	ADDZ -ac_unit_height+gs_fw_upper
	CUTFORM 5, 1, 1+2,
		0,0,1, topPanelHeight-gs_fw_upper,
		ac_unit_width/2-gs_fw_side_right, 0, 1+2+4+8+16,
		ac_unit_width/2, 0,     1+2+4+8+16,
		ac_unit_width/2, gs_fthk,      1+2+4+8+16,
		ac_unit_width/2-gs_fw_side_right, gs_fthk, 1+2+4+8+16,
		ac_unit_width/2-gs_fw_side_right, 0,      -1
	DEL 2
	xprtp=0
endif

if iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED AND gs_UTrans then
	CUTFORM 5, 1, 1+2,
		 0, 0, 1, gs_gsb+gs_glass_thk,
		-ac_unit_width/2, ac_unit_height-topPanelHeight,  2+8+16,
		(-ac_unit_width/2+leftPanelWidth)*gs_bSLight, ac_unit_height-topPanelHeight, 2+8+16,
		(-ac_unit_width/2+leftPanelWidth)*gs_bSLight, ac_unit_height-gs_fw_upper, 2+8+16,
		-ac_unit_width/2, ac_unit_height-gs_fw_upper, 2+8+16,
		-ac_unit_width/2, ac_unit_height-topPanelHeight,  -1
endif

if iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED AND gs_UTrans AND gs_cl AND leftCornerAngle <180 then
	ROTX 90
	ADDZ -ac_unit_height+gs_fw_upper
		CUTFORM 5, 1, 1+2,
			0,0,1, topPanelHeight-gs_fw_upper,
			-ac_unit_width/2+(gs_frame_width/2)/SIN(leftCornerAngle/2),0,95,
			-ac_unit_width/2+gs_fw_side_left+(gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)-gs_fw_side_left)*(leftCornerAngle<60),0,95,
			-ac_unit_width/2+gs_fw_side_left+(gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)-gs_fw_side_left)*(leftCornerAngle<60), gs_fthk,95,
			-ac_unit_width/2+gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2),gs_fthk,95,
			-ac_unit_width/2+(gs_frame_width/2)/SIN(leftCornerAngle/2),0,-1
	DEL 2
	xpltp=gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)
endif

if iFrameStyleLeft = FRAME_STYLE_ANGLE_FRAME AND gs_UTrans AND gs_cl AND leftCornerAngle<180 then
	ROTX 90
	ADDZ -ac_unit_height+gs_fw_upper
	lin_ -ac_unit_width/2+(gs_gsb+gs_glass_thk)*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), 0, 0, \
		 -ac_unit_width/2+gs_fw_side_left+(gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)-gs_fw_side_left)*(leftCornerAngle<60), 0, 0
	lin_ -ac_unit_width/2+gs_fw_side_left+(gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)-gs_fw_side_left)*(leftCornerAngle<60), \
		 gs_fthk, 0, -ac_unit_width/2+gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), gs_fthk, 0

	CUTFORM 6, 1, 1+2,
		0,0,1, topPanelHeight-gs_fw_upper,
		-ac_unit_width/2+(gs_gsb+gs_glass_thk)*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), gs_gsb+gs_glass_thk,31,
		-ac_unit_width/2+(gs_gsb+gs_glass_thk)*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), 0,31,
		-ac_unit_width/2+gs_fw_side_left+(gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)-gs_fw_side_left)*(leftCornerAngle<60),0,31,
		-ac_unit_width/2+gs_fw_side_left+(gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)-gs_fw_side_left)*(leftCornerAngle<60), gs_fthk,31,
		-ac_unit_width/2+gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2),gs_fthk, 31,
		-ac_unit_width/2+(gs_gsb+gs_glass_thk)*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), gs_gsb+gs_glass_thk,-1
	DEL 2
	xpltp=gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)
endif

if iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED AND gs_UTrans AND gs_cl AND leftCornerAngle>180 then
	ROTX 90
	ADDZ -ac_unit_height+gs_fw_upper
		CUTFORM 5, 1, 1+2,
			0,0,1, topPanelHeight-gs_fw_upper,
			-ac_unit_width/2+gs_fthk*TAN(90+leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), 0, 95,
			-ac_unit_width/2+gs_fw_side_left, 0, 95,
			-ac_unit_width/2+gs_fw_side_left, gs_fthk, 95,
			-ac_unit_width/2+(gs_frame_width/2)/SIN(leftCornerAngle/2), gs_fthk, 95,
			-ac_unit_width/2+gs_fthk*TAN(90+leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), 0, -1
	DEL 2
	xpltp=-gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)
endif

if iFrameStyleLeft = FRAME_STYLE_ANGLE_FRAME AND gs_UTrans AND gs_cl AND leftCornerAngle>180 then
	ROTX 90
	ADDZ -ac_unit_height+gs_fw_upper
	lin_ -ac_unit_width/2+(gs_fthk-gs_gsb-gs_glass_thk)*TAN(90+leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), 0, 0, -ac_unit_width/2+gs_fw_side_left, 0, 0
	lin_ -ac_unit_width/2+gs_fw_side_left, gs_fthk, 0, -ac_unit_width/2+(gs_frame_width/2)/SIN(leftCornerAngle/2), gs_fthk, 0

	CUTFORM 6, 1, 1+2,
		0,0,1, topPanelHeight-gs_fw_upper,
		-ac_unit_width/2+(gs_fthk-gs_gsb-gs_glass_thk)*TAN(90+leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), 0, 31,
		-ac_unit_width/2+gs_fw_side_left, 0, 31,
		-ac_unit_width/2+gs_fw_side_left, gs_fthk, 31,
		-ac_unit_width/2+(gs_frame_width/2)/SIN(leftCornerAngle/2), gs_fthk, 31,
		-ac_unit_width/2+(gs_fthk-gs_gsb-gs_glass_thk)*TAN(90+leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), gs_gsb+gs_glass_thk, 31,
		-ac_unit_width/2+(gs_fthk-gs_gsb-gs_glass_thk)*TAN(90+leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2), 0, -1
	DEL 2
	xpltp=-gs_fthk*TAN(90-leftCornerAngle/2)+(gs_frame_width/2)/SIN(leftCornerAngle/2)
endif

if iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED_WO_FRAME AND gs_UTrans AND gs_cl then
	ROTX 90
	ADDZ -ac_unit_height+gs_fw_upper
	CUTFORM 5, 1, 1+2,
		0,0,1, topPanelHeight-gs_fw_upper,
		-ac_unit_width/2+gs_fw_side_left, 0, 1+2+4+8+16,
		-ac_unit_width/2, 0, 1+2+4+8+16,
		-ac_unit_width/2, gs_fthk, 1+2+4+8+16,
		-ac_unit_width/2+gs_fw_side_left, gs_fthk, 1+2+4+8+16,
		-ac_unit_width/2+gs_fw_side_left, 0, -1
	DEL 2
	xpltp=0
endif
!! END OF TOP PANEL !

gs_rh_m=0

! =============================================================================
! Contour Frame
! =============================================================================

if not(gs_UTrans) then
	if not(gs_bSLight) and not(gs_bSLight2) then
		if gs_SashText_typ_num = 1 then ! Mittered Joint
			base
			gosub "leftFrameSimpleMittered"
			gosub "textures1"
			body 1

			base
			gosub "rightFrameSimpleMittered"
			gosub "textures1"
			body 1

			base
				Prism_ 4, gs_fthk,
					rightFrame, topFrame,mask3,
					leftFrame, topFrame, 10,
					-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 15,
					ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 10
			body 1
				Prism_ 4, gs_fthk,
					leftFrame, bottomFrame, 10,
					-ac_unit_width/2+gs_fw_side_left, gs_fw_lower, 15,
					ac_unit_width/2-gs_fw_side_right, gs_fw_lower, 10,
					rightFrame, bottomFrame,15

			gosub "textures2"
			body 1
	else  ! Butt Joint
			base
			gosub "leftFrameSimpleButtJoint"
			gosub "textures1"
			body 1

			base
			gosub "rightFrameSimpleButtJoint"
			gosub "textures1"
			body 1

			base
				Prism_ 6, gs_fthk,
					rightFrame, topFrame,mask3,
					leftFrame, topFrame,mask4,
					leftFrame, ac_unit_height-gs_fw_upper, 8+maskLeftButFr,
					-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 13,
					ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 8+maskRightButFr,
					rightFrame, ac_unit_height-gs_fw_upper, mask2
			body 1
				Prism_ 6, gs_fthk,
					rightFrame, gs_fw_lower, 8+maskRightButFr,
					ac_unit_width/2-gs_fw_side_right, gs_fw_lower, 13,
					-ac_unit_width/2+gs_fw_side_left, gs_fw_lower, 8+maskLeftButFr,
					leftFrame, gs_fw_lower, mask4,
					leftFrame, bottomFrame, mask1,
					rightFrame, bottomFrame, mask2
			gosub "textures2"
			body 1
		endif
	endif


	if gs_bSLight and not(gs_bSLight2) then
		if gs_SashText_typ_num = 1 then   ! Mittered Joint
			base
			gosub "leftFrameSimpleMittered"
			gosub "textures1"
			body 1

			base
				Prism_ 4, gs_fthk,
					-ac_unit_width/2+leftPanelWidth, ac_unit_height-gs_fw_upper, 15,
					-ac_unit_width/2+leftPanelWidth, gs_fw_lower, 10,
					-ac_unit_width/2+frameOrSLightWidthLeft, gs_fw_lower, 15,
					-ac_unit_width/2+frameOrSLightWidthLeft, ac_unit_height-gs_fw_upper, 10
			gosub "textures1"
			body 1

			base
			gosub "rightFrameSimpleMittered"
			gosub "textures1"
			body 1

			base
				Prism_ 6, gs_fthk,
					leftFrame, bottomFrame, 10,
					-ac_unit_width/2+gs_fw_side_left, gs_fw_lower, 15,
					-ac_unit_width/2+leftPanelWidth, gs_fw_lower, 10,
					-ac_unit_width/2+frameOrSLightWidthLeft, gs_fw_lower, 15,
					ac_unit_width/2-gs_fw_side_right, gs_fw_lower, 10,
					rightFrame, bottomFrame, 15
			gosub "textures2"
			body 1

			base
				Prism_ 6, gs_fthk,
					rightFrame, topFrame,mask3,
					leftFrame, topFrame, 10,
					-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 15,
					-ac_unit_width/2+leftPanelWidth, ac_unit_height-gs_fw_upper, 10,
					-ac_unit_width/2+frameOrSLightWidthLeft, ac_unit_height-gs_fw_upper, 15,
					ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 10
			gosub "textures2"
			body 1
	else
			base
			gosub "leftFrameSimpleButtJoint"
			gosub "textures1"
			body 1

			base
				Prism_ 4, gs_fthk,
					-ac_unit_width/2+leftPanelWidth, ac_unit_height-gs_fw_upper, 15,
					-ac_unit_width/2+leftPanelWidth, gs_fw_lower, 10,
					-ac_unit_width/2+frameOrSLightWidthLeft, gs_fw_lower, 13,
					-ac_unit_width/2+frameOrSLightWidthLeft, ac_unit_height-gs_fw_upper, 10
			gosub "textures1"
			body 1

			base
			gosub "rightFrameSimpleButtJoint"
			gosub "textures1"
			body 1

			base
				Prism_ 8, gs_fthk,
					-ac_unit_width/2+gs_fw_side_left, gs_fw_lower, 10,
					leftFrame, gs_fw_lower, mask4,
					leftFrame, bottomFrame, 15,
					rightFrame, bottomFrame, 15,
					rightFrame, gs_fw_lower,8+maskRightButFr,
					ac_unit_width/2-gs_fw_side_right, gs_fw_lower, 15,
					-ac_unit_width/2+frameOrSLightWidthLeft, gs_fw_lower, 8+maskLeftButFr,
					-ac_unit_width/2+leftPanelWidth, gs_fw_lower, 15

			gosub "textures2"
			body 1

			base
				Prism_ 8, gs_fthk,
					rightFrame, topFrame,mask3,
					leftFrame, topFrame,mask4,
					leftFrame, ac_unit_height-gs_fw_upper, 8+maskLeftButFr,
					-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 15,
					-ac_unit_width/2+leftPanelWidth, ac_unit_height-gs_fw_upper, 10,
					-ac_unit_width/2+frameOrSLightWidthLeft, ac_unit_height-gs_fw_upper, 15,
					ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 10+maskRightButFr,
					rightFrame, ac_unit_height-gs_fw_upper, mask2
			gosub "textures2"
			body 1
		endif
	endif

	if not(gs_bSLight) AND gs_bSLight2 then
		if gs_SashText_typ_num = 1 then   ! Mittered Joint
			base
			gosub "rightFrameSimpleMittered"
			gosub "textures1"
			body 1

			base
				Prism_ 4, gs_fthk,
					ac_unit_width/2-rightPanelWidth, ac_unit_height-gs_fw_upper, 15,
					ac_unit_width/2-rightPanelWidth, gs_fw_lower, 10,
					ac_unit_width/2-gs_fw_side_left*(not(gs_bSLight2))-rightPanelWidth-gs_frame_width*(gs_bSLight2), gs_fw_lower, 15,
					ac_unit_width/2-gs_fw_side_left*(not(gs_bSLight2))-rightPanelWidth-gs_frame_width*(gs_bSLight2), ac_unit_height-gs_fw_upper, 10
			gosub "textures1"
			body 1

			base
			gosub "leftFrameSimpleMittered"
			gosub "textures1"
			body 1

			base
				Prism_ 6, gs_fthk,
					rightFrame, bottomFrame, 10,
					ac_unit_width/2-gs_fw_side_right, gs_fw_lower, 15,
					ac_unit_width/2-rightPanelWidth, gs_fw_lower, 10,
					ac_unit_width/2-frameOrSLightWidthRight, gs_fw_lower, 15,
					-ac_unit_width/2+gs_fw_side_left, gs_fw_lower, 10,
					leftFrame, bottomFrame, 15
			gosub "textures2"
			body 1

			base
				Prism_ 6, gs_fthk,
					leftFrame, topFrame, mask3,
					rightFrame, topFrame, 10,
					ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 15,
					ac_unit_width/2-rightPanelWidth, ac_unit_height-gs_fw_upper, 10,
					ac_unit_width/2-frameOrSLightWidthRight, ac_unit_height-gs_fw_upper, 15,
					-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 10
			gosub "textures2"
			body 1
	else  ! Butt Joint
			base
			gosub "rightFrameSimpleButtJoint"
			gosub "textures1"
			body 1

			base
				Prism_ 4, gs_fthk,
					ac_unit_width/2-rightPanelWidth,  ac_unit_height-gs_fw_upper, 15,
					ac_unit_width/2-rightPanelWidth, gs_fw_lower, 10,
					ac_unit_width/2-frameOrSLightWidthRight, gs_fw_lower, 13,
					ac_unit_width/2-frameOrSLightWidthRight, ac_unit_height-gs_fw_upper, 10
			gosub "textures1"
			body 1

			base
			gosub "leftFrameSimpleButtJoint"
			gosub "textures1"
			body 1

			base
				Prism_ 8, gs_fthk,
					ac_unit_width/2-gs_fw_side_right, gs_fw_lower, 10,
					rightFrame, gs_fw_lower, mask4,
					rightFrame, bottomFrame, 15,
					leftFrame, bottomFrame, 15,
					leftFrame, gs_fw_lower, 8+maskLeftButFr,
					-ac_unit_width/2+gs_fw_side_left, gs_fw_lower, 15,
					ac_unit_width/2-frameOrSLightWidthRight, gs_fw_lower, 8+maskRightButFr,
					ac_unit_width/2-rightPanelWidth, gs_fw_lower, 15
			gosub "textures2"
			body 1

			base
				Prism_ 8, gs_fthk,
					leftFrame, topFrame, mask3,
					rightFrame, topFrame, mask4,
					rightFrame, ac_unit_height-gs_fw_upper, 8+maskRightButFr,
					ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 15,
					ac_unit_width/2-rightPanelWidth, ac_unit_height-gs_fw_upper, 10,
					ac_unit_width/2-frameOrSLightWidthRight, ac_unit_height-gs_fw_upper, 15,
					-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 10+maskLeftButFr,
					leftFrame, ac_unit_height-gs_fw_upper, mask2
			gosub "textures2"
			body 1
		endif

	endif

	if gs_bSLight AND gs_bSLight2 then
		if gs_SashText_typ_num = 1 then   ! Mittered Joint

			base
				Prism_ 4, gs_fthk,
					-ac_unit_width/2+leftPanelWidth, ac_unit_height-gs_fw_upper, 15,
					-ac_unit_width/2+leftPanelWidth, gs_fw_lower, 10,
					-ac_unit_width/2+frameOrSLightWidthLeft, gs_fw_lower, 15,
					-ac_unit_width/2+frameOrSLightWidthLeft, ac_unit_height-gs_fw_upper, 10
			gosub "textures1"
			body 1

			base
			gosub "rightFrameSimpleMittered"
			gosub "textures1"
			body 1

			base
				Prism_ 4, gs_fthk,
					ac_unit_width/2-rightPanelWidth, ac_unit_height-gs_fw_upper, 15,
					ac_unit_width/2-rightPanelWidth, gs_fw_lower, 10,
					ac_unit_width/2-gs_fw_side_left*(not(gs_bSLight2))-rightPanelWidth-gs_frame_width*(gs_bSLight2), gs_fw_lower, 15,
					ac_unit_width/2-gs_fw_side_left*(not(gs_bSLight2))-rightPanelWidth-gs_frame_width*(gs_bSLight2), ac_unit_height-gs_fw_upper, 10
			gosub "textures1"
			body 1

			base
			gosub "leftFrameSimpleMittered"
			gosub "textures1"
			body 1

			base
				Prism_ 8, gs_fthk,
					leftFrame, topFrame, mask3,
					rightFrame, topFrame, 10,
					ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 15,
					ac_unit_width/2-rightPanelWidth, ac_unit_height-gs_fw_upper, 10,
					ac_unit_width/2-frameOrSLightWidthRight, ac_unit_height-gs_fw_upper, 15,
					-ac_unit_width/2+frameOrSLightWidthLeft, ac_unit_height-gs_fw_upper,10,
					-ac_unit_width/2+leftPanelWidth, ac_unit_height-gs_fw_upper,15,
					-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 10
			gosub "textures2"
			body 1

			base
				Prism_ 8, gs_fthk,
					leftFrame, bottomFrame, 10,
					-ac_unit_width/2+gs_fw_side_left, gs_fw_lower, 15,
					-ac_unit_width/2+leftPanelWidth, gs_fw_lower, 10,
					-ac_unit_width/2+frameOrSLightWidthLeft, gs_fw_lower, 15,
					ac_unit_width/2-frameOrSLightWidthRight, gs_fw_lower, 10,
					ac_unit_width/2-rightPanelWidth,  gs_fw_lower, 15,
					ac_unit_width/2-gs_fw_side_right, gs_fw_lower, 10,
					rightFrame, bottomFrame, 15

			gosub "textures2"
			body 1
	else    ! Butt Joint
			base
				Prism_ 4, gs_fthk,
					-ac_unit_width/2+leftPanelWidth, ac_unit_height-gs_fw_upper, 15,
					-ac_unit_width/2+leftPanelWidth, gs_fw_lower, 10,
					-ac_unit_width/2+frameOrSLightWidthLeft, gs_fw_lower, 13,
					-ac_unit_width/2+frameOrSLightWidthLeft, ac_unit_height-gs_fw_upper, 10
			gosub "textures1"
			body 1

			base
			gosub "rightFrameSimpleButtJoint"
			gosub "textures1"
			body 1

			base
				Prism_ 4, gs_fthk,
					ac_unit_width/2-rightPanelWidth,  ac_unit_height-gs_fw_upper, 15,
					ac_unit_width/2-rightPanelWidth, gs_fw_lower, 10,
					ac_unit_width/2-frameOrSLightWidthRight, gs_fw_lower, 13,
					ac_unit_width/2-frameOrSLightWidthRight, ac_unit_height-gs_fw_upper, 10
			gosub "textures1"
			body 1

			base
			gosub "leftFrameSimpleButtJoint"
			gosub "textures1"
			body 1

			base
				Prism_ 10, gs_fthk,
					leftFrame, topFrame, mask3,
					rightFrame, topFrame, mask4,
					rightFrame, ac_unit_height-gs_fw_upper, 8+maskRightButFr,
					ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 15,
					ac_unit_width/2-rightPanelWidth, ac_unit_height-gs_fw_upper, 10,
					ac_unit_width/2-frameOrSLightWidthRight, ac_unit_height-gs_fw_upper, 15,
					-ac_unit_width/2+frameOrSLightWidthLeft, ac_unit_height-gs_fw_upper,10,
					-ac_unit_width/2+leftPanelWidth, ac_unit_height-gs_fw_upper,15,
					-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 10+maskLeftButFr,
					leftFrame, ac_unit_height-gs_fw_upper, mask2
			gosub "textures2"
			body 1

			base
				Prism_ 10, gs_fthk,
					-ac_unit_width/2+gs_fw_side_left, gs_fw_lower, 10,
					leftFrame, gs_fw_lower, mask4,
					leftFrame, bottomFrame, 15,
					rightFrame, bottomFrame, 15,
					rightFrame, gs_fw_lower, 8,
					ac_unit_width/2-gs_fw_side_right, gs_fw_lower, 15,
					ac_unit_width/2-rightPanelWidth, gs_fw_lower, 10+maskRightButFr,
					ac_unit_width/2-frameOrSLightWidthRight, gs_fw_lower, 15,
					-ac_unit_width/2+frameOrSLightWidthLeft, gs_fw_lower, 8+maskLeftButFr,
					-ac_unit_width/2+leftPanelWidth, gs_fw_lower, 15
			gosub "textures2"
			body 1

		endif
	endif
else
	if not(gs_bSLight) AND not(gs_bSLight2) then
		if gs_SashText_typ_num = 1 then   ! Mittered Joint
			base
				if iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED then
					Prism_ 6, gs_fthk,
						leftFrame, topFrame, mask4,
						leftFrame, bottomFrame, 10,
						-ac_unit_width/2+gs_fw_side_left+(xpltp-gs_fw_side_left)*(xpltp>gs_fw_side_left), gs_fw_lower, 15,
						-ac_unit_width/2+gs_fw_side_left+(xpltp-gs_fw_side_left)*(xpltp>gs_fw_side_left),ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans),10,
						-ac_unit_width/2+gs_fw_side_left+(xpltp-gs_fw_side_left)*(xpltp>gs_fw_side_left), ac_unit_height-topPanelHeight , 15,
						-ac_unit_width/2+gs_fw_side_left+(xpltp-gs_fw_side_left)*(xpltp>gs_fw_side_left), ac_unit_height-gs_fw_upper, 10
				else
					Prism_ 6, gs_fthk,
						leftFrame, topFrame, mask4,
						leftFrame, bottomFrame, 10,
						-ac_unit_width/2+gs_fw_side_left, gs_fw_lower, 15,
						-ac_unit_width/2+gs_fw_side_left,ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans),10,
						-ac_unit_width/2+gs_fw_side_left, ac_unit_height-topPanelHeight , 15,
						-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 10
				endif
			gosub "textures1"
			body 1

			base
				Prism_ 6, gs_fthk,
					rightFrame, bottomFrame,mask2,
					rightFrame, topFrame, 10,
					ac_unit_width/2-gs_fw_side_right-(xprtp-gs_fw_side_right)*(xprtp>gs_fw_side_right), ac_unit_height-gs_fw_upper, 15,
					ac_unit_width/2-gs_fw_side_right-(xprtp-gs_fw_side_right)*(xprtp>gs_fw_side_right), ac_unit_height-topPanelHeight , 10,
					ac_unit_width/2-gs_fw_side_right-(xprtp-gs_fw_side_right)*(xprtp>gs_fw_side_right), ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans),15,
					ac_unit_width/2-gs_fw_side_right-(xprtp-gs_fw_side_right)*(xprtp>gs_fw_side_right), gs_fw_lower, 10
			gosub "textures1"
			body 1

			base

				Prism_ 4, gs_fthk,
					rightFrame, topFrame,mask3,
					leftFrame, topFrame, 10,
					-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 15,
					ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 10
			body 1
				Prism_ 4, gs_fthk,
					leftFrame, bottomFrame, 10,
					-ac_unit_width/2+gs_fw_side_left, gs_fw_lower, 15,
					ac_unit_width/2-gs_fw_side_right, gs_fw_lower, 10,
					rightFrame, bottomFrame,15


			gosub "textures2"
			body 1
	else  ! Butt Joint
			base
				if iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED then
					Prism_ 6, gs_fthk,
						leftFrame, ac_unit_height-gs_fw_upper, mask4,
						leftFrame, gs_fw_lower, 10,
						-ac_unit_width/2+gs_fw_side_left+(xpltp-gs_fw_side_left)*(xpltp>gs_fw_side_left), gs_fw_lower, 15,
						-ac_unit_width/2+gs_fw_side_left+(xpltp-gs_fw_side_left)*(xpltp>gs_fw_side_left), ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans),10,
						-ac_unit_width/2+gs_fw_side_left+(xpltp-gs_fw_side_left)*(xpltp>gs_fw_side_left), ac_unit_height-topPanelHeight , 15,
						-ac_unit_width/2+gs_fw_side_left+(xpltp-gs_fw_side_left)*(xpltp>gs_fw_side_left), ac_unit_height-gs_fw_upper, 10
				else
					Prism_ 6, gs_fthk,
						leftFrame, ac_unit_height-gs_fw_upper, mask4,
						leftFrame, gs_fw_lower, 10,
						-ac_unit_width/2+gs_fw_side_left, gs_fw_lower, 15,
						-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans),10,
						-ac_unit_width/2+gs_fw_side_left, ac_unit_height-topPanelHeight , 15,
						-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 10
				endif
			gosub "textures1"
			body 1

			base
				Prism_ 6, gs_fthk,
					rightFrame, gs_fw_lower, mask2,
					rightFrame, ac_unit_height-gs_fw_upper, 10,
					ac_unit_width/2-gs_fw_side_right-(xprtp-gs_fw_side_right)*(xprtp>gs_fw_side_right), ac_unit_height-gs_fw_upper, 15,
					ac_unit_width/2-gs_fw_side_right-(xprtp-gs_fw_side_right)*(xprtp>gs_fw_side_right), ac_unit_height-topPanelHeight , 10,
					ac_unit_width/2-gs_fw_side_right-(xprtp-gs_fw_side_right)*(xprtp>gs_fw_side_right), ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans),15,
					ac_unit_width/2-gs_fw_side_right-(xprtp-gs_fw_side_right)*(xprtp>gs_fw_side_right), gs_fw_lower, 10
			gosub "textures1"
			body 1

			base
				Prism_ 6, gs_fthk,
					rightFrame, topFrame,mask3,
					leftFrame, topFrame,mask4,
					leftFrame, ac_unit_height-gs_fw_upper, 8+maskLeftButFr,
					-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 13,
					ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 8+maskRightButFr,
					rightFrame, ac_unit_height-gs_fw_upper, mask2
			body 1
				Prism_ 6, gs_fthk,
					rightFrame, gs_fw_lower, 8+maskRightButFr,
					ac_unit_width/2-gs_fw_side_right, gs_fw_lower, 13,
					-ac_unit_width/2+gs_fw_side_left, gs_fw_lower, 8+maskLeftButFr,
					leftFrame, gs_fw_lower, mask4,
					leftFrame, bottomFrame, mask1,
					rightFrame, bottomFrame, mask2
			gosub "textures2"
			body 1
		endif

		! Top Panel Frame
		base
			Prism_ 4, gs_fthk,
				ac_unit_width/2-gs_fw_side_right-(xprtp-gs_fw_side_right)*(xprtp>gs_fw_side_right), ac_unit_height-topPanelHeight , 10,
				ac_unit_width/2-gs_fw_side_right-(xprtp-gs_fw_side_right)*(xprtp>gs_fw_side_right), ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans),15,
				-ac_unit_width/2+gs_fw_side_left+(xpltp-gs_fw_side_left)*(xpltp>gs_fw_side_left)*(iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED),ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans),10,
				-ac_unit_width/2+gs_fw_side_left+(xpltp-gs_fw_side_left)*(xpltp>gs_fw_side_left)*(iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED), ac_unit_height-topPanelHeight , 15
			gosub "textures2"
		body 1
	endif


	if gs_bSLight AND not(gs_bSLight2) then
		if gs_SashText_typ_num = 1 then   ! Mittered Joint
			base
				Prism_ 6, gs_fthk,
					leftFrame, topFrame,mask4,
					leftFrame, bottomFrame, 10,
					-ac_unit_width/2+gs_fw_side_left, gs_fw_lower, 15,
					-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans),10,
					-ac_unit_width/2+gs_fw_side_left, ac_unit_height-topPanelHeight, 15,
					-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 10
			gosub "textures1"
			body 1

			base
				Prism_ 8, gs_fthk,
					-ac_unit_width/2+leftPanelWidth, ac_unit_height-gs_fw_upper, 15,
					-ac_unit_width/2+leftPanelWidth, ac_unit_height-topPanelHeight, 10,
					-ac_unit_width/2+leftPanelWidth,ac_unit_height-topPanelHeight-gs_frame_width,15,
					-ac_unit_width/2+leftPanelWidth, gs_fw_lower, 10,
					-ac_unit_width/2+frameOrSLightWidthLeft, gs_fw_lower, 15,
					-ac_unit_width/2+frameOrSLightWidthLeft,ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans),10,
					-ac_unit_width/2+frameOrSLightWidthLeft,ac_unit_height-topPanelHeight,15,
					-ac_unit_width/2+frameOrSLightWidthLeft, ac_unit_height-gs_fw_upper, 10
			gosub "textures1"
			body 1

			base
				Prism_ 6, gs_fthk,
					rightFrame, bottomFrame, mask2,
					rightFrame, topFrame, 10,
					ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 15,
					ac_unit_width/2-gs_fw_side_right, ac_unit_height-topPanelHeight,10,
					ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans),15,
					ac_unit_width/2-gs_fw_side_right, gs_fw_lower, 10
			gosub "textures1"
			body 1

			base
				Prism_ 6, gs_fthk,
					leftFrame, bottomFrame, 10,
					-ac_unit_width/2+gs_fw_side_left, gs_fw_lower, 15,
					-ac_unit_width/2+leftPanelWidth, gs_fw_lower, 10,
					-ac_unit_width/2+frameOrSLightWidthLeft, gs_fw_lower, 15,
					ac_unit_width/2-gs_fw_side_right, gs_fw_lower, 10,
					rightFrame, bottomFrame, 15
			gosub "textures2"
			body 1

			base
				Prism_ 6, gs_fthk,
					rightFrame, topFrame, mask3,
					leftFrame, topFrame, 10,
					-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 15,
					-ac_unit_width/2+leftPanelWidth, ac_unit_height-gs_fw_upper, 10,
					-ac_unit_width/2+frameOrSLightWidthLeft, ac_unit_height-gs_fw_upper, 15,
					ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 10
			gosub "textures2"
			body 1
	else    ! Butt Joint
			base
				Prism_ 6, gs_fthk,
					leftFrame, ac_unit_height-gs_fw_upper, mask4,
					leftFrame, gs_fw_lower, 8,
					-ac_unit_width/2+gs_fw_side_left, gs_fw_lower, 15,
					-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans),10,
					-ac_unit_width/2+gs_fw_side_left, ac_unit_height-topPanelHeight, 15,
					-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 10
			gosub "textures1"
			body 1

			base
				Prism_ 8, gs_fthk,
					-ac_unit_width/2+leftPanelWidth, ac_unit_height-gs_fw_upper, 15,
					-ac_unit_width/2+leftPanelWidth, ac_unit_height-topPanelHeight, 10,
					-ac_unit_width/2+leftPanelWidth, ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans),15,
					-ac_unit_width/2+leftPanelWidth, gs_fw_lower, 10,
					-ac_unit_width/2+frameOrSLightWidthLeft, gs_fw_lower, 13,
					-ac_unit_width/2+frameOrSLightWidthLeft, ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans),10,
					-ac_unit_width/2+frameOrSLightWidthLeft, ac_unit_height-topPanelHeight,15,
					-ac_unit_width/2+frameOrSLightWidthLeft, ac_unit_height-gs_fw_upper, 10
			gosub "textures1"
			body 1

			base
				Prism_ 6, gs_fthk,
					rightFrame, gs_fw_lower, mask2,
					rightFrame, ac_unit_height-gs_fw_upper, 8,
					ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 15,
					ac_unit_width/2-gs_fw_side_right, ac_unit_height-topPanelHeight, 10,
					ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans),15,
					ac_unit_width/2-gs_fw_side_right, gs_fw_lower, 10
			gosub "textures1"
			body 1

			base
				Prism_ 8, gs_fthk,
					-ac_unit_width/2+gs_fw_side_left, gs_fw_lower, 10,
					leftFrame, gs_fw_lower, mask4,
					leftFrame, bottomFrame, 15,
					rightFrame, bottomFrame,mask2,
					rightFrame, gs_fw_lower, 8+maskRightButFr,
					ac_unit_width/2-gs_fw_side_right, gs_fw_lower, 15,
					-ac_unit_width/2+frameOrSLightWidthLeft, gs_fw_lower, 10+maskLeftButFr,
					-ac_unit_width/2+leftPanelWidth, gs_fw_lower, 15

			gosub "textures2"
			body 1

			base
				Prism_ 8, gs_fthk,
					rightFrame, topFrame, mask3,
					leftFrame, topFrame, mask4,
					leftFrame, ac_unit_height-gs_fw_upper, 8+maskLeftButFr,
					-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 15,
					-ac_unit_width/2+frameOrSLightWidthLeft, ac_unit_height-gs_fw_upper, 15,
					ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 10+maskRightButFr,
					rightFrame, ac_unit_height-gs_fw_upper, mask2,
					rightFrame, topFrame, -1

			gosub "textures2"
			body 1
		endif

		! Top Panel Frame
		base
			Prism_ 4, gs_fthk,
				ac_unit_width/2-gs_fw_side_right, ac_unit_height-topPanelHeight,10,
				ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans),15,
				-ac_unit_width/2+frameOrSLightWidthLeft, ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans), 10,
				-ac_unit_width/2+frameOrSLightWidthLeft, ac_unit_height-topPanelHeight, 15
		body 1
			Prism_ 4, gs_fthk,
				-ac_unit_width/2+gs_fw_side_left, ac_unit_height-topPanelHeight,10,
				-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans),15,
				-ac_unit_width/2+leftPanelWidth, ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans), 10,
				-ac_unit_width/2+leftPanelWidth, ac_unit_height-topPanelHeight, 15
			gosub "textures2"
		body 1
	endif

	if not(gs_bSLight) AND gs_bSLight2 then
		if gs_SashText_typ_num = 1 then   ! Mittered Joint
			base
				Prism_ 6, gs_fthk,
					rightFrame, topFrame, mask4,
					rightFrame, bottomFrame, 10,
					ac_unit_width/2-gs_fw_side_right, gs_fw_lower, 15,
					ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans),10,
					ac_unit_width/2-gs_fw_side_right, ac_unit_height-topPanelHeight, 15,
					ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 10
			gosub "textures1"
			body 1

			base
				Prism_ 8, gs_fthk,
					ac_unit_width/2-rightPanelWidth, ac_unit_height-gs_fw_upper, 15,
					ac_unit_width/2-rightPanelWidth, ac_unit_height-topPanelHeight, 10,
					ac_unit_width/2-rightPanelWidth,ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans),15,
					ac_unit_width/2-rightPanelWidth, gs_fw_lower, 10,
					ac_unit_width/2-frameOrSLightWidthRight, gs_fw_lower, 15,
					ac_unit_width/2-frameOrSLightWidthRight,ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans),10,
					ac_unit_width/2-frameOrSLightWidthRight,ac_unit_height-topPanelHeight,15,
					ac_unit_width/2-frameOrSLightWidthRight, ac_unit_height-gs_fw_upper, 10
			gosub "textures1"
			body 1

			base
				Prism_ 6, gs_fthk,
					leftFrame, bottomFrame, mask2,
					leftFrame, topFrame, 10,
					-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 15,
					-ac_unit_width/2+gs_fw_side_left, ac_unit_height-topPanelHeight,10,
					-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans),15,
					-ac_unit_width/2+gs_fw_side_left, gs_fw_lower, 10
			gosub "textures1"
			body 1

			base
				Prism_ 6, gs_fthk,
					rightFrame, bottomFrame, 10,
					ac_unit_width/2-gs_fw_side_right, gs_fw_lower, 15,
					ac_unit_width/2-rightPanelWidth, gs_fw_lower, 10,
					ac_unit_width/2-frameOrSLightWidthRight, gs_fw_lower, 15,
					-ac_unit_width/2+gs_fw_side_left, gs_fw_lower, 10,
					leftFrame, bottomFrame, 15
			gosub "textures2"
			body 1

			base
				Prism_ 6, gs_fthk,
					leftFrame, topFrame, mask3,
					rightFrame, topFrame, 10,
					ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 15,
					ac_unit_width/2-rightPanelWidth, ac_unit_height-gs_fw_upper, 10,
					ac_unit_width/2-frameOrSLightWidthRight, ac_unit_height-gs_fw_upper, 15,
					-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 10
			gosub "textures2"
			body 1
	else  ! Butt Joint
			base
				Prism_ 6, gs_fthk,
					rightFrame, ac_unit_height-gs_fw_upper, mask4,
					rightFrame, gs_fw_lower, 8,
					ac_unit_width/2-gs_fw_side_right, gs_fw_lower, 15,
					ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans),10,
					ac_unit_width/2-gs_fw_side_right, ac_unit_height-topPanelHeight, 15,
					ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 10
			gosub "textures1"
			body 1

			base
				Prism_ 8, gs_fthk,
					ac_unit_width/2-rightPanelWidth,  ac_unit_height-gs_fw_upper, 15,
					ac_unit_width/2-rightPanelWidth, ac_unit_height-topPanelHeight, 10,
					ac_unit_width/2-rightPanelWidth, ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans),15,
					ac_unit_width/2-rightPanelWidth, gs_fw_lower, 10,
					ac_unit_width/2-frameOrSLightWidthRight, gs_fw_lower, 13,
					ac_unit_width/2-frameOrSLightWidthRight,ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans),10,
					ac_unit_width/2-frameOrSLightWidthRight,ac_unit_height-topPanelHeight,15,
					ac_unit_width/2-frameOrSLightWidthRight, ac_unit_height-gs_fw_upper, 10
			gosub "textures1"
			body 1

			base
				Prism_ 6, gs_fthk,
					leftFrame, gs_fw_lower, mask2,
					leftFrame, ac_unit_height-gs_fw_upper, 8,
					-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 15,
					-ac_unit_width/2+gs_fw_side_left, ac_unit_height-topPanelHeight, 10,
					-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans),15,
					-ac_unit_width/2+gs_fw_side_left, gs_fw_lower, 10
			gosub "textures1"
			body 1

			base
				Prism_ 8, gs_fthk,
					ac_unit_width/2-gs_fw_side_right, gs_fw_lower, 10,
					rightFrame, gs_fw_lower, mask4,
					rightFrame, bottomFrame, 15,
					leftFrame, bottomFrame, mask2,
					leftFrame, gs_fw_lower, 8+maskLeftButFr,
					-ac_unit_width/2+gs_fw_side_left, gs_fw_lower, 15,
					ac_unit_width/2-frameOrSLightWidthRight, gs_fw_lower, 8+maskRightButFr,
					ac_unit_width/2-rightPanelWidth, gs_fw_lower, 15
			gosub "textures2"
			body 1

			base
				Prism_ 8, gs_fthk,
					leftFrame, topFrame, mask3,
					rightFrame, topFrame, mask4,
					rightFrame, ac_unit_height-gs_fw_upper, 8+maskRightButFr,
					ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 15,
					ac_unit_width/2-rightPanelWidth, ac_unit_height-gs_fw_upper, 10,
					ac_unit_width/2-frameOrSLightWidthRight, ac_unit_height-gs_fw_upper, 15,
					-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 10+maskLeftButFr,
					leftFrame, ac_unit_height-gs_fw_upper, mask2
			gosub "textures2"
			body 1
		endif

		! Top Panel Frame
		base
			Prism_ 4, gs_fthk,
				-ac_unit_width/2+gs_fw_side_left, ac_unit_height-topPanelHeight,10,
				-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans),15,
				ac_unit_width/2-frameOrSLightWidthRight, ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans), 10,
				ac_unit_width/2-frameOrSLightWidthRight, ac_unit_height-topPanelHeight, 15
		body 1
			Prism_ 4, gs_fthk,
				ac_unit_width/2-gs_fw_side_right, ac_unit_height-topPanelHeight,10,
				ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans),15,
				ac_unit_width/2-rightPanelWidth, ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans), 10,
				ac_unit_width/2-rightPanelWidth, ac_unit_height-topPanelHeight, 15
			gosub "textures2"
		body 1
	endif

	if gs_bSLight AND gs_bSLight2 then
		if gs_SashText_typ_num = 1 then ! Mittered Joint
			base
				Prism_ 8, gs_fthk,
					-ac_unit_width/2+leftPanelWidth, ac_unit_height-gs_fw_upper, 15,
					-ac_unit_width/2+leftPanelWidth, ac_unit_height-topPanelHeight, 10,
					-ac_unit_width/2+leftPanelWidth, ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans),15,
					-ac_unit_width/2+leftPanelWidth, gs_fw_lower, 10,
					-ac_unit_width/2+frameOrSLightWidthLeft, gs_fw_lower, 15,
					-ac_unit_width/2+frameOrSLightWidthLeft, ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans),10,
					-ac_unit_width/2+frameOrSLightWidthLeft, ac_unit_height-topPanelHeight,15,
					-ac_unit_width/2+frameOrSLightWidthLeft, ac_unit_height-gs_fw_upper, 10
			gosub "textures1"
			body 1


			base
				Prism_ 6, gs_fthk,
					rightFrame, topFrame, mask4,
					rightFrame, bottomFrame, 10,
					ac_unit_width/2-gs_fw_side_right, gs_fw_lower, 15,
					ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans),10,
					ac_unit_width/2-gs_fw_side_right, ac_unit_height-topPanelHeight, 15,
					ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 10
			gosub "textures1"
			body 1

			base
				Prism_ 8, gs_fthk,
					ac_unit_width/2-rightPanelWidth, ac_unit_height-gs_fw_upper, 15,
					ac_unit_width/2-rightPanelWidth, ac_unit_height-topPanelHeight, 10,
					ac_unit_width/2-rightPanelWidth, ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans),15,
					ac_unit_width/2-rightPanelWidth, gs_fw_lower, 10,
					ac_unit_width/2-frameOrSLightWidthRight, gs_fw_lower, 15,
					ac_unit_width/2-frameOrSLightWidthRight,ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans),10,
					ac_unit_width/2-frameOrSLightWidthRight,ac_unit_height-topPanelHeight,15,
					ac_unit_width/2-frameOrSLightWidthRight, ac_unit_height-gs_fw_upper, 10
			gosub "textures1"
			body 1

			base
				Prism_ 6, gs_fthk,
					leftFrame, bottomFrame, mask2,
					leftFrame, topFrame, 10,
					-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 15,
					-ac_unit_width/2+gs_fw_side_left, ac_unit_height-topPanelHeight,10,
					-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans),15,
					-ac_unit_width/2+gs_fw_side_left, gs_fw_lower, 10
			gosub "textures1"
			body 1

			base
				Prism_ 8, gs_fthk,
					rightFrame, bottomFrame, 10,
					ac_unit_width/2-gs_fw_side_right, gs_fw_lower, 15,
					ac_unit_width/2-rightPanelWidth, gs_fw_lower, 10,
					ac_unit_width/2-frameOrSLightWidthRight, gs_fw_lower, 15,
					-ac_unit_width/2+frameOrSLightWidthLeft, gs_fw_lower, 10,
					-ac_unit_width/2+leftPanelWidth, gs_fw_lower, 15,
					-ac_unit_width/2+gs_fw_side_left, gs_fw_lower, 10,
					leftFrame, bottomFrame, 15
			gosub "textures2"
			body 1
			base
				Prism_ 8, gs_fthk,
					leftFrame, topFrame, mask3,
					rightFrame, topFrame, 10,
					ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 15,
					ac_unit_width/2-rightPanelWidth, ac_unit_height-gs_fw_upper, 10,
					ac_unit_width/2-frameOrSLightWidthRight, ac_unit_height-gs_fw_upper, 15,
					-ac_unit_width/2+frameOrSLightWidthLeft, ac_unit_height-gs_fw_upper,10,
					-ac_unit_width/2+leftPanelWidth, ac_unit_height-gs_fw_upper,15,
					-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 10
			gosub "textures2"
			body 1
	else    ! Butt Joint
			base
				Prism_ 8, gs_fthk,
					-ac_unit_width/2+leftPanelWidth, ac_unit_height-gs_fw_upper, 15,
					-ac_unit_width/2+leftPanelWidth, ac_unit_height-topPanelHeight, 10,
					-ac_unit_width/2+leftPanelWidth, ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans),15,
					-ac_unit_width/2+leftPanelWidth, gs_fw_lower, 10,
					-ac_unit_width/2+frameOrSLightWidthLeft, gs_fw_lower, 13,
					-ac_unit_width/2+frameOrSLightWidthLeft,ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans),10,
					-ac_unit_width/2+frameOrSLightWidthLeft,ac_unit_height-topPanelHeight,15,
					-ac_unit_width/2+frameOrSLightWidthLeft, ac_unit_height-gs_fw_upper, 10
			gosub "textures1"
			body 1


			base
				Prism_ 6, gs_fthk,
					rightFrame, ac_unit_height-gs_fw_upper, mask4,
					rightFrame, gs_fw_lower, 8,
					ac_unit_width/2-gs_fw_side_right, gs_fw_lower, 15,
					ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans),10,
					ac_unit_width/2-gs_fw_side_right, ac_unit_height-topPanelHeight, 15,
					ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 10
			gosub "textures1"
			body 1

			base
				Prism_ 8, gs_fthk,
					ac_unit_width/2-rightPanelWidth, ac_unit_height-gs_fw_upper, 15,
					ac_unit_width/2-rightPanelWidth, ac_unit_height-topPanelHeight, 10,
					ac_unit_width/2-rightPanelWidth, ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans),15,
					ac_unit_width/2-rightPanelWidth, gs_fw_lower, 10,
					ac_unit_width/2-frameOrSLightWidthRight, gs_fw_lower, 13,
					ac_unit_width/2-frameOrSLightWidthRight, ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans),10,
					ac_unit_width/2-frameOrSLightWidthRight, ac_unit_height-topPanelHeight,15,
					ac_unit_width/2-frameOrSLightWidthRight, ac_unit_height-gs_fw_upper, 10
			gosub "textures1"
			body 1

			base
				Prism_ 6, gs_fthk,
					leftFrame, gs_fw_lower, mask2,
					leftFrame, ac_unit_height-gs_fw_upper, 8,
					-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 15,
					-ac_unit_width/2+gs_fw_side_left, ac_unit_height-topPanelHeight, 10,
					-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans),15,
					-ac_unit_width/2+gs_fw_side_left, gs_fw_lower, 10
			gosub "textures1"
			body 1

			base
				Prism_ 10, gs_fthk,
					ac_unit_width/2-rightPanelWidth, gs_fw_lower, 10,
					ac_unit_width/2-frameOrSLightWidthRight, gs_fw_lower, 15,
					-ac_unit_width/2+frameOrSLightWidthLeft, gs_fw_lower, 10,
					-ac_unit_width/2+leftPanelWidth, gs_fw_lower, 15,
					-ac_unit_width/2+gs_fw_side_left, gs_fw_lower, 8+maskLeftButFr,
					leftFrame, gs_fw_lower, mask2,
					leftFrame, bottomFrame, mask1,
					rightFrame, bottomFrame, mask4,
					rightFrame, gs_fw_lower, 8+maskRightButFr,
					ac_unit_width/2-gs_fw_side_right, gs_fw_lower, 13

			gosub "textures2"
			body 1

			base
				Prism_ 10, gs_fthk,
					leftFrame, topFrame, mask3,
					rightFrame, topFrame, mask4,
					rightFrame, ac_unit_height-gs_fw_upper, 8+maskRightButFr,
					ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 13,
					ac_unit_width/2-rightPanelWidth, ac_unit_height-gs_fw_upper, 10,
					ac_unit_width/2-frameOrSLightWidthRight, ac_unit_height-gs_fw_upper, 15,
					-ac_unit_width/2+frameOrSLightWidthLeft, ac_unit_height-gs_fw_upper,10,
					-ac_unit_width/2+leftPanelWidth, ac_unit_height-gs_fw_upper,13,
					-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 8+maskLeftButFr,
					leftFrame, ac_unit_height-gs_fw_upper, mask2
			gosub "textures2"
			body 1
		endif

		! Top Panel Frame
		material gs_frame_mat
		Prism_ 4, gs_fthk,
			ac_unit_width/2-gs_fw_side_right, ac_unit_height-topPanelHeight,10,
			ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans),15,
			ac_unit_width/2-rightPanelWidth, ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans), 10,
			ac_unit_width/2-rightPanelWidth, ac_unit_height-topPanelHeight, 15
		body 1
		Prism_ 4, gs_fthk,
			-ac_unit_width/2+gs_fw_side_left, ac_unit_height-topPanelHeight,10,
			-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans),15,
			-ac_unit_width/2+leftPanelWidth, ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans), 10,
			-ac_unit_width/2+leftPanelWidth, ac_unit_height-topPanelHeight, 15
		body 1
		Prism_ 4, gs_fthk,
			ac_unit_width/2-frameOrSLightWidthRight, ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans), 10,
			ac_unit_width/2-frameOrSLightWidthRight, ac_unit_height-topPanelHeight, 15,
			-ac_unit_width/2+frameOrSLightWidthLeft, ac_unit_height-topPanelHeight, 10,
			-ac_unit_width/2+frameOrSLightWidthLeft, ac_unit_height-gs_fw_upper*(not(gs_UTrans))-topPanelHeight-gs_frame_width*(gs_UTrans), 15
		body 1
	endif
endif

if iFrameStyleLeft <> FRAME_STYLE_VISIBLE_MULLIONS AND gs_UTrans AND gs_cl then CUTEND

if iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED AND gs_UTrans then CUTEND

if iFrameStyleRight <> FRAME_STYLE_VISIBLE_MULLIONS AND gs_UTrans AND gs_cr then CUTEND

if iFrameStyleRight = FRAME_STYLE_BUTT_GLAZED AND gs_UTrans then CUTEND

if iFrameStyleLeft <> FRAME_STYLE_VISIBLE_MULLIONS AND gs_cl then CUTEND

if iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED then CUTEND

if iFrameStyleRight <> FRAME_STYLE_VISIBLE_MULLIONS AND gs_cr then CUTEND

if iFrameStyleRight = FRAME_STYLE_BUTT_GLAZED then CUTEND

if iFrameStyleLeft <> FRAME_STYLE_VISIBLE_MULLIONS AND gs_cl AND bMiddleRail then CUTEND

if iFrameStyleLeft = FRAME_STYLE_BUTT_GLAZED AND bMiddleRail then CUTEND

if iFrameStyleRight <> FRAME_STYLE_VISIBLE_MULLIONS AND gs_cr AND bMiddleRail then CUTEND

if iFrameStyleRight = FRAME_STYLE_BUTT_GLAZED AND bMiddleRail then CUTEND

if gs_cl then CUTEND
if gs_cr then CUTEND

if isVentilationOverFrame then
	cutend
endif

!! END OF FRAME !!

ENDGROUP

GROUP "middle rail"
sect_fill gs_fillFr, gs_penFr_bg, gs_penFr_fg, gs_frame_pen

if bMiddleRail then
	MATERIAL gs_midrail_mat

	if gs_cl AND leftCornerAngle<180 then
		ADDX -ac_unit_width/2
		ROTY -leftCornerAngle/2
			CUTPLANE
		DEL 2
	endif

	if gs_cl AND leftCornerAngle>180 then
		ADD -ac_unit_width/2-WIDO_REVEAL_SIDE*gs_fthk*TAN(90-leftCornerAngle/2), 0, (1-WIDO_REVEAL_SIDE)*gs_fthk
		ROTY -leftCornerAngle/2
		CUTPLANE
		DEL 2
	endif

	if gs_cr AND rightCornerAngle<180 then
		ADDX ac_unit_width/2
		ROTY rightCornerAngle/2
			CUTPLANE
		DEL 2
	endif

	if gs_cr AND rightCornerAngle>180 then
		ADD ac_unit_width/2+WIDO_REVEAL_SIDE*gs_fthk*TAN(90-rightCornerAngle/2), 0, (1-WIDO_REVEAL_SIDE)*gs_fthk
		ROTY rightCornerAngle/2
			CUTPLANE
		DEL 2
	endif

	PRISM_ 5, gs_fthk,
		   -ac_unit_width/2,  midRailElevation-midRailWidth/2, 15,
			ac_unit_width/2,  midRailElevation-midRailWidth/2, 15,
			ac_unit_width/2,  midRailElevation+midRailWidth/2, 15,
		   -ac_unit_width/2,  midRailElevation+midRailWidth/2, 15,
		   -ac_unit_width/2,  midRailElevation-midRailWidth/2, -1
	body 1
	if gs_cl=1 then CUTEND
	if gs_cr=1 then CUTEND
endif
ENDGROUP

sect_fill gs_fillFr, gs_penFr_bg, gs_penFr_fg, gs_frame_pen
PLACEGROUP SUBGROUP ("middle rail", "frame")

sect_fill gs_fillFr, gs_penFr_bg, gs_penFr_fg, gs_frame_pen
PLACEGROUP "frame"


! =============================================================================
! Horizontal Grids
! =============================================================================
SECT_FILL gs_fillFr, gs_penFr_bg, gs_penFr_fg, gs_frame_pen

GROUP "gridsh"

	MATERIAL gs_sash_mat

! =============================================================================
! Corner
! =============================================================================

	if gs_cl AND leftCornerAngle<180 then
		ADDX -ac_unit_width/2
		ROTY -leftCornerAngle/2
			CUTPLANE
		DEL 2
	endif

	if gs_cl AND leftCornerAngle>180 then
		ADD -ac_unit_width/2-WIDO_REVEAL_SIDE*gs_fthk*TAN(90-leftCornerAngle/2), 0, (1-WIDO_REVEAL_SIDE)*gs_fthk
		ROTY -leftCornerAngle/2
		CUTPLANE
		DEL 2
	endif

	if gs_cr AND rightCornerAngle<180 then
		ADDX ac_unit_width/2
		ROTY rightCornerAngle/2
			CUTPLANE
		DEL 2
	endif

	if gs_cr AND rightCornerAngle>180 then
		ADD ac_unit_width/2+WIDO_REVEAL_SIDE*gs_fthk*TAN(90-rightCornerAngle/2), 0, (1-WIDO_REVEAL_SIDE)*gs_fthk
		ROTY rightCornerAngle/2
			CUTPLANE
		DEL 2
	endif


! =============================================================================
! Horizontal Grids
! =============================================================================

	if gs_hor_gnum >0 AND bMiddleRail then
		for i=1 to gs_hor_gnum
			ADDY gs_hor_d[i]
				hgnn=ac_unit_width-gs_fw_side_right-gs_fw_side_left
				ADD -ac_unit_width/2+gs_fw_side_left, gs_fw_lower-gs_grid_w/2, (gs_gsb+gs_glass_thk)*(iFrameStyleMullion = FRAME_STYLE_BUTT_GLAZED)
					PRISM_ 5, gs_grid_thk,
						-gs_fw_side_left*(iFrameStyleLeft <> FRAME_STYLE_VISIBLE_MULLIONS), -gs_grid_w/2, 15,
						 hgnn+gs_fw_side_right*(iFrameStyleRight <> FRAME_STYLE_VISIBLE_MULLIONS), -gs_grid_w/2, 15,
						 hgnn+gs_fw_side_right*(iFrameStyleRight <> FRAME_STYLE_VISIBLE_MULLIONS),  gs_grid_w/2, 15,
						-gs_fw_side_left*(iFrameStyleLeft <> FRAME_STYLE_VISIBLE_MULLIONS),  gs_grid_w/2, 15,
						-gs_fw_side_left*(iFrameStyleLeft <> FRAME_STYLE_VISIBLE_MULLIONS), -gs_grid_w/2, -1
					body 1
				DEL 1
			DEL 1
		next i
	endif


! =============================================================================
! Horizontal Grids Middle
! =============================================================================

	if gs_hor_gnumtr >0 then
		for i=1 to gs_hor_gnumtr
			ADDY gs_hor_dtr[i]
				hgnn=ac_unit_width-gs_fw_side_right-gs_fw_side_left
				ADD -ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper*(not(gs_UTrans))-gs_frame_width*(gs_UTrans)-middlePanelHeight-gs_grid_w/2, (gs_gsb+gs_glass_thk)*(iFrameStyleMullion = FRAME_STYLE_BUTT_GLAZED)
					PRISM_ 5, gs_grid_thk,
					-gs_fw_side_left*(iFrameStyleLeft <> FRAME_STYLE_VISIBLE_MULLIONS), -gs_grid_w/2, 15,
					 hgnn+gs_fw_side_right*(iFrameStyleRight <> FRAME_STYLE_VISIBLE_MULLIONS), -gs_grid_w/2, 15,
					 hgnn+gs_fw_side_right*(iFrameStyleRight <> FRAME_STYLE_VISIBLE_MULLIONS),  gs_grid_w/2, 15,
					-gs_fw_side_left*(iFrameStyleLeft <> FRAME_STYLE_VISIBLE_MULLIONS),  gs_grid_w/2, 15,
					-gs_fw_side_left*(iFrameStyleLeft <> FRAME_STYLE_VISIBLE_MULLIONS), -gs_grid_w/2, -1
					body 1
				DEL 1
			DEL 1
		next i
	endif


! =============================================================================
! Horizontal Grids Top Panel
! =============================================================================

	if gs_hor_gtp >0 AND gs_UTrans then
		base
		for i=1 to gs_hor_gtp
			ADDY gs_hor_dtp[i]
			hgnn=ac_unit_width-gs_fw_side_right-gs_fw_side_left
			ADD -ac_unit_width/2+gs_fw_side_left, ac_unit_height-topPanelHeight-gs_grid_w/2, (gs_gsb+gs_glass_thk)*(iFrameStyleMullion = FRAME_STYLE_BUTT_GLAZED)
				PRISM_ 5, gs_grid_thk,
					-gs_fw_side_left*(iFrameStyleLeft <> FRAME_STYLE_VISIBLE_MULLIONS), -gs_grid_w/2, 15,
					 hgnn+gs_fw_side_right*(iFrameStyleRight <> FRAME_STYLE_VISIBLE_MULLIONS), -gs_grid_w/2, 15,
					 hgnn+gs_fw_side_right*(iFrameStyleRight <> FRAME_STYLE_VISIBLE_MULLIONS),  gs_grid_w/2, 15,
					-gs_fw_side_left*(iFrameStyleLeft <> FRAME_STYLE_VISIBLE_MULLIONS),  gs_grid_w/2, 15,
					-gs_fw_side_left*(iFrameStyleLeft <> FRAME_STYLE_VISIBLE_MULLIONS), -gs_grid_w/2, -1
			DEL 2
		next i

		vert 0, 0, 0
		vert 1, 0, 0
		vert 0, 1, 0
		vert 0, 0, 1
		coor 2, -1, -2, -3, -4
		body 1
	endif

	if gs_cl=1 then CUTEND
	if gs_cr=1 then CUTEND

ENDGROUP


! =============================================================================
! Vertical Grids
! =============================================================================

GROUP "gridsv"
	SECT_FILL gs_fillFr, gs_penFr_bg, gs_penFr_fg, gs_frame_pen
	material gs_vertMull_mat

	if gs_ver_gnum >0 then

		base
		for HK=1 to gs_ver_gnum
			ADDX gs_ver_d[HK]
				ADD  -ac_unit_width/2+gs_fw_side_left*(not(gs_bSLight))+(leftPanelWidth+gs_frame_width)*(gs_bSLight)-gridWidthVert/2, 0, (gs_gsb+gs_glass_thk)*(iFrameStyleMullion = FRAME_STYLE_BUTT_GLAZED)

				PRISM_ 5, gridThkVert,
					-gridWidthVert/2,   gs_fw_lower, 15,
					 gridWidthVert/2,   gs_fw_lower, 15,
					 gridWidthVert/2, ac_unit_height-gs_fw_upper, 15,
					-gridWidthVert/2, ac_unit_height-gs_fw_upper, 15,
					-gridWidthVert/2,   gs_fw_lower, -1
				DEL 1
			DEL 1
		next HK

		vert 0, 0, 0
		vert 0, 1, 0
		vert 1, 0, 0
		vert 0, 0, 1
		coor 2, -1, -2, -3, -4
		body 1
	endif
ENDGROUP

! =============================================================================

SECT_FILL gs_fillFr, gs_penFr_bg, gs_penFr_fg, gs_frame_pen

PLACEGROUP SUBGROUP (SUBGROUP("gridsh","gridsv"), "frame")
PLACEGROUP SUBGROUP ("gridsv", ADDGROUP("middle rail","frame"))


! =============================================================================
! Glass
! =============================================================================

SECT_FILL gs_gsect, gs_penGlass_bg, gs_penGlass_fg, gs_glass_pen

MATERIAL gs_glass_mat
PEN gs_glass_pen

! CORNER !

if gs_cl=1 AND leftCornerAngle<180 then
	ADDX -ac_unit_width/2
	ROTY -leftCornerAngle/2
		CUTPLANE
	DEL 2
endif

if gs_cl=1 AND leftCornerAngle>180 then
	ADD -ac_unit_width/2-WIDO_REVEAL_SIDE*gs_fthk*TAN(90-leftCornerAngle/2), 0, (1-WIDO_REVEAL_SIDE)*gs_fthk
	ROTY -leftCornerAngle/2
	CUTPLANE
	DEL 2
endif

if gs_cr=1 AND rightCornerAngle<180 then
	ADDX ac_unit_width/2
	ROTY rightCornerAngle/2
		CUTPLANE
	DEL 2
endif

if gs_cr=1 AND rightCornerAngle>180 then
	ADD ac_unit_width/2+WIDO_REVEAL_SIDE*gs_fthk*TAN(90-rightCornerAngle/2), 0, (1-WIDO_REVEAL_SIDE)*gs_fthk
	ROTY rightCornerAngle/2
		CUTPLANE
	DEL 2
endif

! END OF CORNER !

if bMiddleRail then
	ADDZ gs_gsb
	for HJ=1 to gs_hor_gnum+1
		if HJ=1 AND gs_hor_gnum=0 then vgnn=ac_unit_height-gs_fw_upper*(not(gs_UTrans))-gs_frame_width*(gs_UTrans)-middlePanelHeight-gs_fw_lower-midRailWidth
		if HJ=1 AND gs_hor_gnum>0 then vgnn=gs_hor_d[1]-gs_grid_w
		if HJ>1 AND HJ<gs_hor_gnum+1 then vgnn=gs_hor_d[HJ]-gs_hor_d[HJ-1]-gs_grid_w
		if HJ>1 AND HJ=gs_hor_gnum+1 then vgnn=ac_unit_height-gs_fw_upper*(not(gs_UTrans))-gs_frame_width*(gs_UTrans)-middlePanelHeight-gs_hor_d[HJ-1]-gs_fw_lower-midRailWidth

		for HI=1 to gs_ver_gnum+1
			if HI=1 AND gs_ver_gnum=0 then hgnn=ac_unit_width-frameOrSLightWidthLeft-frameOrSLightWidthRight
			if HI=1 AND gs_ver_gnum>0 then hgnn=gs_ver_d[1]-gridWidthVert
			if HI>1 AND HI<gs_ver_gnum+1 then hgnn=gs_ver_d[HI]-gs_ver_d[HI-1]-gridWidthVert
			if HI>1 AND HI=gs_ver_gnum+1 then hgnn=ac_unit_width-gs_ver_d[HI-1]-frameOrSLightWidthLeft-frameOrSLightWidthRight

			ADD -ac_unit_width/2+frameOrSLightWidthLeft, gs_fw_lower,0
			if (iFrameStyleMullion = FRAME_STYLE_BUTT_GLAZED) then
				PRISM_ 5, gs_glass_thk,
					-gs_left_g*(HI=1)*(not(gs_bSLight))-(gridWidthVert-buttGalzedJoint)/2*(HI>1), -(gs_grid_w-buttGalzedJoint)/2*(HJ<>1), 15,
					hgnn+(gridWidthVert-buttGalzedJoint)/2*(HI<gs_ver_gnum+1)+gs_right_g*(HI=gs_ver_gnum+1)*(not(gs_bSLight2)), -(gs_grid_w-buttGalzedJoint)/2*(HJ<>1), 15,
					hgnn+(gridWidthVert-buttGalzedJoint)/2*(HI<gs_ver_gnum+1)+gs_right_g*(HI=gs_ver_gnum+1)*(not(gs_bSLight2)),  vgnn+(gs_grid_w-buttGalzedJoint)/2*(HJ<>gs_hor_gnum+1), 15,
					-gs_left_g*(HI=1)*(not(gs_bSLight))-(gridWidthVert-buttGalzedJoint)/2*(HI>1),  vgnn+(gs_grid_w-buttGalzedJoint)/2*(HJ<>gs_hor_gnum+1), 15,
					-gs_left_g*(HI=1)*(not(gs_bSLight))-(gridWidthVert-buttGalzedJoint)/2*(HI>1), -(gs_grid_w-buttGalzedJoint)/2*(HJ<>1), -1
			else
				PRISM_ 5, gs_glass_thk,
					-gs_left_g*(HI=1)*(not(gs_bSLight)), 0, 15,
					hgnn+gs_right_g*(HI=gs_ver_gnum+1)*(not(gs_bSLight2)), 0, 15,
					hgnn+gs_right_g*(HI=gs_ver_gnum+1)*(not(gs_bSLight2)),  vgnn, 15,
					-gs_left_g*(HI=1)*(not(gs_bSLight)),  vgnn, 15,
					-gs_left_g*(HI=1)*(not(gs_bSLight)), 0, -1
			endif
			body 1

			DEL 1

			ADDX hgnn+gridWidthVert
		next HI
		DEL gs_ver_gnum+1

		if gs_bSLight then
			ADD -ac_unit_width/2+gs_fw_side_left, gs_fw_lower,0
			if iFrameStyleMullion = FRAME_STYLE_BUTT_GLAZED then
				PRISM_ 5, gs_glass_thk,
					-gs_left_g,-(gs_grid_w-buttGalzedJoint)/2*(HJ<>1),15,
					leftPanelWidth-gs_fw_side_left,-(gs_grid_w-buttGalzedJoint)/2*(HJ<>1),15,
					leftPanelWidth-gs_fw_side_left,vgnn+(gs_grid_w-buttGalzedJoint)/2*(HJ<>gs_hor_gnum+1),15,
					-gs_left_g,vgnn+(gs_grid_w-buttGalzedJoint)/2*(HJ<>gs_hor_gnum+1),15,
					-gs_left_g,-(gs_grid_w-buttGalzedJoint)/2*(HJ<>1),-1
			else
				PRISM_ 5, gs_glass_thk,
					-gs_left_g, 0, 15,
					leftPanelWidth-gs_fw_side_left, 0, 15,
					leftPanelWidth-gs_fw_side_left, vgnn, 15,
					-gs_left_g, vgnn, 15,
					-gs_left_g, 0, -1
			endif
			body 1

			DEL 1
		endif

		if gs_bSLight2 then
			ADD +ac_unit_width/2-rightPanelWidth, gs_fw_lower,0
			if iFrameStyleMullion = FRAME_STYLE_BUTT_GLAZED then
				PRISM_ 5, gs_glass_thk,
					0,-(gs_grid_w-buttGalzedJoint)/2*(HJ<>1),15,
					rightPanelWidth-gs_fw_side_right+gs_right_g,-(gs_grid_w-buttGalzedJoint)/2*(HJ<>1),15,
					rightPanelWidth-gs_fw_side_right+gs_right_g,vgnn+(gs_grid_w-buttGalzedJoint)/2*(HJ<>gs_hor_gnum+1),15,
					0,vgnn+(gs_grid_w-buttGalzedJoint)/2*(HJ<>gs_hor_gnum+1),15,
					0,-(gs_grid_w-buttGalzedJoint)/2*(HJ<>1),-1
			else
				PRISM_ 5, gs_glass_thk,
					0, 0, 15,
					rightPanelWidth-gs_fw_side_right+gs_right_g, 0, 15,
					rightPanelWidth-gs_fw_side_right+gs_right_g, vgnn, 15,
					0, vgnn, 15,
					0, 0, -1
			endif
			body 1

			DEL 1
		endif
		ADDY vgnn+gs_grid_w
	next HJ
	DEL gs_hor_gnum+1
	DEL 1
endif
!! END OF GLASS !!

!! TRANSOM GLASS !!

MATERIAL gs_glass_mat
PEN gs_glass_pen

ADDZ gs_gsb

for HW=1 to gs_hor_gnumtr+1
	if HW=1 AND gs_hor_gnumtr=0 then vgnt=middlePanelHeight-topPanelHeight
	if HW=1 AND gs_hor_gnumtr>0 then vgnt=gs_hor_dtr[1]-gs_grid_w
	if HW>1 AND HW<gs_hor_gnumtr+1 then vgnt=gs_hor_dtr[HW]-gs_hor_dtr[HW-1]-gs_grid_w
	if HW>1 AND HW=gs_hor_gnumtr+1 then vgnt=middlePanelHeight-gs_hor_dtr[HW-1]-topPanelHeight

	for HA=1 to gs_ver_gnum+1
		if abs(HA-1)<eps AND gs_ver_gnum=0 then
			hgnn=ac_unit_width-frameOrSLightWidthLeft-frameOrSLightWidthRight
		endif
		if abs(HA-1)<eps AND gs_ver_gnum>0 then hgnn=gs_ver_d[1]-gridWidthVert
		if HA>1 AND HA<gs_ver_gnum+1 then hgnn=gs_ver_d[HA]-gs_ver_d[HA-1]-gridWidthVert
		if HA>1 AND abs(HA-gs_ver_gnum-1)<eps then
			hgnn=ac_unit_width-gs_ver_d[HA-1]-frameOrSLightWidthLeft-frameOrSLightWidthRight
		endif

		if iStorefrontType = 3 then
			ADD -ac_unit_width/2+frameOrSLightWidthLeft, midRailElevation*bMiddleRail+midRailWidth/2-gs_fw_lower*gs_stack_bottom,0
		else
			ADD -ac_unit_width/2+frameOrSLightWidthLeft, midRailElevation*bMiddleRail+midRailWidth/2,0
		endif
		if iFrameStyleMullion = FRAME_STYLE_BUTT_GLAZED then
			PRISM_ 5, gs_glass_thk,
				-gs_left_g*(abs(HA-1)<eps)*(not(gs_bSLight))-(gridWidthVert-buttGalzedJoint)/2*(HA>1), -(gs_grid_w-buttGalzedJoint)/2*(HW<>1), 15,
				hgnn+(gridWidthVert-buttGalzedJoint)/2*(HA<gs_ver_gnum+1)+gs_right_g*(abs(HA-gs_ver_gnum-1)<eps)*(not(gs_bSLight2)), -(gs_grid_w-buttGalzedJoint)/2*(HW<>1), 15,
				hgnn+(gridWidthVert-buttGalzedJoint)/2*(HA<gs_ver_gnum+1)+gs_right_g*(abs(HA-gs_ver_gnum-1)<eps)*(not(gs_bSLight2)),  vgnt+(gs_grid_w-buttGalzedJoint)/2*(HW<>gs_hor_gnumtr+1), 15,
				-gs_left_g*(abs(HA-1)<eps)*(not(gs_bSLight))-(gridWidthVert-buttGalzedJoint)/2*(HA>1),  vgnt+(gs_grid_w-buttGalzedJoint)/2*(HW<>gs_hor_gnumtr+1), 15,
				-gs_left_g*(abs(HA-1)<eps)*(not(gs_bSLight))-(gridWidthVert-buttGalzedJoint)/2*(HA>1), -(gs_grid_w-buttGalzedJoint)/2*(HW<>1), -1
		else
			PRISM_ 5, gs_glass_thk,
				-gs_left_g*(abs(HA-1)<eps)*(not(gs_bSLight)), 0, 15,
				hgnn+gs_right_g*(abs(HA-gs_ver_gnum-1)<eps)*(not(gs_bSLight2)), 0, 15,
				hgnn+gs_right_g*(abs(HA-gs_ver_gnum-1)<eps)*(not(gs_bSLight2)),  vgnt, 15,
				-gs_left_g*(abs(HA-1)<eps)*(not(gs_bSLight)),  vgnt, 15,
				-gs_left_g*(abs(HA-1)<eps)*(not(gs_bSLight)), 0, -1
		endif
		body 1

		DEL 1

		ADDX hgnn+gridWidthVert
	next HA
	DEL gs_ver_gnum+1

	if gs_bSLight then
		ADD -ac_unit_width/2+gs_fw_side_left, midRailElevation*bMiddleRail+midRailWidth/2,0
		if iFrameStyleMullion = FRAME_STYLE_BUTT_GLAZED then
			PRISM_ 5, gs_glass_thk,
				-gs_left_g,-(gs_grid_w-buttGalzedJoint)/2*(HW<>1),15,
				leftPanelWidth-gs_fw_side_left,-(gs_grid_w-buttGalzedJoint)/2*(HW<>1),15,
				leftPanelWidth-gs_fw_side_left,vgnt+(gs_grid_w-buttGalzedJoint)/2*(Hw<>gs_hor_gnumtr+1),15,
				-gs_left_g,vgnt+(gs_grid_w-buttGalzedJoint)/2*(Hw<>gs_hor_gnumtr+1),15,
				-gs_left_g,-(gs_grid_w-buttGalzedJoint)/2*(HW<>1),-1
		else
			PRISM_ 5, gs_glass_thk,
				-gs_left_g, 0, 15,
				leftPanelWidth-gs_fw_side_left, 0, 15,
				leftPanelWidth-gs_fw_side_left, vgnt, 15,
				-gs_left_g, vgnt, 15,
				-gs_left_g, 0, -1
		endif
		body 1

		DEL 1
	endif

	if gs_bSLight2 then
		ADD +ac_unit_width/2-rightPanelWidth, midRailElevation*bMiddleRail+midRailWidth/2,0
		if iFrameStyleMullion = FRAME_STYLE_BUTT_GLAZED then
			PRISM_ 5, gs_glass_thk,
				0,-(gs_grid_w-buttGalzedJoint)/2*(HW<>1),15,
				rightPanelWidth-gs_fw_side_right+gs_right_g,-(gs_grid_w-buttGalzedJoint)/2*(HW<>1),15,
				rightPanelWidth-gs_fw_side_right+gs_right_g,vgnt+(gs_grid_w-buttGalzedJoint)/2*(Hw<>gs_hor_gnumtr+1),15,
				0,vgnt+(gs_grid_w-buttGalzedJoint)/2*(Hw<>gs_hor_gnumtr+1),15,
				0,-(gs_grid_w-buttGalzedJoint)/2*(HW<>1),-1
		else
			PRISM_ 5, gs_glass_thk,
				0, 0, 15,
				rightPanelWidth-gs_fw_side_right+gs_right_g, 0, 15,
				rightPanelWidth-gs_fw_side_right+gs_right_g, vgnt, 15,
				0, vgnt, 15,
				0, 0, -1
		endif
		body 1

		DEL 1
	endif
	ADDY vgnt+gs_grid_w
next HW
DEL gs_hor_gnumtr+1

DEL 1

! END OF TRANSOM GLASS !!

!! TOP PANEL GLASS !!

if gs_UTrans then

MATERIAL gs_glass_mat
PEN gs_glass_pen
ADDZ gs_gsb

for HW=1 to gs_hor_gtp+1
		if HW=1 AND gs_hor_gtp=0 then vgnt=topPanelHeight-gs_fw_upper
		if HW=1 AND gs_hor_gtp>0 then vgnt=gs_hor_dtp[1]-gs_grid_w
		if HW>1 AND HW<gs_hor_gtp+1 then vgnt=gs_hor_dtp[HW]-gs_hor_dtp[HW-1]-gs_grid_w
		if HW>1 AND HW=gs_hor_gtp+1 then vgnt=topPanelHeight-gs_hor_dtp[HW-1]-gs_fw_upper

	for HA=1 to gs_ver_gnum+1
		if iStorefrontType = 5 then
			if abs(HA-1)<eps AND gs_ver_gnum=0 then
				hgnn=ac_unit_width-frameOrSLightWidthLeft-frameOrSLightWidthRight
			endif
		else
			if abs(HA-1)<eps AND gs_ver_gnum=0 then  hgnn=ac_unit_width-gs_fw_side_left-gs_fw_side_right-leftPanelWidth-rightPanelWidth
		endif

		if abs(HA-1)<eps AND gs_ver_gnum>0 then hgnn=gs_ver_d[1]-gridWidthVert
		if HA>1 AND HA<gs_ver_gnum+1 then hgnn=gs_ver_d[HA]-gs_ver_d[HA-1]-gridWidthVert
		if HA>1 AND abs(HA-gs_ver_gnum-1)<eps then
			hgnn=ac_unit_width-gs_ver_d[HA-1]-frameOrSLightWidthLeft-frameOrSLightWidthRight
		endif

		ADD -ac_unit_width/2+frameOrSLightWidthLeft, ac_unit_height-topPanelHeight,0

		if iFrameStyleMullion = FRAME_STYLE_BUTT_GLAZED then
			PRISM_ 5, gs_glass_thk,
				-gs_left_g*(abs(HA-1)<eps)*(not(gs_bSLight))-(gridWidthVert-buttGalzedJoint)/2*(HA>1), -(gs_grid_w-buttGalzedJoint)/2*(HW<>1), 15,
				hgnn+(gridWidthVert-buttGalzedJoint)/2*(HA<gs_ver_gnum+1)+gs_right_g*(abs(HA-gs_ver_gnum-1)<eps)*(not(gs_bSLight2)), -(gs_grid_w-buttGalzedJoint)/2*(HW<>1), 15,
				hgnn+(gridWidthVert-buttGalzedJoint)/2*(HA<gs_ver_gnum+1)+gs_right_g*(abs(HA-gs_ver_gnum-1)<eps)*(not(gs_bSLight2)),  vgnt+(gs_grid_w-buttGalzedJoint)/2*(HW<>gs_hor_gtp+1), 15,
				-gs_left_g*(abs(HA-1)<eps)*(not(gs_bSLight))-(gridWidthVert-buttGalzedJoint)/2*(HA>1),  vgnt+(gs_grid_w-buttGalzedJoint)/2*(HW<>gs_hor_gtp+1), 15,
				-gs_left_g*(abs(HA-1)<eps)*(not(gs_bSLight))-(gridWidthVert-buttGalzedJoint)/2*(HA>1), -(gs_grid_w-buttGalzedJoint)/2*(HW<>1), -1
		else
			PRISM_ 5, gs_glass_thk,
				-gs_left_g*(abs(HA-1)<eps)*(not(gs_bSLight)), 0, 15,
				hgnn+gs_right_g*(abs(HA-gs_ver_gnum-1)<eps)*(not(gs_bSLight2)), 0, 15,
				hgnn+gs_right_g*(abs(HA-gs_ver_gnum-1)<eps)*(not(gs_bSLight2)),  vgnt, 15,
				-gs_left_g*(abs(HA-1)<eps)*(not(gs_bSLight)),  vgnt, 15,
				-gs_left_g*(abs(HA-1)<eps)*(not(gs_bSLight)), 0, -1
		endif
		body 1

		DEL 1
		ADDX hgnn+gridWidthVert
	next HA
	DEL gs_ver_gnum+1

	if gs_bSLight then
		ADD -ac_unit_width/2+gs_fw_side_left,  ac_unit_height-topPanelHeight,0
		if iFrameStyleMullion = FRAME_STYLE_BUTT_GLAZED then
			PRISM_ 5, gs_glass_thk,
				-gs_left_g,-(gs_grid_w-buttGalzedJoint)/2*(HW<>1),15,
				leftPanelWidth-gs_fw_side_left,-(gs_grid_w-buttGalzedJoint)/2*(HW<>1),15,
				leftPanelWidth-gs_fw_side_left,vgnt+(gs_grid_w-buttGalzedJoint)/2*(Hw<>gs_hor_gtp+1),15,
				-gs_left_g,vgnt+(gs_grid_w-buttGalzedJoint)/2*(Hw<>gs_hor_gtp+1),15,
				-gs_left_g,-(gs_grid_w-buttGalzedJoint)/2*(HW<>1),-1
		else
			PRISM_ 5, gs_glass_thk,
				-gs_left_g, 0, 15,
				leftPanelWidth-gs_fw_side_left, 0, 15,
				leftPanelWidth-gs_fw_side_left, vgnt, 15,
				-gs_left_g, vgnt, 15,
				-gs_left_g, 0, -1
		endif
		body 1

		DEL 1
	endif

	if gs_bSLight2 then
		ADD ac_unit_width/2-rightPanelWidth, ac_unit_height-topPanelHeight,0
		if iFrameStyleMullion = FRAME_STYLE_BUTT_GLAZED then
			PRISM_ 5, gs_glass_thk,
				0,-(gs_grid_w-buttGalzedJoint)/2*(HW<>1),15,
				rightPanelWidth-gs_fw_side_right+gs_right_g,-(gs_grid_w-buttGalzedJoint)/2*(HW<>1),15,
				rightPanelWidth-gs_fw_side_right+gs_right_g,vgnt+(gs_grid_w-buttGalzedJoint)/2*(Hw<>gs_hor_gtp+1),15,
				0,vgnt+(gs_grid_w-buttGalzedJoint)/2*(Hw<>gs_hor_gtp+1),15,
				0,-(gs_grid_w-buttGalzedJoint)/2*(HW<>1),-1
		else
			PRISM_ 5, gs_glass_thk,
				0, 0, 15,
				rightPanelWidth-gs_fw_side_right+gs_right_g, 0, 15,
				rightPanelWidth-gs_fw_side_right+gs_right_g, vgnt, 15,
				0, vgnt, 15,
				0, 0, -1
		endif
		body 1

		DEL 1
	endif
	ADDY vgnt+gs_grid_w
next HW
DEL gs_hor_gtp+1

DEL 1

endif
!! END OF TOP PANEL GLASS !!

if gs_cl=1 then CUTEND
if gs_cr=1 then CUTEND

end


"leftFrameSimpleMittered":
	Prism_ 4, gs_fthk,
		leftFrame, topFrame, mask4,
		leftFrame, bottomFrame, 10,
		-ac_unit_width/2+gs_fw_side_left, gs_fw_lower, 15,
		-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 10
return

"rightFrameSimpleMittered":
		Prism_ 4, gs_fthk,
			rightFrame, bottomFrame,mask2,
			rightFrame, topFrame, 10,
			ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 15,
			ac_unit_width/2-gs_fw_side_right, gs_fw_lower, 10
return

"leftFrameSimpleButtJoint":
	Prism_ 4, gs_fthk,
		leftFrame, ac_unit_height-gs_fw_upper, mask4,
		leftFrame, gs_fw_lower, 10,
		-ac_unit_width/2+gs_fw_side_left, gs_fw_lower, 15,
		-ac_unit_width/2+gs_fw_side_left, ac_unit_height-gs_fw_upper, 10
return

"rightFrameSimpleButtJoint":

	Prism_ 4, gs_fthk,
		rightFrame, gs_fw_lower, mask2,
		rightFrame, ac_unit_height-gs_fw_upper, 8,
		ac_unit_width/2-gs_fw_side_right, ac_unit_height-gs_fw_upper, 15,
		ac_unit_width/2-gs_fw_side_right, gs_fw_lower, 10
return

"textures1":
			vert 0, 0, 0
			vert 0, 1, 0
			vert 1, 0, 0
			vert 0, 0, 1
			coor 2, -1, -2, -3, -4

return
"textures2":
			vert 0, 0, 0
			vert 1, 0, 0
			vert 0, 1, 0
			vert 0, 0, 1
			coor 2, -1, -2, -3, -4

return

