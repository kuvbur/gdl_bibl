<?xml version="1.0" encoding="UTF-8"?>
<Symbol IsArchivable="false" IsPlaceable="true" MainGUID="0CA8B983-622A-4EA3-A889-EA29723E6D06" MigrationValue="Normal" Owner="1196638531" Signature="1196644685" Version="38">
<Ancestry SectVersion="1" SectionFlags="0" SubIdent="0" Template="false">
	<MainGUID>F938E33A-329D-4A36-BE3E-85E126820996</MainGUID>
	<MainGUID>B176ABF1-5813-478F-926B-28EE7C5DC1F7</MainGUID>
	<MainGUID>4FD10D67-2F29-4844-A65A-6597589B0CB5</MainGUID>
	<MainGUID>E861C53A-AE47-47A1-8AE8-D815C1B6E49A</MainGUID>
</Ancestry>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_3D SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_3D>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_2D SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[
n = REQUEST ("program_info", "", name, version)
if version+EPS>22 then
	AC_TextFont = AC_TextFont_1
	AC_TextSize = AC_TextSize_1
	AC_TextPen = AC_TextPen_1
	AC_TextStyle = AC_TextStyle_1
endif

! ==============================================================================
! Input Parameter Definitions
! ==============================================================================

n = request ("HomeDB_info", "", n, AC_LayoutNumber, AC_LayoutName, n)
n = request ("Name_of_plan", "", n, AC_ProjectName, AC_ProjectPath)

if gs_drawing_name_custom then
	drawingName = gs_drawing_name_custom_text
else
	if AC_SourceFileName <> "" & gs_drawing_name_extension then
		drawingName = AC_SourceFileName
	else
		drawingName = AC_DrawingName
	endif
endif

dim type_drw[]
	type_drw[1] = "АР"
	type_drw[2] = "АС"
	type_drw[3] = "КР"
	type_drw[4] = "КЖ"
	type_drw[5] = "КМ"
	type_drw[6] = "ОВ"
	type_drw[7] = "ТХ"
	type_drw[8] = "ЭМ"
	type_drw[9] = "ТС"
	type_drw[10] = "АТХ"
	type_drw[11] = "АТХ"

if gs_drawing_scale_original then
	drawingScale			= gs_drawing_scale_prefix + AC_OriginalDrawingScale
else
	drawingScale			= gs_drawing_scale_prefix + AC_DrawingScale
endif
drawingNumber			= gs_drawing_number_prefix + AC_DrawingNumber
drawingMagnification	= STR(AC_Magnification, 1,0) + gs_drawing_magn_suffix
layoutNumber			= gs_layout_number_prefix + AC_LayoutNumber
	if gs_debug then
		pen 10
		crossSize = 0.01
		line2 -crossSize,-crossSize, crossSize, crossSize	! Origo
		line2  crossSize,-crossSize,-crossSize, crossSize
	endif
	
	if bPositioningPreview then
		if gs_position_side_int = 1 | gs_position_side_int = 4 then		! Top or Bottom
			previewRatio = titleRectX / savedTitleRectX
		else
			previewRatio = titleRectY / savedTitleRectY
		endif
		gs_title_width_paper = GLOB_SCALE * gs_title_width_paper * previewRatio / 100
		gs_offset_paper = 30 * gs_offset_paper
	endif
	
	gs_title_width = gs_title_width_paper * GLOB_SCALE
	gs_offset = gs_offset_paper * GLOB_SCALE
	
	hID = 1		! Hotspot ID
	
	if AC_UseUniformTextFormat then
		gs_drawing_name_font_type		= AC_TextFont
		gs_drawing_name_font_size		= AC_TextSize
		gs_drawing_name_font_pen		= AC_TextPen
		drawingNameFontStyle			= AC_TextStyle
	
		gs_backref_font_type			= AC_TextFont
		gs_backref_font_size			= AC_TextSize
		gs_backref_font_pen				= AC_TextPen
		backrefFontStyle				= AC_TextStyle
	
		gs_drawing_scale_font_type		= AC_TextFont
		gs_drawing_scale_font_size		= AC_TextSize
		gs_drawing_scale_font_pen		= AC_TextPen
		drawingScaleFontStyle			= AC_TextStyle
	
		gs_drawing_number_font_type		= AC_TextFont
		gs_drawing_number_font_size		= AC_TextSize
		gs_drawing_number_font_pen		= AC_TextPen
		drawingNumberFontStyle			= AC_TextStyle
	
		gs_source_filename_font_type	= AC_TextFont
		gs_source_filename_font_size	= AC_TextSize
		gs_source_filename_font_pen		= AC_TextPen
		sourceFileNameFontStyle			= AC_TextStyle
	
		gs_drawing_magn_font_type		= AC_TextFont
		gs_drawing_magn_font_size		= AC_TextSize
		gs_drawing_magn_font_pen		= AC_TextPen
		drawingMagnFontStyle			= AC_TextStyle
	
		gs_project_filename_font_type	= AC_TextFont
		gs_project_filename_font_size	= AC_TextSize
		gs_project_filename_font_pen	= AC_TextPen
		projectFileNameFontStyle		= AC_TextStyle
	
		gs_layout_name_font_type		= AC_TextFont
		gs_layout_name_font_size		= AC_TextSize
		gs_layout_name_font_pen			= AC_TextPen
		layoutNameFontStyle				= AC_TextStyle
	
		gs_layout_number_font_type		= AC_TextFont
		gs_layout_number_font_size		= AC_TextSize
		gs_layout_number_font_pen		= AC_TextPen
		layoutNumberFontStyle			= AC_TextStyle
	else
		drawingNameFontStyle		= gs_drawing_name_font_bold + 2 * gs_drawing_name_font_italic + 4 * gs_drawing_name_font_under
		drawingNumberFontStyle		= gs_drawing_number_font_bold + 2 * gs_drawing_number_font_italic + 4 * gs_drawing_number_font_under
		drawingScaleFontStyle		= gs_drawing_scale_font_bold + 2 * gs_drawing_scale_font_italic + 4 * gs_drawing_scale_font_under
		sourceFileNameFontStyle		= gs_source_filename_font_bold + 2 * gs_source_filename_font_italic + 4 * gs_source_filename_font_under
		drawingMagnFontStyle		= gs_drawing_magn_font_bold + 2 * gs_drawing_magn_font_italic + 4 * gs_drawing_magn_font_under
		projectFileNameFontStyle	= gs_project_filename_font_bold + 2 * gs_project_filename_font_italic + 4 * gs_project_filename_font_under
		layoutNameFontStyle			= gs_layout_name_font_bold + 2 * gs_layout_name_font_italic + 4 * gs_layout_name_font_under
		layoutNumberFontStyle		= gs_layout_number_font_bold + 2 * gs_layout_number_font_italic + 4 * gs_layout_number_font_under
		backrefFontStyle			= gs_backref_font_bold + 2 * gs_backref_font_italic + 4 * gs_backref_font_under
	endif
	
	bInside = (AC_titleFitMode = 2 | AC_titleFitMode = 3)	! Layout or Cell; Position of the title inside or outside the drawing
	
	anchorDrawingNumber			= 1
	anchorLayoutNumber			= 1
	anchorDrawingName			= 2
	anchorDrawingScale			= 3
	anchorSourceFileName		= 7
	anchorDrawingMagnification	= 7
	anchorProjectFileName		= 7
	anchorLayoutName			= 7
	anchorBackRef				= 1
	
	define style "styleDrawingName" 	gs_drawing_name_font_type,
										gs_drawing_name_font_size,
										anchorDrawingName,
										drawingNameFontStyle
	
	define style "styleBackref" 		gs_backref_font_type,
										gs_backref_font_size,
										anchorBackRef,
										backrefFontStyle
	
	define style "styleDrawingScale"	gs_drawing_scale_font_type,
										gs_drawing_scale_font_size,
										anchorDrawingScale,
										drawingScaleFontStyle
	
	define style "styleDrawingNumber"	gs_drawing_number_font_type,
										gs_drawing_number_font_size,
										anchorDrawingNumber,
										drawingNumberFontStyle
	
	define style "styleSourceFileName" 	gs_source_filename_font_type,
										gs_source_filename_font_size,
										anchorSourceFileName,
										sourceFileNameFontStyle
	
	define style "styleDrawingMagnification" 	gs_drawing_magn_font_type,
												gs_drawing_magn_font_size,
												anchorDrawingMagnification,
												drawingMagnFontStyle
	
	define style "styleProjectFilename" gs_project_filename_font_type,
										gs_project_filename_font_size,
										anchorProjectFileName,
										projectFileNameFontStyle
	
	define style "styleLayoutName" 		gs_layout_name_font_type,
										gs_layout_name_font_size,
										anchorLayoutName,
										layoutNameFontStyle
	
	define style "styleLayoutNumber"	gs_layout_number_font_type,
										gs_layout_number_font_size,
										anchorLayoutNumber,
										layoutNumberFontStyle
	
	
	
	if gs_debug & GLOB_CONTEXT <> 5 then
		pen 10
		circle2 AC_LayoutRect[1], AC_LayoutRect[2], 0.01
		circle2 AC_LayoutRect[3], AC_LayoutRect[4], 0.01
	
		pen 7
		circle2 AC_GridRect[1], AC_GridRect[2], 0.01
		circle2 AC_GridRect[3], AC_GridRect[4], 0.01
	
		pen 4
		circle2 AC_DrawingRect[1], AC_DrawingRect[2], 0.01
		circle2 AC_DrawingRect[3], AC_DrawingRect[4], 0.01
	endif

	! ==============================================================================
	! Draw Title
	! ==============================================================================
	
	if gs_debug then
	
		add2 titlePosX, titlePosY
		rot2 titleAlpha
	
		if not(AC_ManualPosition) then
			rect2 0,0, titleRectX, titleRectY	! Selected Drawing
	
			hotspot2 0,0
			hotspot2 0, titleRectY
			hotspot2 titleRectX, 0
			hotspot2 titleRectX, titleRectY
		endif
	
		del 2
	endif
	
	
	! ==============================================================================
	! Precalculations
	! ==============================================================================
	
	drawingNameFontH	 = gs_show_drawing_name *			(1.6 * PAPER_TO_MODEL * gs_drawing_name_font_size)
	drawingScaleFontH	 = gs_show_drawing_scale *			(1.6 * PAPER_TO_MODEL * gs_drawing_scale_font_size)
	drawingNumberFontH	 = gs_show_drawing_number *			(1.6 * PAPER_TO_MODEL * gs_drawing_number_font_size)
	sourceFileNameFontH	 = gs_show_source_filename *		(1.6 * PAPER_TO_MODEL * gs_source_filename_font_size)
	drawingMagnFontH	 = gs_show_drawing_magnification *	(1.6 * PAPER_TO_MODEL * gs_drawing_magn_font_size)
	projectFileNameFontH = gs_show_project_filename *		(1.6 * PAPER_TO_MODEL * gs_project_filename_font_size)
	layoutNameFontH		 = gs_show_layout_name *			(1.6 * PAPER_TO_MODEL * gs_layout_name_font_size)
	layoutNumberFontH	 = gs_show_layout_number *			(1.6 * PAPER_TO_MODEL * gs_layout_number_font_size)
	backrefFontH		 = AC_ShowDrawingReferences *		(1.6 * PAPER_TO_MODEL * gs_backref_font_size)
	
	
	if not(gs_link_title_width) | AC_ManualPosition then
		titleWidth = gs_title_width
	else
		if gs_position_side_int = 1 | gs_position_side_int = 4 then		! Top or Bottom
			titleWidth = titleRectX
		else
			titleWidth = titleRectY
		endif
	endif
	
	titleHeight = max(drawingNameFontH, drawingScaleFontH, drawingNumberFontH, layoutNumberFontH)
	
	
	! ==============================================================================
	! Positioning
	! ==============================================================================
	
	if SYMB_MIRRORED & not(bPositioningPreview) then mul2 -1, 1
	if GLOB_CONTEXT = 5 then rot2 -SYMB_ROTANGLE
	
	add2 titlePosX, titlePosY
	rot2 titleAlpha
	
	if gs_position_side_int = 1 then		! Top
		if bInside then
			add2 0,titleRectY - gs_offset
		else
			add2 0,titleRectY + titleHeight + gs_offset
		endif
	endif
	if gs_position_side_int = 2 then		! Left
		if bInside then
			add2 gs_offset, 0
		else
			if bSpecPos then
				add2 -gs_offset - titleWidth, 0
			else
				add2 -gs_offset - titleHeight, 0
			endif
		endif
		rot2 (gs_title_rotate_with_position) * 90
	endif
	if gs_position_side_int = 3 then		! Right
		if bInside then
			add2 titleRectX - titleHeight - gs_offset, 0
		else
			add2 titleRectX + gs_offset, 0
		endif
		rot2 (gs_title_rotate_with_position) * 90
	endif
	if gs_position_side_int = 4 then		! Bottom
		if bInside then
			add2 0, titleHeight + gs_offset
		else
			add2 0, -gs_offset
		endif
	endif
	
	if AC_titleFitMode = 1 & not(gs_title_rotate_with_position) then
		if gs_title_rotate_with_drawing then
			rot2 -gs_title_rotation_angle
		else
			rot2 -titleAlpha - SYMB_ROTANGLE - gs_title_rotation_angle
		endif
	endif
	
	if not(gs_link_title_width) | AC_ManualPosition then
		if gs_position_alignment_int = 1 then	! Left
			if bSpecPos then
				add2 -fitToFrameOffset, titleHeight
			else
				add2 -fitToFrameOffset, 0
			endif
	
			hotspot2  0,				-titleHeight,	hID,	gs_title_width, 1 + (AC_ManualPosition + 1) * 128,	gs_title_width_paper
			hotspot2 -1,				-titleHeight,	hID+1,	gs_title_width, 3,									gs_title_width_paper
			hotspot2  gs_title_width,	-titleHeight,	hID+2,	gs_title_width, 2,									gs_title_width_paper
			hID = hID + 3
	
			add2 0, 0
		endif
		if gs_position_alignment_int = 2 then	! Center
			if bSpecPos then
				add2 -(titleRectY - gs_title_width) / 2, (titleRectY + titleHeight) / 2
			else
				add2 0, 0
			endif
	
			if gs_position_side_int = 1 | gs_position_side_int = 4 then	! Top or Bottom
				hotspot2 titleRectX / 2,						-titleHeight,	hID,	gs_title_half_width, 1 + 128,	gs_title_width_paper
				hotspot2 titleRectX / 2 - 1,					-titleHeight,	hID+1,	gs_title_half_width, 3,			gs_title_width_paper
				hotspot2 titleRectX / 2 + gs_title_half_width,	-titleHeight,	hID+2,	gs_title_half_width, 2,			gs_title_width_paper
				hID = hID + 3
	
				hotspot2 titleRectX / 2,						-titleHeight,	hID,	gs_title_half_width, 1 + 128,	gs_title_width_paper
				hotspot2 titleRectX / 2 + 1,					-titleHeight,	hID+1,	gs_title_half_width, 3,			gs_title_width_paper
				hotspot2 titleRectX / 2 - gs_title_half_width,	-titleHeight,	hID+2,	gs_title_half_width, 2,			gs_title_width_paper
				hID = hID + 3
	
				add2 (titleRectX - gs_title_width) / 2, 0
			else
				hotspot2 titleRectY / 2,						-titleHeight,	hID,	gs_title_half_width, 1 + 128,	gs_title_width_paper
				hotspot2 titleRectY / 2 - 1,					-titleHeight,	hID+1,	gs_title_half_width, 3,			gs_title_width_paper
				hotspot2 titleRectY / 2 + gs_title_half_width,	-titleHeight,	hID+2,	gs_title_half_width, 2,			gs_title_width_paper
				hID = hID + 3
	
				hotspot2 titleRectY / 2,						-titleHeight,	hID,	gs_title_half_width, 1 + 128,	gs_title_width_paper
				hotspot2 titleRectY / 2 + 1,					-titleHeight,	hID+1,	gs_title_half_width, 3,			gs_title_width_paper
				hotspot2 titleRectY / 2 - gs_title_half_width,	-titleHeight,	hID+2,	gs_title_half_width, 2,			gs_title_width_paper
				hID = hID + 3
	
				add2 (titleRectY - gs_title_width) / 2, 0
			endif
		endif
		if gs_position_alignment_int = 3 then	! Right
			if bSpecPos then
				add2 -titleRectY + titleWidth, titleRectY
			else
				add2 fitToFrameOffset, 0
			endif
	
			if gs_position_side_int = 1 | gs_position_side_int = 4 then	! Top or Bottom
				hotspot2 titleRectX,					-titleHeight,	hID,	gs_title_width, 1 + (AC_ManualPosition + 1) * 128,	gs_title_width_paper
				hotspot2 titleRectX + 1,				-titleHeight,	hID+1,	gs_title_width, 3,									gs_title_width_paper
				hotspot2 titleRectX - gs_title_width,	-titleHeight,	hID+2,	gs_title_width, 2,									gs_title_width_paper
				hID = hID + 3
	
				add2 titleRectX - gs_title_width, 0
			else
				hotspot2 titleRectY,					-titleHeight,	hID,	gs_title_width, 1 + (AC_ManualPosition + 1) * 128,	gs_title_width_paper
				hotspot2 titleRectY + 1,				-titleHeight,	hID+1,	gs_title_width, 3,									gs_title_width_paper
				hotspot2 titleRectY - gs_title_width,	-titleHeight,	hID+2,	gs_title_width, 2,									gs_title_width_paper
				hID = hID + 3
	
				add2 titleRectY - gs_title_width, 0
			endif
		endif
	else
		add2 0,0	! Empty transformation
	endif
	
	if SYMB_MIRRORED & not(bPositioningPreview) then
		add2 gs_title_width,0
		mul2 -1, 1
	endif
	
	
	! ==============================================================================
	! Title Preview
	! ==============================================================================
	
	if bPositioningPreview then
		pen gs_frame_pen
		line_type gs_frame_linetype
	
		fill gs_frame_fill
	
		poly2_b 4, 7, gs_frame_fill_fg, gs_frame_fill_bg,
			0,			 0,					1,
			0,			-titleHeight,		1,
			titleWidth,	-titleHeight,		1,
			titleWidth,	 0,					1
	endif
	
	
	! ==============================================================================
	! Drawing Title
	! ==============================================================================
	
	if not(bPositioningPreview) then
	
	! Marker =======================================================================
	
	!	! Marker
	!	gosub 100
	
		! Drawing Number
		posX = 0
		posY = -titleHeight + drawingNumberFontH
		gosub 202
	
		! Layout Number
		posX = 0
		posY = -titleHeight + layoutNumberFontH
		gosub 207
	
	
	! Lines ========================================================================
	
!		pen gs_title_pen
!		line_type gs_title_linetype
!	
!		line2 0, -titleHeight, titleWidth,-titleHeight
!	
!		hotline2 0, -titleHeight, titleWidth,-titleHeight
!		hotspot2 0, -titleHeight
!		hotspot2 titleWidth,-titleHeight
	
	! Data =========================================================================
	
		! Drawing Name
		posX = titleWidth / 2
		posY = -titleHeight + drawingNameFontH
		gosub 200
	
		! Drawing Scale
		posX = titleWidth
		posY = -titleHeight + drawingScaleFontH
		gosub 201
	
		! Layout ID Separator
		if AC_ShowDrawingReferences then
	
		posX = 0
		posY = -titleHeight *2
	
			hotspot2 posX,								posY + gs_backref_pos_y,	hID,	gs_backref_pos_x, 1+128
			hotspot2 posX - 1,							posY + gs_backref_pos_y,	hID+1,	gs_backref_pos_x, 3
			hotspot2 posX + gs_backref_pos_x,	posY + gs_backref_pos_y,	hID+2,	gs_backref_pos_x, 2
			hID = hID + 3
	
			hotspot2 posX + gs_backref_pos_x,	posY,							hID,	gs_backref_pos_y, 1+128
			hotspot2 posX + gs_backref_pos_x,	posY - 1,						hID+1,	gs_backref_pos_y, 3
			hotspot2 posX + gs_backref_pos_x,	posY + gs_backref_pos_y,	hID+2,	gs_backref_pos_y, 2
			hID = hID + 3
	
!		if gs_backref_custom=0 then
!	
!	
!			STYLE styleBackref
!			pen gs_backref_font_pen
!	
!	
!				TEXT2 posX+ gs_backref_pos_x,-backrefFontH+gs_backref_pos_y,gs_backref_prefix+"<BACKREFSHEETNUMBER_R><DUMMY><"+ gs_backref_separator + ">" + AC_BackReferenceGUIDList[1]
!		else
!	
!			set style "styleBackref"
!			pen gs_backref_font_pen
!				TEXT2 posX+ gs_backref_pos_x ,-titleHeight+gs_backref_pos_y,gs_backref_prefix+gs_backref_customtxt
!		endif
	
		endif
	endif
	
	
	del 4 + 2 * (SYMB_MIRRORED & not(bPositioningPreview))
	
	! ==============================================================================
	
	end

100:
! ==============================================================================
! Drawing title marker symbol
! ==============================================================================
! in:
!	titleWidth:
!	titleHeight:
! out:
!	upperLineDx:
!	middleLineDx:
!	bottomLineDx
! ==============================================================================

	if not(gs_show_symbol) then		! Off
		upperLineDx		= 0
		bottomLineDx	= 0

		bHaveMarkerData = (gs_show_drawing_number | gs_show_layout_number)

		if bHaveMarkerData then
			middleLineDx	= titleHeight
		else
			middleLineDx	= 0
		endif
	else
		pen gs_symbol_pen
		fill gs_symbol_fill

		poly2_b 2, 7, gs_symbol_fill_fg, gs_symbol_fill_bg,
			titleWidth - titleHeight / 2, -titleHeight / 2, 901,
			titleHeight / 2, 360, 4001

		upperLineDx		= titleHeight / 2
		middleLineDx	= titleHeight
		bottomLineDx	= titleHeight / 2
	endif
return



200:
! ==============================================================================
! Text Drawing Name
! ==============================================================================
! in:
!	posX:	position X
!	posY:	position Y
! ==============================================================================

	if gs_show_drawing_name then

		set style "styleDrawingName"
		pen gs_drawing_name_font_pen

		if (GLOB_CONTEXT = 22 | GLOB_CONTEXT = 28) & (gs_GLOB_MODPAR_NAME = "gs_drawing_name_pos_x" | gs_GLOB_MODPAR_NAME = "gs_drawing_name_pos_y") then
			textWidth	= stw(drawingName) * PAPER_TO_MODEL
			textHeight	= drawingNameFontH
			textAnchor	= anchorDrawingName
			gosub 300

			add2 anchorX, anchorY

			rect2 posX + gs_drawing_name_pos_x,				posY + gs_drawing_name_pos_y,
				  posX + gs_drawing_name_pos_x + textWidth,	posY + gs_drawing_name_pos_y + textHeight
			del 1
		else
		if AC_ShowDrawingReferences then
			if not(gs_backref_custom) then
					backr = "<BACKREFSHEETNUMBER_R><DUMMY><" + gs_backref_separator + ">" + AC_BackReferenceGUIDList[1]
			else
					backr = gs_backref_customtxt
			endif
			d1 = " (см. лист "
			d2 = ")"
		else
			backr = ""
			d1 = ""
			d2 = ""
		endif

			if vartype(drawingName)=2 then
				for j=1 to vardim1(type_drw)
					t_type_drw = "."+type_drw[j]
					lend = STRLEN(t_type_drw)
					tend = STRSUB(drawingName, STRLEN(drawingName)-lend+1, lend)
					if tend=t_type_drw then drawingName = STRSUB(drawingName, 1, STRLEN(drawingName)-lend)
					t_type_drw = type_drw[j]+"."
					first_str = STRSUB (drawingName, 1, lend)
					if first_str = t_type_drw then drawingName = STRSUB (drawingName, lend+1, STRLEN(drawingName))
				next j
			endif
			if vartype(drawingNumber)=2 then
				for j=1 to vardim1(type_drw)
					t_type_drw = "."+type_drw[j]
					lend = STRLEN(t_type_drw)
					tend = STRSUB(drawingNumber, STRLEN(drawingNumber)-lend+1, lend)
					if tend=t_type_drw then drawingNumber = STRSUB(drawingNumber, 1, STRLEN(drawingNumber)-lend)
					t_type_drw = type_drw[j]+"."
					first_str = STRSUB (drawingNumber, 1, lend)
					if first_str = t_type_drw then drawingNumber = STRSUB (drawingNumber, lend+1, STRLEN(drawingNumber))
				next j
			endif

			if drawingNumber <> "спец" and drawingNumber <> "с" then
				if STRSTR(drawingName,"Узел")=0 then
					if STRSTR(drawingName,"Разрез")<>0 and STRSTR(drawingName,"по оси")=0 then drawingName=drawingName+" "+drawingNumber+"-"+drawingNumber
					if STRSTR(drawingName,"Вид")<>0 then drawingName=drawingName+" "+drawingNumber
					text2 posX + gs_drawing_name_pos_x, posY + gs_drawing_name_pos_y, drawingName + d1 + backr + d2
				else
					drawingName=drawingNumber
					line_type 1
					CIRCLE2 posX + gs_drawing_name_pos_x, posY + gs_drawing_name_pos_y,radi
					if backr = "" then
						text2 posX + gs_drawing_name_pos_x, posY + gs_drawing_name_pos_y+drawingNameFontH*0.4, drawingNumber
					else
						text2 posX + gs_drawing_name_pos_x, posY + gs_drawing_name_pos_y+drawingNameFontH*0.8, drawingNumber
						text2 posX + gs_drawing_name_pos_x, posY + gs_drawing_name_pos_y-drawingNameFontH*0.2, backr
						line2 posX + gs_drawing_name_pos_x + radi, posY + gs_drawing_name_pos_y,posX + gs_drawing_name_pos_x-radi, posY + gs_drawing_name_pos_y
					endif
					line_type gs_title_linetype
				endif
			endif
		endif
!==========================================================================================================================================================================================================
		hotspot2 posX,							posY + gs_drawing_name_pos_y,	hID,	gs_drawing_name_pos_x, 1+128,	gs_drawing_name_pos_x_paper
		hotspot2 posX - 1,						posY + gs_drawing_name_pos_y,	hID+1,	gs_drawing_name_pos_x, 3,		gs_drawing_name_pos_x_paper
		hotspot2 posX + gs_drawing_name_pos_x,	posY + gs_drawing_name_pos_y,	hID+2,	gs_drawing_name_pos_x, 2,		gs_drawing_name_pos_x_paper
		hID = hID + 3

		hotspot2 posX + gs_drawing_name_pos_x,	posY,							hID,	gs_drawing_name_pos_y, 1+128,	gs_drawing_name_pos_y_paper
		hotspot2 posX + gs_drawing_name_pos_x,	posY - 1,						hID+1,	gs_drawing_name_pos_y, 3,		gs_drawing_name_pos_y_paper
		hotspot2 posX + gs_drawing_name_pos_x,	posY + gs_drawing_name_pos_y,	hID+2,	gs_drawing_name_pos_y, 2,		gs_drawing_name_pos_y_paper
		hID = hID + 3
	endif
return

201:
! ==============================================================================
! Text Drawing Scale
! ==============================================================================
! in:
!	posX:	position X
!	posY:	position Y
! ==============================================================================

	if gs_show_drawing_scale then

		set style "styleDrawingScale"
		pen gs_drawing_scale_font_pen

		if (GLOB_CONTEXT = 22 | GLOB_CONTEXT = 28) & (gs_GLOB_MODPAR_NAME = "gs_drawing_scale_pos_x" | gs_GLOB_MODPAR_NAME = "gs_drawing_scale_pos_y") then
			textWidth	= stw(drawingScale) * PAPER_TO_MODEL
			textHeight	= drawingScaleFontH
			textAnchor	= anchorDrawingScale
			gosub 300

			add2 anchorX, anchorY

			rect2 posX + gs_drawing_scale_pos_x,				posY + gs_drawing_scale_pos_y,
				  posX + gs_drawing_scale_pos_x + textWidth,	posY + gs_drawing_scale_pos_y + textHeight
			del 1
		else
			text2 posX + gs_drawing_scale_pos_x, posY + gs_drawing_scale_pos_y, drawingScale
		endif

		hotspot2 posX,							posY + gs_drawing_scale_pos_y,	hID,	gs_drawing_scale_pos_x, 1+128
		hotspot2 posX - 1,						posY + gs_drawing_scale_pos_y,	hID+1,	gs_drawing_scale_pos_x, 3
		hotspot2 posX + gs_drawing_scale_pos_x,	posY + gs_drawing_scale_pos_y,	hID+2,	gs_drawing_scale_pos_x, 2
		hID = hID + 3

		hotspot2 posX + gs_drawing_scale_pos_x,	posY,							hID,	gs_drawing_scale_pos_y, 1+128
		hotspot2 posX + gs_drawing_scale_pos_x,	posY - 1,						hID+1,	gs_drawing_scale_pos_y, 3
		hotspot2 posX + gs_drawing_scale_pos_x,	posY + gs_drawing_scale_pos_y,	hID+2,	gs_drawing_scale_pos_y, 2
		hID = hID + 3
	endif
return

202:
! ==============================================================================
! Text Drawing Number
! ==============================================================================
! in:
!	posX:	position X
!	posY:	position Y
! ==============================================================================

	if gs_show_drawing_number then

		set style "styleDrawingNumber"
		pen gs_drawing_number_font_pen

		if (GLOB_CONTEXT = 22 | GLOB_CONTEXT = 28) & (gs_GLOB_MODPAR_NAME = "gs_drawing_number_pos_x" | gs_GLOB_MODPAR_NAME = "gs_drawing_number_pos_y") then
			textWidth	= stw(drawingNumber) * PAPER_TO_MODEL
			textHeight	= drawingNumberFontH
			textAnchor	= anchorDrawingNumber
			gosub 300

			add2 anchorX, anchorY

			rect2 posX + gs_drawing_number_pos_x,				posY + gs_drawing_number_pos_y,
				  posX + gs_drawing_number_pos_x + textWidth,	posY + gs_drawing_number_pos_y + textHeight
			del 1
		else
			text2 posX + gs_drawing_number_pos_x, posY + gs_drawing_number_pos_y, drawingNumber
		endif

		hotspot2 posX,								posY + gs_drawing_number_pos_y,	hID,	gs_drawing_number_pos_x, 1+128
		hotspot2 posX - 1,							posY + gs_drawing_number_pos_y,	hID+1,	gs_drawing_number_pos_x, 3
		hotspot2 posX + gs_drawing_number_pos_x,	posY + gs_drawing_number_pos_y,	hID+2,	gs_drawing_number_pos_x, 2
		hID = hID + 3

		hotspot2 posX + gs_drawing_number_pos_x,	posY,							hID,	gs_drawing_number_pos_y, 1+128
		hotspot2 posX + gs_drawing_number_pos_x,	posY - 1,						hID+1,	gs_drawing_number_pos_y, 3
		hotspot2 posX + gs_drawing_number_pos_x,	posY + gs_drawing_number_pos_y,	hID+2,	gs_drawing_number_pos_y, 2
		hID = hID + 3
	endif
return

!203:
!! ==============================================================================
!! Text Drawing Path
!! ==============================================================================
!! in:
!!	posX:	position X
!!	posY:	position Y
!! ==============================================================================
!
!	if gs_show_source_filename then
!
!		set style "styleSourceFileName"
!		pen gs_source_filename_font_pen
!
!		if (GLOB_CONTEXT = 22 | GLOB_CONTEXT = 28) & (gs_GLOB_MODPAR_NAME = "gs_source_filename_pos_x" | gs_GLOB_MODPAR_NAME = "gs_source_filename_pos_y") then
!			textWidth	= stw(drawingPath) * PAPER_TO_MODEL
!			textHeight	= sourceFileNameFontH
!			textAnchor	= anchorSourceFileName
!			gosub 300
!
!			add2 anchorX, anchorY
!
!			rect2 posX + gs_source_filename_pos_x,				posY + gs_source_filename_pos_y,
!				  posX + gs_source_filename_pos_x + textWidth,	posY + gs_source_filename_pos_y + textHeight
!			del 1
!		else
!			text2 posX + gs_source_filename_pos_x, posY + gs_source_filename_pos_y, drawingPath
!		endif
!
!		hotspot2 posX,								posY + gs_source_filename_pos_y,	hID,	gs_source_filename_pos_x, 1+128
!		hotspot2 posX - 1,							posY + gs_source_filename_pos_y,	hID+1,	gs_source_filename_pos_x, 3
!		hotspot2 posX + gs_source_filename_pos_x,	posY + gs_source_filename_pos_y,	hID+2,	gs_source_filename_pos_x, 2
!		hID = hID + 3
!
!		hotspot2 posX + gs_source_filename_pos_x,	posY,								hID,	gs_source_filename_pos_y, 1+128
!		hotspot2 posX + gs_source_filename_pos_x,	posY - 1,							hID+1,	gs_source_filename_pos_y, 3
!		hotspot2 posX + gs_source_filename_pos_x,	posY + gs_source_filename_pos_y,	hID+2,	gs_source_filename_pos_y, 2
!		hID = hID + 3
!	endif
!return

204:
! ==============================================================================
! Text Magnification
! ==============================================================================
! in:
!	posX:	position X
!	posY:	position Y
! ==============================================================================

	if gs_show_drawing_magnification then

		set style "styleDrawingMagnification"
		pen gs_drawing_magn_font_pen

		if (GLOB_CONTEXT = 22 | GLOB_CONTEXT = 28) & (gs_GLOB_MODPAR_NAME = "gs_drawing_magn_pos_x" | gs_GLOB_MODPAR_NAME = "gs_drawing_magn_pos_y") then
			textWidth	= stw(drawingMagnification) * PAPER_TO_MODEL
			textHeight	= drawingMagnFontH
			textAnchor	= anchorDrawingMagnification
			gosub 300

			add2 anchorX, anchorY

			rect2 posX + gs_drawing_magn_pos_x,				posY + gs_drawing_magn_pos_y,
				  posX + gs_drawing_magn_pos_x + textWidth,	posY + gs_drawing_magn_pos_y + textHeight
			del 1
		else
			text2 posX + gs_drawing_magn_pos_x, posY + gs_drawing_magn_pos_y, drawingMagnification
		endif

		hotspot2 posX,							posY + gs_drawing_magn_pos_y,	hID,	gs_drawing_magn_pos_x, 1+128
		hotspot2 posX - 1,						posY + gs_drawing_magn_pos_y,	hID+1,	gs_drawing_magn_pos_x, 3
		hotspot2 posX + gs_drawing_magn_pos_x,	posY + gs_drawing_magn_pos_y,	hID+2,	gs_drawing_magn_pos_x, 2
		hID = hID + 3

		hotspot2 posX + gs_drawing_magn_pos_x,	posY,							hID,	gs_drawing_magn_pos_y, 1+128
		hotspot2 posX + gs_drawing_magn_pos_x,	posY - 1,						hID+1,	gs_drawing_magn_pos_y, 3
		hotspot2 posX + gs_drawing_magn_pos_x,	posY + gs_drawing_magn_pos_y,	hID+2,	gs_drawing_magn_pos_y, 2
		hID = hID + 3
	endif
return

!205:
!! ==============================================================================
!! Text File Path
!! ==============================================================================
!! in:
!!	posX:	position X
!!	posY:	position Y
!! ==============================================================================
!
!	if gs_show_project_filename then
!
!		set style "styleProjectFilename"
!		pen gs_project_filename_font_pen
!
!		if (GLOB_CONTEXT = 22 | GLOB_CONTEXT = 28) & (gs_GLOB_MODPAR_NAME = "gs_project_filename_pos_x" | gs_GLOB_MODPAR_NAME = "gs_project_filename_pos_y") then
!			textWidth	= stw(filePath) * PAPER_TO_MODEL
!			textHeight	= projectFileNameFontH
!			textAnchor	= anchorProjectFileName
!			gosub 300
!
!			add2 anchorX, anchorY
!
!			rect2 posX + gs_project_filename_pos_x,				posY + gs_project_filename_pos_y,
!				  posX + gs_project_filename_pos_x + textWidth,	posY + gs_project_filename_pos_y + textHeight
!			del 1
!		else
!			text2 posX + gs_project_filename_pos_x, posY + gs_project_filename_pos_y, filePath
!		endif
!
!		hotspot2 posX,								posY + gs_project_filename_pos_y,	hID,	gs_project_filename_pos_x, 1+128
!		hotspot2 posX - 1,							posY + gs_project_filename_pos_y,	hID+1,	gs_project_filename_pos_x, 3
!		hotspot2 posX + gs_project_filename_pos_x,	posY + gs_project_filename_pos_y,	hID+2,	gs_project_filename_pos_x, 2
!		hID = hID + 3
!
!		hotspot2 posX + gs_project_filename_pos_x,	posY,								hID,	gs_project_filename_pos_y, 1+128
!		hotspot2 posX + gs_project_filename_pos_x,	posY - 1,							hID+1,	gs_project_filename_pos_y, 3
!		hotspot2 posX + gs_project_filename_pos_x,	posY + gs_project_filename_pos_y,	hID+2,	gs_project_filename_pos_y, 2
!		hID = hID + 3
!	endif
!return

!206:
!! ==============================================================================
!! Text Layout Name
!! ==============================================================================
!! in:
!!	posX:	position X
!!	posY:	position Y
!! ==============================================================================
!
!	if gs_show_layout_name then
!
!		set style "styleLayoutName"
!		pen gs_layout_name_font_pen
!
!		if (GLOB_CONTEXT = 22 | GLOB_CONTEXT = 28) & (gs_GLOB_MODPAR_NAME = "gs_layout_name_pos_x" | gs_GLOB_MODPAR_NAME = "gs_layout_name_pos_y") then
!			textWidth	= stw(layoutName) * PAPER_TO_MODEL
!			textHeight	= layoutNameFontH
!			textAnchor	= anchorLayoutName
!			gosub 300
!
!			add2 anchorX, anchorY
!
!			rect2 posX + gs_layout_name_pos_x,				posY + gs_layout_name_pos_y,
!				  posX + gs_layout_name_pos_x + textWidth,	posY + gs_layout_name_pos_y + textHeight
!			del 1
!		else
!			text2 posX + gs_layout_name_pos_x, posY + gs_layout_name_pos_y, layoutName
!		endif
!
!		hotspot2 posX,							posY + gs_layout_name_pos_y,	hID,	gs_layout_name_pos_x, 1+128
!		hotspot2 posX - 1,						posY + gs_layout_name_pos_y,	hID+1,	gs_layout_name_pos_x, 3
!		hotspot2 posX + gs_layout_name_pos_x,	posY + gs_layout_name_pos_y,	hID+2,	gs_layout_name_pos_x, 2
!		hID = hID + 3
!
!		hotspot2 posX + gs_layout_name_pos_x,	posY,							hID,	gs_layout_name_pos_y, 1+128
!		hotspot2 posX + gs_layout_name_pos_x,	posY - 1,						hID+1,	gs_layout_name_pos_y, 3
!		hotspot2 posX + gs_layout_name_pos_x,	posY + gs_layout_name_pos_y,	hID+2,	gs_layout_name_pos_y, 2
!		hID = hID + 3
!	endif
!return

207:
! ==============================================================================
! Text Layout Number
! ==============================================================================
! in:
!	posX:	position X
!	posY:	position Y
! ==============================================================================

	if gs_show_layout_number then

		set style "styleLayoutNumber"
		pen gs_layout_number_font_pen

		if (GLOB_CONTEXT = 22 | GLOB_CONTEXT = 28) & (gs_GLOB_MODPAR_NAME = "gs_layout_number_pos_x" | gs_GLOB_MODPAR_NAME = "gs_layout_number_pos_y") then
			textWidth	= stw(layoutNumber) * PAPER_TO_MODEL
			textHeight	= layoutNumberFontH
			textAnchor	= anchorLayoutNumber
			gosub 300

			add2 anchorX, anchorY

			rect2 posX + gs_layout_number_pos_x,				posY + gs_layout_number_pos_y,
				  posX + gs_layout_number_pos_x + textWidth,	posY + gs_layout_number_pos_y + textHeight
			del 1
		else
			text2 posX + gs_layout_number_pos_x, posY + gs_layout_number_pos_y, layoutNumber
		endif

		hotspot2 posX,							posY + gs_layout_number_pos_y,	hID,	gs_layout_number_pos_x, 1+128
		hotspot2 posX - 1,						posY + gs_layout_number_pos_y,	hID+1,	gs_layout_number_pos_x, 3
		hotspot2 posX + gs_layout_number_pos_x,	posY + gs_layout_number_pos_y,	hID+2,	gs_layout_number_pos_x, 2
		hID = hID + 3

		hotspot2 posX + gs_layout_number_pos_x,	posY,							hID,	gs_layout_number_pos_y, 1+128
		hotspot2 posX + gs_layout_number_pos_x,	posY - 1,						hID+1,	gs_layout_number_pos_y, 3
		hotspot2 posX + gs_layout_number_pos_x,	posY + gs_layout_number_pos_y,	hID+2,	gs_layout_number_pos_y, 2
		hID = hID + 3
	endif
return


300:
! ==============================================================================
! Text anchor relative position
! ==============================================================================
! in:
!	textWidth:		width of the text
!	textHeight:		height of the text
!	textAnchor:		text anchor code
! out:
!	anchorY:		anchor relative position X
!	anchorY:		anchor relative position Y
! ==============================================================================

	if textAnchor = 1 | textAnchor = 4 | textAnchor = 7 then
		anchorX = 0
	endif
	if textAnchor = 2 | textAnchor = 5 | textAnchor = 8 then
		anchorX = -textWidth / 2
	endif
	if textAnchor = 3 | textAnchor = 6 | textAnchor = 9 then
		anchorX = -textWidth
	endif
	if textAnchor = 1 | textAnchor = 2 | textAnchor = 3 then
		anchorY = -textHeight
	endif
	if textAnchor = 4 | textAnchor = 5 | textAnchor = 6 then
		anchorY = -textHeight / 2
	endif
	if textAnchor = 7 | textAnchor = 8 | textAnchor = 9 then
		anchorY = 0
	endif
return

]]>
</Script_2D>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_1D SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[
EPS = 0.0001
PAPER_TO_MODEL = GLOB_SCALE / 1000	! Convert paper size to model size

if GLOB_SCRIPT_TYPE = 7 | GLOB_SCRIPT_TYPE = 8 then goto "MasterEnd"

dim mPositionSide[4]
	mPositionSide[1] = `Верх`
	mPositionSide[2] = `Слева`
	mPositionSide[3] = `Справа`
	mPositionSide[4] = `Низ`

dim mPositionAlignment[3]
	mPositionAlignment[1] = `Слева`
	mPositionAlignment[2] = `Центр`
	mPositionAlignment[3] = `Справа`

dim mTitleFitMode[4]
	mTitleFitMode[1] = `Чертеж`
	mTitleFitMode[2] = `Макет`
	mTitleFitMode[3] = `Ячейка`
	mTitleFitMode[4] = `Специальный`

! ==============================================================================
! Bounding Box Calculations
! ==============================================================================

if AC_titleFitMode = 1 then		! Fit to Drawing Rect
	titlePosX = AC_DrawingRect[1]
	titlePosY = AC_DrawingRect[2]
	titleAlpha = AC_DrawingRect[5]

	xo = AC_DrawingRect[1]:		yo = AC_DrawingRect[2]
	x1 = AC_DrawingRect[3]:		y1 = AC_DrawingRect[4]
	x2 = x1 + cos(titleAlpha - 90):	y2 = y1 + sin(titleAlpha - 90)
endif

if AC_titleFitMode = 2 then		! Fit to Layout Rect
	titlePosX = AC_LayoutRect[1]
	titlePosY = AC_LayoutRect[2]
	titleAlpha = AC_LayoutRect[5]

	xo = AC_LayoutRect[1]:		yo = AC_LayoutRect[2]
	x1 = AC_LayoutRect[3]:		y1 = AC_LayoutRect[4]
	x2 = x1 + cos(titleAlpha - 90):	y2 = y1 + sin(titleAlpha - 90)
endif

if AC_titleFitMode = 3 then		! Fit to Cell Rect
	titlePosX = AC_GridRect[1]
	titlePosY = AC_GridRect[2]
	titleAlpha = AC_GridRect[5]

	xo = AC_GridRect[1]:		yo = AC_GridRect[2]
	x1 = AC_GridRect[3]:		y1 = AC_GridRect[4]
	x2 = x1 + cos(titleAlpha - 90):	y2 = y1 + sin(titleAlpha - 90)
endif

titleRectX = (abs((y2 - y1) * (xo - x1) - (x2 - x1) * (yo - y1)) / sqr((x2 - x1)^2 + (y2 - y1)^2))
diagonalL = sqr((xo - x1)^2 + (yo - y1)^2)

if abs(titleRectX) < EPS | diagonalL < EPS then end

titleRectY = sqr(diagonalL^2 - titleRectX^2)

savedTitleRectX = titleRectX
savedTitleRectY = titleRectY

if AC_ManualPosition then
	titlePosX	= 0
	titlePosY	= 0
	titleAlpha	= 0
endif


! ==============================================================================
! Draw Preview
! ==============================================================================

bPositioningPreview = (GLOB_CONTEXT = 5 & AC_PreviewType = 0)

if bPositioningPreview then

	if SYMB_MIRRORED then
		mul2 -1, 1
	endif

	PAPER_TO_MODEL = 0.1

	pwx = 20
	pwy = 20

	if GLOB_SCRIPT_TYPE = 2 then
		gs_title_width_paper = 100 * gs_title_width_paper / GLOB_SCALE
	endif


	DEFINE FILLA `Штр-ка заголовка чертежа` 136, 34, 136, 34, 136, 34, 136, 34,
		0.07, 0.07, 0, 1,
		1, 0, 0, 0, 0, 2,
		0, 1

	gs_frame_pen		= 1
	gs_frame_linetype	= 1		! Solid Line
	gs_frame_fill		= IND(FILL, `Штр-ка заголовка чертежа`)
	gs_frame_fill_fg	= 6
	gs_frame_fill_bg	= 91

	pen 1
	rect2 0,0, pwx,pwy

	if AC_titleFitMode = 1 | AC_ManualPosition then		! Fit to Drawing Rect
		rect2 0.2*pwx, 0.3*pwy, 0.8*pwx, 0.8*pwy

		titlePosX	= 0.2*pwx
		titlePosY	= 0.3*pwy
		titleAlpha	= 0
		titleRectX	= 0.6*pwx
		titleRectY	= 0.5*pwy
	endif

	if AC_titleFitMode = 2 then		! Fit to Layout Rect
		titlePosX	= 0
		titlePosY	= 0
		titleAlpha	= 0
		titleRectX	= pwx
		titleRectY	= pwy
	endif

	if AC_titleFitMode = 3 then		! Fit to Cell Rect
		line2 0,		0.3*pwy,	pwx,		0.3*pwy
		line2 0,		0.8*pwy,	pwx,		0.8*pwy
		line2 0.2*pwx,	0,			0.2*pwx,	pwy
		line2 0.8*pwx,	0,			0.8*pwx,	pwy

		titlePosX	= 0.2*pwx
		titlePosY	= 0.3*pwy
		titleAlpha	= 0
		titleRectX	= 0.6*pwx
		titleRectY	= 0.5*pwy
	endif

	add2 titlePosX, titlePosY
	rot2 titleAlpha

	rect2 0,0, titleRectX,titleRectY

	del 2
endif


! Rotate mode ==================================================================

bSpecPos = (not(gs_title_rotate_with_position) & (gs_position_side_int = 2 | gs_position_side_int = 3))		! Left or Right

if bSpecPos then
	lock "gs_link_title_width"
	gs_link_title_width = 0
endif

gs_show_symbol = 0

"MasterEnd":

]]>
</Script_1D>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_PR SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_PR>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_UI SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_UI>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_VL SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[
parameters gs_GLOB_MODPAR_NAME = GLOB_MODPAR_NAME
parameters gs_link_title_width=1
parameters gs_title_fit_mode=mTitleFitMode[1]
parameters AC_titleFitMode = 1
parameters gs_position_side_int = 1
parameters gs_position_side= mPositionSide[1]
parameters gs_position_alignment= mPositionAlignment[2]
parameters AC_ManualPosition = 0
! ==============================================================================

if gs_backref_custom then lock "gs_backref_separator"

!if AC_EnableBackReference = 0 then
!	lock "AC_ShowDrawingReferences"
!endif
!
!values "gs_position_side" mPositionSide
!values "gs_position_alignment" mPositionAlignment

! Title Rotation ===============================================================

if AC_titleFitMode <> 1 then
	gs_title_rotate_with_drawing = 1
	lock "gs_title_rotate_with_drawing"
	hideparameter "gs_title_rotate_with_drawing"
endif
if gs_title_rotate_with_position then
	lock "gs_title_rotation_angle"
	hideparameter "gs_title_rotation_angle"
endif


! Title Fit Mode ===============================================================

if gs_link_title_width & not(AC_ManualPosition) then
	lock "gs_title_width", "gs_title_width_paper", "gs_position_alignment"
	hideparameter "gs_title_width", "gs_title_width_paper", "gs_position_alignment"

	if gs_position_side_int = 1 | gs_position_side_int = 4 then		! Top or Bottom
		titleWidth = savedTitleRectX
	else
		titleWidth = savedTitleRectY
	endif

	parameters	gs_title_width = titleWidth,
				gs_title_width_paper = titleWidth / GLOB_SCALE
endif


! Title Position  ===============================================================

bNoGrid = (abs(AC_LayoutRect[1] - AC_GridRect[1]) < EPS & abs(AC_LayoutRect[2] - AC_GridRect[2]) < EPS & abs(AC_LayoutRect[3] - AC_GridRect[3]) < EPS & abs(AC_LayoutRect[4] - AC_GridRect[4]) < EPS & abs(AC_LayoutRect[5] - AC_GridRect[5]) < EPS)
!
!if (GLOB_INTGUID = '' or GLOB_INTGUID = '{00000000-0000-0000-0000-000000000000}') then
!	if bNoGrid then
!		if AC_ManualPosition then
!			values "gs_title_fit_mode" mTitleFitMode[1], mTitleFitMode[2], mTitleFitMode[4]
!		else
!			values "gs_title_fit_mode" mTitleFitMode[1], mTitleFitMode[2]
!		endif
!		if gs_title_fit_mode = mTitleFitMode[3] then
!			gs_title_fit_mode = mTitleFitMode[2]
!		endif
!	else
!		if AC_ManualPosition then
!			values "gs_title_fit_mode" mTitleFitMode[1], mTitleFitMode[2], mTitleFitMode[3], mTitleFitMode[4]
!		else
!			values "gs_title_fit_mode" mTitleFitMode[1], mTitleFitMode[2], mTitleFitMode[3]
!		endif
!	endif
!else
!	if bNoGrid then
!		if AC_ManualPosition then
!			values "gs_title_fit_mode" mTitleFitMode[1], mTitleFitMode[2], mTitleFitMode[4]
!		else
!			values "gs_title_fit_mode" mTitleFitMode[1], mTitleFitMode[2]
!		endif
!		if gs_title_fit_mode = mTitleFitMode[3] then
!			gs_title_fit_mode = mTitleFitMode[2]
!		endif
!	else
!		if AC_ManualPosition then
!			values "gs_title_fit_mode" mTitleFitMode[1], mTitleFitMode[2], mTitleFitMode[3], mTitleFitMode[4]
!		else
!			values "gs_title_fit_mode" mTitleFitMode[1], mTitleFitMode[2], mTitleFitMode[3]
!		endif
!	endif
!endif
!
!if GLOB_MODPAR_NAME = "gs_title_fit_mode" then
!	if gs_title_fit_mode = mTitleFitMode[1] then AC_titleFitMode = 1
!	if gs_title_fit_mode = mTitleFitMode[2] then AC_titleFitMode = 2
!	if gs_title_fit_mode = mTitleFitMode[3] then AC_titleFitMode = 3
!
!	parameters	AC_titleFitMode		= AC_titleFitMode,
!				AC_ManualPosition	= 0
!else
!	if AC_ManualPosition then
!		parameters gs_title_fit_mode = mTitleFitMode[4]		! Custom
!	else
!		if AC_titleFitMode < 1 | AC_titleFitMode >= 4 then
!			AC_titleFitMode = 1
!			parameters AC_titleFitMode = 1
!		endif
!		gs_title_fit_mode = mTitleFitMode[AC_titleFitMode]
!		parameters gs_title_fit_mode = gs_title_fit_mode
!	endif
!endif
!
if GLOB_MODPAR_NAME = "gs_offset" then
	parameters gs_offset_paper = gs_offset / GLOB_SCALE
else
	parameters gs_offset = gs_offset_paper * GLOB_SCALE
endif

if GLOB_MODPAR_NAME = "gs_title_half_width" then
	parameters	gs_title_width		 = 2 * gs_title_half_width,
				gs_title_width_paper = 2 * gs_title_half_width / GLOB_SCALE
else
	if GLOB_MODPAR_NAME = "gs_title_width" then
		parameters	gs_title_half_width  = gs_title_width / 2,
					gs_title_width_paper = gs_title_width / GLOB_SCALE
	else
		if not(gs_link_title_width) then
			parameters	gs_title_half_width = gs_title_width_paper * GLOB_SCALE / 2,
						gs_title_width		= gs_title_width_paper * GLOB_SCALE
		endif
	endif
endif
values "gs_title_width" range (0,]
values "gs_title_width_paper" range (0,]
values "gs_title_half_width" range (0,]

if AC_ManualPosition then		! Custom
	lock "gs_title_position",
		 "gs_position_side",
		 "gs_position_alignment",
		 "gs_offset",
		 "gs_offset_paper",
		 "gs_link_title_width"
	hideparameter	"gs_title_position",
					"gs_position_side",
					"gs_position_alignment",
					"gs_offset",
					"gs_offset_paper",
					"gs_link_title_width"

	gs_link_title_width = 0
	parameters gs_link_title_width = 0
endif


! Frame ========================================================================


if not(gs_show_frame) then
	lock "gs_frame_pen", "gs_frame_linetype", "gs_frame_fill", "gs_frame_fill_fg", "gs_frame_fill_bg"
	hideparameter "gs_frame_pen", "gs_frame_linetype", "gs_frame_fill", "gs_frame_fill_fg", "gs_frame_fill_bg"
endif


! Marker =======================================================================

if not(gs_show_symbol) then
	lock "gs_symbol_pen", "gs_symbol_linetype", "gs_symbol_fill", "gs_symbol_fill_fg", "gs_symbol_fill_bg"
	hideparameter "gs_symbol_pen", "gs_symbol_linetype", "gs_symbol_fill", "gs_symbol_fill_fg", "gs_symbol_fill_bg"
endif


if GLOB_MODPAR_NAME = "gs_symbol_pos" then
	parameters gs_title_width = gs_symbol_pos
else
	parameters gs_symbol_pos = gs_title_width
endif


! ==============================================================================
! Built-in Drawing Title special settings
! ==============================================================================

lock			"gs_show_source_filename",
				"gs_show_drawing_magnification",
				"gs_show_project_filename",
				"gs_show_layout_name"

hideparameter	"gs_show_source_filename",
				"gs_show_drawing_magnification",
				"gs_show_project_filename",
				"gs_show_layout_name"

if GLOB_MODPAR_NAME = "gs_show_drawing_number" & gs_show_drawing_number then
	parameters gs_show_layout_number = 0
endif
if GLOB_MODPAR_NAME = "gs_show_layout_number" & gs_show_layout_number then
	parameters gs_show_drawing_number = 0
endif

if gs_show_symbol then
	lock "gs_title_right_line"
	hideparameter "gs_title_right_line"
endif


! ==============================================================================
! Title Data
! ==============================================================================

dim fontNames[]
n = request("FONTNAMES_LIST", "", fontNames)

! Backref =================================================================

if AC_UseUniformTextFormat | not(gs_show_drawing_name) then
	lock			"gs_backref_font_type",
					"gs_backref_font_size",
					"gs_backref_font_size_point",
					"gs_backref_font_pen",
					"gs_backref_font_bold",
					"gs_backref_font_italic",
					"gs_backref_font_under"

	hideparameter	"gs_backref_font_type",
					"gs_backref_font_size",
					"gs_backref_font_size_point",
					"gs_backref_font_pen",
					"gs_backref_font_bold",
					"gs_backref_font_italic",
					"gs_backref_font_under"
else
	values "gs_backref_font_type" fontNames, custom
	values "gs_backref_font_size" range [0,]
	values "gs_backref_font_size_point" range [0,]
endif

if not(gs_backref_custom) then lock "gs_backref_customtxt"

if not(AC_ShowDrawingReferences) then
	lock			"gs_backref_custom",
					"gs_backref_customtxt"

	hideparameter	"gs_backref_custom",
					"gs_backref_customtxt"
endif

if GLOB_MODPAR_NAME = "gs_backref_pos_x" | GLOB_MODPAR_NAME = "gs_backref_pos_y" then
	parameters gs_backref_pos_x_paper = gs_backref_pos_x / GLOB_SCALE
	parameters gs_backref_pos_y_paper = gs_backref_pos_y / GLOB_SCALE
else
	parameters gs_backref_pos_x = gs_backref_pos_x_paper * GLOB_SCALE
	parameters gs_backref_pos_y = gs_backref_pos_y_paper * GLOB_SCALE
endif


! Drawing Name =================================================================

if AC_UseUniformTextFormat | not(gs_show_drawing_name) then
	lock			"gs_drawing_name_font_type",
					"gs_drawing_name_font_size",
					"gs_drawing_name_font_size_point",
					"gs_drawing_name_font_pen",
					"gs_drawing_name_font_bold",
					"gs_drawing_name_font_italic",
					"gs_drawing_name_font_under"

	hideparameter	"gs_drawing_name_font_type",
					"gs_drawing_name_font_size",
					"gs_drawing_name_font_size_point",
					"gs_drawing_name_font_pen",
					"gs_drawing_name_font_bold",
					"gs_drawing_name_font_italic",
					"gs_drawing_name_font_under"

else
	values "gs_drawing_name_font_type" fontNames, custom
	values "gs_drawing_name_font_size" range [0,]
	values "gs_drawing_name_font_size_point" range [0,]
endif

if not(gs_drawing_name_custom) then lock "gs_drawing_name_custom_text"

if not(gs_show_drawing_number) then
	lock			"gs_drawing_name_custom",
					"gs_drawing_name_custom_text"

	hideparameter	"gs_drawing_name_custom",
					"gs_drawing_name_custom_text"
endif

if GLOB_MODPAR_NAME = "gs_drawing_name_pos_x" | GLOB_MODPAR_NAME = "gs_drawing_name_pos_y" then
	parameters gs_drawing_name_pos_x_paper = gs_drawing_name_pos_x / GLOB_SCALE
	parameters gs_drawing_name_pos_y_paper = gs_drawing_name_pos_y / GLOB_SCALE
else
	parameters gs_drawing_name_pos_x = gs_drawing_name_pos_x_paper * GLOB_SCALE
	parameters gs_drawing_name_pos_y = gs_drawing_name_pos_y_paper * GLOB_SCALE
endif

if AC_SourceFileName = "" then
	hideparameter "gs_drawing_name_extension"
endif


! Drawing Scale ================================================================

if AC_UseUniformTextFormat | not(gs_show_drawing_scale) then
	lock			"gs_drawing_scale_font_type",
					"gs_drawing_scale_font_size",
					"gs_drawing_scale_font_size_poin",
					"gs_drawing_scale_font_pen",
					"gs_drawing_scale_font_bold",
					"gs_drawing_scale_font_italic",
					"gs_drawing_scale_font_under"


	hideparameter	"gs_drawing_scale_font_type",
					"gs_drawing_scale_font_size",
					"gs_drawing_scale_font_size_poin",
					"gs_drawing_scale_font_pen",
					"gs_drawing_scale_font_bold",
					"gs_drawing_scale_font_italic",
					"gs_drawing_scale_font_under"
else
	values "gs_drawing_scale_font_type" fontNames, custom
	values "gs_backref_font_type" fontNames, custom
	values "gs_drawing_scale_font_size" range [0,]
	values "gs_drawing_scale_font_size_poin" range [0,]
endif

if not(gs_show_drawing_scale) then
	lock	"gs_drawing_scale_prefix",
			"gs_drawing_scale_original"
	hideparameter	"gs_drawing_scale_prefix",
					"gs_drawing_scale_original"
endif

if GLOB_MODPAR_NAME = "gs_drawing_scale_pos_x" | GLOB_MODPAR_NAME = "gs_drawing_scale_pos_y" then
	parameters gs_drawing_scale_pos_x_paper = gs_drawing_scale_pos_x / GLOB_SCALE
	parameters gs_drawing_scale_pos_y_paper = gs_drawing_scale_pos_y / GLOB_SCALE
else
	parameters gs_drawing_scale_pos_x = gs_drawing_scale_pos_x_paper * GLOB_SCALE
	parameters gs_drawing_scale_pos_y = gs_drawing_scale_pos_y_paper * GLOB_SCALE
endif


! Drawing Number ===============================================================

if AC_UseUniformTextFormat | not(gs_show_drawing_number) then
	lock			"gs_drawing_number_font_type",
					"gs_drawing_number_font_size",
					"gs_drawing_number_font_size_poi",
					"gs_drawing_number_font_pen",
					"gs_drawing_number_font_bold",
					"gs_drawing_number_font_italic",
					"gs_drawing_number_font_under"

	hideparameter	"gs_drawing_number_font_type",
					"gs_drawing_number_font_size",
					"gs_drawing_number_font_size_poi",
					"gs_drawing_number_font_pen",
					"gs_drawing_number_font_bold",
					"gs_drawing_number_font_italic",
					"gs_drawing_number_font_under"
else
	values "gs_drawing_number_font_type" fontNames, custom
	values "gs_drawing_number_font_size" range [0,]
	values "gs_drawing_number_font_size_poi" range [0,]
endif

if not(gs_show_drawing_number) then
	lock "gs_drawing_number_prefix"
	hideparameter "gs_drawing_number_prefix"
endif

if GLOB_MODPAR_NAME = "gs_drawing_number_pos_x" | GLOB_MODPAR_NAME = "gs_drawing_number_pos_y" then
	parameters gs_drawing_number_pos_x_paper = gs_drawing_number_pos_x / GLOB_SCALE
	parameters gs_drawing_number_pos_y_paper = gs_drawing_number_pos_y / GLOB_SCALE
else
	parameters gs_drawing_number_pos_x = gs_drawing_number_pos_x_paper * GLOB_SCALE
	parameters gs_drawing_number_pos_y = gs_drawing_number_pos_y_paper * GLOB_SCALE
endif


! Source File Name and Path ====================================================

if AC_UseUniformTextFormat | not(gs_show_source_filename) then
	lock			"gs_source_filename_font_type",
					"gs_source_filename_font_size",
					"gs_source_filename_font_size_po",
					"gs_source_filename_font_pen",
					"gs_source_filename_font_bold",
					"gs_source_filename_font_italic",
					"gs_source_filename_font_under"

	hideparameter	"gs_source_filename_font_type",
					"gs_source_filename_font_size",
					"gs_source_filename_font_size_po",
					"gs_source_filename_font_pen",
					"gs_source_filename_font_bold",
					"gs_source_filename_font_italic",
					"gs_source_filename_font_under"
else
	values "gs_source_filename_font_type" fontNames, custom
	values "gs_source_filename_font_size" range [0,]
	values "gs_source_filename_font_size_po" range [0,]
endif

if GLOB_MODPAR_NAME = "gs_source_filename_pos_x" | GLOB_MODPAR_NAME = "gs_source_filename_pos_y" then
	parameters gs_source_filename_pos_x_paper = gs_source_filename_pos_x / GLOB_SCALE
	parameters gs_source_filename_pos_y_paper = gs_source_filename_pos_y / GLOB_SCALE
else
	parameters gs_source_filename_pos_x = gs_source_filename_pos_x_paper * GLOB_SCALE
	parameters gs_source_filename_pos_y = gs_source_filename_pos_y_paper * GLOB_SCALE
endif


! Drawing Magnification ========================================================

if AC_UseUniformTextFormat | not(gs_show_drawing_magnification) then
	lock			"gs_drawing_magn_font_type",
					"gs_drawing_magn_font_size",
					"gs_drawing_magn_font_size_point",
					"gs_drawing_magn_font_pen",
					"gs_drawing_magn_font_bold",
					"gs_drawing_magn_font_italic",
					"gs_drawing_magn_font_under"

	hideparameter	"gs_drawing_magn_font_type",
					"gs_drawing_magn_font_size",
					"gs_drawing_magn_font_size_point",
					"gs_drawing_magn_font_pen",
					"gs_drawing_magn_font_bold",
					"gs_drawing_magn_font_italic",
					"gs_drawing_magn_font_under"
else
	values "gs_drawing_magn_font_type" fontNames, custom
	values "gs_drawing_magn_font_size" range [0,]
	values "gs_drawing_magn_font_size_point" range [0,]
endif

if not(gs_show_drawing_magnification) then
	lock "gs_drawing_magn_suffix"
	hideparameter "gs_drawing_magn_suffix"
endif

if GLOB_MODPAR_NAME = "gs_drawing_magn_pos_x" | GLOB_MODPAR_NAME = "gs_drawing_magn_pos_y" then
	parameters gs_drawing_magn_pos_x_paper = gs_drawing_magn_pos_x / GLOB_SCALE
	parameters gs_drawing_magn_pos_y_paper = gs_drawing_magn_pos_y / GLOB_SCALE
else
	parameters gs_drawing_magn_pos_x = gs_drawing_magn_pos_x_paper * GLOB_SCALE
	parameters gs_drawing_magn_pos_y = gs_drawing_magn_pos_y_paper * GLOB_SCALE
endif


! Project Filename =============================================================

if AC_UseUniformTextFormat | not(gs_show_project_filename) then
	lock			"gs_project_filename_font_type",
					"gs_project_filename_font_size",
					"gs_project_filename_font_size_p",
					"gs_project_filename_font_pen",
					"gs_project_filename_font_bold",
					"gs_project_filename_font_italic",
					"gs_project_filename_font_under"

	hideparameter	"gs_project_filename_font_type",
					"gs_project_filename_font_size",
					"gs_project_filename_font_size_p",
					"gs_project_filename_font_pen",
					"gs_project_filename_font_bold",
					"gs_project_filename_font_italic",
					"gs_project_filename_font_under"
else
	values "gs_project_filename_font_type" fontNames, custom
	values "gs_project_filename_font_size" range [0,]
	values "gs_project_filename_font_size_p" range [0,]
endif

if GLOB_MODPAR_NAME = "gs_project_filename_pos_x" | GLOB_MODPAR_NAME = "gs_project_filename_pos_y" then
	parameters gs_project_filename_pos_x_paper = gs_project_filename_pos_x / GLOB_SCALE
	parameters gs_project_filename_pos_y_paper = gs_project_filename_pos_y / GLOB_SCALE
else
	parameters gs_project_filename_pos_x = gs_project_filename_pos_x_paper * GLOB_SCALE
	parameters gs_project_filename_pos_y = gs_project_filename_pos_y_paper * GLOB_SCALE
endif


! Layout Name ==================================================================

if AC_UseUniformTextFormat | not(gs_show_layout_name) then
	lock			"gs_layout_name_font_type",
					"gs_layout_name_font_size",
					"gs_layout_name_font_size_point",
					"gs_layout_name_font_pen",
					"gs_layout_name_font_bold",
					"gs_layout_name_font_italic",
					"gs_layout_name_font_under"

	hideparameter	"gs_layout_name_font_type",
					"gs_layout_name_font_size",
					"gs_layout_name_font_size_point",
					"gs_layout_name_font_pen",
					"gs_layout_name_font_bold",
					"gs_layout_name_font_italic",
					"gs_layout_name_font_under"
else
	values "gs_layout_name_font_type" fontNames, custom
	values "gs_layout_name_font_size" range [0,]
	values "gs_layout_name_font_size_point" range [0,]
endif

if GLOB_MODPAR_NAME = "gs_layout_name_pos_x" | GLOB_MODPAR_NAME = "gs_layout_name_pos_y" then
	parameters gs_layout_name_pos_x_paper = gs_layout_name_pos_x / GLOB_SCALE
	parameters gs_layout_name_pos_y_paper = gs_layout_name_pos_y / GLOB_SCALE
else
	parameters gs_layout_name_pos_x = gs_layout_name_pos_x_paper * GLOB_SCALE
	parameters gs_layout_name_pos_y = gs_layout_name_pos_y_paper * GLOB_SCALE
endif


! Layout Number ================================================================

if AC_UseUniformTextFormat | not(gs_show_layout_number) then
	lock			"gs_layout_number_font_type",
					"gs_layout_number_font_size",
					"gs_layout_number_font_size_poin",
					"gs_layout_number_font_pen",
					"gs_layout_number_font_bold",
					"gs_layout_number_font_italic",
					"gs_layout_number_font_under"

	hideparameter	"gs_layout_number_font_type",
					"gs_layout_number_font_size",
					"gs_layout_number_font_size_poin",
					"gs_layout_number_font_pen",
					"gs_layout_number_font_bold",
					"gs_layout_number_font_italic",
					"gs_layout_number_font_under"
else
	values "gs_layout_number_font_type" fontNames, custom
	values "gs_layout_number_font_size" range [0,]
	values "gs_layout_number_font_size_poin" range [0,]
endif

if not(gs_show_layout_number) then
	lock "gs_layout_number_prefix"
	hideparameter "gs_layout_number_prefix"
endif

if GLOB_MODPAR_NAME = "gs_layout_number_pos_x" | GLOB_MODPAR_NAME = "gs_layout_number_pos_y" then
	parameters gs_layout_number_pos_x_paper = gs_layout_number_pos_x / GLOB_SCALE
	parameters gs_layout_number_pos_y_paper = gs_layout_number_pos_y / GLOB_SCALE
else
	parameters gs_layout_number_pos_x = gs_layout_number_pos_x_paper * GLOB_SCALE
	parameters gs_layout_number_pos_y = gs_layout_number_pos_y_paper * GLOB_SCALE
endif


! ==============================================================================
! Debug Functions
! ==============================================================================

if not(gs_debug) then
	hideparameter	"AC_DrawingName",
					"AC_SourceFileName",
					"AC_DrawingNumber",
					"AC_SourceFilePath",
					"AC_DrawingScale",
					"AC_OriginalDrawingScale",
					"AC_Magnification",
!!!					"AC_PreviewType",
					"AC_LayoutRect",
					"AC_GridRect",
					"AC_DrawingRect"
endif



Dot_in_mm = 25.4 / 72


!!! Synhronized mm and point in marker width
if GLOB_MODPAR_NAME = "gs_drawing_name_font_size" then
	parameters gs_drawing_name_font_size_point = gs_drawing_name_font_size / Dot_in_mm
	gs_drawing_name_font_size_point = gs_drawing_name_font_size / Dot_in_mm
endif
if GLOB_MODPAR_NAME = "gs_drawing_name_font_size_point" then
	parameters gs_drawing_name_font_size = gs_drawing_name_font_size_point * Dot_in_mm
	gs_drawing_name_font_size = gs_drawing_name_font_size_point * Dot_in_mm
endif

if GLOB_MODPAR_NAME = "gs_drawing_scale_font_size" then
	parameters gs_drawing_scale_font_size_poin = gs_drawing_scale_font_size / Dot_in_mm
	gs_drawing_scale_font_size_poin = gs_drawing_scale_font_size / Dot_in_mm
endif
if GLOB_MODPAR_NAME = "gs_drawing_scale_font_size_poin" then
	parameters gs_drawing_scale_font_size = gs_drawing_scale_font_size_poin * Dot_in_mm
	gs_drawing_scale_font_size = gs_drawing_scale_font_size_poin * Dot_in_mm
endif

if GLOB_MODPAR_NAME = "gs_backref_font_size" then
	parameters gs_backref_font_size_point = gs_backref_font_size / Dot_in_mm
	gs_backref_font_size_point = gs_backref_font_size / Dot_in_mm
endif
if GLOB_MODPAR_NAME = "gs_backref_font_size_point" then
	parameters gs_backref_font_size = gs_backref_font_size_point * Dot_in_mm
	gs_backref_font_size = gs_backref_font_size_point * Dot_in_mm
endif

if GLOB_MODPAR_NAME = "gs_drawing_number_font_size" then
	parameters gs_drawing_number_font_size_poi = gs_drawing_number_font_size / Dot_in_mm
	gs_drawing_number_font_size_poi = gs_drawing_number_font_size / Dot_in_mm
endif
if GLOB_MODPAR_NAME = "gs_drawing_number_font_size_poi" then
	parameters gs_drawing_number_font_size = gs_drawing_number_font_size_poi * Dot_in_mm
	gs_drawing_number_font_size = gs_drawing_number_font_size_poi * Dot_in_mm
endif

if GLOB_MODPAR_NAME = "gs_source_filename_font_size" then
	parameters gs_source_filename_font_size_po = gs_source_filename_font_size / Dot_in_mm
	gs_source_filename_font_size_po = gs_source_filename_font_size / Dot_in_mm
endif
if GLOB_MODPAR_NAME = "gs_source_filename_font_size_po" then
	parameters gs_source_filename_font_size = gs_source_filename_font_size_po * Dot_in_mm
	gs_source_filename_font_size = gs_source_filename_font_size_po * Dot_in_mm
endif

if GLOB_MODPAR_NAME = "gs_drawing_magn_font_size" then
	parameters gs_drawing_magn_font_size_point = gs_drawing_magn_font_size / Dot_in_mm
	gs_drawing_magn_font_size_point = gs_drawing_magn_font_size / Dot_in_mm
endif
if GLOB_MODPAR_NAME = "gs_drawing_magn_font_size_point" then
	parameters gs_drawing_magn_font_size = gs_drawing_magn_font_size_point * Dot_in_mm
	gs_drawing_magn_font_size = gs_drawing_magn_font_size_point * Dot_in_mm
endif

if GLOB_MODPAR_NAME = "gs_project_filename_font_size" then
	parameters gs_project_filename_font_size_p = gs_project_filename_font_size / Dot_in_mm
	gs_project_filename_font_size_p = gs_project_filename_font_size / Dot_in_mm
endif
if GLOB_MODPAR_NAME = "gs_project_filename_font_size_p" then
	parameters gs_project_filename_font_size = gs_project_filename_font_size_p * Dot_in_mm
	gs_project_filename_font_size = gs_project_filename_font_size_p * Dot_in_mm
endif

if GLOB_MODPAR_NAME = "gs_layout_name_font_size" then
	parameters gs_layout_name_font_size_point = gs_layout_name_font_size / Dot_in_mm
	gs_layout_name_font_size_point = gs_layout_name_font_size / Dot_in_mm
endif
if GLOB_MODPAR_NAME = "gs_layout_name_font_size_point" then
	parameters gs_layout_name_font_size = gs_layout_name_font_size_point * Dot_in_mm
	gs_layout_name_font_size = gs_layout_name_font_size_point * Dot_in_mm
endif

if GLOB_MODPAR_NAME = "gs_layout_number_font_size" then
	parameters gs_layout_number_font_size_poin = gs_layout_number_font_size / Dot_in_mm
	gs_layout_number_font_size_poin = gs_layout_number_font_size / Dot_in_mm
endif
if GLOB_MODPAR_NAME = "gs_layout_number_font_size_poin" then
	parameters gs_layout_number_font_size = gs_layout_number_font_size_poin * Dot_in_mm
	gs_layout_number_font_size = gs_layout_number_font_size_poin * Dot_in_mm
endif

! ==============================================================================
! String - Integer parameters
! ==============================================================================

if GLOB_MODPAR_NAME = "gs_position_side" then
	gs_position_side_int = 1
	if gs_position_side = mPositionSide[2] then gs_position_side_int = 2
	if gs_position_side = mPositionSide[3] then gs_position_side_int = 3
	if gs_position_side = mPositionSide[4] then gs_position_side_int = 4
	parameters gs_position_side_int = gs_position_side_int
else
	gs_position_side = mPositionSide[max(1, min(gs_position_side_int, vardim1(mPositionSide)) )]
	parameters gs_position_side = gs_position_side
endif

if GLOB_MODPAR_NAME = "gs_position_alignment" then
	gs_position_alignment_int = 1
	if gs_position_alignment = mPositionAlignment[2] then gs_position_alignment_int = 2
	if gs_position_alignment = mPositionAlignment[3] then gs_position_alignment_int = 3
	parameters gs_position_alignment_int = gs_position_alignment_int
else
	gs_position_alignment = mPositionAlignment[max(1, min(gs_position_alignment_int, vardim1(mPositionAlignment)) )]
	parameters gs_position_alignment = gs_position_alignment
endif


]]>
</Script_VL>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Comment SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Comment>

<ParamSection SectVersion="26" SectionFlags="0" SubIdent="0">
	<ParamSectHeader>
		<Version>26</Version>
		<AutoHotspots>false</AutoHotspots>
		<StatBits>
			<STBit_FixSize/>
		</StatBits>
		<WDLeftFrame>0</WDLeftFrame>
		<WDRightFrame>0</WDRightFrame>
		<WDTopFrame>0</WDTopFrame>
		<WDBotFrame>0</WDBotFrame>
		<LayFlags>65535</LayFlags>
		<WDMirrorThickness>0</WDMirrorThickness>
		<WDWallInset>0</WDWallInset>
		<SymbolColor>0</SymbolColor>
	</ParamSectHeader>
	<Parameters>
		<Length Name="A">
			<Description><![CDATA["Размер 1"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>1</Value>
		</Length>
		<Length Name="B">
			<Description><![CDATA["Размер 2"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>1</Value>
		</Length>

		<!-- gs_drawing_title_position: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="gs_drawing_title_position">
			<Description><![CDATA["Расположение"]]></Description>
		</Title>
		<String Name="gs_title_fit_mode">
			<Description><![CDATA["Располож. отн..."]]></Description>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value><![CDATA["Чертеж"]]></Value>
		</String>
		<Integer Name="AC_TitleFitMode">
			<Description><![CDATA["Располож. отн..."]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>1</Value>
		</Integer>
		<Boolean Name="AC_ManualPosition">
			<Description><![CDATA["Ручное размещение"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<String Name="AC_DrawingGUID">
			<Description><![CDATA["Ссылка на чертеж"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<Boolean Name="AC_EnableBackReference">
			<Description><![CDATA["Активировать обратную ссылку"]]></Description>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<String Name="AC_BackReferenceGUIDList">
			<Description><![CDATA["Список GUID рассмотр. макетов"]]></Description>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<ArrayValues FirstDimension="1" SecondDimension="0">
				<AVal Row="1"><![CDATA[""]]></AVal>
			</ArrayValues>
		</String>
		<String Name="gs_position_side">
			<Description><![CDATA["Сторона"]]></Description>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value><![CDATA["Верх"]]></Value>
		</String>
		<Integer Name="gs_position_side_int">
			<Description><![CDATA["Сторона"]]></Description>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>1</Value>
		</Integer>
		<String Name="gs_position_alignment">
			<Description><![CDATA["Выравнивание"]]></Description>
			<Value><![CDATA["Слева"]]></Value>
		</String>
		<Integer Name="gs_position_alignment_int">
			<Description><![CDATA["Выравнивание"]]></Description>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>1</Value>
		</Integer>
		<Length Name="gs_offset">
			<Description><![CDATA["Смещ.чертежа (размер модели)"]]></Description>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>1</Value>
		</Length>
		<Length Name="gs_offset_paper">
			<Description><![CDATA["Смещ.чертежа (размер бумаги)"]]></Description>
			<Value>0.01</Value>
		</Length>
		<Length Name="radi">
			<Description><![CDATA["Радиус окружности узла"]]></Description>
			<Value>0.005</Value>
		</Length>

		<!-- gs_drawing_title_rotation: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="gs_drawing_title_rotation">
			<Description><![CDATA["Угол поворота"]]></Description>
		</Title>
		<Boolean Name="gs_title_rotate_with_position">
			<Description><![CDATA["Поворачивать с располож."]]></Description>
			<Value>1</Value>
		</Boolean>
		<Boolean Name="gs_title_rotate_with_drawing">
			<Description><![CDATA["Поворачивать с чертежом"]]></Description>
			<Value>1</Value>
		</Boolean>
		<Angle Name="gs_title_rotation_angle">
			<Description><![CDATA["Спец. угол"]]></Description>
			<Value>0</Value>
		</Angle>

		<!-- gs_drawing_title_width: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="gs_drawing_title_width">
			<Description><![CDATA["Ширина"]]></Description>
		</Title>
		<Boolean Name="gs_link_title_width">
			<Description><![CDATA["Привязать ширину к располож."]]></Description>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>1</Value>
		</Boolean>
		<Length Name="gs_title_width">
			<Description><![CDATA["Шир.заголовка (размер модели)"]]></Description>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>1.19826429093</Value>
		</Length>
		<Length Name="gs_title_width_paper">
			<Description><![CDATA["Шир.заголовка (размер бумаги)"]]></Description>
			<Value>0.0119826429093</Value>
		</Length>
		<Length Name="gs_title_half_width">
			<Description><![CDATA["Пол шир. загол.(размер модели)"]]></Description>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0.599132145465</Value>
		</Length>

		<!-- gs_show_drawing_name: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Boolean Name="gs_show_drawing_name">
			<Description><![CDATA["Показ имени чертежа"]]></Description>
			<Flags>
				<ParFlg_BoldName/>
			</Flags>
			<Value>1</Value>
		</Boolean>
		<Boolean Name="gs_drawing_name_extension">
			<Description><![CDATA["С расширением"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_drawing_name_custom">
			<Description><![CDATA["Спец. имя чертежа"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<String Name="gs_drawing_name_custom_text">
			<Description><![CDATA["Специальный текст"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="gs_drawing_name_font_type">
			<Description><![CDATA["Тип шрифта"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA["ISOCPEUR Кириллический"]]></Value>
		</String>
		<RealNum Name="gs_drawing_name_font_size">
			<Description><![CDATA["Размер шрифта (мм)"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>5</Value>
		</RealNum>
		<RealNum Name="gs_drawing_name_font_size_point">
			<Description><![CDATA["Размер шрифта (пункты)"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>14.1732283465</Value>
		</RealNum>
		<PenColor Name="gs_drawing_name_font_pen">
			<Description><![CDATA["Перо шрифта"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>66</Value>
		</PenColor>
		<Boolean Name="gs_drawing_name_font_bold">
			<Description><![CDATA["Жирный шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_drawing_name_font_italic">
			<Description><![CDATA["Курсивный шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_drawing_name_font_under">
			<Description><![CDATA["Подчеркнутый шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Length Name="gs_drawing_name_pos_x">
			<Description><![CDATA["X позиция текста"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_drawing_name_pos_y">
			<Description><![CDATA["Y позиция текста"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_drawing_name_pos_x_paper">
			<Description><![CDATA["X поз.текста (размер бумаги)"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_drawing_name_pos_y_paper">
			<Description><![CDATA["Y поз.текста (размер бумаги)"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>

		<!-- gs_show_drawing_scale: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Boolean Name="gs_show_drawing_scale">
			<Description><![CDATA["Показ масштаба чертежа"]]></Description>
			<Flags>
				<ParFlg_BoldName/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_drawing_scale_original">
			<Description><![CDATA["Исп. исх. масштаб"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<String Name="gs_drawing_scale_prefix">
			<Description><![CDATA["Префикс масш.чертежа"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="gs_drawing_scale_font_type">
			<Description><![CDATA["Тип шрифта"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA["Arial Cyrillic"]]></Value>
		</String>
		<RealNum Name="gs_drawing_scale_font_size">
			<Description><![CDATA["Размер шрифта (мм)"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>4</Value>
		</RealNum>
		<RealNum Name="gs_drawing_scale_font_size_poin">
			<Description><![CDATA["Размер шрифта (пункты)"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>11.3385826772</Value>
		</RealNum>
		<PenColor Name="gs_drawing_scale_font_pen">
			<Description><![CDATA["Перо шрифта"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>66</Value>
		</PenColor>
		<Boolean Name="gs_drawing_scale_font_bold">
			<Description><![CDATA["Жирный шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_drawing_scale_font_italic">
			<Description><![CDATA["Курсивный шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_drawing_scale_font_under">
			<Description><![CDATA["Подчеркнутый шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Length Name="gs_drawing_scale_pos_x">
			<Description><![CDATA["X позиция текста"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_drawing_scale_pos_y">
			<Description><![CDATA["Y позиция текста"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_drawing_scale_pos_x_paper">
			<Description><![CDATA["X поз.текста (размер бумаги)"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_drawing_scale_pos_y_paper">
			<Description><![CDATA["Y поз.текста (размер бумаги)"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>

		<!-- gs_show_drawing_number: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Boolean Name="gs_show_drawing_number">
			<Description><![CDATA["Показать ID чертежа"]]></Description>
			<Flags>
				<ParFlg_BoldName/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<String Name="gs_drawing_number_prefix">
			<Description><![CDATA["Префикс ID чертежа"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="gs_drawing_number_font_type">
			<Description><![CDATA["Тип шрифта"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA["Arial Cyrillic"]]></Value>
		</String>
		<RealNum Name="gs_drawing_number_font_size">
			<Description><![CDATA["Размер шрифта (мм)"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>4</Value>
		</RealNum>
		<RealNum Name="gs_drawing_number_font_size_poi">
			<Description><![CDATA["Размер шрифта (пункты)"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>11.3385826772</Value>
		</RealNum>
		<PenColor Name="gs_drawing_number_font_pen">
			<Description><![CDATA["Перо шрифта"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>66</Value>
		</PenColor>
		<Boolean Name="gs_drawing_number_font_bold">
			<Description><![CDATA["Жирный шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_drawing_number_font_italic">
			<Description><![CDATA["Курсивный шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_drawing_number_font_under">
			<Description><![CDATA["Подчеркнутый шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Length Name="gs_drawing_number_pos_x">
			<Description><![CDATA["X позиция текста"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_drawing_number_pos_y">
			<Description><![CDATA["Y позиция текста"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_drawing_number_pos_x_paper">
			<Description><![CDATA["X поз.текста (размер бумаги)"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_drawing_number_pos_y_paper">
			<Description><![CDATA["Y поз.текста (размер бумаги)"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>

		<!-- gs_show_source_filename: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Boolean Name="gs_show_source_filename">
			<Description><![CDATA["Показ имени исх.файла и пути"]]></Description>
			<Flags>
				<ParFlg_BoldName/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<String Name="gs_source_filename_font_type">
			<Description><![CDATA["Тип шрифта"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA["Arial Cyrillic"]]></Value>
		</String>
		<RealNum Name="gs_source_filename_font_size">
			<Description><![CDATA["Размер шрифта (мм)"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>4.0005</Value>
		</RealNum>
		<RealNum Name="gs_source_filename_font_size_po">
			<Description><![CDATA["Размер шрифта (пункты)"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>11.34</Value>
		</RealNum>
		<PenColor Name="gs_source_filename_font_pen">
			<Description><![CDATA["Перо шрифта"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>66</Value>
		</PenColor>
		<Boolean Name="gs_source_filename_font_bold">
			<Description><![CDATA["Жирный шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_source_filename_font_italic">
			<Description><![CDATA["Курсивный шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_source_filename_font_under">
			<Description><![CDATA["Подчеркнутый шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Length Name="gs_source_filename_pos_x">
			<Description><![CDATA["X позиция текста"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_source_filename_pos_y">
			<Description><![CDATA["Y позиция текста"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_source_filename_pos_x_paper">
			<Description><![CDATA["X поз.текста (размер бумаги)"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_source_filename_pos_y_paper">
			<Description><![CDATA["Y поз.текста (размер бумаги)"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>

		<!-- gs_show_drawing_magnification: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Boolean Name="gs_show_drawing_magnification">
			<Description><![CDATA["Показ увеличения"]]></Description>
			<Flags>
				<ParFlg_BoldName/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<String Name="gs_drawing_magn_suffix">
			<Description><![CDATA["Суффикс увеличения"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[" %"]]></Value>
		</String>
		<String Name="gs_drawing_magn_font_type">
			<Description><![CDATA["Тип шрифта"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA["Arial Cyrillic"]]></Value>
		</String>
		<RealNum Name="gs_drawing_magn_font_size">
			<Description><![CDATA["Размер шрифта (мм)"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>4.0005</Value>
		</RealNum>
		<RealNum Name="gs_drawing_magn_font_size_point">
			<Description><![CDATA["Размер шрифта (пункты)"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>11.34</Value>
		</RealNum>
		<PenColor Name="gs_drawing_magn_font_pen">
			<Description><![CDATA["Перо шрифта"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>66</Value>
		</PenColor>
		<Boolean Name="gs_drawing_magn_font_bold">
			<Description><![CDATA["Жирный шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_drawing_magn_font_italic">
			<Description><![CDATA["Курсивный шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_drawing_magn_font_under">
			<Description><![CDATA["Подчеркнутый шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Length Name="gs_drawing_magn_pos_x">
			<Description><![CDATA["X позиция текста"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_drawing_magn_pos_y">
			<Description><![CDATA["Y позиция текста"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_drawing_magn_pos_x_paper">
			<Description><![CDATA["X поз.текста (размер бумаги)"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_drawing_magn_pos_y_paper">
			<Description><![CDATA["Y поз.текста (размер бумаги)"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>

		<!-- gs_show_project_filename: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Boolean Name="gs_show_project_filename">
			<Description><![CDATA["Показ имени файла проекта и пути"]]></Description>
			<Flags>
				<ParFlg_BoldName/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<String Name="gs_project_filename_font_type">
			<Description><![CDATA["Тип шрифта"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA["Arial Cyrillic"]]></Value>
		</String>
		<RealNum Name="gs_project_filename_font_size">
			<Description><![CDATA["Размер шрифта (мм)"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>4.0005</Value>
		</RealNum>
		<RealNum Name="gs_project_filename_font_size_p">
			<Description><![CDATA["Размер шрифта (пункты)"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>11.34</Value>
		</RealNum>
		<PenColor Name="gs_project_filename_font_pen">
			<Description><![CDATA["Перо шрифта"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>66</Value>
		</PenColor>
		<Boolean Name="gs_project_filename_font_bold">
			<Description><![CDATA["Жирный шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_project_filename_font_italic">
			<Description><![CDATA["Курсивный шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_project_filename_font_under">
			<Description><![CDATA["Подчеркнутый шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Length Name="gs_project_filename_pos_x">
			<Description><![CDATA["X позиция текста"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_project_filename_pos_y">
			<Description><![CDATA["Y позиция текста"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_project_filename_pos_x_paper">
			<Description><![CDATA["X поз.текста (размер бумаги)"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_project_filename_pos_y_paper">
			<Description><![CDATA["Y поз.текста (размер бумаги)"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>

		<!-- gs_show_layout_name: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Boolean Name="gs_show_layout_name">
			<Description><![CDATA["Показ имени макета"]]></Description>
			<Flags>
				<ParFlg_BoldName/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<String Name="gs_layout_name_font_type">
			<Description><![CDATA["Тип шрифта"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA["Arial Cyrillic"]]></Value>
		</String>
		<RealNum Name="gs_layout_name_font_size">
			<Description><![CDATA["Размер шрифта (мм)"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>4.0005</Value>
		</RealNum>
		<RealNum Name="gs_layout_name_font_size_point">
			<Description><![CDATA["Размер шрифта (пункты)"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>11.34</Value>
		</RealNum>
		<PenColor Name="gs_layout_name_font_pen">
			<Description><![CDATA["Перо шрифта"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>66</Value>
		</PenColor>
		<Boolean Name="gs_layout_name_font_bold">
			<Description><![CDATA["Жирный шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_layout_name_font_italic">
			<Description><![CDATA["Курсивный шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_layout_name_font_under">
			<Description><![CDATA["Подчеркнутый шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Length Name="gs_layout_name_pos_x">
			<Description><![CDATA["X позиция текста"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_layout_name_pos_y">
			<Description><![CDATA["Y позиция текста"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_layout_name_pos_x_paper">
			<Description><![CDATA["X поз.текста (размер бумаги)"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_layout_name_pos_y_paper">
			<Description><![CDATA["Y поз.текста (размер бумаги)"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>

		<!-- gs_show_layout_number: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Boolean Name="gs_show_layout_number">
			<Description><![CDATA["Показать ID макета"]]></Description>
			<Flags>
				<ParFlg_BoldName/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<String Name="gs_layout_number_prefix">
			<Description><![CDATA["Префикс ID макета"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="gs_layout_number_font_type">
			<Description><![CDATA["Тип шрифта"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA["Arial Cyrillic"]]></Value>
		</String>
		<RealNum Name="gs_layout_number_font_size">
			<Description><![CDATA["Размер шрифта (мм)"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>4</Value>
		</RealNum>
		<RealNum Name="gs_layout_number_font_size_poin">
			<Description><![CDATA["Размер шрифта (пункты)"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>11.34</Value>
		</RealNum>
		<PenColor Name="gs_layout_number_font_pen">
			<Description><![CDATA["Перо шрифта"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>66</Value>
		</PenColor>
		<Boolean Name="gs_layout_number_font_bold">
			<Description><![CDATA["Жирный шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_layout_number_font_italic">
			<Description><![CDATA["Курсивный шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_layout_number_font_under">
			<Description><![CDATA["Подчеркнутый шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Length Name="gs_layout_number_pos_x">
			<Description><![CDATA["X позиция текста"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_layout_number_pos_y">
			<Description><![CDATA["Y позиция текста"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_layout_number_pos_x_paper">
			<Description><![CDATA["X поз.текста (размер бумаги)"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_layout_number_pos_y_paper">
			<Description><![CDATA["Y поз.текста (размер бумаги)"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>

		<!-- AC_ShowDrawingReferences: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Boolean Name="AC_ShowDrawingReferences">
			<Description><![CDATA["Показать обратную ссылку"]]></Description>
			<Flags>
				<ParFlg_BoldName/>
			</Flags>
			<Value>1</Value>
		</Boolean>
		<String Name="gs_backref_separator">
			<Description><![CDATA["Разделитель ID макета"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[","]]></Value>
		</String>
		<Boolean Name="gs_backref_custom">
			<Description><![CDATA["Спец. обратные ссылки"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<String Name="gs_backref_customtxt">
			<Description><![CDATA["Специальный текст"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA["mn"]]></Value>
		</String>
		<String Name="gs_backref_prefix">
			<Description><![CDATA["Префикс обратной ссылки"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="gs_backref_font_type">
			<Description><![CDATA["Тип шрифта"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value><![CDATA["Arial Cyrillic"]]></Value>
		</String>
		<RealNum Name="gs_backref_font_size">
			<Description><![CDATA["Размер шрифта (мм)"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>4</Value>
		</RealNum>
		<RealNum Name="gs_backref_font_size_point">
			<Description><![CDATA["Размер шрифта (пункты)"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>11.34</Value>
		</RealNum>
		<PenColor Name="gs_backref_font_pen">
			<Description><![CDATA["Перо шрифта"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>66</Value>
		</PenColor>
		<Boolean Name="gs_backref_font_bold">
			<Description><![CDATA["Жирный шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_backref_font_italic">
			<Description><![CDATA["Курсивный шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_backref_font_under">
			<Description><![CDATA["Подчеркнутый шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Length Name="gs_backref_pos_x">
			<Description><![CDATA["X позиция текста"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_backref_pos_y">
			<Description><![CDATA["Y позиция текста"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_backref_pos_x_paper">
			<Description><![CDATA["X поз.текста (размер бумаги)"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_backref_pos_y_paper">
			<Description><![CDATA["Y поз.текста (размер бумаги)"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>

		<!-- gs_title_lines: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="gs_title_lines">
			<Description><![CDATA["Линии заголовка"]]></Description>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
		</Title>
		<LineType Name="gs_title_linetype">
			<Description><![CDATA["Тип линии"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>3</Value>
		</LineType>
		<PenColor Name="gs_title_pen">
			<Description><![CDATA["Перо"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>19</Value>
		</PenColor>

		<!-- gs_show_frame: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Boolean Name="gs_show_frame">
			<Description><![CDATA["Показать рамку"]]></Description>
			<Flags>
				<ParFlg_BoldName/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<PenColor Name="gs_frame_pen">
			<Description><![CDATA["Перо"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>7</Value>
		</PenColor>
		<LineType Name="gs_frame_linetype">
			<Description><![CDATA["Тип линии"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</LineType>
		<FillPattern Name="gs_frame_fill">
			<Description><![CDATA["Штриховка фона"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>23</Value>
		</FillPattern>
		<PenColor Name="gs_frame_fill_fg">
			<Description><![CDATA["Тип пера штриховки"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>6</Value>
		</PenColor>
		<PenColor Name="gs_frame_fill_bg">
			<Description><![CDATA["Тип пера фона штриховки"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>19</Value>
		</PenColor>

		<!-- gs_show_symbol: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Boolean Name="gs_show_symbol">
			<Description><![CDATA["Показать маркер"]]></Description>
			<Flags>
				<ParFlg_BoldName/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<PenColor Name="gs_symbol_pen">
			<Description><![CDATA["Перо"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>65</Value>
		</PenColor>
		<FillPattern Name="gs_symbol_fill">
			<Description><![CDATA["Штриховка фона"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>65</Value>
		</FillPattern>
		<PenColor Name="gs_symbol_fill_fg">
			<Description><![CDATA["Тип пера штриховки"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>65</Value>
		</PenColor>
		<PenColor Name="gs_symbol_fill_bg">
			<Description><![CDATA["Тип пера фона штриховки"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>125</Value>
		</PenColor>
		<Length Name="gs_symbol_pos">
			<Description><![CDATA["Расположение символа"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>1.19826429093</Value>
		</Length>
		<String Name="AC_TextFont">
			<Description><![CDATA["Тип шрифта"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value><![CDATA["ISOCPEUR Кириллический"]]></Value>
		</String>
		<RealNum Name="AC_TextSize">
			<Description><![CDATA["Размер шрифта"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>5</Value>
		</RealNum>
		<PenColor Name="AC_TextPen">
			<Description><![CDATA["Перо шрифта"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>1</Value>
		</PenColor>
		<Integer Name="AC_TextStyle">
			<Description><![CDATA["Стиль шрифта"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>1</Value>
		</Integer>
		<Boolean Name="AC_UseUniformTextFormat">
			<Description><![CDATA["Одинаковый формат текста"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>1</Value>
		</Boolean>
		<String Name="AC_DrawingName">
			<Description><![CDATA["Имя чертежа"]]></Description>
			<Flags>
				<ParFlg_Unique/>
			</Flags>
			<Value><![CDATA["Имя чертежа"]]></Value>
		</String>
		<String Name="AC_DrawingNumber">
			<Description><![CDATA["ID чертежа"]]></Description>
			<Flags>
				<ParFlg_Unique/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="AC_DrawingScale">
			<Description><![CDATA["Масштаб чертежа"]]></Description>
			<Flags>
				<ParFlg_Unique/>
			</Flags>
			<Value><![CDATA["1 : 100"]]></Value>
		</String>
		<String Name="AC_OriginalDrawingScale">
			<Description><![CDATA["Исх. масштаб чертежа"]]></Description>
			<Flags>
				<ParFlg_Unique/>
			</Flags>
			<Value><![CDATA["1 : 50"]]></Value>
		</String>
		<RealNum Name="AC_Magnification">
			<Description><![CDATA["Увеличение"]]></Description>
			<Flags>
				<ParFlg_Unique/>
			</Flags>
			<Value>1</Value>
		</RealNum>
		<String Name="AC_SourceFileName">
			<Description><![CDATA["Имя исх. файла"]]></Description>
			<Flags>
				<ParFlg_Unique/>
			</Flags>
			<Value><![CDATA["Имя исх. файла"]]></Value>
		</String>
		<String Name="AC_SourceFilePath">
			<Description><![CDATA["Путь исх. файла"]]></Description>
			<Flags>
				<ParFlg_Unique/>
			</Flags>
			<Value><![CDATA["Путь исх. файла"]]></Value>
		</String>
		<Integer Name="AC_PreviewType">
			<Description><![CDATA["Тип предв. просмотра"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Unique/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Integer>
		<Boolean Name="AC_ConvertedTitle">
			<Description><![CDATA["Конвертированный заголовок"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Length Name="AC_LayoutRect">
			<Description><![CDATA["Данные прямоуг. макета"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Unique/>
			</Flags>
			<ArrayValues FirstDimension="5" SecondDimension="0">
				<AVal Row="1">-2.21574609878</AVal>
				<AVal Row="2">0.263931800834</AVal>
				<AVal Row="3">3.94791507788</AVal>
				<AVal Row="4">2.13357035504</AVal>
				<AVal Row="5">341.3525</AVal>
			</ArrayValues>
		</Length>
		<Length Name="AC_GridRect">
			<Description><![CDATA["Данные прямоуг. сетки"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Unique/>
			</Flags>
			<ArrayValues FirstDimension="5" SecondDimension="0">
				<AVal Row="1">-0.161192373224</AVal>
				<AVal Row="2">0.887144652238</AVal>
				<AVal Row="3">2.29221947768</AVal>
				<AVal Row="4">2.69230076516</AVal>
				<AVal Row="5">341.3525</AVal>
			</ArrayValues>
		</Length>
		<Length Name="AC_DrawingRect">
			<Description><![CDATA["Данные прямоуг. чертежа"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Unique/>
			</Flags>
			<ArrayValues FirstDimension="5" SecondDimension="0">
				<AVal Row="1">0.19832778852</AVal>
				<AVal Row="2">1.72393537597</AVal>
				<AVal Row="3">1.83877444272</AVal>
				<AVal Row="4">1.58753253554</AVal>
				<AVal Row="5">311.9606</AVal>
			</ArrayValues>
		</Length>
		<String Name="gs_GLOB_MODPAR_NAME">
			<Description><![CDATA[""]]></Description>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<Boolean Name="gs_debug">
			<Description><![CDATA["Функция отладки"]]></Description>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<RealNum Name="AC_TextSize_1">
			<Description><![CDATA[""]]></Description>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>3</Value>
		</RealNum>
		<Integer Name="AC_TextStyle_1">
			<Description><![CDATA[""]]></Description>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Integer>
		<String Name="AC_TextFont_1">
			<Description><![CDATA[""]]></Description>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value><![CDATA["@Arial Unicode MS Кириллический"]]></Value>
		</String>
		<PenColor Name="AC_TextPen_1">
			<Description><![CDATA[""]]></Description>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>1</Value>
		</PenColor>
		<RealNum Name="AC_TextCharWidthFactor_1">
			<Description><![CDATA[""]]></Description>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>1</Value>
		</RealNum>
		<RealNum Name="AC_TextCharSpaceFactor_1">
			<Description><![CDATA[""]]></Description>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>1</Value>
		</RealNum>
	</Parameters>
</ParamSection>

<CalledMacros SectVersion="2" SectionFlags="0" SubIdent="0">
</CalledMacros>

<Copyright SectVersion="1" SectionFlags="0" SubIdent="0">
	<Author></Author>
	<License>
		<Type>CC0</Type>
		<Version>1.0</Version>
	</License>
</Copyright>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_FWM SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[
actualGUID = FROM_GUID

! ==============================================================================
! New integer parameters AC15 --> AC16
! New Font Style parameters AC15 --> AC16
! ==============================================================================

if actualGUID = "AE2D4CFC-58CB-40B5-8533-4E01FD9DEEB2" then

	returnedActID = 1

	dim mPositionSideMigration[4]
		mPositionSideMigration[1] = `Верх`
		mPositionSideMigration[2] = `Слева`
		mPositionSideMigration[3] = `Справа`
		mPositionSideMigration[4] = `Низ`

	dim mPositionAlignmentMigration[3]
		mPositionAlignmentMigration[1] = `Слева`
		mPositionAlignmentMigration[2] = `Центр`
		mPositionAlignmentMigration[3] = `Справа`


! ==============================================================================

	bHasParameters = DELETED_PAR_VALUE ("gs_position_side_int", gs_position_side_int)

	if not(bHasParameters) | (bHasParameters & gs_position_side_int = 0) then

		if DELETED_PAR_VALUE ("gs_position_side", gs_position_side) then

			! AUT, CHE, GER
			if gs_position_side = "Oben"	then gs_position_side = "Top"
			if gs_position_side = "Links"	then gs_position_side = "Left"
			if gs_position_side = "Rechts"	then gs_position_side = "Right"
			if gs_position_side = "Unten"	then gs_position_side = "Bottom"

			! CHI
			if gs_position_side = "??"		then gs_position_side = "Top"
			if gs_position_side = "?"		then gs_position_side = "Left"
			if gs_position_side = "?"		then gs_position_side = "Right"
			if gs_position_side = "??"		then gs_position_side = "Bottom"

			! CZE
			if gs_position_side = "nahore"			then gs_position_side = "Top"
			if gs_position_side = "na leve strane"	then gs_position_side = "Left"
			if gs_position_side = "na prave strane"	then gs_position_side = "Right"
			if gs_position_side = "Dolu"			then gs_position_side = "Bottom"

			! FIN
			if gs_position_side = "Ylhaalla"	then gs_position_side = "Top"
			if gs_position_side = "Vasen"		then gs_position_side = "Left"
			if gs_position_side = "Oikea"		then gs_position_side = "Right"
			if gs_position_side = "Alhaalla"	then gs_position_side = "Bottom"

			! FRA
			if gs_position_side = "Haut"		then gs_position_side = "Top"
			if gs_position_side = "Gauche"		then gs_position_side = "Left"
			if gs_position_side = "Droite"		then gs_position_side = "Right"
			if gs_position_side = "Bas"			then gs_position_side = "Bottom"

			! GRE
			if gs_position_side = "???"			then gs_position_side = "Top"
			if gs_position_side = "????????"	then gs_position_side = "Left"
			if gs_position_side = "?????"		then gs_position_side = "Right"
			if gs_position_side = "????"		then gs_position_side = "Bottom"

			! HUN
			if gs_position_side = "Felul"		then gs_position_side = "Top"
			if gs_position_side = "Balra"		then gs_position_side = "Left"
			if gs_position_side = "Jobbra"		then gs_position_side = "Right"
			if gs_position_side = "Alul"		then gs_position_side = "Bottom"

			! ITA
			if gs_position_side = "Sopra"		then gs_position_side = "Top"
			if gs_position_side = "Sinistra"	then gs_position_side = "Left"
			if gs_position_side = "Destra"		then gs_position_side = "Right"
			if gs_position_side = "Sotto"		then gs_position_side = "Bottom"

			! JPN
			if gs_position_side = "?"		then gs_position_side = "Top"
			if gs_position_side = "?"		then gs_position_side = "Left"
			if gs_position_side = "?"		then gs_position_side = "Right"
			if gs_position_side = "?"		then gs_position_side = "Bottom"

			! KOR
			if gs_position_side = "??"		then gs_position_side = "Top"
			if gs_position_side = "??"		then gs_position_side = "Left"
			if gs_position_side = "??"		then gs_position_side = "Right"
			if gs_position_side = "??"		then gs_position_side = "Bottom"

			! NED, FLA
			if gs_position_side = "Boven"		then gs_position_side = "Top"
			if gs_position_side = "Links"		then gs_position_side = "Left"
			if gs_position_side = "Rechts"		then gs_position_side = "Right"
			if gs_position_side = "Onder"		then gs_position_side = "Bottom"

			! POL
			if gs_position_side = "Gora"	then gs_position_side = "Top"
			if gs_position_side = "Lewa"	then gs_position_side = "Left"
			if gs_position_side = "Prawa"	then gs_position_side = "Right"
			if gs_position_side = "Dol"		then gs_position_side = "Bottom"

			! POR
			if gs_position_side = "Topo"		then gs_position_side = "Top"
			if gs_position_side = "Esquerda"	then gs_position_side = "Left"
			if gs_position_side = "Direita"		then gs_position_side = "Right"
			if gs_position_side = "Base"		then gs_position_side = "Bottom"

			! RUS
			if gs_position_side = "Верх"		then gs_position_side = "Top"
			if gs_position_side = "Слева"		then gs_position_side = "Left"
			if gs_position_side = "Справа"		then gs_position_side = "Right"
			if gs_position_side = "Низ"			then gs_position_side = "Bottom"

			! SPA
			if gs_position_side = "Arriba"		then gs_position_side = "Top"
			if gs_position_side = "Izquierdo"	then gs_position_side = "Left"
			if gs_position_side = "Derecha"		then gs_position_side = "Right"
			if gs_position_side = "Inferior"	then gs_position_side = "Bottom"

			! SWE
			if gs_position_side = "Topp"		then gs_position_side = "Top"
			if gs_position_side = "Vanster"		then gs_position_side = "Left"
			if gs_position_side = "Hoger"		then gs_position_side = "Right"
			if gs_position_side = "Botten"		then gs_position_side = "Bottom"

			! TAI
			if gs_position_side = "??"		then gs_position_side = "Top"
			if gs_position_side = "?"		then gs_position_side = "Left"
			if gs_position_side = "?"		then gs_position_side = "Right"
			if gs_position_side = "??"		then gs_position_side = "Bottom"

			! TUR
			if gs_position_side = "Ust"		then gs_position_side = "Top"
			if gs_position_side = "Sol"		then gs_position_side = "Left"
			if gs_position_side = "Sag"		then gs_position_side = "Right"
			if gs_position_side = "Alt"		then gs_position_side = "Bottom"

			! TODO

		! ------------------------------------------------------------------------------
			! AUS, DEN, INT, NOR, NZE, USA
			if gs_position_side = "Top"		then gs_position_side = mPositionSideMigration[1]
			if gs_position_side = "Left"	then gs_position_side = mPositionSideMigration[2]
			if gs_position_side = "Right"	then gs_position_side = mPositionSideMigration[3]
			if gs_position_side = "Bottom"	then gs_position_side = mPositionSideMigration[4]


			gs_position_side_int = 1		! Top
			if gs_position_side = mPositionSideMigration[2] then gs_position_side_int = 2	! Left
			if gs_position_side = mPositionSideMigration[3] then gs_position_side_int = 3	! Right
			if gs_position_side = mPositionSideMigration[4] then gs_position_side_int = 4	! Bottom
			parameters gs_position_side_int = gs_position_side_int
		else
			returnedActID = 0
		endif
	endif

! ==============================================================================

	bHasParameters = DELETED_PAR_VALUE ("gs_position_alignment_int", gs_position_alignment_int)

	if not(bHasParameters) | (bHasParameters & gs_position_alignment_int = 0) then

		if DELETED_PAR_VALUE ("gs_position_alignment", gs_position_alignment) then

			! AUT, CHE, GER
			if gs_position_alignment = "Links"		then gs_position_alignment = "Left"
			if gs_position_alignment = "Mittig"		then gs_position_alignment = "Center"
			if gs_position_alignment = "Rechts"		then gs_position_alignment = "Right"

			! CHI
			if gs_position_alignment = "?"			then gs_position_alignment = "Left"
			if gs_position_alignment = "??"		then gs_position_alignment = "Center"
			if gs_position_alignment = "?"			then gs_position_alignment = "Right"

			! CZE
			if gs_position_alignment = "na leve strane"		then gs_position_alignment = "Left"
			if gs_position_alignment = "stred"				then gs_position_alignment = "Center"
			if gs_position_alignment = "na prave strane"	then gs_position_alignment = "Right"

			! FIN
			if gs_position_alignment = "Vasen"		then gs_position_alignment = "Left"
			if gs_position_alignment = "Keskitetty"	then gs_position_alignment = "Center"
			if gs_position_alignment = "Oikea"		then gs_position_alignment = "Right"

			! FRA
			if gs_position_alignment = "Gauche"		then gs_position_alignment = "Left"
			if gs_position_alignment = "Centre "	then gs_position_alignment = "Center"
			if gs_position_alignment = "Droite"		then gs_position_alignment = "Right"

			! GRE
			if gs_position_alignment = "????????"	then gs_position_alignment = "Left"
			if gs_position_alignment = "??????"		then gs_position_alignment = "Center"
			if gs_position_alignment = "?????"		then gs_position_alignment = "Right"

			! HUN
			if gs_position_alignment = "Balra"		then gs_position_alignment = "Left"
			if gs_position_alignment = "Kozepen"	then gs_position_alignment = "Center"
			if gs_position_alignment = "Jobbra"		then gs_position_alignment = "Right"

			! ITA
			if gs_position_alignment = "Sinistra"	then gs_position_alignment = "Left"
			if gs_position_alignment = "Centro"		then gs_position_alignment = "Center"
			if gs_position_alignment = "Destra"		then gs_position_alignment = "Right"

			! JPN
			if gs_position_alignment = "?"			then gs_position_alignment = "Left"
			if gs_position_alignment = "??"		then gs_position_alignment = "Center"
			if gs_position_alignment = "?"			then gs_position_alignment = "Right"

			! KOR
			if gs_position_alignment = "??"		then gs_position_alignment = "Left"
			if gs_position_alignment = "??"		then gs_position_alignment = "Center"
			if gs_position_alignment = "??"		then gs_position_alignment = "Right"

			! NED, FLA
			if gs_position_alignment = "Links"		then gs_position_alignment = "Left"
			if gs_position_alignment = "Midden"		then gs_position_alignment = "Center"
			if gs_position_alignment = "Rechts"		then gs_position_alignment = "Right"

			! POL
			if gs_position_alignment = "Lewa"		then gs_position_alignment = "Left"
			if gs_position_alignment = "Srodek"		then gs_position_alignment = "Center"
			if gs_position_alignment = "Prawa"		then gs_position_alignment = "Right"

			! POR
			if gs_position_alignment = "Esquerda"	then gs_position_alignment = "Left"
			if gs_position_alignment = "Centro"		then gs_position_alignment = "Center"
			if gs_position_alignment = "Direita"	then gs_position_alignment = "Right"

			! RUS
			if gs_position_alignment = "Слева"		then gs_position_alignment = "Left"
			if gs_position_alignment = "Центр"		then gs_position_alignment = "Center"
			if gs_position_alignment = "Справа"		then gs_position_alignment = "Right"

			! SPA
			if gs_position_alignment = "Izquierdo"	then gs_position_alignment = "Left"
			if gs_position_alignment = "Centro"		then gs_position_alignment = "Center"
			if gs_position_alignment = "Derecha"	then gs_position_alignment = "Right"

			! SWE
			if gs_position_alignment = "Vanster"	then gs_position_alignment = "Left"
			if gs_position_alignment = "Centrum"	then gs_position_alignment = "Center"
			if gs_position_alignment = "Hoger"		then gs_position_alignment = "Right"

			! TAI
			if gs_position_alignment = "?"			then gs_position_alignment = "Left"
			if gs_position_alignment = "??"		then gs_position_alignment = "Center"
			if gs_position_alignment = "?"			then gs_position_alignment = "Right"

			! TUR
			if gs_position_alignment = "Sol"		then gs_position_alignment = "Left"
			if gs_position_alignment = "Merkez"		then gs_position_alignment = "Center"
			if gs_position_alignment = "Sag"		then gs_position_alignment = "Right"

			! TODO

		! ------------------------------------------------------------------------------
			! AUS, DEN, INT, NOR, NZE, USA
			if gs_position_alignment = "Top"	then gs_position_alignment = mPositionAlignmentMigration[1]
			if gs_position_alignment = "Left"	then gs_position_alignment = mPositionAlignmentMigration[2]
			if gs_position_alignment = "Right"	then gs_position_alignment = mPositionAlignmentMigration[3]

			gs_position_alignment_int = 1		! Left
			if gs_position_alignment = mPositionAlignmentMigration[2] then gs_position_alignment_int = 2		! Center
			if gs_position_alignment = mPositionAlignmentMigration[3] then gs_position_alignment_int = 3		! Right
			parameters gs_position_alignment_int = gs_position_alignment_int
		else
			returnedActID  = 0
		endif
	endif


! Font Style Control
! ==============================================================================

	! Drawing Name
	! ---------------------------------------------------------------------------------------------
	bHasParameters = DELETED_PAR_VALUE ("gs_drawing_name_font_istyle", gs_drawing_name_font_istyle)

	if not(bHasParameters) | (bHasParameters & gs_drawing_name_font_istyle = 0) then
		if DELETED_PAR_VALUE ("gs_drawing_name_font_style", gs_drawing_name_font_style) then
			styleString = gs_drawing_name_font_style
			gosub "ConvertStyleStringToBoolean"
		else
			returnedActID = 0
		endif
	else
		styleInteger = gs_drawing_name_font_istyle
		gosub "ConvertStyleIntegerToBoolean"
	endif

	gs_drawing_name_font_bold	= bStyleBold
	gs_drawing_name_font_italic	= bStyleItalic
	gs_drawing_name_font_under	= bStyleUnderline

	parameters gs_drawing_name_font_bold  	= gs_drawing_name_font_bold,
				gs_drawing_name_font_italic	= gs_drawing_name_font_italic,
				gs_drawing_name_font_under	= gs_drawing_name_font_under

	! Drawing Scale
	! ---------------------------------------------------------------------------------------------
	bHasParameters = DELETED_PAR_VALUE ("gs_drawing_scale_font_istyle", gs_drawing_scale_font_istyle)

	if not(bHasParameters) | (bHasParameters & gs_drawing_scale_font_istyle = 0) then
		if DELETED_PAR_VALUE ("gs_drawing_scale_font_style", gs_drawing_scale_font_style) then
			styleString = gs_drawing_scale_font_style
			gosub "ConvertStyleStringToBoolean"
		else
			returnedActID = 0
		endif
	else
		styleInteger = gs_drawing_scale_font_istyle
		gosub "ConvertStyleIntegerToBoolean"
	endif

	gs_drawing_scale_font_bold		= bStyleBold
	gs_drawing_scale_font_italic	= bStyleItalic
	gs_drawing_scale_font_under		= bStyleUnderline

	parameters gs_drawing_scale_font_bold  	= gs_drawing_scale_font_bold,
				gs_drawing_scale_font_italic= gs_drawing_scale_font_italic,
				gs_drawing_scale_font_under	= gs_drawing_scale_font_under

	! Drawing Number
	! ---------------------------------------------------------------------------------------------
	bHasParameters = DELETED_PAR_VALUE ("gs_drawing_number_font_istyle", gs_drawing_number_font_istyle)

	if not(bHasParameters) | (bHasParameters & gs_drawing_number_font_istyle = 0) then
		if DELETED_PAR_VALUE ("gs_drawing_number_font_style", gs_drawing_number_font_style) then
			styleString = gs_drawing_number_font_style
			gosub "ConvertStyleStringToBoolean"
		else
			returnedActID = 0
		endif
	else
		styleInteger = gs_drawing_number_font_istyle
		gosub "ConvertStyleIntegerToBoolean"
	endif

	gs_drawing_number_font_bold			= bStyleBold
	gs_drawing_number_font_italic		= bStyleItalic
	gs_drawing_number_font_under		= bStyleUnderline

	parameters gs_drawing_number_font_bold  	= gs_drawing_number_font_bold,
				gs_drawing_number_font_italic	= gs_drawing_number_font_italic,
				gs_drawing_number_font_under	= gs_drawing_number_font_under


	!  Source File Name and Path
	! ---------------------------------------------------------------------------------------------
	bHasParameters = DELETED_PAR_VALUE ("gs_source_filename_font_istyle", gs_source_filename_font_istyle)

	if not(bHasParameters) | (bHasParameters & gs_source_filename_font_istyle = 0) then
		if DELETED_PAR_VALUE ("gs_source_filename_font_style", gs_source_filename_font_style) then
			styleString = gs_source_filename_font_style
			gosub "ConvertStyleStringToBoolean"
		else
			returnedActID = 0
		endif
	else
		styleInteger = gs_source_filename_font_istyle
		gosub "ConvertStyleIntegerToBoolean"
	endif

	gs_source_filename_font_bold		= bStyleBold
	gs_source_filename_font_italic		= bStyleItalic
	gs_source_filename_font_under		= bStyleUnderline

	parameters gs_source_filename_font_bold  	= gs_source_filename_font_bold,
				gs_source_filename_font_italic	= gs_source_filename_font_italic,
				gs_source_filename_font_under	= gs_source_filename_font_under


	!  Source File Name and Path
	! ---------------------------------------------------------------------------------------------
	bHasParameters = DELETED_PAR_VALUE ("gs_drawing_magn_font_istyle", gs_drawing_magn_font_istyle)

	if not(bHasParameters) | (bHasParameters & gs_drawing_magn_font_istyle = 0) then
		if DELETED_PAR_VALUE ("gs_drawing_magn_font_style", gs_drawing_magn_font_style) then
			styleString = gs_drawing_magn_font_style
			gosub "ConvertStyleStringToBoolean"
		else
			returnedActID = 0
		endif
	else
		styleInteger = gs_drawing_magn_font_istyle
		gosub "ConvertStyleIntegerToBoolean"
	endif

	gs_drawing_magn_font_bold		= bStyleBold
	gs_drawing_magn_font_italic		= bStyleItalic
	gs_drawing_magn_font_under		= bStyleUnderline

	parameters gs_drawing_magn_font_bold  		= gs_drawing_magn_font_bold,
				gs_drawing_magn_font_italic		= gs_drawing_magn_font_italic,
				gs_drawing_magn_font_under		= gs_drawing_magn_font_under


	!  Project File Name and Path
	! ---------------------------------------------------------------------------------------------
	bHasParameters = DELETED_PAR_VALUE ("gs_project_filename_font_istyle", gs_project_filename_font_istyle)

	if not(bHasParameters) | (bHasParameters & gs_project_filename_font_istyle = 0) then
		if DELETED_PAR_VALUE ("gs_project_filename_font_style", gs_project_filename_font_style) then
			styleString = gs_project_filename_font_style
			gosub "ConvertStyleStringToBoolean"
		else
			returnedActID = 0
		endif
	else
		styleInteger = gs_project_filename_font_istyle
		gosub "ConvertStyleIntegerToBoolean"
	endif

	gs_project_filename_font_bold		= bStyleBold
	gs_project_filename_font_italic		= bStyleItalic
	gs_project_filename_font_under		= bStyleUnderline

	parameters gs_project_filename_font_bold 		= gs_project_filename_font_bold,
				gs_project_filename_font_italic		= gs_project_filename_font_italic,
				gs_project_filename_font_under		= gs_project_filename_font_under


	!  Layout Name
	! ---------------------------------------------------------------------------------------------
	bHasParameters = DELETED_PAR_VALUE ("gs_layout_name_font_istyle", gs_layout_name_font_istyle)

	if not(bHasParameters) | (bHasParameters & gs_layout_name_font_istyle = 0) then
		if DELETED_PAR_VALUE ("gs_layout_name_font_style", gs_layout_name_font_style) then
			styleString = gs_layout_name_font_style
			gosub "ConvertStyleStringToBoolean"
		else
			returnedActID = 0
		endif
	else
		styleInteger = gs_layout_name_font_istyle
		gosub "ConvertStyleIntegerToBoolean"
	endif

	gs_layout_name_font_bold		= bStyleBold
	gs_layout_name_font_italic		= bStyleItalic
	gs_layout_name_font_under		= bStyleUnderline

	parameters gs_layout_name_font_bold  		= gs_layout_name_font_bold,
				gs_layout_name_font_italic		= gs_layout_name_font_italic,
				gs_layout_name_font_under		= gs_layout_name_font_under


	!  Layout Number
	! ---------------------------------------------------------------------------------------------
	bHasParameters = DELETED_PAR_VALUE ("gs_layout_number_font_istyle", gs_layout_number_font_istyle)

	if not(bHasParameters) | (bHasParameters & gs_layout_number_font_istyle = 0) then
		if DELETED_PAR_VALUE ("gs_layout_number_font_style", gs_layout_number_font_style) then
			styleString = gs_layout_number_font_style
			gosub "ConvertStyleStringToBoolean"
		else
			returnedActID = 0
		endif
	else
		styleInteger = gs_layout_number_font_istyle
		gosub "ConvertStyleIntegerToBoolean"
	endif

	gs_layout_number_font_bold		= bStyleBold
	gs_layout_number_font_italic	= bStyleItalic
	gs_layout_number_font_under		= bStyleUnderline

	parameters gs_layout_number_font_bold  		= gs_layout_number_font_bold,
				gs_layout_number_font_italic	= gs_layout_number_font_italic,
				gs_layout_number_font_under		= gs_layout_number_font_under


	!  Back Reference
	! ---------------------------------------------------------------------------------------------
	gs_backref_font_istyle_temp = 0
	bHasParameters = DELETED_PAR_VALUE ("gs_backref_font_istyle", gs_backref_font_istyle_temp)

	if not(bHasParameters) | (bHasParameters & gs_backref_font_istyle_temp = 0) then
		if DELETED_PAR_VALUE ("gs_backref_font_style", gs_backref_font_style) then
			styleString = gs_backref_font_style
			gosub "ConvertStyleStringToBoolean"
		else
			! New Parameter at AC11

			bStyleBold		= 0
			bStyleItalic	= 0
			bStyleUnderline	= 0
		endif
	else
		styleInteger = gs_backref_font_istyle_temp
		gosub "ConvertStyleIntegerToBoolean"
	endif

	gs_backref_font_bold	= bStyleBold
	gs_backref_font_italic	= bStyleItalic
	gs_backref_font_under	= bStyleUnderline

	parameters gs_backref_font_bold  	= gs_backref_font_bold,
				gs_backref_font_italic	= gs_backref_font_italic,
				gs_backref_font_under	= gs_backref_font_under



	if returnedActID = 1 then
		actualGUID = "3D7E0964-647E-4BC3-AD69-9A4F39B9E65F"
	else
		actualGUID = ""
	endif
endif


! ==============================================================================
! Set migration GUID
! ==============================================================================

setmigrationguid actualGUID


! ==============================================================================
end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! end
! ==============================================================================


! ==============================================================================
! Convert localized style string to boolean
! ------------------------------------------------------------------------------
! Input Parameters:
!	styleString:	Localized style string
! Output:
!	bStyleBold:			Bold Style identifier (boolean)
!	bStyleItalic:		Italic Style identifier (boolean)
!	bStyleUnderline:	Underline identifier (boolean)
! ==============================================================================

"ConvertStyleStringToBoolean":

	! AUT, CHE, GER
	if styleString = "Fett"					then styleString = "Bold"
	if styleString = "Kursiv"				then styleString = "Italic"
	if styleString = "Fett Kursiv"			then styleString = "Bold Italic"
	if styleString = "Unterstrichen"		then styleString = "Underline"
	if styleString = "Normal"				then styleString = "Normal"

	! CHI
	if styleString = "??"					then styleString = "Bold"
	if styleString = "???"				then styleString = "Italic"
	if styleString = "???"				then styleString = "Bold Italic"
	if styleString = "???"				then styleString = "Underline"
	if styleString = "??"					then styleString = "Normal"

	! CZE
	if styleString = "tucne"				then styleString = "Bold"
	if styleString = "kurziva"				then styleString = "Italic"
	if styleString = "tucna kurziva"		then styleString = "Bold Italic"
	if styleString = "podtrzene"			then styleString = "Underline"
	if styleString = "obycejne"				then styleString = "Normal"

	! FIN
	if styleString = "Lihava"					then styleString = "Bold"
	if styleString = "Kursiivi"					then styleString = "Italic"
	if styleString = "Lihavoitu ja kursivoitu"	then styleString = "Bold Italic"
	if styleString = "Alleviivaus"				then styleString = "Underline"
	if styleString = "Normaali"					then styleString = "Normal"

	! FRA
	if styleString = "Gras"					then styleString = "Bold"
	if styleString = "Italique"				then styleString = "Italic"
	if styleString = "Gras italique"		then styleString = "Bold Italic"
	if styleString = "Souligne"				then styleString = "Underline"
	if styleString = "Normal"				then styleString = "Normal"

	! GRE
	if styleString = "??????"				then styleString = "Bold"
	if styleString = "??????"				then styleString = "Italic"
	if styleString = "?????? ??????"		then styleString = "Bold Italic"
	if styleString = "??????????????"		then styleString = "Underline"
	if styleString = "????????"				then styleString = "Normal"

	! HUN
	if styleString = "felkover"				then styleString = "Bold"
	if styleString = "dolt"					then styleString = "Italic"
	if styleString = "felkover dolt"		then styleString = "Bold Italic"
	if styleString = "alahuzott"			then styleString = "Underline"
	if styleString = "normal"				then styleString = "Normal"

	! ITA
	if styleString = "Grassetto"			then styleString = "Bold"
	if styleString = "Corsivo"				then styleString = "Italic"
	if styleString = "Grassetto Corsivo"	then styleString = "Bold Italic"
	if styleString = "Sottolineato"			then styleString = "Underline"
	if styleString = "Normale"				then styleString = "Normal"

	! JPN
	if styleString = "??"					then styleString = "Bold"
	if styleString = "??"					then styleString = "Italic"
	if styleString = "????"				then styleString = "Bold Italic"
	if styleString = "??"					then styleString = "Underline"
	if styleString = "??"					then styleString = "Normal"

	! KOR
	if styleString = "???"				then styleString = "Bold"
	if styleString = "????"				then styleString = "Italic"
	if styleString = "?? ????"			then styleString = "Bold Italic"
	if styleString = "??"					then styleString = "Underline"
	if styleString = "??"					then styleString = "Normal"

	! NED, FLA
	if styleString = "Vet"					then styleString = "Bold"
	if styleString = "Cursief"				then styleString = "Italic"
	if styleString = "Vet cursief"			then styleString = "Bold Italic"
	if styleString = "Onderstrepen"			then styleString = "Underline"
	if styleString = "Normaal"				then styleString = "Normal"

	! POL
	if styleString = "Pogrubienie"			then styleString = "Bold"
	if styleString = "Kursywa"				then styleString = "Italic"
	if styleString = "Pogrubiona kursywa"	then styleString = "Bold Italic"
	if styleString = "Podkreslenie"			then styleString = "Underline"
	if styleString = "Normalny"				then styleString = "Normal"

	! POR
	if styleString = "A cheio"				then styleString = "Bold"
	if styleString = "Italico"				then styleString = "Italic"
	if styleString = "A Cheio Italico"		then styleString = "Bold Italic"
	if styleString = "Sublinhado"			then styleString = "Underline"
	if styleString = "Normal"				then styleString = "Normal"

	! RUS
	if styleString = "Жирный"				then styleString = "Bold"
	if styleString = "Курсив"				then styleString = "Italic"
	if styleString = "Жирный курсив"		then styleString = "Bold Italic"
	if styleString = "Подчеркнутый"			then styleString = "Underline"
	if styleString = "Обычный"				then styleString = "Normal"

	! SPA
	if styleString = "Negrita"				then styleString = "Bold"
	if styleString = "Cursiva"				then styleString = "Italic"
	if styleString = "Negrita Cursiva"		then styleString = "Bold Italic"
	if styleString = "Subrayado"			then styleString = "Underline"
	if styleString = "Normal"				then styleString = "Normal"

	! SWE
	if styleString = "Fet"					then styleString = "Bold"
	if styleString = "Kursiv"				then styleString = "Italic"
	if styleString = "Fet Kursiv"			then styleString = "Bold Italic"
	if styleString = "Understruket"			then styleString = "Underline"
	if styleString = "Normal"				then styleString = "Normal"

	! TAI
	if styleString = "??"					then styleString = "Bold"
	if styleString = "???"				then styleString = "Italic"
	if styleString = "???"				then styleString = "Bold Italic"
	if styleString = "???"				then styleString = "Underline"
	if styleString = "??"					then styleString = "Normal"

	! TUR
	if styleString = "Kal?n"				then styleString = "Bold"
	if styleString = "Italik"				then styleString = "Italic"
	if styleString = "Kal?n Italik"			then styleString = "Bold Italic"
	if styleString = "Alt Cizgili"			then styleString = "Underline"
	if styleString = "Normal"				then styleString = "Normal"

			! TODO

! ------------------------------------------------------------------------------

	! AUS, DEN, INT, NOR, NZE, NZE, USA

	bStyleBold		= 0
	bStyleItalic	= 0
	bStyleUnderline	= 0

	if styleString = "Bold"		| styleString = "Bold Italic"	then bStyleBold = 1
	if styleString = "Italic"	| styleString = "Bold Italic"	then bStyleItalic = 1
	if styleString = "Underline"								then bStyleUnderline = 1


return

! ==============================================================================
! Convert integer identifier to boolean
! ------------------------------------------------------------------------------
! Input Parameters:
!	styleInteger:		Integer identifier
! Output:
!	bStyleBold:			Bold Style identifier (boolean)
!	bStyleItalic:		Italic Style identifier (boolean)
!	bStyleUnderline:	Underline identifier (boolean)
! ==============================================================================

"ConvertStyleIntegerToBoolean":

	bStyleBold		= 0
	bStyleItalic	= 0
	bStyleUnderline	= 0

	if styleInteger = 1	| styleInteger = 3	then bStyleBold = 1
	if styleInteger = 2	| styleInteger = 3	then bStyleItalic = 1
	if styleInteger = 4						then bStyleUnderline = 1

return

]]>
</Script_FWM>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_BWM SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[
bContinue = 1

! ==============================================================================
! Integer control parameters AC16 --> AC15
! ==============================================================================

if bContinue then
	! from 3D7E0964-647E-4BC3-AD69-9A4F39B9E65F to AE2D4CFC-58CB-40B5-8533-4E01FD9DEEB2
	returnedTargetID = 1

! Font Style Control
! ==============================================================================

	newparameter "gs_drawing_name_font_istyle", "Integer"
	bStyleBold		= gs_drawing_name_font_bold
	bStyleItalic	= gs_drawing_name_font_italic
	bStyleUnderline	= gs_drawing_name_font_under
	gosub "ConvertBooleanToStyleInteger"
	gs_drawing_name_font_istyle = styleInteger
	parameters gs_drawing_name_font_istyle = gs_drawing_name_font_istyle

	newparameter "gs_drawing_scale_font_istyle", "Integer"
	bStyleBold		= gs_drawing_scale_font_bold
	bStyleItalic	= gs_drawing_scale_font_italic
	bStyleUnderline	= gs_drawing_scale_font_under
	gosub "ConvertBooleanToStyleInteger"
	gs_drawing_scale_font_istyle = styleInteger
	parameters gs_drawing_scale_font_istyle = gs_drawing_scale_font_istyle

	newparameter "gs_drawing_number_font_istyle", "Integer"
	bStyleBold		= gs_drawing_number_font_bold
	bStyleItalic	= gs_drawing_number_font_italic
	bStyleUnderline	= gs_drawing_number_font_under
	gosub "ConvertBooleanToStyleInteger"
	gs_drawing_number_font_istyle = styleInteger
	parameters gs_drawing_number_font_istyle = gs_drawing_number_font_istyle

	newparameter "gs_source_filename_font_istyle", "Integer"
	bStyleBold		= gs_source_filename_font_bold
	bStyleItalic	= gs_source_filename_font_italic
	bStyleUnderline	= gs_source_filename_font_under
	gosub "ConvertBooleanToStyleInteger"
	gs_source_filename_font_istyle = styleInteger
	parameters gs_source_filename_font_istyle = gs_source_filename_font_istyle

	newparameter "gs_drawing_magn_font_istyle", "Integer"
	bStyleBold		= gs_drawing_magn_font_bold
	bStyleItalic	= gs_drawing_magn_font_italic
	bStyleUnderline	= gs_drawing_magn_font_under
	gosub "ConvertBooleanToStyleInteger"
	gs_drawing_magn_font_istyle = styleInteger
	parameters gs_drawing_magn_font_istyle = gs_drawing_magn_font_istyle

	newparameter "gs_project_filename_font_istyle", "Integer"
	bStyleBold		= gs_project_filename_font_bold
	bStyleItalic	= gs_project_filename_font_italic
	bStyleUnderline	= gs_project_filename_font_under
	gosub "ConvertBooleanToStyleInteger"
	gs_project_filename_font_istyle = styleInteger
	parameters gs_project_filename_font_istyle = gs_project_filename_font_istyle

	newparameter "gs_layout_name_font_istyle", "Integer"
	bStyleBold		= gs_layout_name_font_bold
	bStyleItalic	= gs_layout_name_font_italic
	bStyleUnderline	= gs_layout_name_font_under
	gosub "ConvertBooleanToStyleInteger"
	gs_layout_name_font_istyle = styleInteger
	parameters gs_layout_name_font_istyle = gs_layout_name_font_istyle

	newparameter "gs_layout_number_font_istyle", "Integer"
	bStyleBold		= gs_layout_number_font_bold
	bStyleItalic	= gs_layout_number_font_italic
	bStyleUnderline	= gs_layout_number_font_under
	gosub "ConvertBooleanToStyleInteger"
	gs_layout_number_font_istyle = styleInteger
	parameters gs_layout_number_font_istyle = gs_layout_number_font_istyle

	newparameter "gs_backref_font_istyle", "Integer"
	bStyleBold		= gs_backref_font_bold
	bStyleItalic	= gs_backref_font_italic
	bStyleUnderline	= gs_backref_font_under
	gosub "ConvertBooleanToStyleInteger"
	gs_backref_font_istyle = styleInteger
	parameters gs_backref_font_istyle = gs_backref_font_istyle

	if returnedTargetID = 1 then
		targetGUID = "AE2D4CFC-58CB-40B5-8533-4E01FD9DEEB2"
	else
		targetGuid = ""
		bContinue = 0
	endif
	if TO_GUID = "AE2D4CFC-58CB-40B5-8533-4E01FD9DEEB2" then bContinue = 0
endif

! ==============================================================================
! Set migration GUID
! ==============================================================================

setmigrationguid targetGuid

! ==============================================================================
end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! end
! ==============================================================================

! ==============================================================================
! Convert boolean to style integer
! ------------------------------------------------------------------------------
! Input Parameters:
!	bStyleBold:			Bold Style identifier (boolean)
!	bStyleItalic:		Italic Style identifier (boolean)
!	bStyleUnderline:	Underline identifier (boolean)
! Output:
!	styleInteger:		Style integer
! ==============================================================================

"ConvertBooleanToStyleInteger":

	styleInteger = 0
	iStyle = bStyleBold + 2 * bStyleItalic + 4 * bStyleUnderline

	if iStyle = 0 then styleInteger = 5	! Normal
	if iStyle = 1 then styleInteger = 1	! Bold
	if iStyle = 2 then styleInteger = 2	! Italic
	if iStyle = 3 then styleInteger = 3	! Bold italic
	if iStyle = 4 then styleInteger = 4	! Underline

	if styleInteger = 0 then
		! migartionwarning : Some Font Style are not available in previous version
		if iStyle = 5 then styleInteger = 1	! Bold, Underline -> Bold
		if iStyle = 6 then styleInteger = 2	! Italic, Underline -> Italic
		if iStyle = 7 then styleInteger = 3	! Bold, Italic, Underline -> Bold Italic
	endif

return
]]>
</Script_BWM>

<MigrationTable SectVersion="1" SectionFlags="0" SubIdent="0">
	<MigrationTableElement>
		<MainGUID>AE2D4CFC-58CB-40B5-8533-4E01FD9DEEB2</MainGUID>
		<Version>15</Version>
		<Name><![CDATA[""]]></Name>
		<AutoMigration>false</AutoMigration>
	</MigrationTableElement>
</MigrationTable>

<Keywords SectVersion="1" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Keywords>

</Symbol>
