<?xml version="1.0" encoding="UTF-8"?>
<Symbol IsArchivable="false" IsPlaceable="true" MainGUID="0B6CEF83-2521-454E-900D-C609BF7A0C5A" MigrationValue="Normal" Owner="0" Signature="1196644685" Version="43">
<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_2D SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[
L=0.01*GLOB_SCALE
MUL2   L,L
DEFINE STYLE "текст25-3"  fontType, 2.5, 3, rtype
DEFINE STYLE "текст25-5"  fontType, r255, 5, r255type
DEFINE STYLE "текст18-4"  fontType, r184, 4, r184type
DEFINE STYLE "текст20-5"  fontType, r205, 5, r205type
DEFINE STYLE "текст20-4"  fontType, r205, 4, r205type
DEFINE STYLE "текст50-5"  fontType, r505, 5, r505type
DEFINE STYLE "текст18-5"  fontType, r184, 5, r184type

n = REQUEST ("HomeDB_info", "", homeDBIntId, homeDBUserId, homeDBName, homeContext)
if homeContext<>5 then
	is_num = 0
else
	if diff_type_table then
		if homeDBUserId = "1" then
			type_table = type_table_first
		else
			type_table = type_table_next
		endif
	endif
endif
if not(is_autotext) then
	current_phase = phase
endif
if tend_date = " " then tend_date = current_date
tn_change = vardim1(change_info)

if shifrt_l<>" " and shifrt_l<>"" then
	shifr = shifrt_l + delim_part + current_part
else
	shifr = shifrt + delim_part + current_part
endif
IF type_table <> 99 and type_table > 4 THEN 
	HOTSPOT2 0,0
	is_end = 0
	IF type_table = 5 THEN
		gosub "table_type_5"
		is_end = 1
	endif
	IF type_table = 6 THEN !Дата изм 0
		SET STYLE "текст20-5"
		TEXT2  0,0,current_date 
		is_end = 1
	endif
	IF type_table = 7 THEN !Шифр
		SET STYLE "текст50-5"
		TEXT2  0,0,shifr 
		is_end = 1
	endif
	IF type_table = 8 THEN !Стадия
		SET STYLE "текст50-5"
		TEXT2  0,0,"Стадия " + current_phase 
		is_end = 1
	endif
	IF type_table = 9 THEN
		SET STYLE "текст50-5"
		if current_phase = "П" then naen_dok = "Проектная документация" 
		if current_phase = "Р" then naen_dok = "Рабочая документация" 
		TEXT2  0,0,naen_dok 
		is_end = 1
	endif
	if is_end then end
endif

if _bERROR then
	pen_small = pen_error
	pen_osn = pen_error
	pen_podp = pen_error
	pen_text = pen_error
	LINE2  0, 0, hsh, lsh
	LINE2  hsh, 0, 0, lsh
endif

IF is_boundary THEN gosub "out_boundary"
gosub "inner_boundary"

if type_table = 10 then
	is_second = 0
	if homeContext = 5 then
		curren_ID = 0
		n1= SPLIT (homeDBUserId, "%n", curren_ID)
		if curren_ID>1 then	is_second = 1
	endif
	if iscont then is_second = 1
	if not(is_second) then type_table = 1
endif

if is_dop_graph and type_table <> 10 then gosub "dop_graph"
if is_agreed and type_table <> 10 then gosub "agreed"


IF type_table = 98 THEN gosub "table_type_98"
IF type_table = 97 THEN gosub "table_type_9"

IF type_table = 99 THEN gosub "table_type_99"
IF type_table = 4 THEN gosub "table_type_4"
IF type_table = 3 THEN gosub "table_type_3"
IF type_table = 2 THEN gosub "table_type_2"
IF type_table = 1 THEN gosub "table_type_1"
IF type_table = 10 THEN gosub "table_type_10"
del top
END

"table_type_5":
	pen SYMB_VIEW_PEN
	lsh = 6
	hsh = max (2, tn_change*0.5+0.5)
	pen pen_osn
	RECT2 0, 0, lsh, hsh
	RECT2 0, hsh, lsh, hsh-0.5
	line2 1,0, 1, hsh
	line2 2.5,0, 2.5, hsh
	line2 4.5,0, 4.5, hsh
	hotspot2 1,0
	hotspot2 2.5,0
	hotspot2 4.5,0
	hotspot2 0,0
	hotspot2 lsh,0
	hotspot2 lsh,hsh
	hotspot2 0,hsh
	pen pen_small
	for x = 0.5 to hsh-1 step 0.5
		line2 0,x, lsh, x	
	next x
	PEN pen_text
	SET STYLE "текст18-5"
	text2 0.5,hsh-0.25,"Изм."
	text2 1.75,hsh-0.25,"№ док."
	text2 3.5,hsh-0.25,"Подп."
	text2 5.25,hsh-0.25,"Дата"
	i = 0
	for x = hsh-0.75 to 0 step -0.5
		i = i + 1
		if i <= tn_change then
			if vartype(change_info[i][2]) = 2 then 
				if strlen(change_info[i][2])>-1 then
					TEXT2  0.5, x, change_info[i][1]
					TEXT2  1.75, x, change_info[i][3]
					if end_date then change_info[i][5] = tend_date
					if tis_date then TEXT2  5.25, x, change_info[i][5]
					add2 2.6, x-0.25
					surname = change_info[i][4] : gosub "signature"
					del 1
				endif
			endif
		endif
	next x
return

"table_type_1":
	pen SYMB_VIEW_PEN
	ADD2 hsh-19, 0.5
	hotspot2 13.5, 1.5
	hotspot2 0, 0
	hotspot2 0, 5.5+(tn_change-4)*0.5*(tn_change>4)
	hotspot2 0, 5.5
	hotspot2 18.5,5.5
	hotspot2 1.7, 0
	hotspot2 1.7, 5.5+(tn_change-4)*0.5*(tn_change>4)
	hotspot2 4, 0
	hotspot2 4, 5.5+(tn_change-4)*0.5*(tn_change>4)
	hotspot2 5.5, 0
	hotspot2 5.5, 5.5+(tn_change-4)*0.5*(tn_change>4)
	hotspot2 6.5, 0
	hotspot2 6.5, 5.5+(tn_change-4)*0.5*(tn_change>4)
	hotspot2 6.5, 1.5
	hotspot2 18.5, 1.5
	hotspot2 13.5, 0
	hotspot2 13.5, 3.0
	hotspot2 15, 1.5
	hotspot2 15, 2.5
	hotspot2 15, 3.0
	hotspot2 16.5, 1.5
	hotspot2 16.5, 2.5
	hotspot2 16.5, 3.0
	hotspot2 13.5, 2.5
	hotspot2 18.5, 2.5
	hotspot2 6.5, 3.0
	hotspot2 18.5, 3.0
	hotspot2 6.5, 4.5
	hotspot2 18.5, 4.5

	pen pen_osn
	LINE2  0, 0, 0, 5.5+(tn_change-4)*0.5*(tn_change>4)
	LINE2  0, 5.5 ,18.5,5.5
	LINE2  1.7, 0, 1.7, 5.5+(tn_change-4)*0.5*(tn_change>4)
	LINE2  4, 0, 4, 5.5+(tn_change-4)*0.5*(tn_change>4)
	LINE2  5.5, 0, 5.5, 5.5+(tn_change-4)*0.5*(tn_change>4)
	LINE2  6.5, 0, 6.5, 5.5+(tn_change-4)*0.5*(tn_change>4)

	LINE2  0, 3.0, 18.5, 3.0
	LINE2  0, 3.5, 6.5, 3.5
	LINE2  6.5, 1.5, 18.5, 1.5
	LINE2  13.5, 0.0, 13.5, 3.0
	LINE2  15.0, 1.5, 15.0, 3.0
	LINE2  16.5, 1.5, 16.5, 3.0
	LINE2  13.5, 2.5, 18.5, 2.5
	LINE2  6.5, 4.5, 18.5, 4.5

	SET STYLE "текст20-5"
	PEN pen_text
	TEXT2  14.25, 2.75, "Стадия"
	TEXT2  15.75,2.75,"Лист"
	TEXT2  17.5,2.75,"Листов"
	SET STYLE "текст25-5"
	TEXT2  14.25, 2, current_phase
	TEXT2  15.75,2,sheet_id
	SET STYLE "текст50-5"
	TEXT2  12.5,5,shifr
	SET STYLE "текст25-5"
	upper_bound = 5.5
	start_change = 3
	gosub "position"
RETURN

"table_type_2":
	pen SYMB_VIEW_PEN
	ADD2 hsh-19, 0.5
	pen pen_osn
	LINE2  0, 0, 0, 5.5
	LINE2  0, 5.5 ,18.5,5.5
	LINE2  1.7, 0, 1.7, 5.5
	LINE2  4, 0, 4, 5.5
	LINE2  5.5, 0, 5.5, 5.5
	LINE2  6.5, 0, 6.5, 5.5
	pen pen_small
	LINE2  6.5, 1.5, 18.5, 1.5
	LINE2  6.5, 4, 18.5, 4
	LINE2  13.5, 3.5, 18.5, 3.5
	LINE2  13.5, 2, 18.5, 2
	LINE2  13.5, 0, 13.5, 4
	LINE2  15, 2, 15, 4
	LINE2  16.5, 2, 16.5, 4
	LINE2  15.5, 1.5, 15.5, 2
	SET STYLE "текст20-5"
	PEN pen_text
	TEXT2  14.25, 3.75, "Стадия"
	TEXT2  15.75,3.75,"Масса"
	TEXT2  17.5,3.75,"Масштаб"
	TEXT2  14.0,1.75,"Лист"
	TEXT2  16.5,1.75,"Листов"
	SET STYLE "текст25-5"
	TEXT2  14.25, 2.75, current_phase
	TEXT2  15.75, 2.75, weight
	TEXT2  17.5, 2.75, "б/м"
	SET STYLE "текст20-5"
	TEXT2  15,1.75,sheet_id
	SET STYLE "текст50-5"
	TEXT2  12.5,4.75,shifr+delim_part+subpos
	SET STYLE "текст25-5"
	upper_bound = 5.5
	start_change = 3
	gosub "position"
RETURN

"table_type_3":
	pen SYMB_VIEW_PEN
	ADD2 hsh-19, 0.5
	LINE2  0, 0, 0, 4
	LINE2  0, 4 ,18.5,4
	LINE2  1.7, 0, 1.7, 4
	LINE2  4, 0, 4, 4
	LINE2  5.5, 0, 5.5, 4
	LINE2  6.5, 0, 6.5, 4
	LINE2  13.5, 0, 13.5, 2.5
	LINE2  15, 1.5, 15, 2.5
	LINE2  16.5, 1.5, 16.5, 2.5
	LINE2  0, 0.5, 6.5, .5
	LINE2  0, 1, 6.5, 1
	LINE2  0, 1.5, 6.5, 1.5
	LINE2  13.5, 1.5, 18.5, 1.5
	LINE2  0, 2, 6.5, 2
	LINE2  0, 2.5, 18.5, 2.5
	LINE2  13.5, 2, 18.5, 2
	LINE2  0, 3, 6.5, 3
	LINE2  0, 3.5, 6.5, 3.5
	SET STYLE "текст20-5"
	PEN  pen_text
	TEXT2  14.25, 2.25, "Стадия"
	TEXT2  15.75,2.25,"Лист"
	TEXT2  17.5,2.25,"Листов"
	SET STYLE "текст20-5"
	TEXT2  14.25, 1.75, current_phase
	TEXT2  15.75,1.75,sheet_id
	SET STYLE "текст50-5"
	TEXT2  12.5,3.2,shifr
	SET STYLE "текст25-5"
	TEXT2  10,1.25,naen_sheet
	gosub "position"
RETURN

"table_type_4":
	pen SYMB_VIEW_PEN
	ADD2 hsh-13.5, 0.5
	LINE2  0, 0, 0, 1.5
	LINE2  0, 1.5 ,13,1.5
	LINE2  12, 0, 12, 1.5
	LINE2  12, 1, 13, 1
	SET STYLE "текст20-5"
	PEN pen_text
	TEXT2  12.5,1.25,"Лист"
	TEXT2  12.5,0.5,sheet_id
	SET STYLE "текст50-5"
	TEXT2  6.5,0.75,shifr
	SET STYLE "текст25-5"
RETURN

"table_type_99":
	pen SYMB_VIEW_PEN
	ADD2 hsh-19, 0.5

	hotspot2 0.0,	0.0		! НЛ угол ШТАММПА А4
	hotspot2 0.0,	2.0		! ВЛ угол ШТАММПА А4
	hotspot2 0.0,	0.5
	hotspot2 0.0,	1.0
	hotspot2 0.0,	1.5
	hotspot2 1.7,	0.5
	hotspot2 1.7,	1.0
	hotspot2 1.7,	1.5
	hotspot2 4.0,	0.5
	hotspot2 4.0,	1.0
	hotspot2 4.0,	1.5
	hotspot2 5.5,	0.5
	hotspot2 5.5,	1.0
	hotspot2 5.5,	1.5
	hotspot2 6.5,	0.5
	hotspot2 6.5,	1.0
	hotspot2 6.5,	1.5
	hotspot2 18.5,	0.0		! НП угол ШТАММПА А4
	hotspot2 18.5,	2.0		! ВП угол ШТАММПА А4
	hotspot2 17.5,	0.0 
	hotspot2 17.5,	1.0 
	hotspot2 18.5,	1.0 
	hotspot2 17.5,	2.0
	hotspot2 16.5,	0.0 
	hotspot2 16.5,	1.0 
	hotspot2 16.5,	2.0
	hotspot2 5.5,	0.0
	hotspot2 5.5,	2.0
	hotspot2 1.7,	0.0
	hotspot2 1.7,	2.0
	hotspot2 4.0,	0.0
	hotspot2 4.0,	2.0
	hotspot2 6.5,	0.0
	hotspot2 6.5,	2.0

	hotspot2 1.5,	2.0
	hotspot2 3.0,	2.0
	hotspot2 13.5,	2.0
	hotspot2 15.0,	2.0
	hotspot2 1.5,	23.7
	hotspot2 3.0,	23.7
	hotspot2 13.5,	23.7
	hotspot2 15.0,	23.7
	hotspot2 0.0,	23.7
	hotspot2 18.5,	23.7
	hotspot2 1.5,	24.2
	hotspot2 3.0,	24.2
	hotspot2 13.5,	24.2
	hotspot2 15.0,	24.2
	hotspot2 0.0,	24.2
	hotspot2 18.5,	24.2
	hotspot2 7.5,	24.2
	hotspot2 7.5,	26.2
	hotspot2 3.0,	26.2
	hotspot2 0.0,	26.2
	hotspot2 18.5,	26.2
	hotspot2 7.5,	27.2
	hotspot2 3.0,	27.2
	hotspot2 0.0,	27.2
	hotspot2 18.5,	27.2
	hotspot2 4.0,	27.2
	hotspot2 4.0,	28.7

	PEN pen_small
	LINE2  0, 	0.5, 	6.5, 	0.5
	LINE2  0, 	1, 		6.5, 	1
	LINE2  0, 	1.5, 	6.5, 	1.5

	PEN pen_osn
	LINE2  16.5,	0.0,	16.5,	2.0
	LINE2  17.5,	0.0,	17.5,	2.0
	LINE2  0.0,		2.0,	18.5,	2.0
	LINE2  16.5,	1.0,	18.5,	1.0
	LINE2  1.5,		2.0,	1.5,	24.2
	LINE2  3.0,		2.0,	3.0,	27.2
	LINE2  13.5,	2.0,	13.5,	24.2
	LINE2  15.0,	2.0,	15.0,	24.2
	LINE2  0.0,		23.7,	18.5,	23.7
	LINE2  0.0,		24.2,	18.5,	24.2
	LINE2  0.0,		26.2,	18.5,	26.2
	LINE2  0.0,		27.2,	18.5,	27.2
	LINE2  4.0,		27.2,	4.0,	28.7
	LINE2  7.5,		24.2,	7.5,	27.2

	LINE2  0, 	0, 		0, 		2
	LINE2  1.7, 0, 		1.7, 	2
	LINE2  5.5, 0, 		5.5, 	2
	LINE2  6.5, 0, 		6.5, 	2
	LINE2  4, 	0, 		4, 		2

	SET STYLE "текст20-5"
	PEN  pen_text
	TEXT2  17.0,1.5,"Лист"
	TEXT2  18.0,1.5,"Листов"
	TEXT2  0.8,23.9,"Изм."
	TEXT2  2.3,23.9,"Лист"
	TEXT2  8.5,23.9,"Содержание изменения"
	TEXT2  14.3,23.9,"Код"
	TEXT2  16.9,23.9,"Примечание"
	TEXT2  1.5,26.7,"Разрешение"
	TEXT2  5.3,26.7,"Обозначение"
	TEXT2  5.3,25.4,"Наименование объекта"
	TEXT2  5.3,25.0,"строительства"

	SET STYLE "текст20-4"
	PEN  pen_text
	TEXT2  0.1,1.7,"Изм. внес"
	TEXT2  0.1,1.2,"Составил"
	TEXT2  0.1,0.7,"ГИП"
	TEXT2  0.1,0.2,"Утв."

!	SET STYLE "текст20-5"
!	TEXT2  14.25, 1.75, current_phase
!	TEXT2  15.75,1.75,sheet_id
	SET STYLE "текст50-5"
	TEXT2  11.5,27.9,"Разрешение на внесение изменений"
	TEXT2  13.0,26.6,shifr
!	SET STYLE "текст25-5"

!	gosub "position"
RETURN


"table_type_9":
	ADD2 hsh-19.0, 0.5
	pen pen_small
	LINE2  0.0, 1.0, 6.5, 1.0
	LINE2  17.5, 1, 18.5, 1
	PEN pen_osn
	LINE2  0, 0, 0, 1.5
	LINE2  0, 1.5 ,18.5,1.5
	LINE2  17.5, 0, 17.5, 1.5
	LINE2  0.85, 0, 0.85, 1.5
	LINE2  1.7, 0, 1.7, 1.5
	LINE2  2.85, 0, 2.85, 1.5
	LINE2  4.0, 0, 4.0, 1.5
	LINE2  5.5, 0, 5.5, 1.5
	LINE2  6.5, 0, 6.5, 1.5
	LINE2  0.0, 0.5, 6.5, 0.5

	SET STYLE "текст20-5"
	PEN pen_text
	TEXT2  18,1.25,"Лист"
	SET STYLE "текст25-5"
	TEXT2  18,0.5,sheet_id
	IF is_position = 1 THEN
			if tis_position and not(_bERROR) and diff_type_tabe=0 then 
				TEXT2 12,1.1,"<NOTES>" + ". Арх. " + position_info[1][2] + ". <SUBSETID>"	
			endif	
		ELSE
		TEXT2  12.1,0.7,shifr
	ENDIF
	SET STYLE "текст18-5"
	TEXT2  0.45, 0.25, "Изм."
	TEXT2  1.30, 0.25, "Кол.уч."
	TEXT2  2.3, 0.25, "Лист"
	TEXT2  3.4, 0.25, "№ док."
	TEXT2  4.8, 0.25, "Подп."
	TEXT2  6.0, 0.25, "Дата"
	TEXT2  16.5, -0.3, "Формат " + format
	FOR y = 0 TO 1.5 STEP 0.5
		HOTSPOT2 0.0, y
		HOTSPOT2 0.85, y
		HOTSPOT2 1.7, y
		HOTSPOT2 2.85, y
		HOTSPOT2 4.0, y
		HOTSPOT2 5.5, y
		HOTSPOT2 6.5, y
	NEXT y
	HOTSPOT2 18.5, 1
	HOTSPOT2 18.5, 1.5
	HOTSPOT2 17.5, 0
	HOTSPOT2 17.5, 1
	HOTSPOT2 17.5, 1.5
RETURN

"table_type_98":
	HOTSPOT2 0 , 0
	HOTSPOT2 hsh, lsh
	HOTSPOT2 hsh, 0
	HOTSPOT2 0, lsh
if tis_position and not(_bERROR) then 
	! Подписи
	if vardim1(change_info) > 0 THEN
		SET STYLE "текст20-5"
		TEXT2 2.8,18.2, change_info[vardim1(change_info)][3]
		TEXT2 4.2,18.45, "Изм.    ."
		TEXT2 4.55,18.45, change_info[vardim1(change_info)][1]
		ADD2	6, 7.8
		surname = change_info[vardim1(change_info)][4] : gosub "signature"
		ADD2	0.3, -1.1
		surname = change_info[vardim1(change_info)][4] : gosub "signature"
	ELSE
		SET STYLE "текст20-5"
		TEXT2 2.8,18.2, "1"
		ADD2	6, 7.8
		surname = position_info[1][2] : gosub "signature"
		ADD2	0.3, -1.1
		surname = position_info[1][2] : gosub "signature"		
	ENDIF
	ADD2	0.5, -1.0
	surname = position_info[6][2] : gosub "signature"
endif

RETURN




"table_type_10":
	pen SYMB_VIEW_PEN
	ADD2 hsh-19, 0.5
	hotspot2 13.5, 1.5
	hotspot2 0, 0
	hotspot2 0, 1.5+(tn_change-2)*0.5*(tn_change>2)
	hotspot2 0, 1.5
	hotspot2 18.5,1.5
	hotspot2 1.7, 0
	hotspot2 1.7, 1.5+(tn_change-2)*0.5*(tn_change>2)
	hotspot2 4, 0
	hotspot2 4, 1.5+(tn_change-2)*0.5*(tn_change>2)
	hotspot2 5.5, 0
	hotspot2 5.5, 1.5+(tn_change-2)*0.5*(tn_change>2)
	hotspot2 6.5, 0
	hotspot2 6.5, 1.5+(tn_change-2)*0.5*(tn_change>2)
	hotspot2 6.5, 1.5
	hotspot2 18.5, 1.5


	pen pen_osn
	LINE2  0, 0, 0, 1.5+(tn_change-2)*0.5*(tn_change>2)
	LINE2  6.5, 1.5 ,18.5,1.5
	LINE2  1.7, 0, 1.7, 1.5+(tn_change-2)*0.5*(tn_change>2)
	LINE2  4, 0, 4, 1.5+(tn_change-2)*0.5*(tn_change>2)
	LINE2  5.5, 0, 5.5, 1.5+(tn_change-2)*0.5*(tn_change>2)
	LINE2  6.5, 0, 6.5, 1.5+(tn_change-2)*0.5*(tn_change>2)
	LINE2  17.5, 0 ,17.5,1.5
	LINE2  17.5, 1 ,18.5,1

	SET STYLE "текст20-5"
	PEN pen_text
	TEXT2  18,1.25,"Лист"
	SET STYLE "текст25-5"
	TEXT2  18,0.5,sheet_id
	SET STYLE "текст50-5"
	TEXT2  12,0.75,shifr
	SET STYLE "текст25-5"
	upper_bound = 1.5
	start_change = 0
	gosub "position"
RETURN

"dop_graph":
	pen pen_osn
	LINE2  0.8, 0.5, 0.8, 9
	LINE2  1.3, 0.5, 1.3, 9
	LINE2  0.8, 0.5, 2, .5
	LINE2  0.8, 3, 2, 3
	LINE2  0.8, 6.5, 2, 6.5
	LINE2  0.8, 9, 2, 9
	SET STYLE "текст20-5"
	PEN pen_text
	ADD2 1.05, 1.5
	ROT2 90
	TEXT2  0, 0, " Инв. N подл."
	TEXT2  3,0," Подпись и дата"
	TEXT2  6,0,"   Взамен инв. N"

	DEL  2
return

"agreed":
	rot2 90
	add2 9,-2
	ngragr=1
	if tis_position and not(_bERROR) then ngragr =  max(1,round_int((vardim1(agreed_info)-2)/3)+2)
	pen pen_small
	line2 0,0.5,ngragr*6.5,0.5
	line2 6.5,1,ngragr*6.5,1
	pen pen_osn
	line2 6.5,1,0,1
	line2 0,1.5,ngragr*6.5,1.5
	line2 0,0,ngragr*6.5,0
	line2 0,0,0,1.5
	line2 2,0,2,1
	line2 4,0,4,1
	line2 5.5,0,5.5,1
	line2 6.5,0,6.5,1.5
	if ngragr>1 then
		for i=1 to ngragr-1
			line2 2+i*6.5,0,2+i*6.5,1.5
			line2 4+i*6.5,0,4+i*6.5,1.5
			line2 5.5+i*6.5,0,5.5+i*6.5,1.5
			line2 6.5+i*6.5,0,6.5+i*6.5,1.5
		next i
	endif
	SET STYLE "текст20-4"
	PEN pen_text
	text2 0.05,1.20,"Согласовано"
	if tis_position and not(_bERROR) then
	nfam = 0
	x = 0.75
	y = 0
	for i=1 to vardim1(agreed_info)
		if i=2 then nfam = 3
		if nfam>3 then
			nfam = 1
			y = y + 6.5
			x = 1.25
		endif
		if vartype(agreed_info[i][2]) = 2 then 
			if strlen(agreed_info[i][2])>2 then
				SET STYLE "текст18-4"
				PEN pen_text
				TEXT2  0.05+y, x, agreed_info[i][1]
				if tis_fam then TEXT2  2.05+y, x, agreed_info[i][2]
				if end_date then agreed_info[i][3] = tend_date
				if tis_date then TEXT2  5.55+y, x, agreed_info[i][3]
				add2 4.0+y, x-0.25
				surname = agreed_info[i][2] : gosub "signature"
				del 1
			endif
		endif
		nfam = nfam + 1
		x = x - 0.5
	next i
	endif
	del 2
return

"out_boundary":
	RECT2 0, 0, hsh, lsh
	HOTSPOT2 0 , 0
	HOTSPOT2 hsh, lsh
	HOTSPOT2 hsh, 0
	HOTSPOT2 0, lsh
	hotline2 0 , 0, hsh, 0
	hotline2 hsh, 0, hsh, lsh
	hotline2 hsh, lsh, 0, lsh
	hotline2 0, lsh, 0, 0
return

"inner_boundary":
	pen pen_osn
	RECT2 2 , 0.5, hsh-.5, lsh-.5
	HOTSPOT2 2 , lsh-.5
	HOTSPOT2 hsh-.5, lsh-.5
	HOTSPOT2 2 , 0.5
	HOTSPOT2 hsh-.5, 0.5
	HOTline2 2 , lsh-.5, hsh-.5, lsh-.5
	HOTline2 hsh-.5, lsh-.5,hsh-.5 , 0.5
	HOTline2 2 , 0.5,hsh-.5, 0.5
	HOTline2 2 , 0.5,2 , lsh-.5
	if is_num then 
		add2 hsh-.5-0.2, lsh-.5-0.2
		MUL2   1/L,1/L
		call "Сквозная нумерация листов" PARAMETERS ALL
		del 2
	endif
	PEN pen_text
	SET STYLE "текст25-3"
	if format<>"ПРОИЗВОЛЬНЫЙ" then
		TEXT2  hsh-.5, .4, "Формат " + format
	else
		TEXT2  hsh-.5, .4, "Формат " + name_custom
	endif
return

"position":
	IF type_table < 3 or type_table = 10 then
		HOTSPOT2 0, upper_bound+(tn_change-4)*0.5*(tn_change>4)
		HOTSPOT2 18.5, upper_bound+(tn_change-4)*0.5*(tn_change>4)
		HOTSPOT2 0, 0
		HOTSPOT2 18.5, 0
		hotspot2 0.85, start_change
		hotspot2 0.85, upper_bound+(tn_change-4)*0.5*(tn_change>4)
		hotspot2 2.85, start_change
		hotspot2 2.85, upper_bound+(tn_change-4)*0.5*(tn_change>4)
		pen pen_small
		if type_table < 3 then
			max_change = 3
			max_change_2 = 4
		else
			max_change = 2
			max_change_2 = 2
		endif
		for x = 0.5 to upper_bound+(tn_change-max_change)*0.5*(tn_change>=max_change) - 0.5 step 0.5
			LINE2  0, x, 6.5, x
			hotspot2 0, x
			hotspot2 6.5, x
		next x
		pen pen_osn
		LINE2  0.85, start_change, 0.85, upper_bound+(tn_change-max_change_2)*0.5*(tn_change>max_change_2)
		LINE2  2.85, start_change, 2.85, upper_bound+(tn_change-max_change_2)*0.5*(tn_change>max_change_2)
		pen pen_osn
		LINE2  6.5, upper_bound+(tn_change-max_change_2)*0.5*(tn_change>max_change_2), 0, upper_bound+(tn_change-max_change_2)*0.5*(tn_change>max_change_2)
		PEN pen_text
		SET STYLE "текст18-5"
		TEXT2  0.45, start_change + 0.25, "Изм."
		TEXT2  1.30, start_change + 0.25, "Кол.уч."
		TEXT2  2.3, start_change + 0.25, "Лист"
		TEXT2  3.4, start_change + 0.25, "№ док."
		TEXT2  4.8, start_change + 0.25, "Подп."
		TEXT2  6.0, start_change + 0.25, "Дата"
		if _bERROR then
			LINE2  0, 0, 18.5, upper_bound
			LINE2 18.5, 0, 0, upper_bound
		endif
		if not(_bfirstchange) and tis_position then
			SET STYLE "текст18-5"
			i = 0
			for x = start_change + 0.75 to upper_bound+(tn_change-max_change_2)*0.5*(tn_change>max_change_2) step 0.5
				i = i + 1
				if i <= tn_change then
					if vartype(change_info[i][2]) = 2 then 
						if strlen(change_info[i][2])>-1 then
							TEXT2  0.45, x, change_info[i][1]
							TEXT2  1.3, x, change_info[i][6]
							TEXT2  2.3, x, change_info[i][2]
							TEXT2  3.4, x, change_info[i][3]
							add2 4.1, x-0.25
							surname = change_info[i][4] : gosub "signature"
							del 1
							if tis_date then TEXT2  6.0, x, change_info[i][5]
						endif
					endif
				endif
			next x
		endif
	endif
	if tis_position and not(_bERROR) then 
		SET STYLE "текст18-4"
		i = 0
		for x = 2.75 to 0.25 step -0.5
			i = i + 1
			if i <= vardim1(position_info) then
				if vartype(position_info[i][2]) = 2 then 
					if strlen(position_info[i][2])>2 then
						PEN pen_text
						TEXT2  0.1, x, position_info[i][1]
						if tis_fam then TEXT2  1.8, x, position_info[i][2]
						SET STYLE "текст18-5"
						if end_date then position_info[i][3] = tend_date
						if tis_date then TEXT2  6, x, position_info[i][3]
						SET STYLE "текст18-4"
						add2 4.0, x-0.3
						surname = position_info[i][2] : gosub "signature"
						del 1
					endif
				endif
			endif
		next x
	endif
return

"signature":
	if tis_autosign then
		PEN pen_podp
		CALL "Подпись" parameters surname = surname, pen_podp=pen_podp
		PEN pen_text
	endif
return
]]>
</Script_2D>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_VL SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[
values{2} "sort" isorttype, tsorttype
values{2} "type_sort_issue" itype_sort_issue, ttype_sort_issue
values{2} "type_table" itype_form, ttype_form

values{2} "type_table_first" itype_form, ttype_form
values{2} "type_table_next" itype_form, ttype_form

values "norm_position" range [1,6]

values{2} "r205type" irtype, trtype
values{2} "r505type" irtype, trtype
values{2} "r184type" irtype, trtype
values{2} "r255type" irtype, trtype
values{2} "rtype" irtype, trtype

IF type_table = 99 THEN 
	parameters format = "A4"
	parameters is_gor = 0
	LOCK "format", "is_gor"
else
	values "format" size_inx
endif

isize = vardim1(size_inx)
for i = 1 to vardim1(size_inx)
	if format = size_inx[i] then iformat = i
next i
parameters iformat = iformat
parameters size = size

if is_gor then
	hsh = size[iformat][2]
	lsh = size[iformat][1]
else
	hsh = size[iformat][1]
	lsh = size[iformat][2]
endif
parameters hsh = hsh, lsh = lsh

if is_autotext then
	parameters sheet_id = "<LAYOUTID>"
endif

IF type_table <> 10 THEN HIDEPARAMETER "iscont"
if not(is_num) then HIDEPARAMETER "is_ram"
]]>
</Script_VL>

<ParamSection SectVersion="27" SectionFlags="0" SubIdent="0">
	<ParamSectHeader>
		<AutoHotspots>true</AutoHotspots>
		<WDLeftFrame>0</WDLeftFrame>
		<WDRightFrame>0</WDRightFrame>
		<WDTopFrame>0</WDTopFrame>
		<WDBotFrame>0</WDBotFrame>
		<LayFlags>65535</LayFlags>
		<WDMirrorThickness>0</WDMirrorThickness>
		<WDWallInset>0</WDWallInset>
	</ParamSectHeader>
	<Parameters>
		<Length Name="A">
			<Description><![CDATA[""]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>84.1</Value>
		</Length>
		<Length Name="B">
			<Description><![CDATA[""]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>59.4</Value>
		</Length>
		<String Name="format">
			<Description><![CDATA["Формат (A0...A4, произвольн.)"]]></Description>
			<Value><![CDATA["A1"]]></Value>
		</String>
		<Integer Name="aaa">
			<Description><![CDATA["Длина произвольного листа"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>600</Value>
		</Integer>
		<Integer Name="bbb">
			<Description><![CDATA["Ширина произвольного листа"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>300</Value>
		</Integer>
		<String Name="name_custom">
			<Description><![CDATA["Имя произвольного формата"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA["А"]]></Value>
		</String>
		<Boolean Name="is_gor">
			<Description><![CDATA["Горизонтально (да, нет)"]]></Description>
			<Value>1</Value>
		</Boolean>
		<Integer Name="type_table">
			<Description><![CDATA["Форма штампа (1, 2, 3, 4, 0-нет)"]]></Description>
			<Value>1</Value>
		</Integer>
		<Boolean Name="diff_type_table">
			<Description><![CDATA["Различные форма для первого и последующих листов"]]></Description>
			<Value>0</Value>
		</Boolean>
		<Integer Name="type_table_first">
			<Description><![CDATA["Форма штампа первой страницы"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Integer>
		<Integer Name="type_table_next">
			<Description><![CDATA["Форма штампа последующих"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Integer>
		<Boolean Name="iscont">
			<Description><![CDATA["Штамп для второй страницы"]]></Description>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="end_date">
			<Description><![CDATA["Брать дату из последнего изменения"]]></Description>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="is_autotext">
			<Description><![CDATA["Стадия из изм. 0"]]></Description>
			<Value>1</Value>
		</Boolean>
		<String Name="phase">
			<Description><![CDATA["Стадия"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="sheet_id">
			<Description><![CDATA["Лист"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA["<LAYOUTID>"]]></Value>
		</String>
		<String Name="shifrt">
			<Description><![CDATA["Шифр"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA["<autotext-23AE59EE-4139-444B-BABD-A51D9B39C8EE>"]]></Value>
		</String>
		<String Name="naen_obj">
			<Description><![CDATA["Наименование объекта"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value><![CDATA["<autotext-E1750E61-4FD4-46FF-9770-86BDE811A621>"]]></Value>
		</String>
		<String Name="naen_zd">
			<Description><![CDATA["Наименование здания"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value><![CDATA["<autotext-83C9C111-32B3-4721-AD06-822CE1270958>"]]></Value>
		</String>
		<String Name="naen_sheet">
			<Description><![CDATA["Название листа"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value><![CDATA["<LAYOUTNAME>"]]></Value>
		</String>
		<String Name="delim_part">
			<Description><![CDATA["Разделитель шифра и раздела"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA["-"]]></Value>
		</String>

		<!-- _sp0_B: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="_sp0_B">
			<Description><![CDATA["Внешний вид"]]></Description>
		</Title>
		<Integer Name="type_sort_issue">
			<Description><![CDATA["Сортировка изменений"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Integer>
		<Integer Name="sort">
			<Description><![CDATA["Порядок чтения данных"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>2</Value>
		</Integer>
		<Boolean Name="is_autosign">
			<Description><![CDATA["Автоподпись"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Boolean>
		<Boolean Name="is_position">
			<Description><![CDATA["Должности (да, нет)"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Boolean>
		<Boolean Name="is_dop_graph">
			<Description><![CDATA["Доп.графы (да, нет)"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Boolean>
		<Boolean Name="is_agreed">
			<Description><![CDATA["Согласовано (да, нет)"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Boolean>
		<Boolean Name="is_boundary">
			<Description><![CDATA["Граница листа (да, нет)"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Boolean>
		<Boolean Name="is_num">
			<Description><![CDATA["Сквозная нумерация"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Boolean>
		<Boolean Name="is_ram">
			<Description><![CDATA["В рамке"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<RealNum Name="size">
			<Description><![CDATA["Таблица размеров"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<ArrayValues FirstDimension="13" SecondDimension="2">
				<AVal Column="1" Row="1">84.1</AVal>
				<AVal Column="2" Row="1">118.9</AVal>
				<AVal Column="1" Row="2">59.4</AVal>
				<AVal Column="2" Row="2">84.1</AVal>
				<AVal Column="1" Row="3">42</AVal>
				<AVal Column="2" Row="3">59.4</AVal>
				<AVal Column="1" Row="4">29.7</AVal>
				<AVal Column="2" Row="4">42</AVal>
				<AVal Column="1" Row="5">21</AVal>
				<AVal Column="2" Row="5">29.7</AVal>
				<AVal Column="1" Row="6">60</AVal>
				<AVal Column="2" Row="6">30</AVal>
				<AVal Column="1" Row="7">42</AVal>
				<AVal Column="2" Row="7">89.1</AVal>
				<AVal Column="1" Row="8">42</AVal>
				<AVal Column="2" Row="8">118.9</AVal>
				<AVal Column="1" Row="9">42</AVal>
				<AVal Column="2" Row="9">148.6</AVal>
				<AVal Column="1" Row="10">29.7</AVal>
				<AVal Column="2" Row="10">63</AVal>
				<AVal Column="1" Row="11">29.7</AVal>
				<AVal Column="2" Row="11">84.1</AVal>
				<AVal Column="1" Row="12">29.7</AVal>
				<AVal Column="2" Row="12">105.1</AVal>
				<AVal Column="1" Row="13">29.7</AVal>
				<AVal Column="2" Row="13">126.1</AVal>
			</ArrayValues>
		</RealNum>
		<Boolean Name="debug">
			<Description><![CDATA["Отладка"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<String Name="fontType">
			<Description><![CDATA["Шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA["ISOCPEUR"]]></Value>
		</String>
		<RealNum Name="r205">
			<Description><![CDATA["Размер шрифта доп. графы"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>2.6</Value>
		</RealNum>
		<Integer Name="r205type">
			<Description><![CDATA["Тип шрифта доп. графы"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Integer>
		<RealNum Name="r505">
			<Description><![CDATA["Размер шрифта шифра"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>5</Value>
		</RealNum>
		<Integer Name="r505type">
			<Description><![CDATA["Тип шрифта шифра"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Integer>
		<RealNum Name="r184">
			<Description><![CDATA["Размер шрифта фамилий"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>2.2</Value>
		</RealNum>
		<Integer Name="r184type">
			<Description><![CDATA["Тип шрифта фамилий"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Integer>
		<RealNum Name="r255">
			<Description><![CDATA["Размер шрифта листов и стадий"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>4.5</Value>
		</RealNum>
		<Integer Name="r255type">
			<Description><![CDATA["Тип шрифта листов и стадий"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Integer>
		<Integer Name="rtype">
			<Description><![CDATA["Тип шрифта остальных граф"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Integer>

		<!-- _sp0_A: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="_sp0_A">
			<Description><![CDATA["Перья"]]></Description>
		</Title>
		<PenColor Name="pen_small">
			<Description><![CDATA["Перо тонких линий"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</PenColor>
		<PenColor Name="pen_osn">
			<Description><![CDATA["Перо основных линий"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>20</Value>
		</PenColor>
		<PenColor Name="pen_podp">
			<Description><![CDATA["Перо подписей"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>6</Value>
		</PenColor>
		<PenColor Name="pen_text">
			<Description><![CDATA["Перо текста"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</PenColor>
		<PenColor Name="pen_error">
			<Description><![CDATA["Перо ошибок"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>20</Value>
		</PenColor>
		<Integer Name="iformat">
			<Description><![CDATA[""]]></Description>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>2</Value>
		</Integer>
		<Length Name="hsh">
			<Description><![CDATA[""]]></Description>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>84.1</Value>
		</Length>
		<Length Name="lsh">
			<Description><![CDATA[""]]></Description>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>59.4</Value>
		</Length>
	</Parameters>
</ParamSection>

<Picture MIME="image/png" SectVersion="19" SectionFlags="0" SubIdent="0" length_in_bytes="277" platform="Win">
	<![CDATA[
	696D6167652F706E670089504E470D0A1A0A0000000D494844520000007E0000
	00650203000000F65CBF4300000009504C5445FFFFFF000000FF0000C0C99DB0
	000000BD49444154785EED96310EC2300C4593A8EC1EE80D60E1141D7A800E98
	81D370049630B374C0A704B56A5D250D56142912257F7E7ADFFA59A27E2A2535
	0633021014E809100D4DC0B0CB0C14A04601D8B722905EB105E0282D79683701
	647AEE02C84B422701F7FF006CA28197D4E8C63168050A74B55EC186B303E435
	188B4E622BCC4DAAA0D72CBFD0F5415F876AA09A0DC806BE6179642719F8867E
	30F84084216228FAA4F70CF4E48A13AD0EC547865FD3076CC24F4CFCCB654CC9
	1B1E9787DDC05ADF6A0000000049454E44AE426082
	]]>
</Picture>

<Ancestry SectVersion="1" SectionFlags="0" SubIdent="0" Template="false">
	<MainGUID>F938E33A-329D-4A36-BE3E-85E126820996</MainGUID>
	<MainGUID>B176ABF1-5813-478F-926B-28EE7C5DC1F7</MainGUID>
	<MainGUID>4FD10D67-2F29-4844-A65A-6597589B0CB5</MainGUID>
</Ancestry>

<CalledMacros SectVersion="2" SectionFlags="0" SubIdent="0">
	<Macro>
		<MName><![CDATA["Сквозная нумерация листов"]]></MName>
		<MainGUID>26256CA7-1A13-4C0A-9B67-0ABE8B66B346</MainGUID>
	</Macro>
	<Macro>
		<MName><![CDATA["Подпись"]]></MName>
		<MainGUID>37D5A2DA-1C7F-4C0B-BF58-60B4DB467A96</MainGUID>
	</Macro>
</CalledMacros>

<Copyright SectVersion="1" SectionFlags="0" SubIdent="0">
	<Author></Author>
	<License>
		<Type>CC0</Type>
		<Version>1.0</Version>
	</License>
</Copyright>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_3D SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_3D>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_1D SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[
dim ttype_form[]
dim itype_form[] : i=0
i=i+1 : itype_form[i]=0 : ttype_form[i] = "Только рамка"
i=i+1 : itype_form[i]=1 : ttype_form[i] = "1"
i=i+1 : itype_form[i]=2 : ttype_form[i] = "2"
i=i+1 : itype_form[i]=3 : ttype_form[i] = "3"
i=i+1 : itype_form[i]=4 : ttype_form[i] = "4"
i=i+1 : itype_form[i]=99 : ttype_form[i] = "Разрешение на изм (А4)"

i=i+1 : itype_form[i]=5 : ttype_form[i] = "Регистрация изм (титул)"
i=i+1 : itype_form[i]=6 : ttype_form[i] = "Дата изм. 0"
i=i+1 : itype_form[i]=7 : ttype_form[i] = "Шифр"
i=i+1 : itype_form[i]=8 : ttype_form[i] = "Стадия"
i=i+1 : itype_form[i]=9 : ttype_form[i] = "Название документации"
i=i+1 : itype_form[i]=10 : ttype_form[i] = "Текстовый документ"
i=i+1 : itype_form[i]=98 : ttype_form[i] = "Архив"
i=i+1 : itype_form[i]=97 : ttype_form[i] = "Эскиз"

dim size_inx[]
size_inx[1] = "A0"
size_inx[2] = "A1"
size_inx[3] = "A2"
size_inx[4] = "A3"
size_inx[5] = "A4"
size_inx[6] = "ПРОИЗВОЛЬНЫЙ"
size_inx[7] = "A3x3"
size_inx[8] = "A3x4"
size_inx[9] = "A3x5"
size_inx[10] = "A4x3"
size_inx[11] = "A4x4"
size_inx[12] = "A4x5"
size_inx[13] = "A4x6"

dim irtype[] : dim trtype[] : i=0
i=i+1 : trtype[i] = "Обычный" : irtype[i] = 0
i=i+1 : trtype[i] = "Полужирный" : irtype[i] = 1
i=i+1 : trtype[i] = "Курсив" : irtype[i] = 2
i=i+1 : trtype[i] = "Полужирный курсив" : irtype[i] = 3

dim isorttype[] : dim tsorttype[] : i=0
i=i+1 : tsorttype[i] = "Изменения->Макеты" : isorttype[i] = 0
i=i+1 : tsorttype[i] = "Макеты->Изменения" : isorttype[i] = 1
i=i+1 : tsorttype[i] = "Порядок из выпуска" : isorttype[i] = 2

dim itype_sort_issue[] : dim ttype_sort_issue[] : i=0
i=i+1 : ttype_sort_issue[i] = "Системный" : itype_sort_issue[i] = 0
i=i+1 : ttype_sort_issue[i] = "По возрастанию номера изменения" : itype_sort_issue[i] = 1
i=i+1 : ttype_sort_issue[i] = "По убыванию номера изменения" : itype_sort_issue[i] = 2

dim size[][]
i = 0
i = i + 1 : size[i][1] = 84.1 : size[i][2] = 118.9 !0
i = i + 1 : size[i][1] = 59.4 : size[i][2] = 84.1 !1
i = i + 1 : size[i][1] = 42 : size[i][2] = 59.4 !2
i = i + 1 : size[i][1] = 29.7 : size[i][2] = 42 !3
i = i + 1 : size[i][1] = 21 : size[i][2] = 29.7 !4
i = i + 1 : size[i][1] = aaa*0.1 : size[i][2] = bbb*0.1 !custom

i = i + 1 : size[i][1] = 42.0 : size[i][2] = 89.1 !7
i = i + 1 : size[i][1] = 42.0 : size[i][2] = 118.9 !8
i = i + 1 : size[i][1] = 42.0 : size[i][2] = 148.6 !9

i = i + 1 : size[i][1] = 29.7 : size[i][2] = 63.0 !10
i = i + 1 : size[i][1] = 29.7 : size[i][2] = 84.1 !11
i = i + 1 : size[i][1] = 29.7 : size[i][2] = 105.1 !12
i = i + 1 : size[i][1] = 29.7 : size[i][2] = 126.1 !13

dim error[ ]
dim position_info[ ][ ]
dim agreed_info[ ][ ]
dim change_info[ ][ ]
dim arr1[ ]
dim arr2[ ][ ]
!------------------------------------------------------------------------------------------------
! Check global existence
!------------------------------------------------------------------------------------------------
dim GlobIssueScheme[2][]
dim GlobchangeScheme[2][]
dim LayoutRevHistory[][]
dim LayoutchangeHistory[][]

_bEmptyGlobIssues = 0
_bEmptyGlobchanges = 0
_bEmptyLayoutRevHistory = 0
_bEmptyLayoutChHistory = 0
_bfirstchange = 0
_bEmptychange = 0
_bERROR = 0
n_izm = 0
n_err = 0

current_phase = " "
current_part = " "
current_date = " "
surname = " " 
delim = " "
weight = " "
subpos = " "
shifrt_l = " "
naen_dok = " "
tend_date = " "

if vardim2(GLOB_ISSUE_SCHEME) > 0 then
	! global exists
	GlobIssueScheme	= GLOB_ISSUE_SCHEME
else
	_bEmptyGlobIssues = 1
endif

if vardim2(GLOB_change_SCHEME) > 0 then
	! global exists
	GlobchangeScheme = GLOB_change_SCHEME
else
	_bEmptyGlobchanges = 1
endif

if GLOB_SCRIPT_TYPE = 2 then
	_bLayoutContext = (GLOB_CONTEXT = 8 | GLOB_CONTEXT = 28)
	if _bLayoutContext then
		! Layout context or Layout Editing feedback: use globals from Issue Manager
		LayoutRevHistory = LAYOUT_REVISION_HISTORY
		LayoutchangeHistory	= LAYOUT_change_HISTORY
		last_change_inx = vardim1(LayoutchangeHistory)
		last_rev_inx = vardim1(LayoutRevHistory)
		if vardim2(LayoutRevHistory) > 1 then
			if STRSTR(LayoutRevHistory[last_rev_inx][3], "Отсутствует в Выпуске") then 
				txt = "Макет добавлен в выпуск?"
				gosub "write_error"
			endif
		else
			txt = "Макет добавлен в выпуск?"
			gosub "write_error"
		endif
	else
		text2 0.05, 0.05,  "!! Работает только на макетах !!"
	endif
endif
if vardim2(LayoutRevHistory) <> vardim2(GlobIssueScheme) then
	! if global exists, must have same number of columns as GLOB_ISSUE_SCHEME
	_bEmptyLayoutRevHistory = 1
endif
if vardim2(LayoutchangeHistory) <> vardim2(GlobchangeScheme) then
	! if global exists, must have same number of columns as GLOB_change_SCHEME
	_bEmptyLayoutChHistory = 1
endif
if not(_bEmptyLayoutRevHistory) & _bEmptyLayoutChHistory then
	! if has revision data but no change attached, create 1 dummy empty change row
	for _ichangeCol = 1 to vardim2(GLOB_change_SCHEME)
		if _ichangeCol = 1 then
			LayoutchangeHistory[1][1] = LayoutRevHistory[1][1]
		else
			LayoutchangeHistory[1][_ichangeCol] = ""
		endif
	next _ichangeCol
endif

if not(_bEmptyLayoutRevHistory) then

	ROW_PHASE_PART = 2 !Стадия
	ROW_DATE = 8 !Дата изма
	ROW_IZM_N_DOC = 6 !Номер документа
	ROW_IZM_SUR = 7 !Фамилия изменяющего

	ROW_FAM_START_ISSUE = 0 !Начало штампа выпуска
	ROW_FAM_END_ISSUE = 0 !Конец штампа выпуска
	ROW_FAM_START_CHANGE = 0 !Начало штампа изменений
	ROW_FAM_END_CHANGE = 0 !Конец штампа изменений
	ROW_FAM_START_LAYUOT = 0 !Начало штампа макета
	ROW_FAM_END_LAYUOT = 0 !Конец штампа макета
	ROW_FAM_START_AGREED = 0 !Начало согласований
	ROW_FAM_END_AGREED = 0 !Конец согласований

	tis_position = is_position
	tis_autosign = is_autosign
	tis_fam = 1
	tis_date = 1

	for i = 1 to vardim2(GlobIssueScheme)
		if STRSTR(GlobIssueScheme[1][i], "!!НАЧАЛО ШТАМПА!!") then ROW_FAM_START_ISSUE = i+1
		if STRSTR(GlobIssueScheme[1][i], "!!КОНЕЦ ШТАМПА!!") then ROW_FAM_END_ISSUE = i-1
		if STRSTR(GlobIssueScheme[1][i], "!!СОГЛАСОВАНО!!") then ROW_FAM_START_AGREED = i+1
		if STRSTR(GlobIssueScheme[1][i], "!!КОНЕЦ СОГЛАСОВАНО!!") then ROW_FAM_END_AGREED = i-1
		if STRSTR(GlobIssueScheme[1][i], "Должности (ДА/НЕТ)")>0 then
			if STRSTR(LayoutRevHistory[1][i], "НЕТ", 1)>0 then tis_position = 0
		endif
		if STRSTR(GlobIssueScheme[1][i], "Подписи (ДА/НЕТ)")>0 then
			if STRSTR(LayoutRevHistory[1][i], "НЕТ", 1)>0 then tis_autosign = 0
		endif
		if STRSTR(GlobIssueScheme[1][i], "Фамилии (ДА/НЕТ)")>0 then
			if STRSTR(LayoutRevHistory[1][i], "НЕТ", 1)>0 then tis_fam = 0
		endif
		if STRSTR(GlobIssueScheme[1][i], "Дата (ДА/НЕТ)")>0 then
			if STRSTR(LayoutRevHistory[1][i], "НЕТ", 1)>0 then tis_date = 0
		endif
	next i
	!Изменения
	for i = 1 to vardim2(GlobchangeScheme)
		if STRSTR(GlobchangeScheme[1][i], "!!НАЧАЛО ИЗМ. 0!!") then ROW_FAM_START_CHANGE = i+2
		if STRSTR(GlobchangeScheme[1][i], "!!КОНЕЦ ИЗМ. 0!!") then ROW_FAM_END_CHANGE = i-1
		if STRSTR(GlobchangeScheme[1][i], "Должности (ДА/НЕТ)")>0 then
			if STRSTR(LayoutchangeHistory[1][i], "НЕТ", 1)>0 then tis_position = 0
		endif
		if STRSTR(GlobchangeScheme[1][i], "Подписи (ДА/НЕТ)")>0 then
			if STRSTR(LayoutchangeHistory[1][i], "НЕТ", 1)>0 then tis_autosign = 0
		endif
		if STRSTR(GlobchangeScheme[1][i], "Фамилии (ДА/НЕТ)")>0 then
			if STRSTR(LayoutchangeHistory[1][i], "НЕТ", 1)>0 then tis_fam = 0
		endif
		if STRSTR(GlobchangeScheme[1][i], "Дата (ДА/НЕТ)")>0 then
			if STRSTR(LayoutchangeHistory[1][i], "НЕТ", 1)>0 then tis_date = 0
		endif
	next i

	ROW_FAM_START_LAYUOT = ROW_FAM_END_CHANGE-2
	ROW_FAM_END_LAYUOT = ROW_FAM_START_AGREED-1

	ROW_DATE = ROW_FAM_START_CHANGE-3 !Дата изма
	ROW_IZM_SUR = ROW_FAM_START_CHANGE-4 !Фамилия изменяющего
	ROW_IZM_N_DOC = ROW_FAM_START_CHANGE-5 !Номер документа

	!---------------------- Поиск изм. 0 ------------------------	
	zero_change_inx = 0 : flag = 0
	for i = 1 to last_change_inx
		if STRSTR(LayoutchangeHistory[i][ROW_PHASE_PART], "Изм 0") then
			zero_change_inx = i
			if flag = 1 then
				txt = "У макета должен быть только один Изм 0."
				gosub "write_error"
			else
				flag = 1
			endif
		endif
	next i
	!------------------------------------------------------------
	if zero_change_inx then
		phase_part = LayoutchangeHistory[zero_change_inx][ROW_PHASE_PART]
		current_phase = "" : current_part = "" : current_type = "" : current_nizm = 0	
		phase_part_tmp = phase_part
		pos = STRSTR (phase_part_tmp, " ")-1
		current_phase = STRSUB(phase_part_tmp,1,pos)
		phase_part_tmp = STRSUB(phase_part_tmp,pos+2,STRLEN(phase_part_tmp))
		pos = STRSTR (phase_part_tmp, " ")-1
		current_part = STRSUB(phase_part_tmp,1,pos)
		phase_part_tmp = STRSUB(phase_part_tmp,pos+2,STRLEN(phase_part_tmp))
		pos = STRSTR (phase_part_tmp, " ")-1
		current_type = STRSUB(phase_part_tmp,1,pos)
		phase_part_tmp = STRSUB(phase_part_tmp,pos+2,STRLEN(phase_part_tmp))
		current_nizm = phase_part_tmp
		if current_phase = "" or current_part = "" or current_type = "" then 
			txt = "Проверьте название -" + phase_part
			gosub "write_error"
		else
			if current_type<>"Изм" and current_type<>"Зам" and current_type<>"Нов" then
				txt = "Может быть только Изм/Зам/Нов" + phase_part
				gosub "write_error"
			endif
		endif
		if strlen(current_phase)>3 then
			txt = "Слишком длинное название стадии."
			gosub "write_error"
		endif
		current_date = LayoutchangeHistory[zero_change_inx][ROW_DATE]
	else
		txt = "Добавьте Изм 0"
		gosub "write_error"
	endif
	if zero_change_inx>0 then
		!----- Переписываем должности, фамилии, даты в штамп --------
		!ГИПа, РукОтдела и Нормоконтроля берём из нулевого изма (LayoutchangeHistory)
		!При этом отдельно выделяем последнюю позицию - её положение настраивается в штампе
		n_position = 0
		if sort=1 then
			gosub "from_layout"
			gosub "from_change"
			gosub "from_issue"
		endif
		if sort=0 then
			gosub "from_change"
			gosub "from_layout"
			gosub "from_issue"
		endif
		if sort=2 then
			n_position = 0
			flag = 0
			for i = ROW_FAM_START_ISSUE to ROW_FAM_END_ISSUE
				n_position = n_position + 1
				position_info[n_position][1] = GlobIssueScheme[1][i]
				position_info[n_position][2] = ""
				position_info[n_position][3] = ""
			next i
			for i = ROW_FAM_START_ISSUE to ROW_FAM_END_ISSUE
				if STRLEN(LayoutRevHistory[last_rev_inx][i])>1 then
					for j=1 to n_position
						if position_info[j][1] = GlobIssueScheme[1][i] then
							position_info[j][2] = LayoutRevHistory[last_rev_inx][i]
							position_info[j][3] = current_date
						endif
					next j
				endif
			next i
			for i = ROW_FAM_START_CHANGE to ROW_FAM_END_CHANGE
				if STRLEN(LayoutchangeHistory[zero_change_inx][i])>1 then  !Если указана фамилия - записываем
					for j=1 to n_position
						if position_info[j][1] = GlobchangeScheme[1][i] then
							position_info[j][2] = LayoutchangeHistory[zero_change_inx][i]
							position_info[j][3] = current_date
						endif
					next j
				endif
			next i
			for i = ROW_FAM_START_LAYUOT to ROW_FAM_END_LAYUOT
				if STRLEN(LayoutRevHistory[last_rev_inx][i])>1 then
					for j=1 to n_position
						if position_info[j][1] = GlobIssueScheme[1][i] then
							position_info[j][2] = LayoutRevHistory[last_rev_inx][i]
							position_info[j][3] = current_date
						endif
					next j
				endif
			next i
		endif
		!------------------------------------------------------------
		!-------- Заполнение граф согласований -------------------------
		n_position_agreed = 0
		for i = ROW_FAM_START_AGREED to ROW_FAM_END_AGREED
			if STRLEN(LayoutRevHistory[last_rev_inx][i])>1 then !Если указана фамилия - записываем
				n_position_agreed = n_position_agreed + 1
				agreed_info[n_position_agreed][1] = GlobIssueScheme[1][i]
				agreed_info[n_position_agreed][2] = LayoutRevHistory[last_rev_inx][i]
				agreed_info[n_position_agreed][3] = current_date
			endif
		next i
		!------------------------------------------------------------
		!---------------------- Для КЖИ -----------------------------
		for i = ROW_FAM_END_AGREED to vardim2(GlobIssueScheme)
			if STRSTR(GlobIssueScheme[1][i], "Масса")>0 then weight = LayoutRevHistory[last_rev_inx][i]
			if STRSTR(GlobIssueScheme[1][i], "Имя сборки")>0 then subpos = LayoutRevHistory[last_rev_inx][i]
			if STRSTR(GlobIssueScheme[1][i], "Шифр")>0 then shifrt_l = LayoutRevHistory[last_rev_inx][i]
		next i
		if vartype(weight)=1 then weight = STR("%.2",weight)
		if vartype(subpos)=1 then subpos = STR("%.0",subpos)
		if vartype(shifrt_l)=1 then shifrt_l = STR("%.0",shifrt_l)
		!------------------------------------------------------------
		!-------- Заполнение граф изменений -------------------------
		start = 8
		for i = 1 to last_change_inx
			not_zero = (STRSTR(LayoutchangeHistory[i][ROW_PHASE_PART], "Изм 0") = 0)
			comp_phase = (STRSTR(LayoutchangeHistory[i][ROW_PHASE_PART], current_phase) > 0)
			comp_part = (STRSTR(LayoutchangeHistory[i][ROW_PHASE_PART], current_part) > 0)
			not_sys = (STRSTR(LayoutchangeHistory[i][ROW_PHASE_PART], "!") = 0)
			if not_zero and comp_phase and comp_part and not_sys then
				phase_part = LayoutchangeHistory[i][ROW_PHASE_PART]
				t_phase = "" : t_part = "" : t_type = "" : t_nizm = ""
				phase_part_tmp = phase_part
				pos = STRSTR (phase_part_tmp, " ")-1
				t_phase = STRSUB(phase_part_tmp,1,pos)
				phase_part_tmp = STRSUB(phase_part_tmp,pos+2,STRLEN(phase_part_tmp))
				pos = STRSTR (phase_part_tmp, " ")-1
				t_part = STRSUB(phase_part_tmp,1,pos)
				phase_part_tmp = STRSUB(phase_part_tmp,pos+2,STRLEN(phase_part_tmp))
				pos = STRSTR (phase_part_tmp, " ")-1
				t_type = STRSUB(phase_part_tmp,1,pos)
				phase_part_tmp = STRSUB(phase_part_tmp,pos+2,STRLEN(phase_part_tmp))
				t_nizm = phase_part_tmp
				if t_phase = "" or t_part = "" or t_type = "" or t_nizm = "" then 
					txt = "Проверьте название -" + phase_part
					gosub "write_error"
				else
					if t_type<>"Изм" and t_type<>"Зам" and t_type<>"Нов" then
						txt = "Может быть только Изм/Зам/Нов" + phase_part
						gosub "write_error"
					endif
				endif
				if n_err=0 then
					n_izm = n_izm + 1
					change_info[n_izm][1] = t_nizm
					change_info[n_izm][2] = t_type
					change_info[n_izm][3] = LayoutchangeHistory[i][ROW_IZM_N_DOC]
					change_info[n_izm][4] = LayoutchangeHistory[i][ROW_IZM_SUR]
					change_info[n_izm][5] = LayoutchangeHistory[i][ROW_DATE]
					tend_date = LayoutchangeHistory[i][ROW_DATE]
					if STRSTR(t_type, "Зам") or STRSTR(t_type, "Нов") then 
						change_info[n_izm][6] = "-"
					else
						change_info[n_izm][6] = " "
					endif
					if STRSTR(t_type, "Изм") then change_info[n_izm][2] = "-"
				endif
			endif
			if (not(comp_phase) or not(comp_part)) and not_zero and not_sys then
				txt = "У всех изменений макеты должны совпадать стадии и разделы"
				gosub "write_error"
			endif
		next i
		if not(n_izm) then 
			_bfirstchange = 1
		else
		! -- Поиск совпадающий измов
			for i = 1 to vardim1(change_info)
				for j = 1 to vardim1(change_info)
					if j<>i and	change_info[i][1] = change_info[j][1] then
						txt = "Сопадающие номера изменений - " + change_info[j][1] + " " + change_info[j][2]
						gosub "write_error"
					endif
				next j
			next i
		endif
		!------------------------------------------------------------
		if debug then
			add2 0.1,0
			arr2 = GlobIssueScheme : gosub "pr_2arr"
			add2 0.1,0
			arr2 = LayoutRevHistory : gosub "pr_2arr"
			add2 0.1,0
			arr2 = GlobchangeScheme : gosub "pr_2arr"
			add2 0.1,0
			arr2 = LayoutchangeHistory : gosub "pr_2arr"
		endif
	endif
else
	txt = "Добавьте Изм 0"
	gosub "write_error"
endif
del top

!-------------- Сортировка массива с изменениями ---------------
if (type_sort_issue=1 or type_sort_issue=2) and n_err=0 then !По номеру изма.
	n_col = 1
	dim sort_arr[]
	for i=1 to n_izm
		var = change_info[i][n_col]
		if vartype(var)=2 then
			rez = SPLIT(var,"%n",var_num)
			var = var_num
		endif
		if vartype(var)=1 then
			sort_arr[i] = var
		else
			sort_arr[i] = 0
			txt = "Номер изменения должно быть числом -" + var
			gosub "write_error"
		endif
	next i
	for j=1 to n_izm
		flag_end=1
		for i=1 TO n_izm-j
			flag_swap = 0
			if type_sort_issue=1 then flag_swap = (sort_arr[i]<sort_arr[i+1])
			if type_sort_issue=2 then flag_swap = (sort_arr[i]>sort_arr[i+1])
			if flag_swap then
				kk = sort_arr[i]
				sort_arr[i] = sort_arr[i+1]
				sort_arr[i+1] = kk
				flag_end=0
			endif
		next i
		if flag_end then j=n_izm
	next j
	dim sort_arr_t[][]
	for j=1 to n_izm
		izm = sort_arr[j]
		for i=1 to n_izm
			var = change_info[i][n_col]
			if vartype(var)=2 then
				rez = SPLIT(var,"%n",var_num)
				var = var_num
			endif
			if vartype(var)=1 then
				if var = izm then
					for k=1 to vardim2(change_info)
						sort_arr_t[j][k] = change_info[i][k]
					next k
					i=n_izm
				endif
			endif
		next i
	next j
	change_info = sort_arr_t
endif
!-------------- Сортировка массива с изменениями ---------------
arr1 = error : gosub "pr_1arr"

if n_err > 0 then _bERROR = 1


goto 20
"pr_2arr":
	k=0
	for i = 1 to vardim1(arr2)
		for j = 1 to vardim2(arr2)
			text2 0,-0.01*k,arr2[i][j]
			text2 -0.01,-0.01*k,i
			text2 -0.02,-0.01*k,j
			k = k+1
		next j
	next i
return
"pr_1arr":
	k=0
	for i = 1 to vardim1(arr1)
			text2 0,-0.01*k,arr1[i]
			text2 -0.01,-0.01*k,i
			k = k+1
	next i
return

"write_error":
	n_err = n_err + 1
	error[n_err] = txt
return

"from_layout":
	for i = ROW_FAM_START_LAYUOT to ROW_FAM_END_LAYUOT
		if STRLEN(LayoutRevHistory[last_rev_inx][i])>1 then
			flag = 1
			for j = 1 to n_position
				if GlobIssueScheme[1][i]= position_info[j][1] then flag = 0
			next j
			if flag then
				n_position = n_position + 1
				position_info[n_position][1] = GlobIssueScheme[1][i]
				position_info[n_position][2] = LayoutRevHistory[last_rev_inx][i]
				position_info[n_position][3] = current_date
			endif
		endif
	next i
return

"from_issue":
	for i = ROW_FAM_START_ISSUE to ROW_FAM_END_ISSUE
		if STRLEN(LayoutRevHistory[last_rev_inx][i])>1 then
			flag = 1
			for j = 1 to n_position
				if GlobIssueScheme[1][i]= position_info[j][1] then flag = 0
			next j
			if flag then
				n_position = n_position + 1
				position_info[n_position][1] = GlobIssueScheme[1][i]
				position_info[n_position][2] = LayoutRevHistory[last_rev_inx][i]
				position_info[n_position][3] = current_date
			endif
		endif
	next i
return

"from_change":
	for i = ROW_FAM_START_CHANGE to ROW_FAM_END_CHANGE
		if STRLEN(LayoutchangeHistory[zero_change_inx][i])>1 then
			flag = 1
			for j = 1 to n_position
				if GlobchangeScheme[1][i]= position_info[j][1] then flag = 0
			next j
			if flag then
				n_position = n_position + 1
				position_info[n_position][1] = GlobchangeScheme[1][i]
				position_info[n_position][2] = LayoutchangeHistory[zero_change_inx][i]
				position_info[n_position][3] = current_date
			endif
		endif
	next i
return
20:
]]>
</Script_1D>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_PR SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_PR>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_UI SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_UI>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_FWM SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_FWM>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_BWM SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_BWM>

<Keywords SectVersion="1" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Keywords>

<Comment SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Comment>

</Symbol>
