<?xml version="1.0" encoding="UTF-8"?>
<Symbol IsArchivable="false" IsPlaceable="true" MainGUID="82E718C1-052C-4295-8AC7-D6DEA1605032" MigrationValue="Normal" Owner="1196638531" Signature="1196644685" Version="43">
<Ancestry SectVersion="1" SectionFlags="0" SubIdent="0" Template="false">
	<MainGUID>F938E33A-329D-4A36-BE3E-85E126820996</MainGUID>
	<MainGUID>B176ABF1-5813-478F-926B-28EE7C5DC1F7</MainGUID>
	<MainGUID>4FD10D67-2F29-4844-A65A-6597589B0CB5</MainGUID>
	<MainGUID>E861C53A-AE47-47A1-8AE8-D815C1B6E49A</MainGUID>
</Ancestry>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_3D SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_3D>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_2D SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[
if gs_debug then
	pen 10

	crossSize = 0.01
	line2 -crossSize,-crossSize, crossSize, crossSize	! Origo
	line2  crossSize,-crossSize,-crossSize, crossSize
endif


if bPositioningPreview then
	if gs_position_side_int = 1 | gs_position_side_int = 4 then		! Top or Bottom
		previewRatio = titleRectX / savedTitleRectX
	else
		previewRatio = titleRectY / savedTitleRectY
	endif
endif

hID = 1		! Hotspot ID


if AC_UseUniformTextFormat then
	gs_drawing_name_font_type		= AC_TextFont
	gs_drawing_name_font_size		= AC_TextSize
	gs_drawing_name_font_pen		= AC_TextPen
	drawingNameFontStyle			= AC_TextStyle

	gs_backref_font_type			= AC_TextFont
	gs_backref_font_size			= AC_TextSize
	gs_backref_font_pen				= AC_TextPen
	backrefFontStyle				= AC_TextStyle

	gs_drawing_scale_font_type		= AC_TextFont
	gs_drawing_scale_font_size		= AC_TextSize
	gs_drawing_scale_font_pen		= AC_TextPen
	drawingScaleFontStyle			= AC_TextStyle

	gs_drawing_number_font_type		= AC_TextFont
	gs_drawing_number_font_size		= AC_TextSize
	gs_drawing_number_font_pen		= AC_TextPen
	drawingNumberFontStyle			= AC_TextStyle

	gs_source_filename_font_type	= AC_TextFont
	gs_source_filename_font_size	= AC_TextSize
	gs_source_filename_font_pen		= AC_TextPen
	sourceFileNameFontStyle			= AC_TextStyle

	gs_drawing_magn_font_type		= AC_TextFont
	gs_drawing_magn_font_size		= AC_TextSize
	gs_drawing_magn_font_pen		= AC_TextPen
	drawingMagnFontStyle			= AC_TextStyle

	gs_project_filename_font_type	= AC_TextFont
	gs_project_filename_font_size	= AC_TextSize
	gs_project_filename_font_pen	= AC_TextPen
	projectFileNameFontStyle		= AC_TextStyle

	gs_layout_name_font_type		= AC_TextFont
	gs_layout_name_font_size		= AC_TextSize
	gs_layout_name_font_pen			= AC_TextPen
	layoutNameFontStyle				= AC_TextStyle

	gs_layout_number_font_type		= AC_TextFont
	gs_layout_number_font_size		= AC_TextSize
	gs_layout_number_font_pen		= AC_TextPen
	layoutNumberFontStyle			= AC_TextStyle
else
	drawingNameFontStyle		= gs_drawing_name_font_bold + 2 * gs_drawing_name_font_italic + 4 * gs_drawing_name_font_under
	drawingNumberFontStyle		= gs_drawing_number_font_bold + 2 * gs_drawing_number_font_italic + 4 * gs_drawing_number_font_under
	drawingScaleFontStyle		= gs_drawing_scale_font_bold + 2 * gs_drawing_scale_font_italic + 4 * gs_drawing_scale_font_under
	sourceFileNameFontStyle		= gs_source_filename_font_bold + 2 * gs_source_filename_font_italic + 4 * gs_source_filename_font_under
	drawingMagnFontStyle		= gs_drawing_magn_font_bold + 2 * gs_drawing_magn_font_italic + 4 * gs_drawing_magn_font_under
	projectFileNameFontStyle	= gs_project_filename_font_bold + 2 * gs_project_filename_font_italic + 4 * gs_project_filename_font_under
	layoutNameFontStyle			= gs_layout_name_font_bold + 2 * gs_layout_name_font_italic + 4 * gs_layout_name_font_under
	layoutNumberFontStyle		= gs_layout_number_font_bold + 2 * gs_layout_number_font_italic + 4 * gs_layout_number_font_under
	backrefFontStyle			= gs_backref_font_bold + 2 * gs_backref_font_italic + 4 * gs_backref_font_under
endif

bInside = (AC_titleFitMode = 2 | AC_titleFitMode = 3)	! Layout or Cell; Position of the title inside or outside the drawing

anchorDrawingNumber			= 1
anchorLayoutNumber			= 1
anchorDrawingName			= 1
anchorDrawingScale			= 7
anchorSourceFileName		= 7
anchorDrawingMagnification	= 7
anchorProjectFileName		= 7
anchorLayoutName			= 7
anchorBackRef				= 7

define style "styleDrawingName" 	gs_drawing_name_font_type,
									gs_drawing_name_font_size,
									anchorDrawingName,
									drawingNameFontStyle

define style "styleBackref" 		gs_backref_font_type,
									gs_backref_font_size,
									anchorBackRef,
									backrefFontStyle

define style "styleDrawingScale"	gs_drawing_scale_font_type,
									gs_drawing_scale_font_size,
									anchorDrawingScale,
									drawingScaleFontStyle

define style "styleDrawingNumber"	gs_drawing_number_font_type,
									gs_drawing_number_font_size,
									anchorDrawingNumber,
									drawingNumberFontStyle

define style "styleSourceFileName" 	gs_source_filename_font_type,
									gs_source_filename_font_size,
									anchorSourceFileName,
									sourceFileNameFontStyle

define style "styleDrawingMagnification" 	gs_drawing_magn_font_type,
											gs_drawing_magn_font_size,
											anchorDrawingMagnification,
											drawingMagnFontStyle

define style "styleProjectFilename" gs_project_filename_font_type,
									gs_project_filename_font_size,
									anchorProjectFileName,
									projectFileNameFontStyle

define style "styleLayoutName" 		gs_layout_name_font_type,
									gs_layout_name_font_size,
									anchorLayoutName,
									layoutNameFontStyle

define style "styleLayoutNumber"	gs_layout_number_font_type,
									gs_layout_number_font_size,
									anchorLayoutNumber,
									layoutNumberFontStyle



if gs_debug & GLOB_CONTEXT <> 5 then
	pen 10
	circle2 AC_LayoutRect[1], AC_LayoutRect[2], 0.01
	circle2 AC_LayoutRect[3], AC_LayoutRect[4], 0.01

	pen 7
	circle2 AC_GridRect[1], AC_GridRect[2], 0.01
	circle2 AC_GridRect[3], AC_GridRect[4], 0.01

	pen 4
	circle2 AC_DrawingRect[1], AC_DrawingRect[2], 0.01
	circle2 AC_DrawingRect[3], AC_DrawingRect[4], 0.01
endif


! ==============================================================================
! Input Parameter Definitions
! ==============================================================================

n = request ("HomeDB_info", "", n, AC_LayoutNumber, AC_LayoutName, n)
n = request ("Name_of_plan", "", n, AC_ProjectName, AC_ProjectPath)

if gs_drawing_name_custom then
	drawingName = gs_drawing_name_custom_text
else
	if AC_SourceFileName <> "" & gs_drawing_name_extension then
		drawingName = AC_SourceFileName
	else
	drawingName = AC_DrawingName
endif
endif

if gs_drawing_scale_original then
	drawingScale			= gs_drawing_scale_prefix + AC_OriginalDrawingScale
else
	drawingScale			= gs_drawing_scale_prefix + AC_DrawingScale
endif
drawingNumber			= gs_drawing_number_prefix + AC_DrawingNumber
drawingMagnification	= STR(AC_Magnification, 1,0) + gs_drawing_magn_suffix
layoutNumber			= gs_layout_number_prefix + AC_LayoutNumber


! ==============================================================================
! Draw Title
! ==============================================================================

if gs_debug then

	add2 titlePosX, titlePosY
	rot2 titleAlpha

	if not(AC_ManualPosition) then
		rect2 0,0, titleRectX, titleRectY	! Selected Drawing

		hotspot2 0,0
		hotspot2 0, titleRectY
		hotspot2 titleRectX, 0
		hotspot2 titleRectX, titleRectY
	endif

	del 2
endif


! ==============================================================================
! Precalculations
! ==============================================================================

drawingNameFontH	 = gs_show_drawing_name *			(1.6 * PAPER_TO_MODEL * gs_drawing_name_font_size)
drawingScaleFontH	 = gs_show_drawing_scale *			(1.6 * PAPER_TO_MODEL * gs_drawing_scale_font_size)
drawingNumberFontH	 = gs_show_drawing_number *			(1.6 * PAPER_TO_MODEL * gs_drawing_number_font_size)
sourceFileNameFontH	 = gs_show_source_filename *		(1.6 * PAPER_TO_MODEL * gs_source_filename_font_size)
drawingMagnFontH	 = gs_show_drawing_magnification *	(1.6 * PAPER_TO_MODEL * gs_drawing_magn_font_size)
projectFileNameFontH = gs_show_project_filename *		(1.6 * PAPER_TO_MODEL * gs_project_filename_font_size)
layoutNameFontH		 = gs_show_layout_name *			(1.6 * PAPER_TO_MODEL * gs_layout_name_font_size)
layoutNumberFontH	 = gs_show_layout_number *			(1.6 * PAPER_TO_MODEL * gs_layout_number_font_size)
backrefFontH		 = AC_ShowDrawingReferences *		(1.6 * PAPER_TO_MODEL * gs_backref_font_size)

if _bCustomPosition then
	titleWidth = gs_title_width
else
	if gs_position_side_int = 1 | gs_position_side_int = 4 then		! Top or Bottom
		titleWidth = titleRectX
	else
		titleWidth = titleRectY
	endif
endif

titleHeight = max(drawingNameFontH, drawingScaleFontH, drawingNumberFontH, layoutNumberFontH)


! ==============================================================================
! Positioning
! ==============================================================================

if SYMB_MIRRORED & not(bPositioningPreview) then mul2 -1, 1
if GLOB_CONTEXT = 5 then rot2 -SYMB_ROTANGLE

add2 titlePosX, titlePosY
rot2 titleAlpha

if gs_position_side_int = 1 then		! Top
	if bInside then
		add2 0,titleRectY - gs_offset
	else
		add2 0,titleRectY + titleHeight + gs_offset
	endif
endif
if gs_position_side_int = 2 then		! Left
	if bInside then
		add2 gs_offset, 0
	else
		if bSpecPos then
			add2 -gs_offset - titleWidth, 0
		else
			add2 -gs_offset - titleHeight, 0
		endif
	endif
	rot2 (gs_title_rotate_with_position) * 90
endif
if gs_position_side_int = 3 then		! Right
	if bInside then
		add2 titleRectX - titleHeight - gs_offset, 0
	else
		add2 titleRectX + gs_offset, 0
	endif
	rot2 (gs_title_rotate_with_position) * 90
endif
if gs_position_side_int = 4 then		! Bottom
	if bInside then
		add2 0, titleHeight + gs_offset
	else
		add2 0, -gs_offset
	endif
endif

if AC_titleFitMode = 1 & not(gs_title_rotate_with_position) then
	if gs_title_rotate_with_drawing then
		rot2 -gs_title_rotation_angle
	else
		rot2 -titleAlpha - SYMB_ROTANGLE - gs_title_rotation_angle
	endif
endif

if _bCustomPosition then
	if gs_position_alignment_int = 1 then	! Left
		if bSpecPos then
			add2 0, titleHeight
		else
			add2 0, 0
		endif

		hotspot2  0,				-titleHeight,	hID,	gs_title_width, 1 + (AC_ManualPosition + 1) * 128
		hotspot2 -1,				-titleHeight,	hID+1,	gs_title_width, 3
		hotspot2  gs_title_width,	-titleHeight,	hID+2,	gs_title_width, 2
		hID = hID + 3

		add2 0, 0
	endif
	if gs_position_alignment_int = 2 then	! Center
		if bSpecPos then
			add2 -(titleRectY - gs_title_width) / 2, (titleRectY + titleHeight) / 2
		else
			add2 0, 0
		endif

		if gs_position_side_int = 1 | gs_position_side_int = 4 then	! Top or Bottom
			hotspot2 titleRectX / 2,						-titleHeight,	hID,	gs_title_half_width, 1 + 128
			hotspot2 titleRectX / 2 - 1,					-titleHeight,	hID+1,	gs_title_half_width, 3
			hotspot2 titleRectX / 2 + gs_title_half_width,	-titleHeight,	hID+2,	gs_title_half_width, 2
			hID = hID + 3

			hotspot2 titleRectX / 2,						-titleHeight,	hID,	gs_title_half_width, 1 + 128
			hotspot2 titleRectX / 2 + 1,					-titleHeight,	hID+1,	gs_title_half_width, 3
			hotspot2 titleRectX / 2 - gs_title_half_width,	-titleHeight,	hID+2,	gs_title_half_width, 2
			hID = hID + 3

			add2 (titleRectX - gs_title_width) / 2, 0
		else
			hotspot2 titleRectY / 2,						-titleHeight,	hID,	gs_title_half_width, 1 + 128
			hotspot2 titleRectY / 2 - 1,					-titleHeight,	hID+1,	gs_title_half_width, 3
			hotspot2 titleRectY / 2 + gs_title_half_width,	-titleHeight,	hID+2,	gs_title_half_width, 2
			hID = hID + 3

			hotspot2 titleRectY / 2,						-titleHeight,	hID,	gs_title_half_width, 1 + 128
			hotspot2 titleRectY / 2 + 1,					-titleHeight,	hID+1,	gs_title_half_width, 3
			hotspot2 titleRectY / 2 - gs_title_half_width,	-titleHeight,	hID+2,	gs_title_half_width, 2
			hID = hID + 3

			add2 (titleRectY - gs_title_width) / 2, 0
		endif
	endif
	if gs_position_alignment_int = 3 then	! Right
		if bSpecPos then
			add2 -titleRectY + titleWidth, titleRectY
		else
			add2 0, 0
		endif

		if gs_position_side_int = 1 | gs_position_side_int = 4 then	! Top or Bottom
			hotspot2 titleRectX,					-titleHeight,	hID,	gs_title_width, 1 + (AC_ManualPosition + 1) * 128
			hotspot2 titleRectX + 1,				-titleHeight,	hID+1,	gs_title_width, 3
			hotspot2 titleRectX - gs_title_width,	-titleHeight,	hID+2,	gs_title_width, 2
			hID = hID + 3

			add2 titleRectX - gs_title_width, 0
		else
			hotspot2 titleRectY,					-titleHeight,	hID,	gs_title_width, 1 + (AC_ManualPosition + 1) * 128
			hotspot2 titleRectY + 1,				-titleHeight,	hID+1,	gs_title_width, 3
			hotspot2 titleRectY - gs_title_width,	-titleHeight,	hID+2,	gs_title_width, 2
			hID = hID + 3

			add2 titleRectY - gs_title_width, 0
		endif
	endif
else
	add2 0,0	! Empty transformation
endif

if SYMB_MIRRORED & not(bPositioningPreview) then
	add2 gs_title_width,0
	mul2 -1, 1
endif


! ==============================================================================
! Title Preview
! ==============================================================================

if bPositioningPreview then
	pen gs_frame_pen
	line_type gs_frame_linetype

	fill gs_frame_fill

	poly2_b 4, 7, gs_frame_fill_fg, gs_frame_fill_bg,
		0,			 0,					1,
		0,			-titleHeight,		1,
		titleWidth,	-titleHeight,		1,
		titleWidth,	 0,					1
endif


! ==============================================================================
! Drawing Title
! ==============================================================================

if not(bPositioningPreview) then

! Marker =======================================================================

	! Marker
	middleLineDx = 0

	WS2 = MAX(STW(layoutNumber), STW(drawingScale), STW(drawingNumber))
	autocolwidth2 = (WS2 /1000*_usedGlobalScale)

	! Drawing Number
	posX = autocolwidth2 / 4
	posY = -titleHeight + drawingNumberFontH
	gosub 202

	! Layout Number
	posX = autocolwidth2 / 4
	posY = -titleHeight + layoutNumberFontH
	gosub 207

	! Drawing Scale
	posX = autocolwidth2 / 4
	posY = -titleHeight - drawingScaleFontH
	gosub 201

	line2 autocolwidth2/2 + autocolwidth2 , -titleHeight*2, autocolwidth2/2 + autocolwidth2 , 0

	! Drawing Name
	posX = autocolwidth2 + autocolwidth2 * 2/3
	posY = -titleHeight + drawingNameFontH

	gosub 200

! Lines ========================================================================

	pen gs_title_pen
	line_type gs_title_linetype
	bvalt=titleWidth
	vvalt=autocolwidth2*2
	!WS3 = MAX(STW(bvalt),STW(vvalt))
	!	If STW(vvalt) > WS3 Then WS3 = STW(vvalt)
	! autocolwidth2 = (WS3 /1000*_usedGlobalScale)


	line2 0, -titleHeight, titleWidth,-titleHeight

	hotline2 0, -titleHeight, titleWidth,-titleHeight
	hotspot2 0, -titleHeight
	hotspot2 titleWidth,-titleHeight


	line2 0, 0, titleWidth,0

	hotline2 0,	0, titleWidth,0
	hotspot2 0,	0
	hotspot2 titleWidth,	0

	line2 titleWidth, -titleHeight*2, titleWidth, 0

	hotline2 titleWidth, -titleHeight, titleWidth, 0
	line2 middleLineDx, -titleHeight*2, middleLineDx, 0

	hotline2 middleLineDx, -titleHeight,
			 middleLineDx, 0
	line2 middleLineDx, -titleHeight*2 , titleWidth,-titleHeight * 2

	hotline2 middleLineDx, -titleHeight / 2, titleWidth,-titleHeight / 2
	hotspot2 middleLineDx, -titleHeight * 2
	hotspot2 titleWidth,-titleHeight * 2

! Data =========================================================================


	! Layout ID Separator
	if AC_ShowDrawingReferences then

		posY = -titleHeight-backrefFontH

		hotspot2 autocolwidth2+autocolwidth2*2/3+ gs_backref_pos_x,		posY+gs_backref_pos_y,	hID,	gs_backref_pos_x, 1+128
		hotspot2 autocolwidth2+autocolwidth2*2/3+ gs_backref_pos_x- 1,	posY+gs_backref_pos_y,	hID+1,	gs_backref_pos_x, 3
		hotspot2 autocolwidth2+autocolwidth2*2/3+ gs_backref_pos_x,		posY+gs_backref_pos_y,	hID+2,	 gs_backref_pos_x, 2
		hID = hID + 3

		hotspot2 autocolwidth2+autocolwidth2*2/3+ gs_backref_pos_x,		posY+gs_backref_pos_y,	hID,	gs_backref_pos_y, 1+128
		hotspot2 autocolwidth2+autocolwidth2*2/3+ gs_backref_pos_x,		posY+gs_backref_pos_y- 1,hID+1,	gs_backref_pos_y, 3
		hotspot2 autocolwidth2+autocolwidth2*2/3+ gs_backref_pos_x,		posY+gs_backref_pos_y,	hID+2,	gs_backref_pos_y, 2
		hID = hID + 3


		if gs_backref_custom=0 then
			STYLE styleBackref
			pen gs_backref_font_pen
			TEXT2 autocolwidth2+autocolwidth2*2/3+ gs_backref_pos_x,-titleHeight-backrefFontH+gs_backref_pos_y,"<BACKREFSHEETNUMBER_R><DUMMY><"+ gs_backref_separator + ">" + AC_BackReferenceGUIDList[1]
		else
			set style "styleBackref"
			pen gs_backref_font_pen
			TEXT2 autocolwidth2+autocolwidth2*2/3+ gs_backref_pos_x ,-titleHeight-backrefFontH+gs_backref_pos_y,gs_backref_customtxt
		endif
	endif



endif


del 4 + 2 * (SYMB_MIRRORED & not(bPositioningPreview))

! ==============================================================================

end



200:
! ==============================================================================
! Text Drawing Name
! ==============================================================================
! in:
!	posX:	position X
!	posY:	position Y
! ==============================================================================

	if gs_show_drawing_name then

		set style "styleDrawingName"
		pen gs_drawing_name_font_pen

		if (GLOB_CONTEXT = 22 | GLOB_CONTEXT = 28) & (gs_GLOB_MODPAR_NAME = "gs_drawing_name_pos_x" | gs_GLOB_MODPAR_NAME = "gs_drawing_name_pos_y") then
			textWidth	= stw(drawingName) * PAPER_TO_MODEL
			textHeight	= drawingNameFontH
			textAnchor	= anchorDrawingName
			gosub 300

			add2 anchorX, anchorY

			rect2 posX + gs_drawing_name_pos_x,				posY + gs_drawing_name_pos_y,
				  posX + gs_drawing_name_pos_x + textWidth,	posY + gs_drawing_name_pos_y + textHeight
			del 1
		else
			text2 posX + gs_drawing_name_pos_x, posY + gs_drawing_name_pos_y, drawingName
		endif

		hotspot2 posX,							posY + gs_drawing_name_pos_y,	hID,	gs_drawing_name_pos_x, 1+128
		hotspot2 posX- 1,						posY + gs_drawing_name_pos_y,	hID+1,	gs_drawing_name_pos_x, 3
		hotspot2 posX+ gs_drawing_name_pos_x,	posY + gs_drawing_name_pos_y,	hID+2,	gs_drawing_name_pos_x, 2
		hID = hID + 3

		hotspot2 posX+ gs_drawing_name_pos_x,	posY,							hID,	gs_drawing_name_pos_y, 1+128
		hotspot2 posX+ gs_drawing_name_pos_x,	posY - 1,						hID+1,	gs_drawing_name_pos_y, 3
		hotspot2 posX+ gs_drawing_name_pos_x,	posY + gs_drawing_name_pos_y,	hID+2,	gs_drawing_name_pos_y, 2
		hID = hID + 3
	endif
return

201:
! ==============================================================================
! Text Drawing Scale
! ==============================================================================
! in:
!	posX:	position X
!	posY:	position Y
! ==============================================================================

	if gs_show_drawing_scale then

		set style "styleDrawingScale"
		pen gs_drawing_scale_font_pen

		if (GLOB_CONTEXT = 22 | GLOB_CONTEXT = 28) & (gs_GLOB_MODPAR_NAME = "gs_drawing_scale_pos_x" | gs_GLOB_MODPAR_NAME = "gs_drawing_scale_pos_y") then
			textWidth	= stw(drawingScale) * PAPER_TO_MODEL
			textHeight	= drawingScaleFontH
			textAnchor	= anchorDrawingScale
			gosub 300

			add2 anchorX, anchorY

			rect2 posX + gs_drawing_scale_pos_x,				posY + gs_drawing_scale_pos_y,
				  posX + gs_drawing_scale_pos_x + textWidth,	posY + gs_drawing_scale_pos_y + textHeight
			del 1
		else
			text2 posX + gs_drawing_scale_pos_x, posY + gs_drawing_scale_pos_y, drawingScale
		endif

		hotspot2 posX,							posY + gs_drawing_scale_pos_y,	hID,	gs_drawing_scale_pos_x, 1+128
		hotspot2 posX - 1,						posY + gs_drawing_scale_pos_y,	hID+1,	gs_drawing_scale_pos_x, 3
		hotspot2 posX + gs_drawing_scale_pos_x,	posY + gs_drawing_scale_pos_y,	hID+2,	gs_drawing_scale_pos_x, 2
		hID = hID + 3

		hotspot2 posX + gs_drawing_scale_pos_x,	posY,							hID,	gs_drawing_scale_pos_y, 1+128
		hotspot2 posX + gs_drawing_scale_pos_x,	posY - 1,						hID+1,	gs_drawing_scale_pos_y, 3
		hotspot2 posX + gs_drawing_scale_pos_x,	posY + gs_drawing_scale_pos_y,	hID+2,	gs_drawing_scale_pos_y, 2
		hID = hID + 3
	endif
return

202:
! ==============================================================================
! Text Drawing Number
! ==============================================================================
! in:
!	posX:	position X
!	posY:	position Y
! ==============================================================================

	if gs_show_drawing_number then

		set style "styleDrawingNumber"
		pen gs_drawing_number_font_pen

		if (GLOB_CONTEXT = 22 | GLOB_CONTEXT = 28) & (gs_GLOB_MODPAR_NAME = "gs_drawing_number_pos_x" | gs_GLOB_MODPAR_NAME = "gs_drawing_number_pos_y") then
			textWidth	= stw(drawingNumber) * PAPER_TO_MODEL
			textHeight	= drawingNumberFontH
			textAnchor	= anchorDrawingNumber
			gosub 300

			add2 anchorX, anchorY

			rect2 posX + gs_drawing_number_pos_x,				posY + gs_drawing_number_pos_y,
				  posX + gs_drawing_number_pos_x + textWidth,	posY + gs_drawing_number_pos_y + textHeight
			del 1
		else
			text2 posX + gs_drawing_number_pos_x, posY + gs_drawing_number_pos_y, drawingNumber
		endif

		hotspot2 posX,								posY + gs_drawing_number_pos_y,	hID,	gs_drawing_number_pos_x, 1+128
		hotspot2 posX - 1,							posY + gs_drawing_number_pos_y,	hID+1,	gs_drawing_number_pos_x, 3
		hotspot2 posX + gs_drawing_number_pos_x,	posY + gs_drawing_number_pos_y,	hID+2,	gs_drawing_number_pos_x, 2
		hID = hID + 3

		hotspot2 posX + gs_drawing_number_pos_x,	posY,							hID,	gs_drawing_number_pos_y, 1+128
		hotspot2 posX + gs_drawing_number_pos_x,	posY - 1,						hID+1,	gs_drawing_number_pos_y, 3
		hotspot2 posX + gs_drawing_number_pos_x,	posY + gs_drawing_number_pos_y,	hID+2,	gs_drawing_number_pos_y, 2
		hID = hID + 3
	endif
return

!203:
!! ==============================================================================
!! Text Drawing Path
!! ==============================================================================
!! in:
!!	posX:	position X
!!	posY:	position Y
!! ==============================================================================
!
!	if gs_show_source_filename then
!
!		set style "styleSourceFileName"
!		pen gs_source_filename_font_pen
!
!		if (GLOB_CONTEXT = 22 | GLOB_CONTEXT = 28) & (gs_GLOB_MODPAR_NAME = "gs_source_filename_pos_x" | gs_GLOB_MODPAR_NAME = "gs_source_filename_pos_y") then
!			textWidth	= stw(drawingPath) * PAPER_TO_MODEL
!			textHeight	= sourceFileNameFontH
!			textAnchor	= anchorSourceFileName
!			gosub 300
!
!			add2 anchorX, anchorY
!
!			rect2 posX + gs_source_filename_pos_x,				posY + gs_source_filename_pos_y,
!				  posX + gs_source_filename_pos_x + textWidth,	posY + gs_source_filename_pos_y + textHeight
!			del 1
!		else
!			text2 posX + gs_source_filename_pos_x, posY + gs_source_filename_pos_y, drawingPath
!		endif
!
!		hotspot2 posX,								posY + gs_source_filename_pos_y,	hID,	gs_source_filename_pos_x, 1+128
!		hotspot2 posX - 1,							posY + gs_source_filename_pos_y,	hID+1,	gs_source_filename_pos_x, 3
!		hotspot2 posX + gs_source_filename_pos_x,	posY + gs_source_filename_pos_y,	hID+2,	gs_source_filename_pos_x, 2
!		hID = hID + 3
!
!		hotspot2 posX + gs_source_filename_pos_x,	posY,								hID,	gs_source_filename_pos_y, 1+128
!		hotspot2 posX + gs_source_filename_pos_x,	posY - 1,							hID+1,	gs_source_filename_pos_y, 3
!		hotspot2 posX + gs_source_filename_pos_x,	posY + gs_source_filename_pos_y,	hID+2,	gs_source_filename_pos_y, 2
!		hID = hID + 3
!	endif
!return

204:
! ==============================================================================
! Text Magnification
! ==============================================================================
! in:
!	posX:	position X
!	posY:	position Y
! ==============================================================================

	if gs_show_drawing_magnification then

		set style "styleDrawingMagnification"
		pen gs_drawing_magn_font_pen

		if (GLOB_CONTEXT = 22 | GLOB_CONTEXT = 28) & (gs_GLOB_MODPAR_NAME = "gs_drawing_magn_pos_x" | gs_GLOB_MODPAR_NAME = "gs_drawing_magn_pos_y") then
			textWidth	= stw(drawingMagnification) * PAPER_TO_MODEL
			textHeight	= drawingMagnFontH
			textAnchor	= anchorDrawingMagnification
			gosub 300

			add2 anchorX, anchorY

			rect2 posX + gs_drawing_magn_pos_x,				posY + gs_drawing_magn_pos_y,
				  posX + gs_drawing_magn_pos_x + textWidth,	posY + gs_drawing_magn_pos_y + textHeight
			del 1
		else
			text2 posX + gs_drawing_magn_pos_x, posY + gs_drawing_magn_pos_y, drawingMagnification
		endif

		hotspot2 posX,							posY + gs_drawing_magn_pos_y,	hID,	gs_drawing_magn_pos_x, 1+128
		hotspot2 posX - 1,						posY + gs_drawing_magn_pos_y,	hID+1,	gs_drawing_magn_pos_x, 3
		hotspot2 posX + gs_drawing_magn_pos_x,	posY + gs_drawing_magn_pos_y,	hID+2,	gs_drawing_magn_pos_x, 2
		hID = hID + 3

		hotspot2 posX + gs_drawing_magn_pos_x,	posY,							hID,	gs_drawing_magn_pos_y, 1+128
		hotspot2 posX + gs_drawing_magn_pos_x,	posY - 1,						hID+1,	gs_drawing_magn_pos_y, 3
		hotspot2 posX + gs_drawing_magn_pos_x,	posY + gs_drawing_magn_pos_y,	hID+2,	gs_drawing_magn_pos_y, 2
		hID = hID + 3
	endif
return

!205:
!! ==============================================================================
!! Text File Path
!! ==============================================================================
!! in:
!!	posX:	position X
!!	posY:	position Y
!! ==============================================================================
!
!	if gs_show_project_filename then
!
!		set style "styleProjectFilename"
!		pen gs_project_filename_font_pen
!
!		if (GLOB_CONTEXT = 22 | GLOB_CONTEXT = 28) & (gs_GLOB_MODPAR_NAME = "gs_project_filename_pos_x" | gs_GLOB_MODPAR_NAME = "gs_project_filename_pos_y") then
!			textWidth	= stw(filePath) * PAPER_TO_MODEL
!			textHeight	= projectFileNameFontH
!			textAnchor	= anchorProjectFileName
!			gosub 300
!
!			add2 anchorX, anchorY
!
!			rect2 posX + gs_project_filename_pos_x,				posY + gs_project_filename_pos_y,
!				  posX + gs_project_filename_pos_x + textWidth,	posY + gs_project_filename_pos_y + textHeight
!			del 1
!		else
!			text2 posX + gs_project_filename_pos_x, posY + gs_project_filename_pos_y, filePath
!		endif
!
!		hotspot2 posX,								posY + gs_project_filename_pos_y,	hID,	gs_project_filename_pos_x, 1+128
!		hotspot2 posX - 1,							posY + gs_project_filename_pos_y,	hID+1,	gs_project_filename_pos_x, 3
!		hotspot2 posX + gs_project_filename_pos_x,	posY + gs_project_filename_pos_y,	hID+2,	gs_project_filename_pos_x, 2
!		hID = hID + 3
!
!		hotspot2 posX + gs_project_filename_pos_x,	posY,								hID,	gs_project_filename_pos_y, 1+128
!		hotspot2 posX + gs_project_filename_pos_x,	posY - 1,							hID+1,	gs_project_filename_pos_y, 3
!		hotspot2 posX + gs_project_filename_pos_x,	posY + gs_project_filename_pos_y,	hID+2,	gs_project_filename_pos_y, 2
!		hID = hID + 3
!	endif
!return

!206:
!! ==============================================================================
!! Text Layout Name
!! ==============================================================================
!! in:
!!	posX:	position X
!!	posY:	position Y
!! ==============================================================================
!
!	if gs_show_layout_name then
!
!		set style "styleLayoutName"
!		pen gs_layout_name_font_pen
!
!		if (GLOB_CONTEXT = 22 | GLOB_CONTEXT = 28) & (gs_GLOB_MODPAR_NAME = "gs_layout_name_pos_x" | gs_GLOB_MODPAR_NAME = "gs_layout_name_pos_y") then
!			textWidth	= stw(layoutName) * PAPER_TO_MODEL
!			textHeight	= layoutNameFontH
!			textAnchor	= anchorLayoutName
!			gosub 300
!
!			add2 anchorX, anchorY
!
!			rect2 posX + gs_layout_name_pos_x,				posY + gs_layout_name_pos_y,
!				  posX + gs_layout_name_pos_x + textWidth,	posY + gs_layout_name_pos_y + textHeight
!			del 1
!		else
!			text2 posX + gs_layout_name_pos_x, posY + gs_layout_name_pos_y, layoutName
!		endif
!
!		hotspot2 posX,							posY + gs_layout_name_pos_y,	hID,	gs_layout_name_pos_x, 1+128
!		hotspot2 posX - 1,						posY + gs_layout_name_pos_y,	hID+1,	gs_layout_name_pos_x, 3
!		hotspot2 posX + gs_layout_name_pos_x,	posY + gs_layout_name_pos_y,	hID+2,	gs_layout_name_pos_x, 2
!		hID = hID + 3
!
!		hotspot2 posX + gs_layout_name_pos_x,	posY,							hID,	gs_layout_name_pos_y, 1+128
!		hotspot2 posX + gs_layout_name_pos_x,	posY - 1,						hID+1,	gs_layout_name_pos_y, 3
!		hotspot2 posX + gs_layout_name_pos_x,	posY + gs_layout_name_pos_y,	hID+2,	gs_layout_name_pos_y, 2
!		hID = hID + 3
!	endif
!return

207:
! ==============================================================================
! Text Layout Number
! ==============================================================================
! in:
!	posX:	position X
!	posY:	position Y
! ==============================================================================

	if gs_show_layout_number then

		set style "styleLayoutNumber"
		pen gs_layout_number_font_pen

		if (GLOB_CONTEXT = 22 | GLOB_CONTEXT = 28) & (gs_GLOB_MODPAR_NAME = "gs_layout_number_pos_x" | gs_GLOB_MODPAR_NAME = "gs_layout_number_pos_y") then
			textWidth	= stw(layoutNumber) * PAPER_TO_MODEL
			textHeight	= layoutNumberFontH
			textAnchor	= anchorLayoutNumber
			gosub 300

			add2 anchorX, anchorY

			rect2 posX + gs_layout_number_pos_x,				posY + gs_layout_number_pos_y,
				  posX + gs_layout_number_pos_x + textWidth,	posY + gs_layout_number_pos_y + textHeight
			del 1
		else
			text2 posX + gs_layout_number_pos_x, posY + gs_layout_number_pos_y, layoutNumber
		endif

		hotspot2 posX,							posY + gs_layout_number_pos_y,	hID,	gs_layout_number_pos_x, 1+128
		hotspot2 posX - 1,						posY + gs_layout_number_pos_y,	hID+1,	gs_layout_number_pos_x, 3
		hotspot2 posX + gs_layout_number_pos_x,	posY + gs_layout_number_pos_y,	hID+2,	gs_layout_number_pos_x, 2
		hID = hID + 3

		hotspot2 posX + gs_layout_number_pos_x,	posY,							hID,	gs_layout_number_pos_y, 1+128
		hotspot2 posX + gs_layout_number_pos_x,	posY - 1,						hID+1,	gs_layout_number_pos_y, 3
		hotspot2 posX + gs_layout_number_pos_x,	posY + gs_layout_number_pos_y,	hID+2,	gs_layout_number_pos_y, 2
		hID = hID + 3
	endif
return


300:
! ==============================================================================
! Text anchor relative position
! ==============================================================================
! in:
!	textWidth:		width of the text
!	textHeight:		height of the text
!	textAnchor:		text anchor code
! out:
!	anchorY:		anchor relative position X
!	anchorY:		anchor relative position Y
! ==============================================================================

	if textAnchor = 1 | textAnchor = 4 | textAnchor = 7 then
		anchorX = 0
	endif
	if textAnchor = 2 | textAnchor = 5 | textAnchor = 8 then
		anchorX = -textWidth / 2
	endif
	if textAnchor = 3 | textAnchor = 6 | textAnchor = 9 then
		anchorX = -textWidth
	endif
	if textAnchor = 1 | textAnchor = 2 | textAnchor = 3 then
		anchorY = -textHeight
	endif
	if textAnchor = 4 | textAnchor = 5 | textAnchor = 6 then
		anchorY = -textHeight / 2
	endif
	if textAnchor = 7 | textAnchor = 8 | textAnchor = 9 then
		anchorY = 0
	endif
return

]]>
</Script_2D>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_1D SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[
EPS = 0.0001


if GLOB_SCRIPT_TYPE = 7 | GLOB_SCRIPT_TYPE = 8 then goto "MasterEnd"	! forward migration, backward migration

_usedGlobalScale = 1						! In Layout View the Global Scale is always 1

PAPER_TO_MODEL = _usedGlobalScale / 1000	! Convert paper size to model size

dim mPositionSide[4]
	mPositionSide[1] = `Верх`
	mPositionSide[2] = `Слева`
	mPositionSide[3] = `Справа`
	mPositionSide[4] = `Низ`

dim mPositionAlignment[3]
	mPositionAlignment[1] = `Слева`
	mPositionAlignment[2] = `Центр`
	mPositionAlignment[3] = `Справа`

dim mTitleFitMode[4]
	mTitleFitMode[1] = `Чертеж`
	mTitleFitMode[2] = `Макет`
	mTitleFitMode[3] = `Ячейка`
	mTitleFitMode[4] = `Специальный`


! ==============================================================================
! Bounding Box Calculations
! ==============================================================================

if AC_titleFitMode = 1 then		! Fit to Drawing Rect
	titlePosX = AC_DrawingRect[1]
	titlePosY = AC_DrawingRect[2]
	titleAlpha = AC_DrawingRect[5]

	xo = AC_DrawingRect[1]:		yo = AC_DrawingRect[2]
	x1 = AC_DrawingRect[3]:		y1 = AC_DrawingRect[4]
	x2 = x1 + cos(titleAlpha - 90):	y2 = y1 + sin(titleAlpha - 90)
endif

if AC_titleFitMode = 2 then		! Fit to Layout Rect
	titlePosX = AC_LayoutRect[1]
	titlePosY = AC_LayoutRect[2]
	titleAlpha = AC_LayoutRect[5]

	xo = AC_LayoutRect[1]:		yo = AC_LayoutRect[2]
	x1 = AC_LayoutRect[3]:		y1 = AC_LayoutRect[4]
	x2 = x1 + cos(titleAlpha - 90):	y2 = y1 + sin(titleAlpha - 90)
endif

if AC_titleFitMode = 3 then		! Fit to Cell Rect
	titlePosX = AC_GridRect[1]
	titlePosY = AC_GridRect[2]
	titleAlpha = AC_GridRect[5]

	xo = AC_GridRect[1]:		yo = AC_GridRect[2]
	x1 = AC_GridRect[3]:		y1 = AC_GridRect[4]
	x2 = x1 + cos(titleAlpha - 90):	y2 = y1 + sin(titleAlpha - 90)
endif

titleRectX = (abs((y2 - y1) * (xo - x1) - (x2 - x1) * (yo - y1)) / sqr((x2 - x1)^2 + (y2 - y1)^2))
diagonalL = sqr((xo - x1)^2 + (yo - y1)^2)

if abs(titleRectX) < EPS | diagonalL < EPS then end

titleRectY = sqr(diagonalL^2 - titleRectX^2)

savedTitleRectX = titleRectX
savedTitleRectY = titleRectY

if AC_ManualPosition then
	titlePosX	= 0
	titlePosY	= 0
	titleAlpha	= 0
endif


! ==============================================================================
! Draw Preview
! ==============================================================================

if GLOB_SCRIPT_TYPE = 2 then
	bPositioningPreview = (GLOB_CONTEXT = 5 & AC_PreviewType = 0)
else
	bPositioningPreview = 0
endif

if bPositioningPreview then

	if SYMB_MIRRORED then
		mul2 -1, 1
	endif

	PAPER_TO_MODEL = 0.1

	pwx = 20
	pwy = 20


	DEFINE FILLA `Штриховка Заголовка Чертежа` 136, 34, 136, 34, 136, 34, 136, 34,
		0.07, 0.07, 0, 1,
		1, 0, 0, 0, 0, 2,
		0, 1

	gs_frame_pen		= 1
	gs_frame_linetype	= 1		! Solid Line
	gs_frame_fill		= IND(FILL, `Штриховка Заголовка Чертежа`)
	gs_frame_fill_fg	= 6
	gs_frame_fill_bg	= 91

	pen 1
	rect2 0,0, pwx,pwy

	if AC_titleFitMode = 1 | AC_ManualPosition then		! Fit to Drawing Rect
		rect2 0.2*pwx, 0.3*pwy, 0.8*pwx, 0.8*pwy

		titlePosX	= 0.2*pwx
		titlePosY	= 0.3*pwy
		titleAlpha	= 0
		titleRectX	= 0.6*pwx
		titleRectY	= 0.5*pwy
	endif

	if AC_titleFitMode = 2 then		! Fit to Layout Rect
		titlePosX	= 0
		titlePosY	= 0
		titleAlpha	= 0
		titleRectX	= pwx
		titleRectY	= pwy
	endif

	if AC_titleFitMode = 3 then		! Fit to Cell Rect
		line2 0,		0.3*pwy,	pwx,		0.3*pwy
		line2 0,		0.8*pwy,	pwx,		0.8*pwy
		line2 0.2*pwx,	0,			0.2*pwx,	pwy
		line2 0.8*pwx,	0,			0.8*pwx,	pwy

		titlePosX	= 0.2*pwx
		titlePosY	= 0.3*pwy
		titleAlpha	= 0
		titleRectX	= 0.6*pwx
		titleRectY	= 0.5*pwy
	endif

	add2 titlePosX, titlePosY
	rot2 titleAlpha

	rect2 0,0, titleRectX,titleRectY

	del 2
endif


! Rotate mode ==================================================================

bSpecPos = (not(gs_title_rotate_with_position) & (gs_position_side_int = 2 | gs_position_side_int = 3))		! Left or Right

if bSpecPos then
	lock "gs_link_title_width"
	gs_link_title_width = 0
endif

gs_show_symbol = 0

! Custom Standing ==================================================================
! free setting Position or Title Range (Width), not depend on Sizes of Drawing/Layout/Cell

_bCustomPosition = not(gs_link_title_width) | AC_ManualPosition

! =============================================================================
"MasterEnd":


]]>
</Script_1D>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_PR SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_PR>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_UI SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_UI>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_VL SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[
parameters gs_GLOB_MODPAR_NAME = GLOB_MODPAR_NAME

! ==============================================================================
values "gs_position_side" mPositionSide
values "gs_position_alignment" mPositionAlignment

if GLOB_MODPAR_NAME = "gs_position_side" then
	gs_position_side_int = 1
	for iPos = 2 to vardim1(mPositionSide)
		if gs_position_side = mPositionSide[iPos] then
			gs_position_side_int = iPos
			iPos = vardim1(mPositionSide)
		endif
	next iPos
	parameters gs_position_side_int = gs_position_side_int
else
	gs_position_side_int = max(1, min(gs_position_side_int, vardim1(mPositionSide)))
	gs_position_side = mPositionSide[gs_position_side_int]
	parameters gs_position_side = gs_position_side, gs_position_side_int = gs_position_side_int
endif

if GLOB_MODPAR_NAME = "gs_position_alignment" then
	gs_position_alignment_int = 1
	for iPosA = 2 to vardim1(mPositionAlignment)
		if gs_position_alignment = mPositionAlignment[iPosA] then
			gs_position_alignment_int = iPosA
			iPosA = vardim1(mPositionAlignment)
		endif
	next iPosA
	parameters gs_position_alignment_int = gs_position_alignment_int
else
	gs_position_alignment_int = max(1, min(gs_position_alignment_int, vardim1(mPositionAlignment)))
	gs_position_alignment = mPositionAlignment[gs_position_alignment_int]
	parameters gs_position_alignment = gs_position_alignment, gs_position_alignment_int = gs_position_alignment_int
endif

! Title Rotation ===============================================================

if AC_titleFitMode <> 1 then
	gs_title_rotate_with_drawing = 1
	lock "gs_title_rotate_with_drawing"
	hideparameter "gs_title_rotate_with_drawing"
endif
if gs_title_rotate_with_position then
	lock "gs_title_rotation_angle"
	hideparameter "gs_title_rotation_angle"
endif


! Title Fit Mode ===============================================================

if gs_link_title_width & not(AC_ManualPosition) then
	lock "gs_title_width", "gs_position_alignment"
	hideparameter "gs_title_width", "gs_position_alignment"

	if gs_position_side_int = 1 | gs_position_side_int = 4 then		! Top or Bottom
		titleWidth = savedTitleRectX
	else
		titleWidth = savedTitleRectY
	endif

	parameters	gs_title_width = titleWidth,
				gs_title_half_width = titleWidth / 2
endif


! Title Position  ===============================================================

bNoGrid = (abs(AC_LayoutRect[1] - AC_GridRect[1]) < EPS & abs(AC_LayoutRect[2] - AC_GridRect[2]) < EPS & abs(AC_LayoutRect[3] - AC_GridRect[3]) < EPS & abs(AC_LayoutRect[4] - AC_GridRect[4]) < EPS & abs(AC_LayoutRect[5] - AC_GridRect[5]) < EPS)

if (GLOB_INTGUID = '' or GLOB_INTGUID = '{00000000-0000-0000-0000-000000000000}') then
	if bNoGrid then
		if AC_ManualPosition then
			values "gs_title_fit_mode" mTitleFitMode[1], mTitleFitMode[2], mTitleFitMode[4]
		else
			values "gs_title_fit_mode" mTitleFitMode[1], mTitleFitMode[2]
		endif
		if gs_title_fit_mode = mTitleFitMode[3] then
			gs_title_fit_mode = mTitleFitMode[2]
		endif
	else
		if AC_ManualPosition then
			values "gs_title_fit_mode" mTitleFitMode[1], mTitleFitMode[2], mTitleFitMode[3], mTitleFitMode[4]
		else
			values "gs_title_fit_mode" mTitleFitMode[1], mTitleFitMode[2], mTitleFitMode[3]
		endif
	endif
else
	if bNoGrid then
		if AC_ManualPosition then
			values "gs_title_fit_mode" mTitleFitMode[1], mTitleFitMode[2], mTitleFitMode[4]
		else
			values "gs_title_fit_mode" mTitleFitMode[1], mTitleFitMode[2]
		endif
		if gs_title_fit_mode = mTitleFitMode[3] then
			gs_title_fit_mode = mTitleFitMode[2]
		endif
	else
		if AC_ManualPosition then
			values "gs_title_fit_mode" mTitleFitMode[1], mTitleFitMode[2], mTitleFitMode[3], mTitleFitMode[4]
		else
			values "gs_title_fit_mode" mTitleFitMode[1], mTitleFitMode[2], mTitleFitMode[3]
		endif
	endif
endif

if GLOB_MODPAR_NAME = "gs_title_fit_mode" then
	if gs_title_fit_mode = mTitleFitMode[1] then AC_titleFitMode = 1
	if gs_title_fit_mode = mTitleFitMode[2] then AC_titleFitMode = 2
	if gs_title_fit_mode = mTitleFitMode[3] then AC_titleFitMode = 3

	parameters	AC_titleFitMode		= AC_titleFitMode,
				AC_ManualPosition	= 0
else
	if AC_ManualPosition then
		parameters gs_title_fit_mode = mTitleFitMode[4]		! Custom
	else
		if AC_titleFitMode < 1 | AC_titleFitMode >= 4 then
			AC_titleFitMode = 1
			parameters AC_titleFitMode = 1
		endif
		gs_title_fit_mode = mTitleFitMode[AC_titleFitMode]
		parameters gs_title_fit_mode = gs_title_fit_mode
	endif
endif

if GLOB_MODPAR_NAME = "gs_title_half_width" then
	parameters	gs_title_width		 = 2 * gs_title_half_width
else
	parameters	gs_title_half_width  = gs_title_width / 2
endif
values "gs_title_width" range (0,]
values "gs_title_half_width" range (0,]

values "gs_title_height" range (0,]

if AC_ManualPosition then		! Custom
	lock "gs_title_position",
		 "gs_position_side",
		 "gs_position_alignment",
		 "gs_offset",
		 "gs_link_title_width"
	hideparameter	"gs_title_position",
					"gs_position_side",
					"gs_position_alignment",
					"gs_offset",
					"gs_link_title_width"

	gs_link_title_width = 0
	parameters gs_link_title_width = 0
endif


! Frame ========================================================================


if not(gs_show_frame) then
	lock "gs_frame_pen", "gs_frame_linetype", "gs_frame_fill", "gs_frame_fill_fg", "gs_frame_fill_bg"
	hideparameter "gs_frame_pen", "gs_frame_linetype", "gs_frame_fill", "gs_frame_fill_fg", "gs_frame_fill_bg"
endif


! Marker =======================================================================

if GLOB_MODPAR_NAME = "gs_symbol_pos" then
	parameters gs_title_width = gs_symbol_pos
else
	parameters gs_symbol_pos = gs_title_width
endif


! ==============================================================================
! Square Title special settings
! ==============================================================================

lock			"gs_show_source_filename",
				"gs_show_drawing_magnification",
				"gs_show_project_filename",
				"gs_show_layout_name"

hideparameter	"gs_show_source_filename",
				"gs_show_drawing_magnification",
				"gs_show_project_filename",
				"gs_show_layout_name"

if GLOB_MODPAR_NAME = "gs_show_drawing_number" & gs_show_drawing_number then
	parameters gs_show_layout_number = 0
endif
if GLOB_MODPAR_NAME = "gs_show_layout_number" & gs_show_layout_number then
	parameters gs_show_drawing_number = 0
endif


! ==============================================================================
! Title Data
! ==============================================================================

! Backref =================================================================

if AC_UseUniformTextFormat | not(gs_show_drawing_name) then
	lock			"gs_backref_font_type",
					"gs_backref_font_size",
					"gs_backref_font_size_point",
					"gs_backref_font_pen",
					"gs_backref_font_bold",
					"gs_backref_font_italic",
					"gs_backref_font_under"

	hideparameter	"gs_backref_font_type",
					"gs_backref_font_size",
					"gs_backref_font_size_point",
					"gs_backref_font_pen",
					"gs_backref_font_bold",
					"gs_backref_font_italic",
					"gs_backref_font_under"
else
	values "gs_backref_font_size" range [0,]
	values "gs_backref_font_size_point" range [0,]
endif

if not(gs_backref_custom) then lock "gs_backref_customtxt"

if not(AC_ShowDrawingReferences) then
	lock			"gs_backref_custom",
					"gs_backref_customtxt"

	hideparameter	"gs_backref_custom",
					"gs_backref_customtxt"
endif


! Drawing Name =================================================================

if AC_UseUniformTextFormat | not(gs_show_drawing_name) then
	lock			"gs_drawing_name_font_type",
					"gs_drawing_name_font_size",
					"gs_drawing_name_font_size_point",
					"gs_drawing_name_font_pen",
					"gs_drawing_name_font_bold",
					"gs_drawing_name_font_italic",
					"gs_drawing_name_font_under"

	hideparameter	"gs_drawing_name_font_type",
					"gs_drawing_name_font_size",
					"gs_drawing_name_font_size_point",
					"gs_drawing_name_font_pen",
					"gs_drawing_name_font_bold",
					"gs_drawing_name_font_italic",
					"gs_drawing_name_font_under"
else
	values "gs_drawing_name_font_size" range [0,]
	values "gs_drawing_name_font_size_point" range [0,]
endif

if not(gs_drawing_name_custom) then lock "gs_drawing_name_custom_text"

if not(gs_show_drawing_number) then
	lock			"gs_drawing_name_custom",
					"gs_drawing_name_custom_text"

	hideparameter	"gs_drawing_name_custom",
					"gs_drawing_name_custom_text"
endif

if AC_SourceFileName = "" then
	hideparameter "gs_drawing_name_extension"
endif


! Drawing Scale ================================================================

if AC_UseUniformTextFormat | not(gs_show_drawing_scale) then
	lock			"gs_drawing_scale_font_type",
					"gs_drawing_scale_font_size",
					"gs_drawing_scale_font_size_poin",
					"gs_drawing_scale_font_pen",
					"gs_drawing_scale_font_bold",
					"gs_drawing_scale_font_italic",
					"gs_drawing_scale_font_under"

	hideparameter	"gs_drawing_scale_font_type",
					"gs_drawing_scale_font_size",
					"gs_drawing_scale_font_size_poin",
					"gs_drawing_scale_font_pen",
					"gs_drawing_scale_font_bold",
					"gs_drawing_scale_font_italic",
					"gs_drawing_scale_font_under"
else
	values "gs_drawing_scale_font_size" range [0,]
	values "gs_drawing_scale_font_size_poin" range [0,]
endif

if not(gs_show_drawing_scale) then
	lock	"gs_drawing_scale_prefix",
			"gs_drawing_scale_original"
	hideparameter	"gs_drawing_scale_prefix",
					"gs_drawing_scale_original"
endif


! Drawing Number ===============================================================

if AC_UseUniformTextFormat | not(gs_show_drawing_number) then
	lock			"gs_drawing_number_font_type",
					"gs_drawing_number_font_size",
					"gs_drawing_number_font_size_poi",
					"gs_drawing_number_font_pen",
					"gs_drawing_number_font_bold",
					"gs_drawing_number_font_italic",
					"gs_drawing_number_font_under"

	hideparameter	"gs_drawing_number_font_type",
					"gs_drawing_number_font_size",
					"gs_drawing_number_font_size_poi",
					"gs_drawing_number_font_pen",
					"gs_drawing_number_font_bold",
					"gs_drawing_number_font_italic",
					"gs_drawing_number_font_under"
else
	values "gs_drawing_number_font_size" range [0,]
	values "gs_drawing_number_font_size_poi" range [0,]
endif

if not(gs_show_drawing_number) then
	lock "gs_drawing_number_prefix"
	hideparameter "gs_drawing_number_prefix"
endif


! Source File Name and Path ====================================================

if AC_UseUniformTextFormat | not(gs_show_source_filename) then
	lock			"gs_source_filename_font_type",
					"gs_source_filename_font_size",
					"gs_source_filename_font_size_po",
					"gs_source_filename_font_pen",
					"gs_source_filename_font_bold",
					"gs_source_filename_font_italic",
					"gs_source_filename_font_under"

	hideparameter	"gs_source_filename_font_type",
					"gs_source_filename_font_size",
					"gs_source_filename_font_size_po",
					"gs_source_filename_font_pen",
					"gs_source_filename_font_bold",
					"gs_source_filename_font_italic",
					"gs_source_filename_font_under"
else
	values "gs_source_filename_font_size" range [0,]
	values "gs_source_filename_font_size_po" range [0,]
endif

if not(gs_show_source_filename) then
	lock			"gs_source_filename_path"
	hideparameter	"gs_source_filename_path"
endif


! Drawing Magnification ========================================================

if AC_UseUniformTextFormat | not(gs_show_drawing_magnification) then
	lock			"gs_drawing_magn_font_type",
					"gs_drawing_magn_font_size",
					"gs_drawing_magn_font_size_point",
					"gs_drawing_magn_font_pen",
					"gs_drawing_magn_font_bold",
					"gs_drawing_magn_font_italic",
					"gs_drawing_magn_font_under"

	hideparameter	"gs_drawing_magn_font_type",
					"gs_drawing_magn_font_size",
					"gs_drawing_magn_font_size_point",
					"gs_drawing_magn_font_pen",
					"gs_drawing_magn_font_bold",
					"gs_drawing_magn_font_italic",
					"gs_drawing_magn_font_under"
else
	values "gs_drawing_magn_font_size" range [0,]
	values "gs_drawing_magn_font_size_point" range [0,]
endif

if not(gs_show_drawing_magnification) then
	lock "gs_drawing_magn_suffix"
	hideparameter "gs_drawing_magn_suffix"
endif


! Project Filename =============================================================

if AC_UseUniformTextFormat | not(gs_show_project_filename) then
	lock			"gs_project_filename_font_type",
					"gs_project_filename_font_size",
					"gs_project_filename_font_size_p",
					"gs_project_filename_font_pen",
					"gs_project_filename_font_bold",
					"gs_project_filename_font_italic",
					"gs_project_filename_font_under"

	hideparameter	"gs_project_filename_font_type",
					"gs_project_filename_font_size",
					"gs_project_filename_font_size_p",
					"gs_project_filename_font_pen",
					"gs_project_filename_font_bold",
					"gs_project_filename_font_italic",
					"gs_project_filename_font_under"
else
	values "gs_project_filename_font_size" range [0,]
	values "gs_project_filename_font_size_p" range [0,]
endif

if not(gs_show_project_filename) then
	lock			"gs_project_filename_path"
	hideparameter	"gs_project_filename_path"
endif


! Layout Name ==================================================================

if AC_UseUniformTextFormat | not(gs_show_layout_name) then
	lock			"gs_layout_name_font_type",
					"gs_layout_name_font_size",
					"gs_layout_name_font_size_point",
					"gs_layout_name_font_pen",
					"gs_layout_name_font_bold",
					"gs_layout_name_font_italic",
					"gs_layout_name_font_under"

	hideparameter	"gs_layout_name_font_type",
					"gs_layout_name_font_size",
					"gs_layout_name_font_size_point",
					"gs_layout_name_font_pen",
					"gs_layout_name_font_bold",
					"gs_layout_name_font_italic",
					"gs_layout_name_font_under"
else
	values "gs_layout_name_font_size" range [0,]
	values "gs_layout_name_font_size_point" range [0,]
endif


! Layout Number ================================================================

if AC_UseUniformTextFormat | not(gs_show_layout_number) then
	lock			"gs_layout_number_font_type",
					"gs_layout_number_font_size",
					"gs_layout_number_font_size_poin",
					"gs_layout_number_font_pen",
					"gs_layout_number_font_bold",
					"gs_layout_number_font_italic",
					"gs_layout_number_font_under"

	hideparameter	"gs_layout_number_font_type",
					"gs_layout_number_font_size",
					"gs_layout_number_font_size_poin",
					"gs_layout_number_font_pen",
					"gs_layout_number_font_bold",
					"gs_layout_number_font_italic",
					"gs_layout_number_font_under"
else
	values "gs_layout_number_font_size" range [0,]
	values "gs_layout_number_font_size_poin" range [0,]
endif

if not(gs_show_layout_number) then
	lock "gs_layout_number_prefix"
	hideparameter "gs_layout_number_prefix"
endif


for i=1 to 255: put i: next i
values "gs_drawing_name_font_pen" use(nsp)
values "gs_drawing_scale_font_pen" use(nsp)
values "gs_drawing_number_font_pen" use(nsp)
values "gs_source_filename_font_pen" use(nsp)
values "gs_drawing_magn_font_pen" use(nsp)
values "gs_project_filename_font_pen" use(nsp)
values "gs_layout_name_font_pen" use(nsp)
values "gs_layout_number_font_pen" use(nsp)
values "gs_backref_font_pen" use(nsp)
values "gs_title_pen" use(nsp)
values "gs_frame_pen" use(nsp)
values "AC_TextPen" get(nsp) ! use get() to clear the parameter queue

! ==============================================================================
! Debug Functions
! ==============================================================================

if not(gs_debug) then
	hideparameter	"AC_DrawingName",
					"AC_SourceFileName",
					"AC_DrawingNumber",
					"AC_SourceFilePath",
					"AC_DrawingScale",
					"AC_OriginalDrawingScale",
					"AC_Magnification",
!!!					"AC_PreviewType",
					"AC_LayoutRect",
					"AC_GridRect",
					"AC_DrawingRect"
endif



Dot_in_mm = 25.4 / 72


!!! Synhronized mm and point in marker width
if GLOB_MODPAR_NAME = "gs_drawing_name_font_size" then
	parameters gs_drawing_name_font_size_point = gs_drawing_name_font_size / Dot_in_mm
	gs_drawing_name_font_size_point = gs_drawing_name_font_size / Dot_in_mm
endif
if GLOB_MODPAR_NAME = "gs_drawing_name_font_size_point" then
	parameters gs_drawing_name_font_size = gs_drawing_name_font_size_point * Dot_in_mm
	gs_drawing_name_font_size = gs_drawing_name_font_size_point * Dot_in_mm
endif

if GLOB_MODPAR_NAME = "gs_drawing_scale_font_size" then
	parameters gs_drawing_scale_font_size_poin = gs_drawing_scale_font_size / Dot_in_mm
	gs_drawing_scale_font_size_poin = gs_drawing_scale_font_size / Dot_in_mm
endif
if GLOB_MODPAR_NAME = "gs_drawing_scale_font_size_poin" then
	parameters gs_drawing_scale_font_size = gs_drawing_scale_font_size_poin * Dot_in_mm
	gs_drawing_scale_font_size = gs_drawing_scale_font_size_poin * Dot_in_mm
endif

if GLOB_MODPAR_NAME = "gs_backref_font_size" then
	parameters gs_backref_font_size_point = gs_backref_font_size / Dot_in_mm
	gs_backref_font_size_point = gs_backref_font_size / Dot_in_mm
endif
if GLOB_MODPAR_NAME = "gs_backref_font_size_point" then
	parameters gs_backref_font_size = gs_backref_font_size_point * Dot_in_mm
	gs_backref_font_size = gs_backref_font_size_point * Dot_in_mm
endif

if GLOB_MODPAR_NAME = "gs_drawing_number_font_size" then
	parameters gs_drawing_number_font_size_poi = gs_drawing_number_font_size / Dot_in_mm
	gs_drawing_number_font_size_poi = gs_drawing_number_font_size / Dot_in_mm
endif
if GLOB_MODPAR_NAME = "gs_drawing_number_font_size_poi" then
	parameters gs_drawing_number_font_size = gs_drawing_number_font_size_poi * Dot_in_mm
	gs_drawing_number_font_size = gs_drawing_number_font_size_poi * Dot_in_mm
endif

if GLOB_MODPAR_NAME = "gs_source_filename_font_size" then
	parameters gs_source_filename_font_size_po = gs_source_filename_font_size / Dot_in_mm
	gs_source_filename_font_size_po = gs_source_filename_font_size / Dot_in_mm
endif
if GLOB_MODPAR_NAME = "gs_source_filename_font_size_po" then
	parameters gs_source_filename_font_size = gs_source_filename_font_size_po * Dot_in_mm
	gs_source_filename_font_size = gs_source_filename_font_size_po * Dot_in_mm
endif

if GLOB_MODPAR_NAME = "gs_drawing_magn_font_size" then
	parameters gs_drawing_magn_font_size_point = gs_drawing_magn_font_size / Dot_in_mm
	gs_drawing_magn_font_size_point = gs_drawing_magn_font_size / Dot_in_mm
endif
if GLOB_MODPAR_NAME = "gs_drawing_magn_font_size_point" then
	parameters gs_drawing_magn_font_size = gs_drawing_magn_font_size_point * Dot_in_mm
	gs_drawing_magn_font_size = gs_drawing_magn_font_size_point * Dot_in_mm
endif

if GLOB_MODPAR_NAME = "gs_project_filename_font_size" then
	parameters gs_project_filename_font_size_p = gs_project_filename_font_size / Dot_in_mm
	gs_project_filename_font_size_p = gs_project_filename_font_size / Dot_in_mm
endif
if GLOB_MODPAR_NAME = "gs_project_filename_font_size_p" then
	parameters gs_project_filename_font_size = gs_project_filename_font_size_p * Dot_in_mm
	gs_project_filename_font_size = gs_project_filename_font_size_p * Dot_in_mm
endif

if GLOB_MODPAR_NAME = "gs_layout_name_font_size" then
	parameters gs_layout_name_font_size_point = gs_layout_name_font_size / Dot_in_mm
	gs_layout_name_font_size_point = gs_layout_name_font_size / Dot_in_mm
endif
if GLOB_MODPAR_NAME = "gs_layout_name_font_size_point" then
	parameters gs_layout_name_font_size = gs_layout_name_font_size_point * Dot_in_mm
	gs_layout_name_font_size = gs_layout_name_font_size_point * Dot_in_mm
endif

if GLOB_MODPAR_NAME = "gs_layout_number_font_size" then
	parameters gs_layout_number_font_size_poin = gs_layout_number_font_size / Dot_in_mm
	gs_layout_number_font_size_poin = gs_layout_number_font_size / Dot_in_mm
endif
if GLOB_MODPAR_NAME = "gs_layout_number_font_size_poin" then
	parameters gs_layout_number_font_size = gs_layout_number_font_size_poin * Dot_in_mm
	gs_layout_number_font_size = gs_layout_number_font_size_poin * Dot_in_mm
endif







]]>
</Script_VL>

<Comment SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Comment>

<ParamSection SectVersion="22" SectionFlags="0" SubIdent="0">
	<ParamSectHeader>
		<AutoHotspots>false</AutoHotspots>
		<StatBits>
			<STBit_FixSize/>
		</StatBits>
		<WDLeftFrame>0</WDLeftFrame>
		<WDRightFrame>0</WDRightFrame>
		<WDTopFrame>0</WDTopFrame>
		<WDBotFrame>0</WDBotFrame>
		<LayFlags>65535</LayFlags>
		<WDMirrorThickness>0</WDMirrorThickness>
		<WDWallInset>0</WDWallInset>
	</ParamSectHeader>
	<Parameters>
		<Length Name="A">
			<Description><![CDATA["Размер 1"]]></Description>
			<Fix/>
			<Value>1</Value>
		</Length>
		<Length Name="B">
			<Description><![CDATA["Размер 2"]]></Description>
			<Fix/>
			<Value>1</Value>
		</Length>

		<!-- gs_title_rotation: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="gs_title_rotation">
			<Description><![CDATA["Угол Поворота"]]></Description>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
		</Title>
		<Boolean Name="gs_rotate_with_position">
			<Description><![CDATA["Поворачивать с Расположением"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_rotate_with_drawing">
			<Description><![CDATA["Поворачивать с Чертежом"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Angle Name="gs_custom_angle">
			<Description><![CDATA["Специальный Угол"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Angle>

		<!-- gs_drawing_title_position: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="gs_drawing_title_position">
			<Description><![CDATA["Расположение"]]></Description>
		</Title>
		<String Name="gs_title_fit_mode">
			<Description><![CDATA["Расположение отн..."]]></Description>
			<Value><![CDATA["Чертеж"]]></Value>
		</String>
		<Integer Name="AC_TitleFitMode">
			<Description><![CDATA["Расположение отн..."]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>1</Value>
		</Integer>
		<Boolean Name="AC_ManualPosition">
			<Description><![CDATA["Ручное Размещение"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<String Name="AC_DrawingGUID">
			<Description><![CDATA["Ссылка на Чертеж"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<Boolean Name="AC_EnableBackReference">
			<Description><![CDATA["Активировать Обратную Ссылку"]]></Description>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<String Name="AC_BackReferenceGUIDList">
			<Description><![CDATA["Список GUID Рассмотр. Макетов"]]></Description>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<ArrayValues FirstDimension="1" SecondDimension="0">
				<AVal Row="1"><![CDATA[""]]></AVal>
			</ArrayValues>
		</String>
		<String Name="gs_position_side">
			<Description><![CDATA["Сторона"]]></Description>
			<Value><![CDATA["Низ"]]></Value>
		</String>
		<Integer Name="gs_position_side_int">
			<Description><![CDATA["Сторона"]]></Description>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>4</Value>
		</Integer>
		<String Name="gs_position_alignment">
			<Description><![CDATA["Выравнивание"]]></Description>
			<Value><![CDATA["Слева"]]></Value>
		</String>
		<Integer Name="gs_position_alignment_int">
			<Description><![CDATA["Выравнивание"]]></Description>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>1</Value>
		</Integer>
		<Length Name="gs_offset">
			<Description><![CDATA["Смещение Чертежа (Размер Модели)"]]></Description>
			<Value>0.01</Value>
		</Length>

		<!-- gs_drawing_title_rotation: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="gs_drawing_title_rotation">
			<Description><![CDATA["Угол Поворота"]]></Description>
		</Title>
		<Boolean Name="gs_title_rotate_with_position">
			<Description><![CDATA["Поворачивать с Расположением"]]></Description>
			<Value>1</Value>
		</Boolean>
		<Boolean Name="gs_title_rotate_with_drawing">
			<Description><![CDATA["Поворачивать с Чертежом"]]></Description>
			<Value>1</Value>
		</Boolean>
		<Angle Name="gs_title_rotation_angle">
			<Description><![CDATA["Специальный"]]></Description>
			<Value>0</Value>
		</Angle>

		<!-- gs_drawing_title_width: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="gs_drawing_title_width">
			<Description><![CDATA["Ширина"]]></Description>
		</Title>
		<Boolean Name="gs_link_title_width">
			<Description><![CDATA["Привязать Ширину к Расположению"]]></Description>
			<Value>1</Value>
		</Boolean>
		<Length Name="gs_title_width">
			<Description><![CDATA["Ширина Заголовка (Размер Модели)"]]></Description>
			<Value>0.0119826429093</Value>
		</Length>
		<Length Name="gs_title_height">
			<Description><![CDATA["Ширина Заголовка"]]></Description>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>1</Value>
		</Length>
		<Length Name="gs_title_half_width">
			<Description><![CDATA["Половина Ширины Заголовка (Размер Модели)"]]></Description>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0.599132145465</Value>
		</Length>

		<!-- gs_show_drawing_name: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Boolean Name="gs_show_drawing_name">
			<Description><![CDATA["Показ Имени Чертежа"]]></Description>
			<Flags>
				<ParFlg_BoldName/>
			</Flags>
			<Value>1</Value>
		</Boolean>
		<Boolean Name="gs_drawing_name_extension">
			<Description><![CDATA["С Расширением"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_drawing_name_custom">
			<Description><![CDATA["Специальное Имя Чертежа"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<String Name="gs_drawing_name_custom_text">
			<Description><![CDATA["Специальный Текст"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="gs_drawing_name_font_type">
			<Description><![CDATA["Тип Шрифта"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA["Arial"]]></Value>
		</String>
		<RealNum Name="gs_drawing_name_font_size">
			<Description><![CDATA["Размер Шрифта (мм)"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>4</Value>
		</RealNum>
		<RealNum Name="gs_drawing_name_font_size_point">
			<Description><![CDATA["Размер Шрифта (пт)"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>11.3385826772</Value>
		</RealNum>
		<PenColor Name="gs_drawing_name_font_pen">
			<Description><![CDATA["Перо Шрифта"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>66</Value>
		</PenColor>
		<Boolean Name="gs_drawing_name_font_bold">
			<Description><![CDATA["Жирный Шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_drawing_name_font_italic">
			<Description><![CDATA["Курсивный Шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_drawing_name_font_under">
			<Description><![CDATA["Подчеркнутый Шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Length Name="gs_drawing_name_pos_x">
			<Description><![CDATA["Позиция Текста по X"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_drawing_name_pos_y">
			<Description><![CDATA["Расположение Текста по Y"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>

		<!-- gs_show_drawing_scale: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Boolean Name="gs_show_drawing_scale">
			<Description><![CDATA["Показ Масштаба Чертежа"]]></Description>
			<Flags>
				<ParFlg_BoldName/>
			</Flags>
			<Value>1</Value>
		</Boolean>
		<Boolean Name="gs_drawing_scale_original">
			<Description><![CDATA["Использовать Исходный Масштаб"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<String Name="gs_drawing_scale_prefix">
			<Description><![CDATA["Префикс Масштаба Чертежа"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="gs_drawing_scale_font_type">
			<Description><![CDATA["Тип Шрифта"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA["Arial"]]></Value>
		</String>
		<RealNum Name="gs_drawing_scale_font_size">
			<Description><![CDATA["Размер Шрифта (мм)"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>4</Value>
		</RealNum>
		<RealNum Name="gs_drawing_scale_font_size_poin">
			<Description><![CDATA["Размер Шрифта (пт)"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>11.3385826772</Value>
		</RealNum>
		<PenColor Name="gs_drawing_scale_font_pen">
			<Description><![CDATA["Перо Шрифта"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>66</Value>
		</PenColor>
		<Boolean Name="gs_drawing_scale_font_bold">
			<Description><![CDATA["Жирный Шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_drawing_scale_font_italic">
			<Description><![CDATA["Курсивный Шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_drawing_scale_font_under">
			<Description><![CDATA["Подчеркнутый Шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Length Name="gs_drawing_scale_pos_x">
			<Description><![CDATA["Позиция Текста по X"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_drawing_scale_pos_y">
			<Description><![CDATA["Расположение Текста по Y"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>

		<!-- gs_show_drawing_number: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Boolean Name="gs_show_drawing_number">
			<Description><![CDATA["Показ ID Чертежа"]]></Description>
			<Flags>
				<ParFlg_BoldName/>
			</Flags>
			<Value>1</Value>
		</Boolean>
		<String Name="gs_drawing_number_prefix">
			<Description><![CDATA["Префикс ID Чертежа"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="gs_drawing_number_font_type">
			<Description><![CDATA["Тип Шрифта"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA["Arial"]]></Value>
		</String>
		<RealNum Name="gs_drawing_number_font_size">
			<Description><![CDATA["Размер Шрифта (мм)"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>4</Value>
		</RealNum>
		<RealNum Name="gs_drawing_number_font_size_poi">
			<Description><![CDATA["Размер Шрифта (пт)"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>11.3385826772</Value>
		</RealNum>
		<PenColor Name="gs_drawing_number_font_pen">
			<Description><![CDATA["Перо Шрифта"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>66</Value>
		</PenColor>
		<Boolean Name="gs_drawing_number_font_bold">
			<Description><![CDATA["Жирный Шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_drawing_number_font_italic">
			<Description><![CDATA["Курсивный Шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_drawing_number_font_under">
			<Description><![CDATA["Подчеркнутый Шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Length Name="gs_drawing_number_pos_x">
			<Description><![CDATA["Позиция Текста по X"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_drawing_number_pos_y">
			<Description><![CDATA["Расположение Текста по Y"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>

		<!-- gs_show_source_filename: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Boolean Name="gs_show_source_filename">
			<Description><![CDATA["Показ Имени Исходного Файла и Пути"]]></Description>
			<Flags>
				<ParFlg_BoldName/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_source_filename_path">
			<Description><![CDATA["с Путем"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<String Name="gs_source_filename_font_type">
			<Description><![CDATA["Тип Шрифта"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA["Arial"]]></Value>
		</String>
		<RealNum Name="gs_source_filename_font_size">
			<Description><![CDATA["Размер Шрифта (мм)"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>4.0005</Value>
		</RealNum>
		<RealNum Name="gs_source_filename_font_size_po">
			<Description><![CDATA["Размер Шрифта (пт)"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>11.34</Value>
		</RealNum>
		<PenColor Name="gs_source_filename_font_pen">
			<Description><![CDATA["Перо Шрифта"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>66</Value>
		</PenColor>
		<Boolean Name="gs_source_filename_font_bold">
			<Description><![CDATA["Жирный Шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_source_filename_font_italic">
			<Description><![CDATA["Курсивный Шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_source_filename_font_under">
			<Description><![CDATA["Подчеркнутый Шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Length Name="gs_source_filename_pos_x">
			<Description><![CDATA["Позиция Текста по X"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_source_filename_pos_y">
			<Description><![CDATA["Расположение Текста по Y"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>

		<!-- gs_show_drawing_magnification: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Boolean Name="gs_show_drawing_magnification">
			<Description><![CDATA["Показ Увеличения"]]></Description>
			<Flags>
				<ParFlg_BoldName/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<String Name="gs_drawing_magn_suffix">
			<Description><![CDATA["Суффикс Увеличения"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[" %"]]></Value>
		</String>
		<String Name="gs_drawing_magn_font_type">
			<Description><![CDATA["Тип Шрифта"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA["Arial"]]></Value>
		</String>
		<RealNum Name="gs_drawing_magn_font_size">
			<Description><![CDATA["Размер Шрифта (мм)"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>4.0005</Value>
		</RealNum>
		<RealNum Name="gs_drawing_magn_font_size_point">
			<Description><![CDATA["Размер Шрифта (пт)"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>11.34</Value>
		</RealNum>
		<PenColor Name="gs_drawing_magn_font_pen">
			<Description><![CDATA["Перо Шрифта"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>66</Value>
		</PenColor>
		<Boolean Name="gs_drawing_magn_font_bold">
			<Description><![CDATA["Жирный Шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_drawing_magn_font_italic">
			<Description><![CDATA["Курсивный Шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_drawing_magn_font_under">
			<Description><![CDATA["Подчеркнутый Шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Length Name="gs_drawing_magn_pos_x">
			<Description><![CDATA["Позиция Текста по X"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_drawing_magn_pos_y">
			<Description><![CDATA["Расположение Текста по Y"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>

		<!-- gs_show_project_filename: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Boolean Name="gs_show_project_filename">
			<Description><![CDATA["Показ Имени Файла Проекта и Пути"]]></Description>
			<Flags>
				<ParFlg_BoldName/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_project_filename_path">
			<Description><![CDATA["с Путем"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<String Name="gs_project_filename_font_type">
			<Description><![CDATA["Тип Шрифта"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA["Arial"]]></Value>
		</String>
		<RealNum Name="gs_project_filename_font_size">
			<Description><![CDATA["Размер Шрифта (мм)"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>4.0005</Value>
		</RealNum>
		<RealNum Name="gs_project_filename_font_size_p">
			<Description><![CDATA["Размер Шрифта (пт)"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>11.34</Value>
		</RealNum>
		<PenColor Name="gs_project_filename_font_pen">
			<Description><![CDATA["Перо Шрифта"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>66</Value>
		</PenColor>
		<Boolean Name="gs_project_filename_font_bold">
			<Description><![CDATA["Жирный Шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_project_filename_font_italic">
			<Description><![CDATA["Курсивный Шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_project_filename_font_under">
			<Description><![CDATA["Подчеркнутый Шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Length Name="gs_project_filename_pos_x">
			<Description><![CDATA["Позиция Текста по X"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_project_filename_pos_y">
			<Description><![CDATA["Расположение Текста по Y"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>

		<!-- gs_show_layout_name: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Boolean Name="gs_show_layout_name">
			<Description><![CDATA["Показ Имени Макета"]]></Description>
			<Flags>
				<ParFlg_BoldName/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<String Name="gs_layout_name_font_type">
			<Description><![CDATA["Тип Шрифта"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA["Arial"]]></Value>
		</String>
		<RealNum Name="gs_layout_name_font_size">
			<Description><![CDATA["Размер Шрифта (мм)"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>4.0005</Value>
		</RealNum>
		<RealNum Name="gs_layout_name_font_size_point">
			<Description><![CDATA["Размер Шрифта (пт)"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>11.34</Value>
		</RealNum>
		<PenColor Name="gs_layout_name_font_pen">
			<Description><![CDATA["Перо Шрифта"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>66</Value>
		</PenColor>
		<Boolean Name="gs_layout_name_font_bold">
			<Description><![CDATA["Жирный Шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_layout_name_font_italic">
			<Description><![CDATA["Курсивный Шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_layout_name_font_under">
			<Description><![CDATA["Подчеркнутый Шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Length Name="gs_layout_name_pos_x">
			<Description><![CDATA["Позиция Текста по X"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_layout_name_pos_y">
			<Description><![CDATA["Расположение Текста по Y"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>

		<!-- gs_show_layout_number: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Boolean Name="gs_show_layout_number">
			<Description><![CDATA["Показ ID Макета"]]></Description>
			<Flags>
				<ParFlg_BoldName/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<String Name="gs_layout_number_prefix">
			<Description><![CDATA["Префикс ID Макета"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="gs_layout_number_font_type">
			<Description><![CDATA["Тип Шрифта"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA["Arial"]]></Value>
		</String>
		<RealNum Name="gs_layout_number_font_size">
			<Description><![CDATA["Размер Шрифта (мм)"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>4</Value>
		</RealNum>
		<RealNum Name="gs_layout_number_font_size_poin">
			<Description><![CDATA["Размер Шрифта (пт)"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>11.34</Value>
		</RealNum>
		<PenColor Name="gs_layout_number_font_pen">
			<Description><![CDATA["Перо Шрифта"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>66</Value>
		</PenColor>
		<Boolean Name="gs_layout_number_font_bold">
			<Description><![CDATA["Жирный Шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_layout_number_font_italic">
			<Description><![CDATA["Курсивный Шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_layout_number_font_under">
			<Description><![CDATA["Подчеркнутый Шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Length Name="gs_layout_number_pos_x">
			<Description><![CDATA["Позиция Текста по X"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_layout_number_pos_y">
			<Description><![CDATA["Расположение Текста по Y"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>

		<!-- AC_ShowDrawingReferences: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Boolean Name="AC_ShowDrawingReferences">
			<Description><![CDATA["Показать Обратную Ссылку"]]></Description>
			<Flags>
				<ParFlg_BoldName/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<String Name="gs_backref_separator">
			<Description><![CDATA["Разделитель ID Макета"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[","]]></Value>
		</String>
		<Boolean Name="gs_backref_custom">
			<Description><![CDATA["Специальные Обратные Ссылки"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<String Name="gs_backref_customtxt">
			<Description><![CDATA["Специальный Текст"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="gs_backref_font_type">
			<Description><![CDATA["Тип Шрифта"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA["Arial"]]></Value>
		</String>
		<RealNum Name="gs_backref_font_size">
			<Description><![CDATA["Размер Шрифта (мм)"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>4</Value>
		</RealNum>
		<RealNum Name="gs_backref_font_size_point">
			<Description><![CDATA["Размер Шрифта (пт)"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>11.34</Value>
		</RealNum>
		<PenColor Name="gs_backref_font_pen">
			<Description><![CDATA["Перо Шрифта"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>66</Value>
		</PenColor>
		<Boolean Name="gs_backref_font_bold">
			<Description><![CDATA["Жирный Шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_backref_font_italic">
			<Description><![CDATA["Курсивный Шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_backref_font_under">
			<Description><![CDATA["Подчеркнутый Шрифт"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Length Name="gs_backref_pos_x">
			<Description><![CDATA["Позиция Текста по X"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_backref_pos_y">
			<Description><![CDATA["Расположение Текста по Y"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>

		<!-- gs_title_lines: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="gs_title_lines">
			<Description><![CDATA["Линии Заголовка"]]></Description>
		</Title>
		<LineType Name="gs_title_linetype">
			<Description><![CDATA["Тип Линии"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</LineType>
		<PenColor Name="gs_title_pen">
			<Description><![CDATA["Перо"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>65</Value>
		</PenColor>

		<!-- gs_show_frame: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Boolean Name="gs_show_frame">
			<Description><![CDATA["Показ Рамки"]]></Description>
			<Flags>
				<ParFlg_BoldName/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<PenColor Name="gs_frame_pen">
			<Description><![CDATA["Перо"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>7</Value>
		</PenColor>
		<LineType Name="gs_frame_linetype">
			<Description><![CDATA["Тип Линии"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</LineType>
		<FillPattern Name="gs_frame_fill">
			<Description><![CDATA["Штриховка Фона"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>23</Value>
		</FillPattern>
		<PenColor Name="gs_frame_fill_fg">
			<Description><![CDATA["Перо Штриховки"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>6</Value>
		</PenColor>
		<PenColor Name="gs_frame_fill_bg">
			<Description><![CDATA["Перо Фона Штриховки"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>19</Value>
		</PenColor>

		<!-- gs_show_symbol: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Boolean Name="gs_show_symbol">
			<Description><![CDATA["Показ Маркера"]]></Description>
			<Flags>
				<ParFlg_BoldName/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Length Name="gs_symbol_pos">
			<Description><![CDATA["Расположение Символа"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>1.19826429093</Value>
		</Length>
		<String Name="AC_TextFont">
			<Description><![CDATA["Тип Шрифта"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value><![CDATA["Arial"]]></Value>
		</String>
		<RealNum Name="AC_TextSize">
			<Description><![CDATA["Размер Шрифта"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>3</Value>
		</RealNum>
		<PenColor Name="AC_TextPen">
			<Description><![CDATA["Перо Шрифта"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>2</Value>
		</PenColor>
		<Integer Name="AC_TextStyle">
			<Description><![CDATA["Стиль Шрифта"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>1</Value>
		</Integer>
		<Boolean Name="AC_UseUniformTextFormat">
			<Description><![CDATA["Единый Формат Текста"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<String Name="AC_DrawingName">
			<Description><![CDATA["Имя Чертежа"]]></Description>
			<Flags>
				<ParFlg_Unique/>
			</Flags>
			<Value><![CDATA["Имя Чертежа"]]></Value>
		</String>
		<String Name="AC_DrawingNumber">
			<Description><![CDATA["ID Чертежа"]]></Description>
			<Flags>
				<ParFlg_Unique/>
			</Flags>
			<Value><![CDATA["d1"]]></Value>
		</String>
		<String Name="AC_DrawingScale">
			<Description><![CDATA["Масштаб Чертежа"]]></Description>
			<Flags>
				<ParFlg_Unique/>
			</Flags>
			<Value><![CDATA["1 : 100"]]></Value>
		</String>
		<String Name="AC_OriginalDrawingScale">
			<Description><![CDATA["Исходный Масштаб Чертежа"]]></Description>
			<Flags>
				<ParFlg_Unique/>
			</Flags>
			<Value><![CDATA["1 : 50"]]></Value>
		</String>
		<RealNum Name="AC_Magnification">
			<Description><![CDATA["Увеличение"]]></Description>
			<Flags>
				<ParFlg_Unique/>
			</Flags>
			<Value>1</Value>
		</RealNum>
		<String Name="AC_SourceFileName">
			<Description><![CDATA["Имя Исходного Файла"]]></Description>
			<Flags>
				<ParFlg_Unique/>
			</Flags>
			<Value><![CDATA["Имя Исходного Файла"]]></Value>
		</String>
		<String Name="AC_SourceFilePath">
			<Description><![CDATA["Путь Исходного Файла"]]></Description>
			<Flags>
				<ParFlg_Unique/>
			</Flags>
			<Value><![CDATA["Путь Исходного Файла"]]></Value>
		</String>
		<Integer Name="AC_PreviewType">
			<Description><![CDATA["Тип Предпросмотра"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Unique/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Integer>
		<Boolean Name="AC_ConvertedTitle">
			<Description><![CDATA["Конвертированный Заголовок"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Length Name="AC_LayoutRect">
			<Description><![CDATA["Данные Прямоугольника Макета"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Unique/>
			</Flags>
			<ArrayValues FirstDimension="5" SecondDimension="0">
				<AVal Row="1">-2.21574609878</AVal>
				<AVal Row="2">0.263931800834</AVal>
				<AVal Row="3">3.94791507788</AVal>
				<AVal Row="4">2.13357035504</AVal>
				<AVal Row="5">341.3525</AVal>
			</ArrayValues>
		</Length>
		<Length Name="AC_GridRect">
			<Description><![CDATA["Данные Прямоугольной Сетки"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Unique/>
			</Flags>
			<ArrayValues FirstDimension="5" SecondDimension="0">
				<AVal Row="1">-0.161192373224</AVal>
				<AVal Row="2">0.887144652238</AVal>
				<AVal Row="3">2.29221947768</AVal>
				<AVal Row="4">2.69230076516</AVal>
				<AVal Row="5">341.3525</AVal>
			</ArrayValues>
		</Length>
		<Length Name="AC_DrawingRect">
			<Description><![CDATA["Данные Прямоугольника Чертежа"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Unique/>
			</Flags>
			<ArrayValues FirstDimension="5" SecondDimension="0">
				<AVal Row="1">0.19832778852</AVal>
				<AVal Row="2">1.72393537597</AVal>
				<AVal Row="3">1.83877444272</AVal>
				<AVal Row="4">1.58753253554</AVal>
				<AVal Row="5">311.9606</AVal>
			</ArrayValues>
		</Length>
		<String Name="gs_GLOB_MODPAR_NAME">
			<Description><![CDATA[""]]></Description>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<Boolean Name="gs_debug">
			<Description><![CDATA[""]]></Description>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<String Name="LibraryLangCode">
			<Description><![CDATA[""]]></Description>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value><![CDATA["RUS"]]></Value>
		</String>
	</Parameters>
</ParamSection>

<CalledMacros SectVersion="2" SectionFlags="0" SubIdent="0">
</CalledMacros>

<Picture MIME="image/png" SectVersion="19" SectionFlags="0" SubIdent="0" length_in_bytes="2940" platform="Win">
	<![CDATA[
	696D6167652F706E670089504E470D0A1A0A0000000D49484452000000800000
	00800800000000E6553E17000000097048597300000B1300000B1301009A9C18
	0000000467414D410000B18E7CFB5193000000206348524D00007A2500008083
	0000F9FF000080E9000075300000EA6000003A980000176F925FC54600000AE8
	4944415478DA62FCCF30B00020809806D87E0680001A70070004D0803B002080
	06DC01000134E00E0008A001770040000DB803000268C01D0010407477C0A7F3
	2F50F80001446F07EC37B1D6E9FC86240010400CFFE90ADECB649C3066B88A24
	021040740E81BB4FA2BF3FEC38F710210210408CF4AC8C3EF1BD5156FCD32969
	7CC8162E061040740C81DF85B2C10CD5172585274B6B21440102888E6960BB5C
	3083E99B064E06B52348A20001443707BC99E5DAFD3F9B21E4FFA5CD1F90C501
	02886E0E7062005AFE239D211B4D1C2080E894069EB6B11C0A5CD3CA3E2D8AF1
	0FAA0C4000D12904E219B2FE7FB76558F0FF2FBA0C4000D1C9019764788FFFBF
	232BFA1C43062080E8E180E5E669DFCEF04B1FFF7F7CED6F0C498000A283037A
	F86C19ECBEED60113C8D4D16208068EB80BDEDC0D067E8F82FC510F47F86FC05
	6C4A000288A60EF81BC830FFFF1981BD9D7A890C296F9F6055031040B40D819B
	C64C9BFFDD3CCA79F322BFD71BEC4A000288860E3802F4F24B1DDE93FF2731D4
	E8D5E352051040B473403FA378D6D6F79724D51E3C9062D078864B194000D1CE
	015341C51C67B00B83EEC3BB7B3FE154061040348C8289CC4A3DD1A24057D8E1
	530510402CB42BFFF318F36E2CF97C6ADFB9A87F786A1C8000A2692E48634827
	A806208068EA80AFDE0C65BF08A80108201AB509EB655241D4FB88970704F0AB
	0408209A84C0DFA50C4CBBC1ACCFAF09A90508205A84C087C8C74A3BA4F6A810
	A518208018685202DCFCBF855DFF39518A010288164DB20F0C5F18BC932E063E
	244631400051DD01B7763204B1243D67F86D70A28C98E80508206A47C1764E86
	D86F3D0CD236B2F79C793E13A1012080A85C12BEECC979B4F8DB6A9985EC0DDC
	0FCD3888D0011040D40B81FD310FFECF9736FAFF3F1154FEED77E333BD498C36
	8000A29E0332852EFFDFC5CA72F8FF6F5F60F37B9A52CC1BA2B4010410F51CF0
	F16173F1FF4D7CCAF7FEBFCCBFF6FFFF0F22B5010410F51CF0EBB71F43D7FF4D
	4C06F749D20610405473C007FB055FED1866FE9FCB349F247D00014435077C16
	D1F97B5F8261E5FF7DBF48D20710405472C0A515FF2733ACFE7F908BEF29893A
	0102883A0EF8A8CA107E56DEE2CFFFCD737E92A8152080A81402310C1C123A0C
	87C9D0091040D4A80BD6465DED1149F6BCC2B0960CCD0001448D1058C8CFD193
	ACF86553F8493234030410C50E785B127DFE69160327433379FA01028852077C
	706660907DFA7FBB3943F43FB20C0008204A1D50237C2F9FC1ECDDFFEFEB5E93
	6700400051E6804BCF22039E2938B3DB5E25DB088000A2C8014FF9026F3DF7F4
	FF6F25B08C6C33000288926C78BEF2B7A52ADB76B58DEFCF45926D0840009119
	023F0F6F7DF1BF8641F6DFFFEF4E0C0CDD148422400091E780EBA60C0C12B37F
	473394FFFBFF72EE764AA2112080C872C06569F939D38418EAFF5A31B4515A8E
	000410390E38A5A271F7FFFF23420C87EECB31ECA2D0010001448E0366305881
	1ADC6B183DFE9F4DBA43A103000288AC286864F0060DB97B0A7CFE4F31000820
	F212611283C7CFFFBFB5F47F53EE00800022C901DFDE4319EF6D184A3E24322C
	A442550A10402438E0DBDF3FF760931D8F6D183438A651A329031040C48F0FBC
	BACA69C4F4484008C27BED7C67AB23353A73000144B403DEDC317AF95EEFFB1D
	357608FFE2275BAAF42601028858073C7B64C8CE70F39FE6AF47726C54EDCE02
	0410910EB8F64B9B1544712A7E7E2B43D51E35400011551BFEBFC66400B29F41
	E3DD5D5EC147540D01800022CA01571835A0AA0DDF3FE7E77A40CD812D800022
	C201BFCE726BC295EB3EFA24C1FA9C8A0E000820C269E0DB55713924EE8FF33A
	BCCF1825A9E60080002218023FCEAA23DBCFC0A175F3B7D4CF0F547300400011
	72C0A76B9A7CA822FCE2E7FECABEFE4A2D0700041001073CBFAA2C822E26CB7D
	9449EED9672A39002080F0A781FBEF75308B9D7B9F397FEAFE7E28CB4E150700
	04105E07DCFAA98D1942D77FEB31DCFAABF9F391022B351C001040F8A2E0C667
	1D4CE91BFF75191854BE3F61177EFE8F1A0E000820DC21F0EF02BF32E6328C9B
	CCE032E1DF4521F9B71FE5992977004000E10C815F174530EDFF759A1F522631
	E9BD7B25CCF7940A45224000E172C0AF0B227218823F2F2AC84299CC9A37BF89
	B0BEA0DC01000184230A3E5D55C02CECBE5F5214435272539BEB119708A50E00
	0820EC21F0E69636A6FD2FCF6888AD088C3F06E5F2C99DFF29FBFE35A5B10010
	40581DF0F28E2E1F86E0E367C6FC2B2A2C2542A64205C4B5CEFF5666A7D40100
	0184AD51FAF0189681DEE747FFFCFF1FD8F4FFFF3A367863F8C925CA1BA50001
	842504EEBF34C62CE4EE3CB700E639A1370C0C8133D24EC01CCF447936000820
	CC10B88A65B4E3EFD573FF7F6CDEF5F3BCD87E20AFC2FD0F48F0DFA5EB546896
	03041086032EDCC2A2EACC9DFF1FECA425CD9E3772DD0086BC02682AE0CFA93B
	D4E8170004105A14FC39C7A28A59265E12506698F7E3DC1975D7A4C880333F0F
	B27100555EC25250910100020835047E1CC732D9F7E5EC3DD084482EA84F68F5
	A349C54476150E95E40080004271C0A753AF30557C3AF216446D557DFDFFFF6F
	F3F8FF77B73CF8FFFFD58957541AE607082064077C39FCF67F21FA78CBC763EF
	FF9FEB042639BB78206F97C04BB0E0C1CF54B2FF3F40002139E0C50960E7D79E
	EF0A8AFCBB631FFFFF3FC030E1FFFFDBB2C93FFF5FE002A5D117A7BF526DA607
	2080100E787C0634F1636BA5F30049FADEF1EFA0B1107DD91E60FE30B66D34F6
	FD092CA8CEFCA09AFDFF010208EE807B677FEF7DF2FFBEE68B3C83F770D95BD7
	C039BE74C241AE59C0FE797F68C737604171E60F15A75A010208E680AB67FEFE
	B672FBF3EDF8FFDFD6EEDFA18277CE40251FFD5FCD055B8779E51A55E77A0102
	88015AD25DFEF7FFFF4B3B5056FBFF4C23089CC4FE9E462E137B65C105FFBFAB
	D4B5FF3F4000811DF0079CD3FFDFA9840CFA3F355D0E2A13CEDD43515918F2F7
	FFFF9F27EE5179B61B2080400EF875EE3178F85134A34B700E38EB7F0166F963
	9092063E0BF0F72930151C7B42EDD50E00010472C09383102F7AFDFFBF5B6C15
	44FCEB49C8E2AB8545C8A344275E50DBFEFF0001041A6C90FA725F11542AF330
	30B824440A3903996F6F2B415A5F3A4A8852FBE3352D7EAA2FB700082048223C
	FB0894BCF966FCFF5F640F0A8E17C7BF6369A79CF9F89FFA002080200EF8730A
	54C1AEE20F8BE300E5B647A77EFE5F7203AEE62B38DF3F3AF19B06F6FF070820
	4875CCAC71F53D0343E816C68F6BAD19181EBED06763D812FD051A460F3D2F80
	7A846F8C69B2EE0C20806005D1D713F0F0BD7A19B4F8375528145AE07DDEFDE5
	FFBF1B17FFFEA7090008205883844BF3E62F88832EB1837A849FAE6E7B11F513
	2CC2E3C2FDEFDC3F3D1AADC10608204465F4EC24A4A10729E9BECEFC7F8F3F17
	56049CBDF79F5600208090AAE3FB57FFFEFF7114C9AA33525D90B511E76867FF
	7F8000426E905CBBF4E1344A4973527C2BA8F571F805EDECFF0F1040287DC3FB
	979D7850E2E79CB03CC3AB872A82345C770F1040A89DD30BE2185DC28F974C38
	69B9F01F2080501DF0F79C9C38DA20F5133D0E5ADACF00104068DDF39FE795C4
	507A649FB5D8696A3F034000A18F0FFC3CAD23803A204563001040E8C50BBBFE
	ED1F88417AD080148D01400061946FBCF297FF4203E312AB1623CD1D00104058
	86689E3FD607C5FB8F4BB2920CB407000184A5849714BF061A103AAD4E0FFB19
	000208EB20D5DD1FDAEFEFC88BD1C37E068000C23E4A76F3FB776D3EBAD8CF00
	10403886E91E4BB2D0C77E068000621CE8BDE7000134E09B5E010268C01D0010
	4003EE008000030023E1CEDEEBDAD2000000000049454E44AE426082
	]]>
</Picture>

<Copyright SectVersion="1" SectionFlags="0" SubIdent="0">
	<Author>GRAPHISOFT</Author>
	<License>
		<Type>CC BY-ND</Type>
		<Version>3.0</Version>
	</License>
</Copyright>

<MigrationTable SectVersion="1" SectionFlags="0" SubIdent="0">
	<MigrationTableElement>
		<MainGUID>85542E72-5646-454E-9F0F-5012D7711D20</MainGUID>
		<Version>17</Version>
		<Name><![CDATA[""]]></Name>
		<AutoMigration>true</AutoMigration>
	</MigrationTableElement>
</MigrationTable>

</Symbol>
