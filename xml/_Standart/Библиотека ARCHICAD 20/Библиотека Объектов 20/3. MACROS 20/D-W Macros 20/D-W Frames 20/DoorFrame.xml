<?xml version="1.0" encoding="UTF-8"?>
<Symbol IsArchivable="true" IsPlaceable="false" MainGUID="B22F92A8-54D5-4AE8-B16B-94D653E1C8F6" MigrationValue="Normal" Owner="1196638531" Signature="1196644685" Version="38">
<Ancestry SectVersion="1" SectionFlags="0" SubIdent="0" Template="false">
	<MainGUID>F938E33A-329D-4A36-BE3E-85E126820996</MainGUID>
	<MainGUID>103E8D2C-8230-42E1-9597-46F84CCE28C0</MainGUID>
	<MainGUID>B2970E4C-8680-4061-8670-2F4B638F3953</MainGUID>
</Ancestry>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_3D SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[
if gs_pocket & not(gs_pocket_door_frame) then goto "PlacingPockets"

bSimpleOrCHIModel = (lod3D = 1 | lod3D = 5)

bNoRebate_02 = (gs_optype_m_02 = SASH_FIXED					|\
				gs_optype_m_02 = SASH_HOR_PIVOT				|\
				gs_optype_m_02 = SASH_VER_PIVOT				|\
				gs_optype_m_02 = SASH_VER_PIVOT_M			|\
				gs_optype_m_02 = SASH_SLIDING_HOR			|\
				gs_optype_m_02 = SASH_SLIDING_HOR_M			|\
				gs_optype_m_02 = SASH_DOUBLE_SLIDING_HOR	|\
				gs_optype_m_02 = SASH_DOUBLE_SLIDING_HOR_M	|\
				gs_optype_m_02 = SASH_SLIDING_VER			|\
				gs_optype_m_02 = SASH_DOUBLE_SLIDING_VER	)

bNoRebate_09 = (gs_optype_m_09 = SASH_FIXED					|\
				gs_optype_m_09 = SASH_HOR_PIVOT				|\
				gs_optype_m_09 = SASH_VER_PIVOT				|\
				gs_optype_m_09 = SASH_VER_PIVOT_M			|\
				gs_optype_m_09 = SASH_SLIDING_HOR			|\
				gs_optype_m_09 = SASH_SLIDING_HOR_M			|\
				gs_optype_m_09 = SASH_DOUBLE_SLIDING_HOR	|\
				gs_optype_m_09 = SASH_DOUBLE_SLIDING_HOR_M	|\
				gs_optype_m_09 = SASH_SLIDING_VER			|\
				gs_optype_m_09 = SASH_DOUBLE_SLIDING_VER	)

bNoRebate_10 = (gs_optype_m_10 = SASH_FIXED					|\
				gs_optype_m_10 = SASH_HOR_PIVOT				|\
				gs_optype_m_10 = SASH_VER_PIVOT				|\
				gs_optype_m_10 = SASH_VER_PIVOT_M			|\
				gs_optype_m_10 = SASH_SLIDING_HOR			|\
				gs_optype_m_10 = SASH_SLIDING_HOR_M			|\
				gs_optype_m_10 = SASH_DOUBLE_SLIDING_HOR	|\
				gs_optype_m_10 = SASH_DOUBLE_SLIDING_HOR_M	|\
				gs_optype_m_10 = SASH_SLIDING_VER			|\
				gs_optype_m_10 = SASH_DOUBLE_SLIDING_VER	)

bNoRebate_11 = (gs_optype_m_11 = SASH_FIXED					|\
				gs_optype_m_11 = SASH_HOR_PIVOT				|\
				gs_optype_m_11 = SASH_VER_PIVOT				|\
				gs_optype_m_11 = SASH_VER_PIVOT_M			|\
				gs_optype_m_11 = SASH_SLIDING_HOR			|\
				gs_optype_m_11 = SASH_SLIDING_HOR_M			|\
				gs_optype_m_11 = SASH_DOUBLE_SLIDING_HOR	|\
				gs_optype_m_11 = SASH_DOUBLE_SLIDING_HOR_M	|\
				gs_optype_m_11 = SASH_SLIDING_VER			|\
				gs_optype_m_11 = SASH_DOUBLE_SLIDING_VER	)

bNoRebate_05 = (gs_optype_m_05 = SASH_FIXED					|\
				gs_optype_m_05 = SASH_HOR_PIVOT				|\
				gs_optype_m_05 = SASH_VER_PIVOT				|\
				gs_optype_m_05 = SASH_VER_PIVOT_M			|\
				gs_optype_m_05 = SASH_SLIDING_HOR			|\
				gs_optype_m_05 = SASH_SLIDING_HOR_M			|\
				gs_optype_m_05 = SASH_DOUBLE_SLIDING_HOR	|\
				gs_optype_m_05 = SASH_DOUBLE_SLIDING_HOR_M	|\
				gs_optype_m_05 = SASH_SLIDING_VER			|\
				gs_optype_m_05 = SASH_DOUBLE_SLIDING_VER	)

bNoRebate_06 = (gs_optype_m_06 = SASH_FIXED					|\
				gs_optype_m_06 = SASH_HOR_PIVOT				|\
				gs_optype_m_06 = SASH_VER_PIVOT				|\
				gs_optype_m_06 = SASH_VER_PIVOT_M			|\
				gs_optype_m_06 = SASH_SLIDING_HOR			|\
				gs_optype_m_06 = SASH_SLIDING_HOR_M			|\
				gs_optype_m_06 = SASH_DOUBLE_SLIDING_HOR	|\
				gs_optype_m_06 = SASH_DOUBLE_SLIDING_HOR_M	|\
				gs_optype_m_06 = SASH_SLIDING_VER			|\
				gs_optype_m_06 = SASH_DOUBLE_SLIDING_VER	)

bNoRebate_07 = (gs_optype_m_07 = SASH_FIXED					|\
				gs_optype_m_07 = SASH_HOR_PIVOT				|\
				gs_optype_m_07 = SASH_VER_PIVOT				|\
				gs_optype_m_07 = SASH_VER_PIVOT_M			|\
				gs_optype_m_07 = SASH_SLIDING_HOR			|\
				gs_optype_m_07 = SASH_SLIDING_HOR_M			|\
				gs_optype_m_07 = SASH_DOUBLE_SLIDING_HOR	|\
				gs_optype_m_07 = SASH_DOUBLE_SLIDING_HOR_M	|\
				gs_optype_m_07 = SASH_SLIDING_VER			|\
				gs_optype_m_07 = SASH_DOUBLE_SLIDING_VER	)

bUniformMaterials = (gs_frame_mat = gs_frame_mat2)
if bUniformMaterials then
	offsetEPS = 0
else
	offsetEPS = 0.0001
endif

! Leaf
if gs_frame_style_m = FRAME_STYLE_DOUBLE_REBATE then
	offset_leaf = offsetEPS
else
	offset_leaf = 0
endif

! Transom
if gs_optype_m_02 = SASH_FIXED | iMullionStyle_02 = MULLION_SOLID_PANEL then
	offset_02 = offsetEPS
else
	if bSimpleOrCHIModel then
		if bNoRebate_02 then
			offset_02 = gs_sash_width + offsetEPS
		else
			offset_02 = gs_sash_width - gs_sidelight_rebate_width + offsetEPS
		endif
	else
		if bNoRebate_02 then
			offset_02 = offsetEPS
		else
			offset_02 = 0
		endif
	endif
endif

! Left Sidelight
if gs_optype_m_09 = SASH_FIXED | iMullionStyle_09 = MULLION_SOLID_PANEL then
	offset_09 = offsetEPS
else
	if bSimpleOrCHIModel then
		if bNoRebate_09 then
			offset_09 = gs_sl_sash_width + offsetEPS
		else
			offset_09 = gs_sl_sash_width - gs_sidelight_rebate_width + offsetEPS
		endif
	else
		if bNoRebate_09 then
			offset_09 = offsetEPS
		else
			offset_09 = 0
		endif
	endif
endif

! Left Upper Sidelight
if gs_optype_m_10 = SASH_FIXED | iMullionStyle_10 = MULLION_SOLID_PANEL then
	offset_10 = offsetEPS
else
	if bSimpleOrCHIModel then
		if bNoRebate_10 then
			offset_10 = gs_sash_width + offsetEPS
		else
			offset_10 = gs_sash_width - gs_sidelight_rebate_width + offsetEPS
		endif
	else
		if bNoRebate_10 then
			offset_10 = offsetEPS
		else
			offset_10 = 0
		endif
	endif
endif

! Left Lower Sidelight
if gs_optype_m_11 = SASH_FIXED | iMullionStyle_11 = MULLION_SOLID_PANEL then
	offset_11 = offsetEPS
else
	if bSimpleOrCHIModel then
		if bNoRebate_11 then
			offset_11 = gs_sl_sash_width + offsetEPS
		else
			offset_11 = gs_sl_sash_width - gs_sidelight_rebate_width + offsetEPS
		endif
	else
		if bNoRebate_11 then
			offset_11 = offsetEPS
		else
			offset_11 = 0
		endif
	endif
endif

! Right Sidelight
if gs_optype_m_05 = SASH_FIXED | iMullionStyle_05 = MULLION_SOLID_PANEL then
	offset_05 = offsetEPS
else
	if bSimpleOrCHIModel then
		if bNoRebate_05 then
			offset_05 = gs_sl_sash_width + offsetEPS
		else
			offset_05 = gs_sl_sash_width - gs_sidelight_rebate_width + offsetEPS
		endif
	else
		if bNoRebate_05 then
			offset_05 = offsetEPS
		else
			offset_05 = 0
		endif
	endif
endif

! Right Upper Sidelight
if gs_optype_m_06 = SASH_FIXED | iMullionStyle_06 = MULLION_SOLID_PANEL then
	offset_06 = offsetEPS
else
	if bSimpleOrCHIModel then
		if bNoRebate_06 then
			offset_06 = gs_sash_width + offsetEPS
		else
			offset_06 = gs_sash_width - gs_sidelight_rebate_width + offsetEPS
		endif
	else
		if bNoRebate_06 then
			offset_06 = offsetEPS
		else
			offset_06 = 0
		endif
	endif
endif

! Right Lower Sidelight
if gs_optype_m_07 = SASH_FIXED | iMullionStyle_07 = MULLION_SOLID_PANEL then
	offset_07 = offsetEPS
else
	if bSimpleOrCHIModel then
		if bNoRebate_07 then
			offset_07 = gs_sl_sash_width + offsetEPS
		else
			offset_07 = gs_sl_sash_width - gs_sidelight_rebate_width + offsetEPS
		endif
	else
		if bNoRebate_07 then
			offset_07 = offsetEPS
		else
			offset_07 = 0
		endif
	endif
endif

! =============================================================================

if bSimpleOrCHIModel then
	iSimpleSashFrameType_02 = SIMPLESASH_NORMAL
	if iMullionStyle_02 <> MULLION_SOLID_PANEL then
		if	gs_optype_m_02 = SASH_DOUBLE_SIDE_HUNG |\
			gs_optype_m_02 = SASH_DOUBLE_TILT_TURN |\
			gs_optype_m_02 = SASH_DOUBLE_TILT_TURN_M then iSimpleSashFrameType_02 = SIMPLESASH_SIDEHUNG
		if	gs_optype_m_02 = SASH_SLIDING_HOR |\
			gs_optype_m_02 = SASH_SLIDING_HOR_M |\
			gs_optype_m_02 = SASH_DOUBLE_SLIDING_HOR |\
			gs_optype_m_02 = SASH_DOUBLE_SLIDING_HOR_M then iSimpleSashFrameType_02 = SIMPLESASH_SLIDEHOR
		if	gs_optype_m_02 = SASH_SLIDING_VER |\
			gs_optype_m_02 = SASH_DOUBLE_SLIDING_VER then iSimpleSashFrameType_02 = SIMPLESASH_SLIDEVER
	endif

	iSimpleSashFrameType_09 = SIMPLESASH_NORMAL
	if iMullionStyle_09 <> MULLION_SOLID_PANEL then
		if	gs_optype_m_09 = SASH_DOUBLE_SIDE_HUNG |\
			gs_optype_m_09 = SASH_DOUBLE_TILT_TURN |\
			gs_optype_m_09 = SASH_DOUBLE_TILT_TURN_M then iSimpleSashFrameType_09 = SIMPLESASH_SIDEHUNG
		if	gs_optype_m_09 = SASH_SLIDING_HOR |\
			gs_optype_m_09 = SASH_SLIDING_HOR_M |\
			gs_optype_m_09 = SASH_DOUBLE_SLIDING_HOR |\
			gs_optype_m_09 = SASH_DOUBLE_SLIDING_HOR_M then iSimpleSashFrameType_09 = SIMPLESASH_SLIDEHOR
		if	gs_optype_m_09 = SASH_SLIDING_VER |\
			gs_optype_m_09 = SASH_DOUBLE_SLIDING_VER then iSimpleSashFrameType_09 = SIMPLESASH_SLIDEVER
	endif

	iSimpleSashFrameType_10 = SIMPLESASH_NORMAL
	if iMullionStyle_10 <> MULLION_SOLID_PANEL then
		if	gs_optype_m_10 = SASH_DOUBLE_SIDE_HUNG |\
			gs_optype_m_10 = SASH_DOUBLE_TILT_TURN |\
			gs_optype_m_10 = SASH_DOUBLE_TILT_TURN_M then iSimpleSashFrameType_10 = SIMPLESASH_SIDEHUNG
		if	gs_optype_m_10 = SASH_SLIDING_HOR |\
			gs_optype_m_10 = SASH_SLIDING_HOR_M |\
			gs_optype_m_10 = SASH_DOUBLE_SLIDING_HOR |\
			gs_optype_m_10 = SASH_DOUBLE_SLIDING_HOR_M then iSimpleSashFrameType_10 = SIMPLESASH_SLIDEHOR
		if	gs_optype_m_10 = SASH_SLIDING_VER |\
			gs_optype_m_10 = SASH_DOUBLE_SLIDING_VER then iSimpleSashFrameType_10 = SIMPLESASH_SLIDEVER
	endif

	iSimpleSashFrameType_11 = SIMPLESASH_NORMAL
	if iMullionStyle_11 <> MULLION_SOLID_PANEL then
		if	gs_optype_m_11 = SASH_DOUBLE_SIDE_HUNG |\
			gs_optype_m_11 = SASH_DOUBLE_TILT_TURN |\
			gs_optype_m_11 = SASH_DOUBLE_TILT_TURN_M then iSimpleSashFrameType_11 = SIMPLESASH_SIDEHUNG
		if	gs_optype_m_11 = SASH_SLIDING_HOR |\
			gs_optype_m_11 = SASH_SLIDING_HOR_M |\
			gs_optype_m_11 = SASH_DOUBLE_SLIDING_HOR |\
			gs_optype_m_11 = SASH_DOUBLE_SLIDING_HOR_M then iSimpleSashFrameType_11 = SIMPLESASH_SLIDEHOR
		if	gs_optype_m_11 = SASH_SLIDING_VER |\
			gs_optype_m_11 = SASH_DOUBLE_SLIDING_VER then iSimpleSashFrameType_11 = SIMPLESASH_SLIDEVER
	endif

	iSimpleSashFrameType_05 = SIMPLESASH_NORMAL
	if iMullionStyle_05 <> MULLION_SOLID_PANEL then
		if	gs_optype_m_05 = SASH_DOUBLE_SIDE_HUNG |\
			gs_optype_m_05 = SASH_DOUBLE_TILT_TURN |\
			gs_optype_m_05 = SASH_DOUBLE_TILT_TURN_M then iSimpleSashFrameType_05 = SIMPLESASH_SIDEHUNG
		if	gs_optype_m_05 = SASH_SLIDING_HOR |\
			gs_optype_m_05 = SASH_SLIDING_HOR_M |\
			gs_optype_m_05 = SASH_DOUBLE_SLIDING_HOR |\
			gs_optype_m_05 = SASH_DOUBLE_SLIDING_HOR_M then iSimpleSashFrameType_05 = SIMPLESASH_SLIDEHOR
		if	gs_optype_m_05 = SASH_SLIDING_VER |\
			gs_optype_m_05 = SASH_DOUBLE_SLIDING_VER then iSimpleSashFrameType_05 = SIMPLESASH_SLIDEVER
	endif

	iSimpleSashFrameType_06 = SIMPLESASH_NORMAL
	if iMullionStyle_06 <> MULLION_SOLID_PANEL then
		if	gs_optype_m_06 = SASH_DOUBLE_SIDE_HUNG |\
			gs_optype_m_06 = SASH_DOUBLE_TILT_TURN |\
			gs_optype_m_06 = SASH_DOUBLE_TILT_TURN_M then iSimpleSashFrameType_06 = SIMPLESASH_SIDEHUNG
		if	gs_optype_m_06 = SASH_SLIDING_HOR |\
			gs_optype_m_06 = SASH_SLIDING_HOR_M |\
			gs_optype_m_06 = SASH_DOUBLE_SLIDING_HOR |\
			gs_optype_m_06 = SASH_DOUBLE_SLIDING_HOR_M then iSimpleSashFrameType_06 = SIMPLESASH_SLIDEHOR
		if	gs_optype_m_06 = SASH_SLIDING_VER |\
			gs_optype_m_06 = SASH_DOUBLE_SLIDING_VER then iSimpleSashFrameType_06 = SIMPLESASH_SLIDEVER
	endif

	iSimpleSashFrameType_07 = SIMPLESASH_NORMAL
	if iMullionStyle_07 <> MULLION_SOLID_PANEL then
		if	gs_optype_m_07 = SASH_DOUBLE_SIDE_HUNG |\
			gs_optype_m_07 = SASH_DOUBLE_TILT_TURN |\
			gs_optype_m_07 = SASH_DOUBLE_TILT_TURN_M then iSimpleSashFrameType_07 = SIMPLESASH_SIDEHUNG
		if	gs_optype_m_07 = SASH_SLIDING_HOR |\
			gs_optype_m_07 = SASH_SLIDING_HOR_M |\
			gs_optype_m_07 = SASH_DOUBLE_SLIDING_HOR |\
			gs_optype_m_07 = SASH_DOUBLE_SLIDING_HOR_M then iSimpleSashFrameType_07 = SIMPLESASH_SLIDEHOR
		if	gs_optype_m_07 = SASH_SLIDING_VER |\
			gs_optype_m_07 = SASH_DOUBLE_SLIDING_VER then iSimpleSashFrameType_07 = SIMPLESASH_SLIDEVER
	endif
else
	iSimpleSashFrameType_02 = SIMPLESASH_NONE
	iSimpleSashFrameType_09 = SIMPLESASH_NONE
	iSimpleSashFrameType_10 = SIMPLESASH_NONE
	iSimpleSashFrameType_11 = SIMPLESASH_NONE
	iSimpleSashFrameType_05 = SIMPLESASH_NONE
	iSimpleSashFrameType_06 = SIMPLESASH_NONE
	iSimpleSashFrameType_07 = SIMPLESASH_NONE
endif

! =============================================================================

bNeedCutting = (bNeedCutting & (gs_frame_style_m <> FRAME_STYLE_METAL) & (gs_frame_style_m <> FRAME_STYLE_WRAPPED_EXTRUSION))

if bNeedCutting then
	if gs_frame_thk > EPS then
		cutDxLeft = max(gs_frame_ovhg_left_out, gs_frame_ovhg_left_in)
		addx -ac_unit_width/2 - gs_frame_ovhg_left_out
		roty 90 + atn((gs_frame_ovhg_left_out - gs_frame_ovhg_left_in) / gs_frame_thk)
		cutplane{2} 180, 3+4*gs_stack_left
		del 2

		cutDxRight = max(gs_frame_ovhg_right_out, gs_frame_ovhg_right_in)
		addx ac_unit_width/2 + gs_frame_ovhg_right_out
		roty 90 - atn((gs_frame_ovhg_right_out - gs_frame_ovhg_right_in) / gs_frame_thk)
		CUTPLANE{2} 0, 3+4*gs_stack_right
		del 2

		cutDy = max(gs_frame_ovhg_top_out, gs_frame_ovhg_top_in)
		addy ac_unit_height + gs_frame_ovhg_top_out
		rotz 90
		roty 90 - atn((gs_frame_ovhg_top_out - gs_frame_ovhg_top_in) / gs_frame_thk)
		CUTPLANE{2} 0, 3+4*gs_stack_top
		del 3
	else
		cutDxLeft	= gs_frame_ovhg_left_out
		cutDxRight	= gs_frame_ovhg_right_out
		cutDy		= gs_frame_ovhg_top_out
	endif
else
	cutDxLeft	= 0
	cutDxRight	= 0
	cutDy		= 0
endif

sect_fill fr_sect_fill_type, fr_sect_fill_bg, fr_sect_fill_fg, gs_frame_pen_cont
material gs_frame_mat
pen gs_frame_pen

resol res

outsideFrameThk	= gs_frame_thk
if gs_frame_wthk then
	if gs_sframe | lod3D = 5 then	! Uniform Frame Depth or CHI model
		insideFrameThk	= gs_frame_thk
	else
		insideFrameThk	= gs_frame_thkin
	endif
else
	insideFrameThk	= gs_frame_thk
endif

if abs(outsideFrameThk - insideFrameThk) < EPS then
	mmask=10
	mmask2=10
else
	mmask=12
	mmask2=14
endif

resol nArchResolution

Diff_extra = (gs_unit_extra_right - gs_unit_extra_left)

numCuts = 0
! ------------------------------------------------------------------------------
! Unit hotspots
! ------------------------------------------------------------------------------

if bShowUnitHotspots then
	addx Diff_extra
	if bArchedTop then
		hotspot -A/2 + gs_unit_extra_left + gs_frame_oversize, 0, 0, 100
		hotspot  A/2 - gs_unit_extra_right - gs_frame_oversize, 0, 0, 101
		hotspot -A/2 + gs_unit_extra_left + gs_frame_oversize, 0, outsideFrameThk, 102
		hotspot  A/2 - gs_unit_extra_right, 0, outsideFrameThk, 103

		hotspot -A/2 + gs_unit_extra_left + gs_frame_oversize, gs_shoulder_h, 0, 104
		hotspot  A/2 - gs_unit_extra_right - gs_frame_oversize, gs_shoulder_h, 0, 105
		hotspot -A/2 + gs_unit_extra_left + gs_frame_oversize, gs_shoulder_h, outsideFrameThk, 106
		hotspot  A/2 - gs_unit_extra_right, gs_shoulder_h, outsideFrameThk, 107

		hotspot 0, B, 0, 108
		hotspot 0, B, outsideFrameThk, 109
	else
		hotspot -A/2 + gs_unit_extra_left + gs_frame_oversize, 0, -comy, 100
		hotspot  A/2 - gs_unit_extra_right - gs_frame_oversize, 0, -comy, 101
		hotspot -A/2 + gs_unit_extra_left + gs_frame_oversize, 0, outsideFrameThk + comy, 102
		hotspot  A/2 - gs_unit_extra_right, 0, outsideFrameThk + comy, 103

		hotspot -A/2 + gs_unit_extra_left + gs_frame_oversize, b - gs_frame_oversize, -comy, 104
		hotspot  A/2 - gs_unit_extra_right - gs_frame_oversize, b - gs_frame_oversize, -comy, 105
		hotspot -A/2 + gs_unit_extra_left + gs_frame_oversize, b - gs_frame_oversize, outsideFrameThk + comy, 106
		hotspot  A/2 - gs_unit_extra_right - gs_frame_oversize, b - gs_frame_oversize, outsideFrameThk + comy, 107
	endif
	del 1
endif


!********** Shoulder Height Editing

if bArchedTop then
	addx Diff_extra
	hotspot -A/2 + gs_unit_extra_left + gs_frame_oversize,	gs_shoulder_h,	0, 2000, gs_shoulder_h, 2
	hotspot -A/2 + gs_unit_extra_left + gs_frame_oversize,	0,				0, 2001, gs_shoulder_h, 1+128
	hotspot -A/2 + gs_unit_extra_left + gs_frame_oversize,	-1,				0, 2002, gs_shoulder_h, 3

	hotspot A/2 - gs_unit_extra_right - gs_frame_oversize,	gs_shoulder_h,	0, 2003, gs_shoulder_h, 2
	hotspot A/2 - gs_unit_extra_right - gs_frame_oversize,	0,				0, 2004, gs_shoulder_h, 1+128
	hotspot A/2 - gs_unit_extra_right - gs_frame_oversize,	-1,				0, 2005, gs_shoulder_h, 3
	del 1
endif

if WIDO_REVEAL_SIDE then
	! Flip Corrections

	topmat=gs_frame_mat
	botmat=gs_frame_mat2
	sidemat=gs_frame_mat
else
	!*** default placement

	topmat=gs_frame_mat2
	botmat=gs_frame_mat
	sidemat=gs_frame_mat2
endif

if gs_door_transom then
	addx Diff_extra
	!*** Hotspot Editing of Transom

	hotspot -A/2 + gs_unit_extra_left + gs_frame_oversize, B-gs_frame_oversize, -comy, 1300, gs_transom_height, 1+128
	hotspot -A/2 + gs_unit_extra_left + gs_frame_oversize, B-gs_frame_oversize+1, -comy, 1301, gs_transom_height, 3
	hotspot -A/2 + gs_unit_extra_left + gs_frame_oversize, B-gs_frame_oversize-gs_transom_height, -comy, 1302, gs_transom_height, 2

	hotspot A/2 - gs_unit_extra_right - gs_frame_oversize, B-gs_frame_oversize, -comy, 1310, gs_transom_height, 1+128
	hotspot A/2 - gs_unit_extra_right - gs_frame_oversize, B-gs_frame_oversize+1, -comy, 1311, gs_transom_height, 3
	hotspot A/2 - gs_unit_extra_right - gs_frame_oversize, B-gs_frame_oversize-gs_transom_height, -comy, 1312, gs_transom_height, 2

	if bTransomHeightEditOnTop then
		hotspot 0, ac_egress_height, -comy, 1360, gs_transom_height_top, 1+128
		hotspot 0, ac_egress_height-1, -comy, 1361, gs_transom_height_top, 3
		hotspot 0, ac_egress_height+gs_transom_height_top, -comy, 1362, gs_transom_height_top, 2
	endif
	del 1
endif

if gs_door_transom then
	htpsHeight = B-_transomHeight
else
	htpsHeight = B
endif

!*** Hotspot Editing of Left SideLight

if gs_sidelight_left then
	addx Diff_extra
	hotspot -A/2 + gs_unit_extra_left + gs_frame_oversize, 0, -comy, 1320, gs_sidelight_width_left, 1+128
	hotspot -A/2 + gs_unit_extra_left + gs_frame_oversize-1, 0, -comy, 1321, gs_sidelight_width_left, 3
	hotspot -A/2 + gs_unit_extra_left + gs_frame_oversize+gs_sidelight_width_left, 0, -comy, 1322, gs_sidelight_width_left, 2

	hotspot -A/2 + gs_unit_extra_left + gs_frame_oversize, htpsHeight, -comy, 1330, gs_sidelight_width_left, 1+128
	hotspot -A/2 + gs_unit_extra_left + gs_frame_oversize-1, htpsHeight, -comy, 1331, gs_sidelight_width_left, 3
	hotspot -A/2 + gs_unit_extra_left + gs_frame_oversize+gs_sidelight_width_left, htpsHeight, -comy, 1332, gs_sidelight_width_left, 2

	if gs_bSidelight_fr_hdiv_left then
		hotspot -A/2 + gs_unit_extra_left + gs_frame_oversize, 0, -comy, 1370, gs_sidelight_fr_hdiv_hgt_left, 1+128
		hotspot -A/2 + gs_unit_extra_left + gs_frame_oversize, -1, -comy, 1371, gs_sidelight_fr_hdiv_hgt_left, 3
		hotspot -A/2 + gs_unit_extra_left + gs_frame_oversize, gs_sidelight_fr_hdiv_hgt_left, -comy, 1372, gs_sidelight_fr_hdiv_hgt_left, 2
	endif
	del 1
endif

!!! *** Hotspot Editing of Right SideLight

if gs_sidelight_right then
	addx Diff_extra
	hotspot A/2 - gs_unit_extra_right - gs_frame_oversize, 0, -comy, 1340, gs_sidelight_width_right, 1+128
	hotspot A/2 - gs_unit_extra_right - gs_frame_oversize+1, 0, -comy, 1341, gs_sidelight_width_right, 3
	hotspot A/2 - gs_unit_extra_right - gs_frame_oversize-gs_sidelight_width_right, 0, -comy, 1342, gs_sidelight_width_right, 2

	hotspot A/2 - gs_unit_extra_right - gs_frame_oversize, htpsHeight, -comy, 1350, gs_sidelight_width_right, 1+128
	hotspot A/2 - gs_unit_extra_right - gs_frame_oversize+1, htpsHeight, -comy, 1351, gs_sidelight_width_right, 3
	hotspot A/2 - gs_unit_extra_right - gs_frame_oversize-gs_sidelight_width_right, htpsHeight, -comy, 1352, gs_sidelight_width_right, 2

	if gs_bSidelight_fr_hdiv_right then
		hotspot A/2 - gs_unit_extra_right - gs_frame_oversize, 0, -comy, 1380, gs_sidelight_fr_hdiv_hgt_right, 1+128
		hotspot A/2 - gs_unit_extra_right - gs_frame_oversize, -1, -comy, 1381, gs_sidelight_fr_hdiv_hgt_right, 3
		hotspot A/2 - gs_unit_extra_right - gs_frame_oversize, gs_sidelight_fr_hdiv_hgt_right, -comy, 1382, gs_sidelight_fr_hdiv_hgt_right, 2
	endif
	del 1
endif

!***********************************************************

if bArchedTop & not(gs_door_transom) then
	if	gs_frame_style_m = FRAME_STYLE_SIMPLE_REBATE		|\
 		gs_frame_style_m = FRAME_STYLE_EXTRUSION			|\
		gs_frame_style_m = FRAME_STYLE_WRAPPED_EXTRUSION	then
		rebateWidth = gs_rebate_width
	else
		rebateWidth = offsetEPS
	endif
else
	if bSimpleOrCHIModel then
		rebateWidth = offsetEPS
	else
		if gs_optype_m_02 = SASH_FIXED then
			rebateWidth = offsetEPS
		else
			if bNoRebate_02 then
				rebateWidth = offsetEPS
			else
				rebateWidth = gs_sidelight_rebate_width
			endif
		endif
	endif
endif

if gs_LeftMullion_Top then
	trans_Left = -A/2+gs_sl_w1-rebateWidth+offset_02
else
	trans_Left = -A/2+gs_frw1-rebateWidth+offset_02
endif

if gs_RightMullion_Top then
	trans_Right = A/2-gs_sl_w2+rebateWidth-offset_02
else
	trans_Right = A/2-gs_frw2+rebateWidth-offset_02
endif

!********************* coordinates according to size types

unitleft	= -ac_unit_width / 2
unitright	=  ac_unit_width / 2
leafleft	= -ac_leaf_width / 2 + ((gs_sl_w1 - gs_frw1) / 2)*gs_sidelight_left - ((gs_sl_w2 - gs_frw2) / 2)*gs_sidelight_right
leafright	=  ac_leaf_width / 2 + ((gs_sl_w1 - gs_frw1) / 2)*gs_sidelight_left - ((gs_sl_w2 - gs_frw2) / 2)*gs_sidelight_right
frameDiff	= (gs_frw1 - gs_frw2) / 2
egressDiff 	= (gs_sliding_fixpanel_width_left-gs_sliding_fixpanel_width_right)/2

if gs_pivotdoor then
	egressleft = -ac_unit_width / 2 + gs_frw1 - frameDiff
	egressright = ac_unit_width / 2 - gs_frw2 - gs_pivotOffset - gs_leaf_thk/2 - frameDiff
else
	egressleft = -ac_egress_width / 2 + ((gs_sl_w1 - gs_frw1) / 2)*gs_sidelight_left - ((gs_sl_w2 - gs_frw2) / 2)*gs_sidelight_right + egressDiff
	egressright = ac_egress_width / 2 + ((gs_sl_w1 - gs_frw1) / 2)*gs_sidelight_left - ((gs_sl_w2 - gs_frw2) / 2)*gs_sidelight_right + egressDiff
endif

unittop = ac_unit_height
leaftop = ac_leaf_height

frameleft = unitleft - cutDxLeft * not(bEnableJointMat)
frameright = unitright + cutDxRight * not(bEnableJointMat)
frametop = unittop + cutDy * not(bEnableJointMat)

if gs_frame_style_m = FRAME_STYLE_WRAPPED_EXTRUSION then
	ace = frameright + gs_tolerance_left - gs_frame_oversize
	bce = frametop + gs_tolerance_left - gs_frame_oversize - gs_shoulder_h

	if bce > EPS then
		r2=(ace^2+bce^2)/(2*bce)
		fce=sqr(r2^2-ace^2)
		fce_frame_oversize	= sqr((r2 - gs_tolerance_left + gs_frame_oversize)^2 - (ace - gs_tolerance_left + gs_frame_oversize)^2)
		gs_shoulder_h = gs_shoulder_h - (fce - fce_frame_oversize)
	endif

	gs_tolerance_left			= 0
	gs_tolerance_left_2			= 0
	gs_tolerance_low_left_sl	= 0
	gs_tolerance_right 			= 0
	gs_tolerance_right_2		= 0
	gs_tolerance_low_right_sl	= 0
endif

!! CURVED TOP CALCULATION !!
ace = frameright
bce = frametop-gs_shoulder_h

if bce > EPS then
	r2=(ace^2+bce^2)/(2*bce)
	if abs(ace/r2) > (1 - EPS) then r2=r2+0.0000001

	alphace=2*asn(ace/r2)
	alphafw=2*asn((ace-gs_frw2-gs_tolerance_left)/(r2-gs_frw2-gs_tolerance_left))

	fce=sqr(r2^2-ace^2)
	if gs_door_transom then
		fcefw=sqr((r2-gs_frw2-gs_tolerance_left-offset_02)^2-(ace-gs_frw2-gs_tolerance_left-offset_02)^2)
		fce_Sl_rebate=sqr((r2-gs_frw2+rebateWidth-gs_tolerance_left-offset_02)^2-(ace-gs_frw2+rebateWidth-gs_tolerance_left-offset_02)^2)
	else
		fcefw=sqr((r2-gs_frw2-gs_tolerance_left-offset_leaf)^2-(ace-gs_frw2-gs_tolerance_left-offset_leaf)^2)
		fce_Sl_rebate=sqr((r2-gs_frw2+rebateWidth-gs_tolerance_left-offset_leaf)^2-(ace-gs_frw2+rebateWidth-gs_tolerance_left-offset_leaf)^2)
	endif

	fce_frame_rebate	= sqr((r2 - frameRebateWidth - gs_tolerance_left)^2 - (ace - frameRebateWidth - gs_tolerance_left)^2)
	fce_frame_toler		= sqr((r2 - gs_tolerance_left)^2 - (ace - gs_tolerance_left)^2)
	fceds	= sqr((r2-gs_frw2-gs_ds_w)^2-(ace-gs_frw2-gs_ds_w)^2)
	fcerel	= sqr((r2-gs_frw2+gs_rebate_width)^2-(ace-gs_frw2+gs_rebate_width)^2)

	alphads=2*asn((ace)/(r2))
	alpharel=2*asn((ace)/(r2))
	alpha_Sl_rebate = 2*asn((ace-gs_frw2+rebateWidth-gs_tolerance_left-offset_02)/(r2-gs_frw2+rebateWidth-gs_tolerance_left-offset_02))
else
	bArchedTop = 0
endif

if bArchedTop then
	TopHeighty = gs_shoulder_h
	TopHeightInny = gs_shoulder_h-(fce-fcefw)
else
	if gs_SashText_typ_num = 1 then		!Mitered Joint
		TopHeighty = b + cutDy
		TopHeightInny = unittop-gs_frwt
	else
		TopHeighty = unittop-gs_frwt
		TopHeightInny = unittop-gs_frwt
	endif
endif


!! END OF CURVED TOP CALCULATION !!



if bArchedTop then
	if not(gs_door_transom) then
		if gs_frame_style_m = FRAME_STYLE_BLOCK			then egresstop = gs_shoulder_h-(fce-fcefw)
		if gs_frame_style_m = FRAME_STYLE_DOUBLE_REBATE	then egresstop = gs_shoulder_h-(fce-fceds)
		if	gs_frame_style_m = FRAME_STYLE_SIMPLE_REBATE		|\
	 		gs_frame_style_m = FRAME_STYLE_EXTRUSION			|\
			gs_frame_style_m = FRAME_STYLE_WRAPPED_EXTRUSION	then
			egresstop = gs_shoulder_h-(fce-fcefw)
		endif
		if gs_frame_style_m = FRAME_STYLE_BLOCK			then leaftop = gs_shoulder_h-(fce-fcefw)
		if gs_frame_style_m = FRAME_STYLE_DOUBLE_REBATE	then leaftop = gs_shoulder_h-(fce-fcefw)
		if	gs_frame_style_m = FRAME_STYLE_SIMPLE_REBATE		|\
	 		gs_frame_style_m = FRAME_STYLE_EXTRUSION			|\
			gs_frame_style_m = FRAME_STYLE_WRAPPED_EXTRUSION	then
			leaftop = gs_shoulder_h-(fce-fcerel)
		endif
		egressarch = ac_egress_height
		leafarch = ac_leaf_height

	else
		egresstop = ac_egress_height
		leaftop = ac_leaf_height
		egressarch = ac_egress_height
		leafarch = ac_leaf_height
	endif
else
	egresstop = ac_egress_height
endif

bTolL = 1 * (abs(gs_tolerance_left) < EPS)
bTolR = 1 * (abs(gs_tolerance_right) < EPS)
bTolU = 1 * (abs(gs_tolerance_upper) < EPS)

ovhg			= max(gs_frame_ovhg_bottom_out, gs_frame_ovhg_bottom_in)
ovhgBottom		= ovhg * gs_sill_outside
if LeftSLParapet > EPS then
	ovhgBottomLeft	= ovhg * gs_sill_outside_sl_left
else
	ovhgBottomLeft	= 0
	gs_tolerance_low_left_sl = 0
endif
if RightSLParapet > EPS then
	ovhgBottomRight	= ovhg * gs_sill_outside_sl_right
else
	ovhgBottomRight	= 0
	gs_tolerance_low_right_sl = 0
endif


! ------------------------------------------------------------------------------
! Egress hotspots
! ------------------------------------------------------------------------------

if gs_usaframe then
	egressthk1 = -comy
	if gs_frame_style_m = FRAME_STYLE_DOUBLE_REBATE | gs_frame_style_m = FRAME_STYLE_METAL then
		egressthk1 = egressthk1 + gs_ds_pr
	endif
	if gs_frame_style_m = FRAME_STYLE_SIMPLE_REBATE then
		egressthk1 = egressthk1 + gs_leaf_thk
	endif
else
	egressthk1 = gs_leaf_thk - comy
endif
egressthk2 = egressthk1 + gs_ds_thk

if bShowEgressHotspots then
	addx -Diff_extra/2
	if gs_frame_style_m = FRAME_STYLE_BLOCK then
		hotspot egressleft  + frameDiff, egresstop, 0, 210
		hotspot egressright + frameDiff, egresstop, 0, 211
		if not(gs_door_transom) & bArchedTop then hotspot 0, egressarch, 0, 214
	else
		hotspot egressleft  + frameDiff, egresstop, egressthk1, 210
		hotspot egressright + frameDiff, egresstop, egressthk1, 211
		if not(gs_door_transom) & bArchedTop then hotspot 0, egressarch, egressthk1, 214
	endif

	if gs_frame_style_m = FRAME_STYLE_DOUBLE_REBATE | gs_frame_style_m = FRAME_STYLE_METAL then
		hotspot egressleft  + frameDiff, egresstop, egressthk2, 212
		hotspot egressright + frameDiff, egresstop, egressthk2, 213
		if not(gs_door_transom) & bArchedTop then hotspot 0, egressarch, egressthk2, 215
	else
		hotspot egressleft + frameDiff, egresstop, outsideFrameThk, 212
		hotspot egressright + frameDiff, egresstop, outsideFrameThk, 213
		if not(gs_door_transom) & bArchedTop then hotspot 0, egressarch, outsideFrameThk, 215
	endif

	del 1
endif

if bShowAddHotspotsForIS then
	addx -Diff_extra/2
	if bArchedTop then
		if not(gs_door_transom) then
			if gs_frame_style_m = FRAME_STYLE_BLOCK then
				hotspot 0, 0, 0, 204
			else
				hotspot 0, 0, egressthk1, 204
			endif

			if gs_frame_style_m = FRAME_STYLE_DOUBLE_REBATE | gs_frame_style_m = FRAME_STYLE_METAL then
				hotspot 0, 0, egressthk2, 205
			else
				hotspot 0, 0, outsideFrameThk, 205
			endif
		else
			if gs_frame_style_m = FRAME_STYLE_BLOCK then
				hotspot egressleft  + frameDiff, 0, 0, 200
				hotspot egressright + frameDiff, 0, 0, 201
			else
				hotspot egressleft  + frameDiff, 0, egressthk1, 200
				hotspot egressright + frameDiff, 0, egressthk1, 201
			endif

			if gs_frame_style_m = FRAME_STYLE_DOUBLE_REBATE | gs_frame_style_m = FRAME_STYLE_METAL then
				hotspot egressleft  + frameDiff, 0, egressthk2, 202
				hotspot egressright + frameDiff, 0, egressthk2, 203
			else
				hotspot egressleft  + frameDiff, 0, outsideFrameThk, 202
				hotspot egressright + frameDiff, 0, outsideFrameThk, 203
			endif
		endif
	else
		if gs_frame_style_m = FRAME_STYLE_BLOCK then
			hotspot egressleft  + frameDiff, 0, 0, 200
			hotspot egressright + frameDiff, 0, 0, 201
		else
			hotspot egressleft  + frameDiff, 0, egressthk1, 200
			hotspot egressright + frameDiff, 0, egressthk1, 201
		endif

		if gs_frame_style_m = FRAME_STYLE_DOUBLE_REBATE | gs_frame_style_m = FRAME_STYLE_METAL then
			hotspot egressleft  + frameDiff, 0, egressthk2, 202
			hotspot egressright + frameDiff, 0, egressthk2, 203
		else
			hotspot egressleft  + frameDiff, 0, outsideFrameThk, 202
			hotspot egressright + frameDiff, 0, outsideFrameThk, 203
		endif
	endif
	del 1
endif


! ------------------------------------------------------------------------------
! Leaf hotspots
! ------------------------------------------------------------------------------

leafthk1=gs_leaf_thk
leafleft1=leafleft
leafright1=leafright

if bShowLeafHotspots then
	if	gs_frame_style_m = FRAME_STYLE_SIMPLE_REBATE |\
		gs_frame_style_m = FRAME_STYLE_EXTRUSION |\
		gs_frame_style_m = FRAME_STYLE_WRAPPED_EXTRUSION then
		hotspot leafleft1  + frameDiff, leaftop, 0, 310
		hotspot leafright1 + frameDiff, leaftop, 0, 311
		hotspot leafleft1  + frameDiff, leaftop, gs_leaf_thk, 312
		hotspot leafright1 + frameDiff, leaftop, gs_leaf_thk, 313
		if not(gs_door_transom) & bArchedTop then
			hotspot 0, leafarch, 0, 314
			hotspot 0, leafarch, gs_leaf_thk, 315
		endif
	else
		hotspot leafleft  + frameDiff, leaftop, -comy, 310
		hotspot leafright + frameDiff, leaftop, -comy, 311
		hotspot leafleft  + frameDiff, leaftop, outsideFrameThk + comy, 312
		hotspot leafright + frameDiff, leaftop, outsideFrameThk + comy, 313
		if not(gs_door_transom) & bArchedTop then
			hotspot 0, leafarch, -comy, 314
			hotspot 0, leafarch, outsideFrameThk + comy, 315
		endif
	endif
endif

if bShowAddHotspotsForIS then
	if bArchedTop then
		if not(gs_door_transom) then
			if	gs_frame_style_m = FRAME_STYLE_SIMPLE_REBATE |\
				gs_frame_style_m = FRAME_STYLE_EXTRUSION  |\
				gs_frame_style_m = FRAME_STYLE_WRAPPED_EXTRUSION then
				hotspot 0, 0, 0, 304
				hotspot 0, 0, gs_leaf_thk, 305
			else
				hotspot 0, 0, -comy, 304
				hotspot 0, 0, outsideFrameThk + comy, 305
			endif
		else
			if	gs_frame_style_m = FRAME_STYLE_SIMPLE_REBATE |\
				gs_frame_style_m = FRAME_STYLE_EXTRUSION  |\
				gs_frame_style_m = FRAME_STYLE_WRAPPED_EXTRUSION then
				hotspot leafleft1  + frameDiff, 0, 0, 300
				hotspot leafright1 + frameDiff, 0, 0, 301
				hotspot leafleft1  + frameDiff, 0, gs_leaf_thk, 302
				hotspot leafright1 + frameDiff, 0, gs_leaf_thk, 303
			else
				hotspot leafleft  + frameDiff, 0, -comy, 300
				hotspot leafright + frameDiff, 0, -comy, 301
				hotspot leafleft  + frameDiff, 0, outsideFrameThk + comy, 302
				hotspot leafright + frameDiff, 0, outsideFrameThk + comy, 303
			endif
		endif
	else
		if	gs_frame_style_m = FRAME_STYLE_SIMPLE_REBATE |\
			gs_frame_style_m = FRAME_STYLE_EXTRUSION  |\
			gs_frame_style_m = FRAME_STYLE_WRAPPED_EXTRUSION then
			hotspot leafleft1  + frameDiff, 0, 0, 300
			hotspot leafright1 + frameDiff, 0, 0, 301
			hotspot leafleft1  + frameDiff, 0, gs_leaf_thk, 302
			hotspot leafright1 + frameDiff, 0, gs_leaf_thk, 303
		else
			hotspot leafleft  + frameDiff, 0, -comy, 300
			hotspot leafright + frameDiff, 0, -comy, 301
			hotspot leafleft  + frameDiff, 0, outsideFrameThk + comy, 302
			hotspot leafright + frameDiff, 0, outsideFrameThk + comy, 303
		endif
	endif
endif


! ------------------------------------------------------------------------------
! Sidelight and Transom rebate
! ------------------------------------------------------------------------------

if not(gs_sidelight_left | gs_sidelight_right | gs_door_transom) then
	gs_opening_dir_SL_m = 1
	gs_sidelight_rebate_depth = gs_leaf_thk - EPS
endif

if gs_opening_dir_SL_m = 1 then
	Sl_Tr_op_depth = 0
	Sl_Tr_cutDir = -1

	bMirrored = WIDO_REVEAL_SIDE

	if bMirrored then
		matLeafRange_Leaf	= gs_frame_mat2
		matLeafRange_Sash	= gs_frame_mat
		matSashRange_Leaf	= gs_frame_mat
		matSashRange_Sash	= gs_frame_mat

		matSashRebate	= gs_frame_mat2
		matSashOpposite	= gs_frame_mat
		matLeafRebate	= gs_frame_mat2
		matLeafOpposite	= gs_frame_mat
	else
		matLeafRange_Leaf	= gs_frame_mat
		matLeafRange_Sash	= gs_frame_mat2
		matSashRange_Leaf	= gs_frame_mat2
		matSashRange_Sash	= gs_frame_mat2

		matSashRebate	= gs_frame_mat
		matSashOpposite	= gs_frame_mat2
		matLeafRebate	= gs_frame_mat
		matLeafOpposite	= gs_frame_mat2
	endif
else
	Sl_Tr_op_depth = insideFrameThk
	Sl_Tr_cutDir = 1

	bMirroredLeaf = WIDO_REVEAL_SIDE
	bMirroredSash = (WIDO_REVEAL_SIDE & gs_opening_dir_SL_m = 1) | (not(WIDO_REVEAL_SIDE) & gs_opening_dir_SL_m = 2)

	if bMirroredLeaf then
		matLeafRange_Leaf	= gs_frame_mat2
		matSashRange_Leaf	= gs_frame_mat

		matLeafRebate	= gs_frame_mat2
		matLeafOpposite = gs_frame_mat
	else
		matLeafRange_Leaf	= gs_frame_mat
		matSashRange_Leaf	= gs_frame_mat2

		matLeafRebate	= gs_frame_mat
		matLeafOpposite = gs_frame_mat2
	endif

	if bMirroredSash then
		matLeafRange_Sash	= gs_frame_mat
		matSashRange_Sash	= gs_frame_mat

		matSashRebate	= gs_frame_mat2
		matSashOpposite	= gs_frame_mat
	else
		matLeafRange_Sash	= gs_frame_mat2
		matSashRange_Sash	= gs_frame_mat2

		matSashRebate	= gs_frame_mat
		matSashOpposite	= gs_frame_mat2
	endif
endif

if gs_pocket_door_frame then
	LeafRebate = posLeafy + widthWallCut/2
else
	if bEnableLeafRebateDepth3D then
		LeafRebate = gs_rebate_depth_3D
	else
		LeafRebate = gs_leaf_thk
	endif
endif


if gs_frame_style_m <> FRAME_STYLE_METAL & gs_frame_style_m <> FRAME_STYLE_DOUBLE_EGRESS_METAL then

	horizDivLeftSideLeftUpperPX		= -A/2+gs_frw1+offset_09
	horizDivLeftSideLeftLowerPX		= -A/2+gs_frw1+offset_11
	horizDivLeftSideRightUpperPX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_09
	horizDivLeftSideRightLowerPX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_11
	horizDivLeftSideUpperPY			= gs_sidelight_fr_hdiv_hgt_left + gs_sidelight_fr_hdiv_wdt_left + offset_09
	horizDivLeftSideLowerPY			= gs_sidelight_fr_hdiv_hgt_left - offset_11

	horizDivRightSideLeftUpperPX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_05
	horizDivRightSideLeftLowerPX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_07
	horizDivRightSideRightUpperPX	= A/2-gs_frw2-offset_05
	horizDivRightSideRightLowerPX	= A/2-gs_frw2-offset_07
	horizDivRightSideUpperPY		= gs_sidelight_fr_hdiv_hgt_right + gs_sidelight_fr_hdiv_wdt_right + offset_05
	horizDivRightSideLowerPY		= gs_sidelight_fr_hdiv_hgt_right - offset_07

	if gs_door_transom then

! =============================================================================
! Frame WITH Transom
! =============================================================================

		!*** lh = bottom edge of transom, NOT leaf height in style 3

		lh = B - _transomHeight

! Door Stop -------------------------------------------------------------------

		if gs_frame_style_m = FRAME_STYLE_DOUBLE_REBATE & lod3D > 1 then

			addz LeafRebate*(abs(gs_ds_pr)<eps)+gs_ds_pr*(abs(gs_ds_pr)>eps)

			if gs_SashText_typ_num = 1 then

				base

				cprism_ topmat, botmat, sidemat,
					4, gs_ds_thk,
					-A/2+gs_sl_w1, 0, 15,
					-A/2+gs_sl_w1, lh, 10,
					-A/2+gs_sl_w1+gs_ds_w, lh-gs_ds_w, 13,
					-A/2+gs_sl_w1+gs_ds_w,0,15

				gosub 500

				cprism_ topmat, botmat, sidemat,
					4, gs_ds_thk,
					A/2-gs_sl_w2, 0, 15,
					A/2-gs_sl_w2, lh, 10,
					A/2-gs_sl_w2-gs_ds_w, lh-gs_ds_w, 13,
					A/2-gs_sl_w2-gs_ds_w, 0,15

				gosub 500

				if gs_mf then
					cprism_ topmat, botmat, sidemat,
						4, gs_ds_thk,
						A/2-gs_mf_pos-gs_mf_w/2-gs_ds_w, 0, 	15,
						A/2-gs_mf_pos-gs_mf_w/2-gs_ds_w, lh-gs_ds_w,	10,
						A/2-gs_mf_pos-gs_mf_w/2,	lh,	15,
						A/2-gs_mf_pos-gs_mf_w/2,	0,	15
					body 1

					cprism_ topmat, botmat, sidemat,
						4, gs_ds_thk,
						A/2-gs_mf_pos+gs_mf_w/2+gs_ds_w, 0, 	15,
						A/2-gs_mf_pos+gs_mf_w/2+gs_ds_w, lh-gs_ds_w,	10,
						A/2-gs_mf_pos+gs_mf_w/2,	lh,	15,
						A/2-gs_mf_pos+gs_mf_w/2,	0,	15

					gosub 500
				endif

				if gs_mf then
					cprism_ topmat, botmat, sidemat,
						4, gs_ds_thk,
						-A/2+gs_sl_w1, lh, 10,
						-A/2+gs_sl_w1+gs_ds_w, lh-gs_ds_w, 15,
						A/2-gs_mf_pos-gs_mf_w/2-gs_ds_w, lh-gs_ds_w, 10,
						A/2-gs_mf_pos-gs_mf_w/2, lh,15
					body 1

					cprism_ topmat, botmat, sidemat,
						4, gs_ds_thk,
						A/2-gs_mf_pos+gs_mf_w/2, lh, 10,
						A/2-gs_mf_pos+gs_mf_w/2+gs_ds_w, lh-gs_ds_w, 15,
						A/2-gs_sl_w2-gs_ds_w, lh-gs_ds_w, 10,
						A/2-gs_sl_w2, lh,15
				else
					cprism_ topmat, botmat, sidemat,
						4, gs_ds_thk,
						-A/2+gs_sl_w1, lh, 10,
						-A/2+gs_sl_w1+gs_ds_w, lh-gs_ds_w, 15,
						 A/2-gs_sl_w2-gs_ds_w, lh-gs_ds_w, 10,
						 A/2-gs_sl_w2, lh,15
				endif

				gosub 600

			endif

			if gs_SashText_typ_num = 2 then		! Butt Joint

				base

				cprism_ topmat, botmat, sidemat,
					4, gs_ds_thk,
					-A/2+gs_sl_w1, 0, 15,
					-A/2+gs_sl_w1, lh-gs_ds_w, 10,
					-A/2+gs_sl_w1+gs_ds_w, lh-gs_ds_w, 13,
					-A/2+gs_sl_w1+gs_ds_w, 0, 15

				gosub 500

				cprism_ topmat, botmat, sidemat,
					4, gs_ds_thk,
					A/2-gs_sl_w2, 0, 15,
					A/2-gs_sl_w2, lh-gs_ds_w, 10,
					A/2-gs_sl_w2-gs_ds_w, lh-gs_ds_w, 13,
					A/2-gs_sl_w2-gs_ds_w, 0,15

				gosub 500

				if gs_mf then
					cprism_ topmat, botmat, sidemat,
						4, gs_ds_thk,
						A/2-gs_mf_pos-gs_mf_w/2-gs_ds_w, 0, 	15,
						A/2-gs_mf_pos-gs_mf_w/2-gs_ds_w, lh-gs_ds_w,	10,
						A/2-gs_mf_pos-gs_mf_w/2,	lh-gs_ds_w,	15,
						A/2-gs_mf_pos-gs_mf_w/2,	0,	15
					body 1

					cprism_ topmat, botmat, sidemat,
						4, gs_ds_thk,
						A/2-gs_mf_pos+gs_mf_w/2+gs_ds_w, 0, 	15,
						A/2-gs_mf_pos+gs_mf_w/2+gs_ds_w, lh-gs_ds_w,	10,
						A/2-gs_mf_pos+gs_mf_w/2,	lh-gs_ds_w,	15,
						A/2-gs_mf_pos+gs_mf_w/2,	0,	15

					gosub 500
				endif

				if gs_mf then
					cprism_ topmat, botmat, sidemat,
						6, gs_ds_thk,
						-A/2+gs_sl_w1, lh, 15,
						-A/2+gs_sl_w1, lh-gs_ds_w,8,
						-A/2+gs_sl_w1+gs_ds_w, lh-gs_ds_w, 15,
						A/2-gs_mf_pos-gs_mf_w/2-gs_ds_w, lh-gs_ds_w, 10,
						A/2-gs_mf_pos-gs_mf_w/2, lh-gs_ds_w,13,
						A/2-gs_mf_pos-gs_mf_w/2, lh,15
					body 1

					cprism_ topmat, botmat, sidemat,
						6, gs_ds_thk,
						A/2-gs_mf_pos+gs_mf_w/2, lh, 15,
						A/2-gs_mf_pos+gs_mf_w/2, lh-gs_ds_w,8,
						A/2-gs_mf_pos+gs_mf_w/2+gs_ds_w, lh-gs_ds_w, 15,
						A/2-gs_sl_w2-gs_ds_w, lh-gs_ds_w, 10,
						A/2-gs_sl_w2, lh-gs_ds_w,13,
						A/2-gs_sl_w2, lh,15
				else
					cprism_ topmat, botmat, sidemat,
						6, gs_ds_thk,
						-A/2+gs_sl_w1, lh, 15,
						-A/2+gs_sl_w1, lh-gs_ds_w,8,
						-A/2+gs_sl_w1+gs_ds_w, lh-gs_ds_w, 15,
						 A/2-gs_sl_w2-gs_ds_w, lh-gs_ds_w, 10,
						 A/2-gs_sl_w2, lh-gs_ds_w,13,
						 A/2-gs_sl_w2, lh,15
				endif

			endif

			body -1
			del 1

		endif

! Extrusion Frame Rebate ---------------------------------------------------

		if	gs_frame_style_m = FRAME_STYLE_EXTRUSION |\
			gs_frame_style_m = FRAME_STYLE_WRAPPED_EXTRUSION then
			material gs_frame_mat

			gosub "Metal Frame Rebate"
		endif

! Leaf Rebate -----------------------------------------------------------------
		if	(not(bUniformMaterials) & gs_frame_style_m = FRAME_STYLE_DOUBLE_REBATE & not(bSimpleOrCHIModel)) |\
			(gs_frame_style_m = FRAME_STYLE_SIMPLE_REBATE) |\
			(gs_frame_style_m = FRAME_STYLE_EXTRUSION) |\
			(gs_frame_style_m = FRAME_STYLE_WRAPPED_EXTRUSION) then

			bDoubleCut = (gs_frame_style_m = FRAME_STYLE_DOUBLE_REBATE)
			if	gs_frame_style_m = FRAME_STYLE_SIMPLE_REBATE		|\
				gs_frame_style_m = FRAME_STYLE_EXTRUSION			|\
				gs_frame_style_m = FRAME_STYLE_WRAPPED_EXTRUSION	then
				rebateWidth = gs_rebate_width
			else
				rebateWidth = offsetEPS
			endif

			addz LeafRebate

			if gs_mf then
				material matLeafRebate
				cutform 4, 1, 2 + 16,
					 0, 0, 1, 0,
					A/2-gs_mf_pos+gs_mf_w/2-rebateWidth+offset_leaf,	0,													31,
					A/2-gs_mf_pos+gs_mf_w/2-rebateWidth+offset_leaf,	B-_transomHeight+rebateWidth-offset_leaf,	31,
					A/2-gs_sl_w2+rebateWidth-offset_leaf,				B-_transomHeight+rebateWidth-offset_leaf,	31,
					A/2-gs_sl_w2+rebateWidth-offset_leaf,				0,													31

				cutform 4, 1, 2 + 16,
					 0, 0, 1, 0,
					-A/2+gs_sl_w1-rebateWidth+offset_leaf,				0,													31,
					-A/2+gs_sl_w1-rebateWidth+offset_leaf,				B-_transomHeight+rebateWidth-offset_leaf,	31,
					 A/2-gs_mf_pos-gs_mf_w/2+rebateWidth-offset_leaf,	B-_transomHeight+rebateWidth-offset_leaf,	31,
					 A/2-gs_mf_pos-gs_mf_w/2+rebateWidth-offset_leaf,	0,													31

				if bDoubleCut then
					material matLeafOpposite
					cutform 4, 1, 2 + 16,
						 0, 0, -1, 0,
						A/2-gs_mf_pos+gs_mf_w/2-rebateWidth+offset_leaf,	0,													31,
						A/2-gs_mf_pos+gs_mf_w/2-rebateWidth+offset_leaf,	B-_transomHeight+rebateWidth-offset_leaf,	31,
						A/2-gs_sl_w2+rebateWidth-offset_leaf,				B-_transomHeight+rebateWidth-offset_leaf,	31,
						A/2-gs_sl_w2+rebateWidth-offset_leaf,				0,													31

					cutform 4, 1, 2 + 16,
						 0, 0, -1, 0,
						-A/2+gs_sl_w1-rebateWidth+offset_leaf,				0,													31,
						-A/2+gs_sl_w1-rebateWidth+offset_leaf,				B-_transomHeight+rebateWidth-offset_leaf,	31,
						 A/2-gs_mf_pos-gs_mf_w/2+rebateWidth-offset_leaf,	B-_transomHeight+rebateWidth-offset_leaf,	31,
						 A/2-gs_mf_pos-gs_mf_w/2+rebateWidth-offset_leaf,	0,													31
				endif
				numCuts = numCuts + 2 + 2 * bDoubleCut
			else
				material matLeafRebate
				cutform 4, 1, 2 + 16,
					 0, 0, 1, 0,
					-A/2+gs_sl_w1-rebateWidth+offset_leaf,	0,													31,
					-A/2+gs_sl_w1-rebateWidth+offset_leaf,	B-_transomHeight+rebateWidth-offset_leaf,	31,
					 A/2-gs_sl_w2+rebateWidth-offset_leaf,	B-_transomHeight+rebateWidth-offset_leaf,	31,
					 A/2-gs_sl_w2+rebateWidth-offset_leaf,	0,													31

				if bDoubleCut then
					material matLeafOpposite
					cutform 4, 1, 2 + 16,
						 0, 0, -1, 0,
						-A/2+gs_sl_w1-rebateWidth+offset_leaf,	0,													31,
						-A/2+gs_sl_w1-rebateWidth+offset_leaf,	B-_transomHeight+rebateWidth-offset_leaf,	31,
						 A/2-gs_sl_w2+rebateWidth-offset_leaf,	B-_transomHeight+rebateWidth-offset_leaf,	31,
						 A/2-gs_sl_w2+rebateWidth-offset_leaf,	0,													31
				endif
				numCuts = numCuts + 1 + bDoubleCut
			endif

			del 1

		endif

! Sidelight and Transom Rebate ------------------------------------------------

		if (lod3D > 1) | not(bUniformMaterials) then
			addz Sl_Tr_op_depth
			mulz Sl_Tr_cutDir

			! Transom
			if bArchedTop then
				if not(bUniformMaterials) | (not(bNoRebate_02) & not(bSimpleOrCHIModel)) then
					bDoubleCut = (bNoRebate_02 | bSimpleOrCHIModel)
					if bSimpleOrCHIModel then
						if iMullionStyle_02 = MULLION_SOLID_PANEL then
							cutDepth = gs_sash_thk
						else
							cutDepth = (insideFrameThk + gs_glass_thk) / 2
						endif
						rebateWidth = offsetEPS
					else
						if gs_optype_m_02 = SASH_FIXED then
							cutDepth = gs_sidelight_rebate_depth + gs_glass_thk / 2
							rebateWidth = offsetEPS
						else
							if bNoRebate_02 then
								cutDepth = min(gs_sash_thk, gs_frame_thk / 2)
								rebateWidth = offsetEPS
							else
								cutDepth = gs_sidelight_rebate_depth
								rebateWidth = gs_sidelight_rebate_width
								if rebateWidth < EPS then cutDepth = 0
							endif
						endif
					endif
					if cutDepth > EPS then
						addz -cutDepth
						material matSashRebate
						cutform 7, 1, 2 + 16,
							0, 0, -1, 0,
							trans_Left, B-_transomHeight+gs_frame_width_transom-rebateWidth+offset_02, 15+16+32,
							trans_Left, gs_shoulder_h-(fce-fce_Sl_rebate)-0.0001, 15+16,
							trans_Left, gs_shoulder_h-(fce-fce_Sl_rebate), 15+16+64,
							0, frametop - r2, 900+15+16+32,
							0, B-gs_frwt+rebateWidth, 3000+15+16+64,
							trans_Right, gs_shoulder_h-(fce-fce_Sl_rebate), 3000+15+16+32,
							trans_Right, B-_transomHeight+gs_frame_width_transom-rebateWidth+offset_02, 15+16+32
						if bDoubleCut then
							material matSashOpposite
							cutform 7, 1, 2 + 16,
								0, 0, 1, 0,
								trans_Left, B-_transomHeight+gs_frame_width_transom-rebateWidth+offset_02, 15+16+32,
								trans_Left, gs_shoulder_h-(fce-fce_Sl_rebate)-0.0001, 15+16,
								trans_Left, gs_shoulder_h-(fce-fce_Sl_rebate), 15+16+64,
								0, frametop - r2, 900+15+16+32,
								0, B-gs_frwt+rebateWidth, 3000+15+16+64,
								trans_Right, gs_shoulder_h-(fce-fce_Sl_rebate), 3000+15+16+32,
								trans_Right, B-_transomHeight+gs_frame_width_transom-rebateWidth+offset_02, 15+16+32
						endif
						numCuts = numCuts + 1 + bDoubleCut
						del 1
					endif
				endif
			else
				if gs_sidelight_left & gs_LeftMullion_Top then
					rebateCutShapeLeftPX = -A/2+gs_sl_w1+offset_02
				else
					rebateCutShapeLeftPX = -A/2+gs_frw1+offset_02
				endif
				if gs_sidelight_right & gs_RightMullion_Top then
					rebateCutShapeRightPX = A/2-gs_sl_w2-offset_02
				else
					rebateCutShapeRightPX = A/2-gs_frw2-offset_02
				endif
				rebateCutShapeTopPY		= B-gs_frwt-offset_02
				rebateCutShapeBottomPY	= B-_transomHeight+gs_frame_width_transom+offset_02
				sashWidthToRebateCut	= gs_sash_width
				gs_optype_m_i			= gs_optype_m_02
				bNoRebate_i				= bNoRebate_02
				iMullionStyle_i			= iMullionStyle_02
				iSimpleSashFrameType_i	= iSimpleSashFrameType_02
				offset_i				= offset_02

				gosub "Rectangular Rebate Cutting"
			endif

			if gs_sidelight_left then			! --- Left Sidelight Rebate

				rebateCutShapeLeftPX	= horizDivLeftSideLeftUpperPX
				rebateCutShapeRightPX	= horizDivLeftSideRightUpperPX
				if gs_Transom_toLeft then
					rebateCutShapeTopPY	= B - _transomHeight - offset_09
				else
					rebateCutShapeTopPY	= TopHeightInny - offset_09
				endif
				if gs_bSidelight_fr_hdiv_Left then
					rebateCutShapeBottomPY = horizDivLeftSideUpperPY
				else
					rebateCutShapeBottomPY = LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_09
				endif
				sashWidthToRebateCut	= gs_sl_sash_width
				gs_optype_m_i			= gs_optype_m_09
				bNoRebate_i				= bNoRebate_09
				iMullionStyle_i			= iMullionStyle_09
				iSimpleSashFrameType_i	= iSimpleSashFrameType_09
				offset_i				= offset_09

				gosub "Rectangular Rebate Cutting"

				if gs_bSidelight_fr_hdiv_left then			! --- Left Lower Sidelight Rebate

					rebateCutShapeLeftPX	= horizDivLeftSideLeftLowerPX
					rebateCutShapeRightPX	= horizDivLeftSideRightLowerPX
					rebateCutShapeTopPY		= horizDivLeftSideLowerPY
					rebateCutShapeBottomPY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_11
					sashWidthToRebateCut	= gs_sl_sash_width
					gs_optype_m_i			= gs_optype_m_11
					bNoRebate_i				= bNoRebate_11
					iMullionStyle_i			= iMullionStyle_11
					iSimpleSashFrameType_i	= iSimpleSashFrameType_11
					offset_i				= offset_11

					gosub "Rectangular Rebate Cutting"
				endif

				! --- Left Upper Sidelight Rebate

				if gs_Transom_toLeft & gs_LeftMullion_Top & (not(bUniformMaterials) | (not(bNoRebate_10) & not(bSimpleOrCHIModel))) then

					rebateCutShapeLeftPX	= -A/2+gs_frw1+offset_10
					rebateCutShapeRightPX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_10
					rebateCutShapeTopPY		= B-gs_frwt-offset_10
					rebateCutShapeBottomPY	= B-_transomHeight+gs_frame_width_transom+offset_10
					sashWidthToRebateCut	= gs_sash_width
					gs_optype_m_i			= gs_optype_m_10
					bNoRebate_i				= bNoRebate_10
					iMullionStyle_i			= iMullionStyle_10
					iSimpleSashFrameType_i	= iSimpleSashFrameType_10
					offset_i				= offset_10

					gosub "Rectangular Rebate Cutting"
				endif
			endif

			if gs_sidelight_right then			! --- Right Sidelight Rebate

				rebateCutShapeLeftPX	= horizDivRightSideLeftUpperPX
				rebateCutShapeRightPX	= horizDivRightSideRightUpperPX
				if gs_Transom_toRight then
					rebateCutShapeTopPY	= B - _transomHeight - offset_05
				else
					rebateCutShapeTopPY	= TopHeightInny - offset_05
				endif
				if gs_bSidelight_fr_hdiv_right then
					rebateCutShapeBottomPY = horizDivRightSideUpperPY
				else
					rebateCutShapeBottomPY = RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_05
				endif
				sashWidthToRebateCut	= gs_sl_sash_width
				gs_optype_m_i			= gs_optype_m_05
				bNoRebate_i				= bNoRebate_05
				iMullionStyle_i			= iMullionStyle_05
				iSimpleSashFrameType_i	= iSimpleSashFrameType_05
				offset_i				= offset_05

				gosub "Rectangular Rebate Cutting"

				if gs_bSidelight_fr_hdiv_right then			! --- Right Lower Sidelight Rebate

					rebateCutShapeLeftPX	= horizDivRightSideLeftLowerPX
					rebateCutShapeRightPX	= horizDivRightSideRightLowerPX
					rebateCutShapeTopPY		= horizDivRightSideLowerPY
					rebateCutShapeBottomPY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_07
					sashWidthToRebateCut	= gs_sl_sash_width
					gs_optype_m_i			= gs_optype_m_07
					bNoRebate_i				= bNoRebate_07
					iMullionStyle_i			= iMullionStyle_07
					iSimpleSashFrameType_i	= iSimpleSashFrameType_07
					offset_i				= offset_07

					gosub "Rectangular Rebate Cutting"
				endif

				! --- Right Upper Sidelight Rebate

				if gs_Transom_toRight & gs_RightMullion_Top & (not(bUniformMaterials) | (not(bNoRebate_06) & not(bSimpleOrCHIModel)) ) then

					rebateCutShapeLeftPX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_06
					rebateCutShapeRightPX	= A/2-gs_frw2-offset_06
					rebateCutShapeTopPY		= B-gs_frwt-offset_06
					rebateCutShapeBottomPY	= B-_transomHeight+gs_frame_width_transom+offset_06
					sashWidthToRebateCut	= gs_sash_width
					gs_optype_m_i			= gs_optype_m_06
					bNoRebate_i				= bNoRebate_06
					iMullionStyle_i			= iMullionStyle_06
					iSimpleSashFrameType_i	= iSimpleSashFrameType_06
					offset_i				= offset_06

					gosub "Rectangular Rebate Cutting"
				endif
			endif
			del 2
		endif

! USA Middle Frame ------------------------------------------------------------

		if gs_mf then
			add A/2-gs_mf_pos, 0, 0
			cprism_ topmat, botmat, sidemat,
				4, outsideFrameThk,
				-gs_mf_w/2-offset_leaf, 0, 	15,
				-gs_mf_w/2-offset_leaf, B-_transomHeight-offset_leaf,	10,
				 gs_mf_w/2+offset_leaf,	B-_transomHeight-offset_leaf,	15,
				 gs_mf_w/2+offset_leaf,	0,	15

			gosub 500
			del 1
		endif

! -----------------------------------------------------------------------------

		base

n = 1
		for i=1 to n

			framethick1	= outsideFrameThk
			framethick2	= insideFrameThk
			frameThickOffset = 0

			mat1=topmat
			mat2=sidemat

			if not(WIDO_REVEAL_SIDE) then
				matLeaf = gs_frame_mat2
			else
				matLeaf = gs_frame_mat
			endif

			if gs_opening_dir_SL_m = 1 exor WIDO_REVEAL_SIDE then
				matSash = gs_frame_mat2
			else
				matSash = gs_frame_mat
			endif

			mask1 = 15
			mask2 = 13
			mask3 = 15

			bExtraPrismOnLeftSide		= 0
			bExtraPrismOnLeftSideTop	= 0
			bExtraPrismOnRightSide		= 0
			bExtraPrismOnRightSideTop	= 0
			bDiffFrameThk = (abs(framethick1-framethick2) > EPS)

			bNoExtraPrismOnTop = (bDiffFrameThk & (lod3D = 1) & not(offset_02 > EPS))
			if gs_sidelight_left & gs_LeftMullion_Top then
				if gs_Transom_toLeft then
					iSimpleSashFrameTypeL = iSimpleSashFrameType_10
					offset_L = offset_10
				else
					iSimpleSashFrameTypeL = iSimpleSashFrameType_09
					offset_L = offset_09
				endif
				bNoExtraPrismOnLeftTop = ((bDiffFrameThk & (lod3D = 1) & not(offset_L > EPS)) & bNoExtraPrismOnTop)
			else
				bNoExtraPrismOnLeftTop = 0
			endif

			if gs_sidelight_right & gs_RightMullion_Top then
				if gs_Transom_toRight then
					iSimpleSashFrameTypeR = iSimpleSashFrameType_06
					offset_R = offset_06
				else
					iSimpleSashFrameTypeR = iSimpleSashFrameType_05
					offset_R = offset_05
				endif
				bNoExtraPrismOnRightTop = ((bDiffFrameThk & (lod3D = 1) & not(offset_R > EPS)) & bNoExtraPrismOnTop)
			else
				bNoExtraPrismOnRightTop = 0
			endif

			if gs_SashText_typ_num = 1 then		! Mitered Joint

				if gs_pocket_door_frame & lod3D <> 5 then
					cutHeight = TopHeightInny
					gosub "Pocket Door Cutting"
				endif

				if gs_sidelight_left then

					if not(gs_Transom_toLeft) then
						bExtraPrismOnLeftSide = (bDiffFrameThk & (lod3D = 1) & (offset_09 > EPS))
						if gs_bSidelight_fr_hdiv_left then
							bExtraPrismOnLeftSideLower = (bDiffFrameThk & (lod3D = 1) & (offset_11 > EPS))
						else
							bExtraPrismOnLeftSideLower = bExtraPrismOnLeftSide
						endif

						if bExtraPrismOnLeftSide | bExtraPrismOnLeftSideLower then
							put	-A/2+gs_frw1, TopHeightInny, 0, 8, matSash,
								-A/2+gs_frw1+offset_09, TopHeightInny-offset_09, 0, mask1 - 2, matSash
							if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEVER then
								if gs_bSidelight_fr_hdiv_left then
									SashBottomY	= horizDivLeftSideUpperPY
								else
									SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_09
								endif
								SashTopY	= TopHeightInny-offset_09
								simpleSashX	= -A/2+gs_frw1+offset_09

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
							endif
							if gs_bSidelight_fr_hdiv_left then
								put horizDivLeftSideLeftUpperPX,	horizDivLeftSideUpperPY, 0, 8,	matSash,
									horizDivLeftSideLeftLowerPX,	horizDivLeftSideLowerPY, 0, mask2 - not(bExtraPrismOnLeftSideLower),	matSash

								if (iSimpleSashFrameType_11 = SIMPLESASH_SLIDEVER) & bExtraPrismOnLeftSideLower then
									SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_11
									SashTopY	= horizDivLeftSideLowerPY
									simpleSashX	= horizDivLeftSideLeftLowerPX

									simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
									put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
										simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
								endif
								offset_i = offset_11
							else
								offset_i = offset_09
							endif
							put	-A/2+gs_frw1+offset_i, LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, 8, matSash,
								-A/2+gs_frw1+offset_i, LeftSLParapet-ovhgBottomLeft, 0, mask1, matSash,
								-A/2+gs_frw1, LeftSLParapet-ovhgBottomLeft, 0, 12, matSash

							cprism_{2} mat1, botmat, matSash,
								nsp/5, framethick2,
								get(nsp)
							body 1

						endif

						put	-A/2 - cutDxLeft, LeftSLParapet-ovhgBottomLeft, 0, mask1 - 7*gs_stack_left, matSash,
							-A/2 - cutDxLeft, TopHeighty, 0, 10 - 2*(gs_stack_top | gs_stack_left), matSash,
							-A/2+gs_frw1+offset_09*not(bExtraPrismOnLeftSide), TopHeightInny-offset_09*not(bExtraPrismOnLeftSide), 0, mask1 - 2 - ((i = 1) & bExtraPrismOnLeftSide), matSash
						if (iSimpleSashFrameType_09 = SIMPLESASH_SLIDEVER) & not(bExtraPrismOnLeftSide) then
							if gs_bSidelight_fr_hdiv_left then
								SashBottomY	= horizDivLeftSideUpperPY
							else
								SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_09
							endif
							SashTopY	= TopHeightInny-offset_09
							simpleSashX	= -A/2+gs_frw1+offset_09

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						if gs_bSidelight_fr_hdiv_left then
							put horizDivLeftSideLeftUpperPX - offset_09*bExtraPrismOnLeftSide,	horizDivLeftSideUpperPY, 0, mmask,	matSash,
								horizDivLeftSideLeftLowerPX - offset_11*bExtraPrismOnLeftSideLower,	horizDivLeftSideLowerPY, 0, mask2-bExtraPrismOnLeftSideLower,	matSash

							if (iSimpleSashFrameType_11 = SIMPLESASH_SLIDEVER) & not(bExtraPrismOnLeftSideLower) then
								SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_11
								SashTopY	= horizDivLeftSideLowerPY
								simpleSashX	= horizDivLeftSideLeftLowerPX

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
							endif
							offset_i = offset_11
						else
							offset_i = offset_09
						endif
						if not(bDiffFrameThk) then
							put	-A/2+gs_frw1+offset_i, LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, mmask, matSash
						else
							put	-A/2+gs_frw1+offset_i*not(bExtraPrismOnLeftSideLower), LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, 12, matSash,
								-A/2+gs_frw1+offset_i*not(bExtraPrismOnLeftSideLower), LeftSLParapet-ovhgBottomLeft, 0, mask1, matSash
						endif
						put	-A/2 - cutDxLeft, LeftSLParapet-ovhgBottomLeft, 0, -1, matSash

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick1,
							get(nsp)
						body 1

					else
						bExtraPrismOnLeftSide = (bDiffFrameThk & (lod3D = 1) & (offset_09 > EPS))
						if gs_bSidelight_fr_hdiv_left then
							bExtraPrismOnLeftSideLower = (bDiffFrameThk & (lod3D = 1) & (offset_11 > EPS))
						else
							bExtraPrismOnLeftSideLower = bExtraPrismOnLeftSide
						endif
						if gs_LeftMullion_Top then
							offset_x = offset_10
							offset_y = offset_10
							iSimpleSashFrameType = iSimpleSashFrameType_10
						else
							offset_x = offset_02
							offset_y = offset_02
							iSimpleSashFrameType = iSimpleSashFrameType_02
						endif
						bExtraPrismOnLeftSideTop = (bDiffFrameThk & (lod3D = 1) & (offset_x > EPS))

						if bExtraPrismOnLeftSide | bExtraPrismOnLeftSideTop | bExtraPrismOnLeftSideLower then
							if bExtraPrismOnLeftSideTop then
								put	-A/2+gs_frw1, TopHeightInny, 0, 8, matSash,
									-A/2+gs_frw1+offset_x, TopHeightInny-offset_y*(not(bArchedTop)), 0, mask1 - 2, matSash
								if iSimpleSashFrameType = SIMPLESASH_SLIDEVER then
									SashBottomY	= lh+gs_frame_width_transom+offset_y
									SashTopY	= TopHeightInny-offset_y
									simpleSashX	= -A/2+gs_frw1+offset_x

									simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
									put simpleSashX, simpleSashDivy + gs_sash_width/2, 0, 8, matSash,
										simpleSashX, simpleSashDivy - gs_sash_width/2, 0, mask2, matSash
								endif
								put	-A/2+gs_frw1+offset_x, lh+gs_frame_width_transom+offset_y, 0, 8, matSash
								if not(bExtraPrismOnLeftSide) then
									put	-A/2+gs_frw1, lh-offset_09, 0, 12, matSash
								endif

								if not(bExtraPrismOnLeftSide) & bExtraPrismOnLeftSideLower then
									cprism_{2} mat1, botmat, matSash,
										nsp/5, framethick2,
										get(nsp)
								endif
							endif
							if bExtraPrismOnLeftSide | bExtraPrismOnLeftSideLower then
								if bExtraPrismOnLeftSide then
									put	-A/2+gs_frw1+offset_09, lh-offset_09, 0, mask1 - 2, matSash
									if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEVER then
										if gs_bSidelight_fr_hdiv_left then
											SashBottomY	= horizDivLeftSideUpperPY
										else
											SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_09
										endif
										SashTopY	= lh-offset_09
										simpleSashX	= -A/2+gs_frw1+offset_09

										simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
										put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
											simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
									endif
								endif
								if gs_bSidelight_fr_hdiv_left then
									put horizDivLeftSideLeftUpperPX,	horizDivLeftSideUpperPY, 0, 8,	matSash,
										horizDivLeftSideLeftLowerPX,	horizDivLeftSideLowerPY, 0, mask2 - not(bExtraPrismOnLeftSideLower),	matSash

									if (iSimpleSashFrameType_11 = SIMPLESASH_SLIDEVER) & bExtraPrismOnLeftSideLower then
										SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_11
										SashTopY	= horizDivLeftSideLowerPY
										simpleSashX	= horizDivLeftSideLeftLowerPX

										simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
										put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
											simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
									endif
									offset_i = offset_11
								else
									offset_i = offset_09
								endif
								if bExtraPrismOnLeftSideLower then
									put	-A/2+gs_frw1+offset_i, LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, 8, matSash,
										-A/2+gs_frw1+offset_i, LeftSLParapet-ovhgBottomLeft, 0, mask1-2, matSash,
										-A/2+gs_frw1, LeftSLParapet-ovhgBottomLeft, 0, 12, matSash
								endif
								if not(bExtraPrismOnLeftSideTop) & bExtraPrismOnLeftSide then
									put	-A/2+gs_frw1, lh+gs_frame_width_transom+offset_y, 0, 8, matSash
								endif
							endif

							cprism_{2} mat1, botmat, matSash,
								nsp/5, framethick2,
								get(nsp)
							body 1

						endif

						put	-A/2 - cutDxLeft, LeftSLParapet-ovhgBottomLeft, 0, mask1 - 7*gs_stack_left, matSash,
							-A/2 - cutDxLeft, TopHeighty, 0, 10 - 2*(gs_stack_top | gs_stack_left), matSash,
							-A/2+gs_frw1+offset_x*not(bExtraPrismOnLeftSideTop), TopHeightInny-offset_y*(not(bArchedTop))*not(bExtraPrismOnLeftSideTop), 0, mask1 - 2 - ((i = 1) & bExtraPrismOnLeftSideTop), matSash
						if (iSimpleSashFrameType = SIMPLESASH_SLIDEVER) & not(bExtraPrismOnLeftSideTop) then
							SashBottomY	= lh+gs_frame_width_transom+offset_y
							SashTopY	= TopHeightInny-offset_y
							simpleSashX	= -A/2+gs_frw1+offset_x

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sash_width/2, 0, mask2, matSash
						endif
						if i = 1 | not(bDiffFrameThk) then
							put	-A/2+gs_frw1+offset_x*not(bExtraPrismOnLeftSideTop), lh+gs_frame_width_transom+offset_y, 0, mmask, matSash
						endif
						put	-A/2+gs_frw1+offset_09*not(bExtraPrismOnLeftSide), lh-offset_09, 0, mask1 - 2 - ((i = 1) & bExtraPrismOnLeftSide), matSash
						if (iSimpleSashFrameType_09 = SIMPLESASH_SLIDEVER) & not(bExtraPrismOnLeftSide) then
							if gs_bSidelight_fr_hdiv_left then
								SashBottomY	= horizDivLeftSideUpperPY
							else
								SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_09
							endif
							SashTopY	= lh-offset_09
							simpleSashX	= -A/2+gs_frw1+offset_09

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						if gs_bSidelight_fr_hdiv_left then
							put horizDivLeftSideLeftUpperPX-offset_09*bExtraPrismOnLeftSide,	horizDivLeftSideUpperPY, 0, mmask,	matSash,
								horizDivLeftSideLeftLowerPX-offset_11*bExtraPrismOnLeftSideLower,	horizDivLeftSideLowerPY, 0, mask2-bExtraPrismOnLeftSideLower,	matSash

							if (iSimpleSashFrameType_11 = SIMPLESASH_SLIDEVER) & not(bExtraPrismOnLeftSideLower) then
								SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_11
								SashTopY	= horizDivLeftSideLowerPY
								simpleSashX	= horizDivLeftSideLeftLowerPX

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
							endif
							offset_i = offset_11
						else
							offset_i = offset_09
						endif
						if not(bDiffFrameThk) then
							put	-A/2+gs_frw1+offset_i, LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, mmask, matSash
						else
							put	-A/2+gs_frw1+offset_i*not(bExtraPrismOnLeftSideLower), LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, 12, matSash,
								-A/2+gs_frw1+offset_i*not(bExtraPrismOnLeftSideLower), LeftSLParapet-ovhgBottomLeft, 0, mask1, matSash
						endif
						put	-A/2 - cutDxLeft, LeftSLParapet-ovhgBottomLeft, 0, -1, matSash

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick1,
							get(nsp)
					endif

					gosub 500

					if gs_LeftMullion_Top then
						if gs_Transom_toLeft then
							put	-A/2+gs_sl_w1-gs_frw_Sl_left-offset_10, B-gs_frwt-offset_10, 0, mask1, matSash
							if iSimpleSashFrameType_10 = SIMPLESASH_SLIDEVER then
								SashBottomY	= lh+gs_frame_width_transom+offset_10
								SashTopY	= B-gs_frwt-offset_10
								simpleSashX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_10

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sash_width/2, 0, mask2, matSash
							endif
							put	-A/2+gs_sl_w1-gs_frw_Sl_left-offset_10, lh+gs_frame_width_transom+offset_10, 0, 10, matSash,
								-A/2+gs_sl_w1-gs_frw_Sl_left-offset_09, lh-offset_09, 0, mask1, matSash
						else
							put	-A/2+gs_sl_w1-gs_frw_Sl_left-offset_09, B-gs_frwt-offset_09, 0, mask1, matSash
						endif
					else
						put	-A/2+gs_sl_w1-gs_frw_Sl_left-offset_09, lh-offset_09, 0, mask1, matSash
					endif
					if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEVER then
						if gs_bSidelight_fr_hdiv_left then
							SashBottomY	= horizDivLeftSideUpperPY
						else
							SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_09
						endif
						if gs_Transom_toLeft then
							SashTopY = lh-offset_09
						else
							SashTopY = B-gs_frwt-offset_09
						endif
						simpleSashX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_09

						simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
						put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
							simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
					endif
					if gs_bSidelight_fr_hdiv_left then
						put horizDivLeftSideRightUpperPX,	horizDivLeftSideUpperPY, 0, 8,		matSash,
							horizDivLeftSideRightLowerPX,	horizDivLeftSideLowerPY, 0, mask2,	matSash

						if iSimpleSashFrameType_11 = SIMPLESASH_SLIDEVER then
							SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_11
							SashTopY	= horizDivLeftSideLowerPY
							simpleSashX	= horizDivLeftSideRightLowerPX

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						offset_i = offset_11
					else
						offset_i = offset_09
					endif
					if LeftSLParapet > EPS then
						put -A/2+gs_sl_w1-gs_frw_Sl_left-offset_i, LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, 10, matSash,
							-A/2+gs_sl_w1-gs_frw_SlParapet_left-gs_tolerance_left_2, LeftSLParapet-ovhgBottomLeft, 0, mask1, matSash,
							-A/2+gs_sl_w1-gs_frw_SlParapet_left-gs_tolerance_left_2, -ovhgBottom, 0, mask1, matSash,
							-A/2+gs_sl_w1+offset_leaf, -ovhgBottom, 0, mask3, matLeaf
					else
						put -A/2+gs_sl_w1-gs_frw_Sl_left-offset_i, gs_frame_width_low_left_sl+offset_i, 0, 10, matSash,
							-A/2+gs_sl_w1+offset_leaf, -ovhgBottom, 0, mask3 - 2, matLeaf
					endif
					if gs_LeftMullion_Top then
						if gs_Transom_toLeft then
							put	-A/2+gs_sl_w1+offset_leaf, lh-offset_leaf, 0, 10, matSash,
								-A/2+gs_sl_w1+offset_02, lh+gs_frame_width_transom+offset_02, 0, mask1, matSash
							if iSimpleSashFrameType_02 = SIMPLESASH_SLIDEVER then
								SashBottomY	= lh+gs_frame_width_transom+offset_02
								SashTopY	= B-gs_frwt-offset_02
								simpleSashX	= -A/2+gs_sl_w1+offset_02

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy - gs_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy + gs_sash_width/2, 0, mask2, matSash
							endif
							put	-A/2+gs_sl_w1+offset_02, B-gs_frwt-offset_02, 0, 10+4*(bNoExtraPrismOnLeftTop | (bDiffFrameThk & (lod3D = 2))), matSash,
								-A/2+gs_sl_w1-gs_frw_Sl_left-offset_10, B-gs_frwt-offset_10, 0, -1, matSash
						else
							put	-A/2+gs_sl_w1+offset_leaf, lh-offset_leaf, 0, 10, matSash,
								-A/2+gs_sl_w1+offset_02, lh+gs_frame_width_transom+offset_02, 0, mask1, matSash
							if iSimpleSashFrameType_02 = SIMPLESASH_SLIDEVER then
								SashBottomY	= lh+gs_frame_width_transom+offset_02
								SashTopY	= B-gs_frwt-offset_02
								simpleSashX	= -A/2+gs_sl_w1+offset_02

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy - gs_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy + gs_sash_width/2, 0, mask2, matSash
							endif
							put	-A/2+gs_sl_w1+offset_02, B-gs_frwt-offset_02, 0, 10+4*(bNoExtraPrismOnLeftTop | (bDiffFrameThk & (lod3D = 2))), matSash,
								-A/2+gs_sl_w1-gs_frw_Sl_left-offset_09, B-gs_frwt-offset_09, 0, -1, matSash
						endif
					else
						put	-A/2+gs_sl_w1+offset_leaf, lh-offset_leaf, 0, 10, matSash,
							-A/2+gs_sl_w1-gs_frw_Sl_left-offset_09, lh-offset_09, 0, -1, matSash
					endif

					cprism_{2} mat1, botmat, matSash,
						nsp/5, framethick2,
						get(nsp)

					gosub 500

					if gs_bSidelight_fr_hdiv_left then
						iSimpleSashFrameType_i = iSimpleSashFrameType_11
						offset_i = offset_11
					else
						iSimpleSashFrameType_i = iSimpleSashFrameType_09
						offset_i = offset_09
					endif
					put	-A/2+gs_sl_w1-gs_frw_Sl_left-offset_i, LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, 10, matSash,
						-A/2+gs_sl_w1-(gs_frw_SlParapet_left+gs_tolerance_left_2) * (LeftSLParapet>0), LeftSLParapet-ovhgBottomLeft, 0, mask1, matSash,
						-A/2+(gs_frw1+offset_i)*bDiffFrameThk-gs_tolerance_left*not(bDiffFrameThk), LeftSLParapet-ovhgBottomLeft, 0, mmask2-4*bExtraPrismOnLeftSideLower - 2*gs_stack_left, matSash,
						-A/2+gs_frw1+offset_i, LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, mask1, matSash
					if iSimpleSashFrameType_i = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_i = SIMPLESASH_SIDEHUNG then
						SashLeftX	= -A/2+gs_frw1+offset_i
						SashRightX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_i
						simpleSashZ	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i

						simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
						if iSimpleSashFrameType_i = SIMPLESASH_SLIDEHOR then
							put simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
								simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
						else
							put simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
								simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
						endif
					endif

					cprism_{2} mat1, botmat, matSash,
						nsp/5, framethick2,
						get(nsp)

					gosub 600
				else
					bExtraPrismOnLeftSideTop = (bDiffFrameThk & (lod3D = 1) & (offset_02 > EPS))
					if bExtraPrismOnLeftSideTop then
						put	-A/2+gs_frw1, TopHeightInny, 0, 8, matSash,
							-A/2+gs_frw1+offset_02, TopHeightInny-offset_02*(not(bArchedTop)), 0, mask1 - 2, matSash
						if iSimpleSashFrameType_02 = SIMPLESASH_SLIDEVER then
							SashBottomY	= lh+gs_frame_width_transom+offset_02
							SashTopY	= TopHeightInny-offset_02
							simpleSashX	= -A/2+gs_frw1+offset_02

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sash_width/2, 0, mask2, matSash
						endif
						put	-A/2+gs_frw1+offset_02, lh+gs_frame_width_transom+offset_02, 0, 8, matSash,
							-A/2+gs_frw1, lh, 0, 12, matLeaf

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick2,
							get(nsp)
						body 1
					endif

					put	-A/2 - cutDxLeft, -ovhgBottom, 0, mask1 - 7*gs_stack_left, matSash,
						-A/2 - cutDxLeft, TopHeighty, 0, 10 - 2*(gs_stack_top | gs_stack_left), matSash,
						-A/2+gs_frw1+offset_02*not(bExtraPrismOnLeftSideTop), TopHeightInny-offset_02*(not(bArchedTop))*not(bExtraPrismOnLeftSideTop), 0, mask1 - 2 - ((i = 1) & bExtraPrismOnLeftSideTop), matSash
					if (iSimpleSashFrameType_02 = SIMPLESASH_SLIDEVER) & not(bExtraPrismOnLeftSideTop) then
						SashBottomY	= lh+gs_frame_width_transom+offset_02
						SashTopY	= TopHeightInny-offset_02
						simpleSashX	= -A/2+gs_frw1+offset_02

						simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
						put simpleSashX, simpleSashDivy + gs_sash_width/2, 0, 8, matSash,
							simpleSashX, simpleSashDivy - gs_sash_width/2, 0, mask2, matSash
					endif
					if i = 1 | not(bDiffFrameThk) then
						put	-A/2+gs_frw1+offset_02*not(bExtraPrismOnLeftSideTop), lh+gs_frame_width_transom+offset_02, 0, mmask, matSash
					endif
					put	-A/2+gs_frw1+offset_leaf, lh-offset_leaf, 0, mask1 - 2, matLeaf,
						-A/2+gs_frw1+offset_leaf, -ovhgBottom, 0, mask1, matSash,
						-A/2 - cutDxLeft, -ovhgBottom, 0, mask1 - 7*gs_stack_left, matSash

					cprism_{2} mat1, botmat, matSash,
						nsp/5, framethick1,
						get(nsp)

					gosub 500
				endif

				if gs_sidelight_right then

					if not(gs_Transom_toRight) then
						bExtraPrismOnRightSide = (bDiffFrameThk & (lod3D = 1) & (offset_05 > EPS))
						if gs_bSidelight_fr_hdiv_right then
							bExtraPrismOnRightSideLower = (bDiffFrameThk & (lod3D = 1) & (offset_07 > EPS))
						else
							bExtraPrismOnRightSideLower = bExtraPrismOnRightSide
						endif

						if bExtraPrismOnRightSide | bExtraPrismOnRightSideLower then
							put	A/2-gs_frw2, TopHeightInny, 0, 8, matSash,
								A/2-gs_frw2-offset_05, TopHeightInny-offset_05, 0, mask1 - 2, matSash
							if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEVER then
								if gs_bSidelight_fr_hdiv_right then
									SashBottomY	= horizDivRightSideUpperPY
								else
									SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_05
								endif
								SashTopY	= TopHeightInny-offset_05
								simpleSashX	= A/2-gs_frw2-offset_05

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
							endif
							if gs_bSidelight_fr_hdiv_right then
								put horizDivRightSideRightUpperPX,	horizDivRightSideUpperPY, 0, 8,	matSash,
									horizDivRightSideRightLowerPX,	horizDivRightSideLowerPY, 0, mask2 - not(bExtraPrismOnRightSideLower),	matSash

								if (iSimpleSashFrameType_07 = SIMPLESASH_SLIDEVER) & bExtraPrismOnRightSideLower then
									SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_07
									SashTopY	= horizDivRightSideLowerPY
									simpleSashX	= horizDivRightSideRightLowerPX

									simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
									put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
										simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
								endif
								offset_i = offset_07
							else
								offset_i = offset_05
							endif
							put	A/2-gs_frw2-offset_i, RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, 8, matSash,
								A/2-gs_frw2-offset_i, RightSLParapet-ovhgBottomRight, 0, mask1, matSash,
								A/2-gs_frw2, RightSLParapet-ovhgBottomRight, 0, 12, matSash

							cprism_{2} mat1, botmat, matSash,
								nsp/5, framethick2,
								get(nsp)
							body 1
						endif

						put	A/2 + cutDxRight, RightSLParapet-ovhgBottomRight, 0, mask1 - 7*gs_stack_right, matSash,
							A/2 + cutDxRight, TopHeighty, 0, 10 - 2*(gs_stack_top | gs_stack_right), matSash,
							A/2-gs_frw2-offset_05*not(bExtraPrismOnRightSide), TopHeightInny-offset_05*not(bExtraPrismOnRightSide), 0, mask1 - 2 - ((i = 1) & bExtraPrismOnRightSide), matSash
						if (iSimpleSashFrameType_05 = SIMPLESASH_SLIDEVER) & not(bExtraPrismOnRightSide) then
							if gs_bSidelight_fr_hdiv_right then
								SashBottomY	= horizDivRightSideUpperPY
							else
								SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_05
							endif
							SashTopY	= TopHeightInny-offset_05
							simpleSashX	= A/2-gs_frw2-offset_05

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						if gs_bSidelight_fr_hdiv_right then
							put horizDivRightSideRightUpperPX+offset_05*bExtraPrismOnRightSide,	horizDivRightSideUpperPY, 0, mmask,	matSash,
								horizDivRightSideRightLowerPX+offset_07*bExtraPrismOnRightSideLower,	horizDivRightSideLowerPY, 0, mask2-bExtraPrismOnRightSideLower,	matSash

							if (iSimpleSashFrameType_07 = SIMPLESASH_SLIDEVER) & not(bExtraPrismOnRightSideLower) then
								SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_07
								SashTopY	= horizDivRightSideLowerPY
								simpleSashX	= horizDivRightSideRightLowerPX

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
							endif
							offset_i = offset_07
						else
							offset_i = offset_05
						endif
						if not(bDiffFrameThk) then
							put	A/2-gs_frw2-offset_i, RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, mmask, matSash
						else
							put	A/2-gs_frw2-offset_i*not(bExtraPrismOnRightSideLower), RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, 12, matSash,
								A/2-gs_frw2-offset_i*not(bExtraPrismOnRightSideLower), RightSLParapet-ovhgBottomRight, 0, mask1, matSash
						endif
						put	A/2 + cutDxRight, RightSLParapet-ovhgBottomRight, 0, -1, matSash

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick1,
							get(nsp)
						body 1
					else
						bExtraPrismOnRightSide = (bDiffFrameThk & (lod3D = 1) & (offset_05 > EPS))
						if gs_bSidelight_fr_hdiv_right then
							bExtraPrismOnRightSideLower = (bDiffFrameThk & (lod3D = 1) & (offset_07 > EPS))
						else
							bExtraPrismOnRightSideLower = bExtraPrismOnRightSide
						endif
						if gs_RightMullion_Top then
							offset_x = offset_06
							offset_y = offset_06
							iSimpleSashFrameType = iSimpleSashFrameType_06
						else
							offset_x = offset_02
							offset_y = offset_02
							iSimpleSashFrameType = iSimpleSashFrameType_02
						endif
						bExtraPrismOnRightSideTop = (bDiffFrameThk & (lod3D = 1) & (offset_x > EPS))

						if bExtraPrismOnRightSide | bExtraPrismOnRightSideTop | bExtraPrismOnRightSideLower then
							if bExtraPrismOnRightSideTop then
								put	A/2-gs_frw2, TopHeightInny, 0, 8, matSash,
									A/2-gs_frw2-offset_x, TopHeightInny-offset_y*(not(bArchedTop)), 0, mask1 - 2, matSash
								if iSimpleSashFrameType = SIMPLESASH_SLIDEVER then
									SashBottomY	= lh+gs_frame_width_transom+offset_y
									SashTopY	= TopHeightInny-offset_y
									simpleSashX	= A/2-gs_frw2-offset_x

									simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
									put simpleSashX, simpleSashDivy + gs_sash_width/2, 0, 8, matSash,
										simpleSashX, simpleSashDivy - gs_sash_width/2, 0, mask2, matSash
								endif
								put	A/2-gs_frw2-offset_x, lh+gs_frame_width_transom+offset_y, 0, 8, matSash
								if not(bExtraPrismOnRightSide) then
									put	A/2-gs_frw2, lh-offset_05, 0, 12, matSash
								endif

								if not(bExtraPrismOnRightSide) & bExtraPrismOnRightSideLower then
									cprism_{2} mat1, botmat, matSash,
										nsp/5, framethick2,
										get(nsp)
								endif
							endif
							if bExtraPrismOnRightSide | bExtraPrismOnRightSideLower then
								if bExtraPrismOnRightSide then
									put	A/2-gs_frw2-offset_05, lh-offset_05, 0, mask1 - 2, matSash
									if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEVER then
										if gs_bSidelight_fr_hdiv_right then
											SashBottomY	= horizDivRightSideUpperPY
										else
											SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_05
										endif
										SashTopY	= lh-offset_05
										simpleSashX	= A/2-gs_frw2-offset_05

										simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
										put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
											simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
									endif
								endif
								if gs_bSidelight_fr_hdiv_right then
									put horizDivRightSideRightUpperPX,	horizDivRightSideUpperPY, 0, 8,	matSash,
										horizDivRightSideRightLowerPX,	horizDivRightSideLowerPY, 0, mask2 - not(bExtraPrismOnRightSideLower),	matSash

									if (iSimpleSashFrameType_07 = SIMPLESASH_SLIDEVER) & bExtraPrismOnRightSideLower then
										SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_07
										SashTopY	= horizDivRightSideLowerPY
										simpleSashX	= horizDivRightSideRightLowerPX

										simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
										put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
											simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
									endif
									offset_i = offset_07
								else
									offset_i = offset_05
								endif
								if bExtraPrismOnRightSideLower then
									put	A/2-gs_frw2-offset_i, RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, 8, matSash,
										A/2-gs_frw2-offset_i, RightSLParapet-ovhgBottomRight, 0, mask1-2, matSash,
										A/2-gs_frw2, RightSLParapet-ovhgBottomRight, 0, 12, matSash
								endif
								if not(bExtraPrismOnRightSideTop) & bExtraPrismOnRightSide then
									put A/2-gs_frw2, lh+gs_frame_width_transom+offset_y, 0, 8, matSash
								endif
							endif

							cprism_{2} mat1, botmat, matSash,
								nsp/5, framethick2,
								get(nsp)
							body 1
						endif

						put	A/2 + cutDxRight, RightSLParapet-ovhgBottomRight, 0, mask1 - 7*gs_stack_right, matSash,
							A/2 + cutDxRight, TopHeighty, 0, 10 - 2*(gs_stack_top | gs_stack_right), matSash,
							A/2-gs_frw2-offset_x*not(bExtraPrismOnRightSideTop), TopHeightInny-offset_y*(not(bArchedTop))*not(bExtraPrismOnRightSideTop), 0, mask1 - 2 - ((i = 1) & bExtraPrismOnRightSideTop), matSash
						if (iSimpleSashFrameType = SIMPLESASH_SLIDEVER) & not(bExtraPrismOnRightSideTop) then
							SashBottomY	= lh+gs_frame_width_transom+offset_y
							SashTopY	= TopHeightInny-offset_y
							simpleSashX	= A/2-gs_frw2-offset_x

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sash_width/2, 0, mask2, matSash
						endif
						if i = 1 | not(bDiffFrameThk) then
							put	A/2-gs_frw2-offset_x*not(bExtraPrismOnRightSideTop), lh+gs_frame_width_transom+offset_y, 0, mmask, matSash
						endif
						put	A/2-gs_frw2-offset_05*not(bExtraPrismOnRightSide), lh-offset_05, 0, mask1 - 2 - ((i = 1) & bExtraPrismOnRightSide), matSash
						if (iSimpleSashFrameType_05 = SIMPLESASH_SLIDEVER) & not(bExtraPrismOnRightSide) then
							if gs_bSidelight_fr_hdiv_right then
								SashBottomY	= horizDivRightSideUpperPY
							else
								SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_05
							endif
							SashTopY	= lh-offset_05
							simpleSashX	= A/2-gs_frw2-offset_05

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						if gs_bSidelight_fr_hdiv_right then
							put horizDivRightSideRightUpperPX+offset_05*bExtraPrismOnRightSide,	horizDivRightSideUpperPY, 0, mmask,	matSash,
								horizDivRightSideRightLowerPX+offset_07*bExtraPrismOnRightSideLower,	horizDivRightSideLowerPY, 0, mask2-bExtraPrismOnRightSideLower,	matSash

							if (iSimpleSashFrameType_07 = SIMPLESASH_SLIDEVER) & not(bExtraPrismOnRightSideLower) then
								SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_07
								SashTopY	= horizDivRightSideLowerPY
								simpleSashX	= horizDivRightSideRightLowerPX

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
							endif
							offset_i = offset_07
						else
							offset_i = offset_05
						endif
						if not(bDiffFrameThk) then
							put	A/2-gs_frw2-offset_i, RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, mmask, matSash
						else
							put	A/2-gs_frw2-offset_i*not(bExtraPrismOnRightSideLower), RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, 12, matSash,
								A/2-gs_frw2-offset_i*not(bExtraPrismOnRightSideLower), RightSLParapet-ovhgBottomRight, 0, mask1, matSash
						endif
						put	A/2 + cutDxRight, RightSLParapet-ovhgBottomRight, 0, -1, matSash

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick1,
							get(nsp)
					endif

					gosub 500

					if gs_RightMullion_Top then
						if gs_Transom_toRight then
							put	A/2-gs_sl_w2+gs_frw_Sl_right+offset_06, B-gs_frwt-offset_06, 0, mask1, matSash
							if iSimpleSashFrameType_06 = SIMPLESASH_SLIDEVER then
								SashBottomY	= lh+gs_frame_width_transom+offset_06
								SashTopY	= B-gs_frwt-offset_06
								simpleSashX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_06

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sash_width/2, 0, mask2, matSash
							endif
							put	A/2-gs_sl_w2+gs_frw_Sl_right+offset_06, lh+gs_frame_width_transom+offset_06, 0, 10, matSash,
								A/2-gs_sl_w2+gs_frw_Sl_right+offset_05, lh-offset_05, 0, mask1, matSash
						else
							put	A/2-gs_sl_w2+gs_frw_Sl_right+offset_05, B-gs_frwt-offset_05, 0, mask1, matSash
						endif
					else
						put	A/2-gs_sl_w2+gs_frw_Sl_right+offset_05, lh-offset_05, 0, mask1, matSash
					endif
					if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEVER then
						if gs_bSidelight_fr_hdiv_right then
							SashBottomY	= horizDivRightSideUpperPY
						else
							SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_05
						endif
						if gs_Transom_toRight then
							SashTopY = lh-offset_05
						else
							SashTopY = B-gs_frwt-offset_05
						endif
						simpleSashX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_05

						simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
						put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
							simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
					endif
					if gs_bSidelight_fr_hdiv_right then
						put horizDivRightSideLeftUpperPX,	horizDivRightSideUpperPY, 0, 8,		matSash,
							horizDivRightSideLeftLowerPX,	horizDivRightSideLowerPY, 0, mask2,	matSash

						if iSimpleSashFrameType_07 = SIMPLESASH_SLIDEVER then
							SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_07
							SashTopY	= horizDivRightSideLowerPY
							simpleSashX	= horizDivRightSideLeftLowerPX

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						offset_i = offset_07
					else
						offset_i = offset_05
					endif
					if RightSLParapet > EPS then
						put A/2-gs_sl_w2+gs_frw_Sl_right+offset_i, RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, 10, matSash,
							A/2-gs_sl_w2+gs_frw_SlParapet_right+gs_tolerance_right_2, RightSLParapet-ovhgBottomRight, 0, mask1, matSash,
							A/2-gs_sl_w2+gs_frw_SlParapet_right+gs_tolerance_right_2, -ovhgBottom, 0, mask1, matSash,
							A/2-gs_sl_w2-offset_leaf, -ovhgBottom, 0, mask3, matLeaf
					else
						put A/2-gs_sl_w2+gs_frw_Sl_right+offset_i, gs_frame_width_low_right_sl+offset_i, 0, 10, matSash,
							A/2-gs_sl_w2-offset_leaf, -ovhgBottom, 0, mask3 - 2, matLeaf
					endif
					if gs_RightMullion_Top then
						if gs_Transom_toRight then
							put	A/2-gs_sl_w2-offset_leaf, lh-offset_leaf, 0, 10, matSash,
								A/2-gs_sl_w2-offset_02, lh+gs_frame_width_transom+offset_02, 0, mask1, matSash
							if iSimpleSashFrameType_02 = SIMPLESASH_SLIDEVER then
								SashBottomY	= lh+gs_frame_width_transom+offset_02
								SashTopY	= B-gs_frwt-offset_02
								simpleSashX	= A/2-gs_sl_w2-offset_02

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy - gs_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy + gs_sash_width/2, 0, mask2, matSash
							endif
							put	A/2-gs_sl_w2-offset_02, B-gs_frwt-offset_02, 0, 10+4*(bNoExtraPrismOnRightTop | (bDiffFrameThk & (lod3D = 2))), matSash,
								A/2-gs_sl_w2+gs_frw_Sl_right+offset_06, B-gs_frwt-offset_06, 0, -1, matSash
						else
							put	A/2-gs_sl_w2-offset_leaf, lh-offset_leaf, 0, 10, matSash,
								A/2-gs_sl_w2-offset_02, lh+gs_frame_width_transom+offset_02, 0, mask1, matSash
							if iSimpleSashFrameType_02 = SIMPLESASH_SLIDEVER then
								SashBottomY	= lh+gs_frame_width_transom+offset_02
								SashTopY	= B-gs_frwt-offset_02
								simpleSashX	= A/2-gs_sl_w2-offset_02

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy - gs_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy + gs_sash_width/2, 0, mask2, matSash
							endif
							put	A/2-gs_sl_w2-offset_02, B-gs_frwt-offset_02, 0, 10+4*(bNoExtraPrismOnRightTop | (bDiffFrameThk & (lod3D = 2))), matSash,
								A/2-gs_sl_w2+gs_frw_Sl_right+offset_05, B-gs_frwt-offset_05, 0, -1, matSash
						endif
					else
						put	A/2-gs_sl_w2-offset_leaf, lh-offset_leaf, 0, 10, matSash,
							A/2-gs_sl_w2+gs_frw_Sl_right+offset_05, lh-offset_05, 0, -1, matSash
					endif

					cprism_{2} mat1, botmat, matSash,
						nsp/5, framethick2,
						get(nsp)

					gosub 500

					if gs_bSidelight_fr_hdiv_right then
						iSimpleSashFrameType_i = iSimpleSashFrameType_07
						offset_i = offset_07
					else
						iSimpleSashFrameType_i = iSimpleSashFrameType_05
						offset_i = offset_05
					endif
					put	A/2-gs_sl_w2+gs_frw_Sl_right+offset_i, RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, 10, matSash,
						A/2-gs_sl_w2+(gs_frw_SlParapet_right+gs_tolerance_right_2) * (RightSLParapet>0), RightSLParapet-ovhgBottomRight, 0, mask1, matSash,
						A/2-(gs_frw2+offset_i)*bDiffFrameThk+gs_tolerance_right*not(bDiffFrameThk), RightSLParapet-ovhgBottomRight, 0, mmask2-4*bExtraPrismOnRightSideLower - 2*gs_stack_right, matSash,
						A/2-gs_frw2-offset_i, RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, mask1, matSash
					if iSimpleSashFrameType_i = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_i = SIMPLESASH_SIDEHUNG then
						SashLeftX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_i
						SashRightX	= A/2-gs_frw2-offset_i
						simpleSashZ	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i

						simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
						if iSimpleSashFrameType_i = SIMPLESASH_SLIDEHOR then
							put simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
								simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
						else
							put simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
								simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
						endif
					endif

					cprism_{2} mat1, botmat, matSash,
						nsp/5, framethick2,
						get(nsp)

					gosub 600
				else
					bExtraPrismOnRightSideTop = (bDiffFrameThk & (lod3D = 1) & (offset_02 > EPS))
					if bExtraPrismOnRightSideTop then
						put	A/2-gs_frw2, TopHeightInny, 0, 8, matSash
						put	A/2-gs_frw2-offset_02, TopHeightInny-offset_02*(not(bArchedTop)), 0, mask1 - 2, matSash
						if iSimpleSashFrameType_02 = SIMPLESASH_SLIDEVER then
							SashBottomY	= lh+gs_frame_width_transom+offset_02
							SashTopY	= TopHeightInny-offset_02
							simpleSashX	= A/2-gs_frw2-offset_02

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sash_width/2, 0, mask2, matSash
						endif
						put	A/2-gs_frw2-offset_02, lh+gs_frame_width_transom+offset_02, 0, 8, matSash,
							A/2-gs_frw2, lh, 0, 12, matLeaf

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick2,
							get(nsp)
						body 1
					endif

					put	A/2 + cutDxRight, -ovhgBottom, 0, mask1 - 7*gs_stack_right, matSash,
						A/2 + cutDxRight, TopHeighty, 0, 10 - 2*(gs_stack_top | gs_stack_right), matSash,
						A/2-gs_frw2-offset_02*not(bExtraPrismOnRightSideTop), TopHeightInny-offset_02*(not(bArchedTop))*not(bExtraPrismOnRightSideTop), 0, mask1 - 2 - ((i = 1) & bExtraPrismOnRightSideTop), matSash
					if (iSimpleSashFrameType_02 = SIMPLESASH_SLIDEVER) & not(bExtraPrismOnRightSideTop) then
						SashBottomY	= lh+gs_frame_width_transom+offset_02
						SashTopY	= TopHeightInny-offset_02
						simpleSashX	= A/2-gs_frw2-offset_02

						simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
						put simpleSashX, simpleSashDivy + gs_sash_width/2, 0, 8, matSash,
							simpleSashX, simpleSashDivy - gs_sash_width/2, 0, mask2, matSash
					endif
					if i = 1 | not(bDiffFrameThk) then
						put	A/2-gs_frw2-offset_02*not(bExtraPrismOnRightSideTop), lh+gs_frame_width_transom+offset_02, 0, mmask, matSash
					endif
					put	A/2-gs_frw2-offset_leaf, lh-offset_leaf, 0, mask1 - 2, matLeaf,
						A/2-gs_frw2-offset_leaf, -ovhgBottom, 0, mask1, matSash,
						A/2 + cutDxRight, -ovhgBottom, 0, -1, matSash

					cprism_{2} mat1, botmat, matSash,
						nsp/5, framethick1,
						get(nsp)

					gosub 500
				endif

				if gs_pocket_door_frame & lod3D <> 5 then
					cutend
					if n=2 then cutend
				endif

				if bArchedTop then
					cprism_{2} mat1, botmat, matSash,
						7, framethick1,
						-A/2 - cutDxLeft, gs_shoulder_h, 0, mask1 + 64, matSash,
						0, frametop - r2, 0, 900, matSash,
						0, b + cutDy, 0, 3064 + mask1, matSash,
						A/2 + cutDxRight, gs_shoulder_h, 0, 3010, matSash,
						A/2-gs_frw2-offset_02, gs_shoulder_h-(fce-fcefw), 0, mask1 + 64, matSash,
						0, B-gs_frwt-offset_02, 0, 3064 + mask1, matSash,
						-A/2+gs_frw1+offset_02,  gs_shoulder_h-(fce-fcefw), 0, 3010, matSash
				else
					bExtraPrismOnTop_02 = 0
					bExtraPrismOnTopLeft = 0
					bExtraPrismOnTopRight = 0

					bExtraPrismOnTop_02 = (bDiffFrameThk & (lod3D = 1) & (offset_02 > EPS))
					if gs_sidelight_left & gs_LeftMullion_Top then
						if gs_Transom_toLeft then
							iSimpleSashFrameTypeL = iSimpleSashFrameType_10
							offset_xL = offset_10
							offset_yL = offset_10
							sashWidthL = gs_sash_width
						else
							iSimpleSashFrameTypeL = iSimpleSashFrameType_09
							offset_xL = offset_09
							offset_yL = offset_09
							sashWidthL = gs_sl_sash_width
						endif
					else
						offset_xL = offset_02
						offset_yL = offset_02
						sashWidthL = gs_sash_width
					endif
					bExtraPrismOnTopLeft = (bDiffFrameThk & (lod3D = 1) & (offset_xL > EPS))

					if gs_sidelight_right & gs_RightMullion_Top then
						if gs_Transom_toRight then
							iSimpleSashFrameTypeR = iSimpleSashFrameType_06
							offset_xR = offset_06
							offset_yR = offset_06
							sashWidthR = gs_sash_width
						else
							iSimpleSashFrameTypeR = iSimpleSashFrameType_05
							offset_xR = offset_05
							offset_yR = offset_05
							sashWidthR = gs_sl_sash_width
						endif
					else
						offset_xR = offset_02
						offset_yR = offset_02
						sashWidthR = gs_sash_width
					endif
					bExtraPrismOnTopRight = (bDiffFrameThk & (lod3D = 1) & (offset_xR > EPS))

					if bExtraPrismOnTop_02 | bExtraPrismOnTopLeft | bExtraPrismOnTopRight then
						put	-A/2+gs_frw1, B-gs_frwt, 0, 8, matSash,
							-A/2+gs_frw1+offset_xL, B-gs_frwt-offset_yL, 0, mask1, matSash

						if gs_sidelight_left & gs_LeftMullion_Top then
							if iSimpleSashFrameTypeL = SIMPLESASH_SLIDEHOR | iSimpleSashFrameTypeL = SIMPLESASH_SIDEHUNG then
								SashLeftX	= -A/2+gs_frw1+offset_xL
								SashRightX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_xL
								simpleSashZ	= B-gs_frwt-offset_yL

								simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
								if iSimpleSashFrameTypeL = SIMPLESASH_SLIDEHOR then
									put simpleSashDivx - sashWidthL/2, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + sashWidthL/2, simpleSashZ, 0, mask2, matSash
								else
									put simpleSashDivx - sashWidthL, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + sashWidthL, simpleSashZ, 0, mask2, matSash
								endif
							endif

							put -A/2+gs_sl_w1-gs_frw_Sl_left-offset_xL,  B-gs_frwt-offset_yL, 0, 10, matSash,
								-A/2+gs_sl_w1+offset_02,  B-gs_frwt-offset_02, 0, mask1,  matSash
						endif

						if iSimpleSashFrameType_02 = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_02 = SIMPLESASH_SIDEHUNG then
							if gs_sidelight_left & gs_LeftMullion_Top then
								SashLeftX = -A/2+gs_sl_w1+offset_02
							else
								SashLeftX = -A/2+gs_frw1+offset_02
							endif
							if gs_sidelight_right & gs_RightMullion_Top then
								SashRightX = A/2-gs_sl_w2-offset_02
							else
								SashRightX = A/2-gs_frw2-offset_02
							endif
							simpleSashZ	= B-gs_frwt-offset_02

							simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
							if iSimpleSashFrameType_02 = SIMPLESASH_SLIDEHOR then
								put simpleSashDivx - gs_sash_width/2, simpleSashZ, 0, 8, matSash,
									simpleSashDivx + gs_sash_width/2, simpleSashZ, 0, mask2, matSash
							else
								put simpleSashDivx - gs_sash_width, simpleSashZ, 0, 8, matSash,
									simpleSashDivx + gs_sash_width, simpleSashZ, 0, mask2, matSash
							endif
						endif

						if gs_sidelight_right & gs_RightMullion_Top then
							put A/2-gs_sl_w2-offset_02,  B-gs_frwt-offset_02, 0, 10, matSash,
								A/2-gs_sl_w2+gs_frw_Sl_right+offset_xR,  B-gs_frwt-offset_yR, 0, mask1, matSash

							if iSimpleSashFrameTypeR = SIMPLESASH_SLIDEHOR | iSimpleSashFrameTypeR = SIMPLESASH_SIDEHUNG then
								SashLeftX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_xR
								SashRightX	= A/2-gs_frw2-offset_xR
								simpleSashZ	= B-gs_frwt-offset_yR

								simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
								if iSimpleSashFrameTypeR = SIMPLESASH_SLIDEHOR then
									put simpleSashDivx - sashWidthR/2, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + sashWidthR/2, simpleSashZ, 0, mask2, matSash
								else
									put simpleSashDivx - sashWidthR, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + sashWidthR, simpleSashZ, 0, mask2, matSash
								endif
							endif
						endif

						put	A/2-gs_frw2-offset_xR, B-gs_frwt-offset_yR, 0, 10, matSash,
							A/2-gs_frw2, B-gs_frwt-offset_yR*not(bExtraPrismOnTopRight), 0, 12, matSash

						cprism_{2} mat1, botmat, matSash,
								nsp/5, framethick2,
								get(nsp)
						body 1
					endif

					if abs(cutDy + gs_frwt + offset_yL*not(bExtraPrismOnTopLeft)) > EPS then	! avoiding self intersect. prism
						put	-A/2 - cutDxLeft, b + cutDy, 0, 10 - 2*(gs_stack_top | gs_stack_left), matSash,
							-A/2+gs_frw1+offset_xL*not(bExtraPrismOnTopLeft), B-gs_frwt-offset_yL*not(bExtraPrismOnTopLeft), 0, mask1 - ((i = 1) & bExtraPrismOnTopLeft), matSash
					endif

					if gs_sidelight_left & gs_LeftMullion_Top then
						if offset_yL*not(bExtraPrismOnTopLeft) > EPS | offset_02*not(bExtraPrismOnTop_02) > EPS | gs_frwt > EPS then	! avoiding self intersect. prism
							if (iSimpleSashFrameTypeL = SIMPLESASH_SLIDEHOR | iSimpleSashFrameTypeL = SIMPLESASH_SIDEHUNG) & not(bExtraPrismOnTopLeft) then
								SashLeftX	= -A/2+gs_frw1+offset_xL
								SashRightX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_xL
								simpleSashZ	= B-gs_frwt-offset_yL

								simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
								if iSimpleSashFrameTypeL = SIMPLESASH_SLIDEHOR then
									put simpleSashDivx - sashWidthL/2, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + sashWidthL/2, simpleSashZ, 0, mask2, matSash
								else
									put simpleSashDivx - sashWidthL, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + sashWidthL, simpleSashZ, 0, mask2, matSash
								endif
							endif
							put -A/2+gs_sl_w1-gs_frw_Sl_left-offset_xL, B-gs_frwt-offset_yL*not(bExtraPrismOnTopLeft), 0, 10+2*bDiffFrameThk, matSash,
								-A/2+gs_sl_w1+offset_02, B-gs_frwt-offset_02*not(bExtraPrismOnTop_02), 0, mask1-2*bDiffFrameThk - ((i = 1) & bExtraPrismOnTop_02),  matSash
						endif
					endif

					if (iSimpleSashFrameType_02 = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_02 = SIMPLESASH_SIDEHUNG) & not(bExtraPrismOnTop_02) then
						if gs_sidelight_left & gs_LeftMullion_Top then
							SashLeftX = -A/2+gs_sl_w1+offset_02
						else
							SashLeftX = -A/2+gs_frw1+offset_02
						endif
						if gs_sidelight_right & gs_RightMullion_Top then
							SashRightX = A/2-gs_sl_w2-offset_02
						else
							SashRightX = A/2-gs_frw2-offset_02
						endif
						simpleSashZ	= B-gs_frwt-offset_02

						simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
						if iSimpleSashFrameType_02 = SIMPLESASH_SLIDEHOR then
							put simpleSashDivx - gs_sash_width/2, simpleSashZ, 0, 8, matSash,
								simpleSashDivx + gs_sash_width/2, simpleSashZ, 0, mask2, matSash
						else
							put simpleSashDivx - gs_sash_width, simpleSashZ, 0, 8, matSash,
								simpleSashDivx + gs_sash_width, simpleSashZ, 0, mask2, matSash
						endif
					endif

					if gs_sidelight_right & gs_RightMullion_Top then
						if offset_yR*not(bExtraPrismOnTopRight) > EPS | offset_02*not(bExtraPrismOnTop_02) > EPS | gs_frwt > EPS then	! avoiding self intersect. prism
							put A/2-gs_sl_w2-offset_02,  B-gs_frwt-offset_02*not(bExtraPrismOnTop_02), 0, 10+2*bDiffFrameThk, matSash,
								A/2-gs_sl_w2+gs_frw_Sl_right+offset_xR,  B-gs_frwt-offset_yR*not(bExtraPrismOnTopRight), 0, mask1-2*bDiffFrameThk - ((i = 1) & bExtraPrismOnTopRight), matSash
							if (iSimpleSashFrameTypeR = SIMPLESASH_SLIDEHOR | iSimpleSashFrameTypeR = SIMPLESASH_SIDEHUNG) & not(bExtraPrismOnTopRight) then
								SashLeftX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_xR
								SashRightX	= A/2-gs_frw2-offset_xR
								simpleSashZ	= B-gs_frwt-offset_yR

								simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
								if iSimpleSashFrameTypeR = SIMPLESASH_SLIDEHOR then
									put simpleSashDivx - sashWidthR/2, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + sashWidthR/2, simpleSashZ, 0, mask2, matSash
								else
									put simpleSashDivx - sashWidthR, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + sashWidthR, simpleSashZ, 0, mask2, matSash
								endif
							endif
						endif
					endif

					if abs(cutDy + gs_frwt + offset_yR*not(bExtraPrismOnTopRight)) > EPS then	! avoiding self intersect. prism
						put	A/2-gs_frw2-offset_xR*not(bExtraPrismOnTopRight), B-gs_frwt-offset_yR*not(bExtraPrismOnTopRight), 0, 10 - 2*(gs_stack_top | gs_stack_right), matSash,
							A/2 + cutDxRight, b + cutDy, 0, mask1 - 2*(gs_stack_top | gs_stack_right) - 5*gs_stack_top, matSash
					endif
					if nsp > 0 then
						cprism_{2} mat1, botmat, matSash,
								nsp/5, framethick1,
								get(nsp)
					endif
				endif

				gosub 600

			endif


			if gs_SashText_typ_num = 2 then		! Butt Joint

				if gs_pocket_door_frame & lod3D <> 5 then
					cutHeight = TopHeightInny
					gosub "Pocket Door Cutting"
				endif

				if gs_sidelight_left then
					if not(gs_Transom_toLeft) then
						bExtraPrismOnLeftSide = (bDiffFrameThk & (lod3D = 1) & (offset_09 > EPS))
						if gs_bSidelight_fr_hdiv_left then
							bExtraPrismOnLeftSideLower = (bDiffFrameThk & (lod3D = 1) & (offset_11 > EPS))
						else
							bExtraPrismOnLeftSideLower = bExtraPrismOnLeftSide
						endif

						if bExtraPrismOnLeftSide | bExtraPrismOnLeftSideLower then
							put	-A/2+gs_frw1, TopHeightInny-offset_09, 0, 8, matSash,
								-A/2+gs_frw1+offset_09, TopHeightInny-offset_09, 0, mask1 - 2, matSash
							if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEVER then
								if gs_bSidelight_fr_hdiv_left then
									SashBottomY	= horizDivLeftSideUpperPY
								else
									SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_09
								endif
								SashTopY	= TopHeightInny-offset_09
								simpleSashX	= -A/2+gs_frw1+offset_09

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
							endif
							if gs_bSidelight_fr_hdiv_left then
								put horizDivLeftSideLeftUpperPX,	horizDivLeftSideUpperPY, 0, 8,	matSash,
									horizDivLeftSideLeftLowerPX,	horizDivLeftSideLowerPY, 0, mask2 - not(bExtraPrismOnLeftSideLower),	matSash

								if (iSimpleSashFrameType_11 = SIMPLESASH_SLIDEVER) & bExtraPrismOnLeftSideLower then
									SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_11
									SashTopY	= horizDivLeftSideLowerPY
									simpleSashX	= horizDivLeftSideLeftLowerPX

									simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
									put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
										simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
								endif
								offset_i = offset_11
							else
								offset_i = offset_09
							endif
							put	-A/2+gs_frw1+offset_i, LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, 8, matSash,
								-A/2+gs_frw1+offset_i, LeftSLParapet-ovhgBottomLeft, 0, mask1, matSash,
								-A/2+gs_frw1, LeftSLParapet-ovhgBottomLeft, 0, 12, matSash

							cprism_{2} mat1, botmat, matSash,
								nsp/5, framethick2,
								get(nsp)
							body 1
						endif

						put	-A/2 - cutDxLeft, LeftSLParapet-ovhgBottomLeft, 0, mask1 - 7*gs_stack_left, matSash,
							-A/2 - cutDxLeft, TopHeighty-offset_09*not(bExtraPrismOnLeftSide), 0, 8, matSash,
							-A/2+gs_frw1+offset_09*not(bExtraPrismOnLeftSide), TopHeightInny-offset_09*not(bExtraPrismOnLeftSide), 0, mask1 - 2 - ((i = 1) & bExtraPrismOnLeftSide), matSash
						if (iSimpleSashFrameType_09 = SIMPLESASH_SLIDEVER) & not(bExtraPrismOnLeftSide) then
							if gs_bSidelight_fr_hdiv_left then
								SashBottomY	= horizDivLeftSideUpperPY
							else
								SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_09
							endif
							SashTopY	= TopHeightInny-offset_09
							simpleSashX	= -A/2+gs_frw1+offset_09

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						if gs_bSidelight_fr_hdiv_left then
							put horizDivLeftSideLeftUpperPX - offset_09*bExtraPrismOnLeftSide,	horizDivLeftSideUpperPY, 0, mmask,	matSash,
								horizDivLeftSideLeftLowerPX - offset_11*bExtraPrismOnLeftSideLower,	horizDivLeftSideLowerPY, 0, mask2-bExtraPrismOnLeftSideLower,	matSash

							if (iSimpleSashFrameType_11 = SIMPLESASH_SLIDEVER) & not(bExtraPrismOnLeftSideLower) then
								SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_11
								SashTopY	= horizDivLeftSideLowerPY
								simpleSashX	= horizDivLeftSideLeftLowerPX

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
							endif
							offset_i = offset_11
						else
							offset_i = offset_09
						endif
						if i = 1 | not(bDiffFrameThk) then
							put	-A/2+gs_frw1+offset_i*not(bExtraPrismOnLeftSideLower), LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, mmask, matSash
						endif
						put	-A/2+gs_frw1+offset_i*not(bExtraPrismOnLeftSideLower), LeftSLParapet-ovhgBottomLeft, 0, mask1, matSash,
							-A/2 - cutDxLeft, LeftSLParapet-ovhgBottomLeft, 0, -1, matSash

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick1,
							get(nsp)
					else
						bExtraPrismOnLeftSide = (bDiffFrameThk & (lod3D = 1) & (offset_09 > EPS))
						if gs_bSidelight_fr_hdiv_left then
							bExtraPrismOnLeftSideLower = (bDiffFrameThk & (lod3D = 1) & (offset_11 > EPS))
						else
							bExtraPrismOnLeftSideLower = bExtraPrismOnLeftSide
						endif

						if gs_LeftMullion_Top then
							offset_x = offset_10
							offset_y = offset_10
							iSimpleSashFrameType = iSimpleSashFrameType_10
						else
							offset_x = offset_02
							offset_y = offset_02
							iSimpleSashFrameType = iSimpleSashFrameType_02
						endif
						bExtraPrismOnLeftSideTop = (bDiffFrameThk & (lod3D = 1) & (offset_x > EPS))

						if bExtraPrismOnLeftSide | bExtraPrismOnLeftSideTop | bExtraPrismOnLeftSideLower then
							if bExtraPrismOnLeftSideTop then
								put	-A/2+gs_frw1, TopHeightInny-offset_y*(not(bArchedTop)), 0, 8, matSash,
									-A/2+gs_frw1+offset_x, TopHeightInny-offset_y*(not(bArchedTop)), 0, mask1 - 2, matSash
								if iSimpleSashFrameType = SIMPLESASH_SLIDEVER then
									SashBottomY	= lh+gs_frame_width_transom+offset_y
									SashTopY	= TopHeightInny-offset_y
									simpleSashX	= -A/2+gs_frw1+offset_x

									simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
									put simpleSashX, simpleSashDivy + gs_sash_width/2, 0, 8, matSash,
										simpleSashX, simpleSashDivy - gs_sash_width/2, 0, mask2, matSash
								endif
								put	-A/2+gs_frw1+offset_x, lh+gs_frame_width_transom+offset_y, 0, 8, matSash
								if not(bExtraPrismOnLeftSide) then
									put	-A/2+gs_frw1, lh-offset_09, 0, 12, matSash
								endif

								if not(bExtraPrismOnLeftSide) & bExtraPrismOnLeftSideLower then
									cprism_{2} mat1, botmat, matSash,
										nsp/5, framethick2,
										get(nsp)
								endif
							endif
							if bExtraPrismOnLeftSide | bExtraPrismOnLeftSideLower then
								if bExtraPrismOnLeftSide then
									put	-A/2+gs_frw1+offset_09, lh-offset_09, 0, mask1 - 2, matSash
									if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEVER then
										if gs_bSidelight_fr_hdiv_left then
											SashBottomY	= horizDivLeftSideUpperPY
										else
											SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_09
										endif
										SashTopY	= lh-offset_09
										simpleSashX	= -A/2+gs_frw1+offset_09

										simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
										put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
											simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
									endif
								endif
								if gs_bSidelight_fr_hdiv_left then
									put horizDivLeftSideLeftUpperPX,	horizDivLeftSideUpperPY, 0, 8,	matSash,
										horizDivLeftSideLeftLowerPX,	horizDivLeftSideLowerPY, 0, mask2 - not(bExtraPrismOnLeftSideLower),	matSash

									if (iSimpleSashFrameType_11 = SIMPLESASH_SLIDEVER) & bExtraPrismOnLeftSideLower then
										SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_11
										SashTopY	= horizDivLeftSideLowerPY
										simpleSashX	= horizDivLeftSideLeftLowerPX

										simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
										put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
											simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
									endif
									offset_i = offset_11
								else
									offset_i = offset_09
								endif
								if bExtraPrismOnLeftSideLower then
									put	-A/2+gs_frw1+offset_i, LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, 8, matSash,
										-A/2+gs_frw1+offset_i, LeftSLParapet-ovhgBottomLeft, 0, mask1-2, matSash,
										-A/2+gs_frw1, LeftSLParapet-ovhgBottomLeft, 0, 12, matSash
								endif
								if not(bExtraPrismOnLeftSideTop) & bExtraPrismOnLeftSide then
									put	-A/2+gs_frw1, lh+gs_frame_width_transom+offset_y, 0, 8, matSash
								endif
							endif

							cprism_{2} mat1, botmat, matSash,
								nsp/5, framethick2,
								get(nsp)
							body 1
						endif

						put	-A/2 - cutDxLeft, LeftSLParapet-ovhgBottomLeft, 0, mask1 - 7*gs_stack_left, matSash,
							-A/2 - cutDxLeft, TopHeighty-offset_y*(not(bArchedTop))*not(bExtraPrismOnLeftSideTop), 0, 8, matSash,
							-A/2+gs_frw1+offset_x*not(bExtraPrismOnLeftSideTop), TopHeightInny-offset_y*(not(bArchedTop))*not(bExtraPrismOnLeftSideTop), 0, mask1 - 2 - ((i = 1) & bExtraPrismOnLeftSideTop), matSash
						if (iSimpleSashFrameType = SIMPLESASH_SLIDEVER) & not(bExtraPrismOnLeftSideTop) then
							SashBottomY	= lh+gs_frame_width_transom+offset_y
							SashTopY	= TopHeightInny-offset_y
							simpleSashX	= -A/2+gs_frw1+offset_x

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sash_width/2, 0, mask2, matSash
						endif
						if i = 1 | not(bDiffFrameThk) then
							put	-A/2+gs_frw1+offset_x*not(bExtraPrismOnLeftSideTop), lh+gs_frame_width_transom+offset_y, 0, mmask, matSash
						endif
						put	-A/2+gs_frw1+offset_09*not(bExtraPrismOnLeftSide), lh-offset_09, 0, mask1 - 2 - ((i = 1) & bExtraPrismOnLeftSide), matSash
						if (iSimpleSashFrameType_09 = SIMPLESASH_SLIDEVER) & not(bExtraPrismOnLeftSide) then
							if gs_bSidelight_fr_hdiv_left then
								SashBottomY	= horizDivLeftSideUpperPY
							else
								SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_09
							endif
							SashTopY	= lh-offset_09
							simpleSashX	= -A/2+gs_frw1+offset_09

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						if gs_bSidelight_fr_hdiv_left then
							put horizDivLeftSideLeftUpperPX-offset_09*bExtraPrismOnLeftSide,	horizDivLeftSideUpperPY, 0, mmask,	matSash,
								horizDivLeftSideLeftLowerPX-offset_11*bExtraPrismOnLeftSideLower,	horizDivLeftSideLowerPY, 0, mask2-bExtraPrismOnLeftSideLower,	matSash

							if (iSimpleSashFrameType_11 = SIMPLESASH_SLIDEVER) & not(bExtraPrismOnLeftSideLower) then
								SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_11
								SashTopY	= horizDivLeftSideLowerPY
								simpleSashX	= horizDivLeftSideLeftLowerPX

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
							endif
							offset_i = offset_11
						else
							offset_i = offset_09
						endif
						if i = 1 | not(bDiffFrameThk) then
							put	-A/2+gs_frw1+offset_i*not(bExtraPrismOnLeftSideLower), LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, mmask, matSash
						endif
						put	-A/2+gs_frw1+offset_i*not(bExtraPrismOnLeftSideLower), LeftSLParapet-ovhgBottomLeft, 0, mask1, matSash,
							-A/2 - cutDxLeft, LeftSLParapet-ovhgBottomLeft, 0, -1, matSash

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick1,
							get(nsp)
					endif

					gosub 500

					if gs_LeftMullion_Top then
						if gs_Transom_toLeft then
							put	-A/2+gs_sl_w1-gs_frw_Sl_left-offset_10, B-gs_frwt-offset_10, 0, mask1, matSash
							if iSimpleSashFrameType_10 = SIMPLESASH_SLIDEVER then
								SashBottomY	= lh+gs_frame_width_transom+offset_10
								SashTopY	= B-gs_frwt-offset_10
								simpleSashX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_10

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sash_width/2, 0, mask2, matSash
							endif
							put	-A/2+gs_sl_w1-gs_frw_Sl_left-offset_10, lh+gs_frame_width_transom+offset_10, 0, 10, matSash,
								-A/2+gs_sl_w1-gs_frw_Sl_left-offset_09, lh-offset_09, 0, mask1, matSash
						else
							put	-A/2+gs_sl_w1-gs_frw_Sl_left-offset_09, B-gs_frwt-offset_09, 0, mask1, matSash
						endif
					else
						put	-A/2+gs_sl_w1-gs_frw_Sl_left-offset_09, lh-offset_09, 0, mask1, matSash
					endif
					if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEVER then
						if gs_bSidelight_fr_hdiv_left then
							SashBottomY	= horizDivLeftSideUpperPY
						else
							SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_09
						endif
						if gs_Transom_toLeft then
							SashTopY = lh-offset_09
						else
							SashTopY = B-gs_frwt-offset_09
						endif
						simpleSashX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_09

						simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
						put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
							simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
					endif
					if gs_bSidelight_fr_hdiv_left then
						put horizDivLeftSideRightUpperPX,	horizDivLeftSideUpperPY, 0, 8,		matSash,
							horizDivLeftSideRightLowerPX,	horizDivLeftSideLowerPY, 0, mask2,	matSash

						if iSimpleSashFrameType_11 = SIMPLESASH_SLIDEVER then
							SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_11
							SashTopY	= horizDivLeftSideLowerPY
							simpleSashX	= horizDivLeftSideRightLowerPX

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						offset_i = offset_11
					else
						offset_i = offset_09
					endif
					if LeftSLParapet > EPS then
						put -A/2+gs_sl_w1-gs_frw_Sl_left-offset_i, LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, 10, matSash,
							-A/2+gs_sl_w1-gs_frw_SlParapet_left-gs_tolerance_left_2, LeftSLParapet-ovhgBottomLeft, 0, mask1, matSash,
							-A/2+gs_sl_w1-gs_frw_SlParapet_left-gs_tolerance_left_2, -ovhgBottom, 0, mask1, matSash,
							-A/2+gs_sl_w1+offset_leaf, -ovhgBottom, 0, mask3, matLeaf
					else
						put -A/2+gs_sl_w1-gs_frw_Sl_left-offset_i, gs_frame_width_low_left_sl+offset_i, 0, 10, matSash,
							-A/2+gs_sl_w1-gs_frw_Sl_left, -ovhgBottom, 0, mask2, matSash,
							-A/2+gs_sl_w1+offset_leaf, -ovhgBottom, 0, mask1, matLeaf
					endif
					if gs_LeftMullion_Top then
						if gs_Transom_toLeft then
							put	-A/2+gs_sl_w1+offset_leaf, lh-offset_leaf, 0, 10, matSash,
								-A/2+gs_sl_w1+offset_02, lh+gs_frame_width_transom+offset_02, 0, mask1, matSash
							if iSimpleSashFrameType_02 = SIMPLESASH_SLIDEVER then
								SashBottomY	= lh+gs_frame_width_transom+offset_02
								SashTopY	= B-gs_frwt-offset_02
								simpleSashX	= -A/2+gs_sl_w1+offset_02

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy - gs_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy + gs_sash_width/2, 0, mask2, matSash
							endif
							put	-A/2+gs_sl_w1+offset_02, B-gs_frwt-offset_02, 0, 10+4*(bNoExtraPrismOnLeftTop | (bDiffFrameThk & (lod3D = 2))), matSash,
								-A/2+gs_sl_w1-gs_frw_Sl_left-offset_10, B-gs_frwt-offset_10, 0, -1, matSash
						else
							put	-A/2+gs_sl_w1+offset_leaf, lh-offset_leaf, 0, 10, matSash,
								-A/2+gs_sl_w1+offset_02, lh+gs_frame_width_transom+offset_02, 0, mask1, matSash
							if iSimpleSashFrameType_02 = SIMPLESASH_SLIDEVER then
								SashBottomY	= lh+gs_frame_width_transom+offset_02
								SashTopY	= B-gs_frwt-offset_02
								simpleSashX	= -A/2+gs_sl_w1+offset_02

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy - gs_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy + gs_sash_width/2, 0, mask2, matSash
							endif
							put	-A/2+gs_sl_w1+offset_02, b-gs_frwt-offset_02, 0, 10+4*(bNoExtraPrismOnLeftTop | (bDiffFrameThk & (lod3D = 2))), matSash,
								-A/2+gs_sl_w1-gs_frw_Sl_left-offset_09, B-gs_frwt-offset_09, 0, -1, matSash
						endif
					else
						put	-A/2+gs_sl_w1+offset_leaf, lh-offset_leaf, 0, 10, matSash,
							-A/2+gs_sl_w1-gs_frw_Sl_left-offset_09, lh-offset_09, 0, -1, matSash
					endif

					cprism_{2} mat1, botmat, matSash,
						nsp/5, framethick2,
						get(nsp)

					gosub 500

					if gs_bSidelight_fr_hdiv_left then
						iSimpleSashFrameType_i = iSimpleSashFrameType_11
						offset_i = offset_11
					else
						iSimpleSashFrameType_i = iSimpleSashFrameType_09
						offset_i = offset_09
					endif
					if LeftSLParapet > EPS then
						put	-A/2+gs_sl_w1-gs_frw_Sl_left-offset_i, LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, 10, matSash,
							-A/2+gs_sl_w1-gs_frw_SlParapet_left-gs_tolerance_left_2, LeftSLParapet-ovhgBottomLeft, 0, mask1, matSash,
							-A/2+gs_frw1+offset_i, LeftSLParapet-ovhgBottomLeft, 0, mmask2-4*bExtraPrismOnLeftSideLower, matSash,
							-A/2+gs_frw1+offset_i, LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, mask1, matSash
					else
						put	-A/2+gs_sl_w1-gs_frw_Sl_left-offset_i, gs_frame_width_low_left_sl+offset_i, 0, 10, matSash,
							-A/2+gs_sl_w1-gs_frw_Sl_left, -ovhgBottom, 0, mask2, matSash,
							-A/2+gs_frw1+offset_i, -ovhgBottom, 0, mmask2-4*bExtraPrismOnLeftSideLower, matSash,
							-A/2+gs_frw1+offset_i, gs_frame_width_low_left_sl+offset_i, 0, mask1, matSash
					endif
					if iSimpleSashFrameType_i = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_i = SIMPLESASH_SIDEHUNG then
						SashLeftX	= -A/2+gs_frw1+offset_i
						SashRightX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_i
						simpleSashZ	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i

						simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
						if iSimpleSashFrameType_i = SIMPLESASH_SLIDEHOR then
							put simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
								simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
						else
							put simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
								simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
						endif
					endif

					cprism_{2} mat1, botmat, matSash,
						nsp/5, framethick2,
						get(nsp)

					gosub 600
				else
					bExtraPrismOnLeftSideTop = (bDiffFrameThk & (lod3D = 1) & (offset_02 > EPS))
					if bExtraPrismOnLeftSideTop then
						put	-A/2+gs_frw1, TopHeightInny-offset_02*(not(bArchedTop)), 0, 8, matSash,
							-A/2+gs_frw1+offset_02, TopHeightInny-offset_02*(not(bArchedTop)), 0, mask1 - 2, matSash
						if iSimpleSashFrameType_02 = SIMPLESASH_SLIDEVER then
							SashBottomY	= lh+gs_frame_width_transom+offset_02
							SashTopY	= TopHeightInny-offset_02
							simpleSashX	= -A/2+gs_frw1+offset_02

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sash_width/2, 0, mask2, matSash
						endif
						put	-A/2+gs_frw1+offset_02, lh+gs_frame_width_transom+offset_02, 0, 8, matSash,
							-A/2+gs_frw1, lh, 0, 12, matLeaf

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick2,
							get(nsp)
						body 1
					endif

					put	-A/2 - cutDxLeft, -ovhgBottom, 0, mask1 - 7*gs_stack_left, matSash,
						-A/2 - cutDxLeft, TopHeighty-offset_02*(not(bArchedTop))*not(bExtraPrismOnLeftSideTop), 0, 8, matSash,
						-A/2+gs_frw1+offset_02*not(bExtraPrismOnLeftSideTop), TopHeightInny-offset_02*(not(bArchedTop))*not(bExtraPrismOnLeftSideTop), 0, mask1 - 2 - ((i = 1) & bExtraPrismOnLeftSideTop), matSash
					if (iSimpleSashFrameType_02 = SIMPLESASH_SLIDEVER) & not(bExtraPrismOnLeftSideTop) then
						SashBottomY	= lh+gs_frame_width_transom+offset_02
						SashTopY	= TopHeightInny-offset_02
						simpleSashX	= -A/2+gs_frw1+offset_02

						simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
						put simpleSashX, simpleSashDivy + gs_sash_width/2, 0, 8, matSash,
							simpleSashX, simpleSashDivy - gs_sash_width/2, 0, mask2, matSash
					endif
					if i = 1 | not(bDiffFrameThk) then
						put	-A/2+gs_frw1+offset_02*not(bExtraPrismOnLeftSideTop), lh+gs_frame_width_transom+offset_02, 0, mmask, matSash
					endif
					put	-A/2+gs_frw1+offset_leaf, lh-offset_leaf, 0, mask1 - 2, matLeaf,
						-A/2+gs_frw1+offset_leaf, -ovhgBottom, 0, mask1, matSash,
						-A/2 - cutDxLeft, -ovhgBottom, 0, mask1 - 7*gs_stack_left, matSash

					cprism_{2} mat1, botmat, matSash,
						nsp/5, framethick1,
						get(nsp)

					gosub 500
				endif

				if gs_sidelight_right then

					if not(gs_Transom_toRight) then
						bExtraPrismOnRightSide = (bDiffFrameThk & (lod3D = 1) & (offset_05 > EPS))
						if gs_bSidelight_fr_hdiv_right then
							bExtraPrismOnRightSideLower = (bDiffFrameThk & (lod3D = 1) & (offset_07 > EPS))
						else
							bExtraPrismOnRightSideLower = bExtraPrismOnRightSide
						endif

						if bExtraPrismOnRightSide | bExtraPrismOnRightSideLower then
							put	A/2-gs_frw2, TopHeightInny-offset_05, 0, 8, matSash,
								A/2-gs_frw2-offset_05, TopHeightInny-offset_05, 0, mask1 - 2, matSash
							if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEVER then
								if gs_bSidelight_fr_hdiv_right then
									SashBottomY	= horizDivRightSideUpperPY
								else
									SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_05
								endif
								SashTopY	= TopHeightInny-offset_05
								simpleSashX	= A/2-gs_frw2-offset_05

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
							endif
							if gs_bSidelight_fr_hdiv_right then
								put horizDivRightSideRightUpperPX,	horizDivRightSideUpperPY, 0, 8,	matSash,
									horizDivRightSideRightLowerPX,	horizDivRightSideLowerPY, 0, mask2 - not(bExtraPrismOnRightSideLower),	matSash

								if (iSimpleSashFrameType_07 = SIMPLESASH_SLIDEVER) & bExtraPrismOnRightSideLower then
									SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_07
									SashTopY	= horizDivRightSideLowerPY
									simpleSashX	= horizDivRightSideRightLowerPX

									simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
									put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
										simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
								endif
								offset_i = offset_07
							else
								offset_i = offset_05
							endif
							put	A/2-gs_frw2-offset_i, RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, 8, matSash,
								A/2-gs_frw2-offset_i, RightSLParapet-ovhgBottomRight, 0, mask1, matSash,
								A/2-gs_frw2, RightSLParapet-ovhgBottomRight, 0, 12, matSash

							cprism_{2} mat1, botmat, matSash,
								nsp/5, framethick2,
								get(nsp)
							body 1
						endif

						put	A/2 + cutDxRight, RightSLParapet-ovhgBottomRight, 0, mask1 - 7*gs_stack_right, matSash,
							A/2 + cutDxRight, TopHeighty-offset_05*not(bExtraPrismOnRightSide), 0, 8, matSash,
							A/2-gs_frw2-offset_05*not(bExtraPrismOnRightSide), TopHeightInny-offset_05*not(bExtraPrismOnRightSide), 0, mask1 - 2 - ((i = 1) & bExtraPrismOnRightSide), matSash
						if (iSimpleSashFrameType_05 = SIMPLESASH_SLIDEVER) & not(bExtraPrismOnRightSide) then
							if gs_bSidelight_fr_hdiv_right then
								SashBottomY	= horizDivRightSideUpperPY
							else
								SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_05
							endif
							SashTopY	= TopHeightInny-offset_05
							simpleSashX	= A/2-gs_frw2-offset_05

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						if gs_bSidelight_fr_hdiv_right then
							put horizDivRightSideRightUpperPX+offset_05*bExtraPrismOnRightSide,	horizDivRightSideUpperPY, 0, mmask,	matSash,
								horizDivRightSideRightLowerPX+offset_07*bExtraPrismOnRightSideLower,	horizDivRightSideLowerPY, 0, mask2-bExtraPrismOnRightSideLower,	matSash

							if (iSimpleSashFrameType_07 = SIMPLESASH_SLIDEVER) & not(bExtraPrismOnRightSideLower) then
								SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_07
								SashTopY	= horizDivRightSideLowerPY
								simpleSashX	= horizDivRightSideRightLowerPX

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
							endif
							offset_i = offset_07
						else
							offset_i = offset_05
						endif
						if i = 1 | not(bDiffFrameThk) then
							put	A/2-gs_frw2-offset_i*not(bExtraPrismOnRightSideLower), RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, mmask, matSash
						endif
						put	A/2-gs_frw2-offset_i*not(bExtraPrismOnRightSideLower), RightSLParapet-ovhgBottomRight, 0, mask1, matSash,
							A/2 + cutDxRight, RightSLParapet-ovhgBottomRight, 0, -1, matSash

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick1,
							get(nsp)
						body 1
					else
						bExtraPrismOnRightSide = (bDiffFrameThk & (lod3D = 1) & (offset_05 > EPS))
						if gs_bSidelight_fr_hdiv_right then
							bExtraPrismOnRightSideLower = (bDiffFrameThk & (lod3D = 1) & (offset_07 > EPS))
						else
							bExtraPrismOnRightSideLower = bExtraPrismOnRightSide
						endif

						if gs_RightMullion_Top then
								offset_x = offset_06
							offset_y = offset_06
							iSimpleSashFrameType = iSimpleSashFrameType_06
						else
							offset_x = offset_02
							offset_y = offset_02
							iSimpleSashFrameType = iSimpleSashFrameType_02
						endif
						bExtraPrismOnRightSideTop = (bDiffFrameThk & (lod3D = 1) & (offset_x > EPS))

						if bExtraPrismOnRightSide | bExtraPrismOnRightSideTop | bExtraPrismOnRightSideLower then
							if bExtraPrismOnRightSideTop then
								put	A/2-gs_frw2, TopHeightInny-offset_y*(not(bArchedTop)), 0, 8, matSash,
									A/2-gs_frw2-offset_x, TopHeightInny-offset_y*(not(bArchedTop)), 0, mask1 - 2, matSash
								if iSimpleSashFrameType = SIMPLESASH_SLIDEVER then
									SashBottomY	= lh+gs_frame_width_transom+offset_y
									SashTopY	= TopHeightInny-offset_y
									simpleSashX	= A/2-gs_frw2-offset_x

									simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
									put simpleSashX, simpleSashDivy + gs_sash_width/2, 0, 8, matSash,
										simpleSashX, simpleSashDivy - gs_sash_width/2, 0, mask2, matSash
								endif
								put	A/2-gs_frw2-offset_x, lh+gs_frame_width_transom+offset_y, 0, 8, matSash
								if not(bExtraPrismOnRightSide) then
									put	A/2-gs_frw2, lh-offset_05, 0, 12, matSash
								endif

								if not(bExtraPrismOnRightSide) & bExtraPrismOnRightSideLower then
									cprism_{2} mat1, botmat, matSash,
										nsp/5, framethick2,
										get(nsp)
								endif
							endif
							if bExtraPrismOnRightSide | bExtraPrismOnRightSideLower then
								if bExtraPrismOnRightSide then
									put	A/2-gs_frw2-offset_05, lh-offset_05, 0, mask1 - 2, matSash
									if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEVER then
										if gs_bSidelight_fr_hdiv_right then
											SashBottomY	= horizDivRightSideUpperPY
										else
											SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_05
										endif
										SashTopY	= lh-offset_05
										simpleSashX	= A/2-gs_frw2-offset_05

										simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
										put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
											simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
									endif
								endif
								if gs_bSidelight_fr_hdiv_right then
									put horizDivRightSideRightUpperPX,	horizDivRightSideUpperPY, 0, 8,	matSash,
										horizDivRightSideRightLowerPX,	horizDivRightSideLowerPY, 0, mask2 - not(bExtraPrismOnRightSideLower),	matSash

									if (iSimpleSashFrameType_07 = SIMPLESASH_SLIDEVER) & bExtraPrismOnRightSideLower then
										SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_07
										SashTopY	= horizDivRightSideLowerPY
										simpleSashX	= horizDivRightSideRightLowerPX

										simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
										put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
											simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
									endif
									offset_i = offset_07
								else
									offset_i = offset_05
								endif
								if bExtraPrismOnRightSideLower then
									put	A/2-gs_frw2-offset_i, RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, 8, matSash,
										A/2-gs_frw2-offset_i, RightSLParapet-ovhgBottomRight, 0, mask1-2, matSash,
										A/2-gs_frw2, RightSLParapet-ovhgBottomRight, 0, 12, matSash
								endif
								if not(bExtraPrismOnRightSideTop) & bExtraPrismOnRightSide then
									put A/2-gs_frw2, lh+gs_frame_width_transom+offset_y, 0, 8, matSash
								endif
							endif

							cprism_{2} mat1, botmat, matSash,
								nsp/5, framethick2,
								get(nsp)
							body 1
						endif

						put	A/2 + cutDxRight, RightSLParapet-ovhgBottomRight, 0, mask1 - 7*gs_stack_right, matSash,
							A/2 + cutDxRight, TopHeighty-offset_y*(not(bArchedTop))*not(bExtraPrismOnRightSideTop), 0, 8, matSash,
							A/2-gs_frw2-offset_x*not(bExtraPrismOnRightSideTop), TopHeightInny-offset_y*(not(bArchedTop))*not(bExtraPrismOnRightSideTop), 0, mask1 - 2 - ((i = 1) & bExtraPrismOnRightSideTop), matSash
						if (iSimpleSashFrameType = SIMPLESASH_SLIDEVER)& not(bExtraPrismOnRightSideTop) then
							SashBottomY	= lh+gs_frame_width_transom+offset_y
							SashTopY	= TopHeightInny-offset_y
							simpleSashX	= A/2-gs_frw2-offset_x

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sash_width/2, 0, mask2, matSash
						endif
						if i = 1 | not(bDiffFrameThk) then
							put	A/2-gs_frw2-offset_x*not(bExtraPrismOnRightSideTop), lh+gs_frame_width_transom+offset_y, 0, mmask, matSash
						endif
						put	A/2-gs_frw2-offset_05*not(bExtraPrismOnRightSide), lh-offset_05, 0, mask1 - 2 - ((i = 1) & bExtraPrismOnRightSide), matSash
						if (iSimpleSashFrameType_05 = SIMPLESASH_SLIDEVER) & not(bExtraPrismOnRightSide) then
							if gs_bSidelight_fr_hdiv_right then
								SashBottomY	= horizDivRightSideUpperPY
							else
								SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_05
							endif
							SashTopY	= lh-offset_05
							simpleSashX	= A/2-gs_frw2-offset_05

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						if gs_bSidelight_fr_hdiv_right then
							put horizDivRightSideRightUpperPX+offset_05*bExtraPrismOnRightSide,	horizDivRightSideUpperPY, 0, mmask,	matSash,
								horizDivRightSideRightLowerPX+offset_07*bExtraPrismOnRightSideLower,	horizDivRightSideLowerPY, 0, mask2-bExtraPrismOnRightSideLower,	matSash

							if (iSimpleSashFrameType_07 = SIMPLESASH_SLIDEVER) & not(bExtraPrismOnRightSideLower) then
								SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_07
								SashTopY	= horizDivRightSideLowerPY
								simpleSashX	= horizDivRightSideRightLowerPX

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
							endif
							offset_i = offset_07
						else
							offset_i = offset_05
						endif
						if i = 1 | not(bDiffFrameThk) then
							put	A/2-gs_frw2-offset_i*not(bExtraPrismOnRightSideLower), RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, mmask, matSash
						endif
						put	A/2-gs_frw2-offset_i*not(bExtraPrismOnRightSideLower), RightSLParapet-ovhgBottomRight, 0, mask1, matSash,
							A/2 + cutDxRight, RightSLParapet-ovhgBottomRight, 0, -1, matSash

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick1,
							get(nsp)
						body 1
					endif

					gosub 500

					if gs_RightMullion_Top then
						if gs_Transom_toRight then
							put	A/2-gs_sl_w2+gs_frw_Sl_right+offset_06, B-gs_frwt-offset_06, 0, mask1, matSash
							if iSimpleSashFrameType_06 = SIMPLESASH_SLIDEVER then
								SashBottomY	= lh+gs_frame_width_transom+offset_06
								SashTopY	= B-gs_frwt-offset_06
								simpleSashX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_06

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sash_width/2, 0, mask2, matSash
							endif
							put	A/2-gs_sl_w2+gs_frw_Sl_right+offset_06, lh+gs_frame_width_transom+offset_06, 0, 10, matSash,
								A/2-gs_sl_w2+gs_frw_Sl_right+offset_05, lh-offset_05, 0, mask1, matSash
						else
							put	A/2-gs_sl_w2+gs_frw_Sl_right+offset_05, B-gs_frwt-offset_05, 0, mask1, matSash
						endif
					else
						put	A/2-gs_sl_w2+gs_frw_Sl_right+offset_05, lh-offset_05, 0, mask1, matSash
					endif
					if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEVER then
						if gs_bSidelight_fr_hdiv_right then
							SashBottomY	= horizDivRightSideUpperPY
						else
							SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_05
						endif
						if gs_Transom_toRight then
							SashTopY = lh-offset_05
						else
							SashTopY = B-gs_frwt-offset_05
						endif
						simpleSashX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_05

						simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
						put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
							simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
					endif
					if gs_bSidelight_fr_hdiv_right then
						put horizDivRightSideLeftUpperPX,	horizDivRightSideUpperPY, 0, 8,		matSash,
							horizDivRightSideLeftLowerPX,	horizDivRightSideLowerPY, 0, mask2,	matSash

						if iSimpleSashFrameType_07 = SIMPLESASH_SLIDEVER then
							SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_07
							SashTopY	= horizDivRightSideLowerPY
							simpleSashX	= horizDivRightSideLeftLowerPX

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						offset_i = offset_07
					else
						offset_i = offset_05
					endif
					if RightSLParapet > EPS then
						put A/2-gs_sl_w2+gs_frw_Sl_right+offset_i, RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, 10, matSash,
							A/2-gs_sl_w2+gs_frw_SlParapet_right+gs_tolerance_right_2, RightSLParapet-ovhgBottomRight, 0, mask1, matSash,
							A/2-gs_sl_w2+gs_frw_SlParapet_right+gs_tolerance_right_2, -ovhgBottom, 0, mask1, matSash,
							A/2-gs_sl_w2-offset_leaf, -ovhgBottom, 0, mask3, matLeaf
					else
						put A/2-gs_sl_w2+gs_frw_Sl_right+offset_i, gs_frame_width_low_right_sl+offset_i, 0, 10, matSash,
							A/2-gs_sl_w2+gs_frw_Sl_right, -ovhgBottom, 0, mask2, matSash,
							A/2-gs_sl_w2-offset_leaf, -ovhgBottom, 0, mask1, matLeaf
					endif
					if gs_RightMullion_Top then
						if gs_Transom_toRight then
							put	A/2-gs_sl_w2-offset_leaf, lh-offset_leaf, 0, 10, matSash,
								A/2-gs_sl_w2-offset_02, lh+gs_frame_width_transom+offset_02, 0, mask1, matSash
							if iSimpleSashFrameType_02 = SIMPLESASH_SLIDEVER then
								SashBottomY	= lh+gs_frame_width_transom+offset_02
								SashTopY	= B-gs_frwt-offset_02
								simpleSashX	= A/2-gs_sl_w2-offset_02

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy - gs_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy + gs_sash_width/2, 0, mask2, matSash
							endif
							put	A/2-gs_sl_w2-offset_02, B-gs_frwt-offset_02, 0, 10+4*(bNoExtraPrismOnRightTop | (bDiffFrameThk & (lod3D = 2))), matSash,
								A/2-gs_sl_w2+gs_frw_Sl_right+offset_06, B-gs_frwt-offset_06, 0, -1, matSash
						else
							put	A/2-gs_sl_w2-offset_leaf, lh-offset_leaf, 0, 10, matSash,
								A/2-gs_sl_w2-offset_02, lh+gs_frame_width_transom+offset_02, 0, mask1, matSash
							if iSimpleSashFrameType_02 = SIMPLESASH_SLIDEVER then
								SashBottomY	= lh+gs_frame_width_transom+offset_02
								SashTopY	= B-gs_frwt-offset_02
								simpleSashX	= A/2-gs_sl_w2-offset_02

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy - gs_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy + gs_sash_width/2, 0, mask2, matSash
							endif
							put	A/2-gs_sl_w2-offset_02, B-gs_frwt-offset_02, 0, 10+4*(bNoExtraPrismOnRightTop | (bDiffFrameThk & (lod3D = 2))), matSash,
								A/2-gs_sl_w2+gs_frw_Sl_right+offset_05, B-gs_frwt-offset_05, 0, -1, matSash
						endif
					else
						put	A/2-gs_sl_w2-offset_leaf, lh-offset_leaf, 0, 10, matSash,
							A/2-gs_sl_w2+gs_frw_Sl_right+offset_05, lh-offset_05, 0, -1, matSash
					endif

					cprism_{2} mat1, botmat, matSash,
						nsp/5, framethick2,
						get(nsp)

					gosub 500

					if gs_bSidelight_fr_hdiv_right then
						iSimpleSashFrameType_i = iSimpleSashFrameType_07
						offset_i = offset_07
					else
						iSimpleSashFrameType_i = iSimpleSashFrameType_05
						offset_i = offset_05
					endif
					if RightSLParapet > EPS then
						put	A/2-gs_sl_w2+gs_frw_Sl_right+offset_i, RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, 10, matSash,
							A/2-gs_sl_w2+gs_frw_SlParapet_right+gs_tolerance_right_2, RightSLParapet-ovhgBottomRight, 0, mask1, matSash,
							A/2-gs_frw2-offset_i, RightSLParapet-ovhgBottomRight, 0, mmask2-4*bExtraPrismOnRightSideLower, matSash,
							A/2-gs_frw2-offset_i, RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, mask1, matSash
					else
						put	A/2-gs_sl_w2+gs_frw_Sl_right+offset_i, gs_frame_width_low_right_sl+offset_i, 0, 10, matSash,
							A/2-gs_sl_w2+gs_frw_Sl_right, -ovhgBottom, 0, mask2, matSash,
							A/2-gs_frw2-offset_i, -ovhgBottom, 0, mmask2-4*bExtraPrismOnRightSideLower, matSash,
							A/2-gs_frw2-offset_i, gs_frame_width_low_right_sl+offset_i, 0, mask1, matSash
					endif
					if iSimpleSashFrameType_i = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_i = SIMPLESASH_SIDEHUNG then
						SashLeftX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_i
						SashRightX	= A/2-gs_frw2-offset_i
						simpleSashZ	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i

						simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
						if iSimpleSashFrameType_i = SIMPLESASH_SLIDEHOR then
							put simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
								simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
						else
							put simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
								simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
						endif
					endif

					cprism_{2} mat1, botmat, matSash,
						nsp/5, framethick2,
						get(nsp)

					gosub 600
				else
					bExtraPrismOnRightSideTop = (bDiffFrameThk & (lod3D = 1) & (offset_02 > EPS))
					if bExtraPrismOnRightSideTop then
						put	A/2-gs_frw2, TopHeightInny-offset_02*(not(bArchedTop)), 0, 8, matSash
						put	A/2-gs_frw2-offset_02, TopHeightInny-offset_02*(not(bArchedTop)), 0, mask1 - 2, matSash
						if iSimpleSashFrameType_02 = SIMPLESASH_SLIDEVER then
							SashBottomY	= lh+gs_frame_width_transom+offset_02
							SashTopY	= TopHeightInny-offset_02
							simpleSashX	= A/2-gs_frw2-offset_02

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sash_width/2, 0, mask2, matSash
						endif
						put	A/2-gs_frw2-offset_02, lh+gs_frame_width_transom+offset_02, 0, 8, matSash,
							A/2-gs_frw2, lh, 0, 12, matLeaf

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick2,
							get(nsp)
						body 1
					endif

					put	A/2 + cutDxRight, -ovhgBottom, 0, mask1 - 7*gs_stack_right, matSash,
						A/2 + cutDxRight, TopHeighty-offset_02*(not(bArchedTop))*not(bExtraPrismOnRightSideTop), 0, 8, matSash,
						A/2-gs_frw2-offset_02*not(bExtraPrismOnRightSideTop), TopHeightInny-offset_02*(not(bArchedTop))*not(bExtraPrismOnRightSideTop), 0, mask1 - 2 - ((i = 1) & bExtraPrismOnRightSideTop), matSash
					if (iSimpleSashFrameType_02 = SIMPLESASH_SLIDEVER) & not(bExtraPrismOnRightSideTop) then
						SashBottomY	= lh+gs_frame_width_transom+offset_02
						SashTopY	= TopHeightInny-offset_02
						simpleSashX	= A/2-gs_frw2-offset_02

						simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
						put simpleSashX, simpleSashDivy + gs_sash_width/2, 0, 8, matSash,
							simpleSashX, simpleSashDivy - gs_sash_width/2, 0, mask2, matSash
					endif
					if i = 1 | not(bDiffFrameThk) then
						put	A/2-gs_frw2-offset_02*not(bExtraPrismOnRightSideTop), lh+gs_frame_width_transom+offset_02, 0, mmask, matSash
					endif
					put	A/2-gs_frw2-offset_leaf, lh-offset_leaf, 0, mask1 - 2, matLeaf,
						A/2-gs_frw2-offset_leaf, -ovhgBottom, 0, mask1, matSash,
						A/2 + cutDxRight, -ovhgBottom, 0, -1, matSash

					cprism_{2} mat1, botmat, matSash,
						nsp/5, framethick1,
						get(nsp)

					gosub 500
				endif

				if gs_pocket_door_frame & lod3D <> 5 then
					cutend
					if n=2 then cutend
				endif

				if bArchedTop then
					cprism_{2} mat1, botmat, matSash,
						7, framethick1,
						-A/2 - cutDxLeft, gs_shoulder_h, 0, mask1 + 64, matSash,
						 0, frametop - r2, 0, 900, matSash,
						 0, B + cutDy, 0, 3064 + mask1, matSash,
						 A/2 + cutDxRight, gs_shoulder_h, 0, 3010, matSash,
						 A/2-gs_frw2-offset_02, gs_shoulder_h-(fce-fcefw), 0, mask1 + 64, matSash,
						 0, B-gs_frwt-offset_02, 0, 3064 + mask1, matSash,
						-A/2+gs_frw1+offset_02,  gs_shoulder_h-(fce-fcefw), 0, 3010, matSash
					body 1
				else
					bExtraPrismOnTop_02 = 0
					bExtraPrismOnTopLeft = 0
					bExtraPrismOnTopRight = 0

					bExtraPrismOnTop_02 = (bDiffFrameThk & (lod3D = 1) & (offset_02 > EPS))
					if gs_sidelight_left & gs_LeftMullion_Top then
						if gs_Transom_toLeft then
							iSimpleSashFrameTypeL = iSimpleSashFrameType_10
							offset_xL = offset_10
							offset_yL = offset_10
							sashWidthL = gs_sash_width
						else
							iSimpleSashFrameTypeL = iSimpleSashFrameType_09
							offset_xL = offset_09
							offset_yL = offset_09
							sashWidthL = gs_sl_sash_width
						endif
					else
						offset_xL = offset_02
						offset_yL = offset_02
						sashWidthL = gs_sash_width
					endif
					bExtraPrismOnTopLeft = (bDiffFrameThk & (lod3D = 1) & (offset_xL > EPS))

					if gs_sidelight_right & gs_RightMullion_Top then
						if gs_Transom_toRight then
							iSimpleSashFrameTypeR = iSimpleSashFrameType_06
							offset_xR = offset_06
							offset_yR = offset_06
							sashWidthR = gs_sash_width
						else
							iSimpleSashFrameTypeR = iSimpleSashFrameType_05
							offset_xR = offset_05
							offset_yR = offset_05
							sashWidthR = gs_sl_sash_width
						endif
					else
						offset_xR = offset_02
						offset_yR = offset_02
						sashWidthR = gs_sash_width
					endif
					bExtraPrismOnTopRight = (bDiffFrameThk & (lod3D = 1) & (offset_xR > EPS))

					if bExtraPrismOnTop_02 | bExtraPrismOnTopLeft | bExtraPrismOnTopRight then
						put	-A/2+gs_frw1,			B-gs_frwt, 			0, 12,		matSash,
							-A/2+gs_frw1,			B-gs_frwt-offset_yL, 	0, 8,		matSash,
							-A/2+gs_frw1+offset_xL,	B-gs_frwt-offset_yL, 	0, mask1,	matSash

						if gs_sidelight_left & gs_LeftMullion_Top then
							if iSimpleSashFrameTypeL = SIMPLESASH_SLIDEHOR | iSimpleSashFrameTypeL = SIMPLESASH_SIDEHUNG then
								SashLeftX	= -A/2+gs_frw1+offset_xL
								SashRightX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_xL
								simpleSashZ	= B-gs_frwt-offset_yL

								simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
								if iSimpleSashFrameTypeL = SIMPLESASH_SLIDEHOR then
									put simpleSashDivx - sashWidthL/2, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + sashWidthL/2, simpleSashZ, 0, mask2, matSash
								else
									put simpleSashDivx - sashWidthL, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + sashWidthL, simpleSashZ, 0, mask2, matSash
								endif
							endif

							put -A/2+gs_sl_w1-gs_frw_Sl_left-offset_xL,  B-gs_frwt-offset_yL, 0, 10, matSash,
								-A/2+gs_sl_w1+offset_02,  B-gs_frwt-offset_02, 0, mask1,  matSash
						endif

						if iSimpleSashFrameType_02 = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_02 = SIMPLESASH_SIDEHUNG then
							if gs_sidelight_left & gs_LeftMullion_Top then
								SashLeftX = -A/2+gs_sl_w1+offset_02
							else
								SashLeftX = -A/2+gs_frw1+offset_02
							endif
							if gs_sidelight_right & gs_RightMullion_Top then
								SashRightX = A/2-gs_sl_w2-offset_02
							else
								SashRightX = A/2-gs_frw2-offset_02
							endif
							simpleSashZ	= B-gs_frwt-offset_02

							simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
							if iSimpleSashFrameType_02 = SIMPLESASH_SLIDEHOR then
								put simpleSashDivx - gs_sash_width/2, simpleSashZ, 0, 8, matSash,
									simpleSashDivx + gs_sash_width/2, simpleSashZ, 0, mask2, matSash
							else
								put simpleSashDivx - gs_sash_width, simpleSashZ, 0, 8, matSash,
									simpleSashDivx + gs_sash_width, simpleSashZ, 0, mask2, matSash
							endif
						endif

						if gs_sidelight_right & gs_RightMullion_Top then
							put A/2-gs_sl_w2-offset_02,  B-gs_frwt-offset_02, 0, 10, matSash,
								A/2-gs_sl_w2+gs_frw_Sl_right+offset_xR,  B-gs_frwt-offset_yR, 0, mask1, matSash

							if iSimpleSashFrameTypeR = SIMPLESASH_SLIDEHOR | iSimpleSashFrameTypeR = SIMPLESASH_SIDEHUNG then
								SashLeftX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_xR
								SashRightX	= A/2-gs_frw2-offset_xR
								simpleSashZ	= B-gs_frwt-offset_yR

								simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
								if iSimpleSashFrameTypeR = SIMPLESASH_SLIDEHOR then
									put simpleSashDivx - sashWidthR/2, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + sashWidthR/2, simpleSashZ, 0, mask2, matSash
								else
									put simpleSashDivx - sashWidthR, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + sashWidthR, simpleSashZ, 0, mask2, matSash
								endif
							endif
						endif

						put	A/2-gs_frw2-offset_xR,	B-gs_frwt-offset_yR,	0, 10,			matSash,
							A/2-gs_frw2,			B-gs_frwt-offset_yR,	0, 12,	matSash,
							A/2-gs_frw2,			B-gs_frwt,				0, 12,			matSash

						cprism_{2} mat1, botmat, matSash,
								nsp/5, framethick2,
								get(nsp)
						body 1
					endif

					if abs(cutDy + gs_frwt + offset_yL*not(bExtraPrismOnTopLeft)) > EPS then	! avoiding self intersect. prism
						put	-A/2 - cutDxLeft,		B + cutDy, 						0, mask1 - 2*(gs_stack_top | gs_stack_left) - 5*gs_stack_left,	matSash,
							-A/2 - cutDxLeft,		B-gs_frwt-offset_yL*not(bExtraPrismOnTopLeft), 	0, 8,		matSash,
							-A/2+gs_frw1+offset_xL*not(bExtraPrismOnTopLeft),	B-gs_frwt-offset_yL*not(bExtraPrismOnTopLeft), 	0, mask1 - ((i = 1) & bExtraPrismOnTopLeft),	matSash
					endif

					if gs_sidelight_left & gs_LeftMullion_Top then
						if offset_yL*not(bExtraPrismOnTopLeft) > EPS | offset_02*not(bExtraPrismOnTop_02) > EPS | gs_frwt > EPS then	! avoiding self intersect. prism
							if (iSimpleSashFrameTypeL = SIMPLESASH_SLIDEHOR | iSimpleSashFrameTypeL = SIMPLESASH_SIDEHUNG) & not(bExtraPrismOnTopLeft) then
								SashLeftX	= -A/2+gs_frw1+offset_xL
								SashRightX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_xL
								simpleSashZ	= B-gs_frwt-offset_yL

								simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
								if iSimpleSashFrameTypeL = SIMPLESASH_SLIDEHOR then
									put simpleSashDivx - sashWidthL/2, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + sashWidthL/2, simpleSashZ, 0, mask2, matSash
								else
									put simpleSashDivx - sashWidthL, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + sashWidthL, simpleSashZ, 0, mask2, matSash
								endif
							endif
							put -A/2+gs_sl_w1-gs_frw_Sl_left-offset_xL, B-gs_frwt-offset_yL*not(bExtraPrismOnTopLeft), 0, 10+2*bDiffFrameThk, matSash,
								-A/2+gs_sl_w1+offset_02, B-gs_frwt-offset_02*not(bExtraPrismOnTop_02), 0, mask1-2*bDiffFrameThk - ((i = 1) & bExtraPrismOnTop_02), matSash
						endif
					endif

					if (iSimpleSashFrameType_02 = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_02 = SIMPLESASH_SIDEHUNG) & not(bExtraPrismOnTop_02) then
						if gs_sidelight_left & gs_LeftMullion_Top then
							SashLeftX = -A/2+gs_sl_w1+offset_02
						else
							SashLeftX = -A/2+gs_frw1+offset_02
						endif
						if gs_sidelight_right & gs_RightMullion_Top then
							SashRightX = A/2-gs_sl_w2-offset_02
						else
							SashRightX = A/2-gs_frw2-offset_02
						endif
						simpleSashZ	= B-gs_frwt-offset_02

						simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
						if iSimpleSashFrameType_02 = SIMPLESASH_SLIDEHOR then
							put simpleSashDivx - gs_sash_width/2, simpleSashZ, 0, 8, matSash,
								simpleSashDivx + gs_sash_width/2, simpleSashZ, 0, mask2, matSash
						else
							put simpleSashDivx - gs_sash_width, simpleSashZ, 0, 8, matSash,
								simpleSashDivx + gs_sash_width, simpleSashZ, 0, mask2, matSash
						endif
					endif

					if gs_sidelight_right & gs_RightMullion_Top then
						if offset_02*not(bExtraPrismOnTop_02) > EPS | offset_yR*not(bExtraPrismOnTopRight) > EPS | gs_frwt > EPS then	! avoiding self intersect. prism
							put A/2-gs_sl_w2-offset_02, B-gs_frwt-offset_02*not(bExtraPrismOnTop_02), 0, 10+2*bDiffFrameThk, matSash,
								A/2-gs_sl_w2+gs_frw_Sl_right+offset_xR, B-gs_frwt-offset_yR*not(bExtraPrismOnTopRight), 0, mask1-2*bDiffFrameThk - ((i = 1) & bExtraPrismOnTopRight), matSash

							if (iSimpleSashFrameTypeR = SIMPLESASH_SLIDEHOR | iSimpleSashFrameTypeR = SIMPLESASH_SIDEHUNG) & not(bExtraPrismOnTopRight) then
								SashLeftX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_xR
								SashRightX	= A/2-gs_frw2-offset_xR
								simpleSashZ	= B-gs_frwt-offset_yR

								simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
								if iSimpleSashFrameTypeR = SIMPLESASH_SLIDEHOR then
									put simpleSashDivx - sashWidthR/2, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + sashWidthR/2, simpleSashZ, 0, mask2, matSash
								else
									put simpleSashDivx - sashWidthR, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + sashWidthR, simpleSashZ, 0, mask2, matSash
								endif
							endif
						endif
					endif

					if abs(cutDy + gs_frwt + offset_yR*not(bExtraPrismOnTopRight)) > EPS then	! avoiding self intersect. prism
						put	A/2-gs_frw2-offset_xR*not(bExtraPrismOnTopRight),	B-gs_frwt-offset_yR*not(bExtraPrismOnTopRight),	0, 10,			matSash,
							A/2 + cutDxRight,		B-gs_frwt-offset_yR*not(bExtraPrismOnTopRight),	0, mask1 - 2 - 5*gs_stack_right,	matSash,
							A/2 + cutDxRight,		B + cutDy,						0, mask1 - 2*(gs_stack_top | gs_stack_right) - 5*gs_stack_top,		matSash
					endif
					if nsp > 0 then
						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick1,
							get(nsp)
					endif
				endif

				gosub 600

			endif


			!************* Both in Type1 and Type2

			if gs_frame_wthk = 0 then mmask=10 else mmask=8

			if gs_sidelight_left & gs_LeftMullion_Top then
				SashLeftX = -A/2+gs_sl_w1+offset_02
			else
				SashLeftX = -A/2+gs_frw1+offset_02
			endif
			if gs_sidelight_right & gs_RightMullion_Top then
				SashRightX = A/2-gs_sl_w2-offset_02
			else
				SashRightX = A/2-gs_frw2-offset_02
			endif
			SashBottomY	= lh+gs_frame_width_transom+offset_02
			SashTopY	= B-gs_frwt-offset_02
			sashWidth	= gs_sash_width
			iSimpleSashFrameType_i = iSimpleSashFrameType_02

			gosub "Extra Frame to Simple Sash"

			if gs_sidelight_left then
				if gs_bSidelight_fr_hdiv_left then
					SashLeftX	= -A/2+gs_frw1+offset_11
					SashRightX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_11
					SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_11
					SashTopY	= horizDivLeftSideLowerPY
					sashWidth	= gs_sl_sash_width
					iSimpleSashFrameType_i = iSimpleSashFrameType_11

					gosub "Extra Frame to Simple Sash"
				endif

				SashLeftX	= -A/2+gs_frw1+offset_09
				SashRightX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_09
				if gs_bSidelight_fr_hdiv_left then
					SashBottomY	= horizDivLeftSideUpperPY
				else
					SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_09
				endif
				if gs_Transom_toLeft then
					SashTopY	= lh-offset_09
				else
					SashTopY	= B-gs_frwt-offset_09
				endif
				sashWidth	= gs_sl_sash_width
				iSimpleSashFrameType_i = iSimpleSashFrameType_09

				gosub "Extra Frame to Simple Sash"

				if gs_Transom_toLeft & gs_LeftMullion_Top then

					SashLeftX	= -A/2+gs_frw1+offset_10
					SashRightX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_10
					SashBottomY	= lh+gs_frame_width_transom+offset_10
					SashTopY	= B-gs_frwt-offset_10
					sashWidth	= gs_sash_width
					iSimpleSashFrameType_i = iSimpleSashFrameType_10

					gosub "Extra Frame to Simple Sash"

					put -A/2+gs_frw1+offset_10, B-_transomHeight+gs_frame_width_transom+offset_10, 0, mask1, matSash

					if iSimpleSashFrameType_10 = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_10 = SIMPLESASH_SIDEHUNG then
						SashLeftX	= -A/2+gs_frw1+offset_10
						SashRightX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_10
						simpleSashZ	= B-_transomHeight+gs_frame_width_transom+offset_10

						simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
						if iSimpleSashFrameType_10 = SIMPLESASH_SLIDEHOR then
							put simpleSashDivx - gs_sash_width/2, simpleSashZ, 0, 8, matSash,
								simpleSashDivx + gs_sash_width/2, simpleSashZ, 0, mask2, matSash
						else
							put simpleSashDivx - gs_sash_width, simpleSashZ, 0, 8, matSash,
								simpleSashDivx + gs_sash_width, simpleSashZ, 0, mask2, matSash
						endif
					endif

					put -A/2+gs_sl_w1-gs_frw_Sl_left-offset_10, B-_transomHeight+gs_frame_width_transom+offset_10, 0, 10, matSash,
						-A/2+gs_sl_w1-gs_frw_Sl_left-offset_09, B-_transomHeight-offset_09, 0, mask1, matSash

					if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_09 = SIMPLESASH_SIDEHUNG then
						SashLeftX	= -A/2+gs_frw1+offset_09
						SashRightX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_09
						simpleSashZ	= B-_transomHeight-offset_09

						simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
						if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEHOR then
							put simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
								simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
						else
							put simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
								simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
						endif
					endif

					put -A/2+gs_frw1+offset_09, B-_transomHeight-offset_09, 0, mmask2-4*(bExtraPrismOnLeftSide | bExtraPrismOnLeftSideTop), matSash

					cprism_{2} topmat, botmat, matSash,
						nsp/5, framethick2,
						get(nsp)

					gosub 600
				endif
			endif

			if gs_sidelight_right then
				if gs_bSidelight_fr_hdiv_right then
					SashLeftX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_07
					SashRightX	= A/2-gs_frw2-offset_07
					SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_07
					SashTopY	= horizDivRightSideLowerPY
					sashWidth	= gs_sl_sash_width
					iSimpleSashFrameType_i = iSimpleSashFrameType_07

					gosub "Extra Frame to Simple Sash"
				endif

				SashLeftX	= A/2-gs_frw2-offset_05
				SashRightX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_05
				if gs_bSidelight_fr_hdiv_right then
					SashBottomY	= horizDivRightSideUpperPY
				else
					SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_05
				endif
				if gs_Transom_toRight then
					SashTopY = lh-offset_05
				else
					SashTopY = B-gs_frwt-offset_05
				endif
				sashWidth	= gs_sl_sash_width
				iSimpleSashFrameType_i = iSimpleSashFrameType_05

				gosub "Extra Frame to Simple Sash"

				if gs_Transom_toRight & gs_RightMullion_Top then

					SashLeftX	= A/2-gs_frw2+offset_06
					SashRightX	= A/2-gs_sl_w2+gs_frw_Sl_right-offset_06
					SashBottomY	= lh+gs_frame_width_transom+offset_06
					SashTopY	= B-gs_frwt-offset_06
					sashWidth	= gs_sash_width
					iSimpleSashFrameType_i = iSimpleSashFrameType_06

					gosub "Extra Frame to Simple Sash"

					put	A/2-gs_frw2-offset_06, B-_transomHeight+gs_frame_width_transom+offset_06, 0, mask1, matSash

					if iSimpleSashFrameType_06 = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_06 = SIMPLESASH_SIDEHUNG then
						SashLeftX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_06
						SashRightX	= A/2-gs_frw2-offset_06
						simpleSashZ	= B-_transomHeight+gs_frame_width_transom+offset_06

						simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
						if iSimpleSashFrameType_06 = SIMPLESASH_SLIDEHOR then
							put simpleSashDivx + gs_sash_width/2, simpleSashZ, 0, 8, matSash,
								simpleSashDivx - gs_sash_width/2, simpleSashZ, 0, mask2, matSash
						else
							put simpleSashDivx + gs_sash_width, simpleSashZ, 0, 8, matSash,
								simpleSashDivx - gs_sash_width, simpleSashZ, 0, mask2, matSash
						endif
					endif

					put	A/2-gs_sl_w2+gs_frw_Sl_right+offset_06, B-_transomHeight+gs_frame_width_transom+offset_06, 0, 10, matSash,
						A/2-gs_sl_w2+gs_frw_Sl_right+offset_05, B-_transomHeight-offset_05, 0, mask1, matSash

					if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_05 = SIMPLESASH_SIDEHUNG then
						SashLeftX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_05
						SashRightX	= A/2-gs_frw2-offset_05
						simpleSashZ	= B-_transomHeight-offset_05

						simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
						if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEHOR then
							put simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
								simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
						else
							put simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
								simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
						endif
					endif

					put	A/2-gs_frw2-offset_05, B-_transomHeight-offset_05, 0, mmask2-4*(bExtraPrismOnRightSide | bExtraPrismOnRightSideTop), matSash

					cprism_{2} topmat, botmat, matSash,
						nsp/5, framethick2,
						get(nsp)

					gosub 600
				endif
			endif

			if gs_sidelight_left then
				if not(gs_Transom_toLeft) then
					if gs_LeftMullion_Top then
						put -A/2+gs_sl_w1+offset_02, B-_transomHeight+gs_frame_width_transom+offset_02, 0, 10, matSash,
							-A/2+gs_sl_w1+offset_leaf, B-_transomHeight-offset_leaf, 0, mask3, matLeaf
					else
						put -A/2+gs_sl_w1-gs_frw_Sl_left, B-_transomHeight+gs_frame_width_transom, 0, mask1, matSash,
							-A/2+gs_sl_w1-gs_frw_Sl_left,  B-_transomHeight, 0, 8, matSash,
							-A/2+gs_sl_w1+offset_leaf, B-_transomHeight-offset_leaf, 0, mask3, matLeaf
					endif
				else
					if gs_LeftMullion_Top then
						put -A/2+gs_sl_w1+offset_02, B-_transomHeight+gs_frame_width_transom+offset_02, 0, 10, matSash,
							-A/2+gs_sl_w1+offset_leaf, B-_transomHeight-offset_leaf, 0, mask3, matLeaf
					else
						put -A/2+gs_sl_w1-gs_frw_Sl_left, B-_transomHeight+gs_frame_width_transom+offset_02, 0, mask1 - 2, matSash,
							-A/2+gs_frw1+offset_02, B-_transomHeight+gs_frame_width_transom+offset_02, 0, mmask2-4*(bExtraPrismOnLeftSide | bExtraPrismOnLeftSideTop), matSash,
							-A/2+gs_frw1+offset_09, B-_transomHeight-offset_09, 0, mask1, matSash

						if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_09 = SIMPLESASH_SIDEHUNG then
							SashLeftX	= -A/2+gs_frw1+offset_09
							SashRightX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_09
							simpleSashZ	= B-_transomHeight-offset_09

							simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
							if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEHOR then
								put simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
									simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
							else
								put simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
									simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
							endif
						endif

						put	-A/2+gs_sl_w1-gs_frw_Sl_left-offset_09, B-_transomHeight-offset_09, 0, 10, matSash,
							-A/2+gs_sl_w1+offset_leaf, B-_transomHeight-offset_leaf, 0, mask3, matLeaf
					endif
				endif
			else
				put -A/2+gs_frw1+offset_02, B-_transomHeight+gs_frame_width_transom+offset_02, 0, mmask2-4*bExtraPrismOnLeftSideTop, matSash,
					-A/2+gs_frw1+offset_leaf, B-_transomHeight-offset_leaf, 0, mask1, matLeaf
			endif

			if gs_sidelight_right then
				if not(gs_Transom_toRight) then
					if gs_RightMullion_Top then
						put A/2-gs_sl_w2-offset_leaf, B-_transomHeight-offset_leaf, 0, 10, matSash,
							A/2-gs_sl_w2-offset_02, B-_transomHeight+gs_frame_width_transom+offset_02, 0, mask1, matSash
					else
						put A/2-gs_sl_w2-offset_leaf, B-_transomHeight-offset_leaf, 0, 10, matSash,
							A/2-gs_sl_w2+gs_frw_Sl_right, B-_transomHeight, 0, mask1 - 2, matSash,
							A/2-gs_sl_w2+gs_frw_Sl_right, B-_transomHeight+gs_frame_width_transom, 0, mask1, matSash
					endif
				else
					if gs_RightMullion_Top then
						put A/2-gs_sl_w2-offset_leaf, B-_transomHeight-offset_leaf, 0, 10, matSash,
							A/2-gs_sl_w2-offset_02, B-_transomHeight+gs_frame_width_transom+offset_02, 0, mask1, matSash
					else
						put A/2-gs_sl_w2-offset_leaf, B-_transomHeight-offset_leaf, 0, 10, matSash,
							A/2-gs_sl_w2+gs_frw_Sl_right+offset_05, B-_transomHeight-offset_05, 0, mask1, matSash

						if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_05 = SIMPLESASH_SIDEHUNG then
							SashLeftX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_05
							SashRightX	= A/2-gs_frw2-offset_05
							simpleSashZ	= B-_transomHeight-offset_05

							simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
							if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEHOR then
								put simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
									simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
							else
								put simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
									simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
							endif
						endif

						put	A/2-gs_frw2-offset_05, B-_transomHeight-offset_05, 0, mmask2-4*(bExtraPrismOnRightSide | bExtraPrismOnRightSideTop), matSash,
							A/2-gs_frw2-offset_02, B-_transomHeight+gs_frame_width_transom+offset_02, 0, mask1, matSash,
							A/2-gs_sl_w2, B-_transomHeight+gs_frame_width_transom+offset_02, 0, mask1 - 2, matSash
					endif
				endif
			else
				put A/2-gs_frw2-offset_leaf, B-_transomHeight-offset_leaf, 0, mmask2-4*bExtraPrismOnRightSideTop, matSash,
					A/2-gs_frw2-offset_02, B-_transomHeight+gs_frame_width_transom+offset_02, 0, mask1, matSash
			endif

			if iSimpleSashFrameType_02 = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_02 = SIMPLESASH_SIDEHUNG then
				if gs_LeftMullion_Top then
					SashLeftX = -A/2+gs_sl_w1+offset_02
				else
					SashLeftX = -A/2+gs_frw1+offset_02
				endif
				if gs_RightMullion_Top then
					SashRightX = A/2-gs_sl_w2-offset_02
				else
					SashRightX = A/2-gs_frw2-offset_02
				endif
				simpleSashZ	= B-_transomHeight+gs_frame_width_transom+offset_02

				simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
				if iSimpleSashFrameType_02 = SIMPLESASH_SLIDEHOR then
					put simpleSashDivx + gs_sash_width/2, simpleSashZ, 0, 8, matSash,
						simpleSashDivx - gs_sash_width/2, simpleSashZ, 0, mask2, matSash
				else
					put simpleSashDivx + gs_sash_width, simpleSashZ, 0, 8, matSash,
						simpleSashDivx - gs_sash_width, simpleSashZ, 0, mask2, matSash
				endif
			endif

			if nsp then
				cprism_{2} topmat, botmat, matSash,
						nsp/5, framethick2,
						get(nsp)
			endif

			gosub 600

			addz frameThickOffset

		next i

		del n

		body -1

	else

! =============================================================================
! Frame WITHOUT Transom
! =============================================================================

! Door Stop -------------------------------------------------------------------

		if gs_frame_style_m = FRAME_STYLE_DOUBLE_REBATE & lod3D > 1 then

			addz LeafRebate*(abs(gs_ds_pr)<eps)+gs_ds_pr*(abs(gs_ds_pr)>eps)

			if bArchedTop then
				base

				cprism_ topmat, botmat, sidemat,
					4, gs_ds_thk,
					-A/2+gs_frw1, 0, 15,
					-A/2+gs_frw1, gs_shoulder_h-(fce-fcefw), 10,
					-A/2+gs_frw1+gs_ds_w, gs_shoulder_h-(fce-fceds), 13,
					-A/2+gs_frw1+gs_ds_w, 0, 15

				gosub 500

				cprism_ topmat, botmat, sidemat,
					4, gs_ds_thk,
					A/2-gs_frw2, 0, 15,
					A/2-gs_frw2, gs_shoulder_h-(fce-fcefw), 10,
					A/2-gs_frw2-gs_ds_w, gs_shoulder_h-(fce-fceds), 13,
					A/2-gs_frw2-gs_ds_w, 0, 15

				gosub 500

				if gs_mf then
					addx A/2-gs_mf_pos
					cutform 4, 1, 2 + 16,
						0, 0, -1, 0,
						-gs_mf_w/2-offset_leaf, 0, 	15+16+32,
						-gs_mf_w/2-offset_leaf, B-gs_frwt-offset_leaf,	10+16+32,
						 gs_mf_w/2+offset_leaf,	B-gs_frwt-offset_leaf,	15+16+32,
						 gs_mf_w/2+offset_leaf,	0,	15+16+32
					body 1
					del 1
				endif

				cprism_ topmat, botmat, sidemat,
					7, gs_ds_thk,
					-A/2+gs_frw1, gs_shoulder_h-(fce-fcefw), 79,
					0, frametop - r2, 900,
					0, frametop, 3079,
					A/2-gs_frw2, gs_shoulder_h-(fce-fcefw), 3010,
					A/2-gs_frw2-gs_ds_w, gs_shoulder_h-(fce-fceds), 79,
					0, b-gs_frwt-gs_ds_w, 3079,
					-A/2+gs_frw1+gs_ds_w, gs_shoulder_h-(fce-fceds), 3010

				gosub 600

				if gs_mf then
					cutend

					cutform 6, 1, 2 + 16,
						0, 0, -1, 0,
						frameleft, B, 15+16+32,
						frameright, B, 15+16+32,
						0, frametop - r2, 900,
						A/2-gs_frw2-gs_ds_w, gs_shoulder_h-(fce-fceds), 15+16+32,
						0, b-gs_frwt-gs_ds_w, 3015+16+32,
						-A/2+gs_frw1+gs_ds_w, gs_shoulder_h-(fce-fceds), 3010+16+32

					addx A/2-gs_mf_pos
					cprism_ topmat, botmat, sidemat,
						4, gs_ds_thk,
						gs_mf_w/2, 0, 15,
						gs_mf_w/2, B-gs_frwt, 10,
						gs_mf_w/2+gs_ds_w, B-gs_frwt, 13,
						gs_mf_w/2+gs_ds_w, 0, 15

					gosub 500

					cprism_ topmat, botmat, sidemat,
						4, gs_ds_thk,
						-gs_mf_w/2, 0, 15,
						-gs_mf_w/2, B-gs_frwt, 10,
						-gs_mf_w/2-gs_ds_w, B-gs_frwt, 13,
						-gs_mf_w/2-gs_ds_w, 0, 15

					gosub 500
					del 1

					cutend
				endif
			else
				if gs_SashText_typ_num = 1 then		! Mitered Joint

					base

					cprism_ topmat, botmat, sidemat,
						4, gs_ds_thk,
						-A/2+gs_sl_w1, 0, 15,
						-A/2+gs_sl_w1, b-gs_frwt, 10,
						-A/2+gs_sl_w1+gs_ds_w, b-gs_frwt-gs_ds_w, 13,
						-A/2+gs_sl_w1+gs_ds_w,0,15

					gosub 500

					cprism_ topmat, botmat, sidemat,
						4, gs_ds_thk,
						A/2-gs_sl_w2, 0, 15,
						A/2-gs_sl_w2, b-gs_frwt, 10,
						A/2-gs_sl_w2-gs_ds_w, b-gs_frwt-gs_ds_w, 13,
						A/2-gs_sl_w2-gs_ds_w, 0,15

					gosub 500

					if gs_mf then
						cprism_ topmat, botmat, sidemat,
							4, gs_ds_thk,
							A/2-gs_mf_pos-gs_mf_w/2-gs_ds_w, 0, 	15,
							A/2-gs_mf_pos-gs_mf_w/2-gs_ds_w, b-gs_frwt-gs_ds_w,	10,
							A/2-gs_mf_pos-gs_mf_w/2,	b-gs_frwt,	15,
							A/2-gs_mf_pos-gs_mf_w/2,	0,	15
						body 1

						cprism_ topmat, botmat, sidemat,
							4, gs_ds_thk,
							A/2-gs_mf_pos+gs_mf_w/2+gs_ds_w, 0, 	15,
							A/2-gs_mf_pos+gs_mf_w/2+gs_ds_w, b-gs_frwt-gs_ds_w,	10,
							A/2-gs_mf_pos+gs_mf_w/2,	b-gs_frwt,	15,
							A/2-gs_mf_pos+gs_mf_w/2,	0,	15

						gosub 500
					endif

					if gs_mf then
						cprism_ topmat, botmat, sidemat,
							4, gs_ds_thk,
							-A/2+gs_sl_w1, b-gs_frwt, 10,
							-A/2+gs_sl_w1+gs_ds_w, b-gs_frwt-gs_ds_w, 15,
							A/2-gs_mf_pos-gs_mf_w/2-gs_ds_w, b-gs_frwt-gs_ds_w, 10,
							A/2-gs_mf_pos-gs_mf_w/2, b-gs_frwt,15
						body 1

						cprism_ topmat, botmat, sidemat,
							4, gs_ds_thk,
							A/2-gs_mf_pos+gs_mf_w/2, b-gs_frwt, 10,
							A/2-gs_mf_pos+gs_mf_w/2+gs_ds_w, b-gs_frwt-gs_ds_w, 15,
							A/2-gs_sl_w2-gs_ds_w, b-gs_frwt-gs_ds_w, 10,
							A/2-gs_sl_w2, b-gs_frwt,15
					else
						cprism_ topmat, botmat, sidemat,
							4, gs_ds_thk,
							-A/2+gs_sl_w1, b-gs_frwt, 10,
							-A/2+gs_sl_w1+gs_ds_w,   b-gs_frwt-gs_ds_w, 15,
							 A/2-gs_sl_w2-gs_ds_w, b-gs_frwt-gs_ds_w, 10,
							 A/2-gs_sl_w2, b-gs_frwt,15
					endif

					gosub 600

				endif

				if gs_SashText_typ_num = 2 then		! Butt Joint

					base

					cprism_ topmat, botmat, sidemat,
						4, gs_ds_thk,
						-A/2+gs_sl_w1, 0, 15,
						-A/2+gs_sl_w1, b-gs_frwt-gs_ds_w, 10,
						-A/2+gs_sl_w1+gs_ds_w, b-gs_frwt-gs_ds_w, 13,
						-A/2+gs_sl_w1+gs_ds_w, 0,15

					gosub 500

					cprism_ topmat, botmat, sidemat,
						4, gs_ds_thk,
						A/2-gs_sl_w2,      0, 15,
						A/2-gs_sl_w2, b-gs_frwt-gs_ds_w, 10,
						A/2-gs_sl_w2-gs_ds_w, b-gs_frwt-gs_ds_w, 13,
						A/2-gs_sl_w2-gs_ds_w, 0,15

					gosub 500

					if gs_mf then
						cprism_ topmat, botmat, sidemat,
							4, gs_ds_thk,
							A/2-gs_mf_pos-gs_mf_w/2-gs_ds_w, 0, 	15,
							A/2-gs_mf_pos-gs_mf_w/2-gs_ds_w, b-gs_frwt-gs_ds_w,	10,
							A/2-gs_mf_pos-gs_mf_w/2,	b-gs_frwt-gs_ds_w,	15,
							A/2-gs_mf_pos-gs_mf_w/2,	0,	15
						body 1

						cprism_ topmat, botmat, sidemat,
							4, gs_ds_thk,
							A/2-gs_mf_pos+gs_mf_w/2+gs_ds_w, 0, 	15,
							A/2-gs_mf_pos+gs_mf_w/2+gs_ds_w, b-gs_frwt-gs_ds_w,	10,
							A/2-gs_mf_pos+gs_mf_w/2,	b-gs_frwt-gs_ds_w,	15,
							A/2-gs_mf_pos+gs_mf_w/2,	0,	15

						gosub 500
					endif

					if gs_mf then
						cprism_ topmat, botmat, sidemat,
							6, gs_ds_thk,
							-A/2+gs_sl_w1, b-gs_frwt, 15,
							-A/2+gs_sl_w1, b-gs_frwt-gs_ds_w,8,
							-A/2+gs_sl_w1+gs_ds_w, b-gs_frwt-gs_ds_w, 15,
							A/2-gs_mf_pos-gs_mf_w/2-gs_ds_w, b-gs_frwt-gs_ds_w, 10,
							A/2-gs_mf_pos-gs_mf_w/2, b-gs_frwt-gs_ds_w,13,
							A/2-gs_mf_pos-gs_mf_w/2, b-gs_frwt,15
						body 1

						cprism_ topmat, botmat, sidemat,
							6, gs_ds_thk,
							A/2-gs_mf_pos+gs_mf_w/2, b-gs_frwt, 15,
							A/2-gs_mf_pos+gs_mf_w/2, b-gs_frwt-gs_ds_w,8,
							A/2-gs_mf_pos+gs_mf_w/2+gs_ds_w, b-gs_frwt-gs_ds_w, 15,
							A/2-gs_sl_w2-gs_ds_w, b-gs_frwt-gs_ds_w, 10,
							A/2-gs_sl_w2, b-gs_frwt-gs_ds_w,13,
							A/2-gs_sl_w2, b-gs_frwt,15
					else
						cprism_ topmat, botmat, sidemat,
							6, gs_ds_thk,
							-A/2+gs_sl_w1, b-gs_frwt, 15,
							-A/2+gs_sl_w1, b-gs_frwt-gs_ds_w,8,
							-A/2+gs_sl_w1+gs_ds_w, b-gs_frwt-gs_ds_w, 15,
							 A/2-gs_sl_w2-gs_ds_w, b-gs_frwt-gs_ds_w, 10,
							 A/2-gs_sl_w2, b-gs_frwt-gs_ds_w,13,
							 A/2-gs_sl_w2, b-gs_frwt,15
					endif

					gosub 600
				endif
			endif

			body -1
			del 1
		endif

! Extrusion Frame Rebate ---------------------------------------------------

		if	gs_frame_style_m = FRAME_STYLE_EXTRUSION |\
			gs_frame_style_m = FRAME_STYLE_WRAPPED_EXTRUSION then
			material gs_frame_mat

			gosub "Metal Frame Rebate"
		endif

! Leaf Rebate -----------------------------------------------------------------

		if (not(bUniformMaterials) & gs_frame_style_m = FRAME_STYLE_DOUBLE_REBATE & not(bSimpleOrCHIModel)) |\
			(gs_frame_style_m = FRAME_STYLE_SIMPLE_REBATE) |\
			(gs_frame_style_m = FRAME_STYLE_EXTRUSION) |\
			(gs_frame_style_m = FRAME_STYLE_WRAPPED_EXTRUSION) then

			bDoubleCut = (gs_frame_style_m = FRAME_STYLE_DOUBLE_REBATE)
			if	gs_frame_style_m = FRAME_STYLE_SIMPLE_REBATE		|\
				gs_frame_style_m = FRAME_STYLE_EXTRUSION			|\
				gs_frame_style_m = FRAME_STYLE_WRAPPED_EXTRUSION	then
				rebateWidth = gs_rebate_width
			else
				rebateWidth = offsetEPS
			endif

			addz LeafRebate

			if bArchedTop then
				if gs_mf then
					material matLeafRebate
					rx = (r2-gs_frw1+rebateWidth-offset_leaf)
					dx = (A/2-gs_mf_pos-gs_mf_w/2+rebateWidth-offset_leaf)
					cutform 5, 1, 2 + 16,
						 0, 0, 1, 0,
						-A/2+gs_frw1-rebateWidth+offset_leaf,	0,										31,
						-A/2+gs_frw1-rebateWidth+offset_leaf,	gs_shoulder_h-(fce-fce_Sl_rebate),		31+64,
						 0, frametop - r2,																900,
						 dx, b-gs_frwt+rebateWidth-offset_leaf - (rx - (sqr(rx^2 - dx^2))),	3031+64,
						 dx,	0,																		31

					dx = (A/2-gs_mf_pos+gs_mf_w/2-rebateWidth+offset_leaf)
					cutform 5, 1, 2 + 16,
						 0, 0, 1, 0,
						 A/2-gs_frw2+rebateWidth-offset_leaf,	0,										31,
						 A/2-gs_frw2+rebateWidth-offset_leaf,	gs_shoulder_h-(fce-fce_Sl_rebate),		31+64,
						 0, frametop - r2,																900,
						 dx, b-gs_frwt+rebateWidth-offset_leaf - (rx - (sqr(rx^2 - dx^2))),	3031+64,
						 dx,	0,																		31

					if bDoubleCut then
						material matLeafOpposite
						dx = (A/2-gs_mf_pos-gs_mf_w/2+rebateWidth-offset_leaf)
						cutform 5, 1, 2 + 16,
							 0, 0, 1, 0,
							-A/2+gs_frw1-rebateWidth+offset_leaf,	0,										31,
							-A/2+gs_frw1-rebateWidth+offset_leaf,	gs_shoulder_h-(fce-fce_Sl_rebate),		31+64,
							 0, frametop - r2,																900,
							 dx, b-gs_frwt+rebateWidth-offset_leaf - (rx - (sqr(rx^2 - dx^2))),	3031+64,
							 dx,	0,																		31

						dx = (A/2-gs_mf_pos+gs_mf_w/2-rebateWidth+offset_leaf)
						cutform 5, 1, 2 + 16,
							 0, 0, 1, 0,
							 A/2-gs_frw2+rebateWidth-offset_leaf,	0,										31,
							 A/2-gs_frw2+rebateWidth-offset_leaf,	gs_shoulder_h-(fce-fce_Sl_rebate),		31+64,
							 0, frametop - r2,																900,
							 dx, b-gs_frwt+rebateWidth-offset_leaf - (rx - (sqr(rx^2 - dx^2))),	3031+64,
							 dx,	0,																		31
					endif

					numCuts = numCuts + 2 + 2*bDoubleCut
				else
					material matLeafRebate
					cutform 6, 1, 2 + 16,
						 0, 0, 1, 0,
						-A/2+gs_frw1-rebateWidth+offset_leaf,	0,									31,
						-A/2+gs_frw1-rebateWidth+offset_leaf,	gs_shoulder_h-(fce-fce_Sl_rebate),	31+64,
						 0, frametop - r2,															900,
						 0, b-gs_frwt-offset_leaf,											3031+64,
						 A/2-gs_frw2+rebateWidth-offset_leaf,	gs_shoulder_h-(fce-fce_Sl_rebate),	3031+64,
						 A/2-gs_frw2+rebateWidth-offset_leaf,	0,									31

					if bDoubleCut then
						material matLeafOpposite
						cutform 6, 1, 2 + 16,
							 0, 0, -1, 0,
							-A/2+gs_frw1-rebateWidth+offset_leaf,	0,									31,
							-A/2+gs_frw1-rebateWidth+offset_leaf,	gs_shoulder_h-(fce-fce_Sl_rebate),	31+64,
							 0, frametop - r2,															900,
							 0, b-gs_frwt-offset_leaf,											3031+64,
							 A/2-gs_frw2+rebateWidth-offset_leaf,	gs_shoulder_h-(fce-fce_Sl_rebate),	3031+64,
							 A/2-gs_frw2+rebateWidth-offset_leaf,	0,									31
					endif
					numCuts = numCuts + 1 + bDoubleCut
				endif
			else
				if gs_mf then
					material matLeafRebate
					cutform 4, 1, 2 + 16,
						 0, 0, 1, 0,
						A/2-gs_mf_pos+gs_mf_w/2-rebateWidth+offset_leaf,	0,											31,
						A/2-gs_mf_pos+gs_mf_w/2-rebateWidth+offset_leaf,	B-gs_frwt+rebateWidth-offset_leaf,	31,
						A/2-gs_sl_w2+rebateWidth-offset_leaf,				B-gs_frwt+rebateWidth-offset_leaf,	31,
						A/2-gs_sl_w2+rebateWidth-offset_leaf,				0,											31

					cutform 4, 1, 2 + 16,
						 0, 0, 1, 0,
						-A/2+gs_sl_w1-rebateWidth+offset_leaf,				0,											31,
						-A/2+gs_sl_w1-rebateWidth+offset_leaf,				B-gs_frwt+rebateWidth-offset_leaf,	31,
						 A/2-gs_mf_pos-gs_mf_w/2+rebateWidth-offset_leaf,	B-gs_frwt+rebateWidth-offset_leaf,	31,
						 A/2-gs_mf_pos-gs_mf_w/2+rebateWidth-offset_leaf,	0,											31

					if bDoubleCut then
						material matLeafOpposite
						cutform 4, 1, 2 + 16,
							 0, 0, -1, 0,
							A/2-gs_mf_pos+gs_mf_w/2-rebateWidth+offset_leaf,	0,											31,
							A/2-gs_mf_pos+gs_mf_w/2-rebateWidth+offset_leaf,	B-gs_frwt+rebateWidth-offset_leaf,	31,
							A/2-gs_sl_w2+rebateWidth-offset_leaf,				B-gs_frwt+rebateWidth-offset_leaf,	31,
							A/2-gs_sl_w2+rebateWidth-offset_leaf,				0,											31

						cutform 4, 1, 2 + 16,
							 0, 0, -1, 0,
							-A/2+gs_sl_w1-rebateWidth+offset_leaf,				0,											31,
							-A/2+gs_sl_w1-rebateWidth+offset_leaf,				B-gs_frwt+rebateWidth-offset_leaf,	31,
							 A/2-gs_mf_pos-gs_mf_w/2+rebateWidth-offset_leaf,	B-gs_frwt+rebateWidth-offset_leaf,	31,
							 A/2-gs_mf_pos-gs_mf_w/2+rebateWidth-offset_leaf,	0,											31
					endif
					numCuts = numCuts + 2 + 2 * bDoubleCut
				else
					material matLeafRebate
					cutform 4, 1, 2 + 16,
						 0, 0, 1, 0,
						-A/2+gs_sl_w1-rebateWidth+offset_leaf,	0,											31,
						-A/2+gs_sl_w1-rebateWidth+offset_leaf,	B-gs_frwt+rebateWidth-offset_leaf,	31,
						 A/2-gs_sl_w2+rebateWidth-offset_leaf,	B-gs_frwt+rebateWidth-offset_leaf,	31,
						 A/2-gs_sl_w2+rebateWidth-offset_leaf,	0,											31

					if bDoubleCut then
						material matLeafOpposite
						cutform 4, 1, 2 + 16,
							 0, 0, -1, 0,
							-A/2+gs_sl_w1-rebateWidth+offset_leaf,	0,											31,
							-A/2+gs_sl_w1-rebateWidth+offset_leaf,	B-gs_frwt+rebateWidth-offset_leaf,	31,
							 A/2-gs_sl_w2+rebateWidth-offset_leaf,	B-gs_frwt+rebateWidth-offset_leaf,	31,
							 A/2-gs_sl_w2+rebateWidth-offset_leaf,	0,											31
					endif
					numCuts = numCuts + 1 + bDoubleCut
				endif
			endif

			del 1

		endif

! Sidelight Rebate ------------------------------------------------------------

		if (lod3D > 1) | not(bUniformMaterials) then
			addz Sl_Tr_op_depth
			mulz Sl_Tr_cutDir

			material matSashRebate

			if gs_sidelight_left then			! --- Left Sidelight Rebate

				rebateCutShapeLeftPX	= horizDivLeftSideLeftUpperPX
				rebateCutShapeRightPX	= horizDivLeftSideRightUpperPX
				rebateCutShapeTopPY		= TopHeightInny - offset_09
				if gs_bSidelight_fr_hdiv_left then
					rebateCutShapeBottomPY = horizDivLeftSideUpperPY
				else
					rebateCutShapeBottomPY = LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_09
				endif
				sashWidthToRebateCut	= gs_sl_sash_width
				gs_optype_m_i			= gs_optype_m_09
				bNoRebate_i				= bNoRebate_09
				iMullionStyle_i			= iMullionStyle_09
				iSimpleSashFrameType_i	= iSimpleSashFrameType_09
				offset_i				= offset_09

				gosub "Rectangular Rebate Cutting"

				if gs_bSidelight_fr_hdiv_left then			! --- Left Lower Sidelight Rebate

					rebateCutShapeLeftPX	= horizDivLeftSideLeftLowerPX
					rebateCutShapeRightPX	= horizDivLeftSideRightLowerPX
					rebateCutShapeTopPY		= horizDivLeftSideLowerPY
					rebateCutShapeBottomPY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_11
					sashWidthToRebateCut	= gs_sl_sash_width
					gs_optype_m_i			= gs_optype_m_11
					bNoRebate_i				= bNoRebate_11
					iMullionStyle_i			= iMullionStyle_11
					iSimpleSashFrameType_i	= iSimpleSashFrameType_11
					offset_i				= offset_11

					gosub "Rectangular Rebate Cutting"
				endif
			endif

			if gs_sidelight_right then			! --- Right Sidelight Rebate

				rebateCutShapeLeftPX	= horizDivRightSideLeftUpperPX
				rebateCutShapeRightPX	= horizDivRightSideRightUpperPX
				rebateCutShapeTopPY		= TopHeightInny - offset_05
				if gs_bSidelight_fr_hdiv_right then
					rebateCutShapeBottomPY = horizDivRightSideUpperPY
				else
					rebateCutShapeBottomPY = RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_05
				endif
				sashWidthToRebateCut	= gs_sl_sash_width
				gs_optype_m_i			= gs_optype_m_05
				bNoRebate_i				= bNoRebate_05
				iMullionStyle_i			= iMullionStyle_05
				iSimpleSashFrameType_i	= iSimpleSashFrameType_05
				offset_i				= offset_05

				gosub "Rectangular Rebate Cutting"

				if gs_bSidelight_fr_hdiv_right then			! --- Right Lower Sidelight Rebate

					rebateCutShapeLeftPX	= horizDivRightSideLeftLowerPX
					rebateCutShapeRightPX	= horizDivRightSideRightLowerPX
					rebateCutShapeTopPY		= horizDivRightSideLowerPY
					rebateCutShapeBottomPY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_07
					sashWidthToRebateCut	= gs_sl_sash_width
					gs_optype_m_i			= gs_optype_m_07
					bNoRebate_i				= bNoRebate_07
					iMullionStyle_i			= iMullionStyle_07
					iSimpleSashFrameType_i	= iSimpleSashFrameType_07
					offset_i				= offset_07

					gosub "Rectangular Rebate Cutting"
				endif
			endif

			del 2
		endif

! USA Middle Frame ------------------------------------------------------------

		if gs_mf then
			if bArchedTop then
				cutform 6, 1, 2 + 16,
					0, 0, -1, 0,
					frameleft, B, 15+16+32,
					frameright, B, 15+16+32,
					0, frametop - r2, 900,
					A/2-gs_frw2, gs_shoulder_h-(fce-fcefw), 15+16+32,
					0, b-gs_frwt, 3015+16+32,
					-A/2+gs_frw1, gs_shoulder_h-(fce-fcefw), 3010+16+32
			endif

			add A/2-gs_mf_pos, 0, 0
			cprism_ topmat, botmat, sidemat,
				4, outsideFrameThk,
				-gs_mf_w/2-offset_leaf, 0, 	15,
				-gs_mf_w/2-offset_leaf, B-gs_frwt-offset_leaf,	10,
				 gs_mf_w/2+offset_leaf,	B-gs_frwt-offset_leaf,	15,
				 gs_mf_w/2+offset_leaf,	0,	15

			gosub 500
			del 1

			if bArchedTop then cutend
		endif

! -----------------------------------------------------------------------------

		base

n=1
		for i=1 to n
			framethick1	= outsideFrameThk
			framethick2	= insideFrameThk
			frameThickOffset = 0

			mat1=topmat
			mat2=sidemat

			if not(WIDO_REVEAL_SIDE) then
				matLeaf = gs_frame_mat2
			else
				matLeaf = gs_frame_mat
			endif

			if gs_opening_dir_SL_m = 1 exor WIDO_REVEAL_SIDE then
				matSash = gs_frame_mat2
			else
				matSash = gs_frame_mat
			endif

			mask1 = 15
			mask2 = 13
			mask3 = 15
			mask5 = 14

			bDiffFrameThk = (abs(framethick1 - framethick2) > EPS)

			if gs_SashText_typ_num = 1 then		! Mitered Joint

				if gs_pocket_door_frame & lod3D <> 5 then
					cutHeight = TopHeightInny
					gosub "Pocket Door Cutting"
				endif

				if gs_sidelight_left then

					bExtraPrismOnLeftSide = (bDiffFrameThk & (lod3D = 1) & (offset_09 > EPS))
					if gs_bSidelight_fr_hdiv_left then
						bExtraPrismOnLeftSideLower = (bDiffFrameThk & (lod3D = 1) & (offset_11 > EPS))
					else
						bExtraPrismOnLeftSideLower = bExtraPrismOnLeftSide
					endif

					if bExtraPrismOnLeftSide | bExtraPrismOnLeftSideLower then

						! --- outside part
						put -A/2 - cutDxLeft, LeftSLParapet-ovhgBottomLeft, 0, mask1 - 7*gs_stack_left, matSash,
							-A/2 - cutDxLeft, TopHeighty, 0, 8, matSash
						if gs_bSidelight_fr_hdiv_left & (bExtraPrismOnLeftSide exor bExtraPrismOnLeftSideLower) then
							if bExtraPrismOnLeftSide then
								put	-A/2+gs_frw1, TopHeightInny, 0, mask5, matSash,
									-A/2+gs_frw1, horizDivLeftSideLowerPY, 0, 13, matSash,
									-A/2+gs_frw1, LeftSLParapet-ovhgBottomLeft+gs_frame_width_low_left_sl, 0, 12, matSash
							else
								put	-A/2+gs_frw1, TopHeightInny, 0, 13, matSash,
									-A/2+gs_frw1, horizDivLeftSideUpperPY, 0, 12, matSash
							endif

							put	-A/2+gs_frw1, LeftSLParapet-ovhgBottomLeft, 0, mask1, matSash,
								-A/2 - cutDxLeft, LeftSLParapet-ovhgBottomLeft, 0, -1, matSash
						else
							put -A/2+gs_frw1, TopHeightInny, 0, mask5, matSash,
								-A/2+gs_frw1, LeftSLParapet-ovhgBottomLeft, 0, mask1, matSash,
								-A/2 - cutDxLeft, LeftSLParapet-ovhgBottomLeft, 0, -1, matSash
						endif

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick1,
							get(nsp)

						gosub 500

						! --- inside part
						put -A/2+gs_frw1, LeftSLParapet-ovhgBottomLeft, 0, mask5, matSash
						if bExtraPrismOnLeftSide then
							put	-A/2+gs_frw1, TopHeightInny, 0, 8, matSash,
								-A/2+gs_frw1+offset_09, TopHeightInny-offset_09, 0, mask1, matSash
						endif
						if (iSimpleSashFrameType_09 = SIMPLESASH_SLIDEVER) & bExtraPrismOnLeftSide then
							if gs_bSidelight_fr_hdiv_left then
								SashBottomY	= horizDivLeftSideUpperPY
							else
								SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_09
							endif
							SashTopY	= b-gs_frwt-offset_09
							simpleSashX	= -A/2+gs_frw1+offset_09

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						if gs_bSidelight_fr_hdiv_left then
							put horizDivLeftSideLeftUpperPX,	horizDivLeftSideUpperPY, 0, 8,		matSash,
								horizDivLeftSideLeftLowerPX,	horizDivLeftSideLowerPY, 0, mask2,	matSash

							if (iSimpleSashFrameType_11 = SIMPLESASH_SLIDEVER) & bExtraPrismOnLeftSideLower then
								SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_11
								SashTopY	= horizDivLeftSideLowerPY
								simpleSashX	= horizDivLeftSideLeftLowerPX

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
							endif
							offset_i = offset_11
						else
							offset_i = offset_09
						endif
						if bExtraPrismOnLeftSideLower then
							put	-A/2+gs_frw1+offset_i, LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, 8, matSash,
								-A/2+gs_frw1+offset_i, LeftSLParapet-ovhgBottomLeft, 0, mask1, matSash,
								-A/2+gs_frw1, LeftSLParapet-ovhgBottomLeft, 0, -1, matSash
						endif

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick2,
							get(nsp)

						gosub 500

					else

						put -A/2 - cutDxLeft, LeftSLParapet-ovhgBottomLeft, 0, mask1 - 7*gs_stack_left, matSash,
							-A/2 - cutDxLeft, TopHeighty, 0, 8, matSash,
							-A/2+gs_frw1+offset_09, TopHeightInny-offset_09, 0, mask1 - 2, matSash
						if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEVER then
							if gs_bSidelight_fr_hdiv_left then
								SashBottomY	= horizDivLeftSideUpperPY
							else
								SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_09
							endif
							SashTopY	= b-gs_frwt-offset_09
							simpleSashX	= -A/2+gs_frw1+offset_09

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						if gs_bSidelight_fr_hdiv_left then
							put horizDivLeftSideLeftUpperPX,	horizDivLeftSideUpperPY, 0, mmask,	matSash,
								horizDivLeftSideLeftLowerPX,	horizDivLeftSideLowerPY, 0, mask2,	matSash

							if iSimpleSashFrameType_11 = SIMPLESASH_SLIDEVER then
								SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_11
								SashTopY	= horizDivLeftSideLowerPY
								simpleSashX	= horizDivLeftSideLeftLowerPX

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
							endif
							offset_i = offset_11
						else
							offset_i = offset_09
						endif
						put	-A/2+gs_frw1+offset_i, LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, mmask, matSash
						if bDiffFrameThk then
							put -A/2+gs_frw1+offset_i, LeftSLParapet-ovhgBottomLeft, 0, mask1, matSash
						endif
						put	-A/2 - cutDxLeft, LeftSLParapet-ovhgBottomLeft, 0, -1, matSash

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick1,
							get(nsp)

						gosub 500

					endif

					if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEVER then
						if gs_bSidelight_fr_hdiv_left then
							SashBottomY	= horizDivLeftSideUpperPY
						else
							SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_09
						endif
						SashTopY	= b-gs_frwt-offset_09
						simpleSashX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_09

						simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
						put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
							simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
					endif
					if gs_bSidelight_fr_hdiv_left then
						put horizDivLeftSideRightUpperPX,	horizDivLeftSideUpperPY, 0, 8,		matSash,
							horizDivLeftSideRightLowerPX,	horizDivLeftSideLowerPY, 0, mask2,	matSash

						if iSimpleSashFrameType_11 = SIMPLESASH_SLIDEVER then
							SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_11
							SashTopY	= horizDivLeftSideLowerPY
							simpleSashX	= horizDivLeftSideRightLowerPX

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						offset_i = offset_11
					else
						offset_i = offset_09
					endif
					if LeftSLParapet > EPS then
						put -A/2+gs_sl_w1-gs_frw_Sl_left-offset_i, LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, 10, matSash,
							-A/2+gs_sl_w1-gs_frw_SlParapet_left-gs_tolerance_left_2, LeftSLParapet-ovhgBottomLeft, 0, mask1, matSash,
							-A/2+gs_sl_w1-gs_frw_SlParapet_left-gs_tolerance_left_2, -ovhgBottom, 0, mask1, matSash,
							-A/2+gs_sl_w1+offset_leaf, -ovhgBottom, 0, mask3, matLeaf
					else
						put -A/2+gs_sl_w1-gs_frw_Sl_left-offset_i, gs_frame_width_low_left_sl+offset_i, 0, 10, matSash,
							-A/2+gs_sl_w1+offset_leaf, -ovhgBottom, 0, mask3 - 2, matLeaf
					endif

					cprism_{2} mat1, botmat, matSash,
						3+nsp/5, framethick2,
						-A/2+gs_sl_w1-gs_frw_Sl_left-offset_09, b-gs_frwt-offset_09, 0, mask1, matSash,
						get(nsp),
						-A/2+gs_sl_w1+offset_leaf, b-gs_frwt-offset_leaf, 0, mmask2 - 6*bExtraPrismOnLeftSide, matSash,
						-A/2+gs_sl_w1-gs_frw_Sl_left-offset_09, b-gs_frwt-offset_09, 0, -1, matSash

					gosub 500

					if gs_bSidelight_fr_hdiv_left then
						iSimpleSashFrameType_i = iSimpleSashFrameType_11
						offset_i = offset_11
					else
						iSimpleSashFrameType_i = iSimpleSashFrameType_09
						offset_i = offset_09
					endif
					put	-A/2+gs_sl_w1-gs_frw_Sl_left-offset_i, LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, 10, matSash,
						-A/2+gs_sl_w1-(gs_frw_SlParapet_left+gs_tolerance_left_2) * (LeftSLParapet>0), LeftSLParapet-ovhgBottomLeft, 0, mask1, matSash,
						-A/2+(gs_frw1+offset_i)*bDiffFrameThk-gs_tolerance_left*not(bDiffFrameThk), LeftSLParapet-ovhgBottomLeft, 0, mmask2 - 6*bExtraPrismOnLeftSideLower - 2*gs_stack_left, matSash,
						-A/2+gs_frw1+offset_i, LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, mask1, matSash
					if iSimpleSashFrameType_i = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_i = SIMPLESASH_SIDEHUNG then
						SashLeftX	= -A/2+gs_frw1+offset_i
						SashRightX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_i
						simpleSashZ	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i

						simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
						if iSimpleSashFrameType_i = SIMPLESASH_SLIDEHOR then
							put simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
								simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
						else
							put simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
								simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
						endif
					endif

					cprism_{2} mat1, botmat, matSash,
						nsp/5, framethick2,
						get(nsp)

					gosub 600
				else
					bExtraPrismOnLeftSide = 0

					if abs(cutDxLeft + gs_frw1 + offset_leaf) > EPS then	! avoiding self intersect. prism
						put -A/2 - cutDxLeft, -ovhgBottom, 0, mask1 - 7*gs_stack_left, matSash,
							-A/2 - cutDxLeft, TopHeighty, 0, 8, matSash,
							-A/2+gs_frw1+offset_leaf, TopHeightInny, 0, mask1 - 2, matLeaf,
							-A/2+gs_frw1+offset_leaf, -ovhgBottom, 0, mask1, matSash,
							-A/2 - cutDxLeft, -ovhgBottom, 0, -1, matSash
					endif

					if nsp > 0 then
						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick1,
							get(nsp)
						gosub 500
					endif
				endif


				if gs_sidelight_right then

					bExtraPrismOnRightSide = (bDiffFrameThk & (lod3D = 1) & (offset_05 > EPS))
					if gs_bSidelight_fr_hdiv_right then
						bExtraPrismOnRightSideLower = (bDiffFrameThk & (lod3D = 1) & (offset_07 > EPS))
					else
						bExtraPrismOnRightSideLower = bExtraPrismOnRightSide
					endif

					if bExtraPrismOnRightSide | bExtraPrismOnRightSideLower then

						! --- outside part
						put	A/2 + cutDxRight, RightSLParapet-ovhgBottomRight, 0, mask1 - 7*gs_stack_right, matSash,
							A/2 + cutDxRight, TopHeighty, 0, 10 - 2*(gs_stack_top | gs_stack_right), matSash
						if gs_bSidelight_fr_hdiv_right & (bExtraPrismOnRightSide exor bExtraPrismOnRightSideLower) then
							if bExtraPrismOnRightSide then
								put	A/2-gs_frw2, TopHeightInny, 0, mask5, matSash,
									A/2-gs_frw2, horizDivRightSideLowerPY, 0, 13, matSash,
									A/2-gs_frw2, RightSLParapet-ovhgBottomRight+gs_frame_width_low_right_sl, 0, 12, matSash
							else
								put	A/2-gs_frw2, TopHeightInny, 0, 13, matSash,
									A/2-gs_frw2, horizDivRightSideUpperPY, 0, 12, matSash
							endif
							put	A/2-gs_frw2, RightSLParapet-ovhgBottomRight, 0, mask1, matSash,
								A/2 + cutDxRight, RightSLParapet-ovhgBottomRight, 0, -1, matSash

						else
							put A/2-gs_frw2, TopHeightInny, 0, mask5, matSash,
								A/2-gs_frw2, RightSLParapet-ovhgBottomRight, 0, mask1, matSash,
								A/2 + cutDxRight, RightSLParapet-ovhgBottomRight, 0, -1, matSash
						endif

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick1,
							get(nsp)

						gosub 500

						! --- inside part
						put A/2-gs_frw2, RightSLParapet-ovhgBottomRight, 0, mask5, matSash
						if bExtraPrismOnRightSide then
							put	A/2-gs_frw2, TopHeightInny, 0, 10, matSash,
								A/2-gs_frw2-offset_05, TopHeightInny-offset_05, 0, mask1, matSash
						endif
						if (iSimpleSashFrameType_05 = SIMPLESASH_SLIDEVER) & bExtraPrismOnRightSide then
							if gs_bSidelight_fr_hdiv_right then
								SashBottomY	= horizDivRightSideUpperPY
							else
								SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_05
							endif
							SashTopY	= b-gs_frwt-offset_05
							simpleSashX	= A/2-gs_frw2-offset_05

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						if gs_bSidelight_fr_hdiv_right then
							put horizDivRightSideRightUpperPX,	horizDivRightSideUpperPY, 0, 8,		matSash,
								horizDivRightSideRightLowerPX,	horizDivRightSideLowerPY, 0, mask2,	matSash

							if (iSimpleSashFrameType_07 = SIMPLESASH_SLIDEVER) & bExtraPrismOnRightSideLower then
								SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_07
								SashTopY	= horizDivRightSideLowerPY
								simpleSashX	= horizDivRightSideRightLowerPX

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
							endif
							offset_i = offset_07
						else
							offset_i = offset_05
						endif
						if bExtraPrismOnRightSideLower then
							put	A/2-gs_frw2-offset_i, RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, 8, matSash,
								A/2-gs_frw2-offset_i, RightSLParapet-ovhgBottomRight, 0, mask1, matSash,
								A/2-gs_frw2, RightSLParapet-ovhgBottomRight, 0, -1, matSash
						endif

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick2,
							get(nsp)

						body 1
					else

						put A/2 + cutDxRight, RightSLParapet-ovhgBottomRight, 0, mask1 - 7*gs_stack_right, matSash,
							A/2 + cutDxRight, TopHeighty, 0, 10 - 2*(gs_stack_top | gs_stack_right), matSash,
							A/2-gs_frw2-offset_05, TopHeightInny-offset_05, 0, mask1 - 2, matSash
						if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEVER then
							if gs_bSidelight_fr_hdiv_right then
								SashBottomY	= horizDivRightSideUpperPY
							else
								SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_05
							endif
							SashTopY	= b-gs_frwt-offset_05
							simpleSashX	= A/2-gs_frw2-offset_05

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						if gs_bSidelight_fr_hdiv_right then
							put horizDivRightSideRightUpperPX,	horizDivRightSideUpperPY, 0, mmask,	matSash,
								horizDivRightSideRightLowerPX,	horizDivRightSideLowerPY, 0, mask2,	matSash

							if iSimpleSashFrameType_07 = SIMPLESASH_SLIDEVER then
								SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_07
								SashTopY	= horizDivRightSideLowerPY
								simpleSashX	= horizDivRightSideRightLowerPX

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
							endif
							offset_i = offset_07
						else
							offset_i = offset_05
						endif
						put	A/2-gs_frw2-offset_i, RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, mmask, matSash
						if bDiffFrameThk then
							put A/2-gs_frw2-offset_i, RightSLParapet-ovhgBottomRight, 0, mask1, matSash
						endif
						put A/2 + cutDxRight, RightSLParapet-ovhgBottomRight, 0, -1, matSash

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick1,
							get(nsp)

						gosub 500

					endif

					if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEVER then
						if gs_bSidelight_fr_hdiv_right then
							SashBottomY	= horizDivRightSideUpperPY
						else
							SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_05
						endif
						SashTopY	= b-gs_frwt-offset_05
						simpleSashX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_05

						simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
						put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
							simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
					endif
					if gs_bSidelight_fr_hdiv_right then
						put horizDivRightSideLeftUpperPX,	horizDivRightSideUpperPY, 0, 8,		matSash,
							horizDivRightSideLeftLowerPX,	horizDivRightSideLowerPY, 0, mask2,	matSash

						if iSimpleSashFrameType_07 = SIMPLESASH_SLIDEVER then
							SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_07
							SashTopY	= horizDivRightSideLowerPY
							simpleSashX	= horizDivRightSideLeftLowerPX

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						offset_i = offset_07
					else
						offset_i = offset_05
					endif
					if RightSLParapet > EPS then
						put A/2-gs_sl_w2+gs_frw_Sl_right+offset_i, RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, 10, matSash,
							A/2-gs_sl_w2+gs_frw_SlParapet_right+gs_tolerance_right_2, RightSLParapet-ovhgBottomRight, 0, mask1, matSash,
							A/2-gs_sl_w2+gs_frw_SlParapet_right+gs_tolerance_right_2, -ovhgBottom, 0, mask1, matSash,
							A/2-gs_sl_w2-offset_leaf, -ovhgBottom, 0, mask3, matLeaf
					else
						put A/2-gs_sl_w2+gs_frw_Sl_right+offset_i, gs_frame_width_low_right_sl+offset_i, 0, 10, matSash,
							A/2-gs_sl_w2-offset_leaf, -ovhgBottom, 0, mask3 - 2, matLeaf
					endif
					cprism_{2} mat1, botmat, matSash,
						3+nsp/5, framethick2,
						 A/2-gs_sl_w2+gs_frw_Sl_right+offset_05, b-gs_frwt-offset_05, 0, mask1, matSash,
						get(nsp),
						 A/2-gs_sl_w2-offset_leaf, b-gs_frwt-offset_leaf, 0, mmask2 - 6*bExtraPrismOnRightSide, matSash,
						 A/2-gs_sl_w2+gs_frw_Sl_right+offset_05, b-gs_frwt-offset_05, 0, -1, matSash

					gosub 500

					if gs_bSidelight_fr_hdiv_right then
						iSimpleSashFrameType_i = iSimpleSashFrameType_07
						offset_i = offset_07
					else
						iSimpleSashFrameType_i = iSimpleSashFrameType_05
						offset_i = offset_05
					endif
					put	A/2-gs_sl_w2+gs_frw_Sl_right+offset_i, RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, 10, matSash,
						A/2-gs_sl_w2+(gs_frw_SlParapet_right+gs_tolerance_right_2) * (RightSLParapet>0), RightSLParapet-ovhgBottomRight, 0, mask1, matSash,
						A/2-(gs_frw2+offset_i)*bDiffFrameThk+gs_tolerance_right*not(bDiffFrameThk), RightSLParapet-ovhgBottomRight, 0, mmask2 - 6*bExtraPrismOnRightSideLower - 2*gs_stack_right, matSash,
						A/2-gs_frw2-offset_i, RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, mask1, matSash

					if iSimpleSashFrameType_i = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_i = SIMPLESASH_SIDEHUNG then
						SashLeftX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_i
						SashRightX	= A/2-gs_frw2-offset_i
						simpleSashZ	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i

						simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
						if iSimpleSashFrameType_i = SIMPLESASH_SLIDEHOR then
							put simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
								simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
						else
							put simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
								simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
						endif
					endif

					cprism_{2} mat1, botmat, matSash,
						nsp/5, framethick2,
						get(nsp)

					gosub 600
				else
					bExtraPrismOnRightSide = 0

					if abs(cutDxRight + gs_frw2 + offset_leaf) > EPS then	! avoiding self intersect. prism
						put A/2 + cutDxRight, -ovhgBottom, 0, mask1 - 7*gs_stack_right, matSash,
							A/2 + cutDxRight, TopHeighty, 0, 10 - 2*(gs_stack_top | gs_stack_right), matSash,
							A/2-gs_frw2-offset_leaf, TopHeightInny, 0, mask1 - 2, matLeaf,
							A/2-gs_frw2-offset_leaf, -ovhgBottom, 0, mask1, matSash,
							A/2 + cutDxRight, -ovhgBottom, 0, -1, matSash
					endif

					if nsp > 0 then
						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick1,
							get(nsp)
						gosub 500
					endif
				endif

				if gs_pocket_door_frame & lod3D <> 5 then
					cutend
					if n=2 then cutend
				endif

				if bArchedTop then
					cprism_ topmat, botmat, sidemat,
						7, outsideFrameThk,
						frameleft, gs_shoulder_h, 79,
						0, frametop - r2, 900,
						0, frametop, 3079,
						frameright, gs_shoulder_h, 3010,
						A/2-gs_frw2+offset_leaf, gs_shoulder_h-(fce-fcefw), 79,
						0, b-gs_frwt-offset_leaf, 3079,
						-A/2+gs_frw1-offset_leaf, gs_shoulder_h-(fce-fcefw), 3010
					body 1
				else
					if bExtraPrismOnLeftSide then
						put -A/2+gs_frw1, b-gs_frwt, 0, 8, matSash,
							-A/2+gs_frw1+offset_09, b-gs_frwt-offset_09, 0, mask2, matSash

						if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_09 = SIMPLESASH_SIDEHUNG then
							SashLeftX	= -A/2+gs_frw1+offset_09
							SashRightX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_09
							simpleSashZ	= b-gs_frwt-offset_09

							simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
							if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEHOR then
								put simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
									simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
							else
								put simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
									simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
							endif
						endif

						put	-A/2+gs_sl_w1-gs_frw_Sl_left-offset_09, b-gs_frwt-offset_09, 0, 8, matSash,
							-A/2+gs_sl_w1, b-gs_frwt, 0, mask5, matLeaf

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick2,
							get(nsp)

						gosub 600
					endif
					if bExtraPrismOnRightSide then
						put	 A/2-gs_sl_w2, b-gs_frwt, 0, 10, matSash,
							 A/2-gs_sl_w2+gs_frw_Sl_right+offset_05, b-gs_frwt-offset_05, 0, mask1 - 2, matSash

						if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_05 = SIMPLESASH_SIDEHUNG then
							SashLeftX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_05
							SashRightX	= A/2-gs_frw2-offset_05
							simpleSashZ	= b-gs_frwt-offset_05

							simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
							if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEHOR then
								put simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
									simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
							else
								put simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
									simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
							endif
						endif

						put	 A/2-gs_frw2-offset_05, b-gs_frwt-offset_05, 0, 8, matSash,
							 A/2-gs_frw2, b-gs_frwt, 0, 12, matSash

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick2,
							get(nsp)

						gosub 600
					endif
					if gs_sidelight_left then
						if bExtraPrismOnLeftSide then
							put -A/2 - cutDxLeft, b + cutDy, 0, 10 - 2*(gs_stack_top | gs_stack_left), matSash,
								-A/2+gs_frw1, b-gs_frwt, 0, mask5, matSash,
								-A/2+gs_sl_w1-gs_frw_Sl_left, b-gs_frwt, 0, 12, matSash,
								-A/2+gs_sl_w1, b-gs_frwt, 0, mask3 - 2, matLeaf
						else
							put -A/2 - cutDxLeft, b + cutDy, 0, 10 - 2*(gs_stack_top | gs_stack_left), matSash,
								-A/2+gs_frw1+offset_09, b-gs_frwt-offset_09, 0, mask1, matSash

							if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_09 = SIMPLESASH_SIDEHUNG then
								SashLeftX	= -A/2+gs_frw1+offset_09
								SashRightX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_09
								simpleSashZ	= b-gs_frwt-offset_09

								simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
								if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEHOR then
									put simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
								else
									put simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
								endif
							endif

							put	-A/2+gs_sl_w1-gs_frw_Sl_left-offset_09, b-gs_frwt-offset_09, 0, mmask, matSash,
								-A/2+gs_sl_w1+offset_leaf, b-gs_frwt-offset_leaf, 0, mask3 - 2, matLeaf
						endif
					else
						if abs(cutDy + gs_frwt + offset_leaf) > EPS then	! avoiding self intersect. prism
							put -A/2 - cutDxLeft, b + cutDy, 0, 10 - 2*(gs_stack_top | gs_stack_left), matSash,
								-A/2+gs_frw1+offset_leaf, b-gs_frwt-offset_leaf, 0, mask1, matLeaf
						endif
					endif
					if gs_sidelight_right then
						if bExtraPrismOnRightSide then
							put	 A/2-gs_sl_w2, b-gs_frwt, 0, 12, matSash,
								 A/2-gs_sl_w2+gs_frw_Sl_right, b-gs_frwt, 0, 12, matSash,
								 A/2-gs_frw2, b-gs_frwt, 0, 10 - 2*(gs_stack_top | gs_stack_right), matSash,
								 A/2 + cutDxRight, b + cutDy, 0, mask1 - 2*(gs_stack_top | gs_stack_right) - 5*gs_stack_top, matSash,
								-A/2 - cutDxLeft, b + cutDy, 0, -1, matSash
						else
							put	 A/2-gs_sl_w2-offset_leaf, b-gs_frwt-offset_leaf, 0, mmask, matSash,
								 A/2-gs_sl_w2+gs_frw_Sl_right+offset_05, b-gs_frwt-offset_05, 0, mask1 - 2, matSash

							if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_05 = SIMPLESASH_SIDEHUNG then
								SashLeftX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_05
								SashRightX	= A/2-gs_frw2-offset_05
								simpleSashZ	= b-gs_frwt-offset_05

								simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
								if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEHOR then
									put simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
								else
									put simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
								endif
							endif

							put	 A/2-gs_frw2-offset_05, b-gs_frwt-offset_05, 0, 10 - 2*(gs_stack_top | gs_stack_right), matSash,
								 A/2 + cutDxRight, b + cutDy, 0, mask1 - 2*(gs_stack_top | gs_stack_right) - 5*gs_stack_top, matSash,
								-A/2 - cutDxLeft, b + cutDy, 0, -1, matSash
						endif
					else
						if abs(cutDy + gs_frwt + offset_leaf) > EPS then	! avoiding self intersect. prism
							put	 A/2-gs_frw2-offset_leaf, b-gs_frwt-offset_leaf, 0, 10 - 2*(gs_stack_top | gs_stack_right), matSash,
								 A/2 + cutDxRight, b + cutDy, 0, mask1 - 2*(gs_stack_top | gs_stack_right) - 5*gs_stack_top, matSash,
								-A/2 - cutDxLeft, b + cutDy, 0, -1, matSash
						endif
					endif

					if nsp > 0 then
						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick1,
							get(nsp)
					endif
				endif

				gosub 600

			endif


			if gs_SashText_typ_num = 2 then		! Butt Joint

				if gs_pocket_door_frame & lod3D <> 5 then
					cutHeight = TopHeightInny
					gosub "Pocket Door Cutting"
				endif

				if gs_sidelight_left then

					bExtraPrismOnLeftSide = (bDiffFrameThk & (lod3D = 1) & (offset_09 > EPS))
					if gs_bSidelight_fr_hdiv_left then
						bExtraPrismOnLeftSideLower = (bDiffFrameThk & (lod3D = 1) & (offset_11 > EPS))
					else
						bExtraPrismOnLeftSideLower = bExtraPrismOnLeftSide
					endif

					if bExtraPrismOnLeftSide | bExtraPrismOnLeftSideLower then

						! --- outside part
						put	-A/2 - cutDxLeft, LeftSLParapet-ovhgBottomLeft, 0, mask1 - 7*gs_stack_left, matSash,
							-A/2 - cutDxLeft, TopHeighty, 0, 8, matSash
						if gs_bSidelight_fr_hdiv_left & (bExtraPrismOnLeftSide exor bExtraPrismOnLeftSideLower) then
							if bExtraPrismOnLeftSide then
								put	-A/2+gs_frw1, TopHeightInny, 0, mask5, matSash,
									-A/2+gs_frw1, horizDivLeftSideLowerPY, 0, 13, matSash,
									-A/2+gs_frw1, LeftSLParapet-ovhgBottomLeft+gs_frame_width_low_left_sl, 0, 12, matSash
							else
								put	-A/2+gs_frw1, TopHeightInny, 0, 13, matSash,
									-A/2+gs_frw1, horizDivLeftSideUpperPY, 0, 12, matSash
							endif
							put	-A/2+gs_frw1, LeftSLParapet-ovhgBottomLeft, 0, mask1, matSash
						else
							put	-A/2+gs_frw1, TopHeightInny, 0, mask5, matSash,
								-A/2+gs_frw1, LeftSLParapet-ovhgBottomLeft, 0, mask1, matSash
						endif

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick1,
							get(nsp)

						gosub 500

						! --- inside part
						put	-A/2+gs_frw1, LeftSLParapet-ovhgBottomLeft, 0, mask5, matSash
						if bExtraPrismOnLeftSide then
							put	-A/2+gs_frw1, TopHeighty-offset_09, 0, 8, matSash,
								-A/2+gs_frw1+offset_09, TopHeightInny-offset_09, 0, mask1, matSash
						endif
						if (iSimpleSashFrameType_09 = SIMPLESASH_SLIDEVER) & bExtraPrismOnLeftSide then
							if gs_bSidelight_fr_hdiv_left then
								SashBottomY	= horizDivLeftSideUpperPY
							else
								SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_09
							endif
							SashTopY	= b-gs_frwt-offset_09
							simpleSashX	= -A/2+gs_frw1+offset_09

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						if gs_bSidelight_fr_hdiv_left then
							put horizDivLeftSideLeftUpperPX,	horizDivLeftSideUpperPY, 0, 8,		matSash,
								horizDivLeftSideLeftLowerPX,	horizDivLeftSideLowerPY, 0, mask2,	matSash

							if (iSimpleSashFrameType_11 = SIMPLESASH_SLIDEVER) & bExtraPrismOnLeftSideLower then
								SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_11
								SashTopY	= horizDivLeftSideLowerPY
								simpleSashX	= horizDivLeftSideLeftLowerPX

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
							endif
							offset_i = offset_11
						else
							offset_i = offset_09
						endif
						if bExtraPrismOnLeftSideLower then
							put	-A/2+gs_frw1+offset_i, LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, 8, matSash,
								-A/2+gs_frw1+offset_i, LeftSLParapet-ovhgBottomLeft, 0, mask1, matSash,
								-A/2+gs_frw1, LeftSLParapet-ovhgBottomLeft, 0, -1, matSash
						endif

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick2,
							get(nsp)

						gosub 500

					else

						put	-A/2 - cutDxLeft, LeftSLParapet-ovhgBottomLeft, 0, mask1 - 7*gs_stack_left, matSash,
							-A/2 - cutDxLeft, TopHeighty-offset_09, 0, 8, matSash,
							-A/2+gs_frw1+offset_09, TopHeightInny-offset_09, 0, mask1 - 2, matSash
						if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEVER then
							if gs_bSidelight_fr_hdiv_left then
								SashBottomY	= horizDivLeftSideUpperPY
							else
								SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_09
							endif
							SashTopY	= b-gs_frwt-offset_09
							simpleSashX	= -A/2+gs_frw1+offset_09

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						if gs_bSidelight_fr_hdiv_left then
							put horizDivLeftSideLeftUpperPX,	horizDivLeftSideUpperPY, 0, mmask,	matSash,
								horizDivLeftSideLeftLowerPX,	horizDivLeftSideLowerPY, 0, mask2,	matSash

							if iSimpleSashFrameType_11 = SIMPLESASH_SLIDEVER then
								SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_11
								SashTopY	= horizDivLeftSideLowerPY
								simpleSashX	= horizDivLeftSideLeftLowerPX

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
							endif
							offset_i = offset_11
						else
							offset_i = offset_09
						endif
						put	-A/2+gs_frw1+offset_i, LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, mmask, matSash,
							-A/2+gs_frw1+offset_i, LeftSLParapet-ovhgBottomLeft, 0, mask1, matSash,
							-A/2 - cutDxLeft, LeftSLParapet-ovhgBottomLeft, 0, -1, matSash

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick1,
							get(nsp)

						gosub 500

					endif

					if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEVER then
						if gs_bSidelight_fr_hdiv_left then
							SashBottomY	= horizDivLeftSideUpperPY
						else
							SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_09
						endif
						SashTopY	= b-gs_frwt-offset_09
						simpleSashX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_09

						simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
						put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
							simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
					endif
					if gs_bSidelight_fr_hdiv_left then
						put horizDivLeftSideRightUpperPX,	horizDivLeftSideUpperPY, 0, 8,		matSash,
							horizDivLeftSideRightLowerPX,	horizDivLeftSideLowerPY, 0, mask2,	matSash

						if iSimpleSashFrameType_11 = SIMPLESASH_SLIDEVER then
							SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_11
							SashTopY	= horizDivLeftSideLowerPY
							simpleSashX	= horizDivLeftSideRightLowerPX

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						offset_i = offset_11
					else
						offset_i = offset_09
					endif
					if LeftSLParapet > EPS then
						put -A/2+gs_sl_w1-gs_frw_Sl_left-offset_i, LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, 10, matSash,
							-A/2+gs_sl_w1-gs_frw_SlParapet_left-gs_tolerance_left_2, LeftSLParapet-ovhgBottomLeft, 0, mask1, matSash,
							-A/2+gs_sl_w1-gs_frw_SlParapet_left-gs_tolerance_left_2, -ovhgBottom, 0, mask1, matSash,
							-A/2+gs_sl_w1+offset_leaf, -ovhgBottom, 0, mask3, matLeaf
					else
						put -A/2+gs_sl_w1-gs_frw_Sl_left-offset_i, gs_frame_width_low_left_sl+offset_i, 0, 10, matSash,
							-A/2+gs_sl_w1-gs_frw_Sl_left, -ovhgBottom, 0, mask3 - 2, matSash,
							-A/2+gs_sl_w1+offset_leaf, -ovhgBottom, 0, mask1, matLeaf
					endif

					cprism_{2} mat1, botmat, matSash,
						3+nsp/5, framethick2,
						-A/2+gs_sl_w1-gs_frw_Sl_left-offset_09, b-gs_frwt-offset_09, 0, mask1, matSash,
						get(nsp),
						-A/2+gs_sl_w1+offset_leaf, b-gs_frwt-offset_leaf, 0, mmask2 - 4*bExtraPrismOnLeftSide, matSash,
						-A/2+gs_sl_w1-gs_frw_Sl_left-offset_09, b-gs_frwt-offset_09, 0, -1, matSash

					gosub 500

					if gs_bSidelight_fr_hdiv_left then
						iSimpleSashFrameType_i = iSimpleSashFrameType_11
						offset_i = offset_11
					else
						iSimpleSashFrameType_i = iSimpleSashFrameType_09
						offset_i = offset_09
					endif
					if LeftSLParapet > EPS then
						put	-A/2+gs_sl_w1-gs_frw_Sl_left-offset_i, LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, 10, matSash,
							-A/2+gs_sl_w1-gs_frw_SlParapet_left-gs_tolerance_left_2, LeftSLParapet-ovhgBottomLeft, 0, mask1, matSash,
							-A/2+gs_frw1+offset_i, LeftSLParapet-ovhgBottomLeft, 0, mmask2 - 6*bExtraPrismOnLeftSideLower, matSash,
							-A/2+gs_frw1+offset_i, LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i, 0, mask1, matSash
					else
						put	-A/2+gs_sl_w1-gs_frw_Sl_left-offset_i, gs_frame_width_low_left_sl+offset_i, 0, 10, matSash,
							-A/2+gs_sl_w1-gs_frw_Sl_left, -ovhgBottomLeft, 0, mask2, matSash,
							-A/2+gs_frw1+offset_i, -ovhgBottomLeft, 0, mmask2 - 6*bExtraPrismOnLeftSideLower, matSash,
							-A/2+gs_frw1+offset_i, gs_frame_width_low_left_sl+offset_i, 0, mask1, matSash
					endif
					if iSimpleSashFrameType_i = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_i = SIMPLESASH_SIDEHUNG then
						SashLeftX	= -A/2+gs_frw1+offset_i
						SashRightX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_i
						simpleSashZ	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_i

						simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
						if iSimpleSashFrameType_i = SIMPLESASH_SLIDEHOR then
							put simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
								simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
						else
							put simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
								simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
						endif
					endif

					cprism_{2} mat1, botmat, matSash,
						nsp/5, framethick2,
						get(nsp)

					gosub 600
				else
					bExtraPrismOnLeftSide = 0

					if abs(cutDxLeft + gs_frw1 + offset_leaf) > EPS then	! avoiding self intersect. prism
						cprism_{2} mat1, botmat, matSash,
							5, framethick1,
							-A/2 - cutDxLeft, -ovhgBottom, 0, mask1 - 7*gs_stack_left, matSash,
							-A/2 - cutDxLeft, TopHeighty, 0, 8, matSash,
							-A/2+gs_frw1+offset_leaf, TopHeightInny, 0, mask1 - 2, matLeaf,
							-A/2+gs_frw1+offset_leaf, -ovhgBottom, 0, mask1, matSash,
							-A/2 - cutDxLeft, -ovhgBottom, 0, -1, matSash

						gosub 500
					endif

				endif

				if gs_sidelight_right then

					bExtraPrismOnRightSide = (bDiffFrameThk & (lod3D = 1) & (offset_05 > EPS))
					if gs_bSidelight_fr_hdiv_right then
						bExtraPrismOnRightSideLower = (bDiffFrameThk & (lod3D = 1) & (offset_07 > EPS))
					else
						bExtraPrismOnRightSideLower = bExtraPrismOnRightSide
					endif

					if bExtraPrismOnRightSide | bExtraPrismOnRightSideLower then

						! --- outside part
						put	A/2 + cutDxRight, RightSLParapet-ovhgBottomRight, 0, mask1 - 7*gs_stack_right, matSash,
							A/2 + cutDxRight, TopHeighty, 0, 8, matSash
						if gs_bSidelight_fr_hdiv_right & (bExtraPrismOnRightSide exor bExtraPrismOnRightSideLower) then
							if bExtraPrismOnRightSide then
								put	A/2-gs_frw2, TopHeightInny, 0, mask5, matSash,
									A/2-gs_frw2, horizDivRightSideLowerPY, 0, 13, matSash,
									A/2-gs_frw2, RightSLParapet-ovhgBottomRight+gs_frame_width_low_right_sl, 0, 12, matSash
							else
								put	A/2-gs_frw2, TopHeightInny, 0, 13, matSash,
									A/2-gs_frw2, horizDivRightSideUpperPY, 0, 12, matSash
							endif
							put	A/2-gs_frw2, RightSLParapet-ovhgBottomRight, 0, mask1, matSash,
								A/2 + cutDxRight, RightSLParapet-ovhgBottomRight, 0, -1, matSash
						else
							put A/2-gs_frw2, TopHeightInny, 0, mask5, matSash,
								A/2-gs_frw2, RightSLParapet-ovhgBottomRight, 0, mask1, matSash,
								A/2 + cutDxRight, RightSLParapet-ovhgBottomRight, 0, -1, matSash
						endif

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick1,
							get(nsp)

						gosub 500

						! --- inside part
						put	A/2-gs_frw2, RightSLParapet-ovhgBottomRight, 0, mask5, matSash
						if bExtraPrismOnRightSide then
							put	A/2-gs_frw2, TopHeighty-offset_05, 0, 8, matSash,
								A/2-gs_frw2-offset_05, TopHeightInny-offset_05, 0, mask1, matSash
						endif
						if (iSimpleSashFrameType_05 = SIMPLESASH_SLIDEVER) & bExtraPrismOnRightSide then
							if gs_bSidelight_fr_hdiv_right then
								SashBottomY	= horizDivRightSideUpperPY
							else
								SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_05
							endif
							SashTopY	= b-gs_frwt-offset_05
							simpleSashX	= A/2-gs_frw2-offset_05

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						if gs_bSidelight_fr_hdiv_right then
							put horizDivRightSideRightUpperPX,	horizDivRightSideUpperPY, 0, 8,		matSash,
								horizDivRightSideRightLowerPX,	horizDivRightSideLowerPY, 0, mask2,	matSash

							if (iSimpleSashFrameType_07 = SIMPLESASH_SLIDEVER) & bExtraPrismOnRightSideLower then
								SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_07
								SashTopY	= horizDivRightSideLowerPY
								simpleSashX	= horizDivRightSideRightLowerPX

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
							endif
							offset_i = offset_07
						else
							offset_i = offset_05
						endif
						if bExtraPrismOnRightSideLower then
							put	A/2-gs_frw2-offset_i, RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, 8, matSash,
								A/2-gs_frw2-offset_i, RightSLParapet-ovhgBottomRight, 0, mask1, matSash,
								A/2-gs_frw2, RightSLParapet-ovhgBottomRight, 0, -1, matSash
						endif

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick2,
							get(nsp)

						gosub 500

					else

						put	A/2 + cutDxRight, RightSLParapet-ovhgBottomRight, 0, mask1 - 7*gs_stack_right, matSash,
							A/2 + cutDxRight, TopHeighty-offset_05, 0, 8, matSash,
							A/2-gs_frw2-offset_05, TopHeightInny-offset_05, 0, mask1 - 2, matSash
						if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEVER then
							if gs_bSidelight_fr_hdiv_right then
								SashBottomY	= horizDivRightSideUpperPY
							else
								SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_05
							endif
							SashTopY	= b-gs_frwt-offset_05
							simpleSashX	= A/2-gs_frw2-offset_05

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						if gs_bSidelight_fr_hdiv_right then
							put horizDivRightSideRightUpperPX,	horizDivRightSideUpperPY, 0, mmask,	matSash,
								horizDivRightSideRightLowerPX,	horizDivRightSideLowerPY, 0, mask2,	matSash

							if iSimpleSashFrameType_07 = SIMPLESASH_SLIDEVER then
								SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_07
								SashTopY	= horizDivRightSideLowerPY
								simpleSashX	= horizDivRightSideRightLowerPX

								simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
								put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
									simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
							endif
							offset_i = offset_07
						else
							offset_i = offset_05
						endif
						put	A/2-gs_frw2-offset_i, RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, mmask, matSash,
							A/2-gs_frw2-offset_i, RightSLParapet-ovhgBottomRight, 0, mask1, matSash,
							A/2 + cutDxRight, RightSLParapet-ovhgBottomRight, 0, -1, matSash

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick1,
							get(nsp)

						gosub 500

					endif

					if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEVER then
						if gs_bSidelight_fr_hdiv_right then
							SashBottomY	= horizDivRightSideUpperPY
						else
							SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_05
						endif
						SashTopY	= b-gs_frwt-offset_05
						simpleSashX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_05

						simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
						put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
							simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
					endif
					if gs_bSidelight_fr_hdiv_right then
						put horizDivRightSideLeftUpperPX,	horizDivRightSideUpperPY, 0, 8,		matSash,
							horizDivRightSideLeftLowerPX,	horizDivRightSideLowerPY, 0, mask2,	matSash

						if iSimpleSashFrameType_07 = SIMPLESASH_SLIDEVER then
							SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_07
							SashTopY	= horizDivRightSideLowerPY
							simpleSashX	= horizDivRightSideLeftLowerPX

							simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2
							put simpleSashX, simpleSashDivy + gs_sl_sash_width/2, 0, 8, matSash,
								simpleSashX, simpleSashDivy - gs_sl_sash_width/2, 0, mask2, matSash
						endif
						offset_i = offset_07
					else
						offset_i = offset_05
					endif
					if RightSLParapet > EPS then
						put A/2-gs_sl_w2+gs_frw_Sl_right+offset_i, RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, 10, matSash,
							A/2-gs_sl_w2+gs_frw_SlParapet_right+gs_tolerance_right_2, RightSLParapet-ovhgBottomRight, 0, mask1, matSash,
							A/2-gs_sl_w2+gs_frw_SlParapet_right+gs_tolerance_right_2, -ovhgBottom, 0, mask1, matSash,
							A/2-gs_sl_w2-offset_leaf, -ovhgBottom, 0, mask3, matLeaf
					else
						put A/2-gs_sl_w2+gs_frw_Sl_right+offset_i, gs_frame_width_low_right_sl+offset_i, 0, 10, matSash,
							A/2-gs_sl_w2+gs_frw_Sl_right, -ovhgBottom, 0, mask2,  matSash,
							A/2-gs_sl_w2-offset_leaf, -ovhgBottom, 0, mask1,  matLeaf
					endif
					cprism_{2} mat1, botmat, matSash,
						3+nsp/5, framethick2,
						A/2-gs_sl_w2+gs_frw_Sl_right+offset_05, b-gs_frwt-offset_05, 0, mask1, matSash,
						get(nsp),
						A/2-gs_sl_w2-offset_leaf, b-gs_frwt-offset_leaf, 0, mmask2 - 4*bExtraPrismOnRightSide, matSash,
						A/2-gs_sl_w2+gs_frw_Sl_right+offset_05, b-gs_frwt-offset_05, 0, -1, matSash

					gosub 500

					if gs_bSidelight_fr_hdiv_right then
						iSimpleSashFrameType_i = iSimpleSashFrameType_07
						offset_i = offset_07
					else
						iSimpleSashFrameType_i = iSimpleSashFrameType_05
						offset_i = offset_05
					endif
					if RightSLParapet > EPS then
						put	A/2-gs_sl_w2+gs_frw_Sl_right+offset_i, RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, 10, matSash,
							A/2-gs_sl_w2+gs_frw_SlParapet_right+gs_tolerance_right_2, RightSLParapet-ovhgBottomRight, 0, mask1, matSash,
							A/2-gs_frw2-offset_i, RightSLParapet-ovhgBottomRight, 0, mmask2 - 6*bExtraPrismOnRightSideLower, matSash,
							A/2-gs_frw2-offset_i, RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i, 0, mask1, matSash
					else
						put	A/2-gs_sl_w2+gs_frw_Sl_right+offset_i, gs_frame_width_low_right_sl+offset_i, 0, 10, matSash,
							A/2-gs_sl_w2+gs_frw_Sl_right, -ovhgBottomRight, 0, mask2, matSash,
							A/2-gs_frw2-offset_i, -ovhgBottomRight, 0, mmask2 - 6*bExtraPrismOnRightSideLower, matSash,
							A/2-gs_frw2-offset_i, gs_frame_width_low_right_sl+offset_i, 0, mask1, matSash
					endif

					if iSimpleSashFrameType_i = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_i = SIMPLESASH_SIDEHUNG then
						SashLeftX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_i
						SashRightX	= A/2-gs_frw2-offset_i
						simpleSashZ	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_i

						simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
						if iSimpleSashFrameType_i = SIMPLESASH_SLIDEHOR then
							put simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
								simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
						else
							put simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
								simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
						endif
					endif

					cprism_{2} mat1, botmat, matSash,
						nsp/5, framethick2,
						get(nsp)

					gosub 600
				else
					bExtraPrismOnRightSide = 0

					if abs(cutDxRight + gs_frw2 + offset_leaf) > EPS then	! avoiding self intersect. prism
						cprism_{2} mat1, botmat, matSash,
							5, framethick1,
							A/2 + cutDxRight, -ovhgBottom, 0, mask1 - 7*gs_stack_right, matSash,
							A/2 + cutDxRight, TopHeighty, 0, 8, matSash,
							A/2-gs_frw2-offset_leaf, TopHeightInny, 0, mask1 - 2, matLeaf,
							A/2-gs_frw2-offset_leaf, -ovhgBottom, 0, mask1, matSash,
							A/2 + cutDxRight, -ovhgBottom, 0, -1, matSash

						gosub 500
					endif

				endif

				if gs_pocket_door_frame & lod3D <> 5 then
					cutend
					if n=2 then cutend
				endif

				if bArchedTop then
					cprism_ topmat, botmat, sidemat,
						7, outsideFrameThk,
						frameleft, gs_shoulder_h, 79,
						0, frametop - r2, 900,
						0, frametop, 3079,
						frameright, gs_shoulder_h, 3010,
						A/2-gs_frw2, gs_shoulder_h-(fce-fcefw), 79,
						0, b-gs_frwt, 3079,
						-A/2+gs_frw1, gs_shoulder_h-(fce-fcefw), 3010
					body 1
				else
					if bExtraPrismOnLeftSide then
						put	-A/2+gs_frw1, b-gs_frwt, 0, 12, matSash,
							-A/2+gs_frw1, b-gs_frwt-offset_09, 0, 8, matSash,
							-A/2+gs_frw1+offset_09, b-gs_frwt-offset_09, 0, mask2, matSash
						if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_09 = SIMPLESASH_SIDEHUNG then
							SashLeftX	= -A/2+gs_frw1+offset_09
							SashRightX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_09
							simpleSashZ	= b-gs_frwt-offset_09

							simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
							if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEHOR then
								put simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
									simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
							else
								put simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
									simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
							endif
						endif
						put	-A/2+gs_sl_w1-gs_frw_Sl_left-offset_09, b-gs_frwt-offset_09, 0, 8, matSash,
							-A/2+gs_sl_w1, b-gs_frwt, 0, 12, matSash

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick2,
							get(nsp)

						gosub 600
					endif

					if bExtraPrismOnRightSide then
						put	 A/2-gs_sl_w2, b-gs_frwt, 0, 8, matSash,
							 A/2-gs_sl_w2+gs_frw_Sl_right+offset_05, b-gs_frwt-offset_05, 0, mask2, matSash
						if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_05 = SIMPLESASH_SIDEHUNG then
							SashLeftX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_05
							SashRightX	= A/2-gs_frw2-offset_05
							simpleSashZ	= b-gs_frwt-offset_05

							simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
							if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEHOR then
								put simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
									simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
							else
								put simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
									simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
							endif
						endif
						put	 A/2-gs_frw2-offset_05, b-gs_frwt-offset_05, 0, 8, matSash,
							 A/2-gs_frw2, b-gs_frwt-offset_05, 0, 12, matSash,
							 A/2-gs_frw2, b-gs_frwt, 0, 12, matSash

						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick2,
							get(nsp)

						gosub 600
					endif

					if gs_sidelight_left then
						if bExtraPrismOnLeftSide then
							put	-A/2 - cutDxLeft, b + cutDy, 0, mask1 - 2*(gs_stack_top | gs_stack_left) - 5*gs_stack_left, matSash,
								-A/2 - cutDxLeft, b-gs_frwt, 0, 8, matSash,
								-A/2+gs_frw1, b-gs_frwt, 0, 12, matSash,
								-A/2+gs_sl_w1, b-gs_frwt, 0, mask3 - 2, matSash
						else
							put	-A/2 - cutDxLeft, b + cutDy, 0, mask1 - 2*(gs_stack_top | gs_stack_left) - 5*gs_stack_left, matSash,
								-A/2 - cutDxLeft, b-gs_frwt-offset_09, 0, 8, matSash,
								-A/2+gs_frw1+offset_09, b-gs_frwt-offset_09, 0, mask1, matSash

							if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_09 = SIMPLESASH_SIDEHUNG then
								SashLeftX	= -A/2+gs_frw1+offset_09
								SashRightX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_09
								simpleSashZ	= b-gs_frwt-offset_09

								simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
								if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEHOR then
									put simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
								else
									put simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
								endif
							endif

							put	-A/2+gs_sl_w1-gs_frw_Sl_left-offset_09, b-gs_frwt-offset_09, 0, mmask, matSash,
								-A/2+gs_sl_w1+offset_leaf, b-gs_frwt-offset_leaf, 0, mask3 - 2, matLeaf
						endif
					else
						if abs(cutDy + gs_frwt + offset_leaf) > EPS then	! avoiding self intersect. prism
							put	-A/2 - cutDxLeft, b + cutDy, 0, mask1 - 2*(gs_stack_top | gs_stack_left) - 5*gs_stack_left, matSash,
								-A/2 - cutDxLeft, b-gs_frwt, 0, 8, matSash,
								-A/2+gs_frw1+offset_leaf, b-gs_frwt-offset_leaf, 0, mask1, matLeaf
						endif
					endif

					if gs_sidelight_right then
						if bExtraPrismOnRightSide then
							put	 A/2-gs_sl_w2, b-gs_frwt, 0, 12, matSash,
								 A/2-gs_frw2, b-gs_frwt, 0, 10, matSash,
								 A/2 + cutDxRight, b-gs_frwt, 0, mask1 - 2 - 5*gs_stack_right, matSash,
								 A/2 + cutDxRight, b + cutDy, 0, mask1 - 2*(gs_stack_top | gs_stack_right) - 5*gs_stack_top, matSash,
								-A/2 - cutDxLeft, b + cutDy, 0, -1, matSash
						else
							put	 A/2-gs_sl_w2-offset_leaf, b-gs_frwt-offset_leaf, 0, mmask, matSash,
								 A/2-gs_sl_w2+gs_frw_Sl_right+offset_05, b-gs_frwt-offset_05, 0, mask1 - 2, matSash

							if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_05 = SIMPLESASH_SIDEHUNG then
								SashLeftX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_05
								SashRightX	= A/2-gs_frw2-offset_05
								simpleSashZ	= b-gs_frwt-offset_05

								simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
								if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEHOR then
									put simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
								else
									put simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
										simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
								endif
							endif

							put	 A/2-gs_frw2-offset_05, b-gs_frwt-offset_05, 0, 10, matSash,
								 A/2 + cutDxRight, b-gs_frwt-offset_05, 0, mask1 - 2 - 5*gs_stack_right, matSash,
								 A/2 + cutDxRight, b + cutDy, 0, mask1 - 2*(gs_stack_top | gs_stack_right) - 5*gs_stack_top, matSash,
								-A/2 - cutDxLeft, b + cutDy, 0, -1, matSash
						endif
					else
						if abs(cutDy + gs_frwt + offset_leaf) > EPS then	! avoiding self intersect. prism
							put	 A/2-gs_frw2-offset_leaf, b-gs_frwt-offset_leaf, 0, 10, matSash,
								 A/2 + cutDxRight, b-gs_frwt, 0, mask1 - 2 - 5*gs_stack_right, matSash,
								 A/2 + cutDxRight, b + cutDy, 0, mask1 - 2*(gs_stack_top | gs_stack_right) - 5*gs_stack_top, matSash,
								-A/2 - cutDxLeft, b + cutDy, 0, -1, matSash
						endif
					endif

					if nsp > 0 then
						cprism_{2} mat1, botmat, matSash,
							nsp/5, framethick1,
							get(nsp)
					endif
				endif

				gosub 600

			endif


			!************* Both in Type1 and Type2

			if gs_sidelight_left then
				if gs_bSidelight_fr_hdiv_left then
					SashLeftX	= -A/2+gs_frw1+offset_11
					SashRightX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_11
					SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_11
					SashTopY	= horizDivLeftSideLowerPY
					sashWidth	= gs_sl_sash_width
					iSimpleSashFrameType_i = iSimpleSashFrameType_11

					gosub "Extra Frame to Simple Sash"
				endif

				SashLeftX	= -A/2+gs_frw1+offset_09
				SashRightX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_09
				if gs_bSidelight_fr_hdiv_left then
					SashBottomY	= horizDivLeftSideUpperPY
				else
					SashBottomY	= LeftSLParapet + gs_frame_width_low_left_sl+gs_tolerance_low_left_sl+offset_09
				endif
				SashTopY	= B-gs_frwt-offset_09
				sashWidth	= gs_sl_sash_width
				iSimpleSashFrameType_i = iSimpleSashFrameType_09

				gosub "Extra Frame to Simple Sash"
			endif

			if gs_sidelight_right then
				if gs_bSidelight_fr_hdiv_right then
					SashLeftX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_07
					SashRightX	= A/2-gs_frw2-offset_07
					SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_07
					SashTopY	= horizDivRightSideLowerPY
					sashWidth	= gs_sl_sash_width
					iSimpleSashFrameType_i = iSimpleSashFrameType_07

					gosub "Extra Frame to Simple Sash"
				endif

				SashLeftX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_05
				SashRightX	= A/2-gs_frw2-offset_05
				if gs_bSidelight_fr_hdiv_right then
					SashBottomY	= horizDivRightSideUpperPY
				else
					SashBottomY	= RightSLParapet + gs_frame_width_low_right_sl+gs_tolerance_low_right_sl+offset_05
				endif
				SashTopY	= B-gs_frwt-offset_05
				sashWidth	= gs_sl_sash_width
				iSimpleSashFrameType_i = iSimpleSashFrameType_05

				gosub "Extra Frame to Simple Sash"
			endif

			addz frameThickOffset

		next i

		del n

	endif

! ------------------------------------------------------------------------------
! Horizontal Division in both type transom and type without transom,
! type butt and type mitered joint
! ------------------------------------------------------------------------------

! --- Left horizontal division

	if gs_sidelight_left & gs_bSidelight_fr_hdiv_left then
		put horizDivLeftSideLeftUpperPX,	horizDivLeftSideUpperPY, 0, mmask2-4*(bExtraPrismOnLeftSide | bExtraPrismOnLeftSideLower), matSash,
			horizDivLeftSideLeftLowerPX,	horizDivLeftSideLowerPY, 0, mask1,	matSash
		if iSimpleSashFrameType_11 = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_11 = SIMPLESASH_SIDEHUNG then
			SashLeftX	= -A/2+gs_frw1+offset_11
			SashRightX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_11
			simpleSashZ	= horizDivLeftSideLowerPY

			simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
			if iSimpleSashFrameType_11 = SIMPLESASH_SLIDEHOR then
				put simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
					simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
			else
				put simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
					simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
			endif
		endif
		put	horizDivLeftSideRightLowerPX,	horizDivLeftSideLowerPY, 0, 10,		matSash,
			horizDivLeftSideRightUpperPX,	horizDivLeftSideUpperPY, 0, mask1,	matSash
		if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_09 = SIMPLESASH_SIDEHUNG then
			SashLeftX	= -A/2+gs_frw1+offset_09
			SashRightX	= -A/2+gs_sl_w1-gs_frw_Sl_left-offset_09
			simpleSashZ	= horizDivLeftSideUpperPY

			simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
			if iSimpleSashFrameType_09 = SIMPLESASH_SLIDEHOR then
				put simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
					simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
			else
				put simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
					simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
			endif
		endif

		cprism_{2} mat1, botmat, matSash,
			nsp/5, framethick2,
			get(nsp)

		gosub 600
	endif


! --- Right horizontal division

	if gs_sidelight_right & gs_bSidelight_fr_hdiv_right then

		put horizDivRightSideLeftUpperPX,	horizDivRightSideUpperPY, 0, 10,	matSash,
			horizDivRightSideLeftLowerPX,	horizDivRightSideLowerPY, 0, mask1,	matSash
		if iSimpleSashFrameType_07 = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_07 = SIMPLESASH_SIDEHUNG then
			SashLeftX	= A/2-gs_frw2-offset_07
			SashRightX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_07
			simpleSashZ	= horizDivRightSideLowerPY

			simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
			if iSimpleSashFrameType_07 = SIMPLESASH_SLIDEHOR then
				put simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
					simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
			else
				put simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
					simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
			endif
		endif
		put	horizDivRightSideRightLowerPX,	horizDivRightSideLowerPY, 0, mmask2-4*(bExtraPrismOnRightSide | bExtraPrismOnRightSideLower), matSash,
			horizDivRightSideRightUpperPX,	horizDivRightSideUpperPY, 0, mask1,	matSash
		if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_05 = SIMPLESASH_SIDEHUNG then
			SashLeftX	= A/2-gs_frw2-offset_05
			SashRightX	= A/2-gs_sl_w2+gs_frw_Sl_right+offset_05
			simpleSashZ	= horizDivRightSideUpperPY

			simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
			if iSimpleSashFrameType_05 = SIMPLESASH_SLIDEHOR then
				put simpleSashDivx + gs_sl_sash_width/2, simpleSashZ, 0, 8, matSash,
					simpleSashDivx - gs_sl_sash_width/2, simpleSashZ, 0, mask2, matSash
			else
				put simpleSashDivx + gs_sl_sash_width, simpleSashZ, 0, 8, matSash,
					simpleSashDivx - gs_sl_sash_width, simpleSashZ, 0, mask2, matSash
			endif
		endif

		cprism_{2} mat1, botmat, matSash,
			nsp/5, framethick2,
			get(nsp)

		gosub 600
	endif

	body -1

	for i=1 to numCuts
		cutend
	next i
	numCuts = 0


	if bEnableJointMat then
		base

		if gs_SashText_typ_num = 1 then
			if gs_jointmat_out = gs_jointmat_in then

				if gs_tolerance_left > 0 then
					cprism_ topjmat, botjmat, sidejmat,
						4, outsideFrameThk,
						frameleft-cutDxLeft,	0,	15,
						frameleft-cutDxLeft,	frametop+cutDy,	8+7*bTolU,
						frameleft,	frametop,	15,
						frameleft,	0,	15

					gosub 500
				endif

				if gs_tolerance_right > 0 then
					cprism_ topjmat, botjmat, sidejmat,
						4, outsideFrameThk,
						frameright+cutDxRight, 	0, 	15,
						frameright+cutDxRight, 	frametop+cutDy,	8+7*bTolU,
						frameright,	frametop,	15,
						frameright,	0,	15

					gosub 500
				endif

				if gs_tolerance_upper > 0 then
					cprism_ topjmat, botjmat, sidejmat,
						4, outsideFrameThk,
						frameleft-cutDxLeft,	frametop+cutDy,	10+5*bTolL,
						frameleft,	frametop,	15,
						frameright,	frametop,	10+5*bTolR,
						frameright+cutDxRight,	frametop+cutDy,	15

					gosub 600
				endif
			else
				if gs_tolerance_left > 0 then
					cprism_ botjmat, botjmat, botjmat,
						4, LeafRebate,
						frameleft-cutDxLeft,	0,	15,
						frameleft-cutDxLeft,	frametop+cutDy,	8+7*bTolU,
						frameleft,	frametop,	15,
						frameleft,	0,	15
					body 1

					addz LeafRebate

					cprism_ topjmat, botjmat, topjmat,
						4, outsideFrameThk-LeafRebate,
						frameleft-cutDxLeft,	0,	15,
						frameleft-cutDxLeft,	frametop+CutDy,	8+7*bTolU,
						frameleft,	frametop,	15,
						frameleft,	0,	15

					del 1

					gosub 500
				endif

				if gs_tolerance_right > 0 then
					cprism_ botjmat, botjmat, botjmat,
						4, LeafRebate,
						frameright+cutDxRight, 	0, 	15,
						frameright+cutDxRight, 	frametop+CutDy,	8+7*bTolU,
						frameright,	frametop,	15,
						frameright,	0,	15
					body 1

					addz LeafRebate

					cprism_ topjmat, botjmat, topjmat,
						4, outsideFrameThk-LeafRebate,
						frameright+cutDxRight, 	0, 	15,
						frameright+cutDxRight, 	frametop+CutDy,	8+7*bTolU,
						frameright,	frametop,	15,
						frameright,	0,	15

					del 1

					gosub 500
				endif

				if gs_tolerance_upper > 0 then
					cprism_ botjmat, botjmat, botjmat,
						4, LeafRebate,
						frameleft-cutDxLeft,	frametop+cutDy,	10+5*bTolL,
						frameleft,	frametop,	15,
						frameright,	frametop,	10+5*bTolL,
						frameright+cutDxRight,	frametop+cutDy,	15
					body 1

					addz LeafRebate

					cprism_ topjmat, botjmat, topjmat,
						4, outsideFrameThk-LeafRebate,
						frameleft-cutDxLeft,	frametop+cutDy,	10+5*bTolL,
						frameleft,	frametop,	15,
						frameright,	frametop,	10+5*bTolR,
						frameright+cutDxRight,	frametop+cutDy,	15

					del 1

					gosub 600
				endif
			endif

		else

			if gs_jointmat_out = gs_jointmat_in then
				if gs_tolerance_left > 0 then
					cprism_ topjmat, botjmat, sidejmat,
						4, outsideFrameThk,
						frameleft-cutDxLeft,	0,	15,
						frameleft-cutDxLeft,	frametop,	8+7*bTolL,
						frameleft,	frametop,	15,
						frameleft,	0,	15

					gosub 500
				endif

				if gs_tolerance_right > 0 then
					cprism_ topjmat, botjmat, sidejmat,
						4, outsideFrameThk,
						frameright+cutDxRight, 	0, 	15,
						frameright+cutDxRight, 	frametop,	8+7*bTolR,
						frameright,	frametop,	13,
						frameright,	0,	15

					gosub 500
				endif

				if gs_tolerance_upper > 0 then
					cprism_ topjmat, botjmat, sidejmat,
						6, outsideFrameThk,
						frameleft-cutDxLeft,	frametop+cutDy,	15,
						frameleft-cutDxLeft,	frametop,	8+7*bTolL,
						frameleft,	frametop,	15,
						frameright,	frametop,	10+5*bTolR,
						frameright+cutDxRight,	frametop,	13+2*bTolR,
						frameright+cutDxRight,	frametop+cutDy,	15

					gosub 600
				endif
			else
				if gs_tolerance_left > 0 then
					cprism_ botjmat, botjmat, botjmat,
						4, LeafRebate,
						frameleft-cutDxLeft,	0,	15,
						frameleft-cutDxLeft,	frametop,	8+7*bTolL,
						frameleft,	frametop,	15,
						frameleft,	0,	15
					body 1

					addz LeafRebate

					cprism_ topjmat, botjmat, topjmat,
						4, outsideFrameThk-LeafRebate,
						frameleft-cutDxLeft,	0,	15,
						frameleft-cutDxLeft,	frametop,	8+7*bTolL,
						frameleft,	frametop,	15,
						frameleft,	0,	15

					del 1

					gosub 500
				endif

				if gs_tolerance_right > 0 then
					cprism_ botjmat, botjmat, botjmat,
						4, LeafRebate,
						frameright+cutDxRight, 	0, 	15,
						frameright+cutDxRight, 	frametop,	8+7*bTolR,
						frameright,	frametop,	13,
						frameright,	0,	15
					body 1

					addz LeafRebate

					cprism_ topjmat, botjmat, topjmat,
						4, outsideFrameThk-LeafRebate,
						frameright+cutDxRight, 	0, 	15,
						frameright+cutDxRight, 	frametop,	8+7*bTolR,
						frameright,	frametop,	13,
						frameright,	0,	15

					del 1

					gosub 500
				endif

				if gs_tolerance_upper > 0 then
					cprism_ botjmat, botjmat, botjmat,
						6, LeafRebate,
						frameleft-cutDxLeft,	frametop+cutDy,	15,
						frameleft-cutDxLeft,	frametop,	8+7*bTolL,
						frameleft,	frametop,	15,
						frameright,	frametop,	10+5*bTolR,
						frameright+cutDxRight,	frametop,	13+2*bTolR,
						frameright+cutDxRight,	frametop+cutDy,	15
					body 1

					addz LeafRebate

					cprism_ topjmat, botjmat, topjmat,
						6, outsideFrameThk-LeafRebate,
						frameleft-cutDxLeft,	frametop+cutDy,	15,
						frameleft-cutDxLeft,	frametop,	8+7*bTolL,
						frameleft,	frametop,	15,
						frameright,	frametop,	10+5*bTolR,
						frameright+cutDxRight,	frametop,	13+2*bTolR,
						frameright+cutDxRight,	frametop+cutDy,	15

					del 1

					gosub 600
				endif
			endif
		endif

		body -1
	endif
else

! ===========================================================================
! Commercial Door Frame
! ===========================================================================

	if gs_frame_style_m = FRAME_STYLE_METAL then

		fitFrame_top_ovhg	= 0
		fitFrame_left_ovhg	= 0
		fitFrame_right_ovhg	= 0

		if gs_fitframe_slantedreveal then
			fitFrame_top_ovhg	= tan(gs_reveal_top_angle) * outsideFrameThk
			fitFrame_left_ovhg	= tan(gs_reveal_left_angle) * outsideFrameThk
			fitFrame_right_ovhg	= tan(gs_reveal_right_angle) * outsideFrameThk
		endif

		signFlipped = (WIDO_REVEAL_SIDE - not(WIDO_REVEAL_SIDE))

		material gs_frame_mat
		gs_txt = 1
		jp = 1/2"
		fi1 = atn(gs_frw1/gs_frwt)
		fi2 = atn(gs_frw2/gs_frwt)
		ctx = jp * gs_frame_wthk

		if abs(gs_ds_w) > eps then
!!			if gs_side_exist = 0 then add 0, 0, gs_ds_pr - ctx
!!			if gs_side_exist = 1 then add  ac_leaf_width/2 + frameleft  + gs_sl_w1, 0, gs_ds_pr - ctx
!!			if gs_side_exist = 3 then add -ac_leaf_width/2 + frameright - gs_sl_w1, 0, gs_ds_pr - ctx

			add ac_leaf_width/2 + frameleft + gs_sl_w1, 0, gs_ds_pr - ctx

			for i=1 to 2
				cprism_ gs_frame_mat, gs_frame_mat, gs_frame_mat,
					 5, gs_ds_thk,
					-ac_leaf_width/2, 0, 15,
					-ac_leaf_width/2+gs_ds_w, 0, 15,
					-ac_leaf_width/2+gs_ds_w, ac_leaf_height-gs_ds_w*(gs_txt<>1), 15-5*(gs_txt=3),
					-ac_leaf_width/2, ac_leaf_height-gs_ds_w*(gs_txt=2), 15,
					-ac_leaf_width/2, 0, -1
				if i=2 then mulx -1
				teta=90
				tx=0
				gosub 500
				if i=2 then del 1

				mulx -1
			next i
			del 2

			cprism_ gs_frame_mat, gs_frame_mat, gs_frame_mat,
				5, gs_ds_thk,
				-ac_leaf_width/2+gs_ds_w*(gs_txt=1),  ac_leaf_height, 15,
				 ac_leaf_width/2-gs_ds_w*(gs_txt=1),  ac_leaf_height, 15-5*(gs_txt=3),
				 ac_leaf_width/2-gs_ds_w*(gs_txt<>2), ac_leaf_height-gs_ds_w, 15,
				-ac_leaf_width/2+gs_ds_w*(gs_txt<>2), ac_leaf_height-gs_ds_w, 15-5*(gs_txt=3),
				-ac_leaf_width/2+gs_ds_w*(gs_txt=1),  ac_leaf_height, -1
			teta=0
			tx=0.5
			gosub 600

			del 1
		endif

		rotx -90

! Right -----------------------------------------------------------------------

		if gs_fitframe_slantedreveal then		! slanted reveal cuts
			addz frametop + WIDO_REVEAL_SIDE * fitFrame_top_ovhg
			rotx signFlipped  * gs_reveal_top_angle
			cutplane
			del 2
		endif

		addx frameright-gs_frw2

		addz frametop-gs_frwt
		rotx 90
		ang = atn((gs_frwt+fitFrame_top_ovhg)/(gs_frw2+fitFrame_right_ovhg))
		dx = gs_frwt+gs_tolerance_upper*not(gs_frame_wthk)+1+TAN(gs_reveal_right_angle) * gs_fthk * gs_fitframe_slantedreveal
		cutpolya 5, 2, 0,
			0, 0, 15,
			-gs_ds_w-0.01, -gs_ds_w-0.01, 15,
			-gs_ds_w-0.01,  dx, 15,
			dx/tan(ang), dx, 15,
			0, 0, -1
		del 2

		rotz 90

		if gs_fitframe_slantedreveal then
			if gs_frame_ovhg_right_out > gs_frame_ovhg_right_in then
				put	ctx,				0,                            																	15,
					ctx,				-gs_frw2-gs_tolerance_right*not(gs_frame_wthk) - tan(gs_reveal_right_angle) * outsideFrameThk,			15,
					ctx-jp,				-gs_frw2-gs_tolerance_right*not(gs_frame_wthk) - tan(gs_reveal_right_angle) * (outsideFrameThk-jp),	15,
					ctx-jp,				-gs_frw2-gs_tolerance_right+jp*not(gs_frame_wthk),												15,
					-outsideFrameThk+jp-ctx,	-gs_frw2-gs_tolerance_right+jp*not(gs_frame_wthk),												15,
					-outsideFrameThk+jp-ctx,	-gs_frw2-gs_tolerance_right*not(gs_frame_wthk) - tan(gs_reveal_right_angle) * jp,				15,
					-outsideFrameThk-ctx,		-gs_frw2-gs_tolerance_right*not(gs_frame_wthk),													15
			else
				put	ctx,				0,                            																	15,
					ctx,				-gs_frw2-gs_tolerance_right*not(gs_frame_wthk),               									15,
					ctx-jp,				-gs_frw2-gs_tolerance_right*not(gs_frame_wthk) - tan(gs_reveal_right_angle) * jp,				15,
					ctx-jp,				-gs_frw2-gs_tolerance_right+jp*not(gs_frame_wthk),												15,
					-outsideFrameThk+jp-ctx,	-gs_frw2-gs_tolerance_right+jp*not(gs_frame_wthk),												15,
					-outsideFrameThk+jp-ctx,	-gs_frw2-gs_tolerance_right*not(gs_frame_wthk) - tan(gs_reveal_right_angle) * (outsideFrameThk-jp),	15,
					-outsideFrameThk-ctx,		-gs_frw2-gs_tolerance_right*not(gs_frame_wthk) - tan(gs_reveal_right_angle) * outsideFrameThk,			15
			endif
		else
			put	ctx,				0,                            						15,
				ctx,				-gs_frw2-gs_tolerance_right*not(gs_frame_wthk),		15,
				ctx-jp,				-gs_frw2-gs_tolerance_right*not(gs_frame_wthk),		15,
				ctx-jp,				-gs_frw2-gs_tolerance_right+jp*not(gs_frame_wthk),	15,
				-outsideFrameThk+jp-ctx,	-gs_frw2-gs_tolerance_right+jp*not(gs_frame_wthk),	15,
				-outsideFrameThk+jp-ctx,	-gs_frw2-gs_tolerance_right*not(gs_frame_wthk),		15,
				-outsideFrameThk-ctx,		-gs_frw2-gs_tolerance_right*not(gs_frame_wthk),		15
		endif

		prism_ 2+nsp/3, frametop + fitFrame_top_ovhg + max(0, gs_tolerance_upper),
			get(nsp),
			-outsideFrameThk-ctx,	 	0,	15,
			ctx, 				0,	15

		cutend
		if gs_fitframe_slantedreveal then cutend

		del 2

		gosub 500

! Top -------------------------------------------------------------------------

		if gs_fitframe_slantedreveal then		! slanted reveal cuts
			addx frameright + WIDO_REVEAL_SIDE * fitFrame_right_ovhg
			roty 90
			rotx signFlipped  * gs_reveal_right_angle
			cutplane
			del 3

			addx frameleft - WIDO_REVEAL_SIDE *  fitFrame_left_ovhg
			roty -90
			rotx signFlipped  * gs_reveal_left_angle
			cutplane
			del 3
		endif

		add frameleft + gs_frw1, 0, frametop - gs_frwt
		rotx 90
		ang = atn((gs_frwt+fitFrame_top_ovhg)/(gs_frw1+fitFrame_left_ovhg))
		dx = (gs_frwt+gs_tolerance_upper*not(gs_frame_wthk)+1+TAN(gs_reveal_top_angle) * gs_fthk *gs_fitframe_slantedreveal)
		cutpolya 5, 2, 0,
			0, 0, 15,
			gs_ds_w+0.01, -gs_ds_w-0.01, 15,
			-dx/tan(ang), -gs_ds_w-0.01, 15,
			-dx/tan(ang), dx, 15,
			0, 0, -1
		del 1

		add frameright - frameleft - gs_frw1 - gs_frw2, 0, 0
		rotx 90
		ang = atn((gs_frwt+fitFrame_top_ovhg)/(gs_frw2+fitFrame_right_ovhg))
		cutpolya 5, 2, 0,
			0, 0, 15,
			-gs_ds_w-0.01, -gs_ds_w-0.01, 15,
			dx/tan(ang),  -gs_ds_w-0.01, 15,
			dx/tan(ang), dx, 15,
			0, 0, -1
		del 2

		roty 90
		rotz 90
		mulx -1
		addz -fitFrame_left_ovhg - gs_frw1 - max(0, gs_tolerance_left)


		if gs_fitframe_slantedreveal then
			if gs_frame_ovhg_right_out > gs_frame_ovhg_right_in then
				put -ctx,				0,                            																15,
					-ctx,				gs_frwt+gs_tolerance_upper*not(gs_frame_wthk) + tan(gs_reveal_top_angle) * outsideFrameThk,			15,
					-ctx+jp,			gs_frwt+gs_tolerance_upper*not(gs_frame_wthk) + tan(gs_reveal_top_angle) * (outsideFrameThk-jp),	15,
					-ctx+jp,			gs_frwt+gs_tolerance_upper-jp*not(gs_frame_wthk),											15,
					outsideFrameThk-jp+ctx,		gs_frwt+gs_tolerance_upper-jp*not(gs_frame_wthk),											15,
					outsideFrameThk-jp+ctx,		gs_frwt+gs_tolerance_upper*not(gs_frame_wthk) + tan(gs_reveal_top_angle) * jp,				15,
					outsideFrameThk+ctx,		gs_frwt+gs_tolerance_upper*not(gs_frame_wthk),												15
			else
				put -ctx,				0,            																				15,
					-ctx,				gs_frwt+gs_tolerance_upper*not(gs_frame_wthk),												15,
					-ctx+jp,			gs_frwt+gs_tolerance_upper*not(gs_frame_wthk) + tan(gs_reveal_top_angle) * jp,				15,
					-ctx+jp,			gs_frwt+gs_tolerance_upper-jp*not(gs_frame_wthk),											15,
					outsideFrameThk-jp+ctx,		gs_frwt+gs_tolerance_upper-jp*not(gs_frame_wthk),											15,
					outsideFrameThk-jp+ctx,		gs_frwt+gs_tolerance_upper*not(gs_frame_wthk) + tan(gs_reveal_top_angle) * (outsideFrameThk-jp),	15,
					outsideFrameThk+ctx,		gs_frwt+gs_tolerance_upper*not(gs_frame_wthk) + tan(gs_reveal_top_angle) * outsideFrameThk,		15
			endif
		else
			put	-ctx,				0,                            						15,
				-ctx,				gs_frwt+gs_tolerance_upper*not(gs_frame_wthk), 		15,
				-ctx+jp,			gs_frwt+gs_tolerance_upper*not(gs_frame_wthk), 		15,
				-ctx+jp,			gs_frwt+gs_tolerance_upper-jp*not(gs_frame_wthk),	15,
				outsideFrameThk-jp+ctx,		gs_frwt+gs_tolerance_upper-jp*not(gs_frame_wthk),	15,
				outsideFrameThk-jp+ctx,		gs_frwt+gs_tolerance_upper*not(gs_frame_wthk),  	15,
				outsideFrameThk+ctx,		gs_frwt+gs_tolerance_upper*not(gs_frame_wthk),		15
		endif


		prism_ 2+nsp/3, frameright - frameleft + fitFrame_left_ovhg + fitFrame_right_ovhg + max(0, gs_tolerance_left) + max(0, gs_tolerance_right),
			get(nsp),
			outsideFrameThk+ctx,	0,	15,
			-ctx,			0,	15

		cutend
		cutend
		if gs_fitframe_slantedreveal then cutend
		if gs_fitframe_slantedreveal then cutend

		del 5
		gosub 600

! Left ------------------------------------------------------------------------

		if gs_fitframe_slantedreveal then		! slanted reveal cuts
			addz frametop + WIDO_REVEAL_SIDE * fitFrame_top_ovhg
			rotx signFlipped * gs_reveal_top_angle
			cutplane
			del 2
		endif

		addx frameleft+gs_frw1

		addz frametop-gs_frwt
		rotx 90
		ang = atn((gs_frwt+fitFrame_top_ovhg)/(gs_frw1+fitFrame_left_ovhg))
		dx = gs_frwt+gs_tolerance_upper*not(gs_frame_wthk)+1+TAN(gs_reveal_left_angle) * gs_fthk * gs_fitframe_slantedreveal
		cutpolya 5, 2, 0,
			0, 0, 15,
			gs_ds_w+0.01, -gs_ds_w-0.01, 15,
			gs_ds_w+0.01, dx, 15,
			-dx/tan(ang), dx, 15,
			0, 0, -1
		del 2

		rotz 90
		mulx -1

		if gs_fitframe_slantedreveal then
			if gs_frame_ovhg_left_out > gs_frame_ovhg_left_in then
				put -ctx,				0,                            																15,
					-ctx,				gs_frw1+gs_tolerance_left*not(gs_frame_wthk) + tan(gs_reveal_left_angle) * outsideFrameThk, 		15,
					-ctx+jp,			gs_frw1+gs_tolerance_left*not(gs_frame_wthk) + tan(gs_reveal_left_angle) * (outsideFrameThk-jp),	15,
					-ctx+jp,			gs_frw1+gs_tolerance_left-jp*not(gs_frame_wthk),  											15,
					outsideFrameThk-jp+ctx,		gs_frw1+gs_tolerance_left-jp*not(gs_frame_wthk),											15,
					outsideFrameThk-jp+ctx,		gs_frw1+gs_tolerance_left*not(gs_frame_wthk) + tan(gs_reveal_left_angle) * jp,				15,
					outsideFrameThk+ctx,		gs_frw1+gs_tolerance_left*not(gs_frame_wthk),												15
			else
				put-ctx,				0,                            																15,
					-ctx,				gs_frw1+gs_tolerance_left*not(gs_frame_wthk), 												15,
					-ctx+jp,			gs_frw1+gs_tolerance_left*not(gs_frame_wthk) + tan(gs_reveal_left_angle) * jp,				15,
					-ctx+jp,			gs_frw1+gs_tolerance_left-jp*not(gs_frame_wthk),  											15,
					outsideFrameThk-jp+ctx,		gs_frw1+gs_tolerance_left-jp*not(gs_frame_wthk),											15,
					outsideFrameThk-jp+ctx,		gs_frw1+gs_tolerance_left*not(gs_frame_wthk) + tan(gs_reveal_left_angle) * (outsideFrameThk-jp),	15,
					outsideFrameThk+ctx,		gs_frw1+gs_tolerance_left*not(gs_frame_wthk) + tan(gs_reveal_left_angle) * outsideFrameThk,			15
			endif
		else
			put -ctx,				0,                            						15,
				-ctx,				gs_frw1+gs_tolerance_left*not(gs_frame_wthk), 		15,
				-ctx+jp,			gs_frw1+gs_tolerance_left*not(gs_frame_wthk),		15,
				-ctx+jp,			gs_frw1+gs_tolerance_left-jp*not(gs_frame_wthk),  	15,
				outsideFrameThk-jp+ctx,		gs_frw1+gs_tolerance_left-jp*not(gs_frame_wthk),	15,
				outsideFrameThk-jp+ctx,		gs_frw1+gs_tolerance_left*not(gs_frame_wthk),		15,
				outsideFrameThk+ctx,		gs_frw1+gs_tolerance_left*not(gs_frame_wthk),		15
		endif


		prism_ 2+nsp/3, frametop + fitFrame_top_ovhg + max(0, gs_tolerance_upper),
			get(nsp),
			outsideFrameThk+ctx,	 	0,	15,
			-ctx, 				0,	15
		del 1

		cutend
		if gs_fitframe_slantedreveal then cutend

		del 2

		gosub 500

		del 1

		if gs_sidelight_left then
			add 0, 0, -ctx
			cprism_ gs_frame_mat, gs_frame_mat, gs_frame_mat,
				5, outsideFrameThk+2*ctx,
				-A/2+gs_sl_w1, 0, 15,
				-A/2+gs_sl_w1-gs_frw_Sl_left, 0, 15,
				-A/2+gs_sl_w1-gs_frw_Sl_left, ac_leaf_height, 15,
				-A/2+gs_sl_w1, ac_leaf_height, 15,
				-A/2+gs_sl_w1, 0, -1
			body 1
			del 1
		endif

		if gs_sidelight_right then
			add 0, 0, -ctx
			cprism_ gs_frame_mat, gs_frame_mat, gs_frame_mat,
				5, outsideFrameThk+2*ctx,
				A/2-gs_sl_w2, 0, 15,
				A/2-gs_sl_w2+gs_frw_Sl_right, 0, 15,
				A/2-gs_sl_w2+gs_frw_Sl_right, ac_leaf_height, 15,
				A/2-gs_sl_w2, ac_leaf_height, 15,
				A/2-gs_sl_w2, 0, -1
			body 1
			del 1
		endif

		if gs_door_transom then
			add 0, 0, -ctx
			cprism_ gs_frame_mat, gs_frame_mat, gs_frame_mat,
				5, outsideFrameThk+2*ctx,
				-A/2+gs_frw1, ac_leaf_height, 15,
				A/2-gs_frw2, ac_leaf_height, 15,
				A/2-gs_frw2, ac_leaf_height+gs_frwm, 15,
				-A/2+gs_frw1, ac_leaf_height+gs_frwm, 15,
				-A/2+gs_frw1, ac_leaf_height, -1
			body 1
			del 1
		endif
	endif

endif

! ===========================================================================
! Double Egress Metal Door
! ===========================================================================

if gs_frame_style_m = FRAME_STYLE_DOUBLE_EGRESS_METAL then

	signFlipped = -1

	material gs_frame_mat

	xCutFrameRight2 = gs_frw2-gs_rebate_width * 2
	xCutFrameUp2 = gs_frwt - gs_rebate_width * 2
	xCutFrameLeft2 = gs_frw1-gs_rebate_width * 2

	rotx -90

	! Right Side
	! -----------------------------------------------------------------------

	add unitright, -posLeafy - gs_leaf_thk, unittop
	rotx 90
	cutpolya 6, 2, -eps,
		0,									0, 2+8,
		-gs_frw2+gs_rebate_width,			0, 8,
		-gs_frw2+gs_rebate_width,			-xCutFrameUp2, 1+2+8,
		-xCutFrameRight2,					-xCutFrameUp2, 2+8,
		gs_tolerance_right,	gs_tolerance_upper, 8,
		0, 0, 2+8,
		0,0, signFlipped

	roty 180
	cutpolya 5, 2, -eps,
		0, 0, 15,
		gs_frw2, 0, 8,
		gs_frw2,			-gs_frwt, 2+8,
		-gs_tolerance_right, gs_tolerance_upper, 8,
		0, 0, 2+8,
		0,0, signFlipped
	del 3

	add leafright + frameDiff, -gs_frame_thk, 0
	rotz 180

	framex		= gs_frw2
	tolerancex	= gs_tolerance_right
	drawUpper	= 0
	lengthx		= ac_unit_height

	gosub "Egress Metal Profile"

	cutend
	cutend
	del 2

	gosub 500

	! Top Side
	! -----------------------------------------------------------------------

	! right cut
	add unitright, -posLeafy - gs_leaf_thk, unittop
	rotx 90
	cutpolya 5, 2, -eps,
		0,					0,  				2+8,
		0,					-xCutFrameUp2, 		8,
		-xCutFrameRight2,	-xCutFrameUp2, 		2+8,
		gs_tolerance_right, gs_tolerance_upper, 8,
		0, 0, 2+8,
		0,0, signFlipped


	rotx -180
	cutpolya 5, 2,  -eps,
		0, 0, 2+8,
		0, gs_frwt, 8,
		-gs_frw2, gs_frwt, 2+8,
		gs_tolerance_right, -gs_tolerance_upper, 8,
		0, 0, 2+8,
		0,0, signFlipped

	del 3

	add unitright, -gs_frame_thk, leaftop - gs_rebate_width
	rotz 180
	roty 90

	framex		= gs_frwt
	tolerancex	= gs_tolerance_upper
	drawUpper	= 1
	lengthx		= gs_mdpw + gs_frw2 - gs_rebate_width

	gosub "Egress Metal Profile"

	cutend
	cutend
	del 3

	gosub 500

	! left cut
	add unitleft,  -posLeafy, unittop
	rotx 90
	cutpolya 5, 2,  -eps,
		0, 		0, 2+8,
		0, 		-gs_frwt, 8,
		gs_frw1, -gs_frwt, 2+8,
		-gs_tolerance_left, gs_tolerance_upper, 8,
		0, 		0, 2+8,
		0,0, signFlipped


	roty 180
	cutpolya 5, 2, -eps,
		0, 0,					2+8,
		0, 		-xCutFrameUp2, 8,
		-xCutFrameLeft2,	-xCutFrameUp2,	2+8,
		gs_tolerance_left, gs_tolerance_upper,	8,
		0, 0,					2+8,
		0,0, signFlipped

	del 3

	add unitleft, 0, leaftop - gs_rebate_width
	roty 90

	framex		= gs_frwt
	tolerancex	= gs_tolerance_upper
	drawUpper	= 1
	lengthx		= ac_unit_width - (gs_mdpw + gs_frw2 - gs_rebate_width)

	gosub "Egress Metal Profile"

	cutend
	cutend
	del 2

	gosub 500

	! Left Side
	! -----------------------------------------------------------------------

	add unitleft, -posLeafy, unittop
	rotx 90
	cutpolya 5, 2,  -eps,
		0, 0, 2+8,
		gs_frw1, 0, 8,
		gs_frw1, -gs_frwt, 2+8,
		-gs_tolerance_left, gs_tolerance_upper, 8,
		0, 0, 2+8,
		0,0, signFlipped

	roty 180
	cutpolya 6, 2, -eps,
		0, 0, 2+8,
		-xCutFrameLeft2 - gs_rebate_width, 0, 8,
		-xCutFrameLeft2 - gs_rebate_width, -xCutFrameUp2, 1+2+8,
		-xCutFrameLeft2, -xCutFrameUp2, 2+8,
		gs_tolerance_left, gs_tolerance_upper, 8,
		0, 0, 2+8,
		0,0, signFlipped
	del 3

	addx leafleft + frameDiff

	framex		= gs_frw1
	tolerancex	= gs_tolerance_left
	drawUpper	= 0
	lengthx		= ac_unit_height

	gosub "Egress Metal Profile"

	cutend
	cutend
	del 1

	gosub 500

endif

if bNeedCutting & outsideFrameThk > EPS then
	cutend
	cutend
	cutend
endif


! =============================================================================
! Pockets
! =============================================================================
"PlacingPockets":

if gs_pocket & lod3D <> 5 then

	add (gs_tolerance_right - gs_tolerance_left)/2, 0, posLeafy

	if gs_pocket_door_frame then
		heightLeaf = ac_leaf_height
	else
		heightLeaf = ac_wallhole_height
	endif

	unID = 3400

	if bDoubleDoor then
		if gs_usaframe then
			PocketWidth = ac_leaf_width/2-0.005
			if gs_pocket_door_frame then PocketWidth = ac_leaf_width/2 - gs_frame_width_right - gs_tolerance_right-0.005
		else
			if bPocketWidthOverride then
				PocketWidth = gs_pocket_width/2 - (ac_egress_width/2 + gs_frame_width_right + gs_tolerance_right) * gs_pocket_door_frame - ac_wallhole_width/2 * not(gs_pocket_door_frame)
			else
				PocketWidth = ac_wallhole_width/2
				if gs_pocket_door_frame then PocketWidth = ac_egress_width/2 - gs_frame_width_right - gs_tolerance_right
			endif
		endif
	else
		if gs_usaframe then
			PocketWidth = ac_leaf_width-0.005
			if gs_pocket_door_frame then PocketWidth = ac_leaf_width - gs_frame_width_right - gs_tolerance_right -0.005
		else
			if bPocketWidthOverride then
				PocketWidth = gs_pocket_width - (A + gs_tolerance_left + gs_tolerance_right) * gs_pocket_door_frame - ac_wallhole_width * not(gs_pocket_door_frame)
			else
				PocketWidth = ac_wallhole_width
				if gs_pocket_door_frame then PocketWidth = ac_egress_width - gs_frame_width_right - gs_tolerance_right
			endif
		endif
	endif
	gosub "Pocket"


	if bDoubleDoor then
		if gs_usaframe then
			if gs_pocket_door_frame then PocketWidth = ac_leaf_width/2 - gs_frame_width_left - gs_tolerance_left-0.005
		else
			if bPocketWidthOverride then
				PocketWidth = gs_pocket_width/2 - (ac_egress_width/2 + gs_frame_width_left + gs_tolerance_left) * gs_pocket_door_frame - ac_wallhole_width/2 * not(gs_pocket_door_frame)
			else
				if gs_pocket_door_frame then PocketWidth = ac_egress_width/2 - gs_frame_width_left - gs_tolerance_left
			endif
		endif
		mulx -1
		gosub "Pocket"
		del 1
	endif

	del 1
endif



end


! =============================================================================
! Pocket for Pocket Doors
! =============================================================================

"Pocket":

addx ac_wallhole_width/2

if gs_pocket_frame then

	sect_fill fr_sect_fill_type, fr_sect_fill_bg, fr_sect_fill_fg, gs_frame_pen_cont
	material gs_frame_mat
	pen gs_frame_pen

	rotx -90

	hotspot 0,											gs_pocket_frame_thk,					0,		unID	:	unID = unID+1
	hotspot 0,											- widthWallCut - gs_pocket_frame_thk,	0,		unID	:	unID = unID+1
	hotspot PocketWidth + 0.005 + gs_pocket_frame_thk,	- widthWallCut - gs_pocket_frame_thk,	0,		unID	:	unID = unID+1
	hotspot PocketWidth + 0.005 + gs_pocket_frame_thk,	gs_pocket_frame_thk,					0,		unID	:	unID = unID+1
	hotspot 0,											gs_pocket_frame_thk,					heightLeaf + 0.005 + gs_pocket_frame_thk,		unID	:	unID = unID+1
	hotspot 0,											- widthWallCut - gs_pocket_frame_thk,	heightLeaf + 0.005 + gs_pocket_frame_thk,		unID	:	unID = unID+1
	hotspot PocketWidth + 0.005 + gs_pocket_frame_thk,	- widthWallCut - gs_pocket_frame_thk,	heightLeaf + 0.005 + gs_pocket_frame_thk,		unID	:	unID = unID+1
	hotspot PocketWidth + 0.005 + gs_pocket_frame_thk,	gs_pocket_frame_thk,					heightLeaf + 0.005 + gs_pocket_frame_thk,		unID	:	unID = unID+1


	num_lath = INT((heightLeaf) / 0.5) - 1
	dist_lath = (heightLeaf - 0.04) / (num_lath+1)

	lath_lgth_modif = 0
	if not(gs_pocket_door_frame) then lath_lgth_modif = 0.04

	addz 0.02

	for ij = 1 to num_lath+2
		addz -0.02
		prism_	4, 0.04,
			lath_lgth_modif,							gs_pocket_frame_thk,					15,
			lath_lgth_modif,							0,										15,
			PocketWidth + 0.005 + gs_pocket_frame_thk,	0,										15,
			PocketWidth + 0.005 + gs_pocket_frame_thk,	gs_pocket_frame_thk,					15

		prism_	4, 0.04,
			lath_lgth_modif,							- widthWallCut,							15,
			lath_lgth_modif,							- widthWallCut - gs_pocket_frame_thk,	15,
			PocketWidth + 0.005 + gs_pocket_frame_thk,	- widthWallCut - gs_pocket_frame_thk,	15,
			PocketWidth + 0.005 + gs_pocket_frame_thk,	- widthWallCut,							15

		del 1
		addz dist_lath
	next ij
	del num_lath+2+1

	prism_	4, heightLeaf,
		PocketWidth + 0.005,						0,				15,
		PocketWidth + 0.005,						- widthWallCut,	15,
		PocketWidth + 0.005 + gs_pocket_frame_thk,	- widthWallCut,	15,
		PocketWidth + 0.005 + gs_pocket_frame_thk,	0,				15

	if not(gs_pocket_door_frame) then
		prism_	4, heightLeaf,
			lath_lgth_modif,	gs_pocket_frame_thk,	15,
			lath_lgth_modif,	0,						15,
			0,					0,						15,
			0,					gs_pocket_frame_thk,	15

		prism_	4, heightLeaf,
			lath_lgth_modif,	- widthWallCut - gs_pocket_frame_thk,	15,
			lath_lgth_modif,	- widthWallCut,							15,
			0,					- widthWallCut,							15,
			0,					- widthWallCut - gs_pocket_frame_thk,	15
	endif

	del 1

	addz -gs_pocket_frame_thk
	wallniche 5, 1, 1,
		0, 0, 1, widthWallCut + 2 * gs_pocket_frame_thk,
		PocketWidth + 0.005 + gs_pocket_frame_thk,	0,			31,
		0,											0,			31,
		0,											heightLeaf, 31,
		PocketWidth + 0.005 + gs_pocket_frame_thk,	heightLeaf, 31,
		PocketWidth + 0.005 + gs_pocket_frame_thk,	0,			-1
	del 1
else
	wallniche 5, 1, 1,
		0, 0, 1, widthWallCut,
		PocketWidth + 0.005,	0, 15+16,
		0,						0, 15+16,
		0,						heightLeaf, 15+16,
		PocketWidth + 0.005,	heightLeaf, 15+16,
		PocketWidth + 0.005,	0, -1
endif



del 1

return


500:

!********************** texture coordination, vertical

vert 0, 0, 0
vert 0, 1, 0
vert 1, 0, 0
vert 0, 0, 1
coor 2, -1, -2, -3, -4
body 1

base

return



600:

!********************** texture coordination, horozintal

rotz 90
vert 0, 0, 0
vert 0, 1, 0
vert 1, 0, 0
vert 0, 0, 1
coor 2, -1, -2, -3, -4
body 1
del 1

base

return

! ------------------------------------------------------------------------------
"Egress Metal Profile":
! ------------------------------------------------------------------------------

	put 	 gs_rebate_width - framex,				 gs_unit_extra_thk,						0,	15,					gs_frame_mat,
			 gs_rebate_width,						 gs_unit_extra_thk,						0,	15,					gs_frame_mat,
			 gs_rebate_width,						-gs_frame_thk + posLeafy + gs_leaf_thk,	0,	15,					gs_frame_mat,
			-gs_rebate_width * drawUpper,			-gs_frame_thk + posLeafy + gs_leaf_thk,	0,	15,					gs_frame_mat,
			-gs_rebate_width * drawUpper,			-gs_frame_thk + posLeafy,				0,	15,					gs_frame_mat,
			-gs_rebate_width,						-gs_frame_thk + posLeafy,				0,	15 - 2 * drawUpper,	gs_frame_mat,
			-gs_rebate_width,						-gs_frame_thk-gs_unit_extra_thk,		0,	15,					gs_frame_mat,
			 gs_rebate_width - framex,				-gs_frame_thk-gs_unit_extra_thk,		0,	15,					gs_frame_mat,
			 gs_rebate_width - framex,				-gs_frame_thk,							0,	15,					gs_frame_mat,
			 gs_rebate_width - framex - tolerancex,	-gs_frame_thk,							0,	15,					gs_frame_mat,
			 gs_rebate_width - framex - tolerancex,	 0,										0,	15,					gs_frame_mat,
			 gs_rebate_width - framex,				 0,										0,	15,					gs_frame_mat,
			 gs_rebate_width - framex,				 gs_unit_extra_thk,						0,	-1,					gs_frame_mat

	cprism_{2} gs_frame_mat, gs_frame_mat, gs_frame_mat, nsp/5,
		lengthx,
		get(nsp)

	body -1

return


! ------------------------------------------------------------------------------
"Pocket Door Cutting":
! ------------------------------------------------------------------------------

	if bDoubleDoor then
		addz posLeafy + widthWallCut/2
		cutStatus = 2+8+16	! Infinite
	else
		add -A/2+gs_frw1, 0, posLeafy + widthWallCut/2
		cutStatus = 2+16	! Semi Infinite
	endif

	roty 90
	if n = 1 then
		cutform 5, 1, cutStatus,
			 0, 0, -1, 0,
			 widthWallCut/2, 0,			15+16+32,
			 widthWallCut/2, cutHeight,	15+16+32,
			-widthWallCut/2, cutHeight,	15+16+32,
			-widthWallCut/2, 0,			15+16+32,
			 widthWallCut/2, 0,			-1
	else
		addx (i = 2) * FrameThickOffset
		material matLeafRange_Leaf
		cutform 5, 1, cutStatus,
			0, 0, -1, 0,
			widthWallCut/2, 0,			15+16+32,
			widthWallCut/2, cutHeight,	15+16+32,
			0, 				cutHeight,	15+16+32,
			0, 				0,			15+16+32,
			widthWallCut/2, 0,			-1

		material matSashRange_Leaf
		cutform 5, 1, cutStatus,
			 0, 0, -1, 0,
			 0,					0,			15+16+32,
			 0,					cutHeight,	15+16+32,
			-widthWallCut/2,	cutHeight,	15+16+32,
			-widthWallCut/2,	0,			15+16+32,
			 0,					0,			-1
		del 1
	endif
	del 2
return


! ------------------------------------------------------------------------------
"Rectangular Rebate Cutting":
! ------------------------------------------------------------------------------

	if not(bUniformMaterials) | (not(bNoRebate_i) & not(bSimpleOrCHIModel)) then
		bDoubleCut = (bNoRebate_i | bSimpleOrCHIModel)
		if bSimpleOrCHIModel then
			if iMullionStyle_i = MULLION_SOLID_PANEL then
				cutDepth = gs_sash_thk
			else
				cutDepth = (insideFrameThk + gs_glass_thk) / 2
			endif
			rebateWidth = offsetEPS
		else
			if gs_optype_m_i = SASH_FIXED then
				cutDepth = gs_sidelight_rebate_depth + gs_glass_thk / 2
				rebateWidth = offsetEPS
			else
				if bNoRebate_i then
					cutDepth = min(gs_sash_thk, gs_frame_thk / 2)
					rebateWidth = offsetEPS
				else
					cutDepth = gs_sidelight_rebate_depth
					rebateWidth = gs_sidelight_rebate_width
					if rebateWidth < EPS then cutDepth = 0
				endif
			endif
		endif

		if cutDepth > EPS then
			addz -cutDepth
			if iSimpleSashFrameType_i = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_i = SIMPLESASH_SIDEHUNG then
				SashLeftX	= rebateCutShapeLeftPX
				SashRightX	= rebateCutShapeRightPX

				simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2
				if iSimpleSashFrameType_i = SIMPLESASH_SLIDEHOR then
					dx = sashWidthToRebateCut/2
				else
					dx = sashWidthToRebateCut
				endif

				material matSashRebate
				cutform 4, 1, 2 + 16,
					0, 0, -1, 0,
					rebateCutShapeRightPX + rebateWidth, rebateCutShapeTopPY + rebateWidth, 15+16+32,
					rebateCutShapeRightPX + rebateWidth, rebateCutShapeBottomPY - rebateWidth, 15+16+32,
					simpleSashDivx+dx, rebateCutShapeBottomPY - rebateWidth, 15+16+32,
					simpleSashDivx+dx, rebateCutShapeTopPY + rebateWidth, 15+16+32

				cutform 4, 1, 2 + 16,
					0, 0, -1, 0,
					simpleSashDivx-dx, rebateCutShapeTopPY + rebateWidth, 15+16+32,
					simpleSashDivx-dx, rebateCutShapeBottomPY - rebateWidth, 15+16+32,
					rebateCutShapeLeftPX - rebateWidth, rebateCutShapeBottomPY - rebateWidth, 15+16+32,
					rebateCutShapeLeftPX - rebateWidth, rebateCutShapeTopPY + rebateWidth, 15+16+32

				if bDoubleCut then
					material matSashOpposite
					cutform 4, 1, 2 + 16,
						0, 0, 1, 0,
						rebateCutShapeRightPX + rebateWidth, rebateCutShapeTopPY + rebateWidth, 15+16+32,
						rebateCutShapeRightPX + rebateWidth, rebateCutShapeBottomPY - rebateWidth, 15+16+32,
						simpleSashDivx+dx, rebateCutShapeBottomPY - rebateWidth, 15+16+32,
						simpleSashDivx+dx, rebateCutShapeTopPY + rebateWidth, 15+16+32

					cutform 4, 1, 2 + 16,
						0, 0, 1, 0,
						simpleSashDivx-dx, rebateCutShapeTopPY + rebateWidth, 15+16+32,
						simpleSashDivx-dx, rebateCutShapeBottomPY - rebateWidth, 15+16+32,
						rebateCutShapeLeftPX - rebateWidth, rebateCutShapeBottomPY - rebateWidth, 15+16+32,
						rebateCutShapeLeftPX - rebateWidth, rebateCutShapeTopPY + rebateWidth, 15+16+32
				endif
				numCuts = numCuts + 2 + 2*bDoubleCut
			else
				if iSimpleSashFrameType_i = SIMPLESASH_SLIDEVER then
					SashTopY	= rebateCutShapeTopPY
					SashBottomY = rebateCutShapeBottomPY

					simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2

					material matSashRebate
					cutform 4, 1, 2 + 16,
						0, 0, -1, 0,
						rebateCutShapeRightPX + rebateWidth, simpleSashDivy - sashWidthToRebateCut/2, 15+16+32,
						rebateCutShapeRightPX + rebateWidth, rebateCutShapeBottomPY - rebateWidth, 15+16+32,
						rebateCutShapeLeftPX - rebateWidth, rebateCutShapeBottomPY - rebateWidth, 15+16+32,
						rebateCutShapeLeftPX - rebateWidth, simpleSashDivy - sashWidthToRebateCut/2, 15+16+32

					cutform 4, 1, 2 + 16,
						0, 0, -1, 0,
						rebateCutShapeRightPX + rebateWidth, rebateCutShapeTopPY + rebateWidth, 15+16+32,
						rebateCutShapeRightPX + rebateWidth, simpleSashDivy + sashWidthToRebateCut/2, 15+16+32,
						rebateCutShapeLeftPX - rebateWidth, simpleSashDivy + sashWidthToRebateCut/2, 15+16+32,
						rebateCutShapeLeftPX - rebateWidth, rebateCutShapeTopPY + rebateWidth, 15+16+32

					if bDoubleCut then
						material matSashOpposite
						cutform 4, 1, 2 + 16,
							0, 0, 1, 0,
							rebateCutShapeRightPX + rebateWidth, simpleSashDivy - sashWidthToRebateCut/2, 15+16+32,
							rebateCutShapeRightPX + rebateWidth, rebateCutShapeBottomPY - rebateWidth, 15+16+32,
							rebateCutShapeLeftPX - rebateWidth, rebateCutShapeBottomPY - rebateWidth, 15+16+32,
							rebateCutShapeLeftPX - rebateWidth, simpleSashDivy - sashWidthToRebateCut/2, 15+16+32

						cutform 4, 1, 2 + 16,
							0, 0, 1, 0,
							rebateCutShapeRightPX + rebateWidth, rebateCutShapeTopPY + rebateWidth, 15+16+32,
							rebateCutShapeRightPX + rebateWidth, simpleSashDivy + sashWidthToRebateCut/2, 15+16+32,
							rebateCutShapeLeftPX - rebateWidth, simpleSashDivy + sashWidthToRebateCut/2, 15+16+32,
							rebateCutShapeLeftPX - rebateWidth, rebateCutShapeTopPY + rebateWidth, 15+16+32
					endif
					numCuts = numCuts + 2 + 2*bDoubleCut
				else
					material matSashRebate
					cutform 4, 1, 2 + 16,
						0, 0, -1, 0,
						rebateCutShapeRightPX + rebateWidth, rebateCutShapeTopPY + rebateWidth, 15+16+32,
						rebateCutShapeRightPX + rebateWidth, rebateCutShapeBottomPY - rebateWidth, 15+16+32,
						rebateCutShapeLeftPX - rebateWidth, rebateCutShapeBottomPY - rebateWidth, 15+16+32,
						rebateCutShapeLeftPX - rebateWidth, rebateCutShapeTopPY + rebateWidth, 15+16+32
					if bDoubleCut then
						material matSashOpposite
						cutform 4, 1, 2 + 16,
							0, 0, 1, 0,
							rebateCutShapeRightPX + rebateWidth, rebateCutShapeTopPY + rebateWidth, 15+16+32,
							rebateCutShapeRightPX + rebateWidth, rebateCutShapeBottomPY - rebateWidth, 15+16+32,
							rebateCutShapeLeftPX - rebateWidth, rebateCutShapeBottomPY - rebateWidth, 15+16+32,
							rebateCutShapeLeftPX - rebateWidth, rebateCutShapeTopPY + rebateWidth, 15+16+32
					endif
					numCuts = numCuts + 1 + bDoubleCut
				endif
			endif
			del 1
		endif
	endif
return


! ------------------------------------------------------------------------------
"Extra Frame to Simple Sash":
! ------------------------------------------------------------------------------

	if iSimpleSashFrameType_i = SIMPLESASH_SLIDEHOR | iSimpleSashFrameType_i = SIMPLESASH_SIDEHUNG then
		simpleSashDivx = SashLeftX + (SashRightX - SashLeftX)/2

		simpleSashZ	= SashBottomY
		if iSimpleSashFrameType_i = SIMPLESASH_SLIDEHOR then
			put simpleSashDivx - sashWidth/2 - offsetEPS, simpleSashZ, 0, 10,		matSash,
				simpleSashDivx + sashWidth/2 + offsetEPS, simpleSashZ, 0, mask1,	matSash
		else
			put simpleSashDivx - sashWidth - offsetEPS, simpleSashZ, 0, 10,		matSash,
				simpleSashDivx + sashWidth + offsetEPS, simpleSashZ, 0, mask1,	matSash
		endif

		simpleSashZ	= SashTopY
		if iSimpleSashFrameType_i = SIMPLESASH_SLIDEHOR then
			put simpleSashDivx + sashWidth/2 + offsetEPS, simpleSashZ, 0, 10,		matSash,
				simpleSashDivx - sashWidth/2 - offsetEPS, simpleSashZ, 0, mask1,	matSash
		else
			put simpleSashDivx + sashWidth + offsetEPS, simpleSashZ, 0, 10,		matSash,
				simpleSashDivx - sashWidth - offsetEPS, simpleSashZ, 0, mask1,	matSash
		endif

		cprism_{2} mat1, botmat, matSash,
			nsp/5, framethick2,
			get(nsp)

		gosub 500
	endif

	if iSimpleSashFrameType_i = SIMPLESASH_SLIDEVER then
		simpleSashDivy = SashBottomY + (SashTopY - SashBottomY)/2

		simpleSashX	= SashLeftX
		put simpleSashX, simpleSashDivy + sashWidth/2 + offsetEPS, 0, 10,		matSash,
			simpleSashX, simpleSashDivy - sashWidth/2 - offsetEPS, 0, mask1,	matSash

		simpleSashX	= SashRightX
		put simpleSashX, simpleSashDivy - sashWidth/2 - offsetEPS, 0, 10,		matSash,
			simpleSashX, simpleSashDivy + sashWidth/2 + offsetEPS, 0, mask1,	matSash

		cprism_{2} mat1, botmat, matSash,
			nsp/5, framethick2,
			get(nsp)

		gosub 600
	endif
return

! ------------------------------------------------------------------------------
"Metal Frame Rebate":
! ------------------------------------------------------------------------------
	edgeStatus = 0
	if gs_sidelight_left then
		cutDyBottomLeft = LeftSLParapet + gs_tolerance_low_left_sl - ovhgBottomLeft
	else
		cutDyBottomLeft = -ovhgBottom
	endif
	if gs_sidelight_right then
		cutDyBottomRight = RightSLParapet + gs_tolerance_low_right_sl - ovhgBottomRight
	else
		cutDyBottomRight = -ovhgBottom
	endif

	addz frameRebateOffset
	if bArchedTop then
		if abs(cutDxRight) < EPS  then
			cutform 4, 1, 2,
				 0, 0, 1, outsideFrameThk - 2*frameRebateOffset,
				-A/2,						gs_shoulder_h,		31,
				-A/2 + frameRebateWidth,	gs_shoulder_h,		31,
				-A/2 + frameRebateWidth,	cutDyBottomLeft,	31,
				-A/2,						cutDyBottomLeft,	31

			numCuts = numCuts + 1

			cutform 4, 1, 2,
				 0, 0, 1, outsideFrameThk - 2*frameRebateOffset,
				 A/2,						gs_shoulder_h,		31,
				 A/2 - frameRebateWidth,	gs_shoulder_h,		31,
				 A/2 - frameRebateWidth,	cutDyBottomRight,	31,
				 A/2,						cutDyBottomRight,	31

			numCuts = numCuts + 1

			cutform 7, 1, 2,
				 0, 0, 1, outsideFrameThk - 2*frameRebateOffset,
				-A/2,						gs_shoulder_h,							31,
				0,							frametop - r2,							900,
				0,							b + cutDy,								3031,
				A/2,						gs_shoulder_h,							3031,
				A/2 - frameRebateWidth,		gs_shoulder_h - (fce-fce_frame_rebate),	31+64,
				0,							B - frameRebateWidth,					3031+64,
				-A/2 + frameRebateWidth,	gs_shoulder_h-(fce-fce_frame_rebate),	3031

			numCuts = numCuts + 1
		else
			plane_ 4,
				-A/2 + frameRebateWidth, gs_shoulder_h-(fce-fce_frame_rebate),												0,							edgeStatus,
				-A/2 + frameRebateWidth, cutDyBottomLeft + frameRebateWidth*(gs_sidelight_left & (LeftSLParapet > EPS)),	0,							edgeStatus,
				-A/2 + frameRebateWidth, cutDyBottomLeft + frameRebateWidth*(gs_sidelight_left & (LeftSLParapet > EPS)),	outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				-A/2 + frameRebateWidth, gs_shoulder_h-(fce-fce_frame_rebate),												outsideFrameThk - 2*frameRebateOffset,	edgeStatus

			plane_ 4,
				-A/2 + frameRebateWidth,	gs_shoulder_h-(fce-fce_frame_rebate),											0,	edgeStatus,
				-A/2 + frameRebateWidth,	cutDyBottomLeft + frameRebateWidth*(gs_sidelight_left & (LeftSLParapet > EPS)),	0,	edgeStatus,
				-A/2,						cutDyBottomLeft,																0,	edgeStatus,
				-A/2,						gs_shoulder_h-(fce-fce_frame_toler),											0,	edgeStatus

			plane_ 4,
				-A/2,	gs_shoulder_h-(fce-fce_frame_toler),		0,					edgeStatus,
				-A/2,	cutDyBottomLeft,							0,					edgeStatus,
				-A/2,	cutDyBottomLeft,							-frameRebateOffset,	edgeStatus,
				-A/2,	gs_shoulder_h-(fce-fce_frame_toler),		-frameRebateOffset,	edgeStatus

			plane_ 4,
				-A/2 + frameRebateWidth,	gs_shoulder_h-(fce-fce_frame_rebate),											outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				-A/2 + frameRebateWidth,	cutDyBottomLeft + frameRebateWidth*(gs_sidelight_left & (LeftSLParapet > EPS)),	outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				-A/2,						cutDyBottomLeft,																outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				-A/2,						gs_shoulder_h-(fce-fce_frame_toler),											outsideFrameThk - 2*frameRebateOffset,	edgeStatus

			plane_ 4,
				-A/2,	gs_shoulder_h-(fce-fce_frame_toler),	outsideFrameThk - frameRebateOffset,	edgeStatus,
				-A/2,	cutDyBottomLeft,						outsideFrameThk - frameRebateOffset,	edgeStatus,
				-A/2,	cutDyBottomLeft,						outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				-A/2,	gs_shoulder_h-(fce-fce_frame_toler),	outsideFrameThk - 2*frameRebateOffset,	edgeStatus


			plane_ 4,
				A/2 - frameRebateWidth, gs_shoulder_h-(fce-fce_frame_rebate),												0,							edgeStatus,
				A/2 - frameRebateWidth, cutDyBottomRight + frameRebateWidth*(gs_sidelight_right & (RightSLParapet > EPS)),	0,							edgeStatus,
				A/2 - frameRebateWidth, cutDyBottomRight + frameRebateWidth*(gs_sidelight_right & (RightSLParapet > EPS)),	outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				A/2 - frameRebateWidth, gs_shoulder_h-(fce-fce_frame_rebate),												outsideFrameThk - 2*frameRebateOffset,	edgeStatus

			plane_ 4,
				A/2 - frameRebateWidth,	gs_shoulder_h-(fce-fce_frame_rebate),												0,	edgeStatus,
				A/2 - frameRebateWidth,	cutDyBottomRight + frameRebateWidth*(gs_sidelight_right & (RightSLParapet > EPS)),	0,	edgeStatus,
				A/2,					cutDyBottomRight,																	0,	edgeStatus,
				A/2,					gs_shoulder_h-(fce-fce_frame_toler),												0,	edgeStatus

			plane_ 4,
				A/2,	gs_shoulder_h-(fce-fce_frame_toler),	0,					edgeStatus,
				A/2,	cutDyBottomRight,						0,					edgeStatus,
				A/2,	cutDyBottomRight,						-frameRebateOffset,	edgeStatus,
				A/2,	gs_shoulder_h-(fce-fce_frame_toler),	-frameRebateOffset,	edgeStatus

			plane_ 4,
				A/2 - frameRebateWidth,	gs_shoulder_h-(fce-fce_frame_rebate),												outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				A/2 - frameRebateWidth,	cutDyBottomRight + frameRebateWidth*(gs_sidelight_right & (RightSLParapet > EPS)),	outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				A/2,					cutDyBottomRight,																	outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				A/2,					gs_shoulder_h-(fce-fce_frame_toler),												outsideFrameThk - 2*frameRebateOffset,	edgeStatus

			plane_ 4,
				A/2,	gs_shoulder_h-(fce-fce_frame_toler),	outsideFrameThk - frameRebateOffset,	edgeStatus,
				A/2,	cutDyBottomRight,						outsideFrameThk - frameRebateOffset,	edgeStatus,
				A/2,	cutDyBottomRight,						outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				A/2,	gs_shoulder_h-(fce-fce_frame_toler),	outsideFrameThk - 2*frameRebateOffset,	edgeStatus


			extrude 4, 0, 0, outsideFrameThk - 2*frameRebateOffset, (16+32)*edgeStatus,
				0,							frametop - r2,							900,
				A/2 - frameRebateWidth,		gs_shoulder_h - (fce-fce_frame_rebate),	1,
				0,							B - frameRebateWidth,					3001,
				-A/2 + frameRebateWidth,	gs_shoulder_h - (fce-fce_frame_rebate),	3001

			extrude 4, 0, 0, -frameRebateOffset, (16+32)*edgeStatus,
				0,		frametop - r2,							900,
				A/2,	gs_shoulder_h - (fce-fce_frame_toler),	1,
				0,		B ,										3001,
				-A/2,	gs_shoulder_h - (fce-fce_frame_toler),	3001

			poly_ 7,
				-A/2,						gs_shoulder_h - (fce-fce_frame_toler),	edgeStatus,
				0,							frametop - r2,							900,
				0,							b + cutDy,								3000 + edgeStatus,
				A/2,						gs_shoulder_h - (fce-fce_frame_toler),	3000 + edgeStatus,
				A/2 - frameRebateWidth,		gs_shoulder_h - (fce-fce_frame_rebate),	edgeStatus,
				0,							B - frameRebateWidth,					3000 + edgeStatus,
				-A/2 + frameRebateWidth,	gs_shoulder_h - (fce-fce_frame_rebate),	3000 + edgeStatus

			addz outsideFrameThk - 2*frameRebateOffset
			extrude 4, 0, 0, frameRebateOffset, (16+32)*edgeStatus,
				0,		frametop - r2,							900,
				A/2,	gs_shoulder_h - (fce-fce_frame_toler),	1,
				0,		B,										3001,
				-A/2,	gs_shoulder_h - (fce-fce_frame_toler),	3001

			poly_ 7,
				-A/2,						gs_shoulder_h - (fce-fce_frame_toler),	edgeStatus,
				0,							frametop - r2,							900,
				0,							b + cutDy,								3000 + edgeStatus,
				A/2,						gs_shoulder_h - (fce-fce_frame_toler),	3000 + edgeStatus,
				A/2 - frameRebateWidth,		gs_shoulder_h - (fce-fce_frame_rebate),	edgeStatus,
				0,							B - frameRebateWidth,					3000 + edgeStatus,
				-A/2 + frameRebateWidth,	gs_shoulder_h - (fce-fce_frame_rebate),	3000 + edgeStatus
			del 1
		endif
	else
		if abs(cutDxLeft) < EPS then
			cutform 4, 1, 2,
				 0, 0, 1, outsideFrameThk - 2*frameRebateOffset,
				-A/2,						B + cutDy,			31,
				-A/2 + frameRebateWidth,	B + cutDy,			31,
				-A/2 + frameRebateWidth,	cutDyBottomLeft,	31,
				-A/2,						cutDyBottomLeft,	31

			numCuts = numCuts + 1
		else
			plane_ 4,
				-A/2 + frameRebateWidth, B - frameRebateWidth,																0,							edgeStatus,
				-A/2 + frameRebateWidth, cutDyBottomLeft + frameRebateWidth*(gs_sidelight_left & (LeftSLParapet > EPS)),	0,							edgeStatus,
				-A/2 + frameRebateWidth, cutDyBottomLeft + frameRebateWidth*(gs_sidelight_left & (LeftSLParapet > EPS)),	outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				-A/2 + frameRebateWidth, B - frameRebateWidth,																outsideFrameThk - 2*frameRebateOffset,	edgeStatus

			plane_ 4,
				-A/2 + frameRebateWidth,	B - frameRebateWidth,															0,	edgeStatus,
				-A/2 + frameRebateWidth,	cutDyBottomLeft + frameRebateWidth*(gs_sidelight_left & (LeftSLParapet > EPS)),	0,	edgeStatus,
				-A/2,						cutDyBottomLeft,																0,	edgeStatus,
				-A/2,						B,																				0,	edgeStatus

			plane_ 4,
				-A/2,	B,					0,					edgeStatus,
				-A/2,	cutDyBottomLeft,	0,					edgeStatus,
				-A/2,	cutDyBottomLeft,	-frameRebateOffset,	edgeStatus,
				-A/2,	B,					-frameRebateOffset,	edgeStatus

			plane_ 4,
				-A/2 + frameRebateWidth,	B - frameRebateWidth,															outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				-A/2 + frameRebateWidth,	cutDyBottomLeft + frameRebateWidth*(gs_sidelight_left & (LeftSLParapet > EPS)),	outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				-A/2,						cutDyBottomLeft,																outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				-A/2,						B,																				outsideFrameThk - 2*frameRebateOffset,	edgeStatus

			plane_ 4,
				-A/2,	B,					outsideFrameThk - frameRebateOffset,	edgeStatus,
				-A/2,	cutDyBottomLeft,	outsideFrameThk - frameRebateOffset,	edgeStatus,
				-A/2,	cutDyBottomLeft,	outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				-A/2,	B,					outsideFrameThk - 2*frameRebateOffset,	edgeStatus
		endif

		if abs(cutDxRight) < EPS  then
			cutform 4, 1, 2,
				 0, 0, 1, outsideFrameThk - 2*frameRebateOffset,
				 A/2,						B + cutDy,			31,
				 A/2 - frameRebateWidth,	B + cutDy,			31,
				 A/2 - frameRebateWidth,	cutDyBottomRight,	31,
				 A/2,						cutDyBottomRight,	31

			numCuts = numCuts + 1
		else
			plane_ 4,
				A/2 - frameRebateWidth, B - frameRebateWidth,																0,							edgeStatus,
				A/2 - frameRebateWidth, cutDyBottomRight + frameRebateWidth*(gs_sidelight_right & (RightSLParapet > EPS)),	0,							edgeStatus,
				A/2 - frameRebateWidth, cutDyBottomRight + frameRebateWidth*(gs_sidelight_right & (RightSLParapet > EPS)),	outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				A/2 - frameRebateWidth, B - frameRebateWidth,																outsideFrameThk - 2*frameRebateOffset,	edgeStatus

			plane_ 4,
				A/2 - frameRebateWidth,	B - frameRebateWidth,																0,	edgeStatus,
				A/2 - frameRebateWidth,	cutDyBottomRight + frameRebateWidth*(gs_sidelight_right & (RightSLParapet > EPS)),	0,	edgeStatus,
				A/2,					cutDyBottomRight,																	0,	edgeStatus,
				A/2,					B,																					0,	edgeStatus

			plane_ 4,
				A/2,	B,					0,					edgeStatus,
				A/2,	cutDyBottomRight,	0,					edgeStatus,
				A/2,	cutDyBottomRight,	-frameRebateOffset,	edgeStatus,
				A/2,	B,					-frameRebateOffset,	edgeStatus

			plane_ 4,
				A/2 - frameRebateWidth,	B - frameRebateWidth,																outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				A/2 - frameRebateWidth,	cutDyBottomRight + frameRebateWidth*(gs_sidelight_right & (RightSLParapet > EPS)),	outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				A/2,					cutDyBottomRight,																	outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				A/2,					B,																					outsideFrameThk - 2*frameRebateOffset,	edgeStatus

			plane_ 4,
				A/2,	B,					outsideFrameThk - frameRebateOffset,	edgeStatus,
				A/2,	cutDyBottomRight,	outsideFrameThk - frameRebateOffset,	edgeStatus,
				A/2,	cutDyBottomRight,	outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				A/2,	B,					outsideFrameThk - 2*frameRebateOffset,	edgeStatus
		endif

		if abs(cutDy) < EPS then
			cutform 4, 1, 2,
				 0, 0, 1, outsideFrameThk - 2*frameRebateOffset,
				-A/2 - cutDxLeft,	B,						31,
				 A/2 + cutDxRight,	B,						31,
				 A/2 + cutDxRight,	B - frameRebateWidth,	31,
				-A/2 - cutDxLeft,	B - frameRebateWidth,	31

			numCuts = numCuts + 1
		else
			plane_ 4,
				-A/2 + frameRebateWidth, B - frameRebateWidth, 0,										edgeStatus,
				 A/2 - frameRebateWidth, B - frameRebateWidth, 0,										edgeStatus,
				 A/2 - frameRebateWidth, B - frameRebateWidth, outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				-A/2 + frameRebateWidth, B - frameRebateWidth, outsideFrameThk - 2*frameRebateOffset,	edgeStatus

			plane_ 4,
				-A/2,						B, 						0,	edgeStatus,
				 A/2,						B, 						0,	edgeStatus,
				 A/2 - frameRebateWidth,	B - frameRebateWidth,	0,	edgeStatus,
				-A/2 + frameRebateWidth,	B - frameRebateWidth,	0,	edgeStatus

			plane_ 4,
				-A/2,	B,	0,					edgeStatus,
				 A/2,	B,	0,					edgeStatus,
				 A/2,	B,	-frameRebateOffset,	edgeStatus,
				-A/2,	B,	-frameRebateOffset,	edgeStatus

			plane_ 4,
				-A/2,						B, 						outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				 A/2,						B, 						outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				 A/2 - frameRebateWidth,	B - frameRebateWidth,	outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				-A/2 + frameRebateWidth,	B - frameRebateWidth,	outsideFrameThk - 2*frameRebateOffset,	edgeStatus

			plane_ 4,
				-A/2,	B, 	outsideFrameThk - frameRebateOffset,	edgeStatus,
				 A/2,	B, 	outsideFrameThk - frameRebateOffset,	edgeStatus,
				 A/2,	B,	outsideFrameThk - 2*frameRebateOffset,	edgeStatus,
				-A/2,	B,	outsideFrameThk - 2*frameRebateOffset,	edgeStatus
		endif
	endif

	if gs_sidelight_left then
		if (LeftSLParapet > EPS) | gs_frame_style_m = FRAME_STYLE_EXTRUSION then
			if abs(gs_tolerance_low_left_sl + ovhgBottomLeft) < EPS then
				cutform 4, 1, 2,
					 0, 0, 1, insideFrameThk - 2*frameRebateOffset,
					-A/2 - cutDxLeft,																									LeftSLParapet,			31,
					-A/2 + gs_sl_w1 - (gs_frw_SlParapet_left + gs_tolerance_left_2) + frameRebateWidth*(abs(gs_tolerance_left_2) < EPS),	LeftSLParapet,			31,
					-A/2 + gs_sl_w1 - (gs_frw_SlParapet_left + gs_tolerance_left_2) + frameRebateWidth*(abs(gs_tolerance_left_2) < EPS),	LeftSLParapet + frameRebateWidth,	31,
					-A/2 - cutDxLeft,																									LeftSLParapet + frameRebateWidth,	31

				numCuts = numCuts + 1
			else
				plane_ 4,
					-A/2 + frameRebateWidth,									LeftSLParapet + gs_tolerance_low_left_sl + frameRebateWidth,	0,						edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left + frameRebateWidth,	LeftSLParapet + gs_tolerance_low_left_sl + frameRebateWidth,	0,						edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left + frameRebateWidth,	LeftSLParapet + gs_tolerance_low_left_sl + frameRebateWidth,	insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					-A/2 + frameRebateWidth,									LeftSLParapet + gs_tolerance_low_left_sl + frameRebateWidth,	insideFrameThk - 2*frameRebateOffset,	edgeStatus

				plane_ 4,
					-A/2 + frameRebateWidth,									LeftSLParapet + gs_tolerance_low_left_sl + frameRebateWidth,	0,	edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left + frameRebateWidth,	LeftSLParapet + gs_tolerance_low_left_sl + frameRebateWidth,	0,	edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left,					LeftSLParapet + gs_tolerance_low_left_sl,					0,	edgeStatus,
					-A/2,														LeftSLParapet + gs_tolerance_low_left_sl,					0,	edgeStatus

				plane_ 4,
					-A/2,										LeftSLParapet + gs_tolerance_low_left_sl,	0,					edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left,	LeftSLParapet + gs_tolerance_low_left_sl,	0,					edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left,	LeftSLParapet + gs_tolerance_low_left_sl,	-frameRebateOffset,	edgeStatus,
					-A/2,										LeftSLParapet + gs_tolerance_low_left_sl,	-frameRebateOffset,	edgeStatus

				plane_ 4,
					-A/2 + frameRebateWidth,									LeftSLParapet + gs_tolerance_low_left_sl + frameRebateWidth,	insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left + frameRebateWidth,	LeftSLParapet + gs_tolerance_low_left_sl + frameRebateWidth,	insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left,					LeftSLParapet + gs_tolerance_low_left_sl,					insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					-A/2,														LeftSLParapet + gs_tolerance_low_left_sl,					insideFrameThk - 2*frameRebateOffset,	edgeStatus

				plane_ 4,
					-A/2,										LeftSLParapet + gs_tolerance_low_left_sl,	insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left,	LeftSLParapet + gs_tolerance_low_left_sl,	insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left,	LeftSLParapet + gs_tolerance_low_left_sl,	insideFrameThk - frameRebateOffset,		edgeStatus,
					-A/2,										LeftSLParapet + gs_tolerance_low_left_sl,	insideFrameThk - frameRebateOffset,		edgeStatus
			endif
		endif

		if (LeftSLParapet > EPS) then
			if abs(gs_tolerance_left_2) < EPS then
				cutform 4, 1, 2,
					 0, 0, 1, insideFrameThk - 2*frameRebateOffset,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left,					LeftSLParapet - ovhgBottomLeft,	31,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left + frameRebateWidth,	LeftSLParapet - ovhgBottomLeft,	31,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left + frameRebateWidth,	-ovhgBottom,					31,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left,					-ovhgBottom,					31

				numCuts = numCuts + 1
			else
				plane_ 4,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left + frameRebateWidth,	-ovhgBottom,												0,						edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left + frameRebateWidth,	LeftSLParapet + gs_tolerance_low_left_sl + frameRebateWidth,	0,						edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left + frameRebateWidth,	LeftSLParapet + gs_tolerance_low_left_sl + frameRebateWidth,	insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left + frameRebateWidth,	-ovhgBottom,												insideFrameThk - 2*frameRebateOffset,	edgeStatus

				plane_ 4,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left,					-ovhgBottom,												0,	edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left,					LeftSLParapet + gs_tolerance_low_left_sl,					0,	edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left + frameRebateWidth,	LeftSLParapet + gs_tolerance_low_left_sl + frameRebateWidth,	0,	edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left + frameRebateWidth,	-ovhgBottom,												0,	edgeStatus

				plane_ 4,
					-A/2 + gs_sl_w1 - gs_frw_SlParapetSl_left,	-ovhgBottom,								0,					edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left,	LeftSLParapet + gs_tolerance_low_left_sl,	0,					edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left,	LeftSLParapet + gs_tolerance_low_left_sl,	-frameRebateOffset,	edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left,	-ovhgBottom,								-frameRebateOffset,	edgeStatus

				plane_ 4,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left,					-ovhgBottom,												insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left,					LeftSLParapet + gs_tolerance_low_left_sl,					insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left + frameRebateWidth,	LeftSLParapet + gs_tolerance_low_left_sl + frameRebateWidth,	insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left + frameRebateWidth,	-ovhgBottom,												insideFrameThk - 2*frameRebateOffset,	edgeStatus

				plane_ 4,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left,	-ovhgBottom,								insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left,	LeftSLParapet + gs_tolerance_low_left_sl,	insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left,	LeftSLParapet + gs_tolerance_low_left_sl,	insideFrameThk - frameRebateOffset,		edgeStatus,
					-A/2 + gs_sl_w1 - gs_frw_SlParapet_left,	-ovhgBottom,								insideFrameThk - frameRebateOffset,		edgeStatus
			endif
		endif
	endif

	if gs_sidelight_right then
		if (RightSLParapet > EPS) | gs_frame_style_m = FRAME_STYLE_EXTRUSION then
			if abs(gs_tolerance_low_right_sl + ovhgBottomRight) < EPS then
				cutform 4, 1, 2,
					 0, 0, 1, insideFrameThk - 2*frameRebateOffset,
					 A/2 + cutDxRight,																										RightSLParapet,			31,
					 A/2 - gs_sl_w2 + (gs_frw_SlParapet_right + gs_tolerance_right_2) - frameRebateWidth*(abs(gs_tolerance_right_2) < EPS),	RightSLParapet,			31,
					 A/2 - gs_sl_w2 + (gs_frw_SlParapet_right + gs_tolerance_right_2) - frameRebateWidth*(abs(gs_tolerance_right_2) < EPS),	RightSLParapet + frameRebateWidth,	31,
					 A/2 + cutDxRight,																										RightSLParapet + frameRebateWidth,	31

				numCuts = numCuts + 1
			else
				plane_ 4,
					A/2 - frameRebateWidth,										RightSLParapet + gs_tolerance_low_right_sl + frameRebateWidth,	0,						edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right - frameRebateWidth,	RightSLParapet + gs_tolerance_low_right_sl + frameRebateWidth,	0,						edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right - frameRebateWidth,	RightSLParapet + gs_tolerance_low_right_sl + frameRebateWidth,	insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					A/2 - frameRebateWidth,										RightSLParapet + gs_tolerance_low_right_sl + frameRebateWidth,	insideFrameThk - 2*frameRebateOffset,	edgeStatus

				plane_ 4,
					A/2 - frameRebateWidth,										RightSLParapet + gs_tolerance_low_right_sl + frameRebateWidth,	0,	edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right - frameRebateWidth,	RightSLParapet + gs_tolerance_low_right_sl + frameRebateWidth,	0,	edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right,					RightSLParapet + gs_tolerance_low_right_sl,					0,	edgeStatus,
					A/2,														RightSLParapet + gs_tolerance_low_right_sl,					0,	edgeStatus

				plane_ 4,
					A/2,										RightSLParapet + gs_tolerance_low_right_sl,	0,					edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right,	RightSLParapet + gs_tolerance_low_right_sl,	0,					edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right,	RightSLParapet + gs_tolerance_low_right_sl,	-frameRebateOffset,	edgeStatus,
					A/2,										RightSLParapet + gs_tolerance_low_right_sl,	-frameRebateOffset,	edgeStatus

				plane_ 4,
					A/2 - frameRebateWidth,										RightSLParapet + gs_tolerance_low_right_sl + frameRebateWidth,	insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right - frameRebateWidth,	RightSLParapet + gs_tolerance_low_right_sl + frameRebateWidth,	insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right,					RightSLParapet + gs_tolerance_low_right_sl,					insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					A/2,														RightSLParapet + gs_tolerance_low_right_sl,					insideFrameThk - 2*frameRebateOffset,	edgeStatus

				plane_ 4,
					A/2,										RightSLParapet + gs_tolerance_low_right_sl,	insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right,	RightSLParapet + gs_tolerance_low_right_sl,	insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right,	RightSLParapet + gs_tolerance_low_right_sl,	insideFrameThk - frameRebateOffset,		edgeStatus,
					A/2,										RightSLParapet + gs_tolerance_low_right_sl,	insideFrameThk - frameRebateOffset,		edgeStatus
			endif
		endif

		if (RightSLParapet > EPS) then
			if abs(gs_tolerance_right_2) < EPS then
				cutform 4, 1, 2,
					 0, 0, 1, insideFrameThk - 2*frameRebateOffset,
					 A/2 - gs_sl_w2 + gs_frw_SlParapet_right,						RightSLParapet - ovhgBottomRight,	31,
					 A/2 - gs_sl_w2 + gs_frw_SlParapet_right - frameRebateWidth,	RightSLParapet - ovhgBottomRight,	31,
					 A/2 - gs_sl_w2 + gs_frw_SlParapet_right - frameRebateWidth,	-ovhgBottom,						31,
					 A/2 - gs_sl_w2 + gs_frw_SlParapet_right,						-ovhgBottom,						31

				numCuts = numCuts + 1
			else
				plane_ 4,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right - frameRebateWidth,	-ovhgBottom,												0,						edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right - frameRebateWidth,	RightSLParapet + gs_tolerance_low_right_sl + frameRebateWidth,	0,						edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right - frameRebateWidth,	RightSLParapet + gs_tolerance_low_right_sl + frameRebateWidth,	insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right - frameRebateWidth,	-ovhgBottom,												insideFrameThk - 2*frameRebateOffset,	edgeStatus

				plane_ 4,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right,						-ovhgBottom,												0,	edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right,						RightSLParapet + gs_tolerance_low_right_sl,					0,	edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_left - frameRebateWidth,		RightSLParapet + gs_tolerance_low_right_sl + frameRebateWidth,	0,	edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_left - frameRebateWidth,		-ovhgBottom,												0,	edgeStatus

				plane_ 4,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right,	-ovhgBottom,								0,					edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right,	RightSLParapet + gs_tolerance_low_left_sl,	0,					edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right,	RightSLParapet + gs_tolerance_low_left_sl,	-frameRebateOffset,	edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right,	-ovhgBottom,								-frameRebateOffset,	edgeStatus

				plane_ 4,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right,					-ovhgBottom,												insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right,					RightSLParapet + gs_tolerance_low_right_sl,					insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right - frameRebateWidth,	RightSLParapet + gs_tolerance_low_right_sl + frameRebateWidth,	insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right - frameRebateWidth,	-ovhgBottom,												insideFrameThk - 2*frameRebateOffset,	edgeStatus

				plane_ 4,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right,	-ovhgBottom,								insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right,	RightSLParapet + gs_tolerance_low_right_sl,	insideFrameThk - 2*frameRebateOffset,	edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right,	RightSLParapet + gs_tolerance_low_right_sl,	insideFrameThk - frameRebateOffset,		edgeStatus,
					A/2 - gs_sl_w2 + gs_frw_SlParapet_right,	-ovhgBottom,								insideFrameThk - frameRebateOffset,		edgeStatus
			endif
		endif
	endif
	del 1
return
]]>
</Script_3D>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_2D SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[
gs_fgs_fillFr	= gs_fillFr * gs_bFills
if gs_frame_pen_cont <= 0 then
	pen gs_pen_2D
else
	pen gs_frame_pen_cont
endif

drawindex 40

outsideFrameThk	= gs_frame_thk
if gs_frame_wthk then
	if gs_sframe then
		insideFrameThk	= gs_frame_thk
	else
		insideFrameThk	= gs_frame_thkin
	endif
else
	insideFrameThk	= gs_frame_thk
endif


! =============================================================================
! 2D symbol following scale
! =============================================================================

lod2D						= DET2D_FS_OFF
bShowRebateOnFixGlass		= 0
bShowFrameContoursOnBottom	= 0

if iLoD2D = SYMBD_S_1LINE then						lod2D	= DET2D_FS_SIMPLE			! Simple --> INT 200
if iLoD2D = SYMBD_M_1LINELEAF_2LINE then			lod2D	= DET2D_FS_MIDDLE			! Middle --> INT 100
if iLoD2D = SYMBD_M_1LINELEAF_1LINE then			lod2D	= DET2D_FS_MIDDLE			! Middle --> USA Middle
if iLoD2D = SYMBD_M_2LINELEAFCL_GLASS then			lod2D	= DET2D_FS_MIDDLE			! Middle --> NLD 100
if iLoD2D = SYMBD_D_2LINELEAFOP_GLASS then			lod2D	= DET2D_FS_DETAILED			! Detailed --> INT 50
if iLoD2D = SYMBD_D_1LINELEAF_GLASS then			lod2D	= DET2D_FS_DETAILED			! Detailed --> SWE 50
if iLoD2D = SYMBD_D_2LINELEAFCL_REBATEONGLASS then	lod2D	= DET2D_FS_DETAILED			! Detailed --> NLD 50
if iLoD2D = SYMBD_D_2LINELEAFOP_SASH then			lod2D	= DET2D_FS_DETAILED			! Detailed --> USA Detailed
if iLoD2D = SYMBD_D_2LEAFOPGLASS_GLASS then			lod2D	= DET2D_FS_DETAILED			! Detailed --> DAN 20
if iLoD2D = SYMBD_S_2LINE then						lod2D	= DET2D_FS_SIMPLE_CHI		! Chinese Simple
if iLoD2D = SYMBD_D_2LINELEAFOP_2LINE then			lod2D 	= DET2D_FS_DETAILED_CHI		! Chinese Detailed

if iLoD2D = SYMBD_M_2LINELEAFCL_GLASS then												! Middle --> NLD 100
	bShowFrameContoursOnBottom		= 0
endif
if	iLoD2D = SYMBD_D_2LINELEAFCL_REBATEONGLASS then										! Detailed --> NLD 50
	bShowRebateOnFixGlass			= 1
	bShowFrameContoursOnBottom		= 0
endif


bNoRebate_05 = (gs_optype_m_05 = SASH_FIXED * (not(bShowRebateOnFixGlass) | iMullionStyle_05 = MULLION_SOLID_PANEL)	|\
				gs_optype_m_05 = SASH_HOR_PIVOT				|\
				gs_optype_m_05 = SASH_VER_PIVOT				|\
				gs_optype_m_05 = SASH_VER_PIVOT_M			|\
				gs_optype_m_05 = SASH_TILT_SLIDE			|\
				gs_optype_m_05 = SASH_LEFT_SLIDING			|\
				gs_optype_m_05 = SASH_RIGHT_SLIDING			|\
				gs_optype_m_05 = SASH_UP_SLIDING			|\
				gs_optype_m_05 = SASH_DOWN_SLIDING			|\
				gs_optype_m_05 = SASH_VER_PIVOT_M			|\
				gs_optype_m_05 = SASH_FIXED_SLIDE			|\
				gs_optype_m_05 = SASH_SLIDING_HOR			|\
				gs_optype_m_05 = SASH_SLIDING_HOR_M			|\
				gs_optype_m_05 = SASH_DOUBLE_SLIDING_HOR	|\
				gs_optype_m_05 = SASH_DOUBLE_SLIDING_HOR_M	|\
				gs_optype_m_05 = SASH_SLIDING_VER			|\
				gs_optype_m_05 = SASH_DOUBLE_SLIDING_VER)

bNoRebate_09 = (gs_optype_m_09 = SASH_FIXED * (not(bShowRebateOnFixGlass) | iMullionStyle_09 = MULLION_SOLID_PANEL)	|\
				gs_optype_m_09 = SASH_HOR_PIVOT				|\
				gs_optype_m_09 = SASH_VER_PIVOT				|\
				gs_optype_m_09 = SASH_VER_PIVOT_M			|\
				gs_optype_m_09 = SASH_TILT_SLIDE			|\
				gs_optype_m_09 = SASH_LEFT_SLIDING			|\
				gs_optype_m_09 = SASH_RIGHT_SLIDING			|\
				gs_optype_m_09 = SASH_UP_SLIDING			|\
				gs_optype_m_09 = SASH_DOWN_SLIDING			|\
				gs_optype_m_09 = SASH_VER_PIVOT_M			|\
				gs_optype_m_09 = SASH_FIXED_SLIDE			|\
				gs_optype_m_09 = SASH_SLIDING_HOR			|\
				gs_optype_m_09 = SASH_SLIDING_HOR_M			|\
				gs_optype_m_09 = SASH_DOUBLE_SLIDING_HOR	|\
				gs_optype_m_09 = SASH_DOUBLE_SLIDING_HOR_M	|\
				gs_optype_m_09 = SASH_SLIDING_VER			|\
				gs_optype_m_09 = SASH_DOUBLE_SLIDING_VER)

symb_2d = 0
if lod2D = DET2D_FS_SIMPLE | lod2D = DET2D_FS_SIMPLE_CHI then symb_2d = 200
if lod2D = DET2D_FS_MIDDLE | lod2D = DET2D_FS_DETAILED_CHI then symb_2d = 100
if lod2D = DET2D_FS_DETAILED then symb_2d = 50

bFeedBack = (GLOB_CONTEXT > 20 & GLOB_CONTEXT < 40)
if bFeedBack then symb_2d = 200

bListView = (GLOB_CONTEXT = 6 | GLOB_CONTEXT = 46)

if bListView then
	gs_frame_left_endline  = 1
	gs_frame_right_endline = 1
endif

if symb_2d = 200 then
	posLeafy		= posLeafy - gs_pocket_frame * gs_pocket_frame_thk
	widthWallCut	= widthWallCut + 2 * gs_pocket_frame * gs_pocket_frame_thk
endif


if gs_pocket & not(gs_pocket_door_frame) then goto "PlacingPockets"


! =============================================================================
! Coordinates according to size types
! =============================================================================

unitleft = -ac_unit_width / 2
unitright = ac_unit_width / 2

leafleft	= unitleft  + gs_sl_w1 - gs_rebate_width
leafright	= unitright - gs_sl_w2 + gs_rebate_width
egressleft	= unitleft  + gs_sl_w1 + gs_ds_w + gs_sliding_fixpanel_width_left
egressright	= unitright - gs_sl_w2 - gs_ds_w - gs_sliding_fixpanel_width_right

frameleftout	= unitleft  - gs_frame_ovhg_left_out
framerightout	= unitright + gs_frame_ovhg_right_out
frameleftin		= unitleft  - gs_frame_ovhg_left_in
framerightin	= unitright + gs_frame_ovhg_right_in
frameDiff		= (gs_frw1 - gs_frw2) / 2
egressDiff		= (gs_sliding_fixpanel_width_left - gs_sliding_fixpanel_width_right)/2

if gs_pivotdoor then
	egressleft = -ac_unit_width / 2 + gs_frw1 - frameDiff
	egressright = ac_unit_width / 2 - gs_frw2 - gs_pivotOffset - gs_leaf_thk/2 - frameDiff
else
	if	gs_leaf_optype_m = LEAF_1L_POCKET	|\
		gs_leaf_optype_m = LEAF_1L_POCKET_M	|\
		gs_leaf_optype_m = LEAF_2L_POCKET	then
			egressleft = -ac_egress_width / 2 + ((gs_sl_w1 - gs_frw1) / 2)*gs_sidelight_left - ((gs_sl_w2 - gs_frw2) / 2)*gs_sidelight_right + frameDiff
			egressright = ac_egress_width / 2 + ((gs_sl_w1 - gs_frw1) / 2)*gs_sidelight_left - ((gs_sl_w2 - gs_frw2) / 2)*gs_sidelight_right + frameDiff
	endif
endif

egressLeftHotspot = egressleft
egressRightHotspot = egressright

if	gs_usaframe & ( gs_leaf_optype_m = LEAF_1L_POCKET	|\
					gs_leaf_optype_m = LEAF_1L_POCKET_M	|\
					gs_leaf_optype_m = LEAF_2L_POCKET)	then

	egressleft = -ac_egress_width / 2 + frameDiff + egressDiff - gs_sliding_fixpanel_width_left
	egressright = ac_egress_width / 2 + frameDiff + egressDiff + gs_sliding_fixpanel_width_right
endif

if symb_2d=100 then
	egressright	= egressright + gs_ds_w
	egressleft	= egressleft  - gs_ds_w
endif


! =============================================================================
! Hotspots on Unit Size
! =============================================================================

if bShowUnitHotspots then
	unID = 100
	hotspot2 unitleft + gs_frame_oversize,	 comy * (symb_2d <> 200),					unID
	hotspot2 unitright - gs_frame_oversize,	 comy * (symb_2d <> 200),					unID + 1
	hotspot2 unitleft + gs_frame_oversize,	(-gs_frame_thk - comy) * (symb_2d <> 200),	unID + 2
	hotspot2 unitright - gs_frame_oversize,	(-gs_frame_thk - comy) * (symb_2d <> 200),	unID + 3

	if gs_frame_oversize > EPS then
		hotspot2 unitleft,	(comy - frameRebateOffset) * (symb_2d <> 200),					unID + 4
		hotspot2 unitright,	(comy - frameRebateOffset) * (symb_2d <> 200),					unID + 5
		hotspot2 unitleft,	(-gs_frame_thk - comy + frameRebateOffset) * (symb_2d <> 200),	unID + 6
		hotspot2 unitright,	(-gs_frame_thk - comy + frameRebateOffset) * (symb_2d <> 200),	unID + 7
	endif
endif

if not(gs_frame_wthk) then
	gs_frame_thkin2 = gs_frame_thk
else
	if gs_frame_style_m = FRAME_STYLE_METAL | gs_frame_style_m = FRAME_STYLE_BLOCK then
		gs_frame_thkin2 = gs_frame_thk
	else
		gs_frame_thkin2 = gs_frame_thkin
	endif
endif


! =============================================================================
! Hotspots on Egress Size
! =============================================================================

if symb_2d = 200 then
	egressthk1 = 0
	egressthk2 = 0
	egressthk3 = 0
else
	if symb_2d=100 then
		egressthk1=0
		egressthk2=-gs_frame_thk
		egressthk3=-gs_frame_thkin2
	else
		egressthk1 = - gs_leaf_thk * not(gs_usaframe) - (gs_ds_pr * (gs_frame_style_m = FRAME_STYLE_DOUBLE_REBATE | gs_frame_style_m = FRAME_STYLE_METAL) + gs_leaf_thk * (gs_frame_style_m = FRAME_STYLE_SIMPLE_REBATE)) * (gs_usaframe) + comy
		egressthk2 = - gs_leaf_thk * not(gs_usaframe) - (gs_ds_pr * (gs_frame_style_m = FRAME_STYLE_DOUBLE_REBATE | gs_frame_style_m = FRAME_STYLE_METAL) + gs_leaf_thk * (gs_frame_style_m = FRAME_STYLE_SIMPLE_REBATE)) * (gs_usaframe) - gs_ds_thk + comy
		egressthk3 = - gs_leaf_thk * not(gs_usaframe) - (gs_ds_pr * (gs_frame_style_m = FRAME_STYLE_DOUBLE_REBATE | gs_frame_style_m = FRAME_STYLE_METAL) + gs_leaf_thk * (gs_frame_style_m = FRAME_STYLE_SIMPLE_REBATE)) * (gs_usaframe) - gs_ds_thk + comy
	endif
endif

if bShowEgressHotspots then
	unID = 200
	if gs_frame_style_m = FRAME_STYLE_BLOCK then
		hotspot2 egressLeftHotspot,  0, unID
		hotspot2 egressRightHotspot, 0, unID + 1
	else
		if gs_frame_style_m = FRAME_STYLE_DOUBLE_EGRESS_METAL then
			hotspot2 egressLeftHotspot  + frameDiff, egressthk1, unID
			hotspot2 egressRightHotspot + frameDiff + gs_rebate_width*2, egressthk1, unID + 1
		else
			hotspot2 egressLeftHotspot,  egressthk1, unID
			hotspot2 egressRightHotspot, egressthk1, unID + 1
		endif
	endif

	if gs_frame_style_m = FRAME_STYLE_DOUBLE_REBATE | gs_frame_style_m = FRAME_STYLE_METAL then
		hotspot2 egressLeftHotspot,  egressthk3, unID + 2
		hotspot2 egressRightHotspot, egressthk3, unID + 3
	else
		if gs_frame_style_m = FRAME_STYLE_DOUBLE_EGRESS_METAL then
			hotspot2 egressLeftHotspot + frameDiff - gs_rebate_width*2, -gs_frame_thk - comy, unID + 2
			hotspot2 egressRightHotspot + frameDiff, -gs_frame_thk - comy, unID + 3
		else
			if gs_frame_style_m <> FRAME_STYLE_SIMPLE_REBATE | not(gs_sidelight_left) then
				hotspot2 egressLeftHotspot,  -gs_frame_thkin2 * (symb_2d <> 200), unID + 2
			endif
			if gs_frame_style_m <> FRAME_STYLE_SIMPLE_REBATE | not(gs_sidelight_right) then
				hotspot2 egressRightHotspot, -gs_frame_thkin2 * (symb_2d <> 200), unID + 3
			endif
		endif
	endif
endif


! =============================================================================
! Hotspots on Leaf Size
! =============================================================================

if symb_2d = 200 then
	leafthk1 = 0
else
	if symb_2d=100 then
		leafthk1=-gs_frame_thkin2
	else
		leafthk1=-gs_leaf_thk
	endif
endif
leafleft1	= leafleft
leafright1	= leafright

if bShowLeafHotspots then
	unID = 300
	if	gs_frame_style_m = FRAME_STYLE_SIMPLE_REBATE		|\
		gs_frame_style_m = FRAME_STYLE_EXTRUSION			|\
		gs_frame_style_m = FRAME_STYLE_WRAPPED_EXTRUSION	then

		hotspot2 leafleft1,  0,        unID
		hotspot2 leafright1, 0,        unID + 1
		if lod2D = DET2D_FS_MIDDLE then
			hotspot2 leafleft1,  0,        unID + 2
			hotspot2 leafright1, 0,        unID + 3
		else
			hotspot2 leafleft1,  leafthk1, unID + 2
			hotspot2 leafright1, leafthk1, unID + 3
		endif
	else
		if gs_frame_style_m = FRAME_STYLE_DOUBLE_EGRESS_METAL then
			hotspot2 leafleft + frameDiff,		-posLeafy * (symb_2d = 50) + comy * (symb_2d = 100),   unID
			hotspot2 leafright + frameDiff,		-posLeafy * (symb_2d = 50) + comy * (symb_2d = 100),           unID + 1
			hotspot2 leafleft + frameDiff,		(-gs_frame_thk + posLeafy) * (symb_2d = 50) + (-gs_frame_thk - comy) * (symb_2d = 100), unID + 2
			hotspot2 leafright + frameDiff,		(-gs_frame_thk + posLeafy) * (symb_2d = 50) + (-gs_frame_thk - comy) * (symb_2d = 100), unID + 3
		else
			hotspot2 leafleft,   comy * (symb_2d <> 200),                   unID
			hotspot2 leafright,  comy * (symb_2d <> 200),                   unID + 1
			hotspot2 leafleft,  (-gs_frame_thkin2 - comy) * (symb_2d <> 200), unID + 2
			hotspot2 leafright, (-gs_frame_thkin2 - comy) * (symb_2d <> 200), unID + 3
		endif
	endif
endif


! =============================================================================
! Hotspot Editing of SideLights in 2D
! =============================================================================

if lod2D = DET2D_FS_MIDDLE | lod2D = DET2D_FS_DETAILED |\
	(bShowEgressHotspots & (gs_frame_style_m = FRAME_STYLE_SIMPLE_REBATE)) then

	if gs_frame_style_m = FRAME_STYLE_SIMPLE_REBATE then
		_iSideLightLeftMovingHsID	= 202
		_iSideLightRightMovingHsID	= 203
	else
		_iSideLightLeftMovingHsID	= 1322
		_iSideLightRightMovingHsID	= 1342
	endif

	add2 0, -gs_frame_thkin2 * (gs_frame_style_m = FRAME_STYLE_SIMPLE_REBATE)
		if gs_sidelight_left then
			hotspot2 -A/2 + gs_frame_oversize, comy, 1320, gs_sidelight_width_left, 1 + 128
			hotspot2 -A/2 + gs_frame_oversize-1, comy, 1321, gs_sidelight_width_left, 3
			hotspot2 -A/2 + gs_frame_oversize+gs_sidelight_width_left, comy, _iSideLightLeftMovingHsID, gs_sidelight_width_left, 2
		endif
		if gs_sidelight_right then
			hotspot2 A/2 - gs_frame_oversize, comy, 1340, gs_sidelight_width_right, 1 + 128
			hotspot2 A/2 - gs_frame_oversize+1, comy, 1341, gs_sidelight_width_right, 3
			hotspot2 A/2 - gs_frame_oversize-gs_sidelight_width_right, comy, _iSideLightRightMovingHsID, gs_sidelight_width_right, 2
		endif
	del 1
endif

_frame_left_endline		= gs_frame_left_endline | (gs_tolerance_left  > 0)
_frame_right_endline	= gs_frame_right_endline | (gs_tolerance_right > 0)


! =============================================================================
! 1:100
! =============================================================================

if symb_2d = 100 then

	!*********************** Simple or 1:100

	if gs_frame_style_m <> FRAME_STYLE_METAL & gs_frame_style_m <> FRAME_STYLE_DOUBLE_EGRESS_METAL then		! Commercial Door Frame
		if gs_pocket_door_frame then
			_pocket_frame_thk = gs_pocket_frame_thk * gs_pocket_frame
			if (gs_frame_ovhg_left_out > EPS) | (gs_frame_ovhg_left_in > EPS) then
				if bDoubleDoor then
					_proportion = ((gs_frame_ovhg_left_in - gs_frame_ovhg_left_out)/outsideFrameThk)
					if not(_pocket_frame_thk) then
						line2 unitleft, -posLeafy, frameleftout - posLeafy*_proportion, -posLeafy
						line2 unitleft, -posLeafy - widthWallCut, frameleftout - (posLeafy + widthWallCut)*_proportion, -posLeafy - widthWallCut
					endif

					if gs_frame_left_endline then
						line2 frameleftout, 0, frameleftout - (posLeafy - _pocket_frame_thk)*_proportion, -posLeafy + _pocket_frame_thk
						line2 frameleftout - (posLeafy + widthWallCut + _pocket_frame_thk)*_proportion, -posLeafy - widthWallCut - _pocket_frame_thk, frameleftin, -outsideFrameThk
					endif
				else
					if gs_frame_left_endline then
						line2 frameleftout, 0, frameleftin, -outsideFrameThk
					endif
				endif

				if (gs_frame_ovhg_left_out > EPS) then
					line2 unitleft, 0, frameleftout, 0
				endif

				if (gs_frame_ovhg_left_in > EPS) then
					line2 unitleft, -outsideFrameThk, frameleftin, -outsideFrameThk
				endif
			endif
			if (gs_frame_ovhg_right_out > EPS) | (gs_frame_ovhg_right_in > EPS) then
				if (gs_frame_ovhg_right_out > EPS) then
					line2 unitright, 0, framerightout, 0
				endif

				if (gs_frame_ovhg_right_in > EPS) then
					line2 unitright, -outsideFrameThk, framerightin, -outsideFrameThk
				endif

				_proportion = ((gs_frame_ovhg_right_in - gs_frame_ovhg_right_out)/outsideFrameThk)
				if not(_pocket_frame_thk) then
					line2 unitright, -posLeafy, framerightout + posLeafy*_proportion, -posLeafy
					line2 unitright, -posLeafy - widthWallCut, framerightout + (posLeafy + widthWallCut)*_proportion, -posLeafy - widthWallCut
				endif

				if gs_frame_right_endline then
					line2 framerightout, 0, framerightout + (posLeafy - _pocket_frame_thk)*_proportion, -posLeafy + _pocket_frame_thk
					line2 framerightout + (posLeafy + widthWallCut + _pocket_frame_thk)*_proportion, -posLeafy - widthWallCut - _pocket_frame_thk, framerightin, -outsideFrameThk
				endif
			endif
		else
			if (gs_frame_ovhg_left_out > EPS) | (gs_frame_ovhg_left_in > EPS) then
				if (gs_frame_ovhg_left_out > EPS) then
					line2 unitleft + gs_frame_oversize,  0, unitleft + gs_frame_oversize - gs_frame_ovhg_left_out,  0
				endif
				if (gs_frame_ovhg_left_in > EPS) then
					line2 unitleft + gs_frame_oversize,  -outsideFrameThk, unitleft + gs_frame_oversize - gs_frame_ovhg_left_in,  -outsideFrameThk
				endif
				if gs_frame_left_endline then
					line2 unitleft + gs_frame_oversize - gs_frame_ovhg_left_out,  0, unitleft + gs_frame_oversize - gs_frame_ovhg_left_in,  -outsideFrameThk
				endif
			endif
			if (gs_frame_ovhg_right_out > EPS) | (gs_frame_ovhg_right_in > EPS) then
				if (gs_frame_ovhg_right_out > EPS) then
					line2 unitright - gs_frame_oversize, 0, unitright - gs_frame_oversize + gs_frame_ovhg_right_out, 0
				endif
				if (gs_frame_ovhg_right_in > EPS) then
					line2 unitright - gs_frame_oversize, -outsideFrameThk, unitright - gs_frame_oversize + gs_frame_ovhg_right_in, -outsideFrameThk
				endif
				if gs_frame_right_endline then
					line2 unitright - gs_frame_oversize + gs_frame_ovhg_right_out, 0, unitright - gs_frame_oversize + gs_frame_ovhg_right_in, -outsideFrameThk
				endif
			endif
		endif

		fill gs_fillFr

		if gs_pocket_door_frame & bDoubleDoor then	! Double Pocket Doors Frame Left
			if posLeafy > EPS then
				put unitleft,	 0,			1+32,
					egressleft,		 0,			1+32,
					egressleft,		-posLeafy,	1+32,
					unitleft,	-posLeafy,	_frame_left_endline * not(gs_pocket_frame) + 32
				if gs_pocket_frame then
					 put unitleft,	-posLeafy + gs_pocket_frame_thk,	_frame_left_endline + 32
				endif
				poly2_b nsp/3, 1+2+4+32, gs_penFr_fg, gs_penFr_bg, get(nsp)
			endif

			if posLeafy < gs_frame_thk - widthWallCut - eps then
				put unitleft,	-posLeafy - widthWallCut,	1+32,
					egressleft,		-posLeafy - widthWallCut,			1+32,
					egressleft,		-gs_frame_thk,	1+32,
					unitleft,	-gs_frame_thk,				_frame_left_endline+32
				if gs_pocket_frame then
					 put unitleft,	-posLeafy - widthWallCut - gs_pocket_frame_thk,	0
				endif
				poly2_b nsp/3, 1+2+4+32, gs_penFr_fg, gs_penFr_bg, get(nsp)
			endif
		else ! Other Doors & Single Pocket Doors Frame Left
			poly2_b 4, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
				-A/2 + gs_frame_oversize,	 0,					1+32,
				-A/2 + gs_frw1,										 0,					1+32,
				-A/2 + gs_frw1,										-outsideFrameThk,	1+32,
				-A/2 + gs_frame_oversize,	-outsideFrameThk,	_frame_left_endline+32
		endif

		if gs_sidelight_left then
			poly2_b 4, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
			   -A/2 - gs_frw_Sl_left + gs_sl_w1,	0,					1+32,
			   -A/2 + gs_sl_w1,						0,					1+32,
			   -A/2 + gs_sl_w1,						-insideFrameThk,	1+32,
			   -A/2 - gs_frw_Sl_left + gs_sl_w1,	-insideFrameThk,	1+32
		endif

		if gs_pocket_door_frame then	! Pocket Doors Frame Right
			if posLeafy > EPS then
				put	unitright,	 	 0,			1+32,
					 egressright,	 0,			1+32,
					 egressright,	-posLeafy,	1+32,
					unitright,		-posLeafy,	_frame_right_endline * not(gs_pocket_frame) + 32
				if gs_pocket_frame then
					 put unitright,	-posLeafy + gs_pocket_frame_thk,	_frame_right_endline + 32
				endif
				poly2_b nsp/3, 1+2+4+32, gs_penFr_fg, gs_penFr_bg, get(nsp)
			endif

			if posLeafy < gs_frame_thk - widthWallCut - eps then
				put	unitright,	 	-posLeafy - widthWallCut,	1+32,
					 egressright,		-posLeafy - widthWallCut,			1+32,
					 egressright,		-gs_frame_thk,	1+32,
					unitright,		-gs_frame_thk,				_frame_right_endline+32
				if gs_pocket_frame then
					 put unitright,	-posLeafy - widthWallCut - gs_pocket_frame_thk,	0
				endif
				poly2_b nsp/3, 1+2+4+32, gs_penFr_fg, gs_penFr_bg, get(nsp)
			endif
		else	! Others Doors Frame Right
			poly2_b 4, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
				A/2 - gs_frame_oversize,	 0,					1+32,
				A/2 - gs_frw2,										 0,					1+32,
				A/2 - gs_frw2,										-outsideFrameThk,	1+32,
				A/2 - gs_frame_oversize,	-outsideFrameThk,	_frame_right_endline+32
		endif

		if gs_sidelight_right then
			poly2_b 4, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
			   A/2 + gs_frw_Sl_right - gs_sl_w2,	 0,					1+32,
			   A/2 - gs_sl_w2,						 0,					1+32,
			   A/2 - gs_sl_w2,						-insideFrameThk,	1+32,
			   A/2 + gs_frw_Sl_right - gs_sl_w2,	-insideFrameThk,	1+32
		endif
	endif

	if gs_frame_style_m = FRAME_STYLE_METAL then		! Commercial Door Frame
		fill gs_fillFr

		jp = 1/2"	! Jamb projection for drywall partition, or edge return for masonry wall, (Typical)
		gs_fcr=1
		gs_fcl=1

		if gs_frame_wthk = 0 then
			poly2_b 4, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
				-A/2 - gs_frame_ovhg_left_out,	 0,				1,
				-A/2 + gs_frw1,					 0,				1,
				-A/2 + gs_frw1,					-gs_frame_thk,	1,
				-A/2 - gs_frame_ovhg_left_in,	-gs_frame_thk,	_frame_left_endline

			poly2_b 4, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
				A/2 + gs_frame_ovhg_right_out,	 0,				1,
				A/2 - gs_frw2,					 0,				1,
				A/2 - gs_frw2,					-gs_frame_thk,	1,
				A/2 + gs_frame_ovhg_right_in,	-gs_frame_thk,	_frame_right_endline

			if gs_sidelight_left then
				poly2_b 4, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
					leafleft,					 0,				1+32,
					leafleft - gs_frw_Sl_left,	 0,				1+32,
					leafleft - gs_frw_Sl_left,	-gs_frame_thk,	1+32,
					leafleft,					-gs_frame_thk,	1+32
			endif

			if gs_sidelight_right then
				poly2_b 4, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
					A/2 - gs_sl_w2 + gs_frw_Sl_right,	 0,				1+32,
					A/2 - gs_sl_w2,						 0,				1+32,
					A/2 - gs_sl_w2,						-gs_frame_thk,	1+32,
					A/2 - gs_sl_w2 + gs_frw_Sl_right,	-gs_frame_thk,	1+32
			endif
		else
			poly2_b 8, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
				-A/2,								 jp,				1+32,
				-A/2 + gs_frw1,						 jp,				1+32,
				-A/2 + gs_frw1,						-gs_frame_thk - jp,	1+32,
				-A/2,								-gs_frame_thk - jp,	1+32,
				-A/2,								-gs_frame_thk, 		bListView+32,
				-A/2 - gs_fcr * gs_tolerance_left, 	-gs_frame_thk, 		_frame_left_endline+32,
				-A/2 - gs_fcr * gs_tolerance_left, 	 0, 				bListView+32,
				-A/2,								 0, 				1+32

			if gs_sidelight_left then
				poly2_b 4, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
					leafleft,					 jp,				1+32,
					leafleft - gs_frw_Sl_left,	 jp,				1+32,
					leafleft - gs_frw_Sl_left,	-gs_frame_thk-jp,	1+32,
					leafleft,					-gs_frame_thk-jp,	1+32
			endif

			if gs_sidelight_right then
				poly2_b 4, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
					A/2 - gs_sl_w2 + gs_frw_Sl_right,	 jp,				1+32,
					A/2 - gs_sl_w2,						 jp,				1+32,
					A/2 - gs_sl_w2,						-gs_frame_thk - jp,	1+32,
					A/2 - gs_sl_w2 + gs_frw_Sl_right,	-gs_frame_thk - jp,	1+32
			endif

			poly2_b 8, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
				A/2 - gs_frw2,												 jp,				1+32,
				A/2 - gs_frw2 + gs_frw2,									 jp,				1+32,
				A/2 - gs_frw2 + gs_frw2,									 0,					bListView+32,
				A/2 - gs_frw2 + gs_fcr * (gs_frw2 + gs_tolerance_right),	 0,					_frame_right_endline+32,
				A/2 - gs_frw2 + gs_fcr * (gs_frw2 + gs_tolerance_right),	-gs_frame_thk,		bListView+32,
				A/2 - gs_frw2 + gs_frw2,									-gs_frame_thk,		1+32,
				A/2 - gs_frw2 + gs_frw2,									-gs_frame_thk - jp,	1+32,
				A/2 - gs_frw2,												-gs_frame_thk - jp,	1+32
		endif
	endif

	if gs_frame_style_m = FRAME_STYLE_DOUBLE_EGRESS_METAL then		! Double Egress Metal Frame

		fill gs_fillFr


		add2 frameDiff, 0

		poly2_b 8, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
			leafleft,				gs_unit_extra_thk,				1+32,
			leafleft + gs_rebate_width - gs_frw1,	gs_unit_extra_thk,				1+32,
			leafleft + gs_rebate_width - gs_frw1, 	0,								bListView+32,
			leafleft + gs_rebate_width - gs_frw1 - gs_tolerance_left,	0, 			_frame_left_endline+32,
			leafleft + gs_rebate_width - gs_frw1 - gs_tolerance_left,	-gs_frame_thk,	bListView+32,
			leafleft + gs_rebate_width - gs_frw1,	-gs_frame_thk,  						1+32,
			leafleft + gs_rebate_width - gs_frw1,	-gs_frame_thk-gs_unit_extra_thk,		1+32,
			leafleft,				-gs_frame_thk - gs_unit_extra_thk,		1+32

		poly2_b 8, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
			leafright,								gs_unit_extra_thk,				1+32,
			leafright - gs_rebate_width + gs_frw2,	gs_unit_extra_thk,				1+32,
			leafright - gs_rebate_width + gs_frw2, 	0,								bListView+32,
			leafright - gs_rebate_width + gs_frw2 + gs_tolerance_right,	0, 				_frame_right_endline+32,
			leafright - gs_rebate_width + gs_frw2 + gs_tolerance_right,	-gs_frame_thk,	bListView+32,
			leafright - gs_rebate_width + gs_frw2,	-gs_frame_thk,  						1+32,
			leafright - gs_rebate_width + gs_frw2,	-gs_frame_thk - gs_unit_extra_thk,		1+32,
			leafright,								-gs_frame_thk-gs_unit_extra_thk,		1+32

		del 1


	endif

	gosub 2500

endif


! =============================================================================
! 1:50
! =============================================================================

if symb_2d = 50 then

	!*********************** Detailed or 1:50

	if gs_frame_style_m = FRAME_STYLE_EXTRUSION | gs_frame_style_m = FRAME_STYLE_WRAPPED_EXTRUSION then
		gs_frame_ovhg_left_in	= 0
		gs_frame_ovhg_left_out	= 0
		gs_frame_ovhg_right_in	= 0
		gs_frame_ovhg_right_out	= 0
		gs_tolerance_left		= 0
		gs_tolerance_right		= 0
	endif

	if gs_pocket_door_frame then
		_pocket_frame_thk = gs_pocket_frame_thk * gs_pocket_frame
		if (gs_frame_ovhg_left_out > EPS) | (gs_frame_ovhg_left_in > EPS) then
			if bDoubleDoor then
				_proportion = ((gs_frame_ovhg_left_in - gs_frame_ovhg_left_out)/outsideFrameThk)
				if not(_pocket_frame_thk) then
					line2 unitleft, -posLeafy, frameleftout - posLeafy*_proportion, -posLeafy
					line2 unitleft, -posLeafy - widthWallCut, frameleftout - (posLeafy + widthWallCut)*_proportion, -posLeafy - widthWallCut
				endif

				if gs_frame_left_endline then
					line2 frameleftout, 0, frameleftout - (posLeafy - _pocket_frame_thk)*_proportion, -posLeafy + _pocket_frame_thk
					line2 frameleftout - (posLeafy + widthWallCut + _pocket_frame_thk)*_proportion, -posLeafy - widthWallCut - _pocket_frame_thk, frameleftin, -outsideFrameThk
				endif
			else
				if gs_frame_left_endline then
					line2 frameleftout, 0, frameleftin, -outsideFrameThk
				endif
			endif

			if (gs_frame_ovhg_left_out > EPS) then
				line2 unitleft, 0, frameleftout, 0
			endif

			if (gs_frame_ovhg_left_in > EPS) then
				line2 unitleft, -outsideFrameThk, frameleftin, -outsideFrameThk
			endif
		endif
		if (gs_frame_ovhg_right_out > EPS) | (gs_frame_ovhg_right_in > EPS) then
			if (gs_frame_ovhg_right_out > EPS) then
				line2 unitright, 0, framerightout, 0
			endif

			if (gs_frame_ovhg_right_in > EPS) then
				line2 unitright, -outsideFrameThk, framerightin, -outsideFrameThk
			endif

			_proportion = ((gs_frame_ovhg_right_in - gs_frame_ovhg_right_out)/outsideFrameThk)
			if not(_pocket_frame_thk) then
				line2 unitright, -posLeafy, framerightout + posLeafy*_proportion, -posLeafy
				line2 unitright, -posLeafy - widthWallCut, framerightout + (posLeafy + widthWallCut)*_proportion, -posLeafy - widthWallCut
			endif

			if gs_frame_right_endline then
				line2 framerightout, 0, framerightout + (posLeafy - _pocket_frame_thk)*_proportion, -posLeafy + _pocket_frame_thk
				line2 framerightout + (posLeafy + widthWallCut + _pocket_frame_thk)*_proportion, -posLeafy - widthWallCut - _pocket_frame_thk, framerightin, -outsideFrameThk
			endif
		endif
	else
		if (gs_frame_ovhg_left_out > EPS) | (gs_frame_ovhg_left_in > EPS) then
			if (gs_frame_ovhg_left_out > EPS) then
				line2 unitleft,  0, unitleft - gs_frame_ovhg_left_out,  0
			endif
			if (gs_frame_ovhg_left_in > EPS) then
				line2 unitleft,  -outsideFrameThk, unitleft - gs_frame_ovhg_left_in,  -outsideFrameThk
			endif
			if gs_frame_left_endline then
				line2 unitleft - gs_frame_ovhg_left_out,  0, unitleft - gs_frame_ovhg_left_in,  -outsideFrameThk
			endif
		endif
		if (gs_frame_ovhg_right_out > EPS) | (gs_frame_ovhg_right_in > EPS) then
			if (gs_frame_ovhg_right_out > EPS) then
				line2 unitright, 0, unitright + gs_frame_ovhg_right_out, 0
			endif
			if (gs_frame_ovhg_right_in > EPS) then
				line2 unitright, -outsideFrameThk, unitright + gs_frame_ovhg_right_in, -outsideFrameThk
			endif
			if gs_frame_right_endline then
				line2 unitright + gs_frame_ovhg_right_out, 0, unitright + gs_frame_ovhg_right_in, -outsideFrameThk
			endif
		endif
	endif

	leafleft2	= egressLeft
	leafright2	= egressRight + (gs_pivotOffset + gs_leaf_thk/2) * gs_pivotdoor

	fill gs_fillFr

	if gs_frame_style_m <> FRAME_STYLE_METAL & gs_frame_style_m <> FRAME_STYLE_DOUBLE_EGRESS_METAL then	! Not Commercial & Metal Frame
		if gs_sidelight_left then

			put -A/2, -outsideFrameThk,	_frame_left_endline+32
			if gs_frame_style_m = FRAME_STYLE_EXTRUSION | gs_frame_style_m = FRAME_STYLE_WRAPPED_EXTRUSION then
				put -A/2,						-outsideFrameThk + frameRebateOffset,	1+32,
					-A/2 + frameRebateWidth,	-outsideFrameThk + frameRebateOffset,	1+32,
					-A/2 + frameRebateWidth,	-frameRebateOffset,						1+32,
					-A/2,						-frameRebateOffset,						_frame_left_endline+32
			endif

			if gs_sidelight_rebate_width > 0 & gs_sidelight_rebate_depth > 0 & not(bNoRebate_09) then
				if gs_opening_dir_sl_m <> 1 then
					poly2_b 5+nsp/3, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
						-A/2,	 									0,			1+32,
						-A/2 + gs_frw1,								0,			1+32,
						-A/2 + gs_frw1,								-insideFrameThk+gs_sidelight_rebate_depth,			1+32,
						-A/2 + gs_frw1-gs_sidelight_rebate_width,	-insideFrameThk+gs_sidelight_rebate_depth,			1+32,
						-A/2 + gs_frw1-gs_sidelight_rebate_width,	-outsideFrameThk,							1+32,
						get(nsp)
				else
					poly2_b 5+nsp/3, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
						-A/2,							 			0,							1+32,
						-A/2 + gs_frw1-gs_sidelight_rebate_width,	0,							1+32,
						-A/2 + gs_frw1-gs_sidelight_rebate_width,	-gs_sidelight_rebate_depth,	1+32,
						-A/2 + gs_frw1,								-gs_sidelight_rebate_depth,	1+32,
						-A/2 + gs_frw1,								-outsideFrameThk,			1+32,
						get(nsp)
				endif
			else
				poly2_b 3+nsp/3, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
					-A/2,				 0,					1+32,
					-A/2 + gs_frw1,		 0,					1+32,
					-A/2 + gs_frw1,		-outsideFrameThk,	1+32,
					get(nsp)
			endif

			if gs_sidelight_rebate_width > 0 & gs_sidelight_rebate_depth > 0 & not(bNoRebate_09) then
				if gs_opening_dir_sl_m <> 1 then
					put	-A/2 + gs_sl_w1 - gs_frw_Sl_left+gs_sidelight_rebate_width,	-insideFrameThk, 1+32,
						-A/2 + gs_sl_w1 - gs_frw_Sl_left+gs_sidelight_rebate_width, -insideFrameThk+gs_sidelight_rebate_depth, 1+32,
						-A/2 + gs_sl_w1 - gs_frw_Sl_left, -insideFrameThk+gs_sidelight_rebate_depth, 1+32,
						-A/2 + gs_sl_w1 - gs_frw_Sl_left, 0, 1+32
				else
					put	-A/2 + gs_sl_w1 - gs_frw_Sl_left,	-insideFrameThk, 1+32,
						-A/2 + gs_sl_w1 - gs_frw_Sl_left, -gs_sidelight_rebate_depth, 1+32,
						-A/2 + gs_sl_w1 - gs_frw_Sl_left+gs_sidelight_rebate_width, -gs_sidelight_rebate_depth, 1+32,
						-A/2 + gs_sl_w1 - gs_frw_Sl_left+gs_sidelight_rebate_width, 0, 1+32
				endif
			else
				put	-A/2 + gs_sl_w1 - gs_frw_Sl_left,	-insideFrameThk, 1+32,
					-A/2 + gs_sl_w1 - gs_frw_Sl_left, 0, 1+32
			endif

			if	gs_frame_style_m = FRAME_STYLE_BLOCK			|\
				gs_frame_style_m = FRAME_STYLE_DOUBLE_REBATE	then
				poly2_b 2+nsp/3, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
					get(nsp),
					-A/2 + gs_sl_w1,	0,1+32,
					-A/2 + gs_sl_w1,	-insideFrameThk, 1+32
			endif

			if gs_frame_style_m = FRAME_STYLE_DOUBLE_REBATE then
				add2 0, (gs_leaf_thk-gs_ds_pr)*(abs(gs_ds_pr)>eps)
				poly2_b 4, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
					-A/2 + gs_sl_w1,			-gs_leaf_thk,			1+32,
					-A/2 + gs_sl_w1 + gs_ds_w,	-gs_leaf_thk,			1+32,
					-A/2 + gs_sl_w1 + gs_ds_w,	-gs_leaf_thk-gs_ds_thk,	1+32,
					-A/2 + gs_sl_w1,			-gs_leaf_thk-gs_ds_thk,	1+32
				del 1
			endif

			if	gs_frame_style_m = FRAME_STYLE_SIMPLE_REBATE		|\
				gs_frame_style_m = FRAME_STYLE_EXTRUSION			|\
				gs_frame_style_m = FRAME_STYLE_WRAPPED_EXTRUSION	then
				poly2_b 4+nsp/3, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
					get(nsp),
					-A/2 + gs_sl_w1 - gs_rebate_width,	 0,				1+32,
					-A/2 + gs_sl_w1 - gs_rebate_width,	-gs_leaf_thk,	1+32,
					-A/2 + gs_sl_w1,					-gs_leaf_thk,	1+32,
					-A/2 + gs_sl_w1,					-insideFrameThk,1+32
			endif

		else

			if gs_pocket_door_frame & bDoubleDoor then  ! Double Pocket Doors Frame Left
				if posLeafy > EPS then
					put	unitleft,	 0,			1+32,
						leafleft2,	 0,			1+32,
						leafleft2,	-posLeafy,	1+32,
						unitleft,	-posLeafy,	_frame_left_endline * not(gs_pocket_frame) + 32
					if gs_pocket_frame then
						 put unitleft,	-posLeafy + gs_pocket_frame_thk,	_frame_left_endline + 32
					endif
					poly2_b nsp/3, 1+2+4+32, gs_penFr_fg, gs_penFr_bg, get(nsp)
				endif

				if posLeafy < gs_frame_thk - widthWallCut - eps then
					put	unitleft,	-posLeafy - widthWallCut,	1+32,
						leafleft2,	-posLeafy - widthWallCut,	1+32,
						leafleft2,	-gs_frame_thk,				1+32,
						unitleft,	-gs_frame_thk,				_frame_left_endline+32
					if gs_pocket_frame then
						 put unitleft,	-posLeafy - widthWallCut - gs_pocket_frame_thk,	0
					endif
					poly2_b nsp/3, 1+2+4+32, gs_penFr_fg, gs_penFr_bg, get(nsp)
				endif

			else ! Other Doors & Single Pocket Doors Frame Left

				if gs_frame_style_m = FRAME_STYLE_BLOCK | gs_frame_style_m = FRAME_STYLE_DOUBLE_REBATE then
					poly2_b 4, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
						-A/2 + gs_sl_w1 - gs_frw1,	-outsideFrameThk,_frame_left_endline+32,
						-A/2 + gs_sl_w1 - gs_frw1,	0,				1+32,
						-A/2 + gs_sl_w1,			0,				1+32,
						-A/2 + gs_sl_w1,			-outsideFrameThk,1+32
				endif

				if gs_frame_style_m = FRAME_STYLE_DOUBLE_REBATE then
					add2 0, (gs_leaf_thk-gs_ds_pr)*(abs(gs_ds_pr)>eps)
					poly2_b 4, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
						-A/2 + gs_sl_w1,			-gs_leaf_thk,			1+32,
						-A/2 + gs_sl_w1 + gs_ds_w,	-gs_leaf_thk,			1+32,
						-A/2 + gs_sl_w1 + gs_ds_w,	-gs_leaf_thk-gs_ds_thk,	1+32,
						-A/2 + gs_sl_w1,			-gs_leaf_thk-gs_ds_thk,	1+32
					del 1
				endif

				if gs_frame_style_m = FRAME_STYLE_SIMPLE_REBATE then
					poly2_b 6, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
						-A/2 + gs_sl_w1 - gs_frw1,			-outsideFrameThk,_frame_left_endline+32,
						-A/2 + gs_sl_w1 - gs_frw1,			 0,				1+32,
						-A/2 + gs_sl_w1 - gs_rebate_width,	 0,				1+32,
						-A/2 + gs_sl_w1 - gs_rebate_width,	-gs_leaf_thk,	1+32,
						-A/2 + gs_sl_w1,					-gs_leaf_thk,	1+32,
						-A/2 + gs_sl_w1,					-outsideFrameThk,1+32
				endif

				if gs_frame_style_m = FRAME_STYLE_EXTRUSION | gs_frame_style_m = FRAME_STYLE_WRAPPED_EXTRUSION then
					poly2_b 10, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
						-A/2 + gs_sl_w1 - gs_frw1,						-outsideFrameThk,					1+32,
						-A/2 + gs_sl_w1 - gs_frw1,						-outsideFrameThk+frameRebateOffset,	1+32,
						-A/2 + gs_sl_w1 - gs_frw1 + frameRebateWidth,	-outsideFrameThk+frameRebateOffset,	1+32,
						-A/2 + gs_sl_w1 - gs_frw1 + frameRebateWidth,	-frameRebateOffset,					1+32,
						-A/2 + gs_sl_w1 - gs_frw1,						-frameRebateOffset,					1+32,
						-A/2 + gs_sl_w1 - gs_frw1,	 					 0,									1+32,
						-A/2 + gs_sl_w1 - gs_rebate_width,				 0,									1+32,
						-A/2 + gs_sl_w1 - gs_rebate_width,				-gs_leaf_thk,						1+32,
						-A/2 + gs_sl_w1,								-gs_leaf_thk,						1+32,
						-A/2 + gs_sl_w1,								-outsideFrameThk,					1+32
				endif
			endif
		endif

		if gs_sidelight_right then
			put A/2, -outsideFrameThk, _frame_right_endline+32
			if gs_frame_style_m = FRAME_STYLE_EXTRUSION | gs_frame_style_m = FRAME_STYLE_WRAPPED_EXTRUSION then
				put A/2,					-outsideFrameThk + frameRebateOffset,	1+32,
					A/2 - frameRebateWidth,	-outsideFrameThk + frameRebateOffset,	1+32,
					A/2 - frameRebateWidth,	-frameRebateOffset,						1+32,
					A/2,					-frameRebateOffset,						_frame_right_endline+32
			endif

			if gs_sidelight_rebate_width > 0 & gs_sidelight_rebate_depth > 0 & not(bNoRebate_05) then
				if gs_opening_dir_sl_m <> 1 then
					poly2_b 5+nsp/3, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
						A/2,	 									0,			1+32,
						A/2 - gs_frw2,								0,			1+32,
						A/2 - gs_frw2,								-insideFrameThk+gs_sidelight_rebate_depth,			1+32,
						A/2 - gs_frw2+gs_sidelight_rebate_width,	-insideFrameThk+gs_sidelight_rebate_depth,			1+32,
						A/2 - gs_frw2+gs_sidelight_rebate_width,	-outsideFrameThk,							1+32,
						get(nsp)
				else
					poly2_b 5+nsp/3, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
						A/2,							 			0,			1+32,
						A/2 - gs_frw2+gs_sidelight_rebate_width,	0,			1+32,
						A/2 - gs_frw2+gs_sidelight_rebate_width,	-gs_sidelight_rebate_depth,			1+32,
						A/2 - gs_frw2,								-gs_sidelight_rebate_depth,			1+32,
						A/2 - gs_frw2,								-outsideFrameThk,							1+32,
						get(nsp)
				endif
			else
				poly2_b 3+nsp/3, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
					A/2,			 0,			1+32,
					A/2 - gs_frw2,	 0,			1+32,
					A/2 - gs_frw2,	-outsideFrameThk,	1+32,
					get(nsp)
			endif

			if gs_sidelight_rebate_width > 0 & gs_sidelight_rebate_depth > 0 & not(bNoRebate_05) then
				if gs_opening_dir_sl_m <> 1 then
					put	A/2 - gs_sl_w2 + gs_frw_Sl_right-gs_sidelight_rebate_width,	-insideFrameThk, 1+32,
						A/2 - gs_sl_w2 + gs_frw_Sl_right-gs_sidelight_rebate_width, -insideFrameThk+gs_sidelight_rebate_depth, 1+32,
						A/2 - gs_sl_w2 + gs_frw_Sl_right, -insideFrameThk+gs_sidelight_rebate_depth, 1+32,
						A/2 - gs_sl_w2 + gs_frw_Sl_right, 0, 1+32
				else
					put	A/2 - gs_sl_w2 + gs_frw_Sl_right,							-insideFrameThk,			1+32,
						A/2 - gs_sl_w2 + gs_frw_Sl_right,							-gs_sidelight_rebate_depth,	1+32,
						A/2 - gs_sl_w2 + gs_frw_Sl_right-gs_sidelight_rebate_width, -gs_sidelight_rebate_depth,	1+32,
						A/2 - gs_sl_w2 + gs_frw_Sl_right-gs_sidelight_rebate_width,	 0,							1+32
				endif
			else
				put	A/2 - gs_sl_w2 + gs_frw_Sl_right,	-insideFrameThk, 1+32,
					A/2 - gs_sl_w2 + gs_frw_Sl_right, 0, 1+32
			endif

			if	gs_frame_style_m = FRAME_STYLE_BLOCK			|\
				gs_frame_style_m = FRAME_STYLE_DOUBLE_REBATE	then
				poly2_b 2+nsp/3, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
					get(nsp),
					A/2 - gs_sl_w2,	0,				1+32,
					A/2 - gs_sl_w2,	-insideFrameThk,1+32
			endif

			if gs_frame_style_m = FRAME_STYLE_DOUBLE_REBATE then
				add2 0, (gs_leaf_thk-gs_ds_pr)*(abs(gs_ds_pr)>eps)
				poly2_b 4, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
					A/2 - gs_sl_w2,				-gs_leaf_thk,			1+32,
					A/2 - gs_sl_w2 - gs_ds_w,	-gs_leaf_thk,			1+32,
					A/2 - gs_sl_w2 - gs_ds_w,	-gs_leaf_thk-gs_ds_thk,	1+32,
					A/2 - gs_sl_w2,				-gs_leaf_thk-gs_ds_thk,	1+32
				del 1
			endif

			if	gs_frame_style_m = FRAME_STYLE_SIMPLE_REBATE		|\
				gs_frame_style_m = FRAME_STYLE_EXTRUSION			|\
				gs_frame_style_m = FRAME_STYLE_WRAPPED_EXTRUSION	then
				poly2_b 4+nsp/3, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
					get(nsp),
					A/2 - gs_sl_w2 + gs_rebate_width,	 0,				1+32,
					A/2 - gs_sl_w2 + gs_rebate_width,	-gs_leaf_thk,	1+32,
					A/2 - gs_sl_w2,						-gs_leaf_thk,	1+32,
					A/2 - gs_sl_w2,						-insideFrameThk,1+32
			endif

		else

			if gs_pocket_door_frame then	! Pocket Doors Frame Right
				if posLeafy > EPS then
					put	 unitright,		 0,			1+32,
						 leafright2,	 0,			1+32,
						 leafright2,	-posLeafy,	1+32,
						 unitright,		-posLeafy,	_frame_right_endline * not(gs_pocket_frame) + 32
					if gs_pocket_frame then
						 put unitright,	-posLeafy + gs_pocket_frame_thk,	_frame_right_endline + 32
					endif
					poly2_b nsp/3, 1+2+4+32, gs_penFr_fg, gs_penFr_bg, get(nsp)
				endif

				if posLeafy < gs_frame_thk - widthWallCut - eps then
					put	 unitright,		-posLeafy - widthWallCut,			1+32,
						 leafright2,	-posLeafy - widthWallCut,			1+32,
						 leafright2,	-gs_frame_thk,	1+32,
						 unitright,		-gs_frame_thk,	_frame_right_endline + 32
					if gs_pocket_frame then
						 put unitright,	-posLeafy - widthWallCut - gs_pocket_frame_thk,	0
					endif
					poly2_b nsp/3, 1+2+4+32, gs_penFr_fg, gs_penFr_bg, get(nsp)
				endif

			else	! Others Doors Frame Right

				if gs_frame_style_m = FRAME_STYLE_BLOCK | gs_frame_style_m = FRAME_STYLE_DOUBLE_REBATE then
					poly2_b 4, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
						A/2 - gs_sl_w2 + gs_frw2,	-outsideFrameThk,_frame_right_endline+32,
						A/2 - gs_sl_w2 + gs_frw2,	0,				1+32,
						A/2 - gs_sl_w2,				0,				1+32,
						A/2 - gs_sl_w2,				-outsideFrameThk,1+32
				endif

				if gs_frame_style_m = FRAME_STYLE_DOUBLE_REBATE then
					add2 0, (gs_leaf_thk-gs_ds_pr)*(abs(gs_ds_pr)>eps)
					poly2_b 4, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
						A/2 - gs_sl_w2,				-gs_leaf_thk,			1+32,
						A/2 - gs_sl_w2 - gs_ds_w,	-gs_leaf_thk,			1+32,
						A/2 - gs_sl_w2 - gs_ds_w,	-gs_leaf_thk-gs_ds_thk,	1+32,
						A/2 - gs_sl_w2,				-gs_leaf_thk-gs_ds_thk,	1+32
					del 1
				endif

				if gs_frame_style_m = FRAME_STYLE_SIMPLE_REBATE then
					poly2_b 6, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
						A/2 - gs_sl_w2 + gs_frw2,			-outsideFrameThk,_frame_right_endline+32,
						A/2 - gs_sl_w2 + gs_frw2,			 0,				1+32,
						A/2 - gs_sl_w2 + gs_rebate_width,	 0,				1+32,
						A/2 - gs_sl_w2 + gs_rebate_width,	-gs_leaf_thk,	1+32,
						A/2 - gs_sl_w2,						-gs_leaf_thk,	1+32,
						A/2 - gs_sl_w2,						-outsideFrameThk,1+32
				endif

				if gs_frame_style_m = FRAME_STYLE_EXTRUSION | gs_frame_style_m = FRAME_STYLE_WRAPPED_EXTRUSION then
					poly2_b 10, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
						A/2 - gs_sl_w2 + gs_frw2,						-outsideFrameThk,						1+32,
						A/2 - gs_sl_w2 + gs_frw2,						-outsideFrameThk + frameRebateOffset,	1+32,
						A/2 - gs_sl_w2 + gs_frw2 - frameRebateWidth,	-outsideFrameThk + frameRebateOffset,	1+32,
						A/2 - gs_sl_w2 + gs_frw2 - frameRebateWidth,	-frameRebateOffset,						1+32,
						A/2 - gs_sl_w2 + gs_frw2,	 					-frameRebateOffset,						1+32,
						A/2 - gs_sl_w2 + gs_frw2,						 0,										1+32,
						A/2 - gs_sl_w2 + gs_rebate_width,				 0,										1+32,
						A/2 - gs_sl_w2 + gs_rebate_width,				-gs_leaf_thk,							1+32,
						A/2 - gs_sl_w2,									-gs_leaf_thk,							1+32,
						A/2 - gs_sl_w2,									-outsideFrameThk,						1+32
				endif
			endif
		endif
	endif

	if gs_frame_style_m = FRAME_STYLE_METAL then		! Commercial Door Frame
		fill gs_fillFr

		jp = 1/2"	! Jamb projection for drywall partition, or edge return for masonry wall, (Typical)
		gs_fcr=_frame_right_endline
		gs_fcl=_frame_left_endline

		if not(gs_frame_wthk) then		! Frame Surrounds Wall

			frameleftout	= unitleft  - gs_frame_ovhg_left_out
			framerightout	= unitright + gs_frame_ovhg_right_out
			frameleftin		= unitleft  - gs_frame_ovhg_left_in
			framerightin	= unitright + gs_frame_ovhg_right_in

			min_frameleft	= max(frameleftout, frameleftin)
			min_frameright	= min(framerightout, framerightin)

			! Terminal Frame Left
			if gs_fitframe_slantedreveal then		! Fit Frame to Slanted Wall
				if frameleftout > frameleftin then
					put min_frameleft, 0,                  1+32,
						min_frameleft - tan(gs_reveal_left_angle) * jp, -jp,                gs_fcr+32,
						min_frameleft+jp*(gs_fcl=1),-jp,                gs_fcr+32,
						min_frameleft+jp*(gs_fcl=1),-gs_frame_thk+jp,            gs_fcr+32,
						min_frameleft - tan(gs_reveal_left_angle) * (gs_frame_thk-jp),-gs_frame_thk+jp,            1+32,
						min_frameleft - tan(gs_reveal_left_angle) * gs_frame_thk,-gs_frame_thk,               1+32
				else
					put min_frameleft - tan(gs_reveal_left_angle) * gs_frame_thk, 0,                  1+32,
						min_frameleft - tan(gs_reveal_left_angle) * (gs_frame_thk-jp), -jp,                gs_fcr+32,
						min_frameleft+jp*(gs_fcl=1),-jp,                gs_fcr+32,
						min_frameleft+jp*(gs_fcl=1),-gs_frame_thk+jp,            gs_fcr+32,
						min_frameleft - tan(gs_reveal_left_angle) * jp,-gs_frame_thk+jp,            1+32,
						min_frameleft,-gs_frame_thk,               1+32
				endif
			else
				put	min_frameleft, 0,                  1+32,
					min_frameleft, -jp,                gs_fcr+32,
					min_frameleft+jp*(gs_fcl=1),-jp,                gs_fcr+32,
					min_frameleft+jp*(gs_fcl=1),-gs_frame_thk+jp,            gs_fcr+32,
					min_frameleft,-gs_frame_thk+jp,            1+32,
					min_frameleft,-gs_frame_thk,               1+32
			endif


			if gs_sidelight_left then
				poly2_b 8, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
					leafleft, 										0,         1+32,
					leafleft-gs_frw_Sl_left, 0,                  1+32,
					leafleft-gs_frw_Sl_left,-gs_frame_thk,               1+32,
					leafleft,-gs_frame_thk,                 1+32,
					leafleft,-gs_ds_pr-gs_ds_thk,             1+32,
					leafleft+gs_ds_w,-gs_ds_pr-gs_ds_thk,         1+32,
					leafleft+gs_ds_w,-gs_ds_pr,             1+32,
					leafleft,-gs_ds_pr,                 1+32

				! Terminal Sidelight Frame Left
				poly2_b 2+nsp/3, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
					unitleft+gs_frw1, 0,                    1+32,
					get(nsp),
					unitleft+gs_frw1,-gs_frame_thk,                 1+32
			else

				! Terminal Door Frame Left
				poly2_b 6+nsp/3, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
					unitleft+gs_frw1, 0,                    1+32,
					get(nsp),
					unitleft+gs_frw1,-gs_frame_thk,                 1+32,
					unitleft+gs_frw1,-gs_ds_pr-gs_ds_thk,             1+32,
					unitleft+gs_frw1+gs_ds_w,-gs_ds_pr-gs_ds_thk,         1+32,
					unitleft+gs_frw1+gs_ds_w,-gs_ds_pr,             1+32,
					unitleft+gs_frw1,-gs_ds_pr,                 1+32
			endif

			! Terminal Frame Right
			if gs_fitframe_slantedreveal then
				if framerightout < framerightin then
					put min_frameright, 0,                  1+32,
						min_frameright + tan(gs_reveal_right_angle) * jp, -jp,                gs_fcr+32,
						min_frameright-jp*(gs_fcr=1),-jp,                gs_fcr+32,
						min_frameright-jp*(gs_fcr=1),-gs_frame_thk+jp,            gs_fcr+32,
						min_frameright + tan(gs_reveal_right_angle) * (gs_frame_thk-jp),-gs_frame_thk+jp,            1+32,
						min_frameright + tan(gs_reveal_right_angle) * gs_frame_thk,-gs_frame_thk,               1+32
				else
					put min_frameright + tan(gs_reveal_right_angle) * gs_frame_thk, 0,                  1+32,
						min_frameright + tan(gs_reveal_right_angle) * (gs_frame_thk-jp), -jp,                gs_fcr+32,
						min_frameright-jp*(gs_fcr=1),-jp,                gs_fcr+32,
						min_frameright-jp*(gs_fcr=1),-gs_frame_thk+jp,            gs_fcr+32,
						min_frameright + tan(gs_reveal_right_angle) * jp,-gs_frame_thk+jp,            1+32,
						min_frameright,-gs_frame_thk,               1+32
				endif
			else
				put min_frameright, 0,                  1+32,
					min_frameright, -jp,                gs_fcr+32,
					min_frameright-jp*(gs_fcr=1),-jp,                gs_fcr+32,
					min_frameright-jp*(gs_fcr=1),-gs_frame_thk+jp,            gs_fcr+32,
					min_frameright,-gs_frame_thk+jp,            1+32,
					min_frameright,-gs_frame_thk,               1+32
			endif


			if gs_sidelight_right then
				poly2_b 8, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
					A/2-gs_sl_w2+gs_frw_Sl_right, 					0,         1+32,
					A/2-gs_sl_w2, 0,                  1+32,
					A/2-gs_sl_w2,-gs_ds_pr,                 1+32,
					A/2-gs_sl_w2-gs_ds_w,-gs_ds_pr,             1+32,
					A/2-gs_sl_w2-gs_ds_w,-gs_ds_pr-gs_ds_thk,         1+32,
					A/2-gs_sl_w2,-gs_ds_pr-gs_ds_thk,             1+32,
					A/2-gs_sl_w2,-gs_frame_thk,               1+32,
					A/2-gs_sl_w2+gs_frw_Sl_right,-gs_frame_thk,                 1+32

				! Terminal Sidelight Frame Left
				poly2_b 2+nsp/3, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
					unitright-gs_frw2, 0,                    1+32,
					get(nsp),
					unitright-gs_frw2,-gs_frame_thk,                 1+32

			else

				! Terminal Door Frame Left
				poly2_b 6+nsp/3, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
					unitright-gs_frw2, 0,                    1+32,
					get(nsp),
					unitright-gs_frw2,-gs_frame_thk,                 1+32,
					unitright-gs_frw2,-gs_ds_pr-gs_ds_thk,             1+32,
					unitright-gs_frw2-gs_ds_w,-gs_ds_pr-gs_ds_thk,         1+32,
					unitright-gs_frw2-gs_ds_w,-gs_ds_pr,             1+32,
					unitright-gs_frw2,-gs_ds_pr,                 1+32
			endif
		else
			if gs_sidelight_left then
				poly2_b 8, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
					-A/2, jp,1+32,
					-A/2+gs_frw1, 						jp,			1+32,
					-A/2+gs_frw1, 						-gs_frame_thk-jp,1+32,
					-A/2, 								-gs_frame_thk-jp,1+32,
					-A/2, 								-gs_frame_thk, 	32,
					-A/2 - gs_fcr * gs_tolerance_left, 	-gs_frame_thk, 	1+32,
					-A/2 - gs_fcr * gs_tolerance_left, 	0, 			1+32,
					-A/2, 								0, 			1+32

				poly2_b 9, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
					leafleft, 										jp,         1+32,
					leafleft-gs_frw_Sl_left, 	jp,                  1+32,
					leafleft-gs_frw_Sl_left,	-gs_frame_thk-jp,               1+32,
					leafleft,					-gs_frame_thk-jp,                 1+32,
					leafleft,					-gs_ds_pr-gs_ds_thk+jp,             1+32,
					leafleft+gs_ds_w,			-gs_ds_pr-gs_ds_thk+jp,         1+32,
					leafleft+gs_ds_w,			-gs_ds_pr+jp,             1+32,
					leafleft,					-gs_ds_pr+jp,                 1+32,
					leafleft, jp,                    -1
			else

				poly2_b 12, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
					-A/2,						jp,							1+32,
					-A/2 + gs_frw1,				jp,							1+32,
					-A/2 + gs_frw1,				-gs_ds_pr + jp,				1+32,
					-A/2 + gs_frw1 + gs_ds_w,	-gs_ds_pr + jp,				1+32,
					-A/2 + gs_frw1 + gs_ds_w,	-gs_ds_pr - gs_ds_thk + jp,	1+32,
					-A/2 + gs_frw1,				-gs_ds_pr - gs_ds_thk + jp,	1+32,
					-A/2 + gs_frw1,				-gs_frame_thk - jp,			1+32,
					-A/2,						-gs_frame_thk - jp,			1+32,
					-A/2,						-gs_frame_thk,				bListView+32,
					-A/2 - gs_fcr * gs_tolerance_left,	-gs_frame_thk,		_frame_left_endline+32,
					-A/2 - gs_fcr * gs_tolerance_left,	 0,					bListView+32,
					-A/2,								 0,					1+32
			endif

			if gs_sidelight_right then
				poly2_b 8, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
					A/2-gs_sl_w2+gs_frw_Sl_right, 	jp,						1+32,
					A/2-gs_sl_w2,					jp,						1+32,
					A/2-gs_sl_w2,					-gs_ds_pr+jp,			1+32,
					A/2-gs_sl_w2-gs_ds_w,			-gs_ds_pr+jp,			1+32,
					A/2-gs_sl_w2-gs_ds_w,			-gs_ds_pr-gs_ds_thk+jp,	1+32,
					A/2-gs_sl_w2,					-gs_ds_pr-gs_ds_thk+jp,	1+32,
					A/2-gs_sl_w2,					-gs_frame_thk-jp,			1+32,
					A/2-gs_sl_w2+gs_frw_Sl_right,	-gs_frame_thk-jp,			1+32

				poly2_b 8, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
					A/2-gs_frw2, 										jp,         1+32,
					A/2-gs_frw2+gs_frw2, jp,                  1+32,
					A/2-gs_frw2+gs_frw2, 								0,          0+32,
					A/2-gs_frw2+gs_fcr*(gs_frw2+gs_tolerance_right), 	0, 			0+32,
					A/2-gs_frw2+gs_fcr*(gs_frw2+gs_tolerance_right), -gs_frame_thk,	0+32,
					A/2-gs_frw2+gs_frw2,							   -gs_frame_thk,  	1+32,
					A/2-gs_frw2+gs_frw2,-gs_frame_thk-jp,               1+32,
					A/2-gs_frw2,-gs_frame_thk-jp,                 1+32
			else
				poly2_b 12, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
					A/2-gs_frw2, 										jp,         1+32,
					A/2-gs_frw2+gs_frw2, jp,                  1+32,
					A/2-gs_frw2+gs_frw2, 								0,          bListView+32,
					A/2-gs_frw2+gs_fcr*(gs_frw2+gs_tolerance_right), 	0, 			_frame_right_endline+32,
					A/2-gs_frw2+gs_fcr*(gs_frw2+gs_tolerance_right), -gs_frame_thk,	bListView+32,
					A/2-gs_frw2+gs_frw2,							   -gs_frame_thk,  	1+32,
					A/2-gs_frw2+gs_frw2,-gs_frame_thk-jp,               1+32,
					A/2-gs_frw2,-gs_frame_thk-jp,                 1+32,
					A/2-gs_frw2,-gs_ds_pr-gs_ds_thk+jp,             1+32,
					A/2-gs_frw2-gs_ds_w,-gs_ds_pr-gs_ds_thk+jp,         1+32,
					A/2-gs_frw2-gs_ds_w,-gs_ds_pr+jp,             1+32,
					A/2-gs_frw2,-gs_ds_pr+jp,                 1+32
			endif
		endif
	endif


	if gs_frame_style_m = FRAME_STYLE_DOUBLE_EGRESS_METAL then		! Double Egress Metal Frame

		fill gs_fillFr

		add2 frameDiff, 0

		poly2_b 12, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
			leafleft + gs_rebate_width,				gs_unit_extra_thk,				1+32,
			leafleft + gs_rebate_width - gs_frw1,	gs_unit_extra_thk,				1+32,
			leafleft + gs_rebate_width - gs_frw1, 	0,								bListView+32,
			leafleft + gs_rebate_width - gs_frw1 - gs_tolerance_left,	0, 			_frame_left_endline+32,
			leafleft + gs_rebate_width - gs_frw1 - gs_tolerance_left,	-gs_frame_thk,	bListView+32,
			leafleft + gs_rebate_width - gs_frw1,	-gs_frame_thk,  						1+32,
			leafleft + gs_rebate_width - gs_frw1,	-gs_frame_thk-gs_unit_extra_thk,		1+32,
			leafleft - gs_rebate_width,				-gs_frame_thk-gs_unit_extra_thk,		1+32,
			leafleft - gs_rebate_width,				-gs_frame_thk + posLeafy,					1+32,
			leafleft,								-gs_frame_thk + posLeafy,					1+32,
			leafleft,								-gs_frame_thk + posLeafy+ gs_leaf_thk,	1+32,
			leafleft + gs_rebate_width,				-gs_frame_thk + posLeafy+ gs_leaf_thk,	1+32

		poly2_b 12, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
			leafright + gs_rebate_width,			gs_unit_extra_thk,				1+32,
			leafright - gs_rebate_width + gs_frw2,	gs_unit_extra_thk,				1+32,
			leafright - gs_rebate_width + gs_frw2, 	0,								bListView+32,
			leafright - gs_rebate_width + gs_frw2 + gs_tolerance_right,	0, 			_frame_right_endline+32,
			leafright - gs_rebate_width + gs_frw2 + gs_tolerance_right,	-gs_frame_thk,	bListView+32,
			leafright - gs_rebate_width + gs_frw2,	-gs_frame_thk,  						1+32,
			leafright - gs_rebate_width + gs_frw2,	-gs_frame_thk-gs_unit_extra_thk,		1+32,
			leafright - gs_rebate_width,			-gs_frame_thk-gs_unit_extra_thk,		1+32,
			leafright - gs_rebate_width,			-gs_frame_thk + posLeafy,					1+32,
			leafright,								-gs_frame_thk + posLeafy,					1+32,
			leafright,								-gs_frame_thk + posLeafy + gs_leaf_thk,	1+32,
			leafright + gs_rebate_width,			-gs_frame_thk + posLeafy + gs_leaf_thk,	1+32

		del 1


	endif




	gosub 2500

endif


! =============================================================================
! Pockets
! =============================================================================
"PlacingPockets":

if gs_pocket then

	unID = 3400

	add2 (gs_tolerance_right - gs_tolerance_left)/2, 0

	if not(gs_pocket_door_frame) then
		gs_tolerance_left	= 0
		gs_tolerance_right	= 0
	endif

	if bDoubleDoor then
		if gs_usaframe then
			PocketWidth = ac_leaf_width/2-0.005
			if gs_pocket_door_frame then PocketWidth = ac_leaf_width/2 - gs_frame_width_right-0.005
		else
			if bPocketWidthOverride then
				PocketWidth = gs_pocket_width/2 - (ac_egress_width/2 + gs_frame_width_right) * gs_pocket_door_frame - ac_wallhole_width/2 * not(gs_pocket_door_frame)
			else
				PocketWidth = ac_wallhole_width/2
				if gs_pocket_door_frame then PocketWidth = ac_egress_width/2 - gs_frame_width_right
			endif
		endif
	else
		if gs_usaframe then
			PocketWidth = ac_leaf_width-0.005
			if gs_pocket_door_frame then PocketWidth = ac_leaf_width - gs_frame_width_right-0.005
		else
			if bPocketWidthOverride then
				PocketWidth = gs_pocket_width - (A + gs_tolerance_left) * gs_pocket_door_frame - ac_wallhole_width * not(gs_pocket_door_frame)
			else
				PocketWidth = ac_wallhole_width
				if gs_pocket_door_frame then PocketWidth = ac_egress_width - gs_frame_width_right
			endif
		endif
	endif
	PocketWidth = PocketWidth - (gs_tolerance_right - (gs_pocket_frame * gs_pocket_frame_thk) + gs_right_oversize) * (lod2D = DET2D_FS_SIMPLE)
	add2 - (gs_tolerance_right) * (lod2D <> DET2D_FS_SIMPLE) + gs_right_oversize * (lod2D = DET2D_FS_SIMPLE), 0

	_ActReveal_width = gs_reveal_right
	gosub "Pocket"
	del 1

	if bDoubleDoor then
		if gs_usaframe then
			PocketWidth = ac_leaf_width/2-0.005
			if gs_pocket_door_frame then PocketWidth = ac_leaf_width/2 - gs_frame_width_left-0.005
		else
			if bPocketWidthOverride then
				PocketWidth = gs_pocket_width/2 - (ac_egress_width/2 + gs_frame_width_left) * gs_pocket_door_frame - ac_wallhole_width/2 * not(gs_pocket_door_frame)
			else
				PocketWidth = ac_wallhole_width/2
				if gs_pocket_door_frame then PocketWidth = ac_egress_width/2 - gs_frame_width_left
			endif
		endif
		PocketWidth = PocketWidth - (gs_tolerance_left - (gs_pocket_frame * gs_pocket_frame_thk) + gs_left_oversize) * (lod2D = DET2D_FS_SIMPLE)

		mul2 -1,1
		add2 - (gs_tolerance_left) * (lod2D <> DET2D_FS_SIMPLE) + gs_left_oversize * (lod2D = DET2D_FS_SIMPLE), 0
		_ActReveal_width = gs_reveal_left
		gosub "Pocket"
		del 2
	endif

	del 1
endif




end



! =============================================================================
! Middle Frame (USA)
! =============================================================================

2500:

fill gs_fillFr

if gs_mf then

	if gs_frame_style_m = FRAME_STYLE_BLOCK or gs_frame_style_m = FRAME_STYLE_DOUBLE_REBATE or (symb_2d = 100 and gs_frame_style_m = FRAME_STYLE_SIMPLE_REBATE) then
		add2 A/2-gs_mf_pos, 0
		poly2_b 4, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
			-gs_mf_w/2,	 0,			1+32,
			-gs_mf_w/2,	-gs_frame_thk,	1+32,
			 gs_mf_w/2,	-gs_frame_thk,	1+32,
			 gs_mf_w/2,	 0,			1+32
		del 1
	else
		add2 A/2-gs_mf_pos, 0
		poly2_b 8, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
			-gs_mf_w/2+gs_rebate_width,	 0,				1+32,
			-gs_mf_w/2+gs_rebate_width,	-gs_leaf_thk,	1+32,
			-gs_mf_w/2,					-gs_leaf_thk,	1+32,
			-gs_mf_w/2,					-gs_frame_thk,		1+32,
			 gs_mf_w/2,					-gs_frame_thk,		1+32,
			 gs_mf_w/2,					-gs_leaf_thk,	1+32,
			 gs_mf_w/2-gs_rebate_width,	-gs_leaf_thk,	1+32,
			 gs_mf_w/2-gs_rebate_width,	 0,				1+32
		del 1
	endif

	if gs_frame_style_m = FRAME_STYLE_DOUBLE_REBATE and symb_2d = 50 then
		add2 0, (gs_leaf_thk-gs_ds_pr)*(abs(gs_ds_pr)>eps)

		poly2_b 4, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
			A/2-gs_mf_pos-gs_mf_w/2-gs_ds_w,	-gs_leaf_thk,			1+32,
			A/2-gs_mf_pos-gs_mf_w/2-gs_ds_w,	-gs_leaf_thk-gs_ds_thk,	1+32,
			A/2-gs_mf_pos-gs_mf_w/2,			-gs_leaf_thk-gs_ds_thk,	1+32,
			A/2-gs_mf_pos-gs_mf_w/2,			-gs_leaf_thk,			1+32

		poly2_b 4, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
			A/2-gs_mf_pos+gs_mf_w/2+gs_ds_w,	-gs_leaf_thk,			1+32,
			A/2-gs_mf_pos+gs_mf_w/2+gs_ds_w,	-gs_leaf_thk-gs_ds_thk,	1+32,
			A/2-gs_mf_pos+gs_mf_w/2,			-gs_leaf_thk-gs_ds_thk,	1+32,
			A/2-gs_mf_pos+gs_mf_w/2,			-gs_leaf_thk,			1+32

		del 1
	endif
endif

return


! =============================================================================
! Pocket for Pocket Doors
! =============================================================================

"Pocket":


add2 ac_wallhole_width/2, 0

if gs_pocket_frame & symb_2d <= 100 then
	fill gs_fgs_fillFr
	pen gs_frame_pen_cont

	hotspot2 0,											-posLeafy + gs_pocket_frame_thk, 				unID: unID = unID+1
	hotspot2 0,											-posLeafy - widthWallCut - gs_pocket_frame_thk, unID: unID = unID+1
	hotspot2 PocketWidth + 0.005 + gs_pocket_frame_thk,	-posLeafy - widthWallCut - gs_pocket_frame_thk, unID: unID = unID+1
	hotspot2 PocketWidth + 0.005 + gs_pocket_frame_thk,	-posLeafy + gs_pocket_frame_thk, 				unID: unID = unID+1

	if bShowUnitHotspots & gs_pocket & (GLOB_CONTEXT = 4 | GLOB_CONTEXT = 6) then
		hotspot2 -ac_unit_width,								-posLeafy - widthWallCut/2,	unID: unID = unID+1
		hotspot2 PocketWidth + 0.005 + gs_pocket_frame_thk,		-posLeafy - widthWallCut/2,	unID: unID = unID+1
	endif

	poly2_b 8, 1+2+4+32, gs_penFr_fg, gs_penFr_bg,
		0,											-posLeafy + gs_pocket_frame_thk,				1+32,
		0,											-posLeafy,										1+32,
		PocketWidth + 0.005,						-posLeafy,										1+32,
		PocketWidth + 0.005,						-posLeafy - widthWallCut,						1+32,
		0,											-posLeafy - widthWallCut,						1+32,
		0,											-posLeafy - widthWallCut - gs_pocket_frame_thk,	1+32,
		PocketWidth + 0.005 + gs_pocket_frame_thk,	-posLeafy - widthWallCut - gs_pocket_frame_thk,	1+32,
		PocketWidth + 0.005 + gs_pocket_frame_thk,	-posLeafy + gs_pocket_frame_thk,				1+32

	if gs_usaframe then
		pen WALL_SECT_PEN
	else
		pen gs_frame_pen_cont
	endif
	if gs_bFills then fill gs_wallhole_fill
	wallhole2 4, 2, gs_wallhole_pen_fg, gs_wallhole_pen_bg,
		0, 0, 0,
		0,											-posLeafy + gs_pocket_frame_thk,				1,
		0,											-posLeafy - widthWallCut - gs_pocket_frame_thk,	1,
		PocketWidth + 0.005 + gs_pocket_frame_thk,	-posLeafy - widthWallCut - gs_pocket_frame_thk,	1,
		PocketWidth + 0.005 + gs_pocket_frame_thk,	-posLeafy + gs_pocket_frame_thk,				1

else
	if (gs_usaframe & GLOB_CONTEXT = 6) then
		hotspot2 0,						-posLeafy, 					unID: unID = unID+1
		hotspot2 0,						-posLeafy - widthWallCut,	unID: unID = unID+1
		hotspot2 PocketWidth + 0.005,	-posLeafy - widthWallCut,	unID: unID = unID+1
		hotspot2 PocketWidth + 0.005,	-posLeafy, 					unID: unID = unID+1

		if bShowUnitHotspots & gs_pocket & (GLOB_CONTEXT = 4 | GLOB_CONTEXT = 6) & not(bDoubleDoor) then
			hotspot2 -ac_wallhole_width + gs_tolerance_left,-posLeafy - widthWallCut/2,	unID: unID = unID+1
			hotspot2 PocketWidth + 0.005,					-posLeafy - widthWallCut/2,	unID: unID = unID+1
		endif
		pen gs_frame_pen_cont

		line2	0, 					-posLeafy,					PocketWidth + 0.005, 	-posLeafy
		line2	PocketWidth + 0.005,-posLeafy,					PocketWidth + 0.005,	-posLeafy - widthWallCut
		line2	0, 					-posLeafy - widthWallCut,	PocketWidth + 0.005, 	-posLeafy - widthWallCut
	endif

	pen WALL_SECT_PEN

	if gs_bFills then fill gs_wallhole_fill
	wallhole2 5, 2, gs_wallhole_pen_fg, gs_wallhole_pen_bg,
		0, 0, 0,
		0, 						-posLeafy, 1,
		0, 						-posLeafy - widthWallCut, 1,
		PocketWidth + 0.005,	-posLeafy - widthWallCut, 1,
		PocketWidth + 0.005,	-posLeafy, 1,
		0,						-posLeafy, -1

	wallline2 -_ActReveal_width,	-posLeafy, PocketWidth + 0.005,	-posLeafy
	wallline2 PocketWidth + 0.005,	-posLeafy, PocketWidth + 0.005,	-posLeafy - widthWallCut
	wallline2 PocketWidth + 0.005,	-posLeafy - widthWallCut,	0,	-posLeafy - widthWallCut
endif

del 1

return


! =============================================================================
! Frame Symbol at Bottom
! =============================================================================

"frame symbol at bottom":

	fill gs_fillFr

	bottomSymbolPosLeftX	= -A/2 + gs_sl_w1
	bottomSymbolPosRightX	= A/2 - gs_sl_w2

	line2	bottomSymbolPosLeftX - gs_rebate_width * (gs_frame_style_m = 3) * (symb_2d = 50), 0,
			bottomSymbolPosRightX + gs_rebate_width * (gs_frame_style_m = 3) * (symb_2d = 50), 0
	line2 bottomSymbolPosLeftX, -outsideFrameThk, bottomSymbolPosRightX, -outsideFrameThk

return





]]>
</Script_2D>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_1D SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[
EPS = 0.0001

DET2D_FS_OFF			= 0
DET2D_FS_SCALESENS		= -1
DET2D_FS_SIMPLE			= 11
DET2D_FS_MIDDLE			= 21
DET2D_FS_DETAILED		= 30
DET2D_FS_SIMPLE_CHI		= 51
DET2D_FS_DETAILED_CHI	= 52

! iLoD2D
SYMBD_OFF							= 0
SYMBD_SCALESENS						= 1
SYMBD_S_1LINE						= 11
SYMBD_S_2LINE						= 12
SYMBD_S_1LINE_FRAME					= 13
SYMBD_S_1LINECL						= 14
SYMBD_S_5							= 15
SYMBD_S_6							= 16
SYMBD_S_7							= 17
SYMBD_S_8							= 18
SYMBD_S_9							= 19
SYMBD_M_1LINELEAF_2LINE				= 21
SYMBD_M_2LINELEAFCL_GLASS			= 22
SYMBD_M_1LINELEAF_1LINE				= 23
SYMBD_M_4							= 24
SYMBD_M_5							= 25
SYMBD_M_6							= 26
SYMBD_M_7							= 27
SYMBD_M_8							= 28
SYMBD_M_9							= 29
SYMBD_D_2LINELEAFOP_GLASS			= 31
SYMBD_D_2LINELEAFCL_REBATEONGLASS	= 32
SYMBD_D_2LINELEAFOP_2LINE			= 33
SYMBD_D_2LINELEAFOP_SASH			= 34
SYMBD_D_1LINELEAF_GLASS				= 35
SYMBD_D_2LINELEAFCL_SASHWLINE		= 36
SYMBD_D_1LINELEAF_SASHWLINE			= 37
SYMBD_D_2LEAFOPGLASS_GLASS			= 38
SYMBD_D_9							= 39

! iWindowShape:
SHAPE_RECTANGULAR			= 0
SHAPE_ARCHED				= 1
SHAPE_ROUND					= 2
SHAPE_EYEBROWS				= 3
SHAPE_HALFCIRCLE			= 4 	! straight side is horizontal
SHAPE_MULTISIDE				= 5
SHAPE_OCTAGONAL				= 6
SHAPE_HALFARCH				= 7
SHAPE_PENTAGON				= 8
SHAPE_QUARTERROUND			= 9
SHAPE_HALFROUND				= 10 	! straight side is vertical
SHAPE_TRAPEZOID				= 11
SHAPE_TRIANGLE				= 12
SHAPE_GOTHICARCH			= 13
SHAPE_ELLIPSEARCH			= 14
SHAPE_ROMBUS				= 15
SHAPE_HORSESHOE				= 16
SHAPE_OGEECENTERED			= 17
SHAPE_SARACENIC				= 18
SHAPE_T						= 19
SHAPE_HALF_T_LEFT			= 20
SHAPE_ARCHED_T				= 21
SHAPE_ARCHED_HALF_T_LEFT	= 22
SHAPE_PARALLELOGRAM			= 23
SHAPE_ELLIPSE				= 24
SHAPE_CORNER_TRIANGLE		= 25
SHAPE_QUARTERROUND_NOFRAME	= 26
SHAPE_HALF_T_RIGHT			= 27
SHAPE_ARCHED_HALF_T_RIGHT	= 28

! iMullionStyle:
MULLION_NONE			= 1
MULLION_HVGRID			= 2
MULLION_EDITABLEGRID	= 3
MULLION_CUSTOM			= 4
MULLION_PRAIRIE			= 5
MULLION_DIVIDED			= 6
MULLION_SUNBURST_1		= 7
MULLION_SUNBURST_2		= 8
MULLION_SUNBURST_3		= 9
MULLION_SUNBURST_4		= 10
MULLION_SUNBURST_5		= 11
MULLION_SUNBURST_6		= 12
MULLION_SOLID_GLAZED	= 13
MULLION_DIVIDED_FRAME	= 14
MULLION_SOLID_PANEL		= 15
MULLION_VENT_PANEL		= 16
MULLION_FRENCH_PANEL	= 17

! gs_optype_m:
SASH_FIXED					= 1		! Fixed Glass
SASH_FIXED_SCREW			= 2		! Fixed Sash
SASH_SIDE_HUNG				= 3		! Side Hung
SASH_SIDE_HUNG_M			= 4		! Side Hung Mirrored
SASH_TILT_TURN				= 5		! Tilt and Turn
SASH_TILT_TURN_M			= 6		! Tilt and Turn Mirrored
SASH_BOTTOM_HUNG			= 7		! Bottom Hung
SASH_TOP_HUNG				= 8		! Top Hung
SASH_HOR_PIVOT				= 9		! Horizontal Pivot Hung
SASH_VER_PIVOT				= 10	! Vertical Pivotted
SASH_TILT_SLIDE				= 11	! Tilt and Slide
SASH_LEFT_SLIDING			= 12	! Left Sliding
SASH_RIGHT_SLIDING			= 13	! Right Sliding
SASH_UP_SLIDING				= 14	! Sliding Up
SASH_DOWN_SLIDING			= 15	! Sliding Down
SASH_VER_PIVOT_M			= 16	! Vertical Pivotted Mirrored
SASH_FIXED_SLIDE			= 17	! Fixed Sliding Sash
SASH_DOUBLE_SIDE_HUNG		= 18	! Double Sash
SASH_DOUBLE_TILT_TURN		= 19	! Double Tilt and Turn
SASH_DOUBLE_TILT_TURN_M		= 20	! Double Tilt and Turn Mirrored
SASH_SLIDING_HOR			= 21	! Sliding
SASH_SLIDING_HOR_M			= 22	! Sliding Mirrored
SASH_DOUBLE_SLIDING_HOR		= 23	! Double Sliding
SASH_DOUBLE_SLIDING_HOR_M	= 24	! Double Sliding Mirrored
SASH_SLIDING_VER			= 25	! Single Hung
SASH_DOUBLE_SLIDING_VER		= 26	! Double Hung

! gs_leaf_optype_m:
LEAF_1L_SIDE_HUNG			= 1
LEAF_1L_SIDE_HUNG_M			= 2
LEAF_1L_DOUBLE_ACTING		= 3
LEAF_1L_DOUBLE_ACTING_M		= 4
LEAF_2L_SIDE_HUNG			= 5
LEAF_2L_DOUBLE_ACTING		= 6
LEAF_2L_DOUBLE_EGRESS		= 7
LEAF_2L_DOUBLE_EGRESS_M		= 8
LEAF_1L_PIVOT				= 9
LEAF_1L_PIVOT_M				= 10
LEAF_2L_1SLIDING			= 11
LEAF_2L_1SLIDING_M			= 12
LEAF_2L_2SLIDING			= 13
LEAF_2L_2SLIDING_M			= 14
LEAF_3L_2SLIDING			= 15
LEAF_3L_2SLIDING_M			= 16
LEAF_4L_2SLIDING			= 17
LEAF_4L_3SLIDING			= 18
LEAF_4L_3SLIDING_M			= 19
LEAF_4L_4SLIDING			= 20
LEAF_4L_4SLIDING_M			= 21
LEAF_1L_EXTERNAL_SLIDING	= 22
LEAF_1L_EXTERNAL_SLIDING_M	= 23
LEAF_2L_EXTERNAL_SLIDING	= 24
LEAF_1L_POCKET				= 25
LEAF_1L_POCKET_M			= 26
LEAF_2L_POCKET				= 27
LEAF_1L_MULTIPANEL			= 28
LEAF_1L_MULTIPANEL_M		= 29
LEAF_2L_MULTIPANEL			= 30
LEAF_REVOLVING				= 31
LEAF_3L_2SLIDING_CENTER		= 32
LEAF_GAR_1L_UP_AND_OVER		= 100
LEAF_GAR_1L_UP_SLIDING		= 101
LEAF_GAR_1L_SECTIONAL		= 102
LEAF_GAR_2L_SIDE_HUNG		= 103
LEAF_GAR_2L_ROLLSIDE		= 104
LEAF_GAR_1L_ROLLUP			= 105

! gs_frame_style_m
FRAME_STYLE_BLOCK				= 1
FRAME_STYLE_DOUBLE_REBATE		= 2
FRAME_STYLE_SIMPLE_REBATE		= 3
FRAME_STYLE_METAL				= 4
FRAME_STYLE_DOUBLE_EGRESS_METAL = 5
FRAME_STYLE_EXTRUSION			= 6
FRAME_STYLE_WRAPPED_EXTRUSION	= 7 

! iSimpleSashFrameType
SIMPLESASH_NONE			= -1
SIMPLESASH_NORMAL		= 0
SIMPLESASH_SIDEHUNG		= 1
SIMPLESASH_SLIDEHOR		= 2
SIMPLESASH_SLIDEVER		= 3

if abs(gs_frame_width_left_2)<EPS then gs_frame_width_left_2 = gs_frwm
if abs(gs_frame_width_right_2)<EPS then gs_frame_width_right_2 = gs_frwm
if abs(gs_frame_width_low_left_sl)<EPS then gs_frame_width_low_left_sl = gs_frwm
if abs(gs_frame_width_low_right_sl)<EPS then gs_frame_width_low_right_sl = gs_frwm
if abs(gs_frame_width_transom)<EPS then gs_frame_width_transom = gs_frwm

gs_frw_Sl_left = gs_frame_width_left_2
gs_frw_Sl_right = gs_frame_width_right_2
gs_frw_SlParapet_left = gs_frame_width_left_2
gs_frw_SlParapet_right = gs_frame_width_right_2

! ------------------------------------------------------------------------------
! Frame Rebate to NED Metal Frames
! ------------------------------------------------------------------------------

if gs_frame_style_m = FRAME_STYLE_WRAPPED_EXTRUSION then
	frameRebateWidth		= gs_frame_oversize
	frameRebateOffset		= gs_frame_oversize_thk
	A						= A + 2*gs_frame_oversize
	B						= B + gs_frame_oversize
	ac_unit_width			= ac_unit_width + 2*gs_frame_oversize
	ac_unit_height			= ac_unit_height + gs_frame_oversize
	gs_frw1					= gs_frw1 + gs_frame_oversize
	gs_frw2					= gs_frw2 + gs_frame_oversize
	gs_frwt					= gs_frwt + gs_frame_oversize
	gs_frw_SlParapet_left	= gs_frw_SlParapet_left + gs_frame_oversize
	gs_frw_SlParapet_right	= gs_frw_SlParapet_right + gs_frame_oversize
	gs_sl_w1				= gs_sidelight_width_left + gs_frame_oversize
	gs_sl_w2				= gs_sidelight_width_right + gs_frame_oversize
	if gs_sidelight_parapet_hgt_left > EPS then
		gs_sidelight_parapet_hgt_left	= gs_sidelight_parapet_hgt_left - gs_frame_oversize + gs_tolerance_low_left_sl
		gs_frame_width_low_left_sl		= gs_frame_width_low_left_sl + gs_frame_oversize
	endif
	if gs_sidelight_parapet_hgt_right > EPS then
		gs_sidelight_parapet_hgt_right	= gs_sidelight_parapet_hgt_right - gs_frame_oversize + gs_tolerance_low_right_sl
		gs_frame_width_low_right_sl		= gs_frame_width_low_right_sl + gs_frame_oversize
	endif
	_transomHeight		= gs_transom_height + gs_frame_oversize
else
	frameRebateWidth	= 0.01
	frameRebateOffset	= 0.01
	gs_frame_oversize	= 0
	gs_sl_w1			= gs_sidelight_width_left
	gs_sl_w2			= gs_sidelight_width_right
	_transomHeight		= gs_transom_height
endif


LeftSLParapet = 0
if iWindowShape = SHAPE_T | iWindowShape = SHAPE_ARCHED_T | \
iWindowShape = SHAPE_HALF_T_LEFT | iWindowShape = SHAPE_ARCHED_HALF_T_LEFT then LeftSLParapet = gs_sidelight_parapet_hgt_left

RightSLParapet = 0
if iWindowShape = SHAPE_T | iWindowShape = SHAPE_ARCHED_T | \
iWindowShape = SHAPE_HALF_T_RIGHT | iWindowShape = SHAPE_ARCHED_HALF_T_RIGHT then RightSLParapet = gs_sidelight_parapet_hgt_right

if	iWindowShape = SHAPE_ARCHED					|\
	iWindowShape = SHAPE_ARCHED_T				|\
	iWindowShape = SHAPE_ARCHED_HALF_T_LEFT		|\
	iWindowShape = SHAPE_ARCHED_HALF_T_RIGHT	then

	bArchedTop = 1
else
	bArchedTop = 0
endif

gs_tolerance_low_left_sl = gs_tolerance_low_left_sl * (LeftSLParapet>0)
gs_tolerance_low_right_sl = gs_tolerance_low_right_sl * (RightSLParapet>0)


!******** frame sizes

if not(gs_sidelight_left) then
	gs_sl_w1 = gs_frw1
endif
if not(gs_sidelight_right) then
	gs_sl_w2 = gs_frw2
endif


comy = 0
if gs_frame_style_m = FRAME_STYLE_METAL then		! Commercial door USA
	if gs_frame_wthk then comy = 1/2"
endif
if gs_frame_style_m = FRAME_STYLE_DOUBLE_EGRESS_METAL then		! D2 Double Egress Metal Door USA
	if gs_frame_wthk then comy = gs_unit_extra_thk
endif

gs_pocket	=	gs_leaf_optype_m = LEAF_1L_POCKET |\
				gs_leaf_optype_m = LEAF_1L_POCKET_M |\
				gs_leaf_optype_m = LEAF_2L_POCKET
gs_pocket_door_frame = gs_pocket_door_frame & gs_pocket

bDoubleDoor = (gs_leaf_optype_m = LEAF_2L_POCKET)

posLeafy = 0
if gs_usaframe then
	slidingGap = 1/4" * (gs_rail_pos_m > 0)
	widthWallCut = gs_leaf_thk + slidingGap * 2
	posHole = slidingGap
else
	widthWallCut = gs_leaf_thk +  0.005 * 2
	posHole = 0.005
endif

if gs_pocket_door_frame then
	if gs_leaf_center then
		posLeafy = (gs_fthk - widthWallCut)/2
	else
		posLeafy = gs_leaf_offset
	endif
else
	if gs_frame_style_m = FRAME_STYLE_DOUBLE_EGRESS_METAL then
		posLeafy = (gs_fthk - gs_leaf_thk) / 2
	endif
endif

]]>
</Script_1D>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_PR SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_PR>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_UI SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_UI>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_VL SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[
if gs_frame_thk < 0 then
	gs_frame_thk = 0
	parameters gs_frame_thk = 0
endif

if gs_frame_style_m = FRAME_STYLE_WRAPPED_EXTRUSION then
	lock "gs_frame_wthk"
endif

if not(gs_frame_wthk) | ((gs_sidelight_left | gs_sidelight_right | gs_door_transom) & gs_opening_dir_SL_m <> 1) then
	lock "gs_sframe"
	gs_sframe = 1
	parameters gs_sframe = 1
endif

if gs_sframe | not(gs_frame_wthk) then
	lock "gs_frame_thkin"
	hideparameter "gs_frame_thkin"
else
	if gs_frame_thkin < 0 then
		gs_frame_thkin = 0
		parameters gs_frame_thkin = 0
	endif
	if gs_frame_thkin > gs_frame_thk then
		gs_frame_thkin = gs_frame_thk
		parameters gs_frame_thkin = gs_frame_thk
	endif
endif

if gs_frame_width < 0 then
	gs_frame_width = 0
	parameters gs_frame_width = gs_frame_width
endif

if bArchedTop & not(gs_door_transom | (gs_sidelight_right & gs_sidelight_parapet_hgt_right > EPS) | (gs_sidelight_left & gs_sidelight_parapet_hgt_left > EPS)) then
	gs_uniform_framewidth = 1
	parameters gs_uniform_framewidth = 1
	lock "gs_uniform_framewidth"
	hideparameter "gs_uniform_framewidth"
endif

if gs_uniform_framewidth then
	lock	"gs_frame_width_left",
			"gs_frame_width_left_2",
			"gs_frame_width_low_left_sl",
			"gs_frame_width_right",
			"gs_frame_width_right_2",
			"gs_frame_width_low_right_sl",
			"gs_frame_width_upper",
			"gs_frame_width_transom"

	hideparameter	"gs_frame_width_left",
					"gs_frame_width_left_2",
					"gs_frame_width_low_left_sl",
					"gs_frame_width_right",
					"gs_frame_width_right_2",
					"gs_frame_width_low_right_sl",
					"gs_frame_width_upper",
					"gs_frame_width_transom"
else
	lock "gs_frame_width"
	hideparameter "gs_frame_width"

	if not(gs_sidelight_right) then
		lock	"gs_frame_width_right_2",
				"gs_frame_width_low_right_sl"

		hideparameter	"gs_frame_width_right_2",
						"gs_frame_width_low_right_sl"
	endif

	if bArchedTop then
		lock	"gs_frame_width_left",
				"gs_frame_width_upper"

		hideparameter	"gs_frame_width_left",
						"gs_frame_width_upper"
	endif

	if gs_frame_width_left < 0 then
		gs_frame_width_left = 0
		parameters gs_frame_width_left = gs_frame_width_left
	endif
	if gs_frame_width_left_2 < 0 then
		gs_frame_width_left_2 = 0
		parameters gs_frame_width_left_2 = gs_frame_width_left_2
	endif
	if gs_frame_width_low_left_sl < 0 then
		gs_frame_width_low_left_sl = 0
		parameters gs_frame_width_low_left_sl = gs_frame_width_low_left_sl
	endif
	if gs_frame_width_right < 0 then
		gs_frame_width_right = 0
		parameters gs_frame_width_right = gs_frame_width_right
	endif
	if gs_frame_width_right_2 < 0 then
		gs_frame_width_right_2 = 0
		parameters gs_frame_width_right_2 = gs_frame_width_right_2
	endif
	if gs_frame_width_low_right_sl < 0 then
		gs_frame_width_low_right_sl = 0
		parameters gs_frame_width_low_right_sl = gs_frame_width_low_right_sl
	endif
	if gs_frame_width_upper < 0 then
		gs_frame_width_upper = 0
		parameters gs_frame_width_upper = gs_frame_width_upper
	endif
	if gs_frame_width_transom < 0 then
		gs_frame_width_transom = 0
		parameters gs_frame_width_transom = gs_frame_width_transom
	endif
endif

if gs_rebate_width < 0 then
	gs_rebate_width = 0
	parameters gs_rebate_width = gs_rebate_width
endif
if gs_sidelight_rebate_width < 0 then
	gs_sidelight_rebate_width = 0
	parameters gs_sidelight_rebate_width = gs_sidelight_rebate_width
endif
if gs_sidelight_rebate_depth < 0 then
	gs_sidelight_rebate_depth = 0
	parameters gs_sidelight_rebate_depth = gs_sidelight_rebate_depth
endif
if gs_frame_thk < EPS then
	gs_frame_thk = EPS
	parameters gs_frame_thk = gs_frame_thk
endif

if	(GLOB_MODPAR_NAME = "gs_leaf_optype" 	|\
	GLOB_MODPAR_NAME = "gs_leaf_optype_m")	&\
	(gs_leaf_optype_m = LEAF_2L_1SLIDING	|\
	gs_leaf_optype_m = LEAF_2L_2SLIDING 	|\
	gs_leaf_optype_m = LEAF_3L_2SLIDING 	|\
	gs_leaf_optype_m = LEAF_4L_2SLIDING 	|\
	gs_leaf_optype_m = LEAF_4L_3SLIDING 	|\
	gs_leaf_optype_m = LEAF_4L_4SLIDING)	then

	numLeaf = 2 + (gs_leaf_optype_m = LEAF_3L_2SLIDING) + ((gs_leaf_optype_m = LEAF_4L_3SLIDING) * 2)

	if gs_frame_thk < (gs_leaf_thk * numLeaf) - eps then
		gs_frame_thk = (gs_leaf_thk * numLeaf)
		parameters gs_frame_thk = gs_frame_thk
	endif
endif

if not(bEnableLeafRebateDepth3D) then
	hideparameter "gs_rebate_depth_3D"
	lock "gs_rebate_depth_3D"
endif

if bEnableLeafRebateDepth3D then
	if gs_frame_style_m = FRAME_STYLE_DOUBLE_REBATE then
		values "gs_rebate_depth_3D" range [gs_leaf_thk, gs_frame_thk - gs_ds_thk]
	else
		if gs_frame_style_m = FRAME_STYLE_BLOCK then
			values "gs_rebate_depth_3D" range [gs_leaf_thk, gs_frame_thk]
		else
			values "gs_rebate_depth_3D" range [gs_leaf_thk, gs_frame_thk)
		endif
	endif
endif

! =============================================================================
! Sidelight and Transom related parameters
! =============================================================================

if not(gs_sidelight_left | gs_sidelight_right | gs_door_transom) then
	lock "gs_sframe", "gs_frame_thkin", "gs_sidelight_rebate_width", "gs_sidelight_rebate_depth"
	hideparameter "gs_sframe", "gs_frame_thkin", "gs_sidelight_rebate_width", "gs_sidelight_rebate_depth"
endif

if not(gs_sidelight_left) then
	lock "gs_frame_width_left_2", "gs_frame_width_low_left_sl"
	hideparameter "gs_frame_width_left_2", "gs_frame_width_low_left_sl"
endif

if not(gs_sidelight_right) then
	lock "gs_frame_width_right_2", "gs_frame_width_low_right_sl"
	hideparameter "gs_frame_width_right_2", "gs_frame_width_low_right_sl"
endif

if not(gs_door_transom) then
	lock "gs_frame_width_transom"
	hideparameter "gs_frame_width_transom"
endif

if gs_sidelight_left & not(gs_bSidelight_fr_hdiv_left) then
	lock "gs_sidelight_fr_hdiv_hgt_left"
	hideparameter "gs_sidelight_fr_hdiv_hgt_left"
endif

if gs_sidelight_right & not(gs_bSidelight_fr_hdiv_right) then
	lock "gs_sidelight_fr_hdiv_hgt_right"
	hideparameter "gs_sidelight_fr_hdiv_hgt_right"
endif

if gs_sidelight_left & (not(gs_bSidelight_fr_hdiv_left) | gs_uniform_framewidth) then
	lock "gs_sidelight_fr_hdiv_wdt_left"
	hideparameter "gs_sidelight_fr_hdiv_wdt_left"
endif

if gs_sidelight_right & (not(gs_bSidelight_fr_hdiv_right) | gs_uniform_framewidth) then
	lock "gs_sidelight_fr_hdiv_wdt_right"
	hideparameter "gs_sidelight_fr_hdiv_wdt_right"
endif


! =============================================================================
! Zone Recognitions for Doors - Parapet wall Inset value calculation
! exeption: Sectional Garage Door,
!			Roll up and Roll Side Garage Doors
!			Empty Door Openings
!		GLOB_ELEVATION				- UNconditional - Zone`s always flowing
!		WIDO_REVEAL_SIDE			- conditional
!		REVEAL (WIDO_SILL)			- conditional
!		Sidelight Parapet Height	- conditional
!
! ParapetWallInset Values:	flowing: zero or more counting from the outside (reveal side)
!		-EPS < >= WALL_THICKNESS
! =============================================================================


ZONE_RECOGNITION_NONE 		= 0
ZONE_RECOGNITION_FULL 		= 1
ZONE_RECOGNITION_OUTSIDE 	= 2
ZONE_RECOGNITION_INSIDE 	= 3

_isZoneFlow = 1
if gs_sidelight_left and (gs_sidelight_parapet_hgt_left > EPS) then
	_isZoneFlow = 0
endif
if gs_sidelight_right and (gs_sidelight_parapet_hgt_right > EPS) then
	_isZoneFlow = 0
endif

if _isZoneFlow then
	! gs_slidingext - buggy behavior
	if	gs_leaf_optype_m = LEAF_1L_EXTERNAL_SLIDING | \
		gs_leaf_optype_m = LEAF_1L_EXTERNAL_SLIDING_M | \
		gs_leaf_optype_m = LEAF_2L_EXTERNAL_SLIDING then
		pwi = ZONE_RECOGNITION_OUTSIDE
	else
	! all others
		if WIDO_REVEAL_SIDE then
			pwi = ZONE_RECOGNITION_INSIDE
		else
			pwi = ZONE_RECOGNITION_OUTSIDE
		endif
	endif
else
	pwi = ZONE_RECOGNITION_NONE
endif
parameters pwi  = pwi

]]>
</Script_VL>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Comment SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Comment>

<ParamSection SectVersion="26" SectionFlags="0" SubIdent="0">
	<ParamSectHeader>
		<Version>26</Version>
		<AutoHotspots>false</AutoHotspots>
		<StatBits>
			<STBit_FixSize/>
		</StatBits>
		<WDLeftFrame>0</WDLeftFrame>
		<WDRightFrame>0</WDRightFrame>
		<WDTopFrame>0</WDTopFrame>
		<WDBotFrame>0</WDBotFrame>
		<LayFlags>65535</LayFlags>
		<WDMirrorThickness>0</WDMirrorThickness>
		<WDWallInset>0</WDWallInset>
		<SymbolColor>0</SymbolColor>
	</ParamSectHeader>
	<Parameters>
		<Length Name="A">
			<Description><![CDATA["Dimension 1"]]></Description>
			<Fix/>
			<Value>1</Value>
		</Length>
		<Length Name="B">
			<Description><![CDATA["Dimension 2"]]></Description>
			<Fix/>
			<Value>1</Value>
		</Length>
		<Length Name="ZZYZX">
			<Description><![CDATA["Height"]]></Description>
			<Fix/>
			<Value>1</Value>
		</Length>
		<Boolean Name="AC_show2DHotspotsIn3D">
			<Description><![CDATA["Show 2D Hotspots in 3D"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>1</Value>
		</Boolean>
		<Length Name="ac_bottomlevel">
			<Description><![CDATA["Bottom Level"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>1</Value>
		</Length>
		<Length Name="ac_toplevel">
			<Description><![CDATA["Top Level"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Integer Name="iWindowShape">
			<Description><![CDATA[""]]></Description>
			<Value>0</Value>
		</Integer>
		<Integer Name="pwi">
			<Description><![CDATA["Parapet Wall Inset Value"]]></Description>
			<Flags>
				<ParFlg_Unique/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Integer>

		<!-- gs_door_sizes: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="gs_door_sizes">
			<Description><![CDATA["Door Sizes"]]></Description>
		</Title>
		<Length Name="gs_shoulder_h">
			<Description><![CDATA["Shoulder Height"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1.8</Value>
		</Length>
		<Length Name="ac_wallhole_width">
			<Description><![CDATA["Wallhole Width"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Length>
		<Length Name="ac_wallhole_height">
			<Description><![CDATA["Wallhole Height"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>2</Value>
		</Length>
		<Length Name="ac_unit_width">
			<Description><![CDATA["Unit Width"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Length>
		<Length Name="ac_unit_height">
			<Description><![CDATA["Unit Height"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>2</Value>
		</Length>
		<Length Name="ac_egress_width">
			<Description><![CDATA["Egress Width"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.9</Value>
		</Length>
		<Length Name="ac_egress_height">
			<Description><![CDATA["Egress Height"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1.95</Value>
		</Length>
		<Length Name="ac_leaf_width">
			<Description><![CDATA["Leaf Width"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.9</Value>
		</Length>
		<Length Name="ac_leaf_height">
			<Description><![CDATA["Leaf Height"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1.95</Value>
		</Length>
		<Length Name="gs_tolerance_left">
			<Description><![CDATA["Tolerance Left"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_tolerance_right">
			<Description><![CDATA["Tolerance Right"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_tolerance_upper">
			<Description><![CDATA["Tolerance Upper"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_tolerance_lower">
			<Description><![CDATA["Tolerance Lower"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_tolerance_left_2">
			<Description><![CDATA["Tolerance Left Sidelight"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_tolerance_right_2">
			<Description><![CDATA["Tolerance Right Sidelight"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_tolerance_low_left_sl">
			<Description><![CDATA["Tolerance Left Sidelight Lower"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_tolerance_low_right_sl">
			<Description><![CDATA["Tolerance Right Sidelight Lower"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Length>

		<!-- gs_door_frame: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="gs_door_frame">
			<Description><![CDATA["Door Frame"]]></Description>
		</Title>
		<Boolean Name="gs_pocket_door_frame">
			<Description><![CDATA["Door Frame"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_BoldName/>
			</Flags>
			<Value>1</Value>
		</Boolean>
		<Integer Name="gs_rail_pos_m">
			<Description><![CDATA[""]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Integer>
		<Integer Name="gs_frame_style_m">
			<Description><![CDATA["Frame Style"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Integer>
		<Boolean Name="gs_frame_wthk">
			<Description><![CDATA["Frame Thickness=Wall Thickness"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_sframe">
			<Description><![CDATA["Uniform Frame Sizes"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Boolean>
		<Boolean Name="gs_LeftMullion_Top">
			<Description><![CDATA["Left Mullion to Top"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_RightMullion_Top">
			<Description><![CDATA["Right Mullion to Top"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_Transom_toLeft">
			<Description><![CDATA["Transom to Left Side"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_Transom_toRight">
			<Description><![CDATA["Transom to Right Side"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Length Name="gs_fthk">
			<Description><![CDATA["Frame Thickness Calculated"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.11</Value>
		</Length>
		<Length Name="gs_frame_thk">
			<Description><![CDATA["Frame Thickness"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.11</Value>
		</Length>
		<Length Name="gs_frame_thkin">
			<Description><![CDATA["Frame Thickness Inside"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.11</Value>
		</Length>
		<Boolean Name="gs_leaf_center">
			<Description><![CDATA["Centered Leaf"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Boolean>
		<Length Name="gs_leaf_offset">
			<Description><![CDATA["Leaf Offset"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Boolean Name="gs_fitframe_slantedreveal">
			<Description><![CDATA["Fit Frame to Slanted Reveal"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_uniform_framewidth">
			<Description><![CDATA["Uniform Frame Width"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Length Name="gs_frame_width_orig">
			<Description><![CDATA["Original Frame Width"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.05</Value>
		</Length>
		<Length Name="gs_frame_width">
			<Description><![CDATA["Frame Width"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.03</Value>
		</Length>
		<Length Name="gs_frame_oversize">
			<Description><![CDATA["Frame Oversize"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.01</Value>
		</Length>
		<Length Name="gs_frame_oversize_thk">
			<Description><![CDATA["Frame Oversize Thickness"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.01</Value>
		</Length>
		<Length Name="gs_frame_width_right">
			<Description><![CDATA["Frame Width Side 1"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.05</Value>
		</Length>
		<Length Name="gs_frame_width_right_2">
			<Description><![CDATA["Middle Frame Width Side 1"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_frame_width_low_right_sl">
			<Description><![CDATA["Bottom Frame Width Side 1"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_frame_width_left">
			<Description><![CDATA["Frame Width Side 2"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.05</Value>
		</Length>
		<Length Name="gs_frame_width_left_2">
			<Description><![CDATA["Middle Frame Width Side 2"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_frame_width_low_left_sl">
			<Description><![CDATA["Bottom Frame Width Side 2"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_frame_width_transom">
			<Description><![CDATA["Transom Frame Width"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_frame_width_upper">
			<Description><![CDATA["Upper Frame Width"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.05</Value>
		</Length>
		<Length Name="gs_frw1">
			<Description><![CDATA["Frame Width 1"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.09</Value>
		</Length>
		<Length Name="gs_frw2">
			<Description><![CDATA["Frame Width 2"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.05</Value>
		</Length>
		<Length Name="gs_frwt">
			<Description><![CDATA["Frame Width Top"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.07</Value>
		</Length>
		<Length Name="gs_frwm">
			<Description><![CDATA["Frame Width Middle"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.065</Value>
		</Length>
		<Length Name="gs_ds_thk">
			<Description><![CDATA["Door Stop Thickness"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.03</Value>
		</Length>
		<Length Name="gs_ds_w">
			<Description><![CDATA["Door Stop Width"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.016</Value>
		</Length>
		<Length Name="gs_rebate_width">
			<Description><![CDATA["Rebate Width"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.01</Value>
		</Length>
		<Length Name="gs_rebate_depth_3D">
			<Description><![CDATA["Leaf Rebate Depth in 3D"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_sidelight_rebate_width">
			<Description><![CDATA["Sidelight and Transom Rebate Width"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_sidelight_rebate_depth">
			<Description><![CDATA["Sidelight and Transom Rebate Depth"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_frame_ovhg_left_out">
			<Description><![CDATA["Overhang Left Out"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_frame_ovhg_left_in">
			<Description><![CDATA["Overhang Left In"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_frame_ovhg_right_out">
			<Description><![CDATA["Overhang Right Out"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_frame_ovhg_right_in">
			<Description><![CDATA["Overhang Right In"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_frame_ovhg_bottom_out">
			<Description><![CDATA[""]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_frame_ovhg_bottom_in">
			<Description><![CDATA[""]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_frame_ovhg_top_out">
			<Description><![CDATA[""]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_frame_ovhg_top_in">
			<Description><![CDATA[""]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_unit_extra_thk">
			<Description><![CDATA[""]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Length>

		<!-- gs_pocket_frame: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Boolean Name="gs_pocket_frame">
			<Description><![CDATA["Pocket Frame"]]></Description>
			<Flags>
				<ParFlg_BoldName/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Length Name="gs_pocket_frame_thk">
			<Description><![CDATA["Pocket Frame Thickness"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.02</Value>
		</Length>
		<Boolean Name="bPocketWidthOverride">
			<Description><![CDATA["Pocket Width by User"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Length Name="gs_pocket_width">
			<Description><![CDATA["Pocket Width Value"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Length>

		<!-- gs_door_panel: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="gs_door_panel">
			<Description><![CDATA["Door Panel"]]></Description>
		</Title>
		<Integer Name="gs_leaf_optype_m">
			<Description><![CDATA["Opening Type"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Integer>
		<Length Name="gs_leaf_thk">
			<Description><![CDATA["Leaf Thickness"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.04</Value>
		</Length>
		<Length Name="gs_glass_thk">
			<Description><![CDATA["Glass Thickness"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_sliding_fixpanel_width_left">
			<Description><![CDATA["Sliding Fixpanel Width Left"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_sliding_fixpanel_width_right">
			<Description><![CDATA["Sliding Fixpanel Width Right"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Boolean Name="bFixedPanelLeft">
			<Description><![CDATA[""]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Boolean>
		<Boolean Name="bFixedPanelright">
			<Description><![CDATA[""]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Boolean>
		<Length Name="gs_mdpw">
			<Description><![CDATA["Main Door Panel Width"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Length>

		<!-- gs_sidelight_left: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Boolean Name="gs_sidelight_left">
			<Description><![CDATA["Left Sidelight"]]></Description>
			<Flags>
				<ParFlg_BoldName/>
			</Flags>
			<Value>1</Value>
		</Boolean>
		<Length Name="gs_sidelight_width_left">
			<Description><![CDATA["Sidelight Width Left"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.4</Value>
		</Length>
		<Length Name="gs_sidelight_parapet_hgt_left">
			<Description><![CDATA["Side 2 Sill Height"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.5</Value>
		</Length>
		<Boolean Name="gs_bSidelight_fr_hdiv_left">
			<Description><![CDATA["Sidelight 2 Horizontal Division"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Length Name="gs_sidelight_fr_hdiv_hgt_left">
			<Description><![CDATA["Sidelight 2 Division Height"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.6</Value>
		</Length>
		<Length Name="gs_sidelight_fr_hdiv_wdt_left">
			<Description><![CDATA["Side 2 Division Frame Width"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.04</Value>
		</Length>

		<!-- gs_sidelight_right: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Boolean Name="gs_sidelight_right">
			<Description><![CDATA["Right Sidelight"]]></Description>
			<Flags>
				<ParFlg_BoldName/>
				<ParFlg_Unique/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Length Name="gs_sidelight_width_right">
			<Description><![CDATA["Sidelight Width Right"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.4</Value>
		</Length>
		<Length Name="gs_sidelight_parapet_hgt_right">
			<Description><![CDATA["Side 1 Sill Height"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.9</Value>
		</Length>
		<Boolean Name="gs_bSidelight_fr_hdiv_right">
			<Description><![CDATA["Sidelight 1 Horizontal Division"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Length Name="gs_sidelight_fr_hdiv_hgt_right">
			<Description><![CDATA["Sidelight 1 Division Height"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.6</Value>
		</Length>
		<Length Name="gs_sidelight_fr_hdiv_wdt_right">
			<Description><![CDATA["Side 1 Division Frame Width"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.04</Value>
		</Length>

		<!-- gs_door_transom: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Boolean Name="gs_door_transom">
			<Description><![CDATA["Transom"]]></Description>
			<Flags>
				<ParFlg_BoldName/>
			</Flags>
			<Value>1</Value>
		</Boolean>
		<Length Name="gs_transom_height">
			<Description><![CDATA["Transom Height"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.3</Value>
		</Length>
		<Length Name="gs_transom_height_top">
			<Description><![CDATA["Transom Height"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Boolean Name="bTransomHeightEditOnTop">
			<Description><![CDATA["Transom Height"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>

		<!-- gs_window_sash: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="gs_window_sash">
			<Description><![CDATA["Sidelight and Transom Sashes"]]></Description>
		</Title>
		<Integer Name="gs_optype_m_02">
			<Description><![CDATA["Opening Type"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Integer>
		<Integer Name="gs_optype_m_09">
			<Description><![CDATA["Opening Type"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Integer>
		<Integer Name="gs_optype_m_05">
			<Description><![CDATA["Opening Type"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Integer>
		<Integer Name="gs_optype_m_10">
			<Description><![CDATA["Opening Type"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Integer>
		<Integer Name="gs_optype_m_06">
			<Description><![CDATA["Opening Type"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Integer>
		<Integer Name="gs_optype_m_11">
			<Description><![CDATA["Opening Type"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Integer>
		<Integer Name="gs_optype_m_07">
			<Description><![CDATA["Opening Type"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Integer>
		<Integer Name="iMullionStyle_02">
			<Description><![CDATA["Grid Style"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Integer>
		<Integer Name="iMullionStyle_09">
			<Description><![CDATA["Grid Style"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Integer>
		<Integer Name="iMullionStyle_05">
			<Description><![CDATA["Grid Style"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Integer>
		<Integer Name="iMullionStyle_10">
			<Description><![CDATA["Grid Style"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Integer>
		<Integer Name="iMullionStyle_06">
			<Description><![CDATA["Grid Style"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Integer>
		<Integer Name="iMullionStyle_11">
			<Description><![CDATA["Grid Style"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Integer>
		<Integer Name="iMullionStyle_07">
			<Description><![CDATA["Grid Style"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Integer>

		<!-- gs_sill_outside: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Boolean Name="gs_sill_outside">
			<Description><![CDATA["Door Sill"]]></Description>
			<Flags>
				<ParFlg_BoldName/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_sill_outside_sl_left">
			<Description><![CDATA[""]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_sill_outside_sl_right">
			<Description><![CDATA[""]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>

		<!-- gs_door_oversize: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="gs_door_oversize">
			<Description><![CDATA["Opening Oversize"]]></Description>
		</Title>
		<Length Name="gs_left_oversize">
			<Description><![CDATA["Left Opening Oversize"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_right_oversize">
			<Description><![CDATA["Right Opening Oversize"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_upper_oversize">
			<Description><![CDATA["Upper Opening Oversize"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_lower_oversize">
			<Description><![CDATA["Lower Opening Oversize"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Length>

		<!-- gs_door_stack: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="gs_door_stack">
			<Description><![CDATA["Ganging"]]></Description>
		</Title>
		<Boolean Name="gs_stack_left">
			<Description><![CDATA["Connection on the Left"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_stack_right">
			<Description><![CDATA["Connection on the Right"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_stack_top">
			<Description><![CDATA["Connection on the Top"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>

		<!-- gs_reveal: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="gs_reveal">
			<Description><![CDATA["Reveal"]]></Description>
		</Title>
		<Length Name="gs_reveal_left">
			<Description><![CDATA["Jamb Depth Side 2"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_reveal_right">
			<Description><![CDATA["Jamb Depth"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Angle Name="gs_reveal_top_angle">
			<Description><![CDATA["Top Side Angle"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Angle>
		<Angle Name="gs_reveal_left_angle">
			<Description><![CDATA["Angle Side 2"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Angle>
		<Angle Name="gs_reveal_right_angle">
			<Description><![CDATA["Angle Side"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Angle>

		<!-- gs_2D_representation: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="gs_2D_representation">
			<Description><![CDATA["2D and Section Representation"]]></Description>
		</Title>
		<Integer Name="gs_detlevel_2D_m">
			<Description><![CDATA["2D Detail Level"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>2</Value>
		</Integer>
		<Integer Name="lod2D">
			<Description><![CDATA["2D Detail Level"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Integer>
		<Integer Name="iLoD2D">
			<Description><![CDATA[""]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Integer>
		<PenColor Name="gs_pen_2D">
			<Description><![CDATA["Symbol Pen"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>3</Value>
		</PenColor>
		<PenColor Name="gs_frame_pen_cont">
			<Description><![CDATA["Frame Contour Pen"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>2</Value>
		</PenColor>
		<PenColor Name="gs_leaf_pen_2D">
			<Description><![CDATA["Leaf Contour Pen"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>3</Value>
		</PenColor>
		<Boolean Name="gs_bFills">
			<Description><![CDATA["Use Fills"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Boolean>
		<FillPattern Name="gs_fillFr">
			<Description><![CDATA["Frame Fill Type"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>65</Value>
		</FillPattern>
		<PenColor Name="gs_penFr_fg">
			<Description><![CDATA["Frame Fill Pen"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>91</Value>
		</PenColor>
		<PenColor Name="gs_penFr_bg">
			<Description><![CDATA["Frame Fill Background Pen"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>91</Value>
		</PenColor>
		<FillPattern Name="gs_wallhole_fill">
			<Description><![CDATA["Door Plan Symbol Fill Type"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>65</Value>
		</FillPattern>
		<PenColor Name="gs_wallhole_pen_fg">
			<Description><![CDATA["Door Plan Symbol Fill Pen"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>19</Value>
		</PenColor>
		<PenColor Name="gs_wallhole_pen_bg">
			<Description><![CDATA["Door Plan Symbol Fill Background Pen"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</PenColor>
		<Length Name="gs_sash_thk">
			<Description><![CDATA["Sidelight and Transom Frame Thickness"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_sash_width">
			<Description><![CDATA["Transom Frame Width"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_sl_sash_width">
			<Description><![CDATA["Sidelight Frame Width"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Boolean Name="gs_frame_left_endline">
			<Description><![CDATA["Draw Left Endline"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_frame_right_endline">
			<Description><![CDATA["Draw Right Endline"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>

		<!-- gs_3D_representation: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="gs_3D_representation">
			<Description><![CDATA["3D Representation"]]></Description>
		</Title>
		<Integer Name="lod3D">
			<Description><![CDATA["3D Detail Level"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>2</Value>
		</Integer>
		<Integer Name="res">
			<Description><![CDATA[""]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>3</Value>
		</Integer>
		<PenColor Name="gs_frame_pen">
			<Description><![CDATA["Frame Pen"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>2</Value>
		</PenColor>
		<Integer Name="nArchResolution">
			<Description><![CDATA["Arch Resolution"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>3</Value>
		</Integer>
		<FillPattern Name="fr_sect_fill_type">
			<Description><![CDATA[""]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>65</Value>
		</FillPattern>
		<PenColor Name="fr_sect_fill_bg">
			<Description><![CDATA[""]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>19</Value>
		</PenColor>
		<PenColor Name="fr_sect_fill_fg">
			<Description><![CDATA[""]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>19</Value>
		</PenColor>

		<!-- gs_door_material: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="gs_door_material">
			<Description><![CDATA["Surfaces"]]></Description>
		</Title>
		<Material Name="gs_frame_mat">
			<Description><![CDATA["Frame Surface Outside"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>15</Value>
		</Material>
		<Material Name="gs_frame_mat2">
			<Description><![CDATA["Frame Surface Inside"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>15</Value>
		</Material>
		<Boolean Name="bEnableJointMat">
			<Description><![CDATA["Different Frame Joint Surfaces"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Material Name="gs_jointmat_out">
			<Description><![CDATA["Joint Surface Outside"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>15</Value>
		</Material>
		<Material Name="gs_jointmat_in">
			<Description><![CDATA["Joint Surface Inside"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>15</Value>
		</Material>
		<Integer Name="gs_ui_current_page">
			<Description><![CDATA[""]]></Description>
			<Flags>
				<ParFlg_Unique/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>1</Value>
		</Integer>
		<Integer Name="gs_ui_sub_tabpage">
			<Description><![CDATA[""]]></Description>
			<Flags>
				<ParFlg_Unique/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>1</Value>
		</Integer>

		<!-- D_Frame_Re_sp2: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="D_Frame_Re_sp2">
			<Description><![CDATA["Others"]]></Description>
		</Title>
		<Boolean Name="bShowAddHotspots">
			<Description><![CDATA["Show Additional Hotspots"]]></Description>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="bShowUnitHotspots">
			<Description><![CDATA["Show Unit Hotspots"]]></Description>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="bShowEgressHotspots">
			<Description><![CDATA["Show Egress Hotspots"]]></Description>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="bShowLeafHotspots">
			<Description><![CDATA["Show Leaf Hotspots"]]></Description>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="bShowAddHotspotsForIS">
			<Description><![CDATA["Show Additional Hotspots For IS"]]></Description>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="bEnableLeafRebateDepth3D">
			<Description><![CDATA["Enable Leaf Rebate in 3D"]]></Description>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Integer Name="gs_SashText_typ_num">
			<Description><![CDATA["Texture Direction"]]></Description>
			<Value>1</Value>
		</Integer>
		<Integer Name="gs_opening_dir_SL_m">
			<Description><![CDATA["Opening Direction Sidelight"]]></Description>
			<Value>2</Value>
		</Integer>

		<!-- usa: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="usa">
			<Description><![CDATA["USA Parameters"]]></Description>
		</Title>
		<Length Name="gs_ds_pr">
			<Description><![CDATA["Door Stop Projection (USA)"]]></Description>
			<Value>0</Value>
		</Length>
		<Boolean Name="gs_mf">
			<Description><![CDATA["Middle Frame"]]></Description>
			<Value>0</Value>
		</Boolean>
		<Length Name="gs_mf_w">
			<Description><![CDATA["Middle Frame Width"]]></Description>
			<Value>0.1524</Value>
		</Length>
		<Length Name="gs_mf_pos">
			<Description><![CDATA["Middle Frame Position"]]></Description>
			<Value>0</Value>
		</Length>
		<Boolean Name="gs_usaframe">
			<Description><![CDATA[""]]></Description>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="gs_pivotdoor">
			<Description><![CDATA[""]]></Description>
			<Value>0</Value>
		</Boolean>
		<Length Name="gs_pivotOffset">
			<Description><![CDATA[""]]></Description>
			<Value>0</Value>
		</Length>
		<Boolean Name="bNeedCutting">
			<Description><![CDATA[""]]></Description>
			<Value>1</Value>
		</Boolean>
		<Length Name="gs_unit_extra_left">
			<Description><![CDATA[""]]></Description>
			<Value>0</Value>
		</Length>
		<Length Name="gs_unit_extra_right">
			<Description><![CDATA[""]]></Description>
			<Value>0</Value>
		</Length>
	</Parameters>
</ParamSection>

<CalledMacros SectVersion="2" SectionFlags="0" SubIdent="0">
</CalledMacros>

<Copyright SectVersion="1" SectionFlags="0" SubIdent="0">
	<Author>GRAPHISOFT</Author>
	<License>
		<Type>CC BY-ND</Type>
		<Version>3.0</Version>
	</License>
</Copyright>

</Symbol>
