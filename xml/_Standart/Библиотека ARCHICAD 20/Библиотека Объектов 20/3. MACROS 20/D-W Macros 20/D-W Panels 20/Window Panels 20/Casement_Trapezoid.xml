<?xml version="1.0" encoding="UTF-8"?>
<Symbol IsArchivable="true" IsPlaceable="false" MainGUID="38C79837-825A-49FD-8427-119710B8DBDB" MigrationValue="Normal" Owner="1196638531" Signature="1297307981" Version="43">
<Ancestry SectVersion="1" SectionFlags="0" SubIdent="0" Template="false">
	<MainGUID>F938E33A-329D-4A36-BE3E-85E126820996</MainGUID>
	<MainGUID>103E8D2C-8230-42E1-9597-46F84CCE28C0</MainGUID>
	<MainGUID>B2970E4C-8680-4061-8670-2F4B638F3953</MainGUID>
</Ancestry>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_3D SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[
unID = sh_unID

! ==============================================================================
! Simple Detail Level
! ==============================================================================

if	gs_optype_m = SASH_FIXED |\
	gs_optype_m = SASH_HOR_PIVOT |\
	gs_optype_m = SASH_VER_PIVOT |\
	gs_optype_m = SASH_VER_PIVOT_M |\
	gs_optype_m = SASH_SLIDING_HOR |\
	gs_optype_m = SASH_SLIDING_HOR_M |\
	gs_optype_m = SASH_DOUBLE_SLIDING_HOR |\
	gs_optype_m = SASH_DOUBLE_SLIDING_HOR_M |\
	gs_optype_m = SASH_SLIDING_VER |\
	gs_optype_m = SASH_DOUBLE_SLIDING_VER then

	if lod3D = 1 | lod3D = 5 | gs_optype_m = SASH_FIXED then
		addy gs_rebate_width
		A = A - 2*gs_rebate_width
		B = B - 2*gs_rebate_width
		if iMullionStyle = MULLION_SOLID_PANEL then
			addz -gs_frame_thk
		endif
	else
		if	gs_optype_m = SASH_HOR_PIVOT |\
			gs_optype_m = SASH_VER_PIVOT |\
			gs_optype_m = SASH_VER_PIVOT_M then
			addz -gs_sash_thk
		else
			addz -gs_frame_thk
		endif
	endif
else
	if lod3D <> 1 & lod3D <> 5 then
		addz -gs_rebate_depth
	endif
endif

bShowFrame = 1
if lod3D = 1 | lod3D = 5 then

	bShowFrame = 0

	vgn = 0
	hgn = 0

	if iMullionStyle = MULLION_CUSTOM then
		iMullionStyle = MULLION_NONE
	endif

	gs_full_edit = 0
endif


if gs_optype_m = SASH_FIXED then
	fix_sh_grmod = gs_sash_width
else
	fix_sh_grmod = 0
endif


! =============================================================================
! Open the Window
! =============================================================================

if GLOB_CONTEXT = 6 then	! Window Schedule - 3D view should NOT display sash in open position
	openingAngle = 0
	openingAngle2 = 0
endif

if not(bOpeningDirectionInside) then
	eloj_ref = -1
else
	eloj_ref = 1
endif

if gs_full_edit then

! -----------------------------------------------------------------------------
	if gs_optype_m = SASH_SIDE_HUNG then
		mulx -1

		addx	-a/2
		addy 	b/2
		rotx -90

		addy -gs_sash_thk/2
		if bEnableSEOpening then
			if CasementID = 1 then
				hotspot A,											-gs_sash_thk/2,								0, unID, openingAngle_01, 4+128 : unID=unID+1
				hotspot 0,											0,											1*eloj_ref, 			 unID, openingAngle_01, 7 : unID=unID+1
				hotspot A*sin(90+openingAngle_01)+gs_sash_thk/2*cos(90+openingAngle_01),A*cos(90+openingAngle_01)-gs_sash_thk/2*sin(90+openingAngle_01),0, unID, openingAngle_01, 5 : unID=unID+1
				hotspot 0, 											0, 											0, unID, openingAngle_01, 6 : unID=unID+1
			endif
			if CasementID = 2 then
				hotspot A,											-gs_sash_thk/2,								0, unID, openingAngle_02, 4+128 : unID=unID+1
				hotspot 0,											0,											1*eloj_ref, 			 unID, openingAngle_02, 7 : unID=unID+1
				hotspot A*sin(90+openingAngle_02)+gs_sash_thk/2*cos(90+openingAngle_02),A*cos(90+openingAngle_02)-gs_sash_thk/2*sin(90+openingAngle_02),0, unID, openingAngle_02, 5 : unID=unID+1
				hotspot 0, 											0, 											0, unID, openingAngle_02, 6 : unID=unID+1
			endif
			if CasementID = 3 then
				hotspot A,											-gs_sash_thk/2,								0, unID, openingAngle_03, 4+128 : unID=unID+1
				hotspot 0,											0,											1*eloj_ref, 			 unID, openingAngle_03, 7 : unID=unID+1
				hotspot A*sin(90+openingAngle_03)+gs_sash_thk/2*cos(90+openingAngle_03),A*cos(90+openingAngle_03)-gs_sash_thk/2*sin(90+openingAngle_03),0, unID, openingAngle_03, 5 : unID=unID+1
				hotspot 0, 											0, 											0, unID, openingAngle_03, 6 : unID=unID+1
			endif
			if CasementID = 4 then
				hotspot A,											-gs_sash_thk/2,								0, unID, openingAngle_04, 4+128 : unID=unID+1
				hotspot 0,											0,											1*eloj_ref, 			 unID, openingAngle_04, 7 : unID=unID+1
				hotspot A*sin(90+openingAngle_04)+gs_sash_thk/2*cos(90+openingAngle_04),A*cos(90+openingAngle_04)-gs_sash_thk/2*sin(90+openingAngle_04),0, unID, openingAngle_04, 5 : unID=unID+1
				hotspot 0, 											0, 											0, unID, openingAngle_04, 6 : unID=unID+1
			endif
			if CasementID = 5 then
				hotspot A,											-gs_sash_thk/2,								0, unID, openingAngle_05, 4+128 : unID=unID+1
				hotspot 0,											0,											1*eloj_ref, 			 unID, openingAngle_05, 7 : unID=unID+1
				hotspot A*sin(90+openingAngle_05)+gs_sash_thk/2*cos(90+openingAngle_05),A*cos(90+openingAngle_05)-gs_sash_thk/2*sin(90+openingAngle_05),0, unID, openingAngle_05, 5 : unID=unID+1
				hotspot 0, 											0, 											0, unID, openingAngle_05, 6 : unID=unID+1
			endif
		endif
		del 1

		del 2

		if openingAngle>90 then openingAngle=0
		if openingAngle<>0 then
			addz gs_rebate_depth
			roty -openingAngle
			addz -gs_rebate_depth
		endif

		addx a/2
		mulx -1
	endif

! -----------------------------------------------------------------------------
	if gs_optype_m = SASH_SIDE_HUNG_M then
		addx	-a/2
		addy 	b/2

		rotx -90
		addy -gs_sash_thk/2

		if bEnableSEOpening then
			if CasementID = 1 then
				hotspot A,											-gs_sash_thk/2,								0, unID, openingAngle_01, 4+128 : unID=unID+1
				hotspot 0,											0,											-1*eloj_ref, 			 unID, openingAngle_01, 7 : unID=unID+1
				hotspot A*sin(90+openingAngle_01)+gs_sash_thk/2*cos(90+openingAngle_01),A*cos(90+openingAngle_01)-gs_sash_thk/2*sin(90+openingAngle_01),0, unID, openingAngle_01, 5 : unID=unID+1
				hotspot 0, 											0, 											0, unID, openingAngle_01, 6 : unID=unID+1
			endif
			if CasementID = 2 then
				hotspot A,											-gs_sash_thk/2,								0, unID, openingAngle_02, 4+128 : unID=unID+1
				hotspot 0,											0,											-1*eloj_ref, 			 unID, openingAngle_02, 7 : unID=unID+1
				hotspot A*sin(90+openingAngle_02)+gs_sash_thk/2*cos(90+openingAngle_02),A*cos(90+openingAngle_02)-gs_sash_thk/2*sin(90+openingAngle_02),0, unID, openingAngle_02, 5 : unID=unID+1
				hotspot 0, 											0, 											0, unID, openingAngle_02, 6 : unID=unID+1
			endif
			if CasementID = 3 then
				hotspot A,											-gs_sash_thk/2,								0, unID, openingAngle_03, 4+128 : unID=unID+1
				hotspot 0,											0,											-1*eloj_ref, 			 unID, openingAngle_03, 7 : unID=unID+1
				hotspot A*sin(90+openingAngle_03)+gs_sash_thk/2*cos(90+openingAngle_03),A*cos(90+openingAngle_03)-gs_sash_thk/2*sin(90+openingAngle_03),0, unID, openingAngle_03, 5 : unID=unID+1
				hotspot 0, 											0, 											0, unID, openingAngle_03, 6 : unID=unID+1
			endif
			if CasementID = 4 then
				hotspot A,											-gs_sash_thk/2,								0, unID, openingAngle_04, 4+128 : unID=unID+1
				hotspot 0,											0,											-1*eloj_ref, 			 unID, openingAngle_04, 7 : unID=unID+1
				hotspot A*sin(90+openingAngle_04)+gs_sash_thk/2*cos(90+openingAngle_04),A*cos(90+openingAngle_04)-gs_sash_thk/2*sin(90+openingAngle_04),0, unID, openingAngle_04, 5 : unID=unID+1
				hotspot 0, 											0, 											0, unID, openingAngle_04, 6 : unID=unID+1
			endif
			if CasementID = 5 then
				hotspot A,											-gs_sash_thk/2,								0, unID, openingAngle_05, 4+128 : unID=unID+1
				hotspot 0,											0,											-1*eloj_ref, 			 unID, openingAngle_05, 7 : unID=unID+1
				hotspot A*sin(90+openingAngle_05)+gs_sash_thk/2*cos(90+openingAngle_05),A*cos(90+openingAngle_05)-gs_sash_thk/2*sin(90+openingAngle_05),0, unID, openingAngle_05, 5 : unID=unID+1
				hotspot 0, 											0, 											0, unID, openingAngle_05, 6 : unID=unID+1
			endif
		endif
		del 1
		del 2

		if openingAngle>90 then openingAngle=0

		if openingAngle<>0 then
			addz gs_rebate_depth
			roty -openingAngle
			addz -gs_rebate_depth
		endif

		addx a/2
	endif

! -----------------------------------------------------------------------------
	if gs_optype_m = SASH_TOP_HUNG then


		addy b
		rotz 	-90
		rotx	-90

		addy -gs_sash_thk/2
		if bEnableSEOpening then
			if CasementID = 1 then
				hotspot B,											-gs_sash_thk/2,								0, unID, openingAngle_01, 4+128 : unID=unID+1
				hotspot 0,											0,											-1*eloj_ref, unID, openingAngle_01, 7 : unID=unID+1
				hotspot B*sin(90+openingAngle_01)+gs_sash_thk/2*cos(90+openingAngle_01),B*cos(90+openingAngle_01)-gs_sash_thk/2*sin(90+openingAngle_01),0, unID, openingAngle_01, 5 : unID=unID+1
				hotspot 0, 											0, 											0, unID, openingAngle_01, 6 : unID=unID+1
			endif
			if CasementID = 2 then
				hotspot B,											-gs_sash_thk/2,								0, unID, openingAngle_02, 4+128 : unID=unID+1
				hotspot 0,											0,											-1*eloj_ref, unID, openingAngle_02, 7 : unID=unID+1
				hotspot B*sin(90+openingAngle_02)+gs_sash_thk/2*cos(90+openingAngle_02),B*cos(90+openingAngle_02)-gs_sash_thk/2*sin(90+openingAngle_02),0, unID, openingAngle_02, 5 : unID=unID+1
				hotspot 0, 											0, 											0, unID, openingAngle_02, 6 : unID=unID+1
			endif
			if CasementID = 3 then
				hotspot B,											-gs_sash_thk/2,								0, unID, openingAngle_03, 4+128 : unID=unID+1
				hotspot 0,											0,											-1*eloj_ref, unID, openingAngle_03, 7 : unID=unID+1
				hotspot B*sin(90+openingAngle_03)+gs_sash_thk/2*cos(90+openingAngle_03),B*cos(90+openingAngle_03)-gs_sash_thk/2*sin(90+openingAngle_03),0, unID, openingAngle_03, 5 : unID=unID+1
				hotspot 0, 											0, 											0, unID, openingAngle_03, 6 : unID=unID+1
			endif
			if CasementID = 4 then
				hotspot B,											-gs_sash_thk/2,								0, unID, openingAngle_04, 4+128 : unID=unID+1
				hotspot 0,											0,											-1*eloj_ref, unID, openingAngle_04, 7 : unID=unID+1
				hotspot B*sin(90+openingAngle_04)+gs_sash_thk/2*cos(90+openingAngle_04),B*cos(90+openingAngle_04)-gs_sash_thk/2*sin(90+openingAngle_04),0, unID, openingAngle_04, 5 : unID=unID+1
				hotspot 0, 											0, 											0, unID, openingAngle_04, 6 : unID=unID+1
			endif
			if CasementID = 5 then
				hotspot B,											-gs_sash_thk/2,								0, unID, openingAngle_05, 4+128 : unID=unID+1
				hotspot 0,											0,											-1*eloj_ref, unID, openingAngle_05, 7 : unID=unID+1
				hotspot B*sin(90+openingAngle_05)+gs_sash_thk/2*cos(90+openingAngle_05),B*cos(90+openingAngle_05)-gs_sash_thk/2*sin(90+openingAngle_05),0, unID, openingAngle_05, 5 : unID=unID+1
				hotspot 0, 											0, 											0, unID, openingAngle_05, 6 : unID=unID+1
			endif
		endif
		del 1

		del 2

		if openingAngle>90 then openingAngle=0
		if openingAngle<>0 then
			addz gs_rebate_depth
			rotx -openingAngle
			addz -gs_rebate_depth
		endif

		addy -b
	endif

! -----------------------------------------------------------------------------
	if gs_optype_m = SASH_BOTTOM_HUNG then

		muly	-1
		rotz 	-90
		rotx	-90

		addy -gs_sash_thk/2
		if bEnableSEOpening then
			if CasementID = 1 then
				hotspot B,											-gs_sash_thk/2,								0, unID, openingAngle_01, 4+128 : unID=unID+1
				hotspot 0,											0,											1*eloj_ref, 			 unID, openingAngle_01, 7 : unID=unID+1
				hotspot B*sin(90+openingAngle_01)+gs_sash_thk/2*cos(90+openingAngle_01),B*cos(90+openingAngle_01)-gs_sash_thk/2*sin(90+openingAngle_01),0, unID, openingAngle_01, 5 : unID=unID+1
				hotspot 0, 											0, 											0, unID, openingAngle_01, 6 : unID=unID+1
			endif
			if CasementID = 2 then
				hotspot B,											-gs_sash_thk/2,								0, unID, openingAngle_02, 4+128 : unID=unID+1
				hotspot 0,											0,											1*eloj_ref, 			 unID, openingAngle_02, 7 : unID=unID+1
				hotspot B*sin(90+openingAngle_02)+gs_sash_thk/2*cos(90+openingAngle_02),B*cos(90+openingAngle_02)-gs_sash_thk/2*sin(90+openingAngle_02),0, unID, openingAngle_02, 5 : unID=unID+1
				hotspot 0, 											0, 														0, unID, openingAngle_02, 6 : unID=unID+1
			endif
			if CasementID = 3 then
				hotspot B,											-gs_sash_thk/2,								0, unID, openingAngle_03, 4+128 : unID=unID+1
				hotspot 0,											0,											1*eloj_ref, 			 unID, openingAngle_03, 7 : unID=unID+1
				hotspot B*sin(90+openingAngle_03)+gs_sash_thk/2*cos(90+openingAngle_03),B*cos(90+openingAngle_03)-gs_sash_thk/2*sin(90+openingAngle_03),0, unID, openingAngle_03, 5 : unID=unID+1
				hotspot 0, 											0, 														0, unID, openingAngle_03, 6 : unID=unID+1
			endif
			if CasementID = 4 then
				hotspot B,											-gs_sash_thk/2,								0, unID, openingAngle_04, 4+128 : unID=unID+1
				hotspot 0,											0,											1*eloj_ref, 			 unID, openingAngle_04, 7 : unID=unID+1
				hotspot B*sin(90+openingAngle_04)+gs_sash_thk/2*cos(90+openingAngle_04),B*cos(90+openingAngle_04)-gs_sash_thk/2*sin(90+openingAngle_04),0, unID, openingAngle_04, 5 : unID=unID+1
				hotspot 0, 											0, 														0, unID, openingAngle_04, 6 : unID=unID+1
			endif
			if CasementID = 5 then
				hotspot B,											-gs_sash_thk/2,								0, unID, openingAngle_05, 4+128 : unID=unID+1
				hotspot 0,											0,											1*eloj_ref, 			 unID, openingAngle_05, 7 : unID=unID+1
				hotspot B*sin(90+openingAngle_05)+gs_sash_thk/2*cos(90+openingAngle_05),B*cos(90+openingAngle_05)-gs_sash_thk/2*sin(90+openingAngle_05),0, unID, openingAngle_05, 5 : unID=unID+1
				hotspot 0, 											0, 														0, unID, openingAngle_05, 6 : unID=unID+1
			endif
		endif
		del 1
		del 2

		if openingAngle>90 then openingAngle=0
		if openingAngle<>0 then
			addz gs_rebate_depth
			rotx -openingAngle
			addz -gs_rebate_depth
		endif
		muly	-1
	endif

! -----------------------------------------------------------------------------
	if gs_optype_m = SASH_VER_PIVOT then
		addy b/2
		rotx	-90
		addy	gs_sash_thk/2

		if bEnableSEOpening then
			if CasementID = 1 then
				hotspot gs_sash_thk*sin(135)+a/2*sin(90), gs_sash_thk*cos(135)+a/2*cos(90), (0), unID, openingAngle_01, 4+128 : unID=unID+1
				hotspot gs_sash_thk*sin(90)+a/2*sin(0), gs_sash_thk*cos(90)+a/2*cos(0), 0, unID, openingAngle_01, 7 : unID=unID+1
				hotspot gs_sash_thk*sin(180+openingAngle_01)+a/2*sin(90+openingAngle_01), gs_sash_thk*cos(180+openingAngle_01)+a/2*cos(90+openingAngle_01), (0), unID, openingAngle_01, 5 : unID=unID+1
				hotspot 0, -gs_sash_thk, (0), unID, openingAngle_01, 6 : unID=unID+1
			endif
			if CasementID = 2 then
				hotspot gs_sash_thk*sin(135)+a/2*sin(90), gs_sash_thk*cos(135)+a/2*cos(90), (0), unID, openingAngle_02, 4+128 : unID=unID+1
				hotspot gs_sash_thk*sin(90)+a/2*sin(0), gs_sash_thk*cos(90)+a/2*cos(0), 0, unID, openingAngle_02, 7 : unID=unID+1
				hotspot gs_sash_thk*sin(180+openingAngle_02)+a/2*sin(90+openingAngle_02), gs_sash_thk*cos(180+openingAngle_02)+a/2*cos(90+openingAngle_02), (0), unID, openingAngle_02, 5 : unID=unID+1
				hotspot 0, -gs_sash_thk, (0), unID, openingAngle_02, 6 : unID=unID+1
			endif
			if CasementID = 3 then
				hotspot gs_sash_thk*sin(135)+a/2*sin(90), gs_sash_thk*cos(135)+a/2*cos(90), (0), unID, openingAngle_03, 4+128 : unID=unID+1
				hotspot gs_sash_thk*sin(90)+a/2*sin(0), gs_sash_thk*cos(90)+a/2*cos(0), 0, unID, openingAngle_03, 7 : unID=unID+1
				hotspot gs_sash_thk*sin(180+openingAngle_03)+a/2*sin(90+openingAngle_03), gs_sash_thk*cos(180+openingAngle_03)+a/2*cos(90+openingAngle_03), (0), unID, openingAngle_03, 5 : unID=unID+1
				hotspot 0, -gs_sash_thk, (0), unID, openingAngle_03, 6 : unID=unID+1
			endif
			if CasementID = 4 then
				hotspot gs_sash_thk*sin(135)+a/2*sin(90), gs_sash_thk*cos(135)+a/2*cos(90), (0), unID, openingAngle_04, 4+128 : unID=unID+1
				hotspot gs_sash_thk*sin(90)+a/2*sin(0), gs_sash_thk*cos(90)+a/2*cos(0), 0, unID, openingAngle_04, 7 : unID=unID+1
				hotspot gs_sash_thk*sin(180+openingAngle_04)+a/2*sin(90+openingAngle_04), gs_sash_thk*cos(180+openingAngle_04)+a/2*cos(90+openingAngle_04), (0), unID, openingAngle_04, 5 : unID=unID+1
				hotspot 0, -gs_sash_thk, (0), unID, openingAngle_04, 6 : unID=unID+1
			endif
			if CasementID = 5 then
				hotspot gs_sash_thk*sin(135)+a/2*sin(90), gs_sash_thk*cos(135)+a/2*cos(90), (0), unID, openingAngle_05, 4+128 : unID=unID+1
				hotspot gs_sash_thk*sin(90)+a/2*sin(0), gs_sash_thk*cos(90)+a/2*cos(0), 0, unID, openingAngle_05, 7 : unID=unID+1
				hotspot gs_sash_thk*sin(180+openingAngle_05)+a/2*sin(90+openingAngle_05), gs_sash_thk*cos(180+openingAngle_05)+a/2*cos(90+openingAngle_05), (0), unID, openingAngle_05, 5 : unID=unID+1
				hotspot 0, -gs_sash_thk, (0), unID, openingAngle_05, 6 : unID=unID+1
			endif
		endif

		del 2

!		if openingAngle>180 then openingAngle=0
		if openingAngle<>0 then
			addz gs_rebate_depth
			roty -openingAngle
			addz -gs_rebate_depth
		endif

		addy -b/2
	endif

! -----------------------------------------------------------------------------
	if gs_optype_m = SASH_TILT_TURN then

		mulx -1
		addx	-a/2
		addy 	b/2
		rotx -90

		addy	-gs_sash_thk/2
		if bEnableSEOpening then
			if CasementID = 1 then
				hotspot A,											-gs_sash_thk/2,								0, unID, openingAngle_01, 4+128 : unID=unID+1
				hotspot 0,											0,											1*eloj_ref, 			 unID, openingAngle_01, 7 : unID=unID+1
				hotspot A*sin(90+openingAngle_01)+gs_sash_thk/2*cos(90+openingAngle_01),A*cos(90+openingAngle_01)-gs_sash_thk/2*sin(90+openingAngle_01),0, unID, openingAngle_01, 5 : unID=unID+1
				hotspot 0, 											0, 											0, unID, openingAngle_01, 6 : unID=unID+1
			endif
			if CasementID = 2 then
				hotspot A,											-gs_sash_thk/2,								0, unID, openingAngle_02, 4+128 : unID=unID+1
				hotspot 0,											0,											1*eloj_ref, 			 unID, openingAngle_02, 7 : unID=unID+1
				hotspot A*sin(90+openingAngle_01)+gs_sash_thk/2*cos(90+openingAngle_02),A*cos(90+openingAngle_02)-gs_sash_thk/2*sin(90+openingAngle_02),0, unID, openingAngle_02, 5 : unID=unID+1
				hotspot 0, 											0, 											0, unID, openingAngle_02, 6 : unID=unID+1
			endif
			if CasementID = 3 then
				hotspot A,											-gs_sash_thk/2,								0, unID, openingAngle_03, 4+128 : unID=unID+1
				hotspot 0,											0,											1*eloj_ref, 			 unID, openingAngle_03, 7 : unID=unID+1
				hotspot A*sin(90+openingAngle_03)+gs_sash_thk/2*cos(90+openingAngle_03),A*cos(90+openingAngle_03)-gs_sash_thk/2*sin(90+openingAngle_03),0, unID, openingAngle_03, 5 : unID=unID+1
				hotspot 0, 											0, 											0, unID, openingAngle_03, 6 : unID=unID+1
			endif
			if CasementID = 4 then
				hotspot A,											-gs_sash_thk/2,								0, unID, openingAngle_04, 4+128 : unID=unID+1
				hotspot 0,											0,											1*eloj_ref, 			 unID, openingAngle_04, 7 : unID=unID+1
				hotspot A*sin(90+openingAngle_04)+gs_sash_thk/2*cos(90+openingAngle_04),A*cos(90+openingAngle_04)-gs_sash_thk/2*sin(90+openingAngle_04),0, unID, openingAngle_04, 5 : unID=unID+1
				hotspot 0, 											0, 											0, unID, openingAngle_04, 6 : unID=unID+1
			endif
			if CasementID = 5 then
				hotspot A,											-gs_sash_thk/2,								0, unID, openingAngle_05, 4+128 : unID=unID+1
				hotspot 0,											0,											1*eloj_ref, 			 unID, openingAngle_05, 7 : unID=unID+1
				hotspot A*sin(90+openingAngle_05)+gs_sash_thk/2*cos(90+openingAngle_05),A*cos(90+openingAngle_05)-gs_sash_thk/2*sin(90+openingAngle_05),0, unID, openingAngle_05, 5 : unID=unID+1
				hotspot 0, 											0, 											0, unID, openingAngle_05, 6 : unID=unID+1
			endif
		endif
		del 1

		del 4


		muly	-1
		rotz 	-90
		rotx	-90

		addy	-gs_sash_thk/2
		if bEnableSEOpening then
			if CasementID = 1 then
				hotspot B,											-gs_sash_thk/2,								0, unID, openingAngle2_01, 4+128 : unID=unID+1
				hotspot 0,											0,											1*eloj_ref, 			 unID, openingAngle2_01, 7 : unID=unID+1
				hotspot B*sin(90+openingAngle2_01)+gs_sash_thk/2*cos(90+openingAngle2_01),B*cos(90+openingAngle2_01)-gs_sash_thk/2*sin(90+openingAngle2_01),0, unID, openingAngle2_01, 5 : unID=unID+1
				hotspot 0, 											0, 											0, unID, openingAngle2_01, 6 : unID=unID+1
			endif
			if CasementID = 2 then
				hotspot B,											-gs_sash_thk/2,								0, unID, openingAngle2_02, 4+128 : unID=unID+1
				hotspot 0,											0,											1*eloj_ref, 			 unID, openingAngle2_02, 7 : unID=unID+1
				hotspot B*sin(90+openingAngle2_02)+gs_sash_thk/2*cos(90+openingAngle2_02),B*cos(90+openingAngle2_02)-gs_sash_thk/2*sin(90+openingAngle2_02),0, unID, openingAngle2_02, 5 : unID=unID+1
				hotspot 0, 											0, 											0, unID, openingAngle2_02, 6 : unID=unID+1
			endif
			if CasementID = 3 then
				hotspot B,											-gs_sash_thk/2,								0, unID, openingAngle2_03, 4+128 : unID=unID+1
				hotspot 0,											0,											1*eloj_ref, 			 unID, openingAngle2_03, 7 : unID=unID+1
				hotspot B*sin(90+openingAngle2_03)+gs_sash_thk/2*cos(90+openingAngle2_03),B*cos(90+openingAngle2_03)-gs_sash_thk/2*sin(90+openingAngle2_03),0, unID, openingAngle2_03, 5 : unID=unID+1
				hotspot 0, 											0, 											0, unID, openingAngle2_03, 6 : unID=unID+1
			endif
			if CasementID = 4 then
				hotspot B,											-gs_sash_thk/2,								0, unID, openingAngle2_04, 4+128 : unID=unID+1
				hotspot 0,											0,											1*eloj_ref, 			 unID, openingAngle2_04, 7 : unID=unID+1
				hotspot B*sin(90+openingAngle2_04)+gs_sash_thk/2*cos(90+openingAngle2_04),B*cos(90+openingAngle2_04)-gs_sash_thk/2*sin(90+openingAngle2_04),0, unID, openingAngle2_04, 5 : unID=unID+1
				hotspot 0, 											0, 											0, unID, openingAngle2_04, 6 : unID=unID+1
			endif
			if CasementID = 5 then
				hotspot B,											-gs_sash_thk/2,								0, unID, openingAngle2_05, 4+128 : unID=unID+1
				hotspot 0,											0,											1*eloj_ref, 			 unID, openingAngle2_05, 7 : unID=unID+1
				hotspot B*sin(90+openingAngle2_05)+gs_sash_thk/2*cos(90+openingAngle2_05),B*cos(90+openingAngle2_05)-gs_sash_thk/2*sin(90+openingAngle2_05),0, unID, openingAngle2_05, 5 : unID=unID+1
				hotspot 0, 											0, 											0, unID, openingAngle2_05, 6 : unID=unID+1
			endif
		endif
		del 1

		del 3

		if openingAngle2 <> 0 then
			muly	-1
			if openingAngle2>90 then openingAngle2=0
			if openingAngle2<>0 then
				addz gs_rebate_depth
				rotx -openingAngle2
				addz -gs_rebate_depth
			endif
			muly	-1
		endif

		gs_sash_mat2 = gs_sash_mat

		if openingAngle <> 0 then
			mulx -1
			addx	-a/2
			if openingAngle>90 then openingAngle=0
			if openingAngle<>0 then
				addz gs_rebate_depth
				roty -openingAngle
				addz -gs_rebate_depth
			endif
			addx a/2
			mulx -1
		endif
	endif

! -----------------------------------------------------------------------------
	if gs_optype_m = SASH_TILT_TURN_M then

		addx	-a/2
		addy 	b/2
		rotx -90

		addy	-gs_sash_thk/2
		if bEnableSEOpening then
			if CasementID = 1 then
				hotspot A,											-gs_sash_thk/2,								0, unID, openingAngle_01, 4+128 : unID=unID+1
				hotspot 0,											0,											-1*eloj_ref, 			 unID, openingAngle_01, 7 : unID=unID+1
				hotspot A*sin(90+openingAngle_01)+gs_sash_thk/2*cos(90+openingAngle_01),A*cos(90+openingAngle_01)-gs_sash_thk/2*sin(90+openingAngle_01),0, unID, openingAngle_01, 5 : unID=unID+1
				hotspot 0, 											0, 											0, unID, openingAngle_01, 6 : unID=unID+1
			endif
			if CasementID = 2 then
				hotspot A,											-gs_sash_thk/2,								0, unID, openingAngle_02, 4+128 : unID=unID+1
				hotspot 0,											0,											-1*eloj_ref, 			 unID, openingAngle_02, 7 : unID=unID+1
				hotspot A*sin(90+openingAngle_02)+gs_sash_thk/2*cos(90+openingAngle_02),A*cos(90+openingAngle_02)-gs_sash_thk/2*sin(90+openingAngle_02),0, unID, openingAngle_02, 5 : unID=unID+1
				hotspot 0, 											0, 											0, unID, openingAngle_02, 6 : unID=unID+1
			endif
			if CasementID = 3 then
				hotspot A,											-gs_sash_thk/2,								0, unID, openingAngle_03, 4+128 : unID=unID+1
				hotspot 0,											0,											-1*eloj_ref, 			 unID, openingAngle_03, 7 : unID=unID+1
				hotspot A*sin(90+openingAngle_03)+gs_sash_thk/2*cos(90+openingAngle_03),A*cos(90+openingAngle_03)-gs_sash_thk/2*sin(90+openingAngle_03),0, unID, openingAngle_03, 5 : unID=unID+1
				hotspot 0, 											0, 											0, unID, openingAngle_03, 6 : unID=unID+1
			endif
			if CasementID = 4 then
				hotspot A,											-gs_sash_thk/2,								0, unID, openingAngle_04, 4+128 : unID=unID+1
				hotspot 0,											0,											-1*eloj_ref, 			 unID, openingAngle_04, 7 : unID=unID+1
				hotspot A*sin(90+openingAngle_04)+gs_sash_thk/2*cos(90+openingAngle_04),A*cos(90+openingAngle_04)-gs_sash_thk/2*sin(90+openingAngle_04),0, unID, openingAngle_04, 5 : unID=unID+1
				hotspot 0, 											0, 											0, unID, openingAngle_04, 6 : unID=unID+1
			endif
			if CasementID = 5 then
				hotspot A,											-gs_sash_thk/2,								0, unID, openingAngle_05, 4+128 : unID=unID+1
				hotspot 0,											0,											-1*eloj_ref, 			 unID, openingAngle_05, 7 : unID=unID+1
				hotspot A*sin(90+openingAngle_05)+gs_sash_thk/2*cos(90+openingAngle_05),A*cos(90+openingAngle_05)-gs_sash_thk/2*sin(90+openingAngle_05),0, unID, openingAngle_05, 5 : unID=unID+1
				hotspot 0, 											0, 											0, unID, openingAngle_05, 6 : unID=unID+1
			endif
		endif
		del 1

		del 3

		muly	-1
		rotz 	-90
		rotx	-90

		addy	-gs_sash_thk/2
		if bEnableSEOpening then
			if CasementID = 1 then
				hotspot B,											-gs_sash_thk/2,								0, unID, openingAngle2_01, 4+128 : unID=unID+1
				hotspot 0,											0,											1*eloj_ref, 			 unID, openingAngle2_01, 7 : unID=unID+1
				hotspot B*sin(90+openingAngle2_01)+gs_sash_thk/2*cos(90+openingAngle2_01),B*cos(90+openingAngle2_01)-gs_sash_thk/2*sin(90+openingAngle2_01),0, unID, openingAngle2_01, 5 : unID=unID+1
				hotspot 0, 											0, 											0, unID, openingAngle2_01, 6 : unID=unID+1
			endif
			if CasementID = 2 then
				hotspot B,											-gs_sash_thk/2,								0, unID, openingAngle2_02, 4+128 : unID=unID+1
				hotspot 0,											0,											1*eloj_ref, 			 unID, openingAngle2_02, 7 : unID=unID+1
				hotspot B*sin(90+openingAngle2_01)+gs_sash_thk/2*cos(90+openingAngle2_02),B*cos(90+openingAngle2_02)-gs_sash_thk/2*sin(90+openingAngle2_02),0, unID, openingAngle2_02, 5 : unID=unID+1
				hotspot 0, 											0, 											0, unID, openingAngle2_02, 6 : unID=unID+1
			endif
			if CasementID = 3 then
				hotspot B,											-gs_sash_thk/2,								0, unID, openingAngle2_03, 4+128 : unID=unID+1
				hotspot 0,											0,											1*eloj_ref, 			 unID, openingAngle2_03, 7 : unID=unID+1
				hotspot B*sin(90+openingAngle2_03)+gs_sash_thk/2*cos(90+openingAngle2_03),B*cos(90+openingAngle2_03)-gs_sash_thk/2*sin(90+openingAngle2_03),0, unID, openingAngle2_03, 5 : unID=unID+1
				hotspot 0, 											0, 											0, unID, openingAngle2_03, 6 : unID=unID+1
			endif
			if CasementID = 4 then
				hotspot B,											-gs_sash_thk/2,								0, unID, openingAngle2_04, 4+128 : unID=unID+1
				hotspot 0,											0,											1*eloj_ref, 			 unID, openingAngle2_04, 7 : unID=unID+1
				hotspot B*sin(90+openingAngle2_04)+gs_sash_thk/2*cos(90+openingAngle2_04),B*cos(90+openingAngle2_04)-gs_sash_thk/2*sin(90+openingAngle2_04),0, unID, openingAngle2_04, 5 : unID=unID+1
				hotspot 0, 											0, 											0, unID, openingAngle2_04, 6 : unID=unID+1
			endif
			if CasementID = 5 then
				hotspot B,											-gs_sash_thk/2,								0, unID, openingAngle2_05, 4+128 : unID=unID+1
				hotspot 0,											0,											1*eloj_ref, 			 unID, openingAngle2_05, 7 : unID=unID+1
				hotspot B*sin(90+openingAngle2_05)+gs_sash_thk/2*cos(90+openingAngle2_05),B*cos(90+openingAngle2_05)-gs_sash_thk/2*sin(90+openingAngle2_05),0, unID, openingAngle2_05, 5 : unID=unID+1
				hotspot 0, 											0, 											0, unID, openingAngle2_05, 6 : unID=unID+1
			endif
		endif
		del 1

		del 3

		if abs(openingAngle2) > EPS then
			muly	-1

			if openingAngle2>90 then openingAngle2=0
			if openingAngle2<>0 then
				addz gs_rebate_depth
				rotx -openingAngle2
				addz -gs_rebate_depth
			endif
			muly	-1
		endif


		if openingAngle <> 0 then
			addx	-a/2

			if openingAngle>90 then openingAngle=0
			if openingAngle<>0 then
				addz gs_rebate_depth
				roty -openingAngle
				addz -gs_sash_thk/2
			endif
			addx a/2
		endif
	endif

endif


! =============================================================================
! Frame Model
! =============================================================================

if gs_penSash_fg < 1 then gs_penSash_fg = SYMB_FILL_PEN

sect_fill gs_fillSash, gs_penSash_bg, gs_penSash_fg, gs_frame_pen_cont

if iMullionStyle <> MULLION_CUSTOM & iMullionStyle <> MULLION_SOLID_PANEL then		! Don't draw in case of Custom Panel

	var_mater		= gs_frame_mat	! Sash front material
	var_mater2		= gs_frame_mat2	! Sash back material
	var_mater_side	= gs_frame_mat	! Sash side material

	if gs_frame_mat = gs_frame_mat2 then
		in_out_cikl = 1

		out_thk = 0
		part_thk = gs_sash_thk

		in_out_mask = 15
		in_out_mask2 = 13 + 2 * (gs_SashText_typ_num = 1)
		in_out_mask3 = 13 + 2 * (gs_SashText_typ_num = 1)
	else												! two bodies
		in_out_cikl = 2

		if not(bOpeningDirectionInside) then
			tempMat = var_mater
			var_mater = var_mater2
			var_mater2 = tempMat

			var_mater_side	= gs_frame_mat2
		else
			var_mater_side	= gs_frame_mat
		endif

		out_thk = gs_sash_thk/2 - gs_glass_thk/2
		part_thk = out_thk

		in_out_mask = 11
		in_out_mask2 = 9
		in_out_mask3 = 9 + 2 * (gs_SashText_typ_num = 1)
	endif


	matGrillSide	= gs_grill_mat
	matGrillTop		= gs_grill_mat2
	matGrillBottom	= gs_grill_mat2

	if (gs_grill_mat = gs_grill_mat2) |\
		iMullionPosition <> MULLION_THROUGHOUT |\
		(iMullionPosition = MULLION_THROUGHOUT & gs_glass_thk >= gth) then

		in_out_cikl_gr	= 1

		part_thk_grill	= gth

		if iMullionPosition = MULLION_INSIDE then
			matGrillSide	= gs_grill_mat2
		else
			matGrillSide	= gs_grill_mat
		endif
		if not(bOpeningDirectionInside) then
			matGrillTop		= gs_grill_mat
			matGrillBottom	= gs_grill_mat2
		else
			matGrillTop		= gs_grill_mat2
			matGrillBottom	= gs_grill_mat
		endif
	else
		in_out_cikl_gr	= 2

		out_thk_grill	= gth/2 - gs_glass_thk/2
		part_thk_grill	= out_thk_grill

		if not(bOpeningDirectionInside) then
			matGrillSide	= gs_grill_mat2
			matGrillTop		= gs_grill_mat
			matGrillBottom	= gs_grill_mat2
		else
			matGrillSide	= gs_grill_mat2
			matGrillTop		= gs_grill_mat2
			matGrillBottom	= gs_grill_mat
		endif
		if iMullionPosition = MULLION_INSIDE exor not(bOpeningDirectionInside) then
			matGrillSide	= gs_grill_mat2
		else
			matGrillSide	= gs_grill_mat
		endif
	endif

	pen gs_frame_pen
	material var_mater
	sect_fill gs_fillSash, gs_penSash_bg, gs_pensash_fg, gs_frame_pen_cont

	if bShowFrame & gs_optype_m <> SASH_FIXED then

		for ijk = 1 to in_out_cikl
			material var_mater2

			if gs_SashText_typ_num = 1 then
				base
				sprism_{2} var_mater2,var_mater2,var_mater2,
					4,
					0,0, 0,1, 0, 0,
					0,0, 0,1, part_thk, 0,
					-A/2+gs_sash_width,		gs_sash_width,		10,				var_mater2,
					-A/2,					0,					in_out_mask,	var_mater2,
					-A/2,					B + A/2 * dxRate,	10,				var_mater_side,
					-A/2+gs_sash_width,		topH1,				in_out_mask,	var_mater2

				sprism_{2} var_mater2,var_mater2,var_mater2,
					4,
					0,0, 0,1, 0, 0,
					0,0, 0,1, part_thk, 0,
					A/2-gs_sash_width,		gs_sash_width,		10,				var_mater2,
					A/2,					0,					in_out_mask,	var_mater_side,
					A/2,					B - A/2 * dxRate,	10,				var_mater2,
					A/2-gs_sash_width,		topH2,				in_out_mask,	var_mater2
				vert 0, 0, 0
				vert 0, 1, 0
				vert 1, 0, 0
				vert 0, 0, 1
				coor 2, -1, -2, -3, -4
				body 1

				base
				sprism_{2} var_mater2,var_mater2,var_mater2,
					4,
					0,0, 0,1, 0, 0,
					0,0, 0,1, part_thk, 0,
					-A/2,					B + A/2 * dxRate,	10,				var_mater2,
					-A/2+gs_sash_width,		topH1,				in_out_mask,	var_mater2,
					 A/2-gs_sash_width,		topH2,				10,				var_mater2,
					 A/2,					B - A/2 * dxRate,	in_out_mask,	var_mater_side
				vert 0, 0, 0
				vert cos(topAngle), -sin(topAngle), 0
				vert sin(topAngle),  cos(topAngle), 0
				vert 0, 0, 1
				coor 2, -1, -2, -3, -4
				body 1

				sprism_{2} var_mater2,var_mater2,var_mater2,
					4,
					0,0, 0,1, 0, 0,
					0,0, 0,1, part_thk, 0,
					 A/2,					-0,				10,				var_mater2,
					 A/2-gs_sash_width,		gs_sash_width,	in_out_mask,	var_mater2,
					-A/2+gs_sash_width,		gs_sash_width,	10,				var_mater2,
					-A/2,					-0,				in_out_mask,	var_mater_side

			endif

			if gs_SashText_typ_num = 2 then
				base
				sprism_{2} var_mater2,var_mater2,var_mater2,
					4,
					0,0, 0,1, 0, 0,
					0,0, 0,1, part_thk, 0,
					-A/2+gs_sash_width,		gs_sash_width,	10,				var_mater2,
					-A/2,					gs_sash_width,	in_out_mask2,	var_mater2,
					-A/2,					topH1,			8,				var_mater_side,
					-A/2+gs_sash_width,		topH1,			in_out_mask,	var_mater2

				sprism_{2} var_mater2,var_mater2,var_mater2,
					4,
					0,0, 0,1, 0, 0,
					0,0, 0,1, part_thk, 0,
					A/2-gs_sash_width,		gs_sash_width,	8,				var_mater2,
					A/2,					gs_sash_width,	in_out_mask2,	var_mater_side,
					A/2,					topH2,			8,				var_mater2,
					A/2-gs_sash_width,		topH2,			in_out_mask,	var_mater2
				vert 0, 0, 0
				vert 0, 1, 0
				vert 1, 0, 0
				vert 0, 0, 1
				coor 2, -1, -2, -3, -4
				body 1

				base
				sprism_{2} var_mater2,var_mater2,var_mater2,
					6,
					0,0, 0,1, 0, 0,
					0,0, 0,1, part_thk, 0,
					-A/2,					B + A/2 * dxRate,	in_out_mask,	var_mater_side,
					-A/2,					topH1,				8,				var_mater2,
					-A/2+gs_sash_width,		topH1,				in_out_mask,	var_mater2,
					 A/2-gs_sash_width,		topH2,				10,				var_mater2,
					 A/2,					topH2,				in_out_mask2,	var_mater_side,
					 A/2,					B - A/2 * dxRate,	in_out_mask,	var_mater_side
				vert 0, 0, 0
				vert cos(topAngle), -sin(topAngle), 0
				vert sin(topAngle),  cos(topAngle), 0
				vert 0, 0, 1
				coor 2, -1, -2, -3, -4
				body 1

				sprism_{2} var_mater2,var_mater2,var_mater2,
					6,
					0,0, 0,1, 0, 0,
					0,0, 0,1, part_thk, 0,
					 A/2,					-0,				in_out_mask,	var_mater_side,
					 A/2,					gs_sash_width,	8,				var_mater2,
					 A/2-gs_sash_width,		gs_sash_width,	in_out_mask,	var_mater2,
					-A/2+gs_sash_width,		gs_sash_width,	10,				var_mater2,
					-A/2,					gs_sash_width,	in_out_mask2,	var_mater_side,
					-A/2,					-0,				in_out_mask,	var_mater_side
			endif

			addz part_thk
			part_thk = gs_sash_thk - out_thk

			tempMat = var_mater
			var_mater = var_mater2
			var_mater2 = tempMat

			in_out_mask = 14
			in_out_mask2 = 12
			in_out_mask3 = 12
		next ijk

		del in_out_cikl
	endif
endif


! =============================================================================
! Glazing
! =============================================================================

body -1

if iMullionStyle <> MULLION_CUSTOM & iMullionStyle <> MULLION_SOLID_PANEL then		! Don't draw in case of Custom Panel

	pen gs_glass_pen
	material gs_glass_mat

	if lod3D = 5 then	! chinese
		addz -gs_frame_thk
		gl_chi_thk = gs_frame_thk
		gl_chi_mask = 13
	else
		if lod3D = 1 then	! Simple
			addz -gs_frame_thk/2 - gs_glass_thk/2
		else
			if gs_optype_m = SASH_FIXED then
				addz -gs_rebate_depth - gs_glass_thk/2
			else
				addz gs_sash_thk/2 - gs_glass_thk/2
			endif
		endif
		gl_chi_thk = gs_glass_thk
		gl_chi_mask = 5
	endif

	if gs_optype_m = SASH_FIXED then
		glassOffset = 0
	else
		glassOffset = gs_sash_width
	endif

	prism_ 5,gl_chi_thk,
		-A/2 + glassOffset,	glassOffset,	gl_chi_mask,
		 A/2 - glassOffset,	glassOffset,	gl_chi_mask,
		 A/2 - glassOffset,	topH2,			gl_chi_mask,
		-A/2 + glassOffset,	topH1,			gl_chi_mask,
		-A/2 + glassOffset,	glassOffset,	-1
	body -1

	del 1
endif


! ==============================================================================
! Opening Line
! ==============================================================================

if bOplines3d & (gs_optype_m <> SASH_FIXED) then
	sideHeightMod = 0
	topWidthMod = 0
	iOpeningType = gs_optype_m
	if gs_optype_m = SASH_TILT_TURN		then iOpeningType = SASH_SIDE_HUNG
	if gs_optype_m = SASH_TILT_TURN_M	then iOpeningType = SASH_SIDE_HUNG_M


	oplineGap = 0

	if lod3D = 5 then	! Chinese
		opLineDist = gs_frame_thk + 2 * oplineGap
		add -A/2 + gs_sash_width, gs_sash_width, 0
	else
		if lod3D = 1 then
			opLineDist = gs_glass_thk + 2 * oplineGap
			add -A/2 + gs_sash_width, gs_sash_width, 0
		else
			opLineDist = gs_sash_thk + 2 * oplineGap
			addx -A/2
		endif
	endif

	if (lod3D = 1 | lod3D = 5) then	! Simple, Chinese
		addz -gs_frame_thk/2
	else
		addz gs_sash_thk/2
	endif

	opLineHeight = B - 2 * gs_sash_width * (lod3D = 1 | lod3D = 5)

	if not(lod3D = 1 | lod3D = 5) then
		topH1 = B + A/2 * dxRate
		topH2 = B - A/2 * dxRate
	endif

	if	(iOpeningType = SASH_SIDE_HUNG & gs_opline_style_m = 1) | \
		(iOpeningType = SASH_SIDE_HUNG_M & gs_opline_style_m = 2) then opLineHeight = topH2 - gs_sash_width * (lod3D = 1 | lod3D = 5)
	if	(iOpeningType = SASH_SIDE_HUNG_M & gs_opline_style_m = 1) |\
		(iOpeningType = SASH_SIDE_HUNG & gs_opline_style_m = 2) then opLineHeight = topH1 - gs_sash_width * (lod3D = 1 | lod3D = 5)
	if iOpeningType = SASH_BOTTOM_HUNG then
		if gs_opline_style_m = 1 then
			opLineHeight = B - gs_sash_width * (1 + dyRate) * (lod3D = 1 | lod3D = 5)
		else
			opLineHeight = topH1 - gs_sash_width * (lod3D = 1 | lod3D = 5)
		endif
	endif
	if iOpeningType = SASH_SIDE_HUNG_M then sideHeightMod = (topH2 - topH1) / 2
	if iOpeningType = SASH_SIDE_HUNG then sideHeightMod = (topH1 - topH2) / 2
	if iOpeningType = SASH_BOTTOM_HUNG & gs_opline_style_m = 2 then
		topWidthMod = topH1 - topH2
	endif

	addz -opLineDist/2
	call "OpeningLines" parameters a = a - 2 * gs_sash_width * (lod3D = 1 | lod3D = 5),
				b					= opLineHeight,
				frameThickness		= opLineDist,
				iOpeningType		= iOpeningType,
				opLineType3dIn		= opLineType3dIn,
				opLineType3dOut		= opLineType3dOut,
				gs_opLinePen		= gs_opLinePen,
				gs_opline_style_m	= gs_opline_style_m,
				sideHeightMod		= sideHeightMod,
				topWidthMod			= topWidthMod

	if gs_optype_m = SASH_TILT_TURN | gs_optype_m = SASH_TILT_TURN_M then
		if gs_opline_style_m = 1 then
			opLineHeight = B - gs_sash_width * (1 + dyRate) * (lod3D = 1 | lod3D = 5)
		else
			opLineHeight = topH1 - gs_sash_width * (lod3D = 1 | lod3D = 5)
		endif
		if (gs_optype_m = SASH_TILT_TURN | gs_optype_m = SASH_TILT_TURN_M) & gs_opline_style_m = 2 then
			topWidthMod = topH1 - topH2
		endif

		call "OpeningLines" parameters a = a - 2 * gs_sash_width * (lod3D = 1 | lod3D = 5),
			b					= opLineHeight,
			frameThickness		= opLineDist,
			iOpeningType		= SASH_BOTTOM_HUNG,
			opLineType3dIn		= opLineType3dIn,
			opLineType3dOut		= opLineType3dOut,
			gs_opLinePen		= gs_opLinePen,
			gs_opline_style_m	= gs_opline_style_m,
			sideHeightMod		= 0,
			topWidthMod			= topWidthMod
	endif
	del 3
endif


! =============================================================================
! Grids
! =============================================================================

pen gs_frame_pen

if iMullionPosition = MULLION_THROUGHOUT then
	gz = (gs_optype_m <> SASH_FIXED) * gs_sash_thk/2 - gth/2
else
	if (iMullionPosition = MULLION_INSIDE) exor not(bOpeningDirectionInside) then
		gz = (gs_optype_m <> SASH_FIXED) * gs_sash_thk/2 + gs_glass_thk/2
	else
		gz = (gs_optype_m <> SASH_FIXED) * gs_sash_thk/2 - gs_glass_thk/2 - gth
	endif
endif
gz = gz - (gs_optype_m = SASH_FIXED) * gs_rebate_depth


! -----------------------------------------------------------------------------
! H-V GRID
! -----------------------------------------------------------------------------

if iMullionStyle = MULLION_HVGRID then

	hgnn = ((A - 2 * gs_sash_width + gw + 2*fix_sh_grmod) / (vgn + 1)) - gw

	if gs_grill_mat = gs_grill_mat2 then				! One body, in case of similar materials
		in_out_cikl_gr = 1

		var_mater_grill = gs_grill_mat
		var_mater2_grill = gs_grill_mat

		part_thk_grill = gth

	else
		if bOpeningDirectionInside then
			temp_grill_mat	= gs_grill_mat
			gs_grill_mat	= gs_grill_mat2
			gs_grill_mat2	= temp_grill_mat
		endif

		var_mater_grill = gs_grill_mat
		var_mater2_grill = gs_grill_mat2

		if iMullionPosition = MULLION_INSIDE or iMullionPosition = MULLION_OUTSIDE or (iMullionPosition = MULLION_THROUGHOUT and gs_glass_thk>=gth ) then		!!Inside, Outside position
			in_out_cikl_gr = 1
			out_thk_grill = gth
			part_thk_grill = out_thk_grill
		else									!!Throughout position
			in_out_cikl_gr = 2
			out_thk_grill = gth/2 - gs_glass_thk/2
			part_thk_grill = out_thk_grill
		endif

	endif

	if iMullionPosition = MULLION_INSIDE then
		side_mat = var_mater2_grill
	else
		side_mat = var_mater_grill
	endif


	pen gs_frame_pen
	material gs_grill_mat


	if gs_optype_m = SASH_FIXED then
		addy B - gs_rebate_width * (dyRate - 1)
	else
		addy B - gs_sash_width * dyRate
	endif
	rotx -90
	roty topAngle
	cutplane	! Cutplane at Top
	del 3

	if gs_optype_m = SASH_FIXED then
		glassOffset = gs_rebate_width
	else
		glassOffset = gs_sash_width
	endif

	for ijk = 1 to in_out_cikl_gr

		if ijk = 1 then
			currentGrillThickness = part_thk_grill
		else
			currentGrillThickness = gth - out_thk_grill
		endif

		base

		! Vertical Grids
		if vgn > 0 then
			for i=1 to vgn
				addx (a-2*gs_sash_width+gw+2*fix_sh_grmod)/(vgn+1)
				add  -a/2+gs_sash_width-gw/2-fix_sh_grmod, 0, gz
				if gw > EPS then
					sprism_ matGrillTop,matGrillBottom,matGrillSide,
						5,
						0,0, 0,1, currentGrillThickness, 0,
						-gw/2,gs_sash_width-fix_sh_grmod,	15,
						 gw/2,gs_sash_width-fix_sh_grmod,	15,
						 gw/2,max(topH1, topH2),15,
						-gw/2,max(topH1, topH2),15,
						-gw/2,gs_sash_width-fix_sh_grmod,	-1
				else
					lin_ 0,gs_sash_width-fix_sh_grmod,0, 0,max(topH1, topH2),0
				endif
				del 1
			next i
			del vgn
			vert 0, 0, 0
			vert 0, 1, 0
			vert 1, 0, 0
			vert 0, 0, 1
			coor 2, -1, -2, -3, -4
			body 1
		endif

		! Horizontal Grids
		if hgn > 0 then
			for i=1 to vgn+1
				for j=1 to hgn
					addy (max(topH1, topH2) - glassOffset + gw) / (hgn + 1)
					add -(A-2*gs_sash_width+2*fix_sh_grmod)/2+hgnn/2, gs_sash_width-gw/2-fix_sh_grmod, gz
					if gw > EPS then
						sprism_ matGrillTop,matGrillBottom,matGrillSide,
							5,
							0,0, 0,1, currentGrillThickness, 0,
							-hgnn/2,-gw/2,15,
							 hgnn/2,-gw/2,15,
							 hgnn/2, gw/2,15,
							-hgnn/2, gw/2,15,
							-hgnn/2,-gw/2,-1
					else
						lin_ -hgnn/2,0,0, hgnn/2,0,0
					endif
					del 1
				next j
				del hgn
				addx (a-2*gs_sash_width+gw+2*fix_sh_grmod)/(vgn+1)
			next i
			del vgn+1
			body -1
		endif

		addz currentGrillThickness

		matGrillSide = matGrillTop

	next ijk
	del in_out_cikl_gr

	cutend
endif

! =============================================================================
! Solid Panel
! =============================================================================

if iMullionStyle = MULLION_SOLID_PANEL then

	sprism_{2} gs_panel_mat2, gs_panel_mat, gs_panel_mat2,
		4,
		0,0, 0,1, 0, 0,
		0,0, 0,1, gs_sash_thk, 0,
		-A/2,	0,					15,	gs_panel_mat2,
		-A/2,	B + A/2 * dxRate,	15,	gs_panel_mat2,
		A/2,	B - A/2 * dxRate,	15,	gs_panel_mat2,
		A/2,	0,					15,	gs_panel_mat2

endif

! =============================================================================
! Custom Panel
! =============================================================================

if iMullionStyle = MULLION_CUSTOM & gs_cust_panel <> "" then

	addy B - (gs_optype_m = SASH_FIXED) * gs_rebate_width * (dyRate - 1)
	rotx -90
	roty topAngle
	cutplane
	del 3

	if gs_optype_m = SASH_FIXED then
		addz -gs_rebate_depth - gs_glass_thk/2
		panelThk = gs_glass_thk
	else
		panelThk = gs_sash_thk
	endif
	BB = B + A/2 * tan(topAngle) - (gs_optype_m = SASH_FIXED) * gs_rebate_width * (1 / cos(topAngle) - 1)

	addx -A/2
	call "Window_Panel_Collection" parameters A=A, B=BB, zzyzx=panelThk, gs_ptype=gs_cust_panel
	del 1

	if gs_optype_m = SASH_FIXED then del 1

	cutend
endif

]]>
</Script_3D>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_1D SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[
EPS = 0.0001

! iMullionStyle:
MULLION_NONE			= 1
MULLION_HVGRID			= 2
MULLION_EDITABLEGRID	= 3
MULLION_CUSTOM			= 4
MULLION_PRAIRIE			= 5
MULLION_DIVIDED			= 6
!MULLION_SUNBURST_1		= 7
!MULLION_SUNBURST_2		= 8
!MULLION_SUNBURST_3		= 9
!MULLION_SUNBURST_4		= 10
!MULLION_SUNBURST_5		= 11
!MULLION_SUNBURST_6		= 12
!MULLION_SOLID_GLAZED	= 13
!MULLION_DIVIDED_FRAME	= 14
MULLION_SOLID_PANEL		= 15
!MULLION_VENT_PANEL		= 16
!MULLION_FRENCH_PANEL	= 17

! iMullionPosition:
MULLION_OUTSIDE		= 1
MULLION_INSIDE		= 2
MULLION_THROUGHOUT	= 3

! gs_optype_m:
SASH_FIXED					= 1		! Fixed Glass
SASH_FIXED_SCREW			= 2		! Fixed Sash
SASH_SIDE_HUNG				= 3		! Side Hung
SASH_SIDE_HUNG_M			= 4		! Side Hung Mirrored
SASH_TILT_TURN				= 5		! Tilt and Turn
SASH_TILT_TURN_M			= 6		! Tilt and Turn Mirrored
SASH_BOTTOM_HUNG			= 7		! Bottom Hung
SASH_TOP_HUNG				= 8		! Top Hung
SASH_HOR_PIVOT				= 9		! Horizontal Pivot Hung
SASH_VER_PIVOT				= 10	! Vertical Pivotted
SASH_TILT_SLIDE				= 11	! Tilt and Slide
SASH_LEFT_SLIDING			= 12	! Left Sliding
SASH_RIGHT_SLIDING			= 13	! Right Sliding
SASH_UP_SLIDING				= 14	! Sliding Up
SASH_DOWN_SLIDING			= 15	! Sliding Down
SASH_VER_PIVOT_M			= 16	! Vertical Pivotted Mirrored
SASH_FIXED_SLIDE			= 17	! Fixed Sliding Sash
SASH_DOUBLE_SIDE_HUNG		= 18	! Double Sash
SASH_DOUBLE_TILT_TURN		= 19	! Double Tilt and Turn
SASH_DOUBLE_TILT_TURN_M		= 20	! Double Tilt and Turn Mirrored
SASH_SLIDING_HOR			= 21	! Sliding
SASH_SLIDING_HOR_M			= 22	! Sliding Mirrored
SASH_DOUBLE_SLIDING_HOR		= 23	! Double Sliding
SASH_DOUBLE_SLIDING_HOR_M	= 24	! Double Sliding Mirrored
SASH_SLIDING_VER			= 25	! Single Hung
SASH_DOUBLE_SLIDING_VER		= 26	! Double Hung

if CasementID = 1 then
	openingAngle = openingAngle_01
	openingAngle2 = openingAngle2_01
	gs_optype_m = gs_optype_m_01
	iMullionStyle = iMullionStyle_01
	gs_cust_panel = gs_cust_panel_01
	vgn = vgn_01
	hgn = hgn_01
endif
if CasementID = 2 then
	openingAngle = openingAngle_02
	openingAngle2 = openingAngle2_02
	gs_optype_m = gs_optype_m_02
	iMullionStyle = iMullionStyle_02
	gs_cust_panel = gs_cust_panel_02
	vgn = vgn_02
	hgn = hgn_02
endif
if CasementID = 3 then
	openingAngle = openingAngle_03
	openingAngle2 = openingAngle2_03
	gs_optype_m = gs_optype_m_03
	iMullionStyle = iMullionStyle_03
	gs_cust_panel = gs_cust_panel_03
	vgn = vgn_03
	hgn = hgn_03
endif
if CasementID = 4 then
	openingAngle = openingAngle_04
	openingAngle2 = openingAngle2_04
	gs_optype_m = gs_optype_m_04
	iMullionStyle = iMullionStyle_04
	gs_cust_panel = gs_cust_panel_04
	vgn = vgn_04
	hgn = hgn_04
endif
if CasementID = 5 then
	openingAngle = openingAngle_05
	openingAngle2 = openingAngle2_05
	gs_optype_m = gs_optype_m_05
	iMullionStyle = iMullionStyle_05
	gs_cust_panel = gs_cust_panel_05
	vgn = vgn_05
	hgn = hgn_05
endif


bEnableSEOpening = (GLOB_CONTEXT <> 4 & GLOB_CONTEXT <> 6)

vgn = vgn - 1 !Grids->Panels
hgn = hgn - 1

if vgn<0 then vgn=0
if hgn<0 then hgn=0

dxRate = tan(topAngle)
dyRate = 1 / cos(topAngle)

if gs_optype_m = SASH_FIXED then
	topH1 = B + (A/2 - gs_rebate_width) * dxRate - gs_rebate_width * (dyRate + 1)
	topH2 = B - (A/2 - gs_rebate_width) * dxRate - gs_rebate_width * (dyRate + 1)
else
	topH1 = B + (A/2 - gs_sash_width) * dxRate - gs_sash_width * dyRate
	topH2 = B - (A/2 - gs_sash_width) * dxRate - gs_sash_width * dyRate
endif

]]>
</Script_1D>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_VL SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_VL>

<Comment SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Comment>

<ParamSection SectVersion="22" SectionFlags="0" SubIdent="0">
	<ParamSectHeader>
		<AutoHotspots>false</AutoHotspots>
		<WDLeftFrame>0</WDLeftFrame>
		<WDRightFrame>0</WDRightFrame>
		<WDTopFrame>0</WDTopFrame>
		<WDBotFrame>0</WDBotFrame>
		<LayFlags>65535</LayFlags>
		<WDMirrorThickness>0</WDMirrorThickness>
		<WDWallInset>0</WDWallInset>
	</ParamSectHeader>
	<Parameters>
		<Length Name="A">
			<Description><![CDATA["Dimension 1"]]></Description>
			<Fix/>
			<Value>1.016</Value>
		</Length>
		<Length Name="B">
			<Description><![CDATA["Dimension 2"]]></Description>
			<Fix/>
			<Value>2.032</Value>
		</Length>
		<Length Name="ZZYZX">
			<Description><![CDATA["Height"]]></Description>
			<Fix/>
			<Value>1</Value>
		</Length>
		<Boolean Name="AC_show2DHotspotsIn3D">
			<Description><![CDATA["Show 2D Hotspots in 3D"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>1</Value>
		</Boolean>
		<Length Name="ac_bottomlevel">
			<Description><![CDATA["Bottom Level"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>1</Value>
		</Length>
		<Length Name="ac_toplevel">
			<Description><![CDATA["Top Level"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Integer Name="CasementID">
			<Description><![CDATA[""]]></Description>
			<Value>1</Value>
		</Integer>
		<Integer Name="lod3D">
			<Description><![CDATA["3D Detail"]]></Description>
			<Value>2</Value>
		</Integer>
		<Angle Name="topAngle">
			<Description><![CDATA["Top Angle"]]></Description>
			<Value>0</Value>
		</Angle>

		<!-- gs_options: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="gs_options">
			<Description><![CDATA["Options"]]></Description>
		</Title>
		<Boolean Name="gs_full_edit">
			<Description><![CDATA["Fully Editable"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>

		<!-- gs_window_frame: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="gs_window_frame">
			<Description><![CDATA["Window Frame"]]></Description>
		</Title>
		<Boolean Name="bOpeningDirectionInside">
			<Description><![CDATA["Opening Direction"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Length Name="gs_frame_thk">
			<Description><![CDATA["Frame Thickness"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.05</Value>
		</Length>
		<Length Name="gs_frame_width">
			<Description><![CDATA["Frame Width"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.07</Value>
		</Length>

		<!-- gs_window_sash: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="gs_window_sash">
			<Description><![CDATA["Sash Frame"]]></Description>
		</Title>
		<Length Name="gs_rebate_width">
			<Description><![CDATA["Rebate Width"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.025</Value>
		</Length>
		<Length Name="gs_rebate_depth">
			<Description><![CDATA["Rebate Depth"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.025</Value>
		</Length>
		<Length Name="gs_sash_thk">
			<Description><![CDATA["Sash Frame Thickness"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.05</Value>
		</Length>
		<Length Name="gs_sash_width">
			<Description><![CDATA["Sash Frame Width"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.05</Value>
		</Length>
		<String Name="gs_cust_panel_01">
			<Description><![CDATA["Custom Panel Name"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="gs_cust_panel_02">
			<Description><![CDATA["Custom Panel Name"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="gs_cust_panel_03">
			<Description><![CDATA["Custom Panel Name"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="gs_cust_panel_04">
			<Description><![CDATA["Custom Panel Name"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="gs_cust_panel_05">
			<Description><![CDATA["Custom Panel Name"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<Integer Name="iMullionStyle_01">
			<Description><![CDATA["Grid Style"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Integer>
		<Integer Name="iMullionStyle_02">
			<Description><![CDATA["Grid Style"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Integer>
		<Integer Name="iMullionStyle_03">
			<Description><![CDATA["Grid Style"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Integer>
		<Integer Name="iMullionStyle_04">
			<Description><![CDATA["Grid Style"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Integer>
		<Integer Name="iMullionStyle_05">
			<Description><![CDATA["Grid Style"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Integer>
		<Integer Name="iMullionPosition">
			<Description><![CDATA["Grid Position"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Integer>
		<Length Name="gw">
			<Description><![CDATA["Grid Width"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.03</Value>
		</Length>
		<Length Name="gth">
			<Description><![CDATA["Grid Thickness"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.04</Value>
		</Length>
		<Integer Name="vgn_01">
			<Description><![CDATA["Panes Number Horizontally"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>2</Value>
		</Integer>
		<Integer Name="hgn_01">
			<Description><![CDATA["Panes Number Vertically"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>3</Value>
		</Integer>
		<Integer Name="vgn_02">
			<Description><![CDATA["Panes Number Horizontally"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Integer>
		<Length Name="hgn_02">
			<Description><![CDATA["Panes Number Vertically"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Integer Name="vgn_03">
			<Description><![CDATA["Panes Number Horizontally"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Integer>
		<Length Name="hgn_03">
			<Description><![CDATA["Panes Number Vertically"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Integer Name="vgn_04">
			<Description><![CDATA["Panes Number Horizontally"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Integer>
		<Length Name="hgn_04">
			<Description><![CDATA["Panes Number Vertically"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Integer Name="vgn_05">
			<Description><![CDATA["Panes Number Horizontally"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Integer>
		<Length Name="hgn_05">
			<Description><![CDATA["Panes Number Vertically"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Length Name="gs_glass_thk">
			<Description><![CDATA["Glass Thickness"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.02</Value>
		</Length>

		<!-- gs_opening: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="gs_opening">
			<Description><![CDATA["Sash Opening"]]></Description>
		</Title>
		<Integer Name="gs_optype_m_01">
			<Description><![CDATA["Opening Type"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Integer>
		<Integer Name="gs_optype_m_02">
			<Description><![CDATA["Opening Type"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Integer>
		<Integer Name="gs_optype_m_03">
			<Description><![CDATA["Opening Type"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Integer>
		<Integer Name="gs_optype_m_04">
			<Description><![CDATA["Opening Type"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Integer>
		<Integer Name="gs_optype_m_05">
			<Description><![CDATA["Opening Type"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Integer>
		<Angle Name="openingAngle_01">
			<Description><![CDATA["Opening Angle"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Angle>
		<Angle Name="openingAngle2_01">
			<Description><![CDATA["Opening Angle"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Angle>
		<Angle Name="openingAngle_02">
			<Description><![CDATA["Opening Angle"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Angle>
		<Angle Name="openingAngle2_02">
			<Description><![CDATA["Opening Angle"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Angle>
		<Angle Name="openingAngle_03">
			<Description><![CDATA["Opening Angle"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Angle>
		<Angle Name="openingAngle2_03">
			<Description><![CDATA["Opening Angle"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Angle>
		<Angle Name="openingAngle_04">
			<Description><![CDATA["Opening Angle"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Angle>
		<Angle Name="openingAngle2_04">
			<Description><![CDATA["Opening Angle"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Angle>
		<Angle Name="openingAngle_05">
			<Description><![CDATA["Opening Angle"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Angle>
		<Angle Name="openingAngle2_05">
			<Description><![CDATA["Opening Angle"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Angle>

		<!-- gs_2D_representation: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="gs_2D_representation">
			<Description><![CDATA["2D and Section Representation"]]></Description>
		</Title>
		<PenColor Name="gs_frame_pen_cont">
			<Description><![CDATA["Cut Line Pen"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</PenColor>
		<FillPattern Name="gs_fillSash">
			<Description><![CDATA["Sash Fill Type"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>16</Value>
		</FillPattern>
		<PenColor Name="gs_penSash_fg">
			<Description><![CDATA["Sash Fill Pen"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>91</Value>
		</PenColor>
		<PenColor Name="gs_penSash_bg">
			<Description><![CDATA["Sash Fill Background Pen"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>91</Value>
		</PenColor>

		<!-- gs_3D_representation: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="gs_3D_representation">
			<Description><![CDATA["3D Representation"]]></Description>
		</Title>
		<Integer Name="gs_SashText_typ_num">
			<Description><![CDATA["Frame Element Joinery"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>2</Value>
		</Integer>
		<PenColor Name="gs_frame_pen">
			<Description><![CDATA["Frame Pen"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>2</Value>
		</PenColor>
		<PenColor Name="gs_sash_pen">
			<Description><![CDATA["Sash Pen"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>2</Value>
		</PenColor>
		<PenColor Name="gs_glass_pen">
			<Description><![CDATA["Glass Pen"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>2</Value>
		</PenColor>

		<!-- gs_materials: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="gs_materials">
			<Description><![CDATA["Surfaces"]]></Description>
		</Title>
		<Material Name="gs_frame_mat">
			<Description><![CDATA["Sash Surface Outside"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>14</Value>
		</Material>
		<Material Name="gs_sash_mat">
			<Description><![CDATA["Sash Surface"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>15</Value>
		</Material>
		<Material Name="gs_frame_mat2">
			<Description><![CDATA["Sash Surface Inside"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>14</Value>
		</Material>
		<Material Name="gs_glass_mat">
			<Description><![CDATA["Glass Surface"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>24</Value>
		</Material>
		<Material Name="gs_grill_mat">
			<Description><![CDATA["Grid Surface Outside"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>15</Value>
		</Material>
		<Material Name="gs_grill_mat2">
			<Description><![CDATA["Grid Surface Inside"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>15</Value>
		</Material>
		<Material Name="gs_panel_mat">
			<Description><![CDATA["Solid Panel Surface Outside"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>15</Value>
		</Material>
		<Material Name="gs_panel_mat2">
			<Description><![CDATA["Solid Panel Surface Inside"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>15</Value>
		</Material>
		<Boolean Name="bOplines3d">
			<Description><![CDATA["Opening Line"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Boolean>
		<Integer Name="opLineType3dIn">
			<Description><![CDATA["Opening Line Type Inside"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Integer>
		<Integer Name="opLineType3dOut">
			<Description><![CDATA["Opening Line Type Outside"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Integer>
		<PenColor Name="gs_opLinePen">
			<Description><![CDATA["Opening Line Pen"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</PenColor>
		<Integer Name="gs_opline_style_m">
			<Description><![CDATA["Opening Line Style"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Integer>
		<Integer Name="sh_unID">
			<Description><![CDATA["Sash Hotspot ID"]]></Description>
			<Value>0</Value>
		</Integer>
	</Parameters>
</ParamSection>

<CalledMacros SectVersion="2" SectionFlags="0" SubIdent="0">
	<Macro>
		<MName><![CDATA["OpeningLines"]]></MName>
		<MainGUID>5EFCD68D-4776-4487-88E3-48DE50840CC3</MainGUID>
	</Macro>
	<Macro>
		<MName><![CDATA["Window_Panel_Collection"]]></MName>
		<MainGUID>20B3F785-D29B-4A41-AC59-1EBD5A753975</MainGUID>
	</Macro>
</CalledMacros>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_2D SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_2D>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_PR SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_PR>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_UI SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_UI>

<Copyright SectVersion="1" SectionFlags="0" SubIdent="0">
	<Author>GRAPHISOFT</Author>
	<License>
		<Type>CC BY-ND</Type>
		<Version>3.0</Version>
	</License>
</Copyright>

</Symbol>
