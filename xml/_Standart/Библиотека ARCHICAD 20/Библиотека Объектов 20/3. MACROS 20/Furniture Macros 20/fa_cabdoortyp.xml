<?xml version="1.0" encoding="UTF-8"?>
<Symbol IsArchivable="true" IsPlaceable="false" MainGUID="9E592AE0-AF1D-4BB9-9CF0-C8E3F1EF8715" MigrationValue="Normal" Owner="1196638531" Signature="1297307981" Version="38">
<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_3D SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[
! macro fa_cabdoortyp : draws different types of door panels as well as drawer panels. Used by the following object-groups: 
!	Appliances, 
!	Cabinets and Shelves, 
!	Kitchen Cabinets, 
!	Basins
! 	this macro is also called by macro: fa_nightTable


If ABS(cabdoortyp_unID-1)<EPS Then
	unID=200
Else
	unID=cabdoortyp_unID
EndIf


if gs_shadow=0 then SHADOW OFF

PEN gs_cont_pen

if door_h < 2 * doorframe_w + 0.1 then
	if gs_door_type_m = 7 or gs_door_type_m = 5 then gs_door_type_m = 12		! Style 10, 8 --> 5
	if gs_door_type_m = 6 or gs_door_type_m = 4 then gs_door_type_m = 11		! Style 9, 7 --> 4
endif
if door_h < 2 * doorframe_w then
	if gs_door_type_m <> 99 and gs_door_type_m <> 6 then gs_door_type_m = 1
endif


ADD doorOffset/2, 0, doorOffset/2 											!!! Door offset for good rendering

! ================================================================
! 3D Hotspot Editing
! ================================================================


If gs_full_edit then
	if gs_door_type_m <> 0 then 
	    !*** knob placing
	    IF gs_detlevel_3D_m=2 OR GLOB_CONTEXT>20 and GLOB_CONTEXT<40 THEN 	!!! HTPS in 3D feedback and in Detailed Model

			if not(bBottomHung) then
			    rotz -door_ang
			else
				rotx door_ang
			endif

    		if ((gs_knob_type_m > 0) & bKnobNoneType) | (bKnob & not(bKnobNoneType)) then
		        IF not(UpperKnob) THEN
			        addz -toe_h+.09
			        hotspot door_w2-knob_pl_x, -fr_th1, 0, unID, knob_pl_y,1+128 : unID=unID+1
			        hotspot door_w2-knob_pl_x, -fr_th1, knob_pl_y, unID, knob_pl_y,2 : unID=unID+1
			        hotspot door_w2-knob_pl_x, -fr_th1, -1, unID, knob_pl_y,3 : unID=unID+1
        
			        hotspot door_w2,           -fr_th1, knob_pl_y, unID, knob_pl_x,1+128 : unID=unID+1
			        hotspot door_w2-knob_pl_x, -fr_th1, knob_pl_y, unID, knob_pl_x,2 : unID=unID+1
			        hotspot door_w2+1,         -fr_th1, knob_pl_y, unID, knob_pl_x,3 : unID=unID+1
			        del 1
		        ELSE
			        hotspot door_w2-knob_pl_x_up, -fr_th1, 0, 			unID, knob_pl_y_up,1+128 : unID=unID+1
			        hotspot door_w2-knob_pl_x_up, -fr_th1, knob_pl_y_up,unID, knob_pl_y_up,2 : unID=unID+1
			        hotspot door_w2-knob_pl_x_up, -fr_th1, -1, 			unID, knob_pl_y_up,3 : unID=unID+1
        
			        hotspot door_w2,			  -fr_th1, knob_pl_y_up, unID, knob_pl_x_up,1+128 : unID=unID+1
			        hotspot door_w2-knob_pl_x_up, -fr_th1, knob_pl_y_up, unID, knob_pl_x_up,2 : unID=unID+1
			        hotspot door_w2+1,			  -fr_th1, -1,			 unID, knob_pl_x_up,3 : unID=unID+1
		        ENDIF
			endif
    
		    DEL 1
	    ENDIF
    
	    IF not(UpperKnob) THEN

			if not(bBottomHung) then

				!! Opening around vertical axis !!
				addz -toe_h +.09
				hotspot 0, 0, knob_pl_y, unID, door_ang, 6+512 : unID=unID+1
				hotspot 0, 0, knob_pl_y, unID, door_ang, 7		: unID=unID+1
				hotspot door_w2-knob_pl_x, 0, knob_pl_y, unID, door_ang,4+128 : unID=unID+1
				rotz -door_ang
				hotspot door_w2-knob_pl_x,-fr_th1-knob_d, knob_pl_y,unID,door_ang,5 : unID=unID+1
				del 2

			else

				!! Opening around horizontal axis !!
				addx door_w2-knob_pl_x
				hotspot 0, 0, 0, unID, door_ang, 6 : unID=unID+1
				hotspot 1, 0, 0, unID, door_ang, 7		: unID=unID+1
				hotspot 0, 0, knob_pl_y, unID, door_ang,4+128 : unID=unID+1
				rotx door_ang
				hotspot 0, 0, knob_pl_y,unID,door_ang,5 : unID=unID+1
				del 2

			endif

	    ENDIF
	endif

ENDIF

! ================================================================
! Door Types 3D GEOMETRY
! ================================================================

IF door_w2<=0 or door_h2<=0 THEN
	end unID
endif

if not(bBottomHung) then
	rotz -door_ang
else
	rotx door_ang
endif

if door_w2<0.02 or door_h2<0.02 then
	gs_detlevel_3D_m = 1
endif
if GLOB_CONTEXT>20 and GLOB_CONTEXT<40 then
	gs_detlevel_3D_m = 1
endif

IF gs_detlevel_3D_m=1 THEN
	if gs_door_type_m = 0 then 
		END
	else
		gosub 1
	endif
else

	bDrawStandardKnob = 1
	if gs_door_type_m=0 then END							! no door panel
	if gs_door_type_m=1 then gosub "SimpleSolidDoor"		! simple solid panel
	if gs_door_type_m=2 then gosub "DoorType2"				 
	if gs_door_type_m=3 then gosub "DoorType3"				! door type 2 with glass
	if gs_door_type_m=4 then gosub "DoorType4"
	if gs_door_type_m=5 then gosub "DoorType5"				! door type 4 with glass
	if gs_door_type_m=6 then gosub "DoorType6"
	if gs_door_type_m=7 then gosub "DoorType7"				! door type 6 with glass
	if gs_door_type_m=8 then gosub "DoorType8"				! door type only for furniture
	if gs_door_type_m=9 then gosub "DoorType9"	
	if gs_door_type_m=10 or\
	 gs_door_type_m=99 then gosub 	"DoorTypeCustom"		! Custom Door
	if gs_door_type_m=11 then gosub "DoorType11"
	if gs_door_type_m=12 then gosub "DoorType12"			! door type 11 with glass

	if bDrawStandardKnob then
		if ((gs_knob_type_m > 0) & bKnobNoneType) | (bKnob& not(bKnobNoneType)) then
			if not(UpperKnob) THEN
				addz -toe_h+.09

				add door_w2-knob_pl_x,-fr_th1,knob_pl_y

				if iNumKnob = 2 then
					del 1	!del previous add for iNumKnob = 1
					add door_w2 * 0.5 + knob_pl_x - 0.079 + knob_size *(gs_knob_type_m > 3) , -fr_th1, knob_pl_y
				endif

				if gs_knob_type_m = 9 then
					reqBKnobs = 0
					success = LIBRARYGLOBAL ("LibraryGlobals13", "hideBKnobs", reqBKnobs)
					if (success = 0 or not(reqBKnobs)) and gs_cust_knob<>"" then
						addx -gs_customHandleHeight/2
						roty 90
						rotx 90
						call "Knob_Collection" parameters gs_ptype	= gs_cust_knob,
												a		= gs_customHandleLength,
												b		= gs_customHandleHeight,
												zzyzx	= gs_customHandleDepth
						del 3
					endif
				else
					call "fa_knobtyp" parameters all
				endif
				del 2

				if iNumKnob = 2 then
					add door_w2 * 0.5 -knob_pl_x + 0.079, -fr_th1, knob_pl_y
					if gs_knob_type_m = 9 then
						reqBKnobs = 0
						success = LIBRARYGLOBAL ("LibraryGlobals13", "hideBKnobs", reqBKnobs)
						if (success = 0 or not(reqBKnobs)) and gs_cust_knob<>"" then
							addx -gs_customHandleHeight/2
							roty 90
							rotx 90
							call "Knob_Collection" parameters gs_ptype	= gs_cust_knob,
													a		= gs_customHandleLength,
													b		= gs_customHandleHeight,
													zzyzx	= gs_customHandleDepth
							del 3
						endif
					else
						call "fa_knobtyp" parameters all
					endif
					del 1
				endif
			else
				add door_w2-knob_pl_x_up,-fr_th1,knob_pl_y_up

				if iNumKnob = 2 and not(bLowerDrawer) then 
					del 1 		!del previous add for iNumKnob = 1
					add door_w2 - knob_pl_x_up - 0.214, -fr_th1, door_h/2 + knob_pl_y_up - 0.385/3 + 0.03
					!the numbers are the default values of the calculated values of the positions x, y on a Lower Drawer
				endif

				if gs_knob_type_m = 9 then
					reqBKnobs = 0
					success = LIBRARYGLOBAL ("LibraryGlobals13", "hideBKnobs", reqBKnobs)
					if (success = 0 or not(reqBKnobs)) and gs_cust_knob<>"" then
						addx -gs_customHandleHeight/2
						roty 90
						rotx 90
						call "Knob_Collection" parameters gs_ptype	= gs_cust_knob,
												a		= gs_customHandleLength,
												b		= gs_customHandleHeight,
												zzyzx	= gs_customHandleDepth
						del 3
					endif
				else
					call "fa_knobtyp" parameters all
				endif
				del 1

				if iNumKnob = 2 and not(bLowerDrawer) then 
					add knob_pl_x_up + 0.214 + knob_size * (gs_knob_type_m>3), -fr_th1, knob_pl_y_up
					if gs_knob_type_m = 9 then
						reqBKnobs = 0
						success = LIBRARYGLOBAL ("LibraryGlobals13", "hideBKnobs", reqBKnobs)
						if (success = 0 or not(reqBKnobs)) and gs_cust_knob<>"" then
							addx -gs_customHandleHeight/2
							roty 90
							rotx 90
							call "Knob_Collection" parameters gs_ptype	= gs_cust_knob,
													a		= gs_customHandleLength,
													b		= gs_customHandleHeight,
													zzyzx	= gs_customHandleDepth
							del 3
						endif
					else
						call "fa_knobtyp" parameters all
					endif
					del 1
				endif
			endif
		endif
	endif

endif

del 2

! ================================================================
! ================================================================
END unID !END !END !END !END !END !END !END !END !END !END !END !END 
! ================================================================
! ================================================================




! ================================================================
! DOOR SUBROUTINES
! ================================================================


! ----------------------------------------------------------------
1:		!Type_Simple/Simple
! ----------------------------------------------------------------
MATERIAL doorframe_mat

fr_th2=0.01: frw=doorframe_w
fr_th3 = fr_th1-fr_th2

if gs_door_type_m<>3 and gs_door_type_m<>5 and gs_door_type_m<>7 then

	!***** door panel without glass

	ADDY -fr_th1

	BLOCK door_w2, fr_th1, door_h2

	DEL 1

	gosub 1000

else

	!***** door panel with glass

	ADDX door_w2/2
	ROTX 90

	material doorframe_mat

	base
		PRISM_	4,fr_th1,
				-door_w2/2+frw,0,15,
				door_w2/2-frw,0,10,
				door_w2/2-frw,frw,15,
				-door_w2/2+frw,frw,10
	vert 0, 0, 0
	vert 1, 0, 0
	vert 0, 1, 0
	vert 0, 0, 1

	coor 2, -1, -2, -3, -4
	body 1

	base
		PRISM_	6,fr_th1,
				door_w2/2,0,15,
				door_w2/2,door_h2,15,
				door_w2/2-frw,door_h2,10,
				door_w2/2-frw,door_h2-frw,15,
				door_w2/2-frw,frw,10,
				door_w2/2-frw,0,15
	vert 0, 0, 0
	vert 0, 1, 0
	vert -1, 0, 0
	vert 0, 0, -1

	coor 2, -1, -2, -3, -4
	body 1

	base
		PRISM_	4,fr_th1,
				-door_w2/2+frw,door_h2,15,
				door_w2/2-frw,door_h2,10,
				door_w2/2-frw,door_h2-frw,15,
				-door_w2/2+frw,door_h2-frw,10
	vert 0, 0, 0
	vert 1, 0, 0
	vert 0, 1, 0
	vert 0, 0, 1

	coor 2, -1, -2, -3, -4
	body 1

	base
		PRISM_	6,fr_th1,
				-door_w2/2,0,15,
				-door_w2/2,door_h2,15,
				-door_w2/2+frw,door_h2,10,
				-door_w2/2+frw,door_h2-frw,15,
				-door_w2/2+frw,frw,10,
				-door_w2/2+frw,0,15
	vert 0, 0, 0
	vert 0, 1, 0
	vert -1, 0, 0
	vert 0, 0, -1

	coor 2, -1, -2, -3, -4
	body 1

	material doorglas_mat

	PRISM_ 5,fr_th1,
			-door_w2/2+frw,frw,15,
			door_w2/2-frw,frw,15,
			door_w2/2-frw,door_h2-frw,15,
			-door_w2/2+frw,door_h2-frw,15,
			-door_w2/2+frw,frw,-1

	del 2

endif

return

! ----------------------------------------------------------------
"SimpleSolidDoor":					! DoorType1
! ----------------------------------------------------------------

	fr_th2=0.01
	fr_th3 = fr_th1-fr_th2
	!! fr_th1:	thickness
	!! fr_th2: 	hill_height

	ADDX door_w2/2
	ROTX 90

	MATERIAL doorframe_mat
	if gs_bevel then
		FPRISM_ doorframe_mat, doorframe_mat, doorframe_mat, doorframe_mat,
			4,fr_th1,45,fr_th2,
			-door_w2/2,0,15,
			door_w2/2,0,15,
			door_w2/2,door_h2,15,
			-door_w2/2,door_h2,15
	ELSE
		PRISM_ 	4,fr_th1,
				-door_w2/2,0,15,
				door_w2/2,0,15,
				door_w2/2,door_h2,15,
				-door_w2/2,door_h2,15
	endif

	gosub 1000

	DEL 2

return

! ----------------------------------------------------------------
"DoorType2":
! ----------------------------------------------------------------

fr_th2=0.01: frw=doorframe_w
fr_th3 = fr_th1-fr_th2
!! fr_th1:	thickness
!! fr_th2: 	hill_height

	IF door_w2<frw*2+0.03 OR door_h2<frw*2+0.03 THEN  gosub "SimpleSolidDoor"        ! simple door

ADDX door_w2/2
ROTX 90

MATERIAL doorframe_mat

if gs_bevel then
	base

	MATERIAL doorframe_mat
	PRISM_	5,fr_th2,
				-door_w2/2,0,15,
				door_w2/2,0,10,
				door_w2/2-frw,frw,12,
				-door_w2/2+frw,frw,10,
				-door_w2/2,0,-1
	ADDz fr_th2
	RULED 	5, 1+2+4+16+32+64,
				-door_w2/2,0,1,
				door_w2/2,0,1,
				door_w2/2-frw,frw,1,
				-door_w2/2+frw,frw,1,
				-door_w2/2,0,1,

				-door_w2/2+fr_th3,fr_th3,fr_th3,
				door_w2/2-fr_th3,fr_th3,fr_th3,
				door_w2/2-frw+fr_th3,frw-fr_th3,fr_th3,
				-door_w2/2+frw-fr_th3,frw-fr_th3,fr_th3,
				-door_w2/2+fr_th3,fr_th3,fr_th3
	DEL 1


	vert 0, 0, 0
	vert 1, 0, 0
	vert 0, 1, 0
	vert 0, 0, 1

	coor 2, -1, -2, -3, -4
	body 1

	base
	PRISM_	5,fr_th2,
				door_w2/2,0,15,
				door_w2/2,door_h2,10,
				door_w2/2-frw,door_h2-frw,12,
				door_w2/2-frw,frw,10,
				door_w2/2,0,-1

	ADDz fr_th2
	RULED 	5, 1+2+4+16+32+64,
				door_w2/2,0,1,
				door_w2/2,door_h2,1,
				door_w2/2-frw,door_h2-frw,1,
				door_w2/2-frw,frw,1,
				door_w2/2,0,-1,

				door_w2/2-fr_th3,fr_th3,fr_th3 ,
				door_w2/2-fr_th3,door_h2-fr_th3,fr_th3,
				door_w2/2-frw+fr_th3,door_h2-frw+fr_th3,fr_th3 ,
				door_w2/2-frw+fr_th3,frw-fr_th3,fr_th3 ,
				door_w2/2-fr_th3,fr_th3,fr_th3
	DEL 1


	vert 0, 0, 0
	vert 0, 1, 0
	vert -1, 0, 0
	vert 0, 0, -1

	coor 2, -1, -2, -3, -4
	body 1

	base
	PRISM_ 5,fr_th2,
				-door_w2/2,door_h2,15,
				door_w2/2,door_h2,10,
				door_w2/2-frw,door_h2-frw,12,
				-door_w2/2+frw,door_h2-frw,10,
				-door_w2/2,door_h2,-1

	ADDz fr_th2
	RULED 	5, 1+2+4+16+32+64,
				-door_w2/2,door_h2,1,
				door_w2/2,door_h2,1,
				door_w2/2-frw,door_h2-frw,1,
				-door_w2/2+frw,door_h2-frw,1,
				-door_w2/2,door_h2,1,

				door_w2/2-fr_th3,door_h2-fr_th3,fr_th3,
				door_w2/2-frw+fr_th3,door_h2-frw+fr_th3,fr_th3,
				-door_w2/2+frw-fr_th3,door_h2-frw+fr_th3,fr_th3,
				-door_w2/2+fr_th3,door_h2-fr_th3,fr_th3,
				door_w2/2-fr_th3,door_h2-fr_th3,fr_th3
	DEL 1

	vert 0, 0, 0
	vert 1, 0, 0
	vert 0, 1, 0
	vert 0, 0, 1

	coor 2, -1, -2, -3, -4
	body 1

	base

	PRISM_ 5,fr_th2,
				-door_w2/2,0,15,
				-door_w2/2,door_h2,10,
				-door_w2/2+frw,door_h2-frw,12,
				-door_w2/2+frw,frw,10,
				-door_w2/2,0,-1

	ADDz fr_th2
	RULED 	5, 1+2+4+16+32+64,
				-door_w2/2,0,1,
				-door_w2/2,door_h2,1,
				-door_w2/2+frw,door_h2-frw,1,
				-door_w2/2+frw,frw,1,
				-door_w2/2,0,-1,

				-door_w2/2+fr_th3,door_h2-fr_th3,fr_th3,
				-door_w2/2+frw-fr_th3,door_h2-frw+fr_th3,fr_th3 ,
				-door_w2/2+frw-fr_th3,frw-fr_th3,fr_th3 ,
				-door_w2/2+fr_th3,fr_th3,fr_th3,
				-door_w2/2+fr_th3,door_h2-fr_th3,fr_th3
	DEL 1


	vert 0, 0, 0
	vert 0, 1, 0
	vert -1, 0, 0
	vert 0, 0, -1

	coor 2, -1, -2, -3, -4
	body 1

	base

	If gs_detlevel_3D_m=2 then
		FPRISM_ doorframe_mat, doorframe_mat, doorframe_mat, doorframe_mat,
				4,fr_th1,45,fr_th2,
				-door_w2/2+frw,frw,14,
				door_w2/2-frw,frw,14,
				door_w2/2-frw,door_h2-frw,14,
				-door_w2/2+frw,door_h2-frw,14

		vert 0, 0, 0
		vert 0, 1, 0
		vert -1, 0, 0
		vert 0, 0, -1

		coor 2, -1, -2, -3, -4
		body 1
		del 2

	endif
else
	base
	PRISM_	4,fr_th1,
				-door_w2/2,0,15,
				door_w2/2,0,10,
				door_w2/2-frw,frw,12,
				-door_w2/2+frw,frw,10
	vert 0, 0, 0
	vert 1, 0, 0
	vert 0, 1, 0
	vert 0, 0, 1

	coor 2, -1, -2, -3, -4
	body 1

	base
	PRISM_	4,fr_th1,
				door_w2/2,0,15,
				door_w2/2,door_h2,10,
				door_w2/2-frw,door_h2-frw,12,
				door_w2/2-frw,frw,10
	vert 0, 0, 0
	vert 0, 1, 0
	vert -1, 0, 0
	vert 0, 0, -1

	coor 2, -1, -2, -3, -4
	body 1

	base
	PRISM_	4,fr_th1,
				-door_w2/2,door_h2,15,
				door_w2/2,door_h2,10,
				door_w2/2-frw,door_h2-frw,12,
				-door_w2/2+frw,door_h2-frw,10
	vert 0, 0, 0
	vert 1, 0, 0
	vert 0, 1, 0
	vert 0, 0, 1

	coor 2, -1, -2, -3, -4
	body 1

	base
	PRISM_	4,fr_th1,
				-door_w2/2,0,15,
				-door_w2/2,door_h2,10,
				-door_w2/2+frw,door_h2-frw,12,
				-door_w2/2+frw,frw,10
	vert 0, 0, 0
	vert 0, 1, 0
	vert -1, 0, 0
	vert 0, 0, -1

	coor 2, -1, -2, -3, -4
	body 1

	If gs_detlevel_3D_m=2 then
		base
		FPRISM_ doorframe_mat, doorframe_mat, doorframe_mat, doorframe_mat,
					4,fr_th1,45,fr_th2,
					-door_w2/2+frw,frw,14,
					door_w2/2-frw,frw,14,
					door_w2/2-frw,door_h2-frw,14,
					-door_w2/2+frw,door_h2-frw,14
		vert 0, 0, 0
		vert 0, 1, 0
		vert -1, 0, 0
		vert 0, 0, -1

		coor 2, -1, -2, -3, -4
		body 1
	endif

	Base
	PRISM_ 4,fr_th1-fr_th2,
			-door_w2/2+frw,frw,12,
			door_w2/2-frw,frw,12,
			door_w2/2-frw,door_h2-frw,12,
			-door_w2/2+frw,door_h2-frw,12
	vert 0, 0, 0
	vert 0, 1, 0
	vert -1, 0, 0
	vert 0, 0, -1

	coor 2, -1, -2, -3, -4
	body 1

	DEL 2

	gosub 1000

endif

return


! ----------------------------------------------------------------
"DoorType3":
! ----------------------------------------------------------------

fr_th2=0.01: frw=doorframe_w
fr_th3 = fr_th1-fr_th2
!! fr_th1:	thickness
!! fr_th2: 	hill_height

	IF A<frw*2+0.01+vert_gnum*0.016 OR door_h2<frw*2+0.01+hor_gnum*0.016 THEN gosub "SimpleSolidDoor"        ! simple door

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! *** Door Panel
ADDX door_w2/2
ROTX 90

if gs_bevel then
		group "frame_typ2"					!! Door Frame
	base
	MATERIAL doorframe_mat
		PRISM_ 5,fr_th2,
				-door_w2/2,0,15,
				door_w2/2,0,15,
				door_w2/2-frw,frw,15,
				-door_w2/2+frw,frw,15,
				-door_w2/2,0,-1

	ADDz fr_th2
	RULED 	5, 1+2+4+16+32+64,
				-door_w2/2,0,1,
				door_w2/2,0,1,
				door_w2/2-frw,frw,1,
				-door_w2/2+frw,frw,1,
				-door_w2/2,0,1,

				-door_w2/2+fr_th3,fr_th3,fr_th3,
				door_w2/2-fr_th3,fr_th3,fr_th3,
				door_w2/2-frw+fr_th3,frw-fr_th3,fr_th3,
				-door_w2/2+frw-fr_th3,frw-fr_th3,fr_th3,
				-door_w2/2+fr_th3,fr_th3,fr_th3
	DEL 1


	vert 0, 0, 0
	vert 1, 0, 0
	vert 0, 1, 0
	vert 0, 0, 1

	coor 2, -1, -2, -3, -4
	body 1

	base
	PRISM_ 5,fr_th2,
				door_w2/2,0,15,
				door_w2/2,door_h2,15,
				door_w2/2-frw,door_h2-frw,15,
				door_w2/2-frw,frw,15,
				door_w2/2,0,-1

	ADDz fr_th2
	RULED 	5, 1+2+4+16+32+64,
				door_w2/2,0,1,
				door_w2/2,door_h2,1,
				door_w2/2-frw,door_h2-frw,1,
				door_w2/2-frw,frw,1,
				door_w2/2,0,-1,

				door_w2/2-fr_th3,fr_th3,fr_th3 ,
				door_w2/2-fr_th3,door_h2-fr_th3,fr_th3,
				door_w2/2-frw+fr_th3,door_h2-frw+fr_th3,fr_th3 ,
				door_w2/2-frw+fr_th3,frw-fr_th3,fr_th3 ,
				door_w2/2-fr_th3,fr_th3,fr_th3
	DEL 1

	vert 0, 0, 0
	vert 0, 1, 0
	vert -1, 0, 0
	vert 0, 0, -1

	coor 2, -1, -2, -3, -4
	body 1

	base
	PRISM_	5,fr_th2,
			-door_w2/2,door_h2,15,
			door_w2/2,door_h2,15,
			door_w2/2-frw,door_h2-frw,15,
			-door_w2/2+frw,door_h2-frw,15,
			-door_w2/2,door_h2,-1

	ADDz fr_th2
	RULED 	5, 1+2+4+16+32+64,
				-door_w2/2,door_h2,1,
				door_w2/2,door_h2,1,
				door_w2/2-frw,door_h2-frw,1,
				-door_w2/2+frw,door_h2-frw,1,
				-door_w2/2,door_h2,1,

				door_w2/2-fr_th3,door_h2-fr_th3,fr_th3,
				door_w2/2-frw+fr_th3,door_h2-frw+fr_th3,fr_th3,
				-door_w2/2+frw-fr_th3,door_h2-frw+fr_th3,fr_th3,
				-door_w2/2+fr_th3,door_h2-fr_th3,fr_th3,
				door_w2/2-fr_th3,door_h2-fr_th3,fr_th3
	DEL 1

	vert 0, 0, 0
	vert 1, 0, 0
	vert 0, 1, 0
	vert 0, 0, 1

	coor 2, -1, -2, -3, -4
	body 1

	base
	PRISM_ 5,fr_th2,
				-door_w2/2,0,15,
				-door_w2/2,door_h2,15,
				-door_w2/2+frw,door_h2-frw,15,
				-door_w2/2+frw,frw,15,
				-door_w2/2,0,-1

	ADDz fr_th2
	RULED 	5, 1+2+4+16+32+64,
				-door_w2/2,0,1,
				-door_w2/2,door_h2,1,
				-door_w2/2+frw,door_h2-frw,1,
				-door_w2/2+frw,frw,1,
				-door_w2/2,0,-1,

				-door_w2/2+fr_th3,door_h2-fr_th3,fr_th3,
				-door_w2/2+frw-fr_th3,door_h2-frw+fr_th3,fr_th3 ,
				-door_w2/2+frw-fr_th3,frw-fr_th3,fr_th3 ,
				-door_w2/2+fr_th3,fr_th3,fr_th3,
				-door_w2/2+fr_th3,door_h2-fr_th3,fr_th3
	DEL 1

	vert 0, 0, 0
	vert 0, 1, 0
	vert -1, 0, 0
	vert 0, 0, -1

	coor 2, -1, -2, -3, -4
	body 1
	endgroup
	placegroup "frame_typ2"

	group "grill_typ2"
			gosub "GrillsOfLeaf"					!! Call Grill
	endgroup

	grills_typ1=subgroup("grill_typ2","frame_typ2")
	placegroup grills_typ1

	killgroup "frame_typ2"
	killgroup "grill_typ2"
	killgroup grills_typ1
else
	group "frame_typ1"					!! Door Frame

	MATERIAL doorframe_mat

	base
		PRISM_	4,fr_th1,
				-door_w2/2,0,15,
				door_w2/2,0,15,
				door_w2/2-frw,frw,15,
				-door_w2/2+frw,frw,15
	vert 0, 0, 0
	vert 1, 0, 0
	vert 0, 1, 0
	vert 0, 0, 1

	coor 2, -1, -2, -3, -4
	body 1

	base
		PRISM_	4,fr_th1,
				door_w2/2,0,15,
				door_w2/2,door_h2,15,
				door_w2/2-frw,door_h2-frw,15,
				door_w2/2-frw,frw,15
	vert 0, 0, 0
	vert 0, 1, 0
	vert -1, 0, 0
	vert 0, 0, -1

	coor 2, -1, -2, -3, -4
	body 1

	base
		PRISM_	4,fr_th1,
				-door_w2/2,door_h2,15,
				door_w2/2,door_h2,15,
				door_w2/2-frw,door_h2-frw,15,
				-door_w2/2+frw,door_h2-frw,15
	vert 0, 0, 0
	vert 1, 0, 0
	vert 0, 1, 0
	vert 0, 0, 1

	coor 2, -1, -2, -3, -4
	body 1

	base
		PRISM_	4,fr_th1,
				-door_w2/2,0,15,
				-door_w2/2,door_h2,15,
				-door_w2/2+frw,door_h2-frw,15,
				-door_w2/2+frw,frw,15
	vert 0, 0, 0
	vert 0, 1, 0
	vert -1, 0, 0
	vert 0, 0, -1

	coor 2, -1, -2, -3, -4
	body 1
	gosub 1000

	endgroup

	placegroup "frame_typ1"

	group "grill_typ1"
			gosub "GrillsOfLeaf"					!! Call Grill
	endgroup

	grills_typ1=subgroup("grill_typ1","frame_typ1")
	placegroup grills_typ1

	killgroup "frame_typ1"
	killgroup "grill_typ1"
	killgroup grills_typ1

	BODY -1
endif

ADDZ fr_th1-fr_th2
MATERIAL doorglas_mat
POLY_ 4,						!! Window Glass
	-door_w2/2+doorframe_w,doorframe_w,1,
	door_w2/2-doorframe_w,doorframe_w,1,
	door_w2/2-doorframe_w,door_h2-doorframe_w,1,
	-door_w2/2+doorframe_w,door_h2-doorframe_w,1
BODY -1
DEL 1
DEL 2

return
! ----------------------------------------------------------------
"DoorType4":
! ----------------------------------------------------------------

fr_th2=0.01: frw=doorframe_w: segh1=0.08
!! fr_th1:	thickness
!! fr_th2: 	hill_height

seg_alfa=ATN(segh1/(door_w2/2-doorframe_w))
seg_beta=90-2*seg_alfa
segh2=(door_w2/2-doorframe_w)*tan(seg_beta)
seg_r=segh1+segh2					!! radius of segment
!!seg_gamma=180-2*(seg_alfa+seg_beta)
seg_gamma=4*seg_alfa

	IF door_w2<frw*2+0.03 OR door_h2<frw*2+0.03	THEN  gosub "SimpleSolidDoor"        ! simple door

ADDX door_w2/2
ROTX 90

MATERIAL doorframe_mat

if gs_bevel then
	FPRISM_ doorframe_mat, doorframe_mat, doorframe_mat, doorframe_mat,
			12,fr_th1,45,fr_th2,
			-door_w2/2,0,15,
			door_w2/2,0,15,
			door_w2/2,door_h2,15,
			-door_w2/2,door_h2,15,
			-door_w2/2,0,-1,
			-door_w2/2+frw,frw,12,
			door_w2/2-frw,frw,12,
			door_w2/2-frw,door_h2-frw-segh1,12,
			0,door_h2-frw-seg_r,900,
			0,seg_gamma,4000,
			-door_w2/2+frw,door_h2-frw-segh1,12,
			-door_w2/2+frw,frw,-1


	If gs_detlevel_3D_m=2 then
		FPRISM_ doorframe_mat, doorframe_mat, doorframe_mat, doorframe_mat,
				6,fr_th1,45,fr_th2,
				-door_w2/2+frw,frw,12,
				door_w2/2-frw,frw,12,
				door_w2/2-frw,door_h2-frw-segh1,12,
				0,door_h2-frw-seg_r,912,
				0,seg_gamma,4012,
				-door_w2/2+frw,door_h2-frw-segh1,12

	ENDIF
else
	base
		PRISM_	4,fr_th1,
				-door_w2/2+frw,0,13,
				door_w2/2-frw,0,8,
				door_w2/2-frw,frw,12,
				-door_w2/2+frw,frw,10
	vert 0, 0, 0
	vert 0, 1, 0
	vert -1, 0, 0
	vert 0, 0, -1


	coor 2, -1, -2, -3, -4
	body 1

	base
		PRISM_	6,fr_th1,
				door_w2/2,0,15,
				door_w2/2,door_h2,15,
				door_w2/2-frw,door_h2,8,
				door_w2/2-frw,door_h2-frw-segh1,12,
				door_w2/2-frw,frw,10,
				door_w2/2-frw,0,13
	vert 0, 0, 0
	vert 0, 1, 0
	vert -1, 0, 0
	vert 0, 0, -1

	coor 2, -1, -2, -3, -4
	body 1

	base
		RESOL 36
		PRISM_	6,fr_th1,
				door_w2/2-frw,door_h2,8,
				door_w2/2-frw,door_h2-frw-segh1,12,!1
				0,door_h2-frw-seg_r,900,
				0,seg_gamma,4000,
				-door_w2/2+frw,door_h2-frw-segh1,10,!2
				-door_w2/2+frw,door_h2,13
	vert 0, 0, 0
	vert 0, 1, 0
	vert -1, 0, 0
	vert 0, 0, -1

	coor 2, -1, -2, -3, -4
	body 1

	base
		PRISM_	6,fr_th1,
				-door_w2/2,0,15,
				-door_w2/2,door_h2,15,
				-door_w2/2+frw,door_h2,8,
				-door_w2/2+frw,door_h2-frw-segh1,12,
				-door_w2/2+frw,frw,10,
				-door_w2/2+frw,0,13
	vert 0, 0, 0
	vert 0, 1, 0
	vert -1, 0, 0
	vert 0, 0, -1

	coor 2, -1, -2, -3, -4
	body 1
	gosub 1000

	If gs_detlevel_3D_m=2 then
		base
			FPRISM_ doorframe_mat, doorframe_mat, doorframe_mat, doorframe_mat,
				6,fr_th1,45,fr_th2,
				-door_w2/2+frw,frw,12,
				door_w2/2-frw,frw,12,
				door_w2/2-frw,door_h2-frw-segh1,12,
				0,door_h2-frw-seg_r,912,
				0,seg_gamma,4012,
				-door_w2/2+frw,door_h2-frw-segh1,12
		vert 0, 0, 0
		vert 0, 1, 0
		vert -1, 0, 0
		vert 0, 0, -1

		coor 2, -1, -2, -3, -4
		body 1

		gosub 1000
	ENDIF
endif
MATERIAL doorframe_mat
base
PRISM_ 6,fr_th1-fr_th2,
		-door_w2/2+frw,frw,10,
		door_w2/2-frw,frw,10,
		door_w2/2-frw,door_h2-frw-segh1,12,
		0,door_h2-frw-seg_r,900,
		0,seg_gamma,4000,
		-door_w2/2+frw,door_h2-frw-segh1,12

vert 0, 0, 0
vert 0, 1, 0
vert -1, 0, 0
vert 0, 0, -1

coor 2, -1, -2, -3, -4
body 1

gosub 1000

DEL 2

return

! ----------------------------------------------------------------
"DoorType5":
! ----------------------------------------------------------------

fr_th2=0.01: frw=doorframe_w: segh1=0.08
!! fr_th1:	thickness
!! fr_th2: 	hill_height

seg_alfa=ATN(segh1/(door_w2/2-doorframe_w))
seg_beta=90-2*seg_alfa
segh2=(door_w2/2-doorframe_w)*tan(seg_beta)
seg_r=segh1+segh2		!! radius of segment
seg_gamma=180-2*(seg_alfa+seg_beta)

	IF door_w2<frw*2+0.01+vert_gnum*0.016 OR door_h2<frw*2+0.01+hor_gnum*0.016 THEN gosub "SimpleSolidDoor"

ADDX door_w2/2
ROTX 90

MATERIAL doorframe_mat

if gs_bevel then
	group "frame_typ6"					!! Door Frame

	FPRISM_ doorframe_mat, doorframe_mat, doorframe_mat, doorframe_mat,
			12,fr_th1,45,fr_th2,
			-door_w2/2,0,15,
			door_w2/2,0,15,
			door_w2/2,door_h2,15,
			-door_w2/2,door_h2,15,
			-door_w2/2,0,-1,
			-door_w2/2+frw,frw,13,
			door_w2/2-frw,frw,13,
			door_w2/2-frw,door_h2-frw-segh1,13,
			0,door_h2-frw-seg_r,900,
			0,2*seg_gamma,4000,
			-door_w2/2+frw,door_h2-frw-segh1,13,
			-door_w2/2+frw,frw,-1

	endgroup
	placegroup "frame_typ6"

	group "grill_typ6"
			gosub "GrillsOfLeaf"					!! Call Grill
	endgroup

	grills_typ5=subgroup("grill_typ6","frame_typ6")
	placegroup grills_typ5

	killgroup "frame_typ6"
	killgroup "grill_typ6"
	killgroup grills_typ5
else
	group "frame_typ5"					!! Door Frame
	base
		PRISM_	4,fr_th1,
				-door_w2/2+frw,0,13,
				door_w2/2-frw,0,8,
				door_w2/2-frw,frw,15,
				-door_w2/2+frw,frw,10
	vert 0, 0, 0
	vert 1, 0, 0
	vert 0, 1, 0
	vert 0, 0, 1

	coor 2, -1, -2, -3, -4
	body 1

	base
		PRISM_	6,fr_th1,
				door_w2/2,0,15,
				door_w2/2,door_h2,15,
				door_w2/2-frw,door_h2,8,
				door_w2/2-frw,door_h2-frw-segh1,15,
				door_w2/2-frw,frw,10,
				door_w2/2-frw,0,13
	vert 0, 0, 0
	vert 0, 1, 0
	vert -1, 0, 0
	vert 0, 0, -1

	coor 2, -1, -2, -3, -4
	body 1

	base
		RESOL 36
		PRISM_	6,fr_th1,
				door_w2/2-frw,door_h2,8,
				door_w2/2-frw,door_h2-frw-segh1,15,!1
				0,door_h2-frw-seg_r,900,
				0,2*seg_gamma,4000,
				-door_w2/2+frw,door_h2-frw-segh1,10,!2
				-door_w2/2+frw,door_h2,13
	vert 0, 0, 0
	vert 1, 0, 0
	vert 0, 1, 0
	vert 0, 0, 1

	coor 2, -1, -2, -3, -4
	body 1

	base
		PRISM_	6,fr_th1,
				-door_w2/2,0,15,
				-door_w2/2,door_h2,15,
				-door_w2/2+frw,door_h2,8,
				-door_w2/2+frw,door_h2-frw-segh1,15,
				-door_w2/2+frw,frw,10,
				-door_w2/2+frw,0,13
	vert 0, 0, 0
	vert 0, 1, 0
	vert -1, 0, 0
	vert 0, 0, -1

	coor 2, -1, -2, -3, -4
	body 1

	gosub 1000

	gosub 1000

	endgroup
	placegroup "frame_typ5"

	group "grill_typ5"
			gosub "GrillsOfLeaf"					!! Call Grill
	endgroup

	grills_typ5=subgroup("grill_typ5","frame_typ5")
	placegroup grills_typ5

	killgroup "frame_typ5"
	killgroup "grill_typ5"
	killgroup grills_typ5

	BODY -1
endif

ADDZ fr_th1-fr_th2
MATERIAL doorglas_mat
POLY_ 7,						!! Window Glass
	-door_w2/2+frw,frw,1,
	door_w2/2-frw,frw,1,
	door_w2/2-frw,door_h2-frw-segh1,1,
	0,door_h2-frw-seg_r,900,
	0,2*seg_gamma,4000,
	-door_w2/2+frw,door_h2-frw-segh1,1,
	-door_w2/2+frw,frw,-1
BODY -1
DEL 1
DEL 2

return

! ----------------------------------------------------------------
"DoorType6":
! ----------------------------------------------------------------

fr_th2=0.01: frw=doorframe_w: segh1=0.08
!! fr_th1:	thickness
!! fr_th2: 	hill_height

seg_alfa=ATN((door_w2/2-frw)/segh1)
segh2=sqr((segh1*segh1)+(door_w2/2-frw)*(door_w2/2-frw))
seg_r=(segh2/cos(seg_alfa))/4
seg_beta=90-seg_alfa


	IF door_w2<frw*2+0.03 OR door_h2<frw*2+0.03 				THEN  gosub "SimpleSolidDoor"        ! simple door

ADDX door_w2/2
ROTX 90

!! 1.center point of radius of segment: door_w2/2-frw, door_h2-frw-segh1+seg_r
!! 2.center point of radius of segment: 0, door_h2-frw-seg_r
!! 3.center point of radius of segment: -door_w2/2+frw, -door_h2+frw-segh1+seg_r

!! Frame
MATERIAL doorframe_mat

if gs_bevel then
	FPRISM_ doorframe_mat, doorframe_mat, doorframe_mat, doorframe_mat,
			16,fr_th1,45,fr_th2,
			-door_w2/2,0,15,
			door_w2/2,0,15,
			door_w2/2,door_h2,15,
			-door_w2/2,door_h2,15,
			-door_w2/2,0,-1,
			-door_w2/2+frw,frw,12,
			-door_w2/2+frw,door_h2-frw-segh1,12,
			-door_w2/2+frw,door_h2-frw-segh1+seg_r,912,		!! 1.centerpoint
			0,2*seg_beta-0.5,4012,							!! 0.01 correction
			0, door_h2-frw-seg_r, 912,					!! 2.centerpoint
			0,-(4*seg_beta),4012,
			door_w2/2-frw,door_h2-frw-segh1+seg_r,912,		!! 3.centerpoint
			0,2*seg_beta-0.5,4012,
			door_w2/2-frw,door_h2-frw-segh1,12,
			door_w2/2-frw,frw,12,
			-door_w2/2+frw,frw,-1

	If gs_detlevel_3D_m=2 then
	!! Middle Panel

	FPRISM_ doorframe_mat, doorframe_mat, doorframe_mat, doorframe_mat,
			11,fr_th1,45,fr_th2,
			-door_w2/2+frw,frw,12,
			-door_w2/2+frw,door_h2-frw-segh1,12,
			-door_w2/2+frw,door_h2-frw-segh1+seg_r,912,		!! 1.centerpoint
			0,2*seg_beta-0.5,4012,							!! 0.01 correction
			0, door_h2-frw-seg_r, 912,					!! 2.centerpoint
			0,-(4*seg_beta),4012,
			door_w2/2-frw,door_h2-frw-segh1+seg_r,912,		!! 3.centerpoint
			0,2*seg_beta-0.5,4012,
			door_w2/2-frw,door_h2-frw-segh1,12,
			door_w2/2-frw,frw,12,
			-door_w2/2+frw,frw,-1

	ENDIF

	MATERIAL doorframe_mat
	!! Back Panel
	PRISM_ 13,fr_th1-fr_th2,
			-door_w2/2+frw,frw,12,
			-door_w2/2+frw,door_h2-frw-segh1,12,
			-door_w2/2+frw,door_h2-frw-segh1+seg_r,900,		!! 1.centerpoint
			0,2*seg_beta,4000,
			-(door_w2/2-frw)/2,door_h2-frw-segh1/2,12,
			0, door_h2-frw-seg_r, 900,				!! 2.centerpoint
			0,-(4*seg_beta),4000,
			(door_w2/2-frw)/2,door_h2-frw-segh1/2,12,
			door_w2/2-frw,door_h2-frw-segh1+seg_r,900,		!! 3.centerpoint
			0,2*seg_beta,4000,
			door_w2/2-frw,door_h2-frw-segh1,12,
			door_w2/2-frw,frw,12,
			-door_w2/2+frw,frw,-1

else
	base
		PRISM_	4,fr_th1,
				-door_w2/2+frw,0,13,
				door_w2/2-frw,0,8,
				door_w2/2-frw,frw,12,
				-door_w2/2+frw,frw,10
	vert 0, 0, 0
	vert 1, 0, 0
	vert 0, 1, 0
	vert 0, 0, 1

	coor 2, -1, -2, -3, -4
	body 1

	base
		PRISM_	6,fr_th1,
				door_w2/2,0,15,
				door_w2/2,door_h2,15,
				door_w2/2-frw,door_h2,8,
				door_w2/2-frw,door_h2-frw-segh1,12,
				door_w2/2-frw,frw,10,
				door_w2/2-frw,0,13
	vert 0, 0, 0
	vert 0, 1, 0
	vert -1, 0, 0
	vert 0, 0, -1

	coor 2, -1, -2, -3, -4
	body 1

	base
		RESOL 36

		PRISM_	10,fr_th1,
			-door_w2/2+frw,door_h2-frw-segh1,12,	!1
			-door_w2/2+frw,door_h2-frw-segh1+seg_r,912,		!! 1.centerpoint
			0,2*seg_beta-0.5,4012,							!! 0.01 correction
			0, door_h2-frw-seg_r, 912,					!! 2.centerpoint
			0,-(4*seg_beta),4012,
			door_w2/2-frw,door_h2-frw-segh1+seg_r,912,		!! 3.centerpoint
			0,2*seg_beta-0.5,4012,
			door_w2/2-frw,door_h2-frw-segh1,10,	!2
			door_w2/2-frw,door_h2,13,
			-door_w2/2+frw,door_h2,8
	vert 0, 0, 0
	vert 1, 0, 0
	vert 0, 1, 0
	vert 0, 0, 1

	coor 2, -1, -2, -3, -4
	body 1

	base
		PRISM_	6,fr_th1,
				-door_w2/2,0,15,
				-door_w2/2,door_h2,15,
				-door_w2/2+frw,door_h2,8,
				-door_w2/2+frw,door_h2-frw-segh1,12,
				-door_w2/2+frw,frw,10,
				-door_w2/2+frw,0,13

	vert 0, 0, 0
	vert 0, 1, 0
	vert -1, 0, 0
	vert 0, 0, -1

	coor 2, -1, -2, -3, -4
	body 1

	gosub 1000

	If gs_detlevel_3D_m=2 then
	!! Middle Panel
	base
		FPRISM_ doorframe_mat, doorframe_mat, doorframe_mat, doorframe_mat,
			11,fr_th1,45,fr_th2,
			-door_w2/2+frw,frw,12,
			-door_w2/2+frw,door_h2-frw-segh1,12,
			-door_w2/2+frw,door_h2-frw-segh1+seg_r,912,		!! 1.centerpoint
			0,2*seg_beta-0.5,4012,							!! 0.01 correction
			0, door_h2-frw-seg_r, 912,					!! 2.centerpoint
			0,-(4*seg_beta),4012,
			door_w2/2-frw,door_h2-frw-segh1+seg_r,912,		!! 3.centerpoint
			0,2*seg_beta-0.5,4012,
			door_w2/2-frw,door_h2-frw-segh1,12,
			door_w2/2-frw,frw,12,
			-door_w2/2+frw,frw,-1
		vert 0, 0, 0
		vert 0, 1, 0
		vert -1, 0, 0
		vert 0, 0, -1

		coor 2, -1, -2, -3, -4
		body 1
		gosub 1000
		gosub 1000
endif
ENDIF

MATERIAL doorframe_mat
!! Back Panel
base
	PRISM_ 13,fr_th1-fr_th2,
		-door_w2/2+frw,frw,12,
		-door_w2/2+frw,door_h2-frw-segh1,12,
		-door_w2/2+frw,door_h2-frw-segh1+seg_r,900,		!! 1.centerpoint
		0,2*seg_beta,4000,
		-(door_w2/2-frw)/2,door_h2-frw-segh1/2,12,
		0, door_h2-frw-seg_r, 900,				!! 2.centerpoint
		0,-(4*seg_beta),4000,
		(door_w2/2-frw)/2,door_h2-frw-segh1/2,12,
		door_w2/2-frw,door_h2-frw-segh1+seg_r,900,		!! 3.centerpoint
		0,2*seg_beta,4000,
		door_w2/2-frw,door_h2-frw-segh1,12,
		door_w2/2-frw,frw,12,
		-door_w2/2+frw,frw,-1
	vert 0, 0, 0
	vert 0, 1, 0
	vert -1, 0, 0
	vert 0, 0, -1

	coor 2, -1, -2, -3, -4
	body 1
DEL 2

return

! ----------------------------------------------------------------
"DoorType7":
! ----------------------------------------------------------------

fr_th2=0.01: frw=doorframe_w: segh1=0.08
!! fr_th1:	thickness
!! fr_th2: 	hill_height

seg_alfa=ATN((door_w2/2-frw)/segh1)
segh2=sqr((segh1*segh1)+(door_w2/2-frw)*(door_w2/2-frw))
seg_r=(segh2/cos(seg_alfa))/4
seg_beta=90-seg_alfa


	IF door_w2<frw*2+0.01+vert_gnum*0.016 OR door_h2<frw*2+0.01+hor_gnum*0.016 THEN gosub "SimpleSolidDoor"        ! simple door

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! *** Door Panel
ADDX door_w2/2
ROTX 90
MATERIAL doorframe_mat

if gs_bevel then
	group "frame_typ8"

	FPRISM_ doorframe_mat, doorframe_mat, doorframe_mat, doorframe_mat,
		15,fr_th1,45,fr_th2,
		-door_w2/2,0,15,
		door_w2/2,0,15,
		door_w2/2,door_h2,15,
		-door_w2/2,door_h2,15,
		-door_w2/2,0,-1,
		-door_w2/2+frw,frw,13,
		-door_w2/2+frw,door_h2-frw-segh1,13,
		-door_w2/2+frw,door_h2-frw-segh1+seg_r,913,		!! 1.centerpoint
		0,2*seg_beta-0.05,4013,					!! 0.01 correction
		0, door_h2-frw-seg_r, 913,				!! 2.centerpoint
		0,-(4*seg_beta),4013,
		door_w2/2-frw,door_h2-frw-segh1+seg_r,913,		!! 3.centerpoint
		0,2*seg_beta-0.05,4013,
		door_w2/2-frw,frw,13,
		-door_w2/2+frw,frw,-1

	endgroup
	placegroup "frame_typ8"

	group "grill_typ8"
			gosub "GrillsOfLeaf"					!! Call Grille
	endgroup

	grills_typ7=subgroup("grill_typ8","frame_typ8")
	placegroup grills_typ7

	killgroup "frame_typ8"
	killgroup "grill_typ8"
	killgroup grills_typ7
else
	group "frame_typ7"					!! Door Frame

		base
				PRISM_	4,fr_th1,
						-door_w2/2+frw,0,13,
						door_w2/2-frw,0,8,
						door_w2/2-frw,frw,15,
						-door_w2/2+frw,frw,10
		vert 0, 0, 0
		vert 1, 0, 0
		vert 0, 1, 0
		vert 0, 0, 1

		coor 2, -1, -2, -3, -4
		body 1

		base
				PRISM_	6,fr_th1,
						door_w2/2,0,15,
						door_w2/2,door_h2,15,
						door_w2/2-frw,door_h2,8,
						door_w2/2-frw,door_h2-frw-segh1,15,
						door_w2/2-frw,frw,10,
						door_w2/2-frw,0,13
		vert 0, 0, 0
		vert 0, 1, 0
		vert -1, 0, 0
		vert 0, 0, -1

		coor 2, -1, -2, -3, -4
		body 1

		base
			RESOL 36
			PRISM_	10,fr_th1,
				-door_w2/2+frw,door_h2-frw-segh1,13,	!1
				-door_w2/2+frw,door_h2-frw-segh1+seg_r,913,		!! 1.centerpoint
				0,2*seg_beta-0.5,4013,							!! 0.01 correction
				0, door_h2-frw-seg_r, 913,					!! 2.centerpoint
				0,-(4*seg_beta),4013,
				door_w2/2-frw,door_h2-frw-segh1+seg_r,913,		!! 3.centerpoint
				0,2*seg_beta-0.5,4013,
				door_w2/2-frw,door_h2-frw-segh1,10,	!2
				door_w2/2-frw,door_h2,13,
				-door_w2/2+frw,door_h2,8
		vert 0, 0, 0
		vert 1, 0, 0
		vert 0, 1, 0
		vert 0, 0, 1

		coor 2, -1, -2, -3, -4
		body 1

		base
				PRISM_	6,fr_th1,
						-door_w2/2,0,15,
						-door_w2/2,door_h2,15,
						-door_w2/2+frw,door_h2,8,
						-door_w2/2+frw,door_h2-frw-segh1,15,
						-door_w2/2+frw,frw,10,
						-door_w2/2+frw,0,13

		vert 0, 0, 0
		vert 0, 1, 0
		vert -1, 0, 0
		vert 0, 0, -1

		coor 2, -1, -2, -3, -4
		body 1

		gosub 1000
	endgroup
	placegroup "frame_typ7"

	group "grill_typ7"
			gosub "GrillsOfLeaf"					!! Call Grille
	endgroup

	grills_typ7=subgroup("grill_typ7","frame_typ7")
	placegroup grills_typ7

	killgroup "frame_typ7"
	killgroup "grill_typ7"
	killgroup grills_typ7

	BODY -1
endif

ADDZ fr_th1-fr_th2
MATERIAL doorglas_mat
POLY_ 13,						!! Window Glass
	-door_w2/2+frw,frw,0,
	-door_w2/2+frw,door_h2-frw-segh1,0,
	-door_w2/2+frw,door_h2-frw-segh1+seg_r,900,		!! 1.centerpoint
	0,2*seg_beta,4000,
	-(door_w2/2-frw)/2,door_h2-frw-segh1/2,0,
	0, door_h2-frw-seg_r, 900,				!! 2.centerpoint
	0,-(4*seg_beta),4000,
	(door_w2/2-frw)/2,door_h2-frw-segh1/2,0,
	door_w2/2-frw,door_h2-frw-segh1+seg_r,900,		!! 3.centerpoint
	0,2*seg_beta,4000,
	door_w2/2-frw,door_h2-frw-segh1,0,
	door_w2/2-frw,frw,0,
	-door_w2/2+frw,frw,-1
BODY -1
DEL 1
DEL 2

return

! ----------------------------------------------------------------
"DoorType8":
! ----------------------------------------------------------------

bDrawStandardKnob = 0
fr_th2=0.01
!! fr_th1:	thickness
!! fr_th2: 	hill_height

ADDX door_w2/2
ROTX 90
base
if gs_bevel then
	FPRISM_ doorframe_mat, doorframe_mat, doorframe_mat, doorframe_mat,
		8,fr_th1,45,fr_th2,
		-door_w2/2,0,15,
		door_w2/2,0,15,
		door_w2/2,door_h2,15,
		0.06,door_h2,15,
		0.06,door_h2-0.05,15,
		-0.06,door_h2-0.05,15,
		-.06,door_h2,15,
		-door_w2/2,door_h2,15

else
	CPRISM_ doorframe_mat, doorframe_mat, doorframe_mat,
		8,fr_th1,
		-door_w2/2+gap_bor,gap_bor,15,
		door_w2/2-gap_bor,gap_bor,15,
		door_w2/2-gap_bor,door_h2-gap_bor,15,
		0.06-gap_bor,door_h2-gap_bor,15,
		0.06-gap_bor,door_h2-0.05+gap_bor,15,
		-0.06+gap_bor,door_h2-0.05+gap_bor,15,
		-0.06+gap_bor,door_h2-gap_bor,15,
		-door_w2/2+gap_bor,door_h2-gap_bor,15

endif
vert 0, 0, 0
vert 0, 1, 0
vert -1, 0, 0
vert 0, 0, -1

coor 2, -1, -2, -3, -4
body 1

gosub 1000

DEL 2

return


! ----------------------------------------------------------------
"DoorType9":
! ----------------------------------------------------------------
fr_th2=0.01: frw=doorframe_w
!! fr_th1:	thickness
!! fr_th2: 	hill_height

	IF door_w2<frw*2+0.03 OR door_h2<frw*2+0.03	THEN  gosub "SimpleSolidDoor"        ! simple door

ADDX door_w2/2
ROTX 90

MATERIAL doorframe_mat

if gs_bevel then
	base
		FPRISM_ doorframe_mat, doorframe_mat, doorframe_mat, doorframe_mat,
			4,fr_th1,45,fr_th2,
					door_w2/2,0,15,
					door_w2/2,door_h2,15,
					door_w2/2-frw,door_h2,15,
					door_w2/2-frw,0,15
	vert 0, 0, 0
	vert 0, 1, 0
	vert -1, 0, 0
	vert 0, 0, -1

	coor 2, -1, -2, -3, -4
	body 1

	base
		FPRISM_ doorframe_mat, doorframe_mat, doorframe_mat, doorframe_mat,
			4,fr_th1,45,fr_th2,
					-door_w2/2,0,15,
					-door_w2/2,door_h2,15,
					-door_w2/2+frw,door_h2,15,
					-door_w2/2+frw,0,15
	vert 0, 0, 0
	vert 0, 1, 0
	vert -1, 0, 0
	vert 0, 0, -1

	coor 2, -1, -2, -3, -4
	body 1

	else
	base
			PRISM_	4,fr_th1,
					door_w2/2,0,15,
					door_w2/2,door_h2,15,
					door_w2/2-frw,door_h2,15,
					door_w2/2-frw,0,15
	vert 0, 0, 0
	vert 0, 1, 0
	vert -1, 0, 0
	vert 0, 0, -1

	coor 2, -1, -2, -3, -4
	body 1

	base
		PRISM_	4,fr_th1,
				-door_w2/2,0,15,
				-door_w2/2,door_h2,15,
				-door_w2/2+frw,door_h2,15,
				-door_w2/2+frw,0,15
	vert 0, 0, 0
	vert 0, 1, 0
	vert -1, 0, 0
	vert 0, 0, -1

	coor 2, -1, -2, -3, -4
	body 1
endif

material doorglas_mat

AddZ fr_th1/2
	Base
		POLY_ 4,
			-door_w2/2+frw,0,1,
			door_w2/2-frw,0,1,
			door_w2/2-frw,door_h2,1,
			-door_w2/2+frw,door_h2,1
	vert 0, 0, 0
	vert 0, 1, 0
	vert -1, 0, 0
	vert 0, 0, -1

	coor 2, -1, -2, -3, -4
	body 1
del 1

DEL 2

gosub 1000

return


! ----------------------------------------------------------------
"DoorType11":
! ----------------------------------------------------------------
	
	fr_th2=0.01: frw=doorframe_w
	fr_th3 = fr_th1-fr_th2
	!! fr_th1:	thickness
	!! fr_th2: 	hill_height
	
	IF door_w2<frw*2+0.03 OR door_h2<frw*2+0.03 				THEN  gosub "SimpleSolidDoor"        ! simple door
	
	ADDX door_w2/2
	ROTX 90
	
	MATERIAL doorframe_mat
	
	if gs_bevel then
	
		base
	
		PRISM_	5,fr_th2,
					-door_w2/2+frw,0,15,
					door_w2/2-frw,0,14,
					door_w2/2-frw,frw,14,
					-door_w2/2+frw,frw,14,
					-door_w2/2+frw,0,-1
	
		ADDz fr_th2
		RULED 	5, 1+2+4+16+32+64,
					-door_w2/2+frw,0,1,
					door_w2/2-frw,0,1,
					door_w2/2-frw,frw,1,
					-door_w2/2+frw,frw,1,
					-door_w2/2+frw,0,-1,
	
					-door_w2/2+frw-fr_th3,fr_th3,fr_th3,
					door_w2/2-frw+fr_th3,fr_th3,fr_th3,
					door_w2/2-frw+fr_th3,frw-fr_th3,fr_th3,
					-door_w2/2+frw-fr_th3,frw-fr_th3,fr_th3,
					-door_w2/2+frw-fr_th3,fr_th3,fr_th3
	
		DEL 1
	
	
	
		vert 0, 0, 0
		vert 1, 0, 0
		vert 0, 1, 0
		vert 0, 0, 1
	
		coor 2, -1, -2, -3, -4
		body 1
	
		base
		MATERIAL doorframe_mat
		PRISM_ 6,fr_th2,
					door_w2/2,0,15,
					door_w2/2,door_h2,15,
					door_w2/2-frw,door_h2,8,
					door_w2/2-frw,door_h2-frw,14,
					door_w2/2-frw,frw,10,
					door_w2/2-frw,0,13
	
		ADDz fr_th2
		RULED 	5, 1+2+4+16+32+64,
					door_w2/2,0,1,
					door_w2/2,door_h2,1,
					door_w2/2-frw,door_h2,1,
					door_w2/2-frw,0,1,
					door_w2/2,0,1,
	
					door_w2/2-fr_th3,fr_th3,fr_th3,
					door_w2/2-fr_th3,door_h2-fr_th3,fr_th3,
					door_w2/2-frw+fr_th3,door_h2-fr_th3,fr_th3,
					door_w2/2-frw+fr_th3,fr_th3,fr_th3,
					door_w2/2-fr_th3,fr_th3,fr_th3
		DEL 1
	
		vert 0, 0, 0
		vert 0, 1, 0
		vert -1, 0, 0
		vert 0, 0, -1
	
		coor 2, -1, -2, -3, -4
		body 1
	
		base
		PRISM_	5,fr_th2,
					-door_w2/2+frw,door_h2,15,
					door_w2/2-frw,door_h2,14,
					door_w2/2-frw,door_h2-frw,14,
					-door_w2/2+frw,door_h2-frw,14,
					-door_w2/2+frw,door_h2,-1
	
		ADDz fr_th2
		RULED 	5, 1+2+4+16+32+64,
					-door_w2/2+frw,door_h2,1,
					door_w2/2-frw,door_h2,1,
					door_w2/2-frw,door_h2-frw,1,
					-door_w2/2+frw,door_h2-frw,1,
					-door_w2/2+frw,door_h2,-1,
	
					door_w2/2-frw+fr_th3,door_h2-fr_th3,fr_th3,
					door_w2/2-frw+fr_th3,door_h2-frw+fr_th3,fr_th3,
					-door_w2/2+frw-fr_th3,door_h2-frw+fr_th3,fr_th3,
					-door_w2/2+frw-fr_th3,door_h2-fr_th3,fr_th3,
					door_w2/2-frw+fr_th3,door_h2-fr_th3,fr_th3
	
		DEL 1
	
		vert 0, 0, 0
		vert 1, 0, 0
		vert 0, 1, 0
		vert 0, 0, 1
	
		coor 2, -1, -2, -3, -4
		body 1
	
		base
		PRISM_	5,fr_th2,
					-door_w2/2,0,15,
					-door_w2/2,door_h2,15,
					-door_w2/2+frw,door_h2,14,
					-door_w2/2+frw,0,9,
					-door_w2/2,0,15
	
		ADDz fr_th2
		RULED 	5, 1+2+4+16+32+64,
					-door_w2/2,0,1,
					-door_w2/2,door_h2,1,
					-door_w2/2+frw,door_h2,1,
					-door_w2/2+frw,0,1,
					-door_w2/2,0,1,
	
					-door_w2/2+fr_th3,door_h2-fr_th3,fr_th3,
					-door_w2/2+frw-fr_th3,door_h2-fr_th3,fr_th3,
					-door_w2/2+frw-fr_th3,fr_th3,fr_th3,
					-door_w2/2+fr_th3,fr_th3,fr_th3,
					-door_w2/2+fr_th3,door_h2-fr_th3,fr_th3
		DEL 1
	
	
	
		vert 0, 0, 0
		vert 0, 1, 0
		vert -1, 0, 0
		vert 0, 0, -1
	
		coor 2, -1, -2, -3, -4
		body 1
	
	else
		base
			PRISM_	4,fr_th1,
					-door_w2/2+frw,0,13,
					door_w2/2-frw,0,8,
					door_w2/2-frw,frw,14,
					-door_w2/2+frw,frw,10
		vert 0, 0, 0
		vert 1, 0, 0
		vert 0, 1, 0
		vert 0, 0, 1
	
		coor 2, -1, -2, -3, -4
		body 1
	
		base
			PRISM_	6,fr_th1,
					door_w2/2,0,15,
					door_w2/2,door_h2,15,
					door_w2/2-frw,door_h2,8,
					door_w2/2-frw,door_h2-frw,14,
					door_w2/2-frw,frw,10,
					door_w2/2-frw,0,13
	vert 0, 0, 0
	vert 0, 1, 0
	vert -1, 0, 0
	vert 0, 0, -1
	
	coor 2, -1, -2, -3, -4
	body 1
	
	base
			PRISM_	4,fr_th1,
					-door_w2/2+frw,door_h2,13,
					door_w2/2-frw,door_h2,8,
					door_w2/2-frw,door_h2-frw,14,
					-door_w2/2+frw,door_h2-frw,10
		vert 0, 0, 0
		vert 1, 0, 0
		vert 0, 1, 0
		vert 0, 0, 1
	
		coor 2, -1, -2, -3, -4
		body 1
	
		base
			PRISM_	6,fr_th1,
					-door_w2/2,0,15,
					-door_w2/2,door_h2,15,
					-door_w2/2+frw,door_h2,8,
					-door_w2/2+frw,door_h2-frw,14,
					-door_w2/2+frw,frw,10,
					-door_w2/2+frw,0,13
		vert 0, 0, 0
		vert 0, 1, 0
		vert -1, 0, 0
		vert 0, 0, -1
	
		coor 2, -1, -2, -3, -4
		body 1
	endif
	
	If gs_detlevel_3D_m=2 then
		base
			FPRISM_ doorframe_mat, doorframe_mat, doorframe_mat, doorframe_mat,
				4,fr_th1,45,fr_th2,
				-door_w2/2+frw,frw,14,
				door_w2/2-frw,frw,14,
				door_w2/2-frw,door_h2-frw,14,
				-door_w2/2+frw,door_h2-frw,14
		vert 0, 0, 0
		vert 0, 1, 0
		vert -1, 0, 0
		vert 0, 0, -1
	
		coor 2, -1, -2, -3, -4
		body 1
	ENDIF
	
	Base
		PRISM_ 4,fr_th1-fr_th2,
				-door_w2/2+frw,frw,12,
				door_w2/2-frw,frw,12,
				door_w2/2-frw,door_h2-frw,12,
				-door_w2/2+frw,door_h2-frw,12
	vert 0, 0, 0
	vert 0, 1, 0
	vert -1, 0, 0
	vert 0, 0, -1
	
	coor 2, -1, -2, -3, -4
	body 1
	
	DEL 2
	
	gosub 1000

return


! ----------------------------------------------------------------
"DoorType12":
! ----------------------------------------------------------------

	fr_th2=0.01: frw=doorframe_w
	fr_th3=fr_th1-fr_th2
	!! fr_th1:	thickness
	!! fr_th2: 	hill_height
	
	IF A<frw*2+0.01+vert_gnum*0.016 OR door_h2<frw*2+0.01+hor_gnum*0.016 THEN gosub "SimpleSolidDoor"        ! simple door
	
	!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! *** Door Panel
	ADDX door_w2/2
	ROTX 90
	
	group "frame_typ11"					!! Door Frame
	
	MATERIAL doorframe_mat
	
	if gs_bevel then
	
	base
		MATERIAL doorframe_mat
		PRISM_	5,fr_th2,
					-door_w2/2+frw,0,15,
					door_w2/2-frw,0,14,
					door_w2/2-frw,frw,15,
					-door_w2/2+frw,frw,14,
					-door_w2/2+frw,0,-1
	
		ADDz fr_th2
		RULED 	5, 1+2+4+16+32+64,
					-door_w2/2+frw,0,1,
					door_w2/2-frw,0,1,
					door_w2/2-frw,frw,1,
					-door_w2/2+frw,frw,1,
					-door_w2/2+frw,0,-1,
	
					-door_w2/2+frw-fr_th3,fr_th3,fr_th3,
					door_w2/2-frw+fr_th3,fr_th3,fr_th3,
					door_w2/2-frw+fr_th3,frw-fr_th3,fr_th3,
					-door_w2/2+frw-fr_th3,frw-fr_th3,fr_th3,
					-door_w2/2+frw-fr_th3,fr_th3,fr_th3
	
		DEL 1
	
	vert 0, 0, 0
	vert 1, 0, 0
	vert 0, 1, 0
	vert 0, 0, 1
	
	coor 2, -1, -2, -3, -4
	body 1
	
	base
		MATERIAL doorframe_mat
		PRISM_ 6,fr_th2,
					door_w2/2,0,15,
					door_w2/2,door_h2,15,
					door_w2/2-frw,door_h2,8,
					door_w2/2-frw,door_h2-frw,15,
					door_w2/2-frw,frw,10,
					door_w2/2-frw,0,13
	
		ADDz fr_th2
		RULED 	5, 1+2+4+16+32+64,
					door_w2/2,0,1,
					door_w2/2,door_h2,1,
					door_w2/2-frw,door_h2,1,
					door_w2/2-frw,0,1,
					door_w2/2,0,1,
	
					door_w2/2-fr_th3,fr_th3,fr_th3,
					door_w2/2-fr_th3,door_h2-fr_th3,fr_th3,
					door_w2/2-frw+fr_th3,door_h2-fr_th3,fr_th3,
					door_w2/2-frw+fr_th3,fr_th3,fr_th3,
					door_w2/2-fr_th3,fr_th3,fr_th3
		DEL 1
	
	
	vert 0, 0, 0
	vert 0, 1, 0
	vert -1, 0, 0
	vert 0, 0, -1
	
	coor 2, -1, -2, -3, -4
	body 1
	
	base
		PRISM_	5,fr_th2,
					-door_w2/2+frw,door_h2,15,
					door_w2/2-frw,door_h2,14,
					door_w2/2-frw,door_h2-frw,15,
					-door_w2/2+frw,door_h2-frw,14,
					-door_w2/2+frw,door_h2,-1
	
		ADDz fr_th2
		RULED 	5, 1+2+4+16+32+64,
					-door_w2/2+frw,door_h2,1,
					door_w2/2-frw,door_h2,1,
					door_w2/2-frw,door_h2-frw,1,
					-door_w2/2+frw,door_h2-frw,1,
					-door_w2/2+frw,door_h2,-1,
	
					door_w2/2-frw+fr_th3,door_h2-fr_th3,fr_th3,
					door_w2/2-frw+fr_th3,door_h2-frw+fr_th3,fr_th3,
					-door_w2/2+frw-fr_th3,door_h2-frw+fr_th3,fr_th3,
					-door_w2/2+frw-fr_th3,door_h2-fr_th3,fr_th3,
					door_w2/2-frw+fr_th3,door_h2-fr_th3,fr_th3
	
		DEL 1
	
	
	vert 0, 0, 0
	vert 1, 0, 0
	vert 0, 1, 0
	vert 0, 0, 1
	
	coor 2, -1, -2, -3, -4
	body 1
	
	base
		PRISM_ 6,fr_th2,
					-door_w2/2,0,15,
					-door_w2/2,door_h2,15,
					-door_w2/2+frw,door_h2,8,
					-door_w2/2+frw,door_h2-frw,15,
					-door_w2/2+frw,frw,10,
					-door_w2/2+frw,0,13
	
		ADDz fr_th2
		RULED 	5, 1+2+4+16+32+64,
					-door_w2/2,0,1,
					-door_w2/2,door_h2,1,
					-door_w2/2+frw,door_h2,1,
					-door_w2/2+frw,0,1,
					-door_w2/2,0,1,
	
					-door_w2/2+fr_th3,door_h2-fr_th3,fr_th3,
					-door_w2/2+frw-fr_th3,door_h2-fr_th3,fr_th3,
					-door_w2/2+frw-fr_th3,fr_th3,fr_th3,
					-door_w2/2+fr_th3,fr_th3,fr_th3,
					-door_w2/2+fr_th3,door_h2-fr_th3,fr_th3
		DEL 1
	
	
	vert 0, 0, 0
	vert 0, 1, 0
	vert -1, 0, 0
	vert 0, 0, -1
	
	coor 2, -1, -2, -3, -4
	body 1
	
	else
	base
		PRISM_	4,fr_th1,
				-door_w2/2+frw,0,13,
				door_w2/2-frw,0,8,
				door_w2/2-frw,frw,15,
				-door_w2/2+frw,frw,10
	vert 0, 0, 0
	vert 1, 0, 0
	vert 0, 1, 0
	vert 0, 0, 1
	
	coor 2, -1, -2, -3, -4
	body 1
	
	base
		PRISM_	6,fr_th1,
				door_w2/2,0,15,
				door_w2/2,door_h2,15,
				door_w2/2-frw,door_h2,8,
				door_w2/2-frw,door_h2-frw,15,
				door_w2/2-frw,frw,10,
				door_w2/2-frw,0,13
	vert 0, 0, 0
	vert 0, 1, 0
	vert -1, 0, 0
	vert 0, 0, -1
	
	coor 2, -1, -2, -3, -4
	body 1
	
	base
		PRISM_	4,fr_th1,
				-door_w2/2+frw,door_h2,13,
				door_w2/2-frw,door_h2,8,
				door_w2/2-frw,door_h2-frw,15,
				-door_w2/2+frw,door_h2-frw,10
	vert 0, 0, 0
	vert 1, 0, 0
	vert 0, 1, 0
	vert 0, 0, 1
	
	coor 2, -1, -2, -3, -4
	body 1
	
	base
		PRISM_	6,fr_th1,
				-door_w2/2,0,15,
				-door_w2/2,door_h2,15,
				-door_w2/2+frw,door_h2,8,
				-door_w2/2+frw,door_h2-frw,15,
				-door_w2/2+frw,frw,10,
				-door_w2/2+frw,0,13
	vert 0, 0, 0
	vert 0, 1, 0
	vert -1, 0, 0
	vert 0, 0, -1
	
	coor 2, -1, -2, -3, -4
	body 1
	
	endif
	gosub 1000
	
	endgroup
	
	placegroup "frame_typ11"
	
	group "grill_typ11"
		gosub "GrillsOfLeaf"					!! Call Grill
	endgroup
	
	grills_typ1=subgroup("grill_typ11","frame_typ11")
	placegroup grills_typ1
	
	killgroup "frame_typ11"
	killgroup "grill_typ11"
	killgroup grills_typ1
	
	BODY -1
	
	ADDZ fr_th1-fr_th2
	MATERIAL doorglas_mat
	POLY_ 4,						!! Window Glass
		-door_w2/2+doorframe_w,doorframe_w,1,
		door_w2/2-doorframe_w,doorframe_w,1,
		door_w2/2-doorframe_w,door_h2-doorframe_w,1,
		-door_w2/2+doorframe_w,door_h2-doorframe_w,1
	BODY -1
	DEL 1
	DEL 2

return


! ----------------------------------------------------------------
"GrillsOfLeaf":		! Vertical and Horizontal Grills of Leaf
! ----------------------------------------------------------------

	xx=(door_w2-2*frw-vert_gnum*0.016)/(vert_gnum+1)	!! dist. of hor. panes
	yy=(door_h2-2*frw-hor_gnum*0.016)/(hor_gnum+1)	!! dist. of vert. panes



	MATERIAL doorframe_mat

	ADD -door_w2/2+frw+xx, frw-fr_th2, fr_th1-fr_th2-0.001
		FOR i=1 TO vert_gnum
			BLOCK 0.016, door_h2-2*(frw-fr_th2), 0.005		!! Vert. Grill
			gosub 1000
			ADDX xx+0.016
		NEXT i
		DEL vert_gnum
	DEL 1


	ADDY frw

	FOR ii=1 TO hor_gnum

		ADD -door_w2/2+frw-fr_th2,yy,fr_th1-fr_th2-0.001
		BLOCK xx+fr_th2, 0.016, 0.005		!! hor. Right End Grills
		gosub 2000
		DEL 1

		IF vert_gnum<>0 AND hor_gnum<>0 THEN
			ADD door_w2/2-frw-xx,yy,fr_th1-fr_th2-0.001
			BLOCK xx+fr_th2, 0.016, 0.005		!! hor. Left End Grills
			gosub 2000
			DEL 1


			ADD -door_w2/2+frw+xx+0.016,yy,fr_th1-fr_th2-0.001
				FOR p=1 TO vert_gnum-1
				BLOCK xx, 0.016, 0.005			!! hor. Middle Grills
				gosub 2000
				ADDX xx+0.016
				NEXT p
				DEL vert_gnum-1
			DEL 1
		ENDIF

	ADDY yy+0.016
	NEXT ii
	DEL hor_gnum
	DEL 1
	DEL TOP
	BODY -1
RETURN

! ----------------------------------------------------------------
"DoorTypeCustom" :					! Custom Panel
! ----------------------------------------------------------------

fr_th2=0.01
!! fr_th1:	thickness
!! fr_th2: 	hill_height

rotx 90
call "Object_Panel_Collection" parameters a=door_w2, b=door_h2, zzyzx=fr_th1, gs_ptype=gs_cust_p
del 1

return

! ================================================================
! TEXTURE SUBROUTINES
! ================================================================

1000:
	roty 90
	gosub 5000
	del 1
	return

2000:
	gosub 5000
	return

3000:
	rotz 90
	gosub 5000
	del 1
	return

4000:
	rotx 90
	gosub 5000
	del 1
	return

5000:
	vert 0, 0, 0
	vert 1, 0, 0
	vert 0, 1, 0
	vert 0, 0, 1

	coor 2, -1, -2, -3, -4

	base

	body -1

	return
]]>
</Script_3D>

<ParamSection SectVersion="26" SectionFlags="0" SubIdent="0">
	<ParamSectHeader>
		<Version>26</Version>
		<AutoHotspots>false</AutoHotspots>
		<WDLeftFrame>0</WDLeftFrame>
		<WDRightFrame>0</WDRightFrame>
		<WDTopFrame>0</WDTopFrame>
		<WDBotFrame>0</WDBotFrame>
		<LayFlags>65535</LayFlags>
		<WDMirrorThickness>0</WDMirrorThickness>
		<WDWallInset>0</WDWallInset>
		<SymbolColor>0</SymbolColor>
	</ParamSectHeader>
	<Parameters>
		<Length Name="A">
			<Description><![CDATA["Dimension 1"]]></Description>
			<Fix/>
			<Value>1</Value>
		</Length>
		<Length Name="B">
			<Description><![CDATA["Dimension 2"]]></Description>
			<Fix/>
			<Value>1</Value>
		</Length>
		<Length Name="ZZYZX">
			<Description><![CDATA["Height"]]></Description>
			<Fix/>
			<Value>1</Value>
		</Length>
		<Boolean Name="AC_show2DHotspotsIn3D">
			<Description><![CDATA["Show 2D Hotspots in 3D"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>1</Value>
		</Boolean>
		<Length Name="ac_bottomlevel">
			<Description><![CDATA["Bottom Level"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>1</Value>
		</Length>
		<Length Name="ac_toplevel">
			<Description><![CDATA["Top Level"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Integer Name="gs_detlevel_3D_m">
			<Description><![CDATA["3D"]]></Description>
			<Value>2</Value>
		</Integer>
		<PenColor Name="gs_cont_pen">
			<Description><![CDATA["Contour Pen"]]></Description>
			<Value>7</Value>
		</PenColor>
		<Boolean Name="gs_shadow">
			<Description><![CDATA["Shadow"]]></Description>
			<Value>1</Value>
		</Boolean>
		<Boolean Name="gs_full_edit">
			<Description><![CDATA["Extra Hotspot Editing"]]></Description>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Boolean>

		<!-- fa_cabdoor_sp0: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="fa_cabdoor_sp0">
			<Description><![CDATA["Door"]]></Description>
		</Title>
		<Boolean Name="bLowerDrawer">
			<Description><![CDATA["Lower part is Drawer"]]></Description>
			<Value>1</Value>
		</Boolean>
		<Boolean Name="gs_bevel">
			<Description><![CDATA["Edge Bevel"]]></Description>
			<Value>1</Value>
		</Boolean>
		<Integer Name="gs_door_type_m">
			<Description><![CDATA["Door Styles"]]></Description>
			<Value>1</Value>
		</Integer>
		<Boolean Name="bKnob">
			<Description><![CDATA["Knob"]]></Description>
			<Value>1</Value>
		</Boolean>
		<Boolean Name="bKnobNoneType">
			<Description><![CDATA["Knob"]]></Description>
			<Value>1</Value>
		</Boolean>
		<String Name="gs_cust_p">
			<Description><![CDATA["Custom Panel Name"]]></Description>
			<Value><![CDATA[""]]></Value>
		</String>
		<Length Name="door_w">
			<Description><![CDATA["Door Width"]]></Description>
			<Value>0.6</Value>
		</Length>
		<Length Name="door_h">
			<Description><![CDATA["Door Height"]]></Description>
			<Value>0.8</Value>
		</Length>
		<Length Name="doorOffset">
			<Description><![CDATA["Width/Height Offset"]]></Description>
			<Value>0.003</Value>
		</Length>
		<Length Name="fr_th1">
			<Description><![CDATA["Door Thickness"]]></Description>
			<Value>0.02</Value>
		</Length>
		<Length Name="doorframe_w">
			<Description><![CDATA["Door Frame Width"]]></Description>
			<Value>0.08</Value>
		</Length>
		<Angle Name="door_ang">
			<Description><![CDATA["Door Opening Angle"]]></Description>
			<Value>0</Value>
		</Angle>
		<Integer Name="vert_gnum">
			<Description><![CDATA["No. of Vert. Door Grids"]]></Description>
			<Value>1</Value>
		</Integer>
		<Integer Name="hor_gnum">
			<Description><![CDATA["No. of Hor. Door Grids"]]></Description>
			<Value>2</Value>
		</Integer>
		<Material Name="doorglas_mat">
			<Description><![CDATA["Door (Glazing)"]]></Description>
			<Value>24</Value>
		</Material>
		<Material Name="doorframe_mat">
			<Description><![CDATA["Door (Frame)"]]></Description>
			<Value>15</Value>
		</Material>

		<!-- _sp0: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="_sp0">
			<Description><![CDATA["Knobs"]]></Description>
		</Title>
		<Integer Name="iNumKnob">
			<Description><![CDATA["Number of Knob"]]></Description>
			<Value>1</Value>
		</Integer>
		<Integer Name="gs_knob_type_m">
			<Description><![CDATA["Knob Style"]]></Description>
			<Value>4</Value>
		</Integer>
		<Length Name="knob_pl_x">
			<Description><![CDATA["(Lower) Knob Position Hor."]]></Description>
			<Value>0.05</Value>
		</Length>
		<Length Name="knob_pl_y">
			<Description><![CDATA["(Lower) Knob Position Vert."]]></Description>
			<Value>0.52</Value>
		</Length>
		<Integer Name="UpperKnob">
			<Description><![CDATA["Upper Knob"]]></Description>
			<Value>0</Value>
		</Integer>
		<Length Name="knob_pl_x_up">
			<Description><![CDATA["Upper Knob Position Hor."]]></Description>
			<Value>0.1</Value>
		</Length>
		<Length Name="knob_pl_y_up">
			<Description><![CDATA["Upper Knob Position Vert."]]></Description>
			<Value>0.3</Value>
		</Length>
		<Integer Name="gs_knob_p_m">
			<Description><![CDATA["Knob Position"]]></Description>
			<Value>1</Value>
		</Integer>
		<Length Name="knob_size">
			<Description><![CDATA["Knob Size"]]></Description>
			<Value>0.1</Value>
		</Length>
		<Integer Name="gs_resol">
			<Description><![CDATA["Knob Resolution"]]></Description>
			<Value>24</Value>
		</Integer>
		<Material Name="gs_knob_mat">
			<Description><![CDATA["Knob"]]></Description>
			<Value>40</Value>
		</Material>
		<Integer Name="cabdoortyp_unID">
			<Description><![CDATA["None"]]></Description>
			<Value>0</Value>
		</Integer>
		<Length Name="toe_h">
			<Description><![CDATA["Toe Height"]]></Description>
			<Value>0.09</Value>
		</Length>
		<String Name="gs_cust_knob">
			<Description><![CDATA["Custom Knob Name"]]></Description>
			<Value><![CDATA[""]]></Value>
		</String>
		<Length Name="gs_customHandleLength">
			<Description><![CDATA[""]]></Description>
			<Value>0.1</Value>
		</Length>
		<Length Name="gs_customHandleHeight">
			<Description><![CDATA[""]]></Description>
			<Value>0.02</Value>
		</Length>
		<Length Name="gs_customHandleDepth">
			<Description><![CDATA[""]]></Description>
			<Value>0.02</Value>
		</Length>
		<Boolean Name="bBottomHung">
			<Description><![CDATA[""]]></Description>
			<Value>0</Value>
		</Boolean>
	</Parameters>
</ParamSection>

<Picture MIME="image/png" SectVersion="19" SectionFlags="0" SubIdent="0" length_in_bytes="559" platform="Win">
	<![CDATA[
	696D6167652F706E670089504E470D0A1A0A0000000D49484452000000800000
	00800803000000F4E091F9000000EA504C5445FFFFFFF8F3EAF4EDDFF4EEE1FB
	F8F3ECDFC8E1CFABE3D2B0F4EDE0EDE1CCE3D2B1E5D5B6F5EEE2E6D6B6E6D6B7
	E6D5B6E8D8B8D9CBAF95928B918E8992908A93928DACA69AE7D6B7E8D7B7D9CC
	B2A2A2A3A1A1A3A1A2A3A2A2A484858997958FE5D4B4E7D9BFF1F0F0F2F2F3F1
	F1F1F3F3F3F5F5F59E9EA096938CE6D8BEECEBEBECECEDECECECEDEDEDF0F0F0
	ECECEFECEEF1ECEEF0EDEFF1F1F2F4999A9E908E89E5D4B5E6D6BAE8DFCFE8E0
	D0E8E0CFEAE2D1BFB8A9BEB4A1E5D5B5E4D3B2EAD9B8EBDAB9EDE0CBE2D1B0E4
	D4B5F5EEE1EDE2CDE4D3B3E6D6B8F5EEE3FDFBF8FBF9F5FCFAF6FEFDFBE518EA
	B4000000F64944415478DAEDDB5952C2501445510D182031010111314827BD62
	0336F46AD028D1F94FC77F7E5E995BAF8A54ED3D81B326700EF6AF4323A12F23
	A9061C99297D9969352063D9FAB28E01000000E09F00C795E7080059C7962700
	E44EF285A2B4D3D2991315503EAF5C78B2AADE65CD8D0CA8379AAD2B59ED4EB7
	2700F407C36B5937230000000000000000000000000000000000000000000000
	000000000000000000000000000000000000000000000000000000000040CC01
	B777F7B21EC693C7E880A7E797E94CD87CB174A3BF6C566B79AF6F3CAD000000
	1037C0BBBFD197FFA1067C065FFA0ABED5806DF8A3AFF07777EE0FFB41E0F5F1
	33716E0000000049454E44AE426082
	]]>
</Picture>

<Ancestry SectVersion="1" SectionFlags="0" SubIdent="0" Template="false">
	<MainGUID>F938E33A-329D-4A36-BE3E-85E126820996</MainGUID>
	<MainGUID>103E8D2C-8230-42E1-9597-46F84CCE28C0</MainGUID>
	<MainGUID>B2970E4C-8680-4061-8670-2F4B638F3953</MainGUID>
</Ancestry>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_VL SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[
VALUES "gs_detlevel_3D_m" 2,1
VALUES "gs_door_type_m" 0,1,2,3,4,5,6,7,8,9,10,11,12,99		
! 1 = simple solid panel. 
! 10 or 99 = Custom door. 
! 8 = only for furniture. 
! 0 = no door.
! 3,5,7,8,12 : doors with glass

if bKnobNoneType then
	values "gs_knob_type_m" 1,2,3,4,5,6,7,8,0
else
	values "gs_knob_type_m" 1,2,3,4,5,6,7,8
endif

VALUES "gs_knob_p_m" 0,1 	!!!(0-Vertical, 1-Horizontal)
]]>
</Script_VL>

<CalledMacros SectVersion="2" SectionFlags="0" SubIdent="0">
	<Macro>
		<MName><![CDATA["Knob_Collection"]]></MName>
		<MainGUID>792251AA-3310-4E1F-B787-19075AC87358</MainGUID>
	</Macro>
	<Macro>
		<MName><![CDATA["fa_knobtyp"]]></MName>
		<MainGUID>29F83AA1-B564-436E-9586-290736E65631</MainGUID>
	</Macro>
	<Macro>
		<MName><![CDATA["Object_Panel_Collection"]]></MName>
		<MainGUID>F846F2AE-D5D0-4EAA-894F-F4CAAF3737B6</MainGUID>
	</Macro>
	<Macro>
		<MName><![CDATA["LibraryGlobals13"]]></MName>
		<MainGUID>9137124A-DDF2-4A06-A532-5FC0CE873258</MainGUID>
	</Macro>
</CalledMacros>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_1D SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[
door_w2 = door_w-doorOffset
door_h2 = door_h-doorOffset


EPS=0.0001
IF ((gs_knob_type_m = 0) & bKnobNoneType) | (not(bKnob) & not(bKnobNoneType)) THEN knob_d=0
IF gs_knob_type_m=1 THEN knob_d=0.025
IF gs_knob_type_m=2 THEN knob_d=0.025
IF gs_knob_type_m=3 THEN knob_d=0.03
IF gs_knob_type_m=4 THEN knob_d=0.024
IF gs_knob_type_m=5 THEN knob_d=0.025
IF gs_knob_type_m=6 THEN knob_d=0.025
IF gs_knob_type_m=7 THEN knob_d=0.03
IF gs_knob_type_m=8 THEN knob_d=0.03

]]>
</Script_1D>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_2D SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_2D>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_PR SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_PR>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_UI SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_UI>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Comment SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Comment>

<Copyright SectVersion="1" SectionFlags="0" SubIdent="0">
	<Author>GRAPHISOFT</Author>
	<License>
		<Type>CC BY-ND</Type>
		<Version>3.0</Version>
	</License>
</Copyright>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_FWM SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_FWM>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_BWM SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_BWM>

<Keywords SectVersion="1" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Keywords>

</Symbol>
