<?xml version="1.0" encoding="UTF-8"?>
<Symbol IsArchivable="false" IsPlaceable="false" MainGUID="6A4A5AB5-4364-4A99-B4C6-0815D728620B" MigrationValue="Normal" Owner="1196638531" Signature="1196644685" Version="38">
<Ancestry SectVersion="1" SectionFlags="0" SubIdent="0" Template="false">
	<MainGUID>F938E33A-329D-4A36-BE3E-85E126820996</MainGUID>
	<MainGUID>103E8D2C-8230-42E1-9597-46F84CCE28C0</MainGUID>
	<MainGUID>B2970E4C-8680-4061-8670-2F4B638F3953</MainGUID>
</Ancestry>

<CalledMacros SectVersion="2" SectionFlags="0" SubIdent="0">
	<Macro>
		<MName><![CDATA["LibraryGlobals13"]]></MName>
		<MainGUID>9137124A-DDF2-4A06-A532-5FC0CE873258</MainGUID>
	</Macro>
	<Macro>
		<MName><![CDATA["tapType_m"]]></MName>
		<MainGUID>D8F9E491-FD02-4664-8E12-E1E966386D6A</MainGUID>
	</Macro>
</CalledMacros>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_3D SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[
unID = start_unID

reqBTaps = 0
success = LIBRARYGLOBAL ("LibraryGlobals13", "hideBTaps", reqBTaps)

if gs_detlevel_3D_m = DET3D_NONE | (success > 0 and reqBTaps and GLOB_CONTEXT <> 5) then end
if GLOB_CONTEXT > 20 and GLOB_CONTEXT < 40 then gs_detlevel_3D_m = DET3D_SIMPLE
if NOT(gs_shadow) then SHADOW OFF
pen gs_cont_pen

_resol		= gs_resol * (gs_detlevel_3D_m = DET3D_DETAILED) + 8 * (gs_detlevel_3D_m = DET3D_SIMPLE)
resol _resol
archResol	= _resol * (gs_detlevel_3D_m = DET3D_DETAILED) + 3 * (gs_detlevel_3D_m = DET3D_SIMPLE)

if tapID = 1 then
	hotspot 0,			0,	0,	unID, tapOffset1, 1 + 128:		unID = unID + 1
	hotspot -1,			0,	0,	unID, tapOffset1, 3:			unID = unID + 1
	hotspot tapOffset1,	0,	0,	unID, tapOffset1, 2:			unID = unID + 1

	addx tapOffset1
else
	hotspot 0,			0,	0,	unID, tapOffset2, 1 + 128:		unID = unID + 1
	hotspot -1,			0,	0,	unID, tapOffset2, 3:			unID = unID + 1
	hotspot tapOffset2,	0,	0,	unID, tapOffset2, 2:			unID = unID + 1

	addx tapOffset2
endif

rotz -90
	gosub "tap"
del 2

!================================================================================
end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! end
!================================================================================

! ======================================================================
"tap":
! ======================================================================

	addx neckDepth / 2 * (gs_tap_type_m = 1)
		hotspot 0,	0,	0,			unID, tapHeight, 1 + 128:	unID = unID + 1
		hotspot 0,	0,	-1,			unID, tapHeight, 3:			unID = unID + 1
		hotspot 0,	0,	tapHeight,	unID, tapHeight, 2:			unID = unID + 1
	del 1

	material gs_tap_mat

	group "top tap"
		tube 2, 4, 1 + 2 + 16 + 32,
			0, 0, 901,
			tapDia / 2, 360, 4001,
	
			0, 0, -1, 0,
			0, 0, sThk, 0,
			0, 0, neckStart, 0,
			0, 0, neckStart * 2, 0
	
		if gs_tap_type_m = 1 then
			__radius		= neckDepth / 2
			__angleOrigoX	= __radius
			__angleOrigoY	= 0
			__angleOrigoZ	= tapHeight - __radius
			__startAngle	= -90
			__fullAngle		= 180
	
			tempResol	= __fullAngle / 360 * archResol
			if tempResol - INT(tempResol) < 0.5 then
				tempResol = INT(tempResol)
				__beta = __fullAngle / tempResol
			else
				tempResol = INT(tempResol) + 1
				__beta = __fullAngle / tempResol
			endif
	
			for i = 1 to tempResol
				put __angleOrigoX + __radius * SIN(__startAngle), 0, __angleOrigoZ + __radius * COS(__startAngle), 0
				__startAngle = __startAngle + __beta
			next i
	
			tube 2, 5 + NSP / 4, 1 + 2 + 16 + 32,
				0, 0, 901,
				neckDia / 2, 360, 4001,
		
				0, 0, 0, 0,
				0, 0, neckStart, 0,
				0, 0, __angleOrigoZ, 0,
				GET(NSP),
				__angleOrigoX + __radius * SIN(__startAngle), 0, __angleOrigoZ + __radius * COS(__startAngle), 0,
				__angleOrigoX + __radius * SIN(__startAngle + __beta), 0, __angleOrigoZ + __radius * COS(__startAngle + __beta), 0

			add neckDepth, 0, __angleOrigoZ
				gosub "tapEnd"
			del 1
			add 0, tapDia / 2, neckStart - 0.05
			rotx -90
				gosub "tapHandle"
			del 2
		endif
	endgroup



	__radius		= 0.05
	__angleOrigoX	= __radius
	__angleOrigoY	= tapWidth / 2 - __radius
	__angleOrigoZ	= bottomTapElev
	__startAngle	= -90
	__fullAngle		= 90

	__radius2		= 0.05
	__angleOrigoX2	= tapDepth - __radius2
	__angleOrigoY2	= tapWidth / 2
	__angleOrigoZ2	= bottomTapElev - __radius2
	__startAngle2	= 0
	__fullAngle2	= 90

	tempResol	= __fullAngle / 360 * archResol
	if tempResol - INT(tempResol) < 0.5 then
		tempResol = INT(tempResol)
		__beta = __fullAngle / tempResol
	else
		tempResol = INT(tempResol) + 1
		__beta = __fullAngle / tempResol
	endif
	
	put	0, -1, __angleOrigoZ, 0,
		0, 0, __angleOrigoZ, 0
	for i = 1 to tempResol
		put __angleOrigoX + __radius * SIN(__startAngle), __angleOrigoY + __radius * COS(__startAngle), __angleOrigoZ, 0
		__startAngle = __startAngle + __beta
	next i
	put	__angleOrigoX + __radius * SIN(__startAngle), __angleOrigoY + __radius * COS(__startAngle), __angleOrigoZ, 0,
		__angleOrigoX2, __angleOrigoY2, __angleOrigoZ, 0


	tempResol	= __fullAngle2 / 360 * archResol
	if tempResol - INT(tempResol) < 0.5 then
		tempResol = INT(tempResol)
		__beta2 = __fullAngle2 / tempResol
	else
		tempResol = INT(tempResol) + 1
		__beta2 = __fullAngle2 / tempResol
	endif
	
	for i = 1 to tempResol
		put __angleOrigoX2 + __radius2 * SIN(__startAngle2), __angleOrigoY2, __angleOrigoZ2 + __radius2 * COS(__startAngle2), 0
		__startAngle2 = __startAngle2 + __beta2
	next i
	put	__angleOrigoX2 + __radius2 * SIN(__startAngle2), __angleOrigoY2, __angleOrigoZ2 + __radius2 * COS(__startAngle2), 0,
		__angleOrigoX2 + __radius2 * SIN(__startAngle2 + __beta2), __angleOrigoY2, __angleOrigoZ2 + __radius2 * COS(__startAngle2 + __beta2), 0

	group "bottom taps"
		tube 2, NSP / 4, 1 + 2 + 16 + 32,
			0, 0, 901,
			tapDia / 2, 360, 4001,
			USE(NSP)

		add tapDepth, tapWidth / 2, __angleOrigoZ2
			gosub "tapEnd"
		del 1
		add __angleOrigoX2 + (__radius2 + tapDia / 2) * COS(45), tapWidth / 2, __angleOrigoZ2 + (__radius2 + tapDia / 2) * SIN(45)
		roty 45
			gosub "tapHandle"
		del 2

		muly -1
			tube 2, NSP / 4, 1 + 2 + 16 + 32,
				0, 0, 901,
				tapDia / 2, 360, 4001,
				GET(NSP)
	
			add tapDepth, tapWidth / 2, __angleOrigoZ2
				gosub "tapEnd"
			del 1
			add __angleOrigoX2 + (__radius2 + tapDia / 2) * COS(45), tapWidth / 2, __angleOrigoZ2 + (__radius2 + tapDia / 2) * SIN(45)
			roty 45
				gosub "tapHandle"
			del 2
		del 1
	endgroup

	placegroup "top tap"
	placegroup subgroup("bottom taps", "top tap")

	cylind sThk, 0.015

return



! ======================================================================
"tapEnd":
! ======================================================================

	addz -0.05
		cylind 0.04, 0.004
		addz 0.04
			cylind 0.01, 0.012
		del 1
	del 1

return



! ======================================================================
"tapHandle":
! ======================================================================

	cylind 0.05, 0.012

return


]]>
</Script_3D>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_2D SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[
unID = start_unID

if TapSymbol_m = DET2D_NONE then end
pen gs_cont_pen
line_type 1
fill gs_fill_type

drawindex 30

if tapID = 1 then
	hotspot2 0,				0,	unID, tapOffset1, 1 + 128:		unID = unID + 1
	hotspot2 -1,			0,	unID, tapOffset1, 3:			unID = unID + 1
	hotspot2 tapOffset1,	0,	unID, tapOffset1, 2:			unID = unID + 1

	add2 tapOffset1, 0
else
	hotspot2 0,				0,	unID, tapOffset2, 1 + 128:		unID = unID + 1
	hotspot2 -1,			0,	unID, tapOffset2, 3:			unID = unID + 1
	hotspot2 tapOffset2,	0,	unID, tapOffset2, 2:			unID = unID + 1

	add2 tapOffset2, 0
endif

	gosub "tap"
del 1

!================================================================================
end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! end ! end
!================================================================================

! ======================================================================
"tap":
! ======================================================================

	if TapSymbol_m = DET2D_DETAILED then
		if gs_tap_type_m = 1 then
			poly2_b 5, 1+2+4+64, gs_fill_pen, gs_back_pen,
				tapDia / 2, tapDia / 2, 1,
				tapDia / 2, -neckDepth, 1,
				0, -1, 800,
				-tapDia / 2, -neckDepth, 1001,
				-tapDia / 2, tapDia / 2, 1
		endif

		for i = 1 to 2
			poly2_b 11, 1+2+4+64, gs_fill_pen, gs_back_pen,
				tapDia / 2 * (gs_tap_type_m = 1), tapDia / 2, 1,
				tapWidth / 2 - 0.05, tapDia / 2, 1,
				1, 0, 800,
				tapWidth / 2 + tapDia / 2, -0.05, 1001,
				tapWidth / 2 + tapDia / 2, -tapDepth, 1,
				0, -1, 800,
				tapWidth / 2 - tapDia / 2, -tapDepth, 1001,
				tapWidth / 2 - tapDia / 2, -0.05, 1,
				0, 1, 800,
				tapWidth / 2 - 0.05, -tapDia / 2, 1001,
				tapDia / 2 * (gs_tap_type_m = 1), -tapDia / 2, (gs_tap_type_m = 1)
	
			mul2 -1, 1
		next i
		del 2
	else
		if gs_tap_type_m = 1 then
			poly2_b 4, 1+2+4+64, gs_fill_pen, gs_back_pen,
				tapDia / 2, tapDia / 2, 1,
				tapDia / 2, -neckDepth - tapDia / 2, 1,
				-tapDia / 2, -neckDepth - tapDia / 2, 1,
				-tapDia / 2, tapDia / 2, 1
		endif

		for i = 1 to 2
			poly2_b 6, 1+2+4+64, gs_fill_pen, gs_back_pen,
				tapDia / 2 * (gs_tap_type_m = 1), tapDia / 2, 1,
				tapWidth / 2 + tapDia / 2, tapDia / 2, 1,
				tapWidth / 2 + tapDia / 2, -tapDepth - tapDia / 2, 1,
				tapWidth / 2 - tapDia / 2, -tapDepth - tapDia / 2, 1,
				tapWidth / 2 - tapDia / 2, -tapDia / 2, 1,
				tapDia / 2 * (gs_tap_type_m = 1), -tapDia / 2, (gs_tap_type_m = 1)
	
			mul2 -1, 1
		next i
		del 2
	endif

return
]]>
</Script_2D>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_1D SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[
EPS = 0.0001

dim stTapType[3]
	stTapType[1] = `Нет`
	stTapType[2] = `Стиль 1`
	stTapType[3] = `Стиль 2`

DET3D_DETAILED		= 2
DET3D_SIMPLE		= 1
DET3D_NONE			= 0

DET2D_DETAILED		= 2
DET2D_SIMPLE		= 1
DET2D_NONE			= 0

if gs_tap_type_m = 1 then
	tapWidth		= 0.3
	tapDepth		= 0.3
	tapDia			= 0.02
	neckDia			= 0.015
	neckDepth		= 0.2
	bottomTapElev	= 0.25
	neckStart		= 0.4
else
	tapWidth		= 0.15
	tapDepth		= 0.15
	tapDia			= 0.02
	neckDia			= 0.015
	neckDepth		= 0.2
	bottomTapElev	= tapHeight
	neckStart		= bottomTapElev
endif
sThk				= 0.008
]]>
</Script_1D>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_PR SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_PR>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_UI SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_UI>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_VL SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[
values "gs_tap_type" stTapType
values "gs_tap_type_m" 0, 1, 2
if GLOB_MODPAR_NAME = "gs_tap_type" then
	gs_tap_type_m = 1
	if gs_tap_type = stTapType[1] then gs_tap_type_m = 0
	if gs_tap_type = stTapType[3] then gs_tap_type_m = 2
	parameters gs_tap_type_m  = gs_tap_type_m
else
	gs_tap_type = stTapType[2]
	if gs_tap_type_m = 0 then gs_tap_type = stTapType[1]
	if gs_tap_type_m = 2 then gs_tap_type = stTapType[3]
	parameters gs_tap_type = gs_tap_type
endif

call "tapType_m" parameters	all	enableTapGroups			= 0,
								enableSingleLevelTaps	= 0,
								enableTwoHandleTaps		= 0,
								enableTraditionalTaps	= 0,
								enableSensorFaucets		= 0,
								enableWallMountedTaps	= 0,
								enableCustomTaps		= 0,
								bEnableTapEdit			= 0,
								bShower 				= 0,
								enableTapSymbols		= 2 + 4 + 32

if gs_tap_type_m = 1 then
	values "tapHeight" range[neckStart + neckDepth / 2, ]
else
	values "tapHeight" range[0.1, ]
endif
]]>
</Script_VL>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_FWM SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_FWM>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_BWM SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_BWM>

<ParamSection SectVersion="26" SectionFlags="0" SubIdent="0">
	<ParamSectHeader>
		<Version>26</Version>
		<AutoHotspots>false</AutoHotspots>
		<StatBits>
			<STBit_FixSize/>
		</StatBits>
		<WDLeftFrame>0</WDLeftFrame>
		<WDRightFrame>0</WDRightFrame>
		<WDTopFrame>0</WDTopFrame>
		<WDBotFrame>0</WDBotFrame>
		<LayFlags>65535</LayFlags>
		<WDMirrorThickness>0</WDMirrorThickness>
		<WDWallInset>0</WDWallInset>
		<SymbolColor>0</SymbolColor>
	</ParamSectHeader>
	<Parameters>
		<Length Name="A">
			<Description><![CDATA["Dimension 1"]]></Description>
			<Fix/>
			<Value>1</Value>
		</Length>
		<Length Name="B">
			<Description><![CDATA["Dimension 2"]]></Description>
			<Fix/>
			<Value>1</Value>
		</Length>
		<Length Name="ZZYZX">
			<Description><![CDATA["Height"]]></Description>
			<Fix/>
			<Value>1</Value>
		</Length>
		<Boolean Name="AC_show2DHotspotsIn3D">
			<Description><![CDATA["Show 2D Hotspots in 3D"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>1</Value>
		</Boolean>
		<Length Name="ac_bottomlevel">
			<Description><![CDATA["Bottom Level"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>1</Value>
		</Length>
		<Length Name="ac_toplevel">
			<Description><![CDATA["Top Level"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>
		<Integer Name="gs_detlevel_3D_m">
			<Description><![CDATA[""]]></Description>
			<Value>2</Value>
		</Integer>
		<Integer Name="gs_resol">
			<Description><![CDATA["Resolution"]]></Description>
			<Value>24</Value>
		</Integer>
		<Boolean Name="gs_shadow">
			<Description><![CDATA["Shadow"]]></Description>
			<Value>1</Value>
		</Boolean>
		<Material Name="gs_tap_mat">
			<Description><![CDATA["Tap Surface"]]></Description>
			<Value>11</Value>
		</Material>
		<Integer Name="tapID">
			<Description><![CDATA[""]]></Description>
			<Value>1</Value>
		</Integer>
		<String Name="gs_tap_type">
			<Description><![CDATA["Tap Type"]]></Description>
			<Value><![CDATA["Стиль 1"]]></Value>
		</String>
		<Integer Name="gs_tap_type_m">
			<Description><![CDATA["Tap Type"]]></Description>
			<Value>1</Value>
		</Integer>
		<Length Name="tapOffset1">
			<Description><![CDATA["Tap Offset 1"]]></Description>
			<Value>0</Value>
		</Length>
		<Length Name="tapOffset2">
			<Description><![CDATA["Tap Offset 2"]]></Description>
			<Value>0</Value>
		</Length>
		<Length Name="tapHeight">
			<Description><![CDATA["Tap Height"]]></Description>
			<Value>0.7</Value>
		</Length>
		<String Name="TapSymbol">
			<Description><![CDATA["Tap Symbol Type"]]></Description>
			<Value><![CDATA["Простой"]]></Value>
		</String>
		<Integer Name="TapSymbol_m">
			<Description><![CDATA["Tap Symbol Type"]]></Description>
			<Value>1</Value>
		</Integer>
		<PenColor Name="gs_cont_pen">
			<Description><![CDATA["Contour Pen"]]></Description>
			<Value>4</Value>
		</PenColor>
		<FillPattern Name="gs_fill_type">
			<Description><![CDATA["Fill Type"]]></Description>
			<Value>65</Value>
		</FillPattern>
		<PenColor Name="gs_fill_pen">
			<Description><![CDATA["Fill Background Pen"]]></Description>
			<Value>19</Value>
		</PenColor>
		<PenColor Name="gs_back_pen">
			<Description><![CDATA["Fill Background Pen"]]></Description>
			<Value>19</Value>
		</PenColor>
		<Integer Name="start_unID">
			<Description><![CDATA["unID"]]></Description>
			<Value>1</Value>
		</Integer>
	</Parameters>
</ParamSection>

<Copyright SectVersion="1" SectionFlags="0" SubIdent="0">
	<Author>GRAPHISOFT</Author>
	<License>
		<Type>CC BY-ND</Type>
		<Version>3.0</Version>
	</License>
</Copyright>

<Keywords SectVersion="1" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Keywords>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Comment SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Comment>

</Symbol>
