<?xml version="1.0" encoding="UTF-8"?>
<Symbol IsArchivable="true" IsPlaceable="false" MainGUID="6F594F19-2447-492C-B7A1-DAA68E580829" MigrationValue="Normal" Owner="1196638531" Signature="1196644685" Version="43">
<Ancestry SectVersion="1" SectionFlags="0" SubIdent="0" Template="false">
	<MainGUID>F938E33A-329D-4A36-BE3E-85E126820996</MainGUID>
	<MainGUID>103E8D2C-8230-42E1-9597-46F84CCE28C0</MainGUID>
	<MainGUID>784EAEA1-5041-4AA6-B6F4-EF263A891EE7</MainGUID>
	<MainGUID>09BEB35E-7BF8-448C-B408-AC04D159B0D1</MainGUID>
</Ancestry>

<ParamSection SectVersion="22" SectionFlags="0" SubIdent="0">
	<ParamSectHeader>
		<AutoHotspots>false</AutoHotspots>
		<StatBits>
			<STBit_FixSize/>
		</StatBits>
		<WDLeftFrame>0</WDLeftFrame>
		<WDRightFrame>0</WDRightFrame>
		<WDTopFrame>0</WDTopFrame>
		<WDBotFrame>0</WDBotFrame>
		<LayFlags>65535</LayFlags>
		<WDMirrorThickness>0</WDMirrorThickness>
		<WDWallInset>0</WDWallInset>
	</ParamSectHeader>
	<Parameters>
		<Length Name="A">
			<Description><![CDATA["Dimension 1"]]></Description>
			<Fix/>
			<Value>1.5</Value>
		</Length>
		<Length Name="B">
			<Description><![CDATA["Dimension 2"]]></Description>
			<Fix/>
			<Value>0.05</Value>
		</Length>
		<Length Name="ZZYZX">
			<Description><![CDATA["Height"]]></Description>
			<Fix/>
			<Value>0.9</Value>
		</Length>
		<Integer Name="gs_detlevel_3D_m">
			<Description><![CDATA["3D"]]></Description>
			<Value>2</Value>
		</Integer>
		<Boolean Name="cfs">
			<Description><![CDATA["Called as Macro from Stair"]]></Description>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Boolean>

		<!-- RailBalust_sp0: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="RailBalust_sp0">
			<Description><![CDATA["General Dimensions"]]></Description>
		</Title>
		<Integer Name="ptyp_m">
			<Description><![CDATA["Rail and Parameter Input Type"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Integer>
		<Angle Name="ani">
			<Description><![CDATA["Inclination Angle"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Angle>
		<Integer Name="rom_m">
			<Description><![CDATA["Rail Orientation Method"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Integer>
		<Integer Name="rmm_m">
			<Description><![CDATA["Rail Measurement Method"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Integer>
		<Length Name="lra">
			<Description><![CDATA["Horizontal Length of Railing"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1.5</Value>
		</Length>
		<Length Name="lrah">
			<Description><![CDATA["Length of Railing"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1.5</Value>
		</Length>
		<Length Name="hr">
			<Description><![CDATA["Height of Railing"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.75</Value>
		</Length>
		<Length Name="hrPerp">
			<Description><![CDATA["Height of Railing"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0.75</Value>
		</Length>
		<Angle Name="ab">
			<Description><![CDATA["Angle of Bending"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>90</Value>
		</Angle>
		<Length Name="rb">
			<Description><![CDATA["Radius of Bending"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Length>
		<Length Name="ds">
			<Description><![CDATA["Distance from Slab/Stair"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.15</Value>
		</Length>
		<Length Name="dsPerp">
			<Description><![CDATA["Distance from Slab/Stair"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0.15</Value>
		</Length>
		<Angle Name="gs_AngleL">
			<Description><![CDATA["Left End Cutting Angle"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>90</Value>
		</Angle>
		<Angle Name="gs_AngleR">
			<Description><![CDATA["Right End Cutting Angle"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>90</Value>
		</Angle>

		<!-- RailParale_sp0: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="RailParale_sp0">
			<Description><![CDATA["Structural Dimensions"]]></Description>
		</Title>
		<Integer Name="btyp_m">
			<Description><![CDATA["Bar Style"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Integer>
		<Length Name="fth">
			<Description><![CDATA["Bar Width"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.05</Value>
		</Length>
		<Length Name="bh">
			<Description><![CDATA["Bar Height"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.025</Value>
		</Length>
		<Length Name="bd">
			<Description><![CDATA["Bar Diameter"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.05</Value>
		</Length>

		<!-- gs_3D_representation: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="gs_3D_representation">
			<Description><![CDATA["3D Representation"]]></Description>
		</Title>
		<Integer Name="res">
			<Description><![CDATA["Rail Arc Resolution"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>32</Value>
		</Integer>
		<Integer Name="rescs">
			<Description><![CDATA["Cross Section Resolution"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>12</Value>
		</Integer>
		<Boolean Name="gs_shadow">
			<Description><![CDATA["Shadow"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Boolean>
		<Boolean Name="AC_show2DHotspotsIn3D">
			<Description><![CDATA["Show 2D Hotspots in 3D"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Length Name="ac_bottomlevel">
			<Description><![CDATA["Bottom Level"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>1</Value>
		</Length>
		<Length Name="ac_toplevel">
			<Description><![CDATA["Top Level"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>

		<!-- gs_2D_representation: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="gs_2D_representation">
			<Description><![CDATA["2D Representation"]]></Description>
			<Fix/>
		</Title>
		<PenColor Name="gs_cont_pen">
			<Description><![CDATA["Contour Pen"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>2</Value>
		</PenColor>
		<FillPattern Name="gs_fill_type">
			<Description><![CDATA["Fill Type"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>65</Value>
		</FillPattern>
		<PenColor Name="gs_fill_pen">
			<Description><![CDATA["Fill Pen"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>91</Value>
		</PenColor>
		<PenColor Name="gs_back_pen">
			<Description><![CDATA["Fill Background Pen"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>91</Value>
		</PenColor>
		<Boolean Name="sa">
			<Description><![CDATA["Show Axis"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Boolean>
		<LineType Name="al">
			<Description><![CDATA["Axis Line Type"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>6</Value>
		</LineType>
		<PenColor Name="gs_RailAxisPen">
			<Description><![CDATA["Axis Line Pen"]]></Description>
			<Value>16</Value>
		</PenColor>

		<!-- RailBalust_sp2: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="RailBalust_sp2">
			<Description><![CDATA["Surfaces"]]></Description>
		</Title>
		<Material Name="fmat">
			<Description><![CDATA["Bar"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>15</Value>
		</Material>

		<!-- gs_list: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="gs_list">
			<Description><![CDATA["Parameters for Listing"]]></Description>
			<Fix/>
		</Title>
		<RealNum Name="gs_list_cost">
			<Description><![CDATA["Cost"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</RealNum>
		<String Name="gs_list_manufacturer">
			<Description><![CDATA["Manufacturer"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="gs_list_note">
			<Description><![CDATA["Note/Remarks"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="gs_list_location">
			<Description><![CDATA["Location"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="gs_list_accessories">
			<Description><![CDATA["Accessories"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="FM_Type">
			<Description><![CDATA["Group Type"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA["Другой"]]></Value>
		</String>
		<Integer Name="iFMType">
			<Description><![CDATA["Group Type"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>25</Value>
		</Integer>
		<String Name="FM_InventoryNumber">
			<Description><![CDATA["Inventory No."]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="FM_SerialNumber">
			<Description><![CDATA["Serial No."]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="FM_ProductionYear">
			<Description><![CDATA["Production Year"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<RealNum Name="FM_ObjectWeight">
			<Description><![CDATA["Object Weight"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</RealNum>
		<String Name="FM_ObjectWeightUnit">
			<Description><![CDATA["Object Weight Unit"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA["кг"]]></Value>
		</String>
		<String Name="gs_list_custom1">
			<Description><![CDATA["User Defined 1"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="gs_list_custom2">
			<Description><![CDATA["User Defined 2"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="gs_list_custom3">
			<Description><![CDATA["User Defined 3"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="gs_list_custom4">
			<Description><![CDATA["User Defined 4"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="gs_list_custom5">
			<Description><![CDATA["User Defined 5"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
	</Parameters>
</ParamSection>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_VL SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[
! GENERAL PARAMETERS
values "gs_detlevel_3D_m" 2,1,0		! Detailed, Simple, Off


! SPECIFIC RAIL GEOMETRY PARAMETERS
values "btyp_m" 1,2					! Rectangular, Round
if btyp_m=2 then
	hideparameter "fth","bh"
	else
	hideparameter "bd"
endif


! GENERAL RAIL GEOMETRY PARAMETERS
values "ptyp_m" 1,2,3				! Straight, Curve Length and Radius, Angle and Radius


VALUES "a" lra
VALUES "zzyzx" ds+hr


IF ptyp_m<>1 then
		IF btyp_m=1 then VALUES "b" fth
		IF btyp_m=2 then VALUES "b" bd
		lock "a","b","zzyzx"
	ELSE
		IF btyp_m=1 then
			IF GLOB_MODPAR_NAME = "B" THEN PARAMETERS fth=B
			IF GLOB_MODPAR_NAME = "fth" THEN PARAMETERS B=fth
			IF GLOB_MODPAR_NAME = "btyp_m" THEN PARAMETERS fth=B
		ELSE
			IF GLOB_MODPAR_NAME = "B" THEN PARAMETERS bd=B
			IF GLOB_MODPAR_NAME = "bd" THEN PARAMETERS B=bd
			IF GLOB_MODPAR_NAME = "btyp_m" THEN PARAMETERS bd=B
		ENDIF
	lock "a","zzyzx"
ENDIF

IF ptyp_m<>1 OR rom_m<>1 THEN
	LOCK "gs_AngleL"
	LOCK "gs_AngleR"
ENDIF

if ptyp_m=1 then
	hideparameter "ab"
	hideparameter "rb"
	hideparameter "res"
endif

if ptyp_m=2 then
	IF ABS(rb)>EPS THEN
		parameters ab=(lra*180)/(rb*pi)
		lock "ab"
	endif
endif

if ptyp_m=3 then
	parameters lra=(rb*pi*ab)/180
	lock "lra"
endif


if gs_cont_pen=0 then parameters gs_cont_pen=2
if gs_fill_pen=0 then parameters gs_fill_pen=91

!!PARAMETER RANGE DEFINITION!!
	VALUES "ani" range(-90, 0), range (0, 90)
	VALUES "hr" range(0,)
	VALUES "lra" RANGE(0,)
	VALUES "lrah" RANGE(0,)
	VALUES "B" range(0,)
	values "fth" range(0,)
	values "bh" range(0,)
	values "bd" range(0,)
	VALUES "gs_AngleL" 	range(0,180)
	VALUES "gs_AngleR" 	range(0,180)
	values "res" range[3,)
	values "rescs" range[3,)

if btyp_m = 1 then
	lock			"rescs"
	hideparameter	"rescs"
endif

IF ABS(ani)<EPS THEN
	VALUES "ab" RANGE (0,360]
	LOCK "rom_m","rmm_m"
ELSE
	VALUES "ab" RANGE (0,)
ENDIF

! Distance from Slab/Stair
if GLOB_MODPAR_NAME = "dsPerp" then
	ds = dsPerp * cos(ani)
	parameters ds = ds
else
	dsPerp = ds / cos(ani)
	parameters dsPerp = dsPerp
endif

! Height of Railing
if GLOB_MODPAR_NAME = "hrPerp" then
	hr = hrPerp * cos(ani)
	parameters hr = hr
else
	hrPerp = hr / cos(ani)
	parameters hrPerp = hrPerp
endif

]]>
</Script_VL>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_3D SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[
!Rail Simple Bar

if gs_detlevel_3D_m=0 then end

if GLOB_CONTEXT>20 and GLOB_CONTEXT<40 then 		!! for Simple Model and in 3D Windoow
gs_detlevel_3D_m=1
endif

if gs_shadow=0 then SHADOW OFF

IF ABS(lra)<EPS THEN END

pen gs_cont_pen
unID=1


If gs_detlevel_3D_m=1 or gs_detlevel_3D_m=2 then

XPosL0=(fth/2)/tan(gs_AngleL)
XPosR0=(fth/2)/tan(gs_AngleR)

XPosL=ABS((fth/2)/tan(gs_AngleL))
XPosR=ABS((fth/2)/tan(gs_AngleR))
YPosL=(XPosL*tan(ani))
YPosR=(XPosR*tan(ani))

material fmat

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! *** STRAIGHT *** !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

	if ABS(ani)<EPS and ptyp_m=1 then

	resol rescs

			!!!FRAME
			MATERIAL fmat
			if btyp_m=1 then

				ADDz ds+hr-bh
					PRISM_ 5,bh,
						XPosL0,fth/2,15,
						-XPosL0,-fth/2,15,
						lra+XPosR0,-fth/2,15,
						lra-XPosR0,fth/2,15,
						XPosL0,fth/2,-1
				DEL 1

			else

				ROTz -90+gs_AngleL		!! CONNECTING ANGLE
				ROTy -90
					CUTPLANE
				DEL 2

				ADDx lra
				ROTz 90-gs_AngleR
				ROTy 90
					CUTPLANE
				DEL 3

						add -XPosL0, 0, ds+hr-bd/2
						roty 90
						cylind lra+XPosL0+XPosR0,bd/2
						del 2
				CUTEND
				CUTEND

			endif

			IF cfs=0 THEN
				!!!LENGHT

				HOTSPOT 0,0,0,unID,lra,1+256 : unID=unID+1
				HOTSPOT lra,0,0,unID,lra,2 : unID=unID+1
				HOTSPOT -1,0,0,unID,lra,3 : unID=unID+1

				HOTSPOT 0,0,ds+hr,unID,lra,1+256 : unID=unID+1
				HOTSPOT lra,0,ds+hr,unID,lra,2 : unID=unID+1
				HOTSPOT -1,0,ds+hr,unID,lra,3 : unID=unID+1

				!!!DISTANCE FROM FLOOR
				HOTSPOT lra,0,0,unID,ds,1+128 : unID=unID+1
				HOTSPOT lra,0,ds,unID,ds,2 : unID=unID+1
				HOTSPOT lra,0,-1,unID,ds,3 : unID=unID+1

				HOTSPOT 0,0,0,unID,ds,1+128 : unID=unID+1
				HOTSPOT 0,0,ds,unID,ds,2 : unID=unID+1
				HOTSPOT 0,0,-1,unID,ds,3 : unID=unID+1

				!!!HEIGHT OF RAILING
				HOTSPOT lra/2,0,ds,unID,hr,1+128 : unID=unID+1
				HOTSPOT lra/2,0,ds+hr,unID,hr,2 : unID=unID+1
				HOTSPOT lra/2,0,-1,unID,hr,3 : unID=unID+1

			ENDIF
	endif


!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! *** STRAIGHT CURVED *** !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!


	if ABS(ani)<EPS and ptyp_m<>1 then

	!FRAME
	material fmat
	resol res

	if ab<360 then

			if btyp_m=1 then
				addz ds+hr-bh
					PRISM_ 10,bh,
						0,fth/2,15,
						0,-fth/2+0.00005,15,
						0,-fth/2,79,
						1,0,800,
						(rb+(fth/2))*sin(ab),rb-(rb+(fth/2))*cos(ab),1015,
						(rb-(fth/2)+0.00005)*sin(ab),rb-(rb-(fth/2)+0.00005)*cos(ab),15,
						(rb-(fth/2))*sin(ab),rb-(rb-(fth/2))*cos(ab),79,
						-cos(ab),-sin(ab),800,
						0,fth/2,1015,
						0,fth/2,-1
				del 1
			else
					gamma0=360/rescs
					gamma=0
					for i=1 to rescs step 1
					put bd/2*cos(gamma),rb+bd/2*sin(gamma),1
					gamma=gamma+gamma0
					next i

					add  0,rb,ds+hr-bd/2
					roty 90
					rotx 180-ab
						REVOLVE rescs+1,ab,1+2+4+8+16+32,
						get (nsp),
					bd/2,rb,-1
					del 3

			endif

			IF cfs=0 THEN
				!!!HOTSPOTS FOR GRAPHICAL EDITING
				!!!ROTATE
				IF ptyp_m=3 THEN
					HOTSPOT 0,rb,ds,unID,ab,6 : unID=unID+1
					HOTSPOT 0,0,ds,unID,ab,4+256 : unID=unID+1
					HOTSPOT rb*sin(ab),rb-rb*cos(ab),ds,unID,ab,5 : unID=unID+1

					!!!FIX HOTSPOT AT FLOOR
					HOTSPOT 0,0,0,unID : unID=unID+1
					HOTSPOT rb*sin(ab),rb-rb*cos(ab),0,unID : unID=unID+1
				ENDIF
				!!!HEIGHT
					HOTSPOT 0,0,ds,unID,hr,1+128 : unID=unID+1
					HOTSPOT 0,0,ds+hr,unID,hr,2 : unID=unID+1
					HOTSPOT 0,0,-1,unID,hr,3 : unID=unID+1

					HOTSPOT rb*sin(ab),rb-rb*cos(ab),ds,unID,hr,1+128 : unID=unID+1
					HOTSPOT rb*sin(ab),rb-rb*cos(ab),ds+hr,unID,hr,2 : unID=unID+1
					HOTSPOT rb*sin(ab),rb-rb*cos(ab),-1,unID,hr,3 : unID=unID+1

					HOTSPOT rb*sin(ab/2),rb-rb*cos(ab/2),ds,unID,hr,1+128 : unID=unID+1
					HOTSPOT rb*sin(ab/2),rb-rb*cos(ab/2),ds+hr,unID,hr,2 : unID=unID+1
					HOTSPOT rb*sin(ab/2),rb-rb*cos(ab/2),-1,unID,ds,3 : unID=unID+1

					HOTSPOT rb*sin(ab/2),rb-rb*cos(ab/2),0,unID,ds,1+128 : unID=unID+1
					HOTSPOT rb*sin(ab/2),rb-rb*cos(ab/2),ds,unID,ds,2 : unID=unID+1
					HOTSPOT rb*sin(ab/2),rb-rb*cos(ab/2),-1,unID,ds,3 : unID=unID+1

					!!!FIX HOTSPOT AT FLOOR
					HOTSPOT rb*sin(ab/2),rb-rb*cos(ab/2),0,unID : unID=unID+1

				IF ptyp_m=2 THEN
					HOTSPOT 0,0,0,unID,ds,1 : unID=unID+1
					HOTSPOT 0,0,ds,unID,ds,2 : unID=unID+1
					HOTSPOT 0,0,-1,unID,ds,3 : unID=unID+1

					HOTSPOT rb*sin(ab),rb-rb*cos(ab),0,unID,ds,1 : unID=unID+1
					HOTSPOT rb*sin(ab),rb-rb*cos(ab),ds,unID,ds,2 : unID=unID+1
					HOTSPOT rb*sin(ab),rb-rb*cos(ab),-1,unID,ds,3 : unID=unID+1
				ENDIF
			ENDIF

	else	!!!ANGLE=360

			if btyp_m=1 then
				addz ds+hr-bh
					prism_ 12,bh,
					0,-fth/2,79,
					1,0,800,
					0,2*rb+fth/2,1079,
					-1,0,800,
					0,-fth/2,1079,
					0,-fth/2,-1,

					0,fth/2,79,
					1,0,800,
					0,2*rb-fth/2,1079,
					-1,0,800,
					0,fth/2,1079,
					0,fth/2,-1
				del 1
			else
					gamma0=360/rescs
					gamma=0
					for i=1 to rescs step 1
					put bd/2*cos(gamma),rb+bd/2*sin(gamma),1
					gamma=gamma+gamma0
					next i
					add  0,rb,ds+hr-bd/2
					roty 90
					rotx 180-ab
					revolve rescs+1,360,0,
					get (nsp),
					bd/2,rb,-1
					del 3
			endif

			IF cfs=0 THEN

			!!!HOTSPOTS FOR GRAPHICAL EDITING
			!!!HEIGHT

				HOTSPOT 0,0,ds,unID,hr,1 : unID=unID+1
				HOTSPOT 0,0,ds+hr,unID,hr,2 : unID=unID+1
				HOTSPOT 0,0,-1,unID,hr,3 : unID=unID+1

				HOTSPOT rb,rb,ds,unID,hr,1 : unID=unID+1
				HOTSPOT rb,rb,ds+hr,unID,hr,2 : unID=unID+1
				HOTSPOT rb,rb,-1,unID,hr,3 : unID=unID+1

				HOTSPOT 0,2*rb,ds,unID,hr,1 : unID=unID+1
				HOTSPOT 0,2*rb,ds+hr,unID,hr,2 : unID=unID+1
				HOTSPOT 0,2*rb,-1,unID,hr,3 : unID=unID+1

				HOTSPOT -rb,rb,ds,unID,hr,1 : unID=unID+1
				HOTSPOT -rb,rb,ds+hr,unID,hr,2 : unID=unID+1
				HOTSPOT -rb,rb,-1,unID,hr,3 : unID=unID+1

				HOTSPOT 0,0,0,unID,ds,1 : unID=unID+1
				HOTSPOT 0,0,ds,unID,ds,2 : unID=unID+1
				HOTSPOT 0,0,-1,unID,ds,3 : unID=unID+1

				HOTSPOT rb,rb,0,unID,ds,1 : unID=unID+1
				HOTSPOT rb,rb,ds,unID,ds,2 : unID=unID+1
				HOTSPOT rb,rb,-1,unID,ds,3 : unID=unID+1

				HOTSPOT 0,2*rb,0,unID,ds,1 : unID=unID+1
				HOTSPOT 0,2*rb,ds,unID,ds,2 : unID=unID+1
				HOTSPOT 0,2*rb,-1,unID,ds,3 : unID=unID+1

				HOTSPOT -rb,rb,0,unID,ds,1 : unID=unID+1
				HOTSPOT -rb,rb,ds,unID,ds,2 : unID=unID+1
				HOTSPOT -rb,rb,-1,unID,ds,3 : unID=unID+1
			ENDIF

		endif

	endif


!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! *** STRAIGHT INCLINED *** !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!


if ABS(ani)>EPS and ptyp_m=1 then

	RESOL rescs

		if rom_m=1 then				!Vertical Orientation
			if rmm_m=2 then		!Perpendicular Measurement Extra Values
				ftw=ftw/cos(ani)
				fbw=fbw/cos(ani)
			endif

			IF rmm_m=1 THEN			!!Vertical Measurement
				temp_ds=ds
				temp_hr=hr
				temp_bd=(bd/2)*cos(ani)
			ELSE					!!Perpendicular Measurement
				temp_ds=dsPerp
				temp_hr=hrPerp
				temp_bd=bd/2
			ENDIF


			ROTz -90+gs_AngleL		!!! CONNECTING ANGLE
			ROTy -90
				CUTPLANE
			DEL 2

			ADDx lra
			ROTz 90-gs_AngleR
			ROTy 90
				CUTPLANE
			DEL 3

				!!!FRAME
				material fmat
				if btyp_m=1 then
					rotx 90
					addz -fth/2
					PRISM_ 5,fth,
						-XPosL,temp_ds+temp_hr-bh-YPosL,15,
						lra+XPosR,temp_ds+temp_hr-bh+lra*tan(ani)+YPosR,15,
						lra+XPosR,temp_ds+temp_hr+lra*tan(ani)+YPosR,15,
						-XPosL,temp_ds+temp_hr-YPosL,15,
						-XPosL,temp_ds+temp_hr-bh-YPosL,-1
					del 2
				else
					add -XPosL,0,temp_ds+temp_hr-bd/2
					roty 90-ani
						CONE lra/cos(ani)+XPosL+XPosR,temp_bd,temp_bd,90+ani,90+ani
					del 2
				endif

			CUTEND
			CUTEND

			IF cfs=0 THEN
					!!!HOTSPOTS FOR GRAPHICAL EDITING

					!!! LENGTH of RAILING
					HOTSPOT 0,	0,	0,				unID, lrah, 1+256 : unID=unID+1
					HOTSPOT -1, 0,	0-tan(ani),		unID, lrah, 3 : unID=unID+1
					HOTSPOT lra,0, 	0+lra*tan(ani),	unID, lrah, 2 : unID=unID+1

					HOTSPOT 0,	 0,	temp_ds+temp_hr,				unID, lrah, 1+256 : unID=unID+1
					HOTSPOT -1,  0,	temp_ds+temp_hr-tan(ani),		unID, lrah, 3 : unID=unID+1
					HOTSPOT lra, 0, temp_ds+temp_hr+lra*tan(ani),	unID, lrah, 2 : unID=unID+1


				IF rmm_m=1 THEN

					!!! DISTANCE FROM FLOOR

					HOTSPOT 0,	0,	0,	unID, ds, 1+128 : unID=unID+1
					HOTSPOT 0,	0,	-1,	unID, ds, 3 : unID=unID+1
					HOTSPOT 0,	0, 	temp_ds,	unID, ds, 2 : unID=unID+1

					HOTSPOT lra,	0,	lra*tan(ani),	unID, ds, 1+128 : unID=unID+1
					HOTSPOT lra,	0,	lra*tan(ani)-1,	unID, ds, 3 : unID=unID+1
					HOTSPOT lra,	0, 	lra*tan(ani)+temp_ds,	unID, ds, 2 : unID=unID+1

					!!! HEIGHT of RAILING
					HOTSPOT lra/2,	0,	temp_ds+lra/2*tan(ani),	unID, hr, 1+128 : unID=unID+1
					HOTSPOT lra/2,	0,	temp_ds+lra/2*tan(ani)-1,	unID, hr, 3 : unID=unID+1
					HOTSPOT lra/2,	0, 	temp_ds+lra/2*tan(ani)+temp_hr,unID, hr, 2 : unID=unID+1

				ELSE

					!!! DISTANCE FROM FLOOR
					HOTSPOT 0,	0,	0,	unID, dsPerp, 1+128, ds : unID=unID+1
					HOTSPOT 0,	0,	0-1,	unID, dsPerp, 3, ds : unID=unID+1
					HOTSPOT 0,	0, 	0+temp_ds,	unID, dsPerp, 2, ds : unID=unID+1

					HOTSPOT lra,	0,	lra*tan(ani),	unID, dsPerp, 1+128, ds : unID=unID+1
					HOTSPOT lra,	0,	lra*tan(ani)-1,	unID, dsPerp, 3, ds : unID=unID+1
					HOTSPOT lra,	0, 	lra*tan(ani)+temp_ds,	unID, dsPerp, 2, ds : unID=unID+1

					!!! HEIGHT of RAILING
					HOTSPOT lra/2,	0,	temp_ds+lra/2*tan(ani),	unID, hrPerp, 1+128, hr : unID=unID+1
					HOTSPOT lra/2,	0,	temp_ds+lra/2*tan(ani)-1,	unID, hrPerp, 3, hr  : unID=unID+1
					HOTSPOT lra/2,	0, 	temp_ds+lra/2*tan(ani)+temp_hr,unID, hrPerp, 2, hr  : unID=unID+1

				ENDIF
			ENDIF

	else						!Perpendicular Orientation
								!Measurement is always perpendicular to inclination in this case

		roty -ani

			!FRAME
			material fmat
			if btyp_m=1 then
				rotx 90
				addz -fth/2
					prism_ 5,fth,
						0,ds+hr-bh,15,
						lrah,ds+hr-bh,15,
						lrah,ds+hr,15,
						0,ds+hr,15,
						0,ds+hr-bh,-1
				del 2
			else
				addz ds+hr-(bd/2)
				roty 90
					cylind lrah,bd/2
				del 2
			endif

			IF cfs=0 THEN
				!!! LENGTH OF RAILING
				HOTSPOT 0,0,0,unID,lrah,1+256 : unID=unID+1
				HOTSPOT lrah,0,0,unID,lrah,2 	: unID=unID+1
				HOTSPOT -1,0,0,unID,lrah,3 	: unID=unID+1

				HOTSPOT 0,0,ds+hr,unID,lrah,1+256 : unID=unID+1
				HOTSPOT lrah,0,ds+hr,unID,lrah,2 	: unID=unID+1
				HOTSPOT -1,0,ds+hr,unID,lrah,3 	: unID=unID+1

				!!!DISTANCE FROM FLOOR
				HOTSPOT 0,0,0,unID,ds,1+128 : unID=unID+1
				HOTSPOT 0,0,ds,unID,ds,2 : unID=unID+1
				HOTSPOT 0,0,-1,unID,ds,3 : unID=unID+1

				HOTSPOT lrah,0,0,unID,ds,1+128 : unID=unID+1
				HOTSPOT lrah,0,ds,unID,ds,2 : unID=unID+1
				HOTSPOT lrah,0,-1,unID,ds,3 : unID=unID+1

				!!! HEIGHT of RAILING
				HOTSPOT lrah/2,0,ds,unID,hr,1+128 : unID=unID+1
				HOTSPOT lrah/2,0,ds+hr,unID,hr,2 : unID=unID+1
				HOTSPOT lrah/2,0,-1,unID,hr,3 : unID=unID+1

			ENDIF

		del 1

	endif


endif



!!!!!!!!!!!!!!!!!!!!!!!!!!!! *** INCLINED AND CURVED *** !!!!!!!!!!!!!!!!!!!!!!!!!!!!


	if ABS(ani)>EPS and ptyp_m<>1 then

	resol rescs

		!FRAME
		material fmat

		alphai=-alphaincl
		deltazi=-deltazincl
		for i=1 to nalphaincl+3 step 1
		put rb*sin(alphai),rb-rb*cos(alphai),ds+deltazi
		alphai=alphai+alphaincl
		deltazi=deltazi+deltazincl
		next i

		if btyp_m=1 then
			addz hr-bh
			tubea 5,nalphaincl+3,1+2+16+32,
			-fth/2,0,0,
			fth/2,0,0,
			fth/2,bh,0,
			-fth/2,bh,0,
			-fth/2,0,-1,
			get (nsp)
			del 1
		else
			addz hr-bd/2
			tubea 6,nalphaincl+3,1+2+16+32,
			-bd/2,0,1,
			0,-1,801,
			bd/2,0,1001,
			0,1,801,
			-bd/2,0,1001,
			-bd/2,0,-1,
			get (nsp)
			del 1
		endif

		IF cfs=0 THEN
			!!!HOTSPOTS FOR GRAPHICAL EDITING
			!!!ROTATE
			IF ptyp_m=3 THEN
				HOTSPOT 0,rb,ds+lra*sin(ani),unID,ab,6 : unID=unID+1
				HOTSPOT 0,0,ds+lra*sin(ani),unID,ab,4+128 : unID=unID+1
				HOTSPOT rb*sin(ab),rb-rb*cos(ab),ds+lra*sin(ani),unID,ab,5 : unID=unID+1
			ENDIF

			!!!HEIGHT
			HOTSPOT 0,0,ds,unID,hr,1 : unID=unID+1
			HOTSPOT 0,0,ds+hr,unID,hr,2 : unID=unID+1
			HOTSPOT 0,0,-1,unID,hr,3 : unID=unID+1

			HOTSPOT rb*sin(ab/2),rb-rb*cos(ab/2),ds+(lra/2)*sin(ani),unID,hr,1 : unID=unID+1
			HOTSPOT rb*sin(ab/2),rb-rb*cos(ab/2),ds+hr+(lra/2)*sin(ani),unID,hr,2 : unID=unID+1
			HOTSPOT rb*sin(ab/2),rb-rb*cos(ab/2),-1,unID,hr,3 : unID=unID+1

			HOTSPOT rb*sin(ab),rb-rb*cos(ab),ds+lra*sin(ani),unID,hr,1 : unID=unID+1
			HOTSPOT rb*sin(ab),rb-rb*cos(ab),ds+hr+lra*sin(ani),unID,hr,2 : unID=unID+1
			HOTSPOT rb*sin(ab),rb-rb*cos(ab),-1,unID,hr,3 : unID=unID+1

			!!!DISTANCE FROM FLOOR

			HOTSPOT rb*sin(ab/2),rb-rb*cos(ab/2),(lra/2)*sin(ani),unID,ds,1+128 : unID=unID+1
			HOTSPOT rb*sin(ab/2),rb-rb*cos(ab/2),ds+(lra/2)*sin(ani),unID,ds,2 : unID=unID+1
			HOTSPOT rb*sin(ab/2),rb-rb*cos(ab/2),-1,unID,ds,3 : unID=unID+1

			HOTSPOT 0,0,0,unID,ds,1+128 : unID=unID+1
			HOTSPOT 0,0,ds,unID,ds,2 : unID=unID+1
			HOTSPOT 0,0,-1,unID,ds,3 : unID=unID+1

			!!!FIX HOTSPOT AT FLOOR
			HOTSPOT 0,0,0, unID : unID=unID+1
			HOTSPOT rb*sin(ab),rb-rb*cos(ab),0+lra*sin(ani), unID : unID=unID+1
			HOTSPOT rb*sin(ab/2),rb-rb*cos(ab/2),0+(lra/2)*sin(ani), unID : unID=unID+1

			IF ptyp_m=2 THEN
				HOTSPOT rb*sin(ab),rb-rb*cos(ab),lra*sin(ani),unID,ds,1+128 : unID=unID+1
				HOTSPOT rb*sin(ab),rb-rb*cos(ab),ds+lra*sin(ani),unID,ds,2 : unID=unID+1
				HOTSPOT rb*sin(ab),rb-rb*cos(ab),-1,unID,ds,3 : unID=unID+1
			ENDIF

		ENDIF

	endif


endif

!!SIMPLE 3D END!!

end


!!SUBROUTINES!!
]]>
</Script_3D>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_2D SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[
call "railSymbol2D_m" parameters all	bEnable2DPosts		= 0,
										iHandRailStyle		= btyp_m,
										handRailDiameter	= bd,
										handRailWidth		= fth,
										bBreakRailLine		= 0,
										bPostNoCalculation	= 0

]]>
</Script_2D>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_1D SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[
! m_Rail Simple Bar

EPS=0.0001

!!PARAMETER INPUT CALCULATION!!


!SEGMENT CALCULATION
if ptyp_m<>1 then
	nalphaincl=int(ab/(360/res))+1 !number of segment points
	alphaincl=ab/nalphaincl  !angle between segment points
	deltaz=lra*sin(ani) !Vertical distance between start and endpoints
	deltazincl=deltaz/nalphaincl !vertical step between segment points
endif
]]>
</Script_1D>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_PR SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_PR>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_UI SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_UI>

<Comment SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Comment>

<Picture MIME="image/png" SectVersion="19" SectionFlags="0" SubIdent="0" length_in_bytes="973" platform="Win">
	<![CDATA[
	696D6167652F706E670089504E470D0A1A0A0000000D494844520000007F0000
	007F0803000000F163ED2100000093504C5445FFFFFFB29353B9A26BAE9152C4
	A35AB49D62C39C53BFA057D1B26BCCAA62AB8B4BC2944CB2904ED1AD65BDA974
	D4B472EAE2CDD1AA5DAE9A63F0F0EECCB063EDE9D9D8CEAEF0EEEAE9D8B4D1C2
	9DE5DBC5AD8E50D5B98AC1AD79B18D4BEEECE3E1D0A4DBD0B3DACEB1E2CCA3DA
	C48DCCBC94E4C59FDCD8CD75663DC9B98C867548856C3A958667C4B17B746641
	D1AE7BA89F8565605487000002EB49444154785EED996596A53908401F12FFFC
	B9974ACBC8FE5737A4AA7B76D0F0277703F7100E1092D51FA6D168341A8D46A3
	D168341AEBA79DA5FE343887272BFBFD1B422082AB897D7FC42500019462A17F
	42478128777399F5EDD31090E89C3BD1C7AD41E2030967E2C20775FB0E911612
	0297B7B5B6FEF18A62163B32FFB3D7B66F07440A39E7C08527F59A7B45D193D8
	43F00FFACDB6DA25F68EB9BBACF59B2D3A24C85DE06E54B76FBFB9C151860E92
	E749BFE600D19DE1D631FB9D7EE2078770BE0130F365AFDF6C111702B8F9C497
	493FF1802876F029A593FAD11FC50E24FE3EA5A795368FF82B788EF1A8DF6C51
	A8B1A77E1CD5EDF757A87A00CF693CA8277EE7BEECC0293E18DC6C011144CFDC
	BFDC0D9A2D622007EC7BFDC4AF5F51F4B040296C90F8C70107E7BE827FD09F73
	8313086AF02F7B9329EB0020791E0DA6ACC83FF5DE8F07F5A397295BA9F67E67
	70B31DC40FCE7B3F5F0C569A65589CE09D1F4F06158FE896B3C8FDAC9FF8C701
	280702D7FBFECD64A5010480247A83298B0B61C854ED87957ECD21216662E6A2
	5F73EFAEDA29C366338F06CD161642224831F5937EE297DA6E08C266333E6BDB
	F7BF5B7DC7717334D865DD67F4E0633499B20B3922F0BC910BCE5AFB11C3D102
	15EEE3834DC58BBCF3B3C14A335D11301074A5C471BF564FFC8210204329739C
	0C561AC04C002C76FD9BED61200CB9DACBFC6270AFC68099EA83F11CF76BFD29
	4B4839DF984B345869109044DFF15CF4133F2152A87AE6A2BF546CFF0A559F29
	6CBA59BFE68E88484208EC9FF52BBEDA7397094D5E8CAFA2FF7AAF2ED7C9E097
	069D04DF89DEE697065D97ABBD3C1BAC34CEB9337CDA4D9A2D7E5EEE20F146FF
	9746120F9562967891DF3C273E1ABE18A7FE62B0CB865FCF967DDF6F0D76D9DF
	B1C7F1C9E6C5180489FD59FDE84F88FF1FFDD160A5410184398E0653D6614002
	483ECA4AA3CEFB77841A3CFB281FF206FE8FBFBF03F832BF6D5716DCFFFDF8F8
	E1394E2B2BDE7FFEF8D3F7EA46A3D168341A8D46A3D168FC0714C92C61347962
	380000000049454E44AE426082
	]]>
</Picture>

<CalledMacros SectVersion="2" SectionFlags="0" SubIdent="0">
	<Macro>
		<MName><![CDATA["railSymbol2D_m"]]></MName>
		<MainGUID>C5C904E6-1706-4CD1-BC8D-6C294B5B40F7</MainGUID>
	</Macro>
</CalledMacros>

<Copyright SectVersion="1" SectionFlags="0" SubIdent="0">
	<Author>GRAPHISOFT</Author>
	<License>
		<Type>CC BY-ND</Type>
		<Version>3.0</Version>
	</License>
</Copyright>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_FWM SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_FWM>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_BWM SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_BWM>

<Keywords SectVersion="1" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Keywords>

</Symbol>
