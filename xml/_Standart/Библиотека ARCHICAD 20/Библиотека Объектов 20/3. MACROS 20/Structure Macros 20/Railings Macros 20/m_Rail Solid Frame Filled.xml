<?xml version="1.0" encoding="UTF-8"?>
<Symbol IsArchivable="true" IsPlaceable="false" MainGUID="15DF11F8-C219-48A7-987E-EBF299D4661E" MigrationValue="Normal" Owner="1196638531" Signature="1196644685" Version="43">
<Ancestry SectVersion="1" SectionFlags="0" SubIdent="0" Template="false">
	<MainGUID>F938E33A-329D-4A36-BE3E-85E126820996</MainGUID>
	<MainGUID>103E8D2C-8230-42E1-9597-46F84CCE28C0</MainGUID>
	<MainGUID>784EAEA1-5041-4AA6-B6F4-EF263A891EE7</MainGUID>
	<MainGUID>09BEB35E-7BF8-448C-B408-AC04D159B0D1</MainGUID>
</Ancestry>

<ParamSection SectVersion="22" SectionFlags="0" SubIdent="0">
	<ParamSectHeader>
		<AutoHotspots>false</AutoHotspots>
		<StatBits>
			<STBit_FixSize/>
		</StatBits>
		<WDLeftFrame>0</WDLeftFrame>
		<WDRightFrame>0</WDRightFrame>
		<WDTopFrame>0</WDTopFrame>
		<WDBotFrame>0</WDBotFrame>
		<LayFlags>65535</LayFlags>
		<WDMirrorThickness>0</WDMirrorThickness>
		<WDWallInset>0</WDWallInset>
	</ParamSectHeader>
	<Parameters>
		<Length Name="A">
			<Description><![CDATA["Dimension 1"]]></Description>
			<Fix/>
			<Value>1.5</Value>
		</Length>
		<Length Name="B">
			<Description><![CDATA["Dimension 2"]]></Description>
			<Fix/>
			<Value>0.05</Value>
		</Length>
		<Length Name="ZZYZX">
			<Description><![CDATA["Height"]]></Description>
			<Fix/>
			<Value>0.9</Value>
		</Length>
		<Integer Name="gs_detlevel_3D_m">
			<Description><![CDATA["3D"]]></Description>
			<Value>2</Value>
		</Integer>
		<Boolean Name="cfs">
			<Description><![CDATA["Called as Macro from Stair"]]></Description>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Boolean>

		<!-- RailBalust_sp0: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="RailBalust_sp0">
			<Description><![CDATA["General Dimensions"]]></Description>
		</Title>
		<Integer Name="ptyp_m">
			<Description><![CDATA["Rail and Parameter Input Type"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Integer>
		<Angle Name="ani">
			<Description><![CDATA["Inclination Angle"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</Angle>
		<Integer Name="rom_m">
			<Description><![CDATA["Rail Orientation Method"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Integer>
		<Integer Name="rmm_m">
			<Description><![CDATA["Rail Measurement Method"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Integer>
		<Length Name="lra">
			<Description><![CDATA["Horizontal Length of Railing"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1.5</Value>
		</Length>
		<Length Name="lrah">
			<Description><![CDATA["Length of Railing"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1.5</Value>
		</Length>
		<Length Name="hr">
			<Description><![CDATA["Height of Railing"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.75</Value>
		</Length>
		<Length Name="hrPerp">
			<Description><![CDATA["Height of Railing"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0.75</Value>
		</Length>
		<Angle Name="ab">
			<Description><![CDATA["Angle of Bending"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>90</Value>
		</Angle>
		<Length Name="rb">
			<Description><![CDATA["Radius of Bending"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Length>
		<Length Name="ds">
			<Description><![CDATA["Distance from Slab/Stair"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.15</Value>
		</Length>
		<Length Name="dsPerp">
			<Description><![CDATA["Distance from Slab/Stair"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0.15</Value>
		</Length>
		<Angle Name="gs_AngleL">
			<Description><![CDATA["Left End Cutting Angle"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>90</Value>
		</Angle>
		<Angle Name="gs_AngleR">
			<Description><![CDATA["Right End Cutting Angle"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>90</Value>
		</Angle>

		<!-- structural_dims: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="structural_dims">
			<Description><![CDATA["Structural Dimensions"]]></Description>
		</Title>
		<Integer Name="gs_frameStyle_m">
			<Description><![CDATA["Frame Style"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Integer>
		<Length Name="gs_frameDiameter">
			<Description><![CDATA["Frame Diameter"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.06</Value>
		</Length>
		<Length Name="fth">
			<Description><![CDATA["Frame Thickness"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.05</Value>
		</Length>
		<Length Name="fsw">
			<Description><![CDATA["Frame Width Side"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.1</Value>
		</Length>
		<Length Name="fswPerp">
			<Description><![CDATA["Frame Width Side"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0.1</Value>
		</Length>
		<Length Name="ftw">
			<Description><![CDATA["Frame Width Top"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.05</Value>
		</Length>
		<Length Name="ftwPerp">
			<Description><![CDATA["Frame Width Top"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0.05</Value>
		</Length>
		<Length Name="fbw">
			<Description><![CDATA["Frame Width Bottom"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.05</Value>
		</Length>
		<Length Name="fbwPerp">
			<Description><![CDATA["Frame Width Bottom"]]></Description>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0.05</Value>
		</Length>
		<Length Name="bth">
			<Description><![CDATA["Fill Thickness"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.025</Value>
		</Length>
		<Length Name="fdf">
			<Description><![CDATA["Fill Distance from Frame"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0.05</Value>
		</Length>

		<!-- gs_3D_representation: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="gs_3D_representation">
			<Description><![CDATA["3D Representation"]]></Description>
		</Title>
		<Integer Name="res">
			<Description><![CDATA["Rail Arc Resolution"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>32</Value>
		</Integer>
		<Integer Name="rescs">
			<Description><![CDATA["Cross Section Resolution"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>12</Value>
		</Integer>
		<Boolean Name="gs_shadow">
			<Description><![CDATA["Shadow"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Boolean>
		<Boolean Name="AC_show2DHotspotsIn3D">
			<Description><![CDATA["Show 2D Hotspots in 3D"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Boolean>
		<Length Name="ac_bottomlevel">
			<Description><![CDATA["Bottom Level"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>1</Value>
		</Length>
		<Length Name="ac_toplevel">
			<Description><![CDATA["Top Level"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value>0</Value>
		</Length>

		<!-- gs_2D_representation: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="gs_2D_representation">
			<Description><![CDATA["2D Representation"]]></Description>
			<Fix/>
		</Title>
		<PenColor Name="gs_cont_pen">
			<Description><![CDATA["Contour Pen"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>2</Value>
		</PenColor>
		<FillPattern Name="gs_fill_type">
			<Description><![CDATA["Fill Type"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>65</Value>
		</FillPattern>
		<PenColor Name="gs_fill_pen">
			<Description><![CDATA["Fill Pen"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>91</Value>
		</PenColor>
		<PenColor Name="gs_back_pen">
			<Description><![CDATA["Fill Background Pen"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>91</Value>
		</PenColor>
		<Boolean Name="sa">
			<Description><![CDATA["Show Axis"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>1</Value>
		</Boolean>
		<LineType Name="al">
			<Description><![CDATA["Axis Line Type"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>6</Value>
		</LineType>
		<PenColor Name="gs_RailAxisPen">
			<Description><![CDATA["Axis Line Pen"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>16</Value>
		</PenColor>

		<!-- RailBalust_sp2: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="RailBalust_sp2">
			<Description><![CDATA["Surfaces"]]></Description>
		</Title>
		<Material Name="fmat">
			<Description><![CDATA["Frame"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>15</Value>
		</Material>
		<Material Name="bmat">
			<Description><![CDATA["Fill"]]></Description>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>24</Value>
		</Material>

		<!-- gs_list: PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK ===== PARAMETER BLOCK -->

		<Title Name="gs_list">
			<Description><![CDATA["Parameters for Listing"]]></Description>
			<Fix/>
		</Title>
		<RealNum Name="gs_list_cost">
			<Description><![CDATA["Cost"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</RealNum>
		<String Name="gs_list_manufacturer">
			<Description><![CDATA["Manufacturer"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="gs_list_note">
			<Description><![CDATA["Note/Remarks"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="gs_list_location">
			<Description><![CDATA["Location"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="gs_list_accessories">
			<Description><![CDATA["Accessories"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="FM_Type">
			<Description><![CDATA["Group Type"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA["Другой"]]></Value>
		</String>
		<Integer Name="iFMType">
			<Description><![CDATA["Group Type"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
				<ParFlg_Hidden/>
			</Flags>
			<Value>25</Value>
		</Integer>
		<String Name="FM_InventoryNumber">
			<Description><![CDATA["Inventory No."]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="FM_SerialNumber">
			<Description><![CDATA["Serial No."]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="FM_ProductionYear">
			<Description><![CDATA["Production Year"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<RealNum Name="FM_ObjectWeight">
			<Description><![CDATA["Object Weight"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value>0</Value>
		</RealNum>
		<String Name="FM_ObjectWeightUnit">
			<Description><![CDATA["Object Weight Unit"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA["кг"]]></Value>
		</String>
		<String Name="gs_list_custom1">
			<Description><![CDATA["User Defined 1"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="gs_list_custom2">
			<Description><![CDATA["User Defined 2"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="gs_list_custom3">
			<Description><![CDATA["User Defined 3"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="gs_list_custom4">
			<Description><![CDATA["User Defined 4"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
		<String Name="gs_list_custom5">
			<Description><![CDATA["User Defined 5"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Child/>
			</Flags>
			<Value><![CDATA[""]]></Value>
		</String>
	</Parameters>
</ParamSection>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_VL SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[
! GENERAL PARAMETERS
values "gs_detlevel_3D_m" 2,1,0		! Detailed, Simple, Off


! GENERAL RAIL GEOMETRY PARAMETERS
values "ptyp_m" 1,2,3				! Straight, Curve Length and Radius, Angle and Radius


IF ptyp_m<>1 OR ABS(ani)<EPS  THEN
	VALUES "rom_m" 1
	VALUES "rmm_m" 1
	HIDEPARAMETER "lrah"
ELSE
	VALUES "rom_m"  1,2
	IF rom_m=2 then
		VALUES "rmm_m" 2
	ELSE
		VALUES "rmm_m" 1,2
	ENDIF
ENDIF


VALUES "a" lra
VALUES "zzyzx" ds+hr

IF ptyp_m<>1 then
	VALUES "b" fth
	lock "a","b","zzyzx"
ELSE
	IF GLOB_MODPAR_NAME = "B" THEN PARAMETERS fth=B
	IF GLOB_MODPAR_NAME = "fth" THEN PARAMETERS B=fth
	lock "a","zzyzx"
ENDIF

IF ptyp_m<>1 OR rom_m<>1 THEN
	LOCK "gs_AngleL"
	LOCK "gs_AngleR"
ENDIF

if gs_cont_pen=0 then parameters gs_cont_pen=2
if gs_fill_pen=0 then parameters gs_fill_pen=91

VALUES "lra" range(2*fsw,)
VALUES "lrah" range(2*fsw,)
VALUES "hr" range(ftw+fbw+2*fdf+0.01,)
VALUES "B" range(0,)
VALUES "ani" range(-90, 0), range (0, 90)
VALUES "fth" range(0,)
VALUES "fsw" range(0,lra/2-fdf-0.01]
VALUES "fswPerp" range(0,(lra/2-fdf-0.01)/cos(ani)]
VALUES "ftw" range(0,hr-fbw-2*fdf-0.02]
VALUES "ftwPerp" range(0,(hr-fbw-2*fdf-0.02)/cos(ani)]
VALUES "fbw" range(0,hr-ftw-2*fdf-0.02]
VALUES "fbwPerp" range(0,(hr-ftw-2*fdf-0.02)/cos(ani)]
VALUES "bth" range(0,)
VALUES "gs_AngleL" 	range(0,180)
VALUES "gs_AngleR" 	range(0,180)
VALUES "res" range[3,)
VALUES "rescs" RANGE[3,)

if gs_frameStyle_m = 1 then
	lock			"rescs"
	hideparameter	"rescs"
endif

fdfMinValue=MIN(lra/2-fsw-0.01,(hr-ftw-fbw)/2-0.01)
VALUES "fdf" range[0,fdfMinValue]

IF ABS(ani)<EPS THEN
	VALUES "ab" RANGE ((2*fsw*180)/(rb*pi),360]
	LOCK "rom_m","rmm_m"
ELSE
	VALUES "ab" RANGE ((2*fsw*180)/(rb*pi),)
ENDIF

! Distance from Slab/Stair
if GLOB_MODPAR_NAME = "dsPerp" then
	ds = dsPerp * cos(ani)
	parameters ds = ds
else
	dsPerp = ds / cos(ani)
	parameters dsPerp = dsPerp
endif

! Height of Railing
if GLOB_MODPAR_NAME = "hrPerp" then
	hr = hrPerp * cos(ani)
	parameters hr = hr
else
	hrPerp = hr / cos(ani)
	parameters hrPerp = hrPerp
endif

! Frame Width Bottom
if GLOB_MODPAR_NAME = "fbwPerp" then
	fbw = fbwPerp * cos(ani)
	parameters fbw = fbw
else
	fbwPerp = fbw / cos(ani)
	parameters fbwPerp = fbwPerp
endif

! Frame Width Top
if GLOB_MODPAR_NAME = "ftwPerp" then
	ftw = ftwPerp * cos(ani)
	parameters ftw = ftw
else
	ftwPerp = ftw / cos(ani)
	parameters ftwPerp = ftwPerp
endif

! Frame Width Side
if GLOB_MODPAR_NAME = "fswPerp" then
	fsw = fswPerp * cos(ani)
	parameters fsw = fsw
else
	fswPerp = fsw / cos(ani)
	parameters fswPerp = fswPerp
endif
]]>
</Script_VL>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_3D SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[
if gs_detlevel_3D_m=0 then end
if not(gs_shadow) then SHADOW OFF

IF ABS(lra)<EPS THEN END

pen gs_cont_pen
unID=1

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! *** SIMPLE 3D *** !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

!!!CALCULATION FOR CONNECTING ANGLE

XPosL0=(fth/2)/tan(gs_AngleL)
XPosR0=(fth/2)/tan(gs_AngleR)

if gs_frameStyle_m = 2 then
	if abs (gs_AngleL - 90) > EPS then
		XPosL = gs_frameDiameter / 2
	else
		XPosL = 0
	endif
	if abs (gs_AngleR - 90) > EPS then
		XPosR = gs_frameDiameter / 2
	else
		XPosR = 0
	endif
else
XPosL=ABS((fth/2)/tan(gs_AngleL))
XPosR=ABS((fth/2)/tan(gs_AngleR))
endif

YPosL=(XPosL*tan(ani))
YPosR=(XPosR*tan(ani))

IF gs_detlevel_3D_m=1 THEN		!!Simple

	resol res

	MATERIAL fmat

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! *** STRAIGHT *** !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

	IF ABS(ani)<EPS and ptyp_m=1 THEN		!!ptyp=Straight

		ADDz ds

			PRISM_ 5,hr,
				XPosL0,fth/2,15,
				-XPosL0,-fth/2,15,
				lra+XPosR0,-fth/2,15,
				lra-XPosR0,fth/2,15,
				XPosL0,fth/2,-1

		DEL 1
	ENDIF

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! *** STRAIGHT CURVED *** !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

	IF ABS(ani)<EPS and ptyp_m<>1 THEN

		!FRAME
		IF ab<360 THEN
				ADDz ds
				PRISM_ 10,hr,
					0,fth/2,15,
					0,-fth/2+0.00005,15,
					0,-fth/2,79,
					1,0,800,
					(rb+(fth/2))*sin(ab),rb-(rb+(fth/2))*cos(ab),1015,
					(rb-(fth/2)+0.00005)*sin(ab),rb-(rb-(fth/2)+0.00005)*cos(ab),15,
					(rb-(fth/2))*sin(ab),rb-(rb-(fth/2))*cos(ab),79,
					-cos(ab),-sin(ab),800,
					0,fth/2,1015,
					0,fth/2,-1

				DEL 1

		ELSE	!!!ANGLE=360

			ADDz ds

				PRISM_ 12,hr,
					0,-fth/2,79,
					1,0,800,
					0,2*rb+fth/2,1079,
					-1,0,800,
					0,-fth/2,1079,
					0,-fth/2,-1,

					0,fth/2,79,
					1,0,800,
					0,2*rb-fth/2,1079,
					-1,0,800,
					0,fth/2,1079,
					0,fth/2,-1

			DEL 1

		ENDIF
	ENDIF

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! *** STRAIGHT INCLINED *** !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

	IF ABS(ani)>EPS and ptyp_m=1 THEN	!ptyp=Straight
		IF rom_m=1 THEN					!Vertical Orientation

				IF rmm_m=1 THEN			!Vertical Measurement
					temp_ds=ds
					temp_hr=hr
				ELSE					!Perpendicular Measurement
					temp_ds=dsPerp
					temp_hr=hrPerp
				ENDIF

				ROTz -90+gs_AngleL		! CONNECTING ANGLE
				ROTy -90
					CUTPLANE
				DEL 2

				ADDx lra
				ROTz 90-gs_AngleR
				ROTy 90
					CUTPLANE
				DEL 3


					ROTx 90
					ADDz -fth/2

						PRISM_ 5,fth,
							-XPosL,temp_ds-YPosL,15,
							lra+XPosR,temp_ds+lra*tan(ani)+YPosR,15,
							lra+XPosR,temp_ds+temp_hr+lra*tan(ani)+YPosR,15,
							-XPosL,temp_ds+temp_hr-YPosL,15,
							-XPosL,temp_ds-YPosL,-1

					DEL 2

				CUTEND
				CUTEND

		ELSE						!Perpendicular Orientation
									!Measurement is always perpendicular to inclination in this case

			ROTy -ani

				ROTx 90
				ADDz -fth/2
				!FRAME
				MATERIAL fmat
				PRISM_ 5,fth,
					0,ds,15,
					lrah,ds,15,
					lrah,ds+hr,15,
					0,ds+hr,15,
					0,ds,-1
				DEL 2

			DEL 1

		ENDIF
	ENDIF


!!!!!!!!!!!!!!!!!!!!!!!!!!!! *** INCLINED AND CURVED *** !!!!!!!!!!!!!!!!!!!!!!!!!!!!

	IF ABS(ani)>EPS and ptyp_m<>1 THEN

		!FRAME
		MATERIAL fmat

		alphai=-alphaincl
		DELtazi=-DELtazincl
		for i=1 to nalphaincl+3
			put rb*sin(alphai),rb-rb*cos(alphai),ds+DELtazi
			alphai=alphai+alphaincl
			DELtazi=DELtazi+DELtazincl
		next i

		TUBEA 5,nalphaincl+3,1+2+16+32,
				-fth/2,0,0,
				fth/2,0,0,
				fth/2,hr,0,
				-fth/2,hr,0,
				-fth/2,0,-1,
				get (nsp)

	ENDIF
ENDIF		!!END of SIMPLE 3D!!


!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! *** DETAILED 3D *** !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

if gs_detlevel_3D_m=2 then

	if cfs then resol res else resol rescs

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! *** STRAIGHT *** !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

	if ABS(ani)<EPS and ptyp_m=1 then			!ptyp=Straight

		!3D FEEDBACK AT HOTSPOT EDITING
		IF GLOB_CONTEXT>20 and GLOB_CONTEXT<40 THEN

				ADDz ds
				MATERIAL fmat
				PRISM_ 5,hr,
					XPosL0,fth/2,15,
					-XPosL0,-fth/2,15,
					lra+XPosR0,-fth/2,15,
					lra-XPosR0,fth/2,15,
					XPosL0,fth/2,-1
				DEL 1

		ELSE	! 3D DETAILED MODEL

			MATERIAL fmat

			ROTz -90+gs_AngleL		!! CONNECTING ANGLE
			ROTy -90
				CUTPLANE
			DEL 2

			ADDx lra
			ROTz 90-gs_AngleR
			ROTy 90
				CUTPLANE
			DEL 3

				rotx 90
			! FRAME

			if gs_frameStyle_m = 2 then
				tube 2, 7, 1+2,
					0, 0, 900,
					gs_frameDiameter/2, 360, 4001,

					-XPosL + gs_frameDiameter/2,		ds + hr - gs_frameDiameter/2,	0, 0,
					-XPosL + gs_frameDiameter/2,		ds + gs_frameDiameter/2,		0, 0,
					lra + XPosR - gs_frameDiameter/2,	ds + gs_frameDiameter/2,		0, 0,
					lra + XPosR - gs_frameDiameter/2,	ds + hr - gs_frameDiameter/2,	0, 0,
					-XPosL + gs_frameDiameter/2,		ds + hr - gs_frameDiameter/2,	0, 0,
					-XPosL + gs_frameDiameter/2,		ds + gs_frameDiameter/2,		0, 0,
					lra + XPosR - gs_frameDiameter/2,	ds + gs_frameDiameter/2,		0, 0
			else
				addz -fth/2
				MATERIAL fmat
				prism_ 10,fth,
						-XPosL,ds,15,
						lra+XPosR,ds,15,
						lra+XPosR,ds+hr,15,
						-XPosL,ds+hr,15,
						-XPosL,ds,-1,
						fsw,ds+fbw,15,
						lra-fsw,ds+fbw,15,
						lra-fsw,ds+hr-ftw,15,
						fsw,ds+hr-ftw,15,
						fsw,ds+fbw,-1

				BODY -1
				del 1
			endif
			del 1

			CUTEND
			CUTEND

			MATERIAL bmat

			ROTz -90+gs_AngleL		!! CONNECTING ANGLE
			ROTy -90
				CUTPLANE
			DEL 2

			ADDx lra
			ROTz 90-gs_AngleR
			ROTy 90
				CUTPLANE
			DEL 3

				rotx 90
				addz -fth/2

					!!! *** FILL
					MATERIAL bmat
					add fsw+fdf,ds+fbw+fdf,(fth-bth)/2
					block fillw,fillh,bth
					del 1
				del 2

			CUTEND
			CUTEND
		ENDIF
	ENDIF


!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! *** STRAIGHT CURVED *** !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

	if ABS(ani)<EPS and ptyp_m<>1 then		!ptyp=Straight

		!!3D FEEDBACK AT HOTSPOT EDITING
		IF GLOB_CONTEXT>20 and GLOB_CONTEXT<40 THEN

			resol res

			!!!!FRAME
			MATERIAL fmat

				IF ab<360 THEN
						ADDz ds
						PRISM_ 10,hr,
							0,fth/2,15,
							0,-fth/2+0.00005,15,
							0,-fth/2,79,
							1,0,800,
							(rb+(fth/2))*sin(ab),rb-(rb+(fth/2))*cos(ab),1015,
							(rb-(fth/2)+0.00005)*sin(ab),rb-(rb-(fth/2)+0.00005)*cos(ab),15,
							(rb-(fth/2))*sin(ab),rb-(rb-(fth/2))*cos(ab),79,
							-cos(ab),-sin(ab),800,
							0,fth/2,1015,
							0,fth/2,-1
						DEL 1

				ELSE	!!!ANGLE=360

					ADDz ds
					PRISM_ 12,hr,
							0,-fth/2,79,
							1,0,800,
							0,2*rb+fth/2,1079,
							-1,0,800,
							0,-fth/2,1079,
							0,-fth/2,-1,

							0,fth/2,79,
							1,0,800,
							0,2*rb-fth/2,1079,
							-1,0,800,
							0,fth/2,1079,
							0,fth/2,-1
					DEL 1

				ENDIF

		ELSE

			!FRAME
			material fmat

			if ab<360 then

				if gs_frameStyle_m = 2 then		! Rounded Frame

					startAngle = asn ((gs_frameDiameter/2) / rb)
					add 0, rb, ds + gs_frameDiameter/2
					betaincl = (ab - 2 * startAngle) / nalphaincl

					actAngle = startAngle
					put rb * sin (actAngle), -rb * cos (actAngle), hr - gs_frameDiameter, 0

					for i = 1 to nalphaincl + 1
						put rb * sin (actAngle), -rb * cos (actAngle), 0, 0
						actAngle = actAngle + betaincl
					next i
					actAngle = actAngle - betaincl

					for i = 1 to nalphaincl + 1
						put rb * sin (actAngle), -rb * cos (actAngle), hr - gs_frameDiameter, 0
						actAngle = actAngle - betaincl
					next i
					actAngle = actAngle + betaincl

					for i = 1 to 2
						put rb * sin (actAngle), -rb * cos (actAngle), 0, 0
						actAngle = actAngle + betaincl
					next i

					tube 2, nsp/4, 1+2,
						0, 0, 900,
						gs_frameDiameter/2, 360, 4000,
						get (nsp)

					del 1
				else
					resol res

					temp_rb=((rb-fth/2)*pi*ab)/180

					ADDz ds
					ADDy fth/2
					ROTx 90
					BPRISM_ fmat,fmat,fmat,
						10, fth, rb-fth/2,
						0,0,15,
						temp_rb,0,15,
						temp_rb,hr,15,
						0,hr,15,
						0,0,-1,
						fsw, fbw,15,
						temp_rb-fsw,fbw,15,
						temp_rb-fsw,hr-ftw,15,
						fsw, hr-ftw,15,
						fsw, fbw,-1
					DEL 3
				endif

					resol res

					!FILL
					material bmat
					add 0,rb,ds+fbw+fdf
					rotz alphafills-90

						prism_ 10,fillh,
							rb-bth/2,0,15,
							rb+bth/2-0.00005,0,15,
							rb+bth/2,0,79,
							0,1,800,
							(rb+bth/2)*cos(alphafillm),(rb+bth/2)*sin(alphafillm),1015,
							(rb-bth/2+0.00005)*cos(alphafillm),(rb-bth/2+0.00005)*sin(alphafillm),15,
							(rb-bth/2)*cos(alphafillm),(rb-bth/2)*sin(alphafillm),79,
							sin(alphafillm),-cos(alphafillm),800,
							rb-bth/2,0,1015,
							rb-bth/2,0,-1

					del 2

			ELSE	!!! ANGLE=360
				if gs_frameStyle_m = 2 then		! Rounded Frame

					addz ds + gs_frameDiameter/2
					alphai = -alphaincl
					for i = 1 to nalphaincl+3
						put rb*sin(alphai), rb-rb*cos(alphai), 0
						alphai = alphai + alphaincl
					next i

					tubea 2, nsp/3, 1+2,
						0, 0, 900,
						gs_frameDiameter/2, 360, 4001,
						use (nsp)

					addz hr - gs_frameDiameter

					tubea 2, nsp/3, 1+2,
						0, 0, 900,
						gs_frameDiameter/2, 360, 4001,
						get (nsp)

					del 2

				else
					resol res

					addz ds
						prism_ 12,fbw,
							0,-fth/2,79,
							1,0,800,
							0,2*rb+fth/2,1079,
							-1,0,800,
							0,-fth/2,1079,
							0,-fth/2,-1,

							0,fth/2,79,
							1,0,800,
							0,2*rb-fth/2,1079,
							-1,0,800,
							0,fth/2,1079,
							0,fth/2,-1

					addz hr-ftw
						prism_ 12,ftw,
							0,-fth/2,79,
							1,0,800,
							0,2*rb+fth/2,1079,
							-1,0,800,
							0,-fth/2,1079,
							0,-fth/2,-1,

							0,fth/2,79,
							1,0,800,
							0,2*rb-fth/2,1079,
							-1,0,800,
							0,fth/2,1079,
							0,fth/2,-1
					del 2
				endif
					resol res

					!FILL
					material bmat
					addz ds+fbw+fdf
						prism_ 12,fillh,
							0,-bth/2,79,
							1,0,800,
							0,2*rb+bth/2,1079,
							-1,0,800,
							0,-bth/2,1079,
							0,-bth/2,-1,

							0,bth/2,79,
							1,0,800,
							0,2*rb-bth/2,1079,
							-1,0,800,
							0,bth/2,1079,
							0,bth/2,-1
					del 1
			endif
		endif
	endif


!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! *** STRAIGHT INCLINED *** !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!


	if ABS(ani)>EPS and ptyp_m=1 then				!ptyp=Straight
		if rom_m=1 then						!Vertical Orientation
			if rmm_m=2 then					!Perpendicular Measurement Extra Values
				ftw=ftw/cos(ani)
				fbw=fbw/cos(ani)
				fdf=fdf/cos(ani)
				fillh=fillh/cos(ani)
			endif

			IF rmm_m=1 THEN			!!Vertical Measurement
				temp_ds=ds
				temp_hr=hr
			ELSE					!!Perpendicular Measurement
				temp_ds=dsPerp
				temp_hr=hrPerp
			ENDIF


			MATERIAL fmat

			ROTz -90+gs_AngleL		!!! CONNECTING ANGLE
			ROTy -90
				CUTPLANE
			DEL 2

			ADDx lra
			ROTz 90-gs_AngleR
			ROTy 90
				CUTPLANE
			DEL 3

			!!3D FEEDBACK AT HOTSPOT EDITING
			IF GLOB_CONTEXT>20 and GLOB_CONTEXT<40 THEN

					ROTx 90
					ADDz -fth/2
						!FRAME
						MATERIAL fmat
						PRISM_ 5,fth,
							-XPosL,temp_ds-YPosL,15,
							lra+XPosR,temp_ds+lra*tan(ani)+YPosR,15,
							lra+XPosR,temp_ds+temp_hr+lra*tan(ani)+YPosR,15,
							-XPosL,temp_ds+temp_hr-YPosL,15,
							-XPosL,temp_ds-YPosL,-1

					DEL 2

			ELSE	! 3D DETAILED MODEL

				MATERIAL fmat
				rotx 90
				if gs_frameStyle_m = 2 then		! Rounded Frame

					length			= lra + XPosR + XPosL - gs_frameDiameter
					bottomHeight	= temp_ds
					topHeight		= temp_ds + temp_hr
					yCorrBottom 	= (gs_frameDiameter/2) / cos(ani) + (gs_frameDiameter/2) * tan(ani)
					yCorrTop		= (gs_frameDiameter/2) / cos(ani) - (gs_frameDiameter/2) * tan(ani)

					tube 2, 7, 1+2,
						0, 0, 900,
						gs_frameDiameter/2, 360, 4000,

						-XPosL + gs_frameDiameter/2,		-YPosL + topHeight - yCorrTop,								0, 0,
						-XPosL + gs_frameDiameter/2,		-YPosL + bottomHeight + yCorrBottom,						0, 0,
						 lra + XPosR - gs_frameDiameter/2,	-YPosL + bottomHeight + yCorrBottom + length * tan(ani),	0, 0,
						 lra + XPosR - gs_frameDiameter/2,	-YPosL + topHeight - yCorrTop + length * tan(ani),			0, 0,
						-XPosL + gs_frameDiameter/2,		-YPosL + topHeight - yCorrTop,								0, 0,
						-XPosL + gs_frameDiameter/2,		-YPosL + bottomHeight + yCorrBottom,						0, 0,
						 lra + XPosR - gs_frameDiameter/2,	-YPosL + bottomHeight + yCorrBottom + length * tan(ani),	0, 0

				else
				addz -fth/2
				!FRAME
				PRISM_ 10,fth,
						-XPosL,temp_ds-YPosL,15,
						lra+XPosR,temp_ds+lra*tan(ani)+YPosR,15,
						lra+XPosR,temp_ds+temp_hr+lra*tan(ani)+YPosR,15,
						-XPosL,temp_ds+temp_hr-YPosL,15,
						-XPosL,temp_ds-YPosL,-1,

						fsw,temp_ds+fbw+fsw*tan(ani),15,
						lra-fsw,temp_ds+fbw+(lra-fsw)*tan(ani),15,
						lra-fsw,temp_ds+temp_hr-ftw+(lra-fsw)*tan(ani),15,
						fsw,temp_ds+temp_hr-ftw+fsw*tan(ani),15,
						fsw,temp_ds+fbw+fsw*tan(ani),-1
				BODY -1
					del 1
				endif

				del 1

			CUTEND
			CUTEND


			MATERIAL bmat

			ROTz -90+gs_AngleL		!!! CONNECTING ANGLE
			ROTy -90
				CUTPLANE
			DEL 2

			ADDx lra
			ROTz 90-gs_AngleR
			ROTy 90
				CUTPLANE
			DEL 3


				!!3D FEEDBACK AT HOTSPOT EDITING
				IF GLOB_CONTEXT>20 and GLOB_CONTEXT<40 THEN

				ELSE	!!! 3D DETAILED MODEL

					rotx 90
					addz -fth/2

						!FILL
						material bmat
						add fsw+fdf,temp_ds+fbw+fdf+(fsw+fdf)*tan(ani),(fth-bth)/2
							prism_ 5,bth,
							0,0,15,
							fillw,fillw*tan(ani),15,
							fillw,fillw*tan(ani)+fillh,15,
							0,fillh,15,
							0,0,-1
						del 1
					del 2
				ENDIF
			endif

			CUTEND
			CUTEND

	ELSE						!Perpendicular Orientation
								!Measurement is always perpendicular to inclination in this case
		roty -ani

			!!3D FEEDBACK AT HOTSPOT EDITING
			IF GLOB_CONTEXT>20 and GLOB_CONTEXT<40 THEN

				ROTx 90
				ADDz -fth/2
					!!FRAME
					MATERIAL fmat
					PRISM_ 5,fth,
						0,ds,15,
						lrah,ds,15,
						lrah,ds+hr,15,
						0,ds+hr,15,
						0,ds,-1
				DEL 2

			ELSE		!! 3D DETAILED MODEL

				rotx 90

					material fmat
				if gs_frameStyle_m = 2 then		! Rounded Frame
					tube 2, 7, 1+2,
						0, 0, 900,
						gs_frameDiameter/2, 360, 4000,

						gs_frameDiameter/2,			ds + hr - gs_frameDiameter/2,	0, 0,
						gs_frameDiameter/2,			ds + gs_frameDiameter/2,		0, 0,
						lrah - gs_frameDiameter/2,	ds + gs_frameDiameter/2,		0, 0,
						lrah - gs_frameDiameter/2,	ds + hr - gs_frameDiameter/2,	0, 0,
						gs_frameDiameter/2,			ds + hr - gs_frameDiameter/2,	0, 0,
						gs_frameDiameter/2,			ds + gs_frameDiameter/2,		0, 0,
						lrah - gs_frameDiameter/2,	ds + gs_frameDiameter/2,		0, 0

					addz -fth/2
				else
				addz -fth/2
					prism_ 10,fth,
						0,ds,15,
						lrah,ds,15,
						lrah,ds+hr,15,
						0,ds+hr,15,
						0,ds,-1,

						fsw,ds+fbw,15,
						lrah-fsw,ds+fbw,15,
						lrah-fsw,ds+hr-ftw,15,
						fsw,ds+hr-ftw,15,
						fsw,ds+fbw,-1
					BODY -1

				endif

					!FILL
					material bmat
					add fsw+fdf,ds+fbw+fdf,(fth-bth)/2
					block fillw,fillh,bth
				del 3

			endif
		del 1
	endif
endif


!!!!!!!!!!!!!!!!!!!!!!!!!!!! *** INCLINED AND CURVED *** !!!!!!!!!!!!!!!!!!!!!!!!!!!!


if ABS(ani)>EPS and ptyp_m<>1 then		!ptyp=Straight

		!FRAME
		material fmat

		!!3D FEEDBACK AT HOTSPOT EDITING
		IF GLOB_CONTEXT>20 and GLOB_CONTEXT<40 THEN

			!FRAME
			alphai=-alphaincl
			deltazi=-deltazincl
			for i=1 to nalphaincl+3 step 1
			put rb*sin(alphai),rb-rb*cos(alphai),ds+deltazi
			alphai=alphai+alphaincl
			deltazi=deltazi+deltazincl
			NEXT i

			TUBEA 5,nalphaincl+3,1+2+16+32,
				-fth/2,0,0,
				fth/2,0,0,
				fth/2,hr,0,
				-fth/2,hr,0,
				-fth/2,0,-1,
				get (nsp)

		ELSE
			if gs_frameStyle_m = 2 then		! Rounded Frame

				startAngle = asn ((gs_frameDiameter/2) / rb)
				betaincl = (ab - 2 * startAngle) / nalphaincl
				startZ = (gs_frameDiameter/2) * sin(ani)
				dZ = betaincl / ab * deltaz		!!! / nalphaincl

				add 0, rb, ds + gs_frameDiameter/2

				actAngle = startAngle
				actZ = startZ
				put rb * sin (actAngle), -rb * cos (actAngle), actZ + hr - gs_frameDiameter, 0

				for i = 1 to nalphaincl + 1
					put rb * sin (actAngle), -rb * cos (actAngle), actZ, 0
					actAngle = actAngle + betaincl
					actZ = actZ + dZ
				next i
				actAngle = actAngle - betaincl
				actZ = actZ - dZ

				for i = 1 to nalphaincl + 1
					put rb * sin (actAngle), -rb * cos (actAngle), actZ + hr - gs_frameDiameter, 0
					actAngle = actAngle - betaincl
					actZ = actZ - dZ
				next i
				actAngle = actAngle + betaincl
				actZ = actZ + dZ

				for i = 1 to 2
					put rb * sin (actAngle), -rb * cos (actAngle), actZ, 0
					actAngle = actAngle + betaincl
					actZ = actZ + dZ
				next i

				tube 2, nsp/4, 1+2,
					0, 0, 900,
					gs_frameDiameter/2, 360, 4000,
					get (nsp)

				del 1
			else
			alphai=-alphaincl
				deltazi=-deltazincl
			for i=1 to nalphaincl+3 step 1
					put rb*sin(alphai),rb-rb*cos(alphai),ds+deltazi
			alphai=alphai+alphaincl
					deltazi=deltazi+deltazincl
			next i

			group "ciframe"
					tubea 5,nalphaincl+3,1+2+16+32,
				-fth/2,0,0,
				fth/2,0,0,
				fth/2,hr,0,
				-fth/2,hr,0,
				-fth/2,0,-1,
				get (nsp)
			endgroup

			alphai=m*alphaincl
			DELtazi=m*DELtazincl
			for i=1 to (nalphaincl-2*m) step 1
			put rb*sin(alphai),rb-rb*cos(alphai),ds+DELtazi
			alphai=alphai+alphaincl
			DELtazi=DELtazi+DELtazincl
			next i

			group "cifill"
					tubea 5,nalphaincl-2*m+4,1+2+16+32,
				-2*fth,fbw,0,
				 fth,fbw,0,
				 fth,hr-ftw,0,
				-2*fth,hr-ftw,0,
				-2*fth,fbw,-1,

				rb*sin((m-1)*alphaincl),rb-rb*cos((m-1)*alphaincl),ds+(m-1)*DELtazincl,
				rb*sin(alphafsw),rb-rb*cos(alphafsw),ds+fsw*sin(ani),
				get (nsp),
				rb*sin(ab-alphafsw),rb-rb*cos(ab-alphafsw),ds+(lra-fsw)*sin(ani),
				rb*sin(ab-(m-1)*alphaincl),rb-rb*cos(ab-(m-1)*alphaincl),ds+DELtaz-(m-1)*DELtazincl
			endgroup

			placegroup subgroup("ciframe","cifill")

			killgroup "ciframe"
			killgroup "cifill"
			endif


			!FILL
			material bmat

			alphai=mm*alphaincl
			deltazi=mm*deltazincl
			for i=1 to (nalphaincl-2*mm) step 1
			put rb*sin(alphai),rb-rb*cos(alphai),ds+deltazi
			alphai=alphai+alphaincl
			deltazi=deltazi+deltazincl
			next i

			TUBEA 5,nalphaincl-2*mm+4,1+2+16+32,
				-bth/2,fbw+fdf,0,
				 bth/2,fbw+fdf,0,
				 bth/2,hr-ftw-fdf,0,
				-bth/2,hr-ftw-fdf,0,
				-bth/2,fbw+fdf,-1,

			rb*sin((mm-1)*alphaincl),rb-rb*cos((mm-1)*alphaincl),ds+(mm-1)*deltazincl,
			rb*sin(alphafills),rb-rb*cos(alphafills),ds+(fsw+fdf)*sin(ani),
			get (nsp),
			rb*sin(ab-alphafills),rb-rb*cos(ab-alphafills),ds+(lra-fsw-fdf)*sin(ani),
			rb*sin(ab-(mm-1)*alphaincl),rb-rb*cos(ab-(mm-1)*alphaincl),ds+deltaz-(mm-1)*deltazincl

		endif
	endif
endif


!!DETAILED 3D END!!

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! ** HOTSPOTS ** !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

	!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! *** STRAIGHT *** !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

	IF cfs=0 THEN
			IF ABS(ani)<EPS and ptyp_m=1 THEN

					!!!LENGHT
					HOTSPOT 0,0,0,unID,lra,1+256 : unID=unID+1
					HOTSPOT lra,0,0,unID,lra,2 : unID=unID+1
					HOTSPOT -1,0,0,unID,lra,3 : unID=unID+1

					HOTSPOT 0,0,ds,unID,lra,1+256 : unID=unID+1
					HOTSPOT lra,0,ds,unID,lra,2 : unID=unID+1
					HOTSPOT -1,0,ds,unID,lra,3 : unID=unID+1

					HOTSPOT 0,0,ds+hr,unID,lra,1+256 : unID=unID+1
					HOTSPOT lra,0,ds+hr,unID,lra,2 : unID=unID+1
					HOTSPOT -1,0,ds+hr,unID,lra,3 : unID=unID+1

					!!!DISTANCE FROM FLOOR
					HOTSPOT lra/2,0,0,unID,ds,1+128 : unID=unID+1
					HOTSPOT lra/2,0,ds,unID,ds,2 : unID=unID+1
					HOTSPOT lra/2,0,-1,unID,ds,3 : unID=unID+1

					!!!HEIGHT OF RAILING
					HOTSPOT lra/2,0,ds,unID,hr,1 : unID=unID+1
					HOTSPOT lra/2,0,ds+hr,unID,hr,2 : unID=unID+1
					HOTSPOT lra/2,0,-1,unID,hr,3 : unID=unID+1


		IF gs_detlevel_3D_m = 2 and gs_frameStyle_m < 2 THEN

						!!!Frame Width Bottom
						HOTSPOT lra/2,0,ds,unID,fbw,1+128 : unID=unID+1
						HOTSPOT lra/2,0,ds+fbw,unID,fbw,2 : unID=unID+1
						HOTSPOT lra/2,0,ds-1,unID,fbw,3 : unID=unID+1

						!!!Frame Width Top
						HOTSPOT lra/2,0,ds+hr,unID,ftw,1+128 : unID=unID+1
						HOTSPOT lra/2,0,ds+hr-ftw,unID,ftw,2 : unID=unID+1
						HOTSPOT lra/2,0,ds+hr+1,unID,ftw,3 : unID=unID+1

						!!!Frame Width Side
						HOTSPOT 0,0,ds+fbw+(hr-ftw-fbw)/2,unID,fsw,1+128 : unID=unID+1
						HOTSPOT fsw,0,ds+fbw+(hr-ftw-fbw)/2,unID,fsw,2 : unID=unID+1
						HOTSPOT -1,0,ds+fbw+(hr-ftw-fbw)/2,unID,fsw,3 : unID=unID+1

						HOTSPOT lra,0,ds+fbw+(hr-ftw-fbw)/2,unID,fsw,1+128 : unID=unID+1
						HOTSPOT lra-fsw,0,ds+fbw+(hr-ftw-fbw)/2,unID,fsw,2 : unID=unID+1
						HOTSPOT lra+1,0,ds+fbw+(hr-ftw-fbw)/2,unID,fsw,3 : unID=unID+1

					ENDIF
			ENDIF

	!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! *** STRAIGHT CURVED *** !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

		IF ABS(ani)<EPS and ptyp_m<>1 THEN
			IF ab<360 THEN

				!!!HEIGHT OF RAILING
					HOTSPOT rb*sin(ab/2),rb-rb*cos(ab/2),ds,unID,hr,1+128 : unID=unID+1
					HOTSPOT rb*sin(ab/2),rb-rb*cos(ab/2),ds+hr,unID,hr,2 : unID=unID+1
					HOTSPOT rb*sin(ab/2),rb-rb*cos(ab/2),-1,unID,ds,3 : unID=unID+1

				!!! DISTANCE FROM FLOOR
					HOTSPOT rb*sin(ab/2),rb-rb*cos(ab/2),0,unID,ds,1 : unID=unID+1
					HOTSPOT rb*sin(ab/2),rb-rb*cos(ab/2),ds,unID,ds,2 : unID=unID+1
					HOTSPOT rb*sin(ab/2),rb-rb*cos(ab/2),-1,unID,ds,3 : unID=unID+1

				IF ptyp_m=3 THEN
				!!!ROTATE
					HOTSPOT 0,rb,ds,unID,ab,6 : unID=unID+1
					HOTSPOT 0,0,ds,unID,ab,4+256 : unID=unID+1
					HOTSPOT rb*sin(ab),rb-rb*cos(ab),ds,unID,ab,5 : unID=unID+1

					HOTSPOT 0,rb,ds+hr,unID,ab,6 : unID=unID+1
					HOTSPOT 0,0,ds+hr,unID,ab,4+256 : unID=unID+1
					HOTSPOT rb*sin(ab),rb-rb*cos(ab),ds+hr,unID,ab,5 : unID=unID+1

				!!!FIX HOTSPOT AT FLOOR
					HOTSPOT 0,0,0,unID : unID=unID+1
					HOTSPOT rb*sin(ab),rb-rb*cos(ab),0,unID : unID=unID+1
				ENDIF


				IF ptyp_m=2 THEN
				!!!HEIGHT OF RAILING
					HOTSPOT 0,0,ds,unID,hr,1+128 : unID=unID+1
					HOTSPOT 0,0,ds+hr,unID,hr,2 : unID=unID+1
					HOTSPOT 0,0,-1,unID,hr,3 : unID=unID+1

					HOTSPOT rb*sin(ab),rb-rb*cos(ab),ds,unID,hr,1+128 : unID=unID+1
					HOTSPOT rb*sin(ab),rb-rb*cos(ab),ds+hr,unID,hr,2 : unID=unID+1
					HOTSPOT rb*sin(ab),rb-rb*cos(ab),-1,unID,hr,3 : unID=unID+1

				!!! DISTANCE FROM FLOOR
					HOTSPOT 0,0,0,unID,ds,1 : unID=unID+1
					HOTSPOT 0,0,ds,unID,ds,2 : unID=unID+1
					HOTSPOT 0,0,-1,unID,ds,3 : unID=unID+1

					HOTSPOT rb*sin(ab),rb-rb*cos(ab),0,unID,ds,1 : unID=unID+1
					HOTSPOT rb*sin(ab),rb-rb*cos(ab),ds,unID,ds,2 : unID=unID+1
					HOTSPOT rb*sin(ab),rb-rb*cos(ab),-1,unID,ds,3 : unID=unID+1
				ENDIF

			IF gs_detlevel_3D_m = 2 and gs_frameStyle_m < 2 THEN
					!!!Frame Width Bottom
					HOTSPOT rb*sin(ab/2),rb-rb*cos(ab/2),ds,unID,fbw,1+128 : unID=unID+1
					HOTSPOT rb*sin(ab/2),rb-rb*cos(ab/2),ds+fbw,unID,fbw,2 : unID=unID+1
					HOTSPOT rb*sin(ab/2),rb-rb*cos(ab/2),ds-1,unID,fbw,3 : unID=unID+1

					!!!Frame Width Top
					HOTSPOT rb*sin(ab/2),rb-rb*cos(ab/2),ds+hr,unID,ftw,1+128 : unID=unID+1
					HOTSPOT rb*sin(ab/2),rb-rb*cos(ab/2),ds+hr-ftw,unID,ftw,2 : unID=unID+1
					HOTSPOT rb*sin(ab/2),rb-rb*cos(ab/2),ds+hr+1,unID,ftw,3 : unID=unID+1
				ENDIF

			ELSE	!!!ANGLE=360

				!!!HOTSPOTS FOR GRAPHICAL EDITING
				!!!HEIGHT OF RAILING
					HOTSPOT 0,0,ds,unID,hr,1 : unID=unID+1
					HOTSPOT 0,0,ds+hr,unID,hr,2 : unID=unID+1
					HOTSPOT 0,0,-1,unID,hr,3 : unID=unID+1

					HOTSPOT rb,rb,ds,unID,hr,1 : unID=unID+1
					HOTSPOT rb,rb,ds+hr,unID,hr,2 : unID=unID+1
					HOTSPOT rb,rb,-1,unID,hr,3 : unID=unID+1

					HOTSPOT 0,2*rb,ds,unID,hr,1 : unID=unID+1
					HOTSPOT 0,2*rb,ds+hr,unID,hr,2 : unID=unID+1
					HOTSPOT 0,2*rb,-1,unID,hr,3 : unID=unID+1

					HOTSPOT -rb,rb,ds,unID,hr,1 : unID=unID+1
					HOTSPOT -rb,rb,ds+hr,unID,hr,2 : unID=unID+1
					HOTSPOT -rb,rb,-1,unID,hr,3 : unID=unID+1

				!!! DISTANCE FROM FLOOR
					HOTSPOT 0,0,0,unID,ds,1 : unID=unID+1
					HOTSPOT 0,0,ds,unID,ds,2 : unID=unID+1
					HOTSPOT 0,0,-1,unID,ds,3 : unID=unID+1

					HOTSPOT rb,rb,0,unID,ds,1 : unID=unID+1
					HOTSPOT rb,rb,ds,unID,ds,2 : unID=unID+1
					HOTSPOT rb,rb,-1,unID,ds,3 : unID=unID+1

					HOTSPOT 0,2*rb,0,unID,ds,1 : unID=unID+1
					HOTSPOT 0,2*rb,ds,unID,ds,2 : unID=unID+1
					HOTSPOT 0,2*rb,-1,unID,ds,3 : unID=unID+1

					HOTSPOT -rb,rb,0,unID,ds,1 : unID=unID+1
					HOTSPOT -rb,rb,ds,unID,ds,2 : unID=unID+1
					HOTSPOT -rb,rb,-1,unID,ds,3 : unID=unID+1

			ENDIF
		ENDIF

	!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! *** STRAIGHT INCLINED *** !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

		IF ABS(ani)>EPS and ptyp_m=1 THEN	!ptyp=Straight
			IF rom_m=1 THEN					!Vertical Orientation

					IF rmm_m=1 THEN			!Vertical Measurement
						temp_ds=ds
						temp_hr=hr
						temp_fbw=fbw
						temp_ftw=ftw
					ELSE					!Perpendicular Measurement
						temp_ds=dsPerp
						temp_hr=hrPerp
						temp_fbw=fbwPerp
						temp_ftw=ftwPerp
					ENDIF


					!!!	HOTSPOTS FOR GRAPHICAL EDITING
					!!! LENGTH OF RAILING

						HOTSPOT 0,	0,	0,				unID, lrah, 1+256 : unID=unID+1
						HOTSPOT -1, 0,	0-tan(ani),		unID, lrah, 3 : unID=unID+1
						HOTSPOT lra,0, 	0+lra*tan(ani),	unID, lrah, 2 : unID=unID+1

						HOTSPOT 0,	0,	temp_ds,				unID, lrah, 1+256 : unID=unID+1
						HOTSPOT -1, 0,	temp_ds-tan(ani),		unID, lrah, 3 : unID=unID+1
						HOTSPOT lra,0, 	temp_ds+lra*tan(ani),	unID, lrah, 2 : unID=unID+1

						HOTSPOT 0,	0,	temp_ds+temp_hr,				unID, lrah, 1+256 : unID=unID+1
						HOTSPOT -1, 0,	temp_ds+temp_hr-tan(ani),		unID, lrah, 3 : unID=unID+1
						HOTSPOT lra,0, 	temp_ds+temp_hr+lra*tan(ani),	unID, lrah, 2 : unID=unID+1


					IF rmm_m=1 THEN
						!!! DISTANCE FROM FLOOR
						HOTSPOT lra/2,	0,	lra/2*tan(ani),	unID, ds, 1+128 : unID=unID+1
						HOTSPOT lra/2,	0,	lra/2*tan(ani)-1,	unID, ds, 3 : unID=unID+1
						HOTSPOT lra/2,	0, 	lra/2*tan(ani)+temp_ds,	unID, ds, 2 : unID=unID+1

						!!! HEIGHT of RAILING
						HOTSPOT lra/2,	0,	temp_ds+lra/2*tan(ani),	unID, hr, 1+128 : unID=unID+1
						HOTSPOT lra/2,	0,	temp_ds+lra/2*tan(ani)-1,	unID, hr, 3 : unID=unID+1
						HOTSPOT lra/2,	0, 	temp_ds+lra/2*tan(ani)+temp_hr,unID, hr, 2 : unID=unID+1

				IF gs_detlevel_3D_m = 2 and gs_frameStyle_m < 2 THEN
							!!!Frame Width Bottom
							HOTSPOT lra/2,	0,	lra/2*tan(ani)+temp_ds,		unID, fbw, 1+128 : unID=unID+1
							HOTSPOT lra/2,	0,	lra/2*tan(ani)+temp_ds-1,	unID, fbw, 3 : unID=unID+1
							HOTSPOT lra/2,	0, 	lra/2*tan(ani)+temp_ds+temp_fbw,unID, fbw, 2 : unID=unID+1

							!!!Frame Width Top
							HOTSPOT lra/2,	0,	lra/2*tan(ani)+temp_ds+temp_hr,		unID, ftw, 1+128 : unID=unID+1
							HOTSPOT lra/2,	0,	lra/2*tan(ani)+temp_ds+temp_hr+1,	unID, ftw, 3 : unID=unID+1
							HOTSPOT lra/2,	0, 	lra/2*tan(ani)+temp_ds+temp_hr-temp_ftw,unID, ftw, 2 : unID=unID+1
						ENDIF

					ELSE
						!!! DISTANCE FROM FLOOR
						HOTSPOT lra/2,	0,	lra/2*tan(ani),	unID, dsPerp, 1+128, ds : unID=unID+1
						HOTSPOT lra/2,	0,	lra/2*tan(ani)-1,	unID, dsPerp, 3, ds : unID=unID+1
						HOTSPOT lra/2,	0, 	lra/2*tan(ani)+temp_ds,	unID, dsPerp, 2, ds : unID=unID+1

						!!! HEIGHT of RAILING
						HOTSPOT lra/2,	0,	temp_ds+lra/2*tan(ani),	unID, hrPerp, 1+128, hr : unID=unID+1
						HOTSPOT lra/2,	0,	temp_ds+lra/2*tan(ani)-1,	unID, hrPerp, 3, hr  : unID=unID+1
						HOTSPOT lra/2,	0, 	temp_ds+lra/2*tan(ani)+temp_hr,unID, hrPerp, 2, hr  : unID=unID+1

				IF gs_detlevel_3D_m = 2 and gs_frameStyle_m < 2 THEN
							!!!Frame Width Bottom
							HOTSPOT lra/2,	0,	lra/2*tan(ani)+temp_ds,		unID, fbwPerp, 1+128, fbw : unID=unID+1
							HOTSPOT lra/2,	0,	lra/2*tan(ani)+temp_ds-1,	unID, fbwPerp, 3, fbw : unID=unID+1
							HOTSPOT lra/2,	0, 	lra/2*tan(ani)+temp_ds+temp_fbw,unID, fbwPerp, 2, fbw : unID=unID+1

							!!!Frame Width Top
							HOTSPOT lra/2,	0,	lra/2*tan(ani)+temp_ds+temp_hr,		unID, ftwPerp, 1+128, ftw : unID=unID+1
							HOTSPOT lra/2,	0,	lra/2*tan(ani)+temp_ds+temp_hr+1,	unID, ftwPerp, 3, ftw : unID=unID+1
							HOTSPOT lra/2,	0, 	lra/2*tan(ani)+temp_ds+temp_hr-temp_ftw,unID, ftwPerp, 2, ftw : unID=unID+1
						ENDIF
					ENDIF

			IF gs_detlevel_3D_m = 2 and gs_frameStyle_m < 2 THEN
							!!!Frame Width Side
							HOTSPOT 0,	0,	temp_ds+temp_fbw+(temp_hr-temp_ftw-temp_fbw)/2,				unID, fswPerp, 1+128, fsw : unID=unID+1
							HOTSPOT -1, 0,	temp_ds+temp_fbw+(temp_hr-temp_ftw-temp_fbw)/2-tan(ani),		unID, fswPerp, 3, fsw : unID=unID+1
							HOTSPOT fsw,0, 	temp_ds+temp_fbw+(temp_hr-temp_ftw-temp_fbw)/2+fsw*tan(ani),	unID, fswPerp, 2, fsw : unID=unID+1

							HOTSPOT lra,	0,	temp_ds+temp_fbw+(temp_hr-temp_ftw-temp_fbw)/2+lra*tan(ani),				unID, fswPerp, 1+128, fsw : unID=unID+1
							HOTSPOT lra+1, 0,	temp_ds+temp_fbw+(temp_hr-temp_ftw-temp_fbw)/2+lra*tan(ani)+tan(ani),		unID, fswPerp, 3, fsw : unID=unID+1
							HOTSPOT lra-fsw,0, 	temp_ds+temp_fbw+(temp_hr-temp_ftw-temp_fbw)/2+lra*tan(ani)-fsw*tan(ani),	unID, fswPerp, 2, fsw : unID=unID+1
					ENDIF

			ELSE			!Perpendicular Orientation
							!Measurement is always perpendicular to inclination in this case
				ROTy -ani

						!!! LENGTH OF RAILING
						HOTSPOT 0,0,0,unID,lrah,1+256 : unID=unID+1
						HOTSPOT lrah,0,0,unID,lrah,2 	: unID=unID+1
						HOTSPOT -1,0,0,unID,lrah,3 	: unID=unID+1

						HOTSPOT 0,0,ds,unID,lrah,1+256 : unID=unID+1
						HOTSPOT lrah,0,ds,unID,lrah,2 	: unID=unID+1
						HOTSPOT -1,0,ds,unID,lrah,3 	: unID=unID+1

						HOTSPOT 0,0,ds+hr,unID,lrah,1+256 : unID=unID+1
						HOTSPOT lrah,0,ds+hr,unID,lrah,2 	: unID=unID+1
						HOTSPOT -1,0,ds+hr,unID,lrah,3 	: unID=unID+1

						!!!DISTANCE FROM FLOOR
						HOTSPOT lrah/2,0,0,unID,ds,1+128 : unID=unID+1
						HOTSPOT lrah/2,0,ds,unID,ds,2 : unID=unID+1
						HOTSPOT lrah/2,0,-1,unID,ds,3 : unID=unID+1

						!!! HEIGHT of RAILING
						HOTSPOT lrah/2,0,ds,unID,hr,1 : unID=unID+1
						HOTSPOT lrah/2,0,ds+hr,unID,hr,2 : unID=unID+1
						HOTSPOT lrah/2,0,-1,unID,hr,3 : unID=unID+1

			IF gs_detlevel_3D_m = 2 and gs_frameStyle_m < 2 THEN
							!!!Frame Width Bottom
							HOTSPOT lrah/2,0,ds,unID,fbw,1+128 : unID=unID+1
							HOTSPOT lrah/2,0,ds+fbw,unID,fbw,2 : unID=unID+1
							HOTSPOT lrah/2,0,ds-1,unID,fbw,3 : unID=unID+1

							!!!Frame Width Top
							HOTSPOT lrah/2,0,ds+hr,unID,ftw,1+128 : unID=unID+1
							HOTSPOT lrah/2,0,ds+hr-ftw,unID,ftw,2 : unID=unID+1
							HOTSPOT lrah/2,0,ds+hr+1,unID,ftw,3 : unID=unID+1

							!!!Frame Width Side
							HOTSPOT 0,0,ds+fbw+(hr-ftw-fbw)/2,unID,fsw,1+128 : unID=unID+1
							HOTSPOT fsw,0,ds+fbw+(hr-ftw-fbw)/2,unID,fsw,2 : unID=unID+1
							HOTSPOT -1,0,ds+fbw+(hr-ftw-fbw)/2,unID,fsw,3 : unID=unID+1

							HOTSPOT lrah,0,ds+fbw+(hr-ftw-fbw)/2,unID,fsw,1+128 : unID=unID+1
							HOTSPOT lrah-fsw,0,ds+fbw+(hr-ftw-fbw)/2,unID,fsw,2 : unID=unID+1
							HOTSPOT lrah+1,0,ds+fbw+(hr-ftw-fbw)/2,unID,fsw,3 : unID=unID+1
						ENDIF

				DEL 1
			ENDIF
		ENDIF

!!!!!!!!!!!!!!!!!!!!!!!!!!!! *** INCLINED AND CURVED *** !!!!!!!!!!!!!!!!!!!!!!!!!!!!

		IF ABS(ani)>EPS and ptyp_m<>1 THEN
				!!!HOTSPOTS FOR GRAPHICAL EDITING
				IF ptyp_m=3 THEN
					!!!ROTATE
					HOTSPOT 0,rb,ds+lra*sin(ani),unID,ab,6 : unID=unID+1
					HOTSPOT 0,0,ds+lra*sin(ani),unID,ab,4+128 : unID=unID+1
					HOTSPOT rb*sin(ab),rb-rb*cos(ab),ds+lra*sin(ani),unID,ab,5 : unID=unID+1

					HOTSPOT 0,rb,ds+hr+lra*sin(ani),unID,ab,6 : unID=unID+1
					HOTSPOT 0,0,ds+hr+lra*sin(ani),unID,ab,4+128 : unID=unID+1
					HOTSPOT rb*sin(ab),rb-rb*cos(ab),ds+hr+lra*sin(ani),unID,ab,5 : unID=unID+1
				ENDIF

					!!!HEIGHT OF RAILING
					HOTSPOT 0,0,ds,unID,hr,1 : unID=unID+1
					HOTSPOT 0,0,ds+hr,unID,hr,2 : unID=unID+1
					HOTSPOT 0,0,-1,unID,hr,3 : unID=unID+1

					HOTSPOT rb*sin(ab/2),rb-rb*cos(ab/2),ds+(lra/2)*sin(ani),unID,hr,1 : unID=unID+1
					HOTSPOT rb*sin(ab/2),rb-rb*cos(ab/2),ds+hr+(lra/2)*sin(ani),unID,hr,2 : unID=unID+1
					HOTSPOT rb*sin(ab/2),rb-rb*cos(ab/2),-1,unID,hr,3 : unID=unID+1

					!!!DISTANCE FROM FLOOR
					HOTSPOT rb*sin(ab/2),rb-rb*cos(ab/2),(lra/2)*sin(ani),unID,ds,1 : unID=unID+1
					HOTSPOT rb*sin(ab/2),rb-rb*cos(ab/2),ds+(lra/2)*sin(ani),unID,ds,2 : unID=unID+1
					HOTSPOT rb*sin(ab/2),rb-rb*cos(ab/2),-1,unID,ds,3 : unID=unID+1

					HOTSPOT 0,0,0,unID,ds,1 : unID=unID+1
					HOTSPOT 0,0,ds,unID,ds,2 : unID=unID+1
					HOTSPOT 0,0,-1,unID,ds,3 : unID=unID+1

					!!!FIX HOTSPOT AT FLOOR
					HOTSPOT rb*sin(ab),rb-rb*cos(ab),0+lra*sin(ani), unID : unID=unID+1

				IF ptyp_m=2 THEN
					!!!HEIGHT OF RAILING
					HOTSPOT rb*sin(ab),rb-rb*cos(ab),ds+lra*sin(ani),unID,hr,1 : unID=unID+1
					HOTSPOT rb*sin(ab),rb-rb*cos(ab),ds+hr+lra*sin(ani),unID,hr,2 : unID=unID+1
					HOTSPOT rb*sin(ab),rb-rb*cos(ab),-1,unID,hr,3 : unID=unID+1

					!!!DISTANCE FROM FLOOR
					HOTSPOT rb*sin(ab),rb-rb*cos(ab),lra*sin(ani),unID,ds,1+128 : unID=unID+1
					HOTSPOT rb*sin(ab),rb-rb*cos(ab),ds+lra*sin(ani),unID,ds,2 : unID=unID+1
					HOTSPOT rb*sin(ab),rb-rb*cos(ab),-1,unID,ds,3 : unID=unID+1
				ENDIF
		ENDIF
	ENDIF

end
]]>
</Script_3D>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_2D SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[
call "railSymbol2D_m" parameters all	bEnable2DPosts		= 0,
										iHandRailStyle		= gs_frameStyle_m,
										handRailDiameter	= gs_frameDiameter,
										handRailWidth		= fth,
										bBreakRailLine		= 0,
										bPostNoCalculation	= 0

]]>
</Script_2D>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_1D SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[
!!Rail Solid Frame Filled

EPS=0.0001

!!PARAMETER INPUT CALCULATION!!

if gs_frameStyle_m = 2 then
	fth = gs_frameDiameter
	ftw = gs_frameDiameter
	fbw = gs_frameDiameter
	fsw = gs_frameDiameter
endif

if ptyp_m=1 then	!ptyp=Straight
	hideparameter "ab"
	hideparameter "rb"
	hideparameter "res"
endif

if ptyp_m=2 then	!ptyp=Curve Length and Radius
	if abs(rb)>EPS then
		parameters ab=(lra*180)/(rb*pi)
		lock "ab"
	endif
endif

if ptyp_m=3 then	!ptyp=Angle and Radius
	parameters lra=(rb*pi*ab)/180
	lock "lra"
endif


!!FILL LENGHT AND HEIGHT CALCULATION!!

IF rom_m=2 AND rmm_m=2 THEN
	fillw=lrah-2*(fsw+fdf)
ELSE
	fillw=lra-2*(fsw+fdf)
ENDIF

	fillh=hr-ftw-fbw-2*fdf


!!ADDITIONAL ANGLE CALCULATION!!
if ptyp_m<>1 then

	alphafsw=(fsw*180)/(rb*pi)
	alphafills=((fsw+fdf)*180)/(rb*pi)
	alphafillm=(fillw*180)/(rb*pi)


	!For curved and inclined rail
	nalphaincl=int(ab/(360/res))+1 !number of segment points
	alphaincl=ab/nalphaincl  !angle between segment points
	deltaz=lra*sin(ani)
	deltazincl=deltaz/nalphaincl !vertical step between segment points

	m=int(alphafsw/alphaincl)+1
	mm=int(alphafills/alphaincl)+1
endif

]]>
</Script_1D>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_PR SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_PR>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_UI SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_UI>

<Comment SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Comment>

<Picture MIME="image/png" SectVersion="19" SectionFlags="0" SubIdent="0" length_in_bytes="3228" platform="Win">
	<![CDATA[
	696D6167652F706E670089504E470D0A1A0A0000000D494844520000007F0000
	007F0803000000F163ED21000000E1504C5445FFFFFFCAA45ACDB26ABAA26CD1
	B36BCCAB62C59A4CD0A95DAE9253EFF0F074633AB293538A7342C39C53D2B572
	C6A24EBDA15D756641DBD6CBE1E5E4B49C62DFE2E0EBE5D3D0AB62CEB371B291
	4EF0F0EEF0EEEA9F9275DBC18AAC8E51AC8C4C725D33E4CBA4BFA674E6D2AC71
	562EE8D9B4B18E4CDDD9D06E542B896D3CDED0B4CEBB94EBE2CDC38D48DBC592
	DFD2A3E8DDC9D4BB816E5B32E0C49C89713DDDCEB4D19F59D4C4A4948464C5B1
	84AE904EC4AC7CC09E66D2BF9AC6893FAD7D3F8B7B529A8659998E73BF8C3F91
	7944BE7F3DE8CFB6D5AE7BC6AD80C07F3D99814E7BA9D0EA00000B6C49444154
	785EC599859222CB12863B4B5B057519779775397AEDFD1FE86656B134DDD567
	D865804916822036E2EB3FB5B2C67B031B0DBDB7B4F751FBF8EDE877115AFB63
	EB6DE8DDCF27846FC3FE5BD087F753C4730E2A397E8BC0B7FD28F279A412D93B
	DCBDEB393A1E6DA07A3DB973FF8F3E5B7A045A48ADAE77CB1FDE4C0D3E829E16
	00EADBB7C75DE2FFD5F60D3D4138D1FFFEA60E7719F819D2231E0946F43FFFBE
	FE13C4CEF8A38FB329055E3201900DBE7FFFEFB5126257FCE1FB9359C47DCE19
	9390A8EFE70FDF95165A64BBE1DFB523322E91AEAEBF7CDD3BDA1B08D03AD387
	3B69B6D3A8CD236EC27E8225D70CC330D21A40EF803FBAC466D7E65C22EFFA3A
	D96F79869F03280DFA78FBCD162BFE8073904A2979D3F25A9D56772F0C073A03
	BDF5FCBB233AE22500F464BF4BF453EF34243E0821D2ADEAEF7E8C48FC010790
	8C210BE9F43A6D34CE2381BFA45BE59BC01FB465920163EC36083A9D4E8BACDB
	683472867C21B7C77FF67D9F133EEAF584A0C0139D8CF43738EBF7D9F6E2DFE5
	D8EA393F481210824DAEC8F50B3B0D1B8D36EA1720B6A3BF85816FA3F8289126
	F001D20BF3507FC819E320E0702BCD3632783900812A0FD1F5656B868DD8670C
	20DB06FFB84D741E25891682DD0C870BF19880017DEF3E840D0EC00060E3FEEF
	1EB4A7D1419B278944F502036F8DD0F4B6FAC3D00746FCC34D07FE842ABE1D01
	7517ECEE65EDF60902EA3F116379B661FE909A2D8D1AC092D362429EEF58EDF6
	9FF930FACF720E99DA6CFC9FBFD8BC4B7A52F4201D0DADF2A507B01F46FF27C8
	5596E9C7CD05DED279D263B24789D5ADD28339DEC43F42F9689BD23FC2C09F44
	9C4752484892C751ABB0A0FA00CD239C3F80F2957ADCD42E6BD6390E424A50E9
	A8A8782456BCDF21FD4703656C7F3353D6663D0043EDBD3BAFDB29857E49BA79
	358F8EC23F07EADB66FCDFFD3C9BD1908F40CA24F9B24F83C6F24B6EB768B2D6
	1DEA9F91FA0D9CBF865F23C49378891D4F7E1D79A7AD65E797FC3FF74573EF28
	3C49B4D6EFF46BFDFF8CF41965BD4C70CE7EA5034EE1F732BEF8A57976BE1781
	4E92E495FEEFB667B4C8B773885424D2BB516DD2CFB1C5339C3E84E10CD43BAD
	5ED5FF5B07D36984F81CB201408A815F5821B69AFC46FFD119F61F942FE5FE2B
	9AED748A81E7790E03D038E75AA5922FD095E427FD8DF06C90242079B236FFC2
	9F4D7D1FB5231DCC01A7ACBE8C5FB8DFD65F48FE072ED7DEFFAFDA2788E73E6A
	CF20EF5F21B3ACDE62ABA19F7BC19CBFA5C48251FBEB365B3FF26DE073796BB5
	9707FD02EF04A163F4FB8CF725C0F15AC72B32CE339590EB51EE4BA1773C1004
	96CFF85AE78FE32F169F6594BFFD6EB0DC6E5A85F8D2BB5C80CDB3B091F34841
	A20FD7B938946D0E4A01C8FE8557AB9C284EE5DBAF3FF4CF06A012F8C5F8B7EE
	6766CE25080769569A39DB405CAF3B4F54C43F518952BFE6FFF712FB0D8F3895
	AEE4932E619C138E537A4E125AFDD87E40FFCAFDE71DF7A76D9F4791D2A207FD
	ABC0308A57F1C5E9380B72A13F223E88E35FB938E47E9B0F400B0DDA4ED94272
	A7E0D4275E2907C207E2834C7F96DFBA8908CF232510AFEF8718F8A58652D768
	2AEFE293FCDF0867C0FA69DAFB39FE33AD3468498FB4A7A3913B639C86EF24C2
	D2A385B4FFCAF427F7EFAEA163E281A0B4B727DB4277457239056ABB50B31137
	72960A5A4D7FA2D90E68C4732905834CED8FE6AD7E5974116477D8384E31F98F
	FA9914E94AFEE8FD2712CF3963004AFDFBC72EEBD695032A45A79482CD4683F6
	3F811E5851FFC7513445CF73897438593AD9969C5CC877BC4FCCEA730636FE82
	24BDC8EFFE07E1E87C004977775473D6F9A5B0962035D95679D4C0D63FEF23FD
	45FEE892D8A81D18A8EB939BA5565FE93125AA9B034E91103F6776FF5F757128
	0112A592FB56812F39B48C767FA819C734FFCE7C8097F4DF593A97129277400B
	D569497D35AF563F4EF1C5EA8792FF9D95C6243D459E097B7158A82FF9D8A13B
	E2DD64698667C807C84456377F879766C87E46E9D2DE1FA1F6427DA9D4ABC402
	EA1E038AFDE78CF67F00ADD4617DE079BB2D2102C1D84DB1D290558105B2E2E5
	02E9068BF40F80D66FFD58FBE739CE0FBE242084C0194F93C63DE3B8242BCDC9
	CD327971FE3B1B64F5FBF787BF90FE394A8031EA8EA4B8555841ADC3A1397DC9
	6DC3C1AD4FE76F65ECD0E11F8553AE648F3171386C552CA86A2FB82EBBA4BA10
	DF613EDAFF0C5FBF73F9E1D9B902D11769BADC70F05DD76CEB32ACF2BFCA8D28
	18FB3EF739CF88AE05E21D7E180BB4D4F22D9BAC5ADAEEEC7762511D9141F0DE
	273CF3F38CF08F43AF8EFF2418E199E1CF63B0D050BCEBFBAB9B1645742E588C
	6CCEFC4C6925D22BAFC6C6C4273C081A76F6012ADDA43EB1DCD957C952E6139D
	C77E0EA0CB273FD7FF20C043FCC8B9C173F2AF2038C425F70793185DFF81F99F
	900EFAB070BDCB4F91AF35F1C9464B4BA58B73EAAC76F5C0C0C7A89D42EF0383
	4989EEF0418B4C002CF2BFE47BC71755DDCED28D0D9FFB685478844FBB65A49B
	7F74CC65A4BF50EFB4F5FA11E7F888F01F31ED50BA7D3127F08E7E290004E59F
	51EF0A77277BFDC1C3E22FA9E63833FA7376D3F256F2996452A7E93CFFCA7E75
	A12F8C7DA43F7F40F018D1467DBF4277ED0FD22F597ADF9F10DFCA776BAC7EB9
	AC7CC34933F6638EE2AD7AE606DEE537B0FED274727FCF2CBF5572ACBBE0B9DC
	E2B93EA2EC3186DED26F036FB58D1B8DBFD2FBFBB4CFA4E7C0DD2729A2EDA425
	35DB98B1B16FF1B781C1AFD6DFF8ED9EBAAFB0FAEB3738C7EBCEC8099ADC04DE
	66BD7FD929E8ABF2EFB734152C457E85F6CFE7BC9A6584E61CE2ADF87E89BE32
	FE8CF55321C073188EE6FA240C4CE039270FD0EBA2A0AFD6DF68C429D2A9FE9D
	8C2AA1DCE355117804DB8A47FC6DC72BF157FBBFCF4080F5BFEB8217567E4B6F
	7EF0B93FE673FAC471FD0AFE591803E185F49C34ABDCA5D4B621EB7A62D3ABE9
	D057F79F27403A63C6FF2BA66DA51628F03147F32DFE6265CDD5CF1F3200ABBF
	FE74E7CE001B781E13D77CB04B0AFCAFF38F9E50BE267E01720ACDA9030ABC91
	4D81A7B29B58D7AFA39F6900D019F25F5C694B2B16567C6C6B8EB453E0D7C2D3
	F9FFC9DCF029E5AD1E6F45E02F632B3E668CC50C6B6E4DFB1DFDAF33AD3290DE
	B2CCFA38FCA05FF8681CC93E2B9AED9AFA91AF94861E78CECD69ED9E8BAEFF10
	53D0B9A5F7ADF6F5F59FBF7BA7752F9181B3C2D74F9C491C53E0596CE8B6D9AE
	AF7F2F3CD75A2709EA774FFDCE6D1BD61CD26DC633AA394CBB57F2F7CE3580D6
	1123BE05D739DEE22FB8A1CFA7ECA443F857EB073261EBBF3AF94B15DFE1289E
	FD385C8F9D9A5B3FFFA8FFD5DFAE159E0FC686CB2C9D5DB410F07A7EB877AEA4
	D000EAE5F91F3CFB7E4CF8D8B8FE76FD9A73FB1FE215EA7F21F383A6A123D8A8
	1FBF26F0EEF91FB44E16E70F27011781F7F97CAB6A7A44DF987E2D40F720215E
	79B12F2ADE8EB898F0ECF6D57077FF06053D9BFFA5729BAF3486EB2F9AED66F9
	716CE8C0DC3FDC10BDD865C9FA1BA513FFE1210632069E5BFC76CA926C8A7FFE
	1327DBF5CE3F2018E9B7CCCA2ECB8CEF3F01E4371BD2EEDE3F907E59AD7FDB6C
	A9E2CD254ADADD38DCF6DF2792CFFAFD72DAD34A13CFB5A37871E56DC5FED843
	FD4232BA7F5BC0CD4A4370CEE89893033BDE0ADCEE9FB47FA78291FE62CA92E3
	B9119F83386C6D0B4FFBD76F291A63F3FDD3365B7B6B8A783680C9665DEFEEDF
	FDBE60CCE8B781E784B71D0720755CBFE1FC47FD4837FA4BBB2C1ACB05D2B76A
	63DABF8530F56F036FF0CCE0E1663B8177F76F0612BC1F81B7709FD59C6CB7D1
	7F7E4F850034AF35263AE1ED35C2F6E9D4FFC37369D6AFEC6B9493786EF166CA
	EE42FF03EDDFA0B48E28EE6CEE7A0CFC6EF8D4FF20834CE968BEC8DB6B849DF1
	F79E044086FE3F6079EEE7F8B1D5C0BBE7DF98C2AF7492E719403E986CD7F5EE
	FDCF13E19506C818B074B84B3AF9FF08F9A09204A007E9D50E90EEFE67E966CA
	BE053FD11A34C0FECE02EFEEBF094CBA0878137E6C03FF36D61A231F8E87DE9B
	59F3F7C7DDD3FF0F25B7E31E1D37F5DB0000000049454E44AE426082
	]]>
</Picture>

<CalledMacros SectVersion="2" SectionFlags="0" SubIdent="0">
	<Macro>
		<MName><![CDATA["railSymbol2D_m"]]></MName>
		<MainGUID>C5C904E6-1706-4CD1-BC8D-6C294B5B40F7</MainGUID>
	</Macro>
</CalledMacros>

<Copyright SectVersion="1" SectionFlags="0" SubIdent="0">
	<Author>GRAPHISOFT</Author>
	<License>
		<Type>CC BY-ND</Type>
		<Version>3.0</Version>
	</License>
</Copyright>

</Symbol>
