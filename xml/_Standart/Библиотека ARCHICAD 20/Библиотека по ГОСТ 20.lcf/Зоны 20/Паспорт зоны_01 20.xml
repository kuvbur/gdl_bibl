<?xml version="1.0" encoding="UTF-8"?>
<Symbol IsArchivable="false" IsPlaceable="true" MainGUID="30E1A6AF-F7FA-4004-95E4-4D9257A9CA2C" MigrationValue="Normal" Owner="0" Signature="1381194061" Version="43">
<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_2D SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[
!Zone_Stamp_01NGK / ©GRAPHISOFT 1996/ VL

define style  "idestyle"  AC_TextFont_1 , ROOM_LSIZE , 1, 1
mul2 GLOB_SCALE/1000,GLOB_SCALE/1000
style idestyle

rrr=request("Height_of_style","idestyle", shight)


IF not(T) then
	max_len = 0
	_numRow = 0
	_offsetFrame = 3
	for i = 1 to maxRowNumber
		_xWidth = 0
		if bParam[i] then
			if i = ORDER_ZONE_NAME then
				_xWidth = stw(contentZoneProperty[i][iDataValue])
			else
				_xWidth = stw(contentZoneProperty[i][iDataValue]) + _offsetFrame
			endif
			_numRow = _numRow + 1
		endif
		if max_len < _xWidth then max_len = _xWidth
	next i
	max_h = - _numRow * shight

	vlen = - shight
	rot2 w
	add2 -max_len/2, vlen - max_h/2

	for i = 1 to maxRowNumber
		if bParam[i] then
			if i = ORDER_ZONE_NAME then
				text2 0, -vlen, contentZoneProperty[i][iDataValue]	
			else
				vlen = vlen + shight
				text2 2, -vlen, contentZoneProperty[i][iDataValue]	
			endif
		endif
	next i
	_numRowWithoutName = _numRow - bParam[ORDER_ZONE_NAME]
	vlen = vlen+shight

	hotspot2 0, shight
	hotspot2 max_len, shight
	hotspot2 0, max_h + shight
	hotspot2 max_len, max_h + shight
	hotspot2 max_len/2, max_h/2 + shight
	if hspots then
	   hotspot2 max_len/2, shight
	   hotspot2 max_len/2, max_h + shight
	   hotspot2 0, max_h/2 + shight
	   hotspot2 max_len, max_h/2 + shight
	endif

	if box_y and _numRowWithoutName > 0 then

	   line2  0 , 0, 0, -vlen
	   line2  max_len , 0, max_len , -vlen
	   for i = 0 to _numRowWithoutName
		  line2 0,-i*shight, max_len, -i*shight
	   next i
	endif
	end
else

	define style  "idestyle1"  AC_TextFont_1 , ROOM_LSIZE , 4, 1
	style idestyle1
	rot2 w
	n=110
	
	dim _xoffset[6]
		_xoffset[ORDER_ZONE_NAME]		= 15
		_xoffset[ORDER_ZONE_NUMBER]		= 2
		_xoffset[ORDER_FLOORING]		= 115
		_xoffset[ORDER_ROOM_AREA]		= 95
		_xoffset[ORDER_PERIMETER]		= 115 + 30 * bParam[ORDER_FLOORING]
		_xoffset[ORDER_CEIL_HEIGHT]		= 115 + 30 * bParam[ORDER_FLOORING] + 30 * bParam[ORDER_PERIMETER]

	for i = 1 to maxRowNumber
		if bParam[i] then
			text2 _xoffset[i], -U/2, contentZoneProperty[i][iDataValue]
		endif
		if i = ORDER_FLOORING | i = ORDER_PERIMETER | i = ORDER_CEIL_HEIGHT then
			if box_y and n then
			   line2  n+30 , 0, n+30, -U
			   line2  n , 0, n+30, 0
				line2  n , -U, n+30, -U
			endif
			n=n+30
		endif
	next i

	if box_y and n then

	   line2  0 , 0, 0, -U
	   line2  10 , 0, 10, -U
	   line2  90 , 0, 90, -U
	   line2  110 , 0, 110, -U
	   line2  0 , 0, 110,0
	   line2  0 , -U, 110, -U
	endif
	end
endif


end



]]>
</Script_2D>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_PR SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[
!Zone Stamp *DIN · ©GRAPHISOFT 1996 · VL

catname = ""
catcode = ""
rrr=request("Zone_category", "", catname, catcode)

if din_area and catcode < "A" then
  if catcode = "0 BGF" then
	 component "ОБЩАЯ ПЛОЩАДЬ", ROOM_AREA, "м2"
  else
	 component "Net Area", ROOM_AREA, "м2"
	 if catcode < "8 FF" then
		component "Area of Use" , ROOM_AREA, "м2"
		if catcode < "7 NNF"  then
		   component "Main Area of Use", ROOM_AREA, "м2"
		else
		   component "Additional Area of Use", ROOM_AREA, "м2"
		endif
	 else
		if catcode < "9 VF" then
		  component "Service Area" , ROOM_AREA, "м2"
		else
		  component "Traffic Area" , ROOM_AREA, "м2"
		endif
	 endif
  endif
endif
]]>
</Script_PR>

<Comment SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[//Intl zone stamp with DIN Area calculation//

- Use Category as Name :
    temporarily replaces current zonen name
    with the Name of the Zone Category
- Midpoint Hotspots:
    generates 4 additional Hotspots at the midpoints
    of the stamp edges
- DIN area calculation:
    calculates Area groups as components in the Zone List
]]>
</Comment>

<ParamSection SectVersion="22" SectionFlags="0" SubIdent="0">
	<ParamSectHeader>
		<AutoHotspots>false</AutoHotspots>
		<WDLeftFrame>0</WDLeftFrame>
		<WDRightFrame>0</WDRightFrame>
		<WDTopFrame>0</WDTopFrame>
		<WDBotFrame>0</WDBotFrame>
		<LayFlags>65535</LayFlags>
		<WDMirrorThickness>0</WDMirrorThickness>
		<WDWallInset>0</WDWallInset>
	</ParamSectHeader>
	<Parameters>
		<Length Name="A">
			<Description><![CDATA[""]]></Description>
			<Fix/>
			<Value>1</Value>
		</Length>
		<Length Name="B">
			<Description><![CDATA[""]]></Description>
			<Fix/>
			<Value>1</Value>
		</Length>
		<String Name="ROOM_NAME">
			<Description><![CDATA[""]]></Description>
			<Fix/>
			<Value><![CDATA["<название зоны>"]]></Value>
		</String>
		<String Name="ROOM_NUMBER">
			<Description><![CDATA[""]]></Description>
			<Fix/>
			<Value><![CDATA["<номер зоны>"]]></Value>
		</String>
		<RealNum Name="ROOM_LSIZE">
			<Description><![CDATA[""]]></Description>
			<Fix/>
			<Value>2</Value>
		</RealNum>
		<RealNum Name="ROOM_AREA">
			<Description><![CDATA[""]]></Description>
			<Fix/>
			<Value>0</Value>
		</RealNum>
		<Length Name="ROOM_PERIM">
			<Description><![CDATA[""]]></Description>
			<Fix/>
			<Value>0</Value>
		</Length>
		<Length Name="ROOM_HOLES_PRM">
			<Description><![CDATA[""]]></Description>
			<Fix/>
			<Value>0</Value>
		</Length>
		<Length Name="ROOM_WALLS_PRM">
			<Description><![CDATA[""]]></Description>
			<Fix/>
			<Value>0</Value>
		</Length>
		<Integer Name="ROOM_CORNERS">
			<Description><![CDATA[""]]></Description>
			<Fix/>
			<Value>0</Value>
		</Integer>
		<Integer Name="ROOM_CONCAVES">
			<Description><![CDATA[""]]></Description>
			<Fix/>
			<Value>0</Value>
		</Integer>
		<RealNum Name="ROOM_WALLS_SURF">
			<Description><![CDATA[""]]></Description>
			<Fix/>
			<Value>0</Value>
		</RealNum>
		<Length Name="ROOM_DOORS_WID">
			<Description><![CDATA[""]]></Description>
			<Fix/>
			<Value>0</Value>
		</Length>
		<RealNum Name="ROOM_DOORS_SURF">
			<Description><![CDATA[""]]></Description>
			<Fix/>
			<Value>0</Value>
		</RealNum>
		<Length Name="ROOM_WINDS_WID">
			<Description><![CDATA[""]]></Description>
			<Fix/>
			<Value>0</Value>
		</Length>
		<RealNum Name="ROOM_WINDS_SURF">
			<Description><![CDATA[""]]></Description>
			<Fix/>
			<Value>0</Value>
		</RealNum>
		<Length Name="ROOM_BASELEV">
			<Description><![CDATA[""]]></Description>
			<Fix/>
			<Value>0</Value>
		</Length>
		<Length Name="ROOM_FL_THICK">
			<Description><![CDATA[""]]></Description>
			<Fix/>
			<Value>0</Value>
		</Length>
		<Length Name="ROOM_HEIGHT">
			<Description><![CDATA[""]]></Description>
			<Fix/>
			<Value>0</Value>
		</Length>
		<RealNum Name="ROOM_NET_AREA">
			<Description><![CDATA[""]]></Description>
			<Fix/>
			<Value>0</Value>
		</RealNum>
		<Length Name="ROOM_NET_PERIMETER">
			<Description><![CDATA[""]]></Description>
			<Fix/>
			<Value>0</Value>
		</Length>
		<RealNum Name="ROOM_WALL_EXTR_AREA">
			<Description><![CDATA[""]]></Description>
			<Fix/>
			<Value>0</Value>
		</RealNum>
		<RealNum Name="ROOM_CURTAINWALL_EXTR_AREA">
			<Description><![CDATA["Вычитаемая Площадь Навесных Стен"]]></Description>
			<Fix/>
			<Value>0</Value>
		</RealNum>
		<RealNum Name="ROOM_COLUMN_EXTR_AREA">
			<Description><![CDATA[""]]></Description>
			<Fix/>
			<Value>0</Value>
		</RealNum>
		<RealNum Name="ROOM_FILL_EXTR_AREA">
			<Description><![CDATA[""]]></Description>
			<Fix/>
			<Value>0</Value>
		</RealNum>
		<RealNum Name="ROOM_LOW_EXTR_AREA">
			<Description><![CDATA[""]]></Description>
			<Fix/>
			<Value>0</Value>
		</RealNum>
		<RealNum Name="ROOM_TOTAL_EXTR_AREA">
			<Description><![CDATA[""]]></Description>
			<Fix/>
			<Value>0</Value>
		</RealNum>
		<RealNum Name="ROOM_REDUCED_AREA">
			<Description><![CDATA[""]]></Description>
			<Fix/>
			<Value>0</Value>
		</RealNum>
		<RealNum Name="ROOM_AREA_FACTOR">
			<Description><![CDATA[""]]></Description>
			<Fix/>
			<Value>1</Value>
		</RealNum>
		<RealNum Name="ROOM_CALC_AREA">
			<Description><![CDATA[""]]></Description>
			<Fix/>
			<Value>0</Value>
		</RealNum>
		<RealNum Name="ROOM_VOLUME">
			<Description><![CDATA[""]]></Description>
			<Fix/>
			<Value>0</Value>
		</RealNum>
		<RealNum Name="ROOM_BOUNDARY_SURF">
			<Description><![CDATA[""]]></Description>
			<Fix/>
			<Value>0</Value>
		</RealNum>
		<RealNum Name="ROOM_TOP_SURFACE">
			<Description><![CDATA[""]]></Description>
			<Fix/>
			<Value>0</Value>
		</RealNum>
		<RealNum Name="ROOM_BOT_SURFACE">
			<Description><![CDATA[""]]></Description>
			<Fix/>
			<Value>0</Value>
		</RealNum>
		<RealNum Name="ROOM_ROOF_TOP_SURF">
			<Description><![CDATA[""]]></Description>
			<Fix/>
			<Value>0</Value>
		</RealNum>
		<RealNum Name="ROOM_ROOF_BOT_SURF">
			<Description><![CDATA[""]]></Description>
			<Fix/>
			<Value>0</Value>
		</RealNum>
		<RealNum Name="ROOM_SLAB_TOP_SURF">
			<Description><![CDATA[""]]></Description>
			<Fix/>
			<Value>0</Value>
		</RealNum>
		<RealNum Name="ROOM_SLAB_BOT_SURF">
			<Description><![CDATA[""]]></Description>
			<Fix/>
			<Value>0</Value>
		</RealNum>
		<RealNum Name="ROOM_BEAM_TOP_SURF">
			<Description><![CDATA[""]]></Description>
			<Fix/>
			<Value>0</Value>
		</RealNum>
		<RealNum Name="ROOM_BEAM_BOT_SURF">
			<Description><![CDATA[""]]></Description>
			<Fix/>
			<Value>0</Value>
		</RealNum>
		<RealNum Name="ROOM_WALL_IN_TOP_SURF">
			<Description><![CDATA[""]]></Description>
			<Fix/>
			<Value>0</Value>
		</RealNum>
		<RealNum Name="ROOM_WALL_IN_BACK_SURF">
			<Description><![CDATA[""]]></Description>
			<Fix/>
			<Value>0</Value>
		</RealNum>
		<RealNum Name="ROOM_WALL_IN_SIDE_SURF">
			<Description><![CDATA[""]]></Description>
			<Fix/>
			<Value>0</Value>
		</RealNum>
		<String Name="listZoneProperty">
			<Description><![CDATA[""]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<ArrayValues FirstDimension="1" SecondDimension="2">
				<AVal Column="1" Row="1"><![CDATA[""]]></AVal>
				<AVal Column="2" Row="1"><![CDATA[""]]></AVal>
			</ArrayValues>
		</String>
		<String Name="AC_TextFont_1">
			<Description><![CDATA["Шрифт текста 1"]]></Description>
			<Fix/>
			<Flags>
				<ParFlg_Hidden/>
			</Flags>
			<Value><![CDATA["Geneva CY"]]></Value>
		</String>
		<Boolean Name="name">
			<Description><![CDATA["Показывать название зоны"]]></Description>
			<Value>1</Value>
		</Boolean>
		<Boolean Name="num">
			<Description><![CDATA["Показывать номер зоны"]]></Description>
			<Value>1</Value>
		</Boolean>
		<Boolean Name="floor">
			<Description><![CDATA["Показать сведения о поле"]]></Description>
			<Value>1</Value>
		</Boolean>
		<String Name="floor_f">
			<Description><![CDATA["Тип пола"]]></Description>
			<Value><![CDATA["<тип пола>"]]></Value>
		</String>
		<Boolean Name="area">
			<Description><![CDATA["Показывать площадь"]]></Description>
			<Value>1</Value>
		</Boolean>
		<Boolean Name="peri">
			<Description><![CDATA["Показывать периметр"]]></Description>
			<Value>1</Value>
		</Boolean>
		<Boolean Name="ceil_s">
			<Description><![CDATA["Показать высоту потолка"]]></Description>
			<Value>1</Value>
		</Boolean>
		<Boolean Name="box_y">
			<Description><![CDATA["Показать паспорт а рамке"]]></Description>
			<Value>1</Value>
		</Boolean>
		<Angle Name="w">
			<Description><![CDATA["Угол поворота"]]></Description>
			<Value>0</Value>
		</Angle>
		<Boolean Name="cn_zn">
			<Description><![CDATA["Использовать имя категории"]]></Description>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="hspots">
			<Description><![CDATA["Узловые точки посередине"]]></Description>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="din_area">
			<Description><![CDATA["Вычисление площадей в DIN"]]></Description>
			<Value>0</Value>
		</Boolean>
		<Boolean Name="T">
			<Description><![CDATA["Новый, старый  (да, нет)"]]></Description>
			<Value>1</Value>
		</Boolean>
		<Boolean Name="XX">
			<Description><![CDATA["Шапка   (да, нет)"]]></Description>
			<Value>0</Value>
		</Boolean>
		<Integer Name="VV">
			<Description><![CDATA["К-во строк"]]></Description>
			<Value>0</Value>
		</Integer>
		<Length Name="U">
			<Description><![CDATA["Высота строк, мм"]]></Description>
			<Value>8</Value>
		</Length>
	</Parameters>
</ParamSection>

<Picture MIME="image/png" SectVersion="19" SectionFlags="0" SubIdent="0" length_in_bytes="1305" platform="Win">
	<![CDATA[
	696D6167652F706E670089504E470D0A1A0A0000000D49484452000000800000
	007D08030000005DEC9B3E00000048504C5445FFFFFFA50800D68484F7D6D6BD
	4242B53129EFC6C6C65A52E7ADADF7E7E7AD2118BD3939CE7373D6948CC6C6C6
	E7FFFF527B841039427373738CADAD84848452525294BDC64A7B84B2BB1A8E00
	00048249444154785EEDD8C98EEB461286D1EF8F3149A96CF7FCFE6FDA309C40
	81437B71295D026E9D8508704322A60C8ABF9E0F2F06B71AF67F1D818F8F8F8F
	8F8F8F61DCA82255DCC624B5B84B2B9F83C7E05E2A6E65C92D964EA503F9E416
	19650A280D6E91900160DC623C3C1B467317290019774915848C2333DE6AC994
	31A455327686E52AE7AD3A2A15505D6C9549320BDEAB0B978CA3500CC87AF3FC
	590D3C659C73396F94118A598487F84701D1BC51094C0178B1E1FA5D4118EF93
	12606A0EBA19327015EF535201A5604F552A6880F7BF81157B593230B1115E72
	5EC3734D674883330F35783613F8C07395F11AAE30A9660CB6CAC0A50EC99928
	D98CD86B5840484EE9ACFE8B0A298A0942805A9B149457F163DAF8D2C8D57D61
	EB61F694062CCE374CC334F05C9DD14C63F0831A32B043482B0494C44E69863F
	158AEB118052212BB6240198D89B2F8B4BC9259E92C150E721FF354F85B1B297
	4FC90070AE89B090411E4B5A06A97053725492719DAB2054380791B30BE41CBC
	A80B6723B58C235783A79A73BE6A70D54C7CC8D92880D62C74CE797099CFF8D6
	21BC510C19EC37A44A5ECA7375F616F74EE92901782F9BAE49E7A5F6ED97559A
	53E858E826A5E4BCCE61CBA8EFC78E50B3A5825072DDB0284E99E44CA1E3C084
	507091E7A3A5E2CCA335CB0286D830F99CBF0B9744508A3F5D8D4A675BB002B0
	BE9C05852B2038679249BBF15021C314C3D4848C0B16F56A30E49CB35CD3C19D
	094CFD9C6D900B7C7149A8810CB62AF837BFFEC2097F5DFD9B152599C571FF0A
	7EFBED3FA72F300429A9B8C853D2C01FA91E6CF8979C5FFFF577CE7C29F5305F
	8D8B2A20549C08A9F8DB2FFFF8E7FF0C1CA5E29A8E384EDFE3503EE7A6E41A5F
	D5C0921AECF838BB3DBA8B8947F6F2AAE337FCB8E6861F92139214C58B5804A5
	E4A89416CA7D16420393E42FFBFE93CCD774F69480AFCDD2CEB74C00D3EA5C57
	9AE5E7123B2E0368D53E5F333EC675CCFD2AA8626748002DB6249B57AE33D90C
	F6895683AF7DB617035FB2978C1F0757B055AD704292725BB036F30626BBDC7C
	835096A5EAD87F52D18AF05DFF3598C2C0C425BEB606D843877A2E19F82AB63A
	8BD14AC75279B50B4A561A007558EF866CFE6E28BEB7C3B670AE700568B01392
	CFCEC315675D41A8B96E31181A783E99C05737ADCEA25C4EAA3C55F3CA551500
	A5519B89AA9EBB6728CD14EC28E7D5F8118372FE6001804CDB296F5498E4444A
	C95E28E0C2F96FE37BFD9C7D98BECD72CBF8230B83858356DAE2B67231022600
	8864AB15CC2C9C8BD02BCE41138083B3A55000B67D4659141396515CB50E1F9D
	2B3BCE82A901CB858925B54A4F5E492159B133C4D9FFE21D50B3FCBC780593CC
	3998ADB16FBF8CEFBBA9E23A6CE13C31C08CFFB1F94D5FD0C6FB9438D5328092
	782F4BA0A24E4F0DC054BC959ED66BB6B3B3A41A60C879A7F90D7026A4A02279
	AB08E31CA47EE7BC55F1272A14C5CF37B857C8B855C8B99773932E6E65920653
	183F9DAF6AA96B6E69FC7CA9F290A280E206A6829294C53D528B670F5B8D7B98
	4CC19DA4E056A6C1BD52DCAB55DC6A316EF3F1F1F1F15150DCCA06F7AAC1ADDC
	17E7AFE6BF4A441636BD56F1EA0000000049454E44AE426082
	]]>
</Picture>

<Ancestry SectVersion="1" SectionFlags="0" SubIdent="0" Template="false">
	<MainGUID>F938E33A-329D-4A36-BE3E-85E126820996</MainGUID>
	<MainGUID>B176ABF1-5813-478F-926B-28EE7C5DC1F7</MainGUID>
	<MainGUID>4FD10D67-2F29-4844-A65A-6597589B0CB5</MainGUID>
	<MainGUID>A73622DE-E40A-4E63-ADB7-52D13422BD06</MainGUID>
</Ancestry>

<CalledMacros SectVersion="2" SectionFlags="0" SubIdent="0">
</CalledMacros>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_1D SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[

! Zone Content
! -------------------------------------------------------------------------
! ==============================================================================
! Content
! 1 : Zone Name				->	title
! 2 : Zone No.				->	title
! 3 : Flooring				->	title
! 4 : Room Area				->	title + value with unit
! 5 : Perimeter				->	title + value with unit
! 6 : Ceiling Height		->	title + value with unit
! ==============================================================================

maxRowNumber = 6

dim contentZoneProperty[6][2]
for i = 1 to maxRowNumber
	for j = 1 to 2
		contentZoneProperty[i][j] = ""
	next j
next i

ORDER_ZONE_NAME		= 1
ORDER_ZONE_NUMBER	= 2
ORDER_FLOORING		= 3
ORDER_ROOM_AREA		= 4
ORDER_PERIMETER		= 5
ORDER_CEIL_HEIGHT	= 6

iDataName	= 1
iDataValue	= 2

dim bParam[6]
	bParam[ORDER_ZONE_NAME]		= name
	bParam[ORDER_ZONE_NUMBER]	= num
	bParam[ORDER_FLOORING]		= floor
	bParam[ORDER_ROOM_AREA]		= area
	bParam[ORDER_PERIMETER]		= peri
	bParam[ORDER_CEIL_HEIGHT]	= ceil_s

! Future Development for quantity macro
_iQuantityString	= 0
_iQuantityLinear	= 1 	! Linear_dimension
_iQuantityCalcLength= 10 	! Calc_length_unit
_iQuantityArea		= 9 	! Area_dimension
_iQuantityCalcArea	= 11 	! Calc_area_unit
_iQuantityVolume	= 12	! Calc_volume_unit
_iQuantityLevel		= 5		! Level_dimension

dim iQuantitiyFormats[6]
	iQuantitiyFormats[ORDER_ZONE_NAME]		= _iQuantityString
	iQuantitiyFormats[ORDER_ZONE_NUMBER]	= _iQuantityString
	iQuantitiyFormats[ORDER_FLOORING]		= _iQuantityString
	iQuantitiyFormats[ORDER_ROOM_AREA]		= _iQuantityArea
	iQuantitiyFormats[ORDER_PERIMETER]		= _iQuantityLinear
	iQuantitiyFormats[ORDER_CEIL_HEIGHT]	= _iQuantityLinear

bCalculateAreaFormat = 0
for i = 1 to maxRowNumber
	if bParam[i] then
		if iQuantitiyFormats[i] = _iQuantityArea then
			bCalculateAreaFormat = 1
		endif
	endif
next i

bCalculateLengthFormat = 0
_useCalcUnit = 0
for i = 1 to maxRowNumber
	if bParam[i] then
		if iQuantitiyFormats[i] = _iQuantityLinear then
			bCalculateLengthFormat = 1
		endif
	endif
next i


! Linear String Form and Unit
! -------------------------------------------------------------------------
linearFormat	= ""
linearUnit		= ""

if bCalculateLengthFormat then
	rrr = request("Linear_dimension", "", linearFormat)
	if strstr (linearFormat, "m") then
		! the most common case
		linearUnit = " м"
		if strstr(linearFormat, "cm")	then linearUnit = " cм"
		if strstr(linearFormat, "mm")	then linearUnit = " мм"
	else
		if strstr(linearFormat, "i") | strstr (linearFormat, "f") then linearUnit = ""
	endif
endif

! Area String Form and Unit
! -------------------------------------------------------------------------
areaFormat	= ""
areaUnit	= ""

if bCalculateAreaFormat then
	rrr = request ("Area_dimension", "", areaFormat)
	if strstr (areaFormat, "sqm") then
		! the most common case
		areaUnit= " m2"
		if strstr (areaFormat, "sqmm")	then areaUnit = " mm2"
	else
		if strstr (areaFormat, "sqcm")	then areaUnit = " cm2"
		if strstr (areaFormat, "sqf")	then areaUnit = " sq ft"
		if strstr (areaFormat, "sqi")	then areaUnit = " sq inch"
	endif
endif

if bParam[ORDER_ZONE_NAME] then
	contentZoneProperty[ORDER_ZONE_NAME][iDataName] = "название зоны"	!`Zone Name`

	catname = ""
	catcode = ""
	_ValueName = ""
	rrr=request("Zone_category", "", catname, catcode)

	! Display Category Name as Zone name
	if cn_zn then			
		_ValueName = catname
	else
		_ValueName = ROOM_NAME
	endif
	! Prints "BGF" to the stamp  
	if catcode = "0 BGF" then
		_ValueName = "ОБЩАЯ ПЛОЩАДЬ"
	endif

	contentZoneProperty[ORDER_ZONE_NAME][iDataValue] = _ValueName
endif
if bParam[ORDER_ZONE_NUMBER] then
	contentZoneProperty[ORDER_ZONE_NUMBER][iDataName] = "номер зоны"	!`Zone Number`
	contentZoneProperty[ORDER_ZONE_NUMBER][iDataValue] = ROOM_NUMBER
endif
if bParam[ORDER_FLOORING] then
	contentZoneProperty[ORDER_FLOORING][iDataName] = "сведения о поле"	!`Flooring`
	contentZoneProperty[ORDER_FLOORING][iDataValue] = floor_f
endif
if bParam[ORDER_ROOM_AREA] then
	contentZoneProperty[ORDER_ROOM_AREA][iDataName] = "площадь"	!`Area`
	_contArea = str (areaFormat, ROOM_AREA)
	if not(T) then
		_contArea = "A: " +  _contArea + areaUnit
	endif
	contentZoneProperty[ORDER_ROOM_AREA][iDataValue] = _contArea
endif
if bParam[ORDER_PERIMETER] then
	contentZoneProperty[ORDER_PERIMETER][iDataName] = "периметр"	!`Perimeter`
	_contPerim = str (linearFormat, ROOM_PERIM)
	if not(T) then
		_contPerim = "P: " + _contPerim + linearUnit
	endif
	contentZoneProperty[ORDER_PERIMETER][iDataValue] = _contPerim
endif
if bParam[ORDER_CEIL_HEIGHT] then
	contentZoneProperty[ORDER_CEIL_HEIGHT][iDataName] = "высоту потолка"	! `Ceiling Height`
	_contHeight = str (linearFormat, ROOM_HEIGHT)
	if not(T) then
		_contHeight = "H: " + _contHeight + linearUnit
	endif
	contentZoneProperty[ORDER_CEIL_HEIGHT][iDataValue] = _contHeight
endif

]]>
</Script_1D>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_UI SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[]]>
</Script_UI>

<!-- GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT ===== GDL SCRIPT -->

<Script_VL SectVersion="20" SectionFlags="0" SubIdent="0">
<![CDATA[
! ==============================================================================
! Content for BIMx Pro XMLs
!	listZoneProperty[][1]	- Data Description
!	listZoneProperty[][2]	- Data Value
! input:
!    contentZoneProperty
! ==============================================================================
dim listZoneProperty[][2]

iGet = 1
for iPut = 1 to maxRowNumber
	if bParam[iPut] then
		listZoneProperty[iGet][1] = contentZoneProperty[iPut][1]
		listZoneProperty[iGet][2] = contentZoneProperty[iPut][2]
		iGet = iGet + 1
	endif
next iPut
parameters listZoneProperty = listZoneProperty
! ==============================================================================
]]>
</Script_VL>

<Copyright SectVersion="1" SectionFlags="0" SubIdent="0">
	<Author>GRAPHISOFT</Author>
	<License>
		<Type>CC BY-ND</Type>
		<Version>3.0</Version>
	</License>
</Copyright>

<MigrationTable SectVersion="1" SectionFlags="0" SubIdent="0">
	<MigrationTableElement>
		<MainGUID>9C7CD9A3-03AA-42D7-B6C8-02ED46DF1AD9</MainGUID>
		<Version>19</Version>
		<Name><![CDATA[""]]></Name>
		<AutoMigration>true</AutoMigration>
	</MigrationTableElement>
</MigrationTable>

</Symbol>
